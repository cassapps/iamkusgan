(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();const uk="modulepreload",ck=function(t){return"/Kusgan/"+t},xy={},dk=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),u=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(n.map(o=>{if(o=ck(o),o in xy)return;xy[o]=!0;const d=o.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${h}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":uk,d||(f.as="script"),f.crossOrigin="",f.href=o,u&&f.setAttribute("nonce",u),document.head.appendChild(f),d)return new Promise((p,g)=>{f.addEventListener("load",p),f.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${o}`)))})}))}function s(a){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=a,window.dispatchEvent(u),!u.defaultPrevented)throw a}return i.then(a=>{for(const u of a||[])u.status==="rejected"&&s(u.reason);return e().catch(s)})};function hk(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function e(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=e(r);fetch(r.href,i)}})();function fk(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var K0={exports:{}},Jc={},X0={exports:{}},Re={};/**
* @license React
* react.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var Al=Symbol.for("react.element"),mk=Symbol.for("react.portal"),pk=Symbol.for("react.fragment"),gk=Symbol.for("react.strict_mode"),yk=Symbol.for("react.profiler"),vk=Symbol.for("react.provider"),bk=Symbol.for("react.context"),wk=Symbol.for("react.forward_ref"),Sk=Symbol.for("react.suspense"),xk=Symbol.for("react.memo"),Ck=Symbol.for("react.lazy"),Cy=Symbol.iterator;function _k(t){return t===null||typeof t!="object"?null:(t=Cy&&t[Cy]||t["@@iterator"],typeof t=="function"?t:null)}var Y0={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},J0=Object.assign,Z0={};function Ha(t,e,n){this.props=t,this.context=e,this.refs=Z0,this.updater=n||Y0}Ha.prototype.isReactComponent={};Ha.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ha.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function ew(){}ew.prototype=Ha.prototype;function $m(t,e,n){this.props=t,this.context=e,this.refs=Z0,this.updater=n||Y0}var Hm=$m.prototype=new ew;Hm.constructor=$m;J0(Hm,Ha.prototype);Hm.isPureReactComponent=!0;var _y=Array.isArray,tw=Object.prototype.hasOwnProperty,qm={current:null},nw={key:!0,ref:!0,__self:!0,__source:!0};function rw(t,e,n){var r,i={},s=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)tw.call(e,r)&&!nw.hasOwnProperty(r)&&(i[r]=e[r]);var u=arguments.length-2;if(u===1)i.children=n;else if(1<u){for(var o=Array(u),d=0;d<u;d++)o[d]=arguments[d+2];i.children=o}if(t&&t.defaultProps)for(r in u=t.defaultProps,u)i[r]===void 0&&(i[r]=u[r]);return{$$typeof:Al,type:t,key:s,ref:a,props:i,_owner:qm.current}}function kk(t,e){return{$$typeof:Al,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Wm(t){return typeof t=="object"&&t!==null&&t.$$typeof===Al}function Ek(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var ky=/\/+/g;function th(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Ek(""+t.key):e.toString(36)}function Lu(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Al:case mk:a=!0}}if(a)return a=t,i=i(a),t=r===""?"."+th(a,0):r,_y(i)?(n="",t!=null&&(n=t.replace(ky,"$&/")+"/"),Lu(i,e,n,"",function(d){return d})):i!=null&&(Wm(i)&&(i=kk(i,n+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(ky,"$&/")+"/")+t)),e.push(i)),1;if(a=0,r=r===""?".":r+":",_y(t))for(var u=0;u<t.length;u++){s=t[u];var o=r+th(s,u);a+=Lu(s,e,n,o,i)}else if(o=_k(t),typeof o=="function")for(t=o.call(t),u=0;!(s=t.next()).done;)s=s.value,o=r+th(s,u++),a+=Lu(s,e,n,o,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function ru(t,e,n){if(t==null)return t;var r=[],i=0;return Lu(t,r,"","",function(s){return e.call(n,s,i++)}),r}function Nk(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var En={current:null},Fu={transition:null},Tk={ReactCurrentDispatcher:En,ReactCurrentBatchConfig:Fu,ReactCurrentOwner:qm};function iw(){throw Error("act(...) is not supported in production builds of React.")}Re.Children={map:ru,forEach:function(t,e,n){ru(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return ru(t,function(){e++}),e},toArray:function(t){return ru(t,function(e){return e})||[]},only:function(t){if(!Wm(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Re.Component=Ha;Re.Fragment=pk;Re.Profiler=yk;Re.PureComponent=$m;Re.StrictMode=gk;Re.Suspense=Sk;Re.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Tk;Re.act=iw;Re.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=J0({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=qm.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(o in e)tw.call(e,o)&&!nw.hasOwnProperty(o)&&(r[o]=e[o]===void 0&&u!==void 0?u[o]:e[o])}var o=arguments.length-2;if(o===1)r.children=n;else if(1<o){u=Array(o);for(var d=0;d<o;d++)u[d]=arguments[d+2];r.children=u}return{$$typeof:Al,type:t.type,key:i,ref:s,props:r,_owner:a}};Re.createContext=function(t){return t={$$typeof:bk,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:vk,_context:t},t.Consumer=t};Re.createElement=rw;Re.createFactory=function(t){var e=rw.bind(null,t);return e.type=t,e};Re.createRef=function(){return{current:null}};Re.forwardRef=function(t){return{$$typeof:wk,render:t}};Re.isValidElement=Wm;Re.lazy=function(t){return{$$typeof:Ck,_payload:{_status:-1,_result:t},_init:Nk}};Re.memo=function(t,e){return{$$typeof:xk,type:t,compare:e===void 0?null:e}};Re.startTransition=function(t){var e=Fu.transition;Fu.transition={};try{t()}finally{Fu.transition=e}};Re.unstable_act=iw;Re.useCallback=function(t,e){return En.current.useCallback(t,e)};Re.useContext=function(t){return En.current.useContext(t)};Re.useDebugValue=function(){};Re.useDeferredValue=function(t){return En.current.useDeferredValue(t)};Re.useEffect=function(t,e){return En.current.useEffect(t,e)};Re.useId=function(){return En.current.useId()};Re.useImperativeHandle=function(t,e,n){return En.current.useImperativeHandle(t,e,n)};Re.useInsertionEffect=function(t,e){return En.current.useInsertionEffect(t,e)};Re.useLayoutEffect=function(t,e){return En.current.useLayoutEffect(t,e)};Re.useMemo=function(t,e){return En.current.useMemo(t,e)};Re.useReducer=function(t,e,n){return En.current.useReducer(t,e,n)};Re.useRef=function(t){return En.current.useRef(t)};Re.useState=function(t){return En.current.useState(t)};Re.useSyncExternalStore=function(t,e,n){return En.current.useSyncExternalStore(t,e,n)};Re.useTransition=function(){return En.current.useTransition()};Re.version="18.3.1";X0.exports=Re;var k=X0.exports;const $e=fk(k),Ik=hk({__proto__:null,default:$e},[k]);/**
* @license React
* react-jsx-runtime.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var jk=k,Ak=Symbol.for("react.element"),Dk=Symbol.for("react.fragment"),Mk=Object.prototype.hasOwnProperty,Pk=jk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ok={key:!0,ref:!0,__self:!0,__source:!0};function sw(t,e,n){var r,i={},s=null,a=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)Mk.call(e,r)&&!Ok.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:Ak,type:t,key:s,ref:a,props:i,_owner:Pk.current}}Jc.Fragment=Dk;Jc.jsx=sw;Jc.jsxs=sw;K0.exports=Jc;var c=K0.exports,sf={},aw={exports:{}},Wn={},ow={exports:{}},lw={};/**
* @license React
* scheduler.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/(function(t){function e(L,G){var z=L.length;L.push(G);e:for(;0<z;){var $=z-1>>>1,W=L[$];if(0<i(W,G))L[$]=G,L[z]=W,z=$;else break e}}function n(L){return L.length===0?null:L[0]}function r(L){if(L.length===0)return null;var G=L[0],z=L.pop();if(z!==G){L[0]=z;e:for(var $=0,W=L.length,ee=W>>>1;$<ee;){var Z=2*($+1)-1,ie=L[Z],P=Z+1,V=L[P];if(0>i(ie,z))P<W&&0>i(V,ie)?(L[$]=V,L[P]=z,$=P):(L[$]=ie,L[Z]=z,$=Z);else if(P<W&&0>i(V,z))L[$]=V,L[P]=z,$=P;else break e}}return G}function i(L,G){var z=L.sortIndex-G.sortIndex;return z!==0?z:L.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,u=a.now();t.unstable_now=function(){return a.now()-u}}var o=[],d=[],h=1,f=null,p=3,g=!1,b=!1,N=!1,D=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(L){for(var G=n(d);G!==null;){if(G.callback===null)r(d);else if(G.startTime<=L)r(d),G.sortIndex=G.expirationTime,e(o,G);else break;G=n(d)}}function O(L){if(N=!1,C(L),!b)if(n(o)!==null)b=!0,Y(R);else{var G=n(d);G!==null&&ce(O,G.startTime-L)}}function R(L,G){b=!1,N&&(N=!1,v(x),x=-1),g=!0;var z=p;try{for(C(G),f=n(o);f!==null&&(!(f.expirationTime>G)||L&&!_());){var $=f.callback;if(typeof $=="function"){f.callback=null,p=f.priorityLevel;var W=$(f.expirationTime<=G);G=t.unstable_now(),typeof W=="function"?f.callback=W:f===n(o)&&r(o),C(G)}else r(o);f=n(o)}if(f!==null)var ee=!0;else{var Z=n(d);Z!==null&&ce(O,Z.startTime-G),ee=!1}return ee}finally{f=null,p=z,g=!1}}var F=!1,E=null,x=-1,j=5,S=-1;function _(){return!(t.unstable_now()-S<j)}function I(){if(E!==null){var L=t.unstable_now();S=L;var G=!0;try{G=E(!0,L)}finally{G?T():(F=!1,E=null)}}else F=!1}var T;if(typeof w=="function")T=function(){w(I)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,K=te.port2;te.port1.onmessage=I,T=function(){K.postMessage(null)}}else T=function(){D(I,0)};function Y(L){E=L,F||(F=!0,T())}function ce(L,G){x=D(function(){L(t.unstable_now())},G)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(L){L.callback=null},t.unstable_continueExecution=function(){b||g||(b=!0,Y(R))},t.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<L?Math.floor(1e3/L):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(o)},t.unstable_next=function(L){switch(p){case 1:case 2:case 3:var G=3;break;default:G=p}var z=p;p=G;try{return L()}finally{p=z}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(L,G){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var z=p;p=L;try{return G()}finally{p=z}},t.unstable_scheduleCallback=function(L,G,z){var $=t.unstable_now();switch(typeof z=="object"&&z!==null?(z=z.delay,z=typeof z=="number"&&0<z?$+z:$):z=$,L){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=z+W,L={id:h++,callback:G,priorityLevel:L,startTime:z,expirationTime:W,sortIndex:-1},z>$?(L.sortIndex=z,e(d,L),n(o)===null&&L===n(d)&&(N?(v(x),x=-1):N=!0,ce(O,z-$))):(L.sortIndex=W,e(o,L),b||g||(b=!0,Y(R))),L},t.unstable_shouldYield=_,t.unstable_wrapCallback=function(L){var G=p;return function(){var z=p;p=G;try{return L.apply(this,arguments)}finally{p=z}}}})(lw);ow.exports=lw;var Rk=ow.exports;/**
* @license React
* react-dom.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var Lk=k,qn=Rk;function oe(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var uw=new Set,el={};function Rs(t,e){Ta(t,e),Ta(t+"Capture",e)}function Ta(t,e){for(el[t]=e,t=0;t<e.length;t++)uw.add(e[t])}var Hr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),af=Object.prototype.hasOwnProperty,Fk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ey={},Ny={};function Uk(t){return af.call(Ny,t)?!0:af.call(Ey,t)?!1:Fk.test(t)?Ny[t]=!0:(Ey[t]=!0,!1)}function Vk(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function zk(t,e,n,r){if(e===null||typeof e>"u"||Vk(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Nn(t,e,n,r,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var dn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){dn[t]=new Nn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];dn[e]=new Nn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){dn[t]=new Nn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){dn[t]=new Nn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){dn[t]=new Nn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){dn[t]=new Nn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){dn[t]=new Nn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){dn[t]=new Nn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){dn[t]=new Nn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Gm=/[\-:]([a-z])/g;function Qm(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Gm,Qm);dn[e]=new Nn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Gm,Qm);dn[e]=new Nn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Gm,Qm);dn[e]=new Nn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){dn[t]=new Nn(t,1,!1,t.toLowerCase(),null,!1,!1)});dn.xlinkHref=new Nn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){dn[t]=new Nn(t,1,!1,t.toLowerCase(),null,!0,!0)});function Km(t,e,n,r){var i=dn.hasOwnProperty(e)?dn[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(zk(e,n,i,r)&&(n=null),r||i===null?Uk(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Jr=Lk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,iu=Symbol.for("react.element"),ra=Symbol.for("react.portal"),ia=Symbol.for("react.fragment"),Xm=Symbol.for("react.strict_mode"),of=Symbol.for("react.profiler"),cw=Symbol.for("react.provider"),dw=Symbol.for("react.context"),Ym=Symbol.for("react.forward_ref"),lf=Symbol.for("react.suspense"),uf=Symbol.for("react.suspense_list"),Jm=Symbol.for("react.memo"),fi=Symbol.for("react.lazy"),hw=Symbol.for("react.offscreen"),Ty=Symbol.iterator;function fo(t){return t===null||typeof t!="object"?null:(t=Ty&&t[Ty]||t["@@iterator"],typeof t=="function"?t:null)}var Ct=Object.assign,nh;function No(t){if(nh===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);nh=e&&e[1]||""}return`
`+nh+t}var rh=!1;function ih(t,e){if(!t||rh)return"";rh=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),s=r.stack.split(`
`),a=i.length-1,u=s.length-1;1<=a&&0<=u&&i[a]!==s[u];)u--;for(;1<=a&&0<=u;a--,u--)if(i[a]!==s[u]){if(a!==1||u!==1)do if(a--,u--,0>u||i[a]!==s[u]){var o=`
`+i[a].replace(" at new "," at ");return t.displayName&&o.includes("<anonymous>")&&(o=o.replace("<anonymous>",t.displayName)),o}while(1<=a&&0<=u);break}}}finally{rh=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?No(t):""}function Bk(t){switch(t.tag){case 5:return No(t.type);case 16:return No("Lazy");case 13:return No("Suspense");case 19:return No("SuspenseList");case 0:case 2:case 15:return t=ih(t.type,!1),t;case 11:return t=ih(t.type.render,!1),t;case 1:return t=ih(t.type,!0),t;default:return""}}function cf(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ia:return"Fragment";case ra:return"Portal";case of:return"Profiler";case Xm:return"StrictMode";case lf:return"Suspense";case uf:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case dw:return(t.displayName||"Context")+".Consumer";case cw:return(t._context.displayName||"Context")+".Provider";case Ym:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Jm:return e=t.displayName||null,e!==null?e:cf(t.type)||"Memo";case fi:e=t._payload,t=t._init;try{return cf(t(e))}catch{}}return null}function $k(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return cf(e);case 8:return e===Xm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ui(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function fw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Hk(t){var e=fw(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){r=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function su(t){t._valueTracker||(t._valueTracker=Hk(t))}function mw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=fw(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function ic(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function df(t,e){var n=e.checked;return Ct({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Iy(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ui(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function pw(t,e){e=e.checked,e!=null&&Km(t,"checked",e,!1)}function hf(t,e){pw(t,e);var n=Ui(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?ff(t,e.type,n):e.hasOwnProperty("defaultValue")&&ff(t,e.type,Ui(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function jy(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function ff(t,e,n){(e!=="number"||ic(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var To=Array.isArray;function ga(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ui(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function mf(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(oe(91));return Ct({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Ay(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(oe(92));if(To(n)){if(1<n.length)throw Error(oe(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ui(n)}}function gw(t,e){var n=Ui(e.value),r=Ui(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Dy(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function yw(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pf(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?yw(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var au,vw=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(au=au||document.createElement("div"),au.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=au.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function tl(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ro={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qk=["Webkit","ms","Moz","O"];Object.keys(Ro).forEach(function(t){qk.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ro[e]=Ro[t]})});function bw(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ro.hasOwnProperty(t)&&Ro[t]?(""+e).trim():e+"px"}function ww(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=bw(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var Wk=Ct({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function gf(t,e){if(e){if(Wk[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(oe(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(oe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(oe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(oe(62))}}function yf(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var vf=null;function Zm(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var bf=null,ya=null,va=null;function My(t){if(t=Pl(t)){if(typeof bf!="function")throw Error(oe(280));var e=t.stateNode;e&&(e=rd(e),bf(t.stateNode,t.type,e))}}function Sw(t){ya?va?va.push(t):va=[t]:ya=t}function xw(){if(ya){var t=ya,e=va;if(va=ya=null,My(t),e)for(t=0;t<e.length;t++)My(e[t])}}function Cw(t,e){return t(e)}function _w(){}var sh=!1;function kw(t,e,n){if(sh)return t(e,n);sh=!0;try{return Cw(t,e,n)}finally{sh=!1,(ya!==null||va!==null)&&(_w(),xw())}}function nl(t,e){var n=t.stateNode;if(n===null)return null;var r=rd(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(oe(231,e,typeof n));return n}var wf=!1;if(Hr)try{var mo={};Object.defineProperty(mo,"passive",{get:function(){wf=!0}}),window.addEventListener("test",mo,mo),window.removeEventListener("test",mo,mo)}catch{wf=!1}function Gk(t,e,n,r,i,s,a,u,o){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var Lo=!1,sc=null,ac=!1,Sf=null,Qk={onError:function(t){Lo=!0,sc=t}};function Kk(t,e,n,r,i,s,a,u,o){Lo=!1,sc=null,Gk.apply(Qk,arguments)}function Xk(t,e,n,r,i,s,a,u,o){if(Kk.apply(this,arguments),Lo){if(Lo){var d=sc;Lo=!1,sc=null}else throw Error(oe(198));ac||(ac=!0,Sf=d)}}function Ls(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Ew(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Py(t){if(Ls(t)!==t)throw Error(oe(188))}function Yk(t){var e=t.alternate;if(!e){if(e=Ls(t),e===null)throw Error(oe(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Py(i),t;if(s===r)return Py(i),e;s=s.sibling}throw Error(oe(188))}if(n.return!==r.return)n=i,r=s;else{for(var a=!1,u=i.child;u;){if(u===n){a=!0,n=i,r=s;break}if(u===r){a=!0,r=i,n=s;break}u=u.sibling}if(!a){for(u=s.child;u;){if(u===n){a=!0,n=s,r=i;break}if(u===r){a=!0,r=s,n=i;break}u=u.sibling}if(!a)throw Error(oe(189))}}if(n.alternate!==r)throw Error(oe(190))}if(n.tag!==3)throw Error(oe(188));return n.stateNode.current===n?t:e}function Nw(t){return t=Yk(t),t!==null?Tw(t):null}function Tw(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Tw(t);if(e!==null)return e;t=t.sibling}return null}var Iw=qn.unstable_scheduleCallback,Oy=qn.unstable_cancelCallback,Jk=qn.unstable_shouldYield,Zk=qn.unstable_requestPaint,Mt=qn.unstable_now,eE=qn.unstable_getCurrentPriorityLevel,ep=qn.unstable_ImmediatePriority,jw=qn.unstable_UserBlockingPriority,oc=qn.unstable_NormalPriority,tE=qn.unstable_LowPriority,Aw=qn.unstable_IdlePriority,Zc=null,Nr=null;function nE(t){if(Nr&&typeof Nr.onCommitFiberRoot=="function")try{Nr.onCommitFiberRoot(Zc,t,void 0,(t.current.flags&128)===128)}catch{}}var or=Math.clz32?Math.clz32:sE,rE=Math.log,iE=Math.LN2;function sE(t){return t>>>=0,t===0?32:31-(rE(t)/iE|0)|0}var ou=64,lu=4194304;function Io(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function lc(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,a=n&268435455;if(a!==0){var u=a&~i;u!==0?r=Io(u):(s&=a,s!==0&&(r=Io(s)))}else a=n&~i,a!==0?r=Io(a):s!==0&&(r=Io(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-or(e),i=1<<n,r|=t[n],e&=~i;return r}function aE(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function oE(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-or(s),u=1<<a,o=i[a];o===-1?(!(u&n)||u&r)&&(i[a]=aE(u,e)):o<=e&&(t.expiredLanes|=u),s&=~u}}function xf(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Dw(){var t=ou;return ou<<=1,!(ou&4194240)&&(ou=64),t}function ah(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Dl(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-or(e),t[e]=n}function lE(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-or(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function tp(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-or(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var nt=0;function Mw(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Pw,np,Ow,Rw,Lw,Cf=!1,uu=[],Ei=null,Ni=null,Ti=null,rl=new Map,il=new Map,pi=[],uE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ry(t,e){switch(t){case"focusin":case"focusout":Ei=null;break;case"dragenter":case"dragleave":Ni=null;break;case"mouseover":case"mouseout":Ti=null;break;case"pointerover":case"pointerout":rl.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":il.delete(e.pointerId)}}function po(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Pl(e),e!==null&&np(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function cE(t,e,n,r,i){switch(e){case"focusin":return Ei=po(Ei,t,e,n,r,i),!0;case"dragenter":return Ni=po(Ni,t,e,n,r,i),!0;case"mouseover":return Ti=po(Ti,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return rl.set(s,po(rl.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,il.set(s,po(il.get(s)||null,t,e,n,r,i)),!0}return!1}function Fw(t){var e=ps(t.target);if(e!==null){var n=Ls(e);if(n!==null){if(e=n.tag,e===13){if(e=Ew(n),e!==null){t.blockedOn=e,Lw(t.priority,function(){Ow(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Uu(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=_f(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);vf=r,n.target.dispatchEvent(r),vf=null}else return e=Pl(n),e!==null&&np(e),t.blockedOn=n,!1;e.shift()}return!0}function Ly(t,e,n){Uu(t)&&n.delete(e)}function dE(){Cf=!1,Ei!==null&&Uu(Ei)&&(Ei=null),Ni!==null&&Uu(Ni)&&(Ni=null),Ti!==null&&Uu(Ti)&&(Ti=null),rl.forEach(Ly),il.forEach(Ly)}function go(t,e){t.blockedOn===e&&(t.blockedOn=null,Cf||(Cf=!0,qn.unstable_scheduleCallback(qn.unstable_NormalPriority,dE)))}function sl(t){function e(i){return go(i,t)}if(0<uu.length){go(uu[0],t);for(var n=1;n<uu.length;n++){var r=uu[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ei!==null&&go(Ei,t),Ni!==null&&go(Ni,t),Ti!==null&&go(Ti,t),rl.forEach(e),il.forEach(e),n=0;n<pi.length;n++)r=pi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<pi.length&&(n=pi[0],n.blockedOn===null);)Fw(n),n.blockedOn===null&&pi.shift()}var ba=Jr.ReactCurrentBatchConfig,uc=!0;function hE(t,e,n,r){var i=nt,s=ba.transition;ba.transition=null;try{nt=1,rp(t,e,n,r)}finally{nt=i,ba.transition=s}}function fE(t,e,n,r){var i=nt,s=ba.transition;ba.transition=null;try{nt=4,rp(t,e,n,r)}finally{nt=i,ba.transition=s}}function rp(t,e,n,r){if(uc){var i=_f(t,e,n,r);if(i===null)gh(t,e,r,cc,n),Ry(t,r);else if(cE(i,t,e,n,r))r.stopPropagation();else if(Ry(t,r),e&4&&-1<uE.indexOf(t)){for(;i!==null;){var s=Pl(i);if(s!==null&&Pw(s),s=_f(t,e,n,r),s===null&&gh(t,e,r,cc,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else gh(t,e,r,null,n)}}var cc=null;function _f(t,e,n,r){if(cc=null,t=Zm(r),t=ps(t),t!==null)if(e=Ls(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Ew(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return cc=t,null}function Uw(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(eE()){case ep:return 1;case jw:return 4;case oc:case tE:return 16;case Aw:return 536870912;default:return 16}default:return 16}}var Si=null,ip=null,Vu=null;function Vw(){if(Vu)return Vu;var t,e=ip,n=e.length,r,i="value"in Si?Si.value:Si.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===i[s-r];r++);return Vu=i.slice(t,1<r?1-r:void 0)}function zu(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function cu(){return!0}function Fy(){return!1}function Gn(t){function e(n,r,i,s,a){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var u in t)t.hasOwnProperty(u)&&(n=t[u],this[u]=n?n(s):s[u]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?cu:Fy,this.isPropagationStopped=Fy,this}return Ct(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=cu)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=cu)},persist:function(){},isPersistent:cu}),e}var qa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},sp=Gn(qa),Ml=Ct({},qa,{view:0,detail:0}),mE=Gn(Ml),oh,lh,yo,ed=Ct({},Ml,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ap,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==yo&&(yo&&t.type==="mousemove"?(oh=t.screenX-yo.screenX,lh=t.screenY-yo.screenY):lh=oh=0,yo=t),oh)},movementY:function(t){return"movementY"in t?t.movementY:lh}}),Uy=Gn(ed),pE=Ct({},ed,{dataTransfer:0}),gE=Gn(pE),yE=Ct({},Ml,{relatedTarget:0}),uh=Gn(yE),vE=Ct({},qa,{animationName:0,elapsedTime:0,pseudoElement:0}),bE=Gn(vE),wE=Ct({},qa,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),SE=Gn(wE),xE=Ct({},qa,{data:0}),Vy=Gn(xE),CE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_E={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function EE(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=kE[t])?!!e[t]:!1}function ap(){return EE}var NE=Ct({},Ml,{key:function(t){if(t.key){var e=CE[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=zu(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?_E[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ap,charCode:function(t){return t.type==="keypress"?zu(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?zu(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),TE=Gn(NE),IE=Ct({},ed,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),zy=Gn(IE),jE=Ct({},Ml,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ap}),AE=Gn(jE),DE=Ct({},qa,{propertyName:0,elapsedTime:0,pseudoElement:0}),ME=Gn(DE),PE=Ct({},ed,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),OE=Gn(PE),RE=[9,13,27,32],op=Hr&&"CompositionEvent"in window,Fo=null;Hr&&"documentMode"in document&&(Fo=document.documentMode);var LE=Hr&&"TextEvent"in window&&!Fo,zw=Hr&&(!op||Fo&&8<Fo&&11>=Fo),By=" ",$y=!1;function Bw(t,e){switch(t){case"keyup":return RE.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $w(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var sa=!1;function FE(t,e){switch(t){case"compositionend":return $w(e);case"keypress":return e.which!==32?null:($y=!0,By);case"textInput":return t=e.data,t===By&&$y?null:t;default:return null}}function UE(t,e){if(sa)return t==="compositionend"||!op&&Bw(t,e)?(t=Vw(),Vu=ip=Si=null,sa=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return zw&&e.locale!=="ko"?null:e.data;default:return null}}var VE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!VE[t.type]:e==="textarea"}function Hw(t,e,n,r){Sw(r),e=dc(e,"onChange"),0<e.length&&(n=new sp("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Uo=null,al=null;function zE(t){tS(t,0)}function td(t){var e=la(t);if(mw(e))return t}function BE(t,e){if(t==="change")return e}var qw=!1;if(Hr){var ch;if(Hr){var dh="oninput"in document;if(!dh){var qy=document.createElement("div");qy.setAttribute("oninput","return;"),dh=typeof qy.oninput=="function"}ch=dh}else ch=!1;qw=ch&&(!document.documentMode||9<document.documentMode)}function Wy(){Uo&&(Uo.detachEvent("onpropertychange",Ww),al=Uo=null)}function Ww(t){if(t.propertyName==="value"&&td(al)){var e=[];Hw(e,al,t,Zm(t)),kw(zE,e)}}function $E(t,e,n){t==="focusin"?(Wy(),Uo=e,al=n,Uo.attachEvent("onpropertychange",Ww)):t==="focusout"&&Wy()}function HE(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return td(al)}function qE(t,e){if(t==="click")return td(e)}function WE(t,e){if(t==="input"||t==="change")return td(e)}function GE(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var cr=typeof Object.is=="function"?Object.is:GE;function ol(t,e){if(cr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!af.call(e,i)||!cr(t[i],e[i]))return!1}return!0}function Gy(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Qy(t,e){var n=Gy(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Gy(n)}}function Gw(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Gw(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Qw(){for(var t=window,e=ic();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=ic(t.document)}return e}function lp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function QE(t){var e=Qw(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Gw(n.ownerDocument.documentElement,n)){if(r!==null&&lp(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=Qy(n,s);var a=Qy(n,r);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var KE=Hr&&"documentMode"in document&&11>=document.documentMode,aa=null,kf=null,Vo=null,Ef=!1;function Ky(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Ef||aa==null||aa!==ic(r)||(r=aa,"selectionStart"in r&&lp(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Vo&&ol(Vo,r)||(Vo=r,r=dc(kf,"onSelect"),0<r.length&&(e=new sp("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=aa)))}function du(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var oa={animationend:du("Animation","AnimationEnd"),animationiteration:du("Animation","AnimationIteration"),animationstart:du("Animation","AnimationStart"),transitionend:du("Transition","TransitionEnd")},hh={},Kw={};Hr&&(Kw=document.createElement("div").style,"AnimationEvent"in window||(delete oa.animationend.animation,delete oa.animationiteration.animation,delete oa.animationstart.animation),"TransitionEvent"in window||delete oa.transitionend.transition);function nd(t){if(hh[t])return hh[t];if(!oa[t])return t;var e=oa[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Kw)return hh[t]=e[n];return t}var Xw=nd("animationend"),Yw=nd("animationiteration"),Jw=nd("animationstart"),Zw=nd("transitionend"),eS=new Map,Xy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ki(t,e){eS.set(t,e),Rs(e,[t])}for(var fh=0;fh<Xy.length;fh++){var mh=Xy[fh],XE=mh.toLowerCase(),YE=mh[0].toUpperCase()+mh.slice(1);Ki(XE,"on"+YE)}Ki(Xw,"onAnimationEnd");Ki(Yw,"onAnimationIteration");Ki(Jw,"onAnimationStart");Ki("dblclick","onDoubleClick");Ki("focusin","onFocus");Ki("focusout","onBlur");Ki(Zw,"onTransitionEnd");Ta("onMouseEnter",["mouseout","mouseover"]);Ta("onMouseLeave",["mouseout","mouseover"]);Ta("onPointerEnter",["pointerout","pointerover"]);Ta("onPointerLeave",["pointerout","pointerover"]);Rs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Rs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Rs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Rs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Rs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Rs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var jo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),JE=new Set("cancel close invalid load scroll toggle".split(" ").concat(jo));function Yy(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Xk(r,e,void 0,t),t.currentTarget=null}function tS(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var a=r.length-1;0<=a;a--){var u=r[a],o=u.instance,d=u.currentTarget;if(u=u.listener,o!==s&&i.isPropagationStopped())break e;Yy(i,u,d),s=o}else for(a=0;a<r.length;a++){if(u=r[a],o=u.instance,d=u.currentTarget,u=u.listener,o!==s&&i.isPropagationStopped())break e;Yy(i,u,d),s=o}}}if(ac)throw t=Sf,ac=!1,Sf=null,t}function ht(t,e){var n=e[Af];n===void 0&&(n=e[Af]=new Set);var r=t+"__bubble";n.has(r)||(nS(e,t,2,!1),n.add(r))}function ph(t,e,n){var r=0;e&&(r|=4),nS(n,t,r,e)}var hu="_reactListening"+Math.random().toString(36).slice(2);function ll(t){if(!t[hu]){t[hu]=!0,uw.forEach(function(n){n!=="selectionchange"&&(JE.has(n)||ph(n,!1,t),ph(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[hu]||(e[hu]=!0,ph("selectionchange",!1,e))}}function nS(t,e,n,r){switch(Uw(e)){case 1:var i=hE;break;case 4:i=fE;break;default:i=rp}n=i.bind(null,e,n,t),i=void 0,!wf||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function gh(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var u=r.stateNode.containerInfo;if(u===i||u.nodeType===8&&u.parentNode===i)break;if(a===4)for(a=r.return;a!==null;){var o=a.tag;if((o===3||o===4)&&(o=a.stateNode.containerInfo,o===i||o.nodeType===8&&o.parentNode===i))return;a=a.return}for(;u!==null;){if(a=ps(u),a===null)return;if(o=a.tag,o===5||o===6){r=s=a;continue e}u=u.parentNode}}r=r.return}kw(function(){var d=s,h=Zm(n),f=[];e:{var p=eS.get(t);if(p!==void 0){var g=sp,b=t;switch(t){case"keypress":if(zu(n)===0)break e;case"keydown":case"keyup":g=TE;break;case"focusin":b="focus",g=uh;break;case"focusout":b="blur",g=uh;break;case"beforeblur":case"afterblur":g=uh;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=Uy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=gE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=AE;break;case Xw:case Yw:case Jw:g=bE;break;case Zw:g=ME;break;case"scroll":g=mE;break;case"wheel":g=OE;break;case"copy":case"cut":case"paste":g=SE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=zy}var N=(e&4)!==0,D=!N&&t==="scroll",v=N?p!==null?p+"Capture":null:p;N=[];for(var w=d,C;w!==null;){C=w;var O=C.stateNode;if(C.tag===5&&O!==null&&(C=O,v!==null&&(O=nl(w,v),O!=null&&N.push(ul(w,O,C)))),D)break;w=w.return}0<N.length&&(p=new g(p,b,null,n,h),f.push({event:p,listeners:N}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",p&&n!==vf&&(b=n.relatedTarget||n.fromElement)&&(ps(b)||b[qr]))break e;if((g||p)&&(p=h.window===h?h:(p=h.ownerDocument)?p.defaultView||p.parentWindow:window,g?(b=n.relatedTarget||n.toElement,g=d,b=b?ps(b):null,b!==null&&(D=Ls(b),b!==D||b.tag!==5&&b.tag!==6)&&(b=null)):(g=null,b=d),g!==b)){if(N=Uy,O="onMouseLeave",v="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(N=zy,O="onPointerLeave",v="onPointerEnter",w="pointer"),D=g==null?p:la(g),C=b==null?p:la(b),p=new N(O,w+"leave",g,n,h),p.target=D,p.relatedTarget=C,O=null,ps(h)===d&&(N=new N(v,w+"enter",b,n,h),N.target=C,N.relatedTarget=D,O=N),D=O,g&&b)t:{for(N=g,v=b,w=0,C=N;C;C=Gs(C))w++;for(C=0,O=v;O;O=Gs(O))C++;for(;0<w-C;)N=Gs(N),w--;for(;0<C-w;)v=Gs(v),C--;for(;w--;){if(N===v||v!==null&&N===v.alternate)break t;N=Gs(N),v=Gs(v)}N=null}else N=null;g!==null&&Jy(f,p,g,N,!1),b!==null&&D!==null&&Jy(f,D,b,N,!0)}}e:{if(p=d?la(d):window,g=p.nodeName&&p.nodeName.toLowerCase(),g==="select"||g==="input"&&p.type==="file")var R=BE;else if(Hy(p))if(qw)R=WE;else{R=HE;var F=$E}else(g=p.nodeName)&&g.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(R=qE);if(R&&(R=R(t,d))){Hw(f,R,n,h);break e}F&&F(t,p,d),t==="focusout"&&(F=p._wrapperState)&&F.controlled&&p.type==="number"&&ff(p,"number",p.value)}switch(F=d?la(d):window,t){case"focusin":(Hy(F)||F.contentEditable==="true")&&(aa=F,kf=d,Vo=null);break;case"focusout":Vo=kf=aa=null;break;case"mousedown":Ef=!0;break;case"contextmenu":case"mouseup":case"dragend":Ef=!1,Ky(f,n,h);break;case"selectionchange":if(KE)break;case"keydown":case"keyup":Ky(f,n,h)}var E;if(op)e:{switch(t){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else sa?Bw(t,n)&&(x="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(x="onCompositionStart");x&&(zw&&n.locale!=="ko"&&(sa||x!=="onCompositionStart"?x==="onCompositionEnd"&&sa&&(E=Vw()):(Si=h,ip="value"in Si?Si.value:Si.textContent,sa=!0)),F=dc(d,x),0<F.length&&(x=new Vy(x,t,null,n,h),f.push({event:x,listeners:F}),E?x.data=E:(E=$w(n),E!==null&&(x.data=E)))),(E=LE?FE(t,n):UE(t,n))&&(d=dc(d,"onBeforeInput"),0<d.length&&(h=new Vy("onBeforeInput","beforeinput",null,n,h),f.push({event:h,listeners:d}),h.data=E))}tS(f,e)})}function ul(t,e,n){return{instance:t,listener:e,currentTarget:n}}function dc(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=nl(t,n),s!=null&&r.unshift(ul(t,s,i)),s=nl(t,e),s!=null&&r.push(ul(t,s,i))),t=t.return}return r}function Gs(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Jy(t,e,n,r,i){for(var s=e._reactName,a=[];n!==null&&n!==r;){var u=n,o=u.alternate,d=u.stateNode;if(o!==null&&o===r)break;u.tag===5&&d!==null&&(u=d,i?(o=nl(n,s),o!=null&&a.unshift(ul(n,o,u))):i||(o=nl(n,s),o!=null&&a.push(ul(n,o,u)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var ZE=/\r\n?/g,eN=/\u0000|\uFFFD/g;function Zy(t){return(typeof t=="string"?t:""+t).replace(ZE,`
`).replace(eN,"")}function fu(t,e,n){if(e=Zy(e),Zy(t)!==e&&n)throw Error(oe(425))}function hc(){}var Nf=null,Tf=null;function If(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var jf=typeof setTimeout=="function"?setTimeout:void 0,tN=typeof clearTimeout=="function"?clearTimeout:void 0,ev=typeof Promise=="function"?Promise:void 0,nN=typeof queueMicrotask=="function"?queueMicrotask:typeof ev<"u"?function(t){return ev.resolve(null).then(t).catch(rN)}:jf;function rN(t){setTimeout(function(){throw t})}function yh(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),sl(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);sl(e)}function Ii(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function tv(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Wa=Math.random().toString(36).slice(2),Cr="__reactFiber$"+Wa,cl="__reactProps$"+Wa,qr="__reactContainer$"+Wa,Af="__reactEvents$"+Wa,iN="__reactListeners$"+Wa,sN="__reactHandles$"+Wa;function ps(t){var e=t[Cr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[qr]||n[Cr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=tv(t);t!==null;){if(n=t[Cr])return n;t=tv(t)}return e}t=n,n=t.parentNode}return null}function Pl(t){return t=t[Cr]||t[qr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function la(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(oe(33))}function rd(t){return t[cl]||null}var Df=[],ua=-1;function Xi(t){return{current:t}}function mt(t){0>ua||(t.current=Df[ua],Df[ua]=null,ua--)}function ot(t,e){ua++,Df[ua]=t.current,t.current=e}var Vi={},Sn=Xi(Vi),Pn=Xi(!1),_s=Vi;function Ia(t,e){var n=t.type.contextTypes;if(!n)return Vi;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function On(t){return t=t.childContextTypes,t!=null}function fc(){mt(Pn),mt(Sn)}function nv(t,e,n){if(Sn.current!==Vi)throw Error(oe(168));ot(Sn,e),ot(Pn,n)}function rS(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(oe(108,$k(t)||"Unknown",i));return Ct({},n,r)}function mc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Vi,_s=Sn.current,ot(Sn,t),ot(Pn,Pn.current),!0}function rv(t,e,n){var r=t.stateNode;if(!r)throw Error(oe(169));n?(t=rS(t,e,_s),r.__reactInternalMemoizedMergedChildContext=t,mt(Pn),mt(Sn),ot(Sn,t)):mt(Pn),ot(Pn,n)}var Fr=null,id=!1,vh=!1;function iS(t){Fr===null?Fr=[t]:Fr.push(t)}function aN(t){id=!0,iS(t)}function Yi(){if(!vh&&Fr!==null){vh=!0;var t=0,e=nt;try{var n=Fr;for(nt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Fr=null,id=!1}catch(i){throw Fr!==null&&(Fr=Fr.slice(t+1)),Iw(ep,Yi),i}finally{nt=e,vh=!1}}return null}var ca=[],da=0,pc=null,gc=0,Kn=[],Xn=0,ks=null,Vr=1,zr="";function ds(t,e){ca[da++]=gc,ca[da++]=pc,pc=t,gc=e}function sS(t,e,n){Kn[Xn++]=Vr,Kn[Xn++]=zr,Kn[Xn++]=ks,ks=t;var r=Vr;t=zr;var i=32-or(r)-1;r&=~(1<<i),n+=1;var s=32-or(e)+i;if(30<s){var a=i-i%5;s=(r&(1<<a)-1).toString(32),r>>=a,i-=a,Vr=1<<32-or(e)+i|n<<i|r,zr=s+t}else Vr=1<<s|n<<i|r,zr=t}function up(t){t.return!==null&&(ds(t,1),sS(t,1,0))}function cp(t){for(;t===pc;)pc=ca[--da],ca[da]=null,gc=ca[--da],ca[da]=null;for(;t===ks;)ks=Kn[--Xn],Kn[Xn]=null,zr=Kn[--Xn],Kn[Xn]=null,Vr=Kn[--Xn],Kn[Xn]=null}var Hn=null,zn=null,yt=!1,ar=null;function aS(t,e){var n=Jn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function iv(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Hn=t,zn=Ii(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Hn=t,zn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ks!==null?{id:Vr,overflow:zr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Jn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Hn=t,zn=null,!0):!1;default:return!1}}function Mf(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Pf(t){if(yt){var e=zn;if(e){var n=e;if(!iv(t,e)){if(Mf(t))throw Error(oe(418));e=Ii(n.nextSibling);var r=Hn;e&&iv(t,e)?aS(r,n):(t.flags=t.flags&-4097|2,yt=!1,Hn=t)}}else{if(Mf(t))throw Error(oe(418));t.flags=t.flags&-4097|2,yt=!1,Hn=t}}}function sv(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Hn=t}function mu(t){if(t!==Hn)return!1;if(!yt)return sv(t),yt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!If(t.type,t.memoizedProps)),e&&(e=zn)){if(Mf(t))throw oS(),Error(oe(418));for(;e;)aS(t,e),e=Ii(e.nextSibling)}if(sv(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(oe(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){zn=Ii(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}zn=null}}else zn=Hn?Ii(t.stateNode.nextSibling):null;return!0}function oS(){for(var t=zn;t;)t=Ii(t.nextSibling)}function ja(){zn=Hn=null,yt=!1}function dp(t){ar===null?ar=[t]:ar.push(t)}var oN=Jr.ReactCurrentBatchConfig;function vo(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(oe(309));var r=n.stateNode}if(!r)throw Error(oe(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var u=i.refs;a===null?delete u[s]:u[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(oe(284));if(!n._owner)throw Error(oe(290,t))}return t}function pu(t,e){throw t=Object.prototype.toString.call(e),Error(oe(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function av(t){var e=t._init;return e(t._payload)}function lS(t){function e(v,w){if(t){var C=v.deletions;C===null?(v.deletions=[w],v.flags|=16):C.push(w)}}function n(v,w){if(!t)return null;for(;w!==null;)e(v,w),w=w.sibling;return null}function r(v,w){for(v=new Map;w!==null;)w.key!==null?v.set(w.key,w):v.set(w.index,w),w=w.sibling;return v}function i(v,w){return v=Mi(v,w),v.index=0,v.sibling=null,v}function s(v,w,C){return v.index=C,t?(C=v.alternate,C!==null?(C=C.index,C<w?(v.flags|=2,w):C):(v.flags|=2,w)):(v.flags|=1048576,w)}function a(v){return t&&v.alternate===null&&(v.flags|=2),v}function u(v,w,C,O){return w===null||w.tag!==6?(w=kh(C,v.mode,O),w.return=v,w):(w=i(w,C),w.return=v,w)}function o(v,w,C,O){var R=C.type;return R===ia?h(v,w,C.props.children,O,C.key):w!==null&&(w.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===fi&&av(R)===w.type)?(O=i(w,C.props),O.ref=vo(v,w,C),O.return=v,O):(O=Qu(C.type,C.key,C.props,null,v.mode,O),O.ref=vo(v,w,C),O.return=v,O)}function d(v,w,C,O){return w===null||w.tag!==4||w.stateNode.containerInfo!==C.containerInfo||w.stateNode.implementation!==C.implementation?(w=Eh(C,v.mode,O),w.return=v,w):(w=i(w,C.children||[]),w.return=v,w)}function h(v,w,C,O,R){return w===null||w.tag!==7?(w=Ss(C,v.mode,O,R),w.return=v,w):(w=i(w,C),w.return=v,w)}function f(v,w,C){if(typeof w=="string"&&w!==""||typeof w=="number")return w=kh(""+w,v.mode,C),w.return=v,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case iu:return C=Qu(w.type,w.key,w.props,null,v.mode,C),C.ref=vo(v,null,w),C.return=v,C;case ra:return w=Eh(w,v.mode,C),w.return=v,w;case fi:var O=w._init;return f(v,O(w._payload),C)}if(To(w)||fo(w))return w=Ss(w,v.mode,C,null),w.return=v,w;pu(v,w)}return null}function p(v,w,C,O){var R=w!==null?w.key:null;if(typeof C=="string"&&C!==""||typeof C=="number")return R!==null?null:u(v,w,""+C,O);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case iu:return C.key===R?o(v,w,C,O):null;case ra:return C.key===R?d(v,w,C,O):null;case fi:return R=C._init,p(v,w,R(C._payload),O)}if(To(C)||fo(C))return R!==null?null:h(v,w,C,O,null);pu(v,C)}return null}function g(v,w,C,O,R){if(typeof O=="string"&&O!==""||typeof O=="number")return v=v.get(C)||null,u(w,v,""+O,R);if(typeof O=="object"&&O!==null){switch(O.$$typeof){case iu:return v=v.get(O.key===null?C:O.key)||null,o(w,v,O,R);case ra:return v=v.get(O.key===null?C:O.key)||null,d(w,v,O,R);case fi:var F=O._init;return g(v,w,C,F(O._payload),R)}if(To(O)||fo(O))return v=v.get(C)||null,h(w,v,O,R,null);pu(w,O)}return null}function b(v,w,C,O){for(var R=null,F=null,E=w,x=w=0,j=null;E!==null&&x<C.length;x++){E.index>x?(j=E,E=null):j=E.sibling;var S=p(v,E,C[x],O);if(S===null){E===null&&(E=j);break}t&&E&&S.alternate===null&&e(v,E),w=s(S,w,x),F===null?R=S:F.sibling=S,F=S,E=j}if(x===C.length)return n(v,E),yt&&ds(v,x),R;if(E===null){for(;x<C.length;x++)E=f(v,C[x],O),E!==null&&(w=s(E,w,x),F===null?R=E:F.sibling=E,F=E);return yt&&ds(v,x),R}for(E=r(v,E);x<C.length;x++)j=g(E,v,x,C[x],O),j!==null&&(t&&j.alternate!==null&&E.delete(j.key===null?x:j.key),w=s(j,w,x),F===null?R=j:F.sibling=j,F=j);return t&&E.forEach(function(_){return e(v,_)}),yt&&ds(v,x),R}function N(v,w,C,O){var R=fo(C);if(typeof R!="function")throw Error(oe(150));if(C=R.call(C),C==null)throw Error(oe(151));for(var F=R=null,E=w,x=w=0,j=null,S=C.next();E!==null&&!S.done;x++,S=C.next()){E.index>x?(j=E,E=null):j=E.sibling;var _=p(v,E,S.value,O);if(_===null){E===null&&(E=j);break}t&&E&&_.alternate===null&&e(v,E),w=s(_,w,x),F===null?R=_:F.sibling=_,F=_,E=j}if(S.done)return n(v,E),yt&&ds(v,x),R;if(E===null){for(;!S.done;x++,S=C.next())S=f(v,S.value,O),S!==null&&(w=s(S,w,x),F===null?R=S:F.sibling=S,F=S);return yt&&ds(v,x),R}for(E=r(v,E);!S.done;x++,S=C.next())S=g(E,v,x,S.value,O),S!==null&&(t&&S.alternate!==null&&E.delete(S.key===null?x:S.key),w=s(S,w,x),F===null?R=S:F.sibling=S,F=S);return t&&E.forEach(function(I){return e(v,I)}),yt&&ds(v,x),R}function D(v,w,C,O){if(typeof C=="object"&&C!==null&&C.type===ia&&C.key===null&&(C=C.props.children),typeof C=="object"&&C!==null){switch(C.$$typeof){case iu:e:{for(var R=C.key,F=w;F!==null;){if(F.key===R){if(R=C.type,R===ia){if(F.tag===7){n(v,F.sibling),w=i(F,C.props.children),w.return=v,v=w;break e}}else if(F.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===fi&&av(R)===F.type){n(v,F.sibling),w=i(F,C.props),w.ref=vo(v,F,C),w.return=v,v=w;break e}n(v,F);break}else e(v,F);F=F.sibling}C.type===ia?(w=Ss(C.props.children,v.mode,O,C.key),w.return=v,v=w):(O=Qu(C.type,C.key,C.props,null,v.mode,O),O.ref=vo(v,w,C),O.return=v,v=O)}return a(v);case ra:e:{for(F=C.key;w!==null;){if(w.key===F)if(w.tag===4&&w.stateNode.containerInfo===C.containerInfo&&w.stateNode.implementation===C.implementation){n(v,w.sibling),w=i(w,C.children||[]),w.return=v,v=w;break e}else{n(v,w);break}else e(v,w);w=w.sibling}w=Eh(C,v.mode,O),w.return=v,v=w}return a(v);case fi:return F=C._init,D(v,w,F(C._payload),O)}if(To(C))return b(v,w,C,O);if(fo(C))return N(v,w,C,O);pu(v,C)}return typeof C=="string"&&C!==""||typeof C=="number"?(C=""+C,w!==null&&w.tag===6?(n(v,w.sibling),w=i(w,C),w.return=v,v=w):(n(v,w),w=kh(C,v.mode,O),w.return=v,v=w),a(v)):n(v,w)}return D}var Aa=lS(!0),uS=lS(!1),yc=Xi(null),vc=null,ha=null,hp=null;function fp(){hp=ha=vc=null}function mp(t){var e=yc.current;mt(yc),t._currentValue=e}function Of(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function wa(t,e){vc=t,hp=ha=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Mn=!0),t.firstContext=null)}function er(t){var e=t._currentValue;if(hp!==t)if(t={context:t,memoizedValue:e,next:null},ha===null){if(vc===null)throw Error(oe(308));ha=t,vc.dependencies={lanes:0,firstContext:t}}else ha=ha.next=t;return e}var gs=null;function pp(t){gs===null?gs=[t]:gs.push(t)}function cS(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,pp(e)):(n.next=i.next,i.next=n),e.interleaved=n,Wr(t,r)}function Wr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var mi=!1;function gp(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function dS(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Br(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ji(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,We&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Wr(t,n)}return i=r.interleaved,i===null?(e.next=e,pp(r)):(e.next=i.next,i.next=e),r.interleaved=e,Wr(t,n)}function Bu(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,tp(t,n)}}function ov(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=a:s=s.next=a,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function bc(t,e,n,r){var i=t.updateQueue;mi=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,u=i.shared.pending;if(u!==null){i.shared.pending=null;var o=u,d=o.next;o.next=null,a===null?s=d:a.next=d,a=o;var h=t.alternate;h!==null&&(h=h.updateQueue,u=h.lastBaseUpdate,u!==a&&(u===null?h.firstBaseUpdate=d:u.next=d,h.lastBaseUpdate=o))}if(s!==null){var f=i.baseState;a=0,h=d=o=null,u=s;do{var p=u.lane,g=u.eventTime;if((r&p)===p){h!==null&&(h=h.next={eventTime:g,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var b=t,N=u;switch(p=e,g=n,N.tag){case 1:if(b=N.payload,typeof b=="function"){f=b.call(g,f,p);break e}f=b;break e;case 3:b.flags=b.flags&-65537|128;case 0:if(b=N.payload,p=typeof b=="function"?b.call(g,f,p):b,p==null)break e;f=Ct({},f,p);break e;case 2:mi=!0}}u.callback!==null&&u.lane!==0&&(t.flags|=64,p=i.effects,p===null?i.effects=[u]:p.push(u))}else g={eventTime:g,lane:p,tag:u.tag,payload:u.payload,callback:u.callback,next:null},h===null?(d=h=g,o=f):h=h.next=g,a|=p;if(u=u.next,u===null){if(u=i.shared.pending,u===null)break;p=u,u=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(!0);if(h===null&&(o=f),i.baseState=o,i.firstBaseUpdate=d,i.lastBaseUpdate=h,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Ns|=a,t.lanes=a,t.memoizedState=f}}function lv(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(oe(191,i));i.call(r)}}}var Ol={},Tr=Xi(Ol),dl=Xi(Ol),hl=Xi(Ol);function ys(t){if(t===Ol)throw Error(oe(174));return t}function yp(t,e){switch(ot(hl,e),ot(dl,t),ot(Tr,Ol),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:pf(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=pf(e,t)}mt(Tr),ot(Tr,e)}function Da(){mt(Tr),mt(dl),mt(hl)}function hS(t){ys(hl.current);var e=ys(Tr.current),n=pf(e,t.type);e!==n&&(ot(dl,t),ot(Tr,n))}function vp(t){dl.current===t&&(mt(Tr),mt(dl))}var wt=Xi(0);function wc(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var bh=[];function bp(){for(var t=0;t<bh.length;t++)bh[t]._workInProgressVersionPrimary=null;bh.length=0}var $u=Jr.ReactCurrentDispatcher,wh=Jr.ReactCurrentBatchConfig,Es=0,St=null,Wt=null,Zt=null,Sc=!1,zo=!1,fl=0,lN=0;function mn(){throw Error(oe(321))}function wp(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!cr(t[n],e[n]))return!1;return!0}function Sp(t,e,n,r,i,s){if(Es=s,St=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,$u.current=t===null||t.memoizedState===null?hN:fN,t=n(r,i),zo){s=0;do{if(zo=!1,fl=0,25<=s)throw Error(oe(301));s+=1,Zt=Wt=null,e.updateQueue=null,$u.current=mN,t=n(r,i)}while(zo)}if($u.current=xc,e=Wt!==null&&Wt.next!==null,Es=0,Zt=Wt=St=null,Sc=!1,e)throw Error(oe(300));return t}function xp(){var t=fl!==0;return fl=0,t}function Sr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Zt===null?St.memoizedState=Zt=t:Zt=Zt.next=t,Zt}function tr(){if(Wt===null){var t=St.alternate;t=t!==null?t.memoizedState:null}else t=Wt.next;var e=Zt===null?St.memoizedState:Zt.next;if(e!==null)Zt=e,Wt=t;else{if(t===null)throw Error(oe(310));Wt=t,t={memoizedState:Wt.memoizedState,baseState:Wt.baseState,baseQueue:Wt.baseQueue,queue:Wt.queue,next:null},Zt===null?St.memoizedState=Zt=t:Zt=Zt.next=t}return Zt}function ml(t,e){return typeof e=="function"?e(t):e}function Sh(t){var e=tr(),n=e.queue;if(n===null)throw Error(oe(311));n.lastRenderedReducer=t;var r=Wt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var u=a=null,o=null,d=s;do{var h=d.lane;if((Es&h)===h)o!==null&&(o=o.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var f={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};o===null?(u=o=f,a=r):o=o.next=f,St.lanes|=h,Ns|=h}d=d.next}while(d!==null&&d!==s);o===null?a=r:o.next=u,cr(r,e.memoizedState)||(Mn=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=o,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,St.lanes|=s,Ns|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function xh(t){var e=tr(),n=e.queue;if(n===null)throw Error(oe(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);cr(s,e.memoizedState)||(Mn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function fS(){}function mS(t,e){var n=St,r=tr(),i=e(),s=!cr(r.memoizedState,i);if(s&&(r.memoizedState=i,Mn=!0),r=r.queue,Cp(yS.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Zt!==null&&Zt.memoizedState.tag&1){if(n.flags|=2048,pl(9,gS.bind(null,n,r,i,e),void 0,null),tn===null)throw Error(oe(349));Es&30||pS(n,e,i)}return i}function pS(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=St.updateQueue,e===null?(e={lastEffect:null,stores:null},St.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function gS(t,e,n,r){e.value=n,e.getSnapshot=r,vS(e)&&bS(t)}function yS(t,e,n){return n(function(){vS(e)&&bS(t)})}function vS(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!cr(t,n)}catch{return!0}}function bS(t){var e=Wr(t,1);e!==null&&lr(e,t,1,-1)}function uv(t){var e=Sr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ml,lastRenderedState:t},e.queue=t,t=t.dispatch=dN.bind(null,St,t),[e.memoizedState,t]}function pl(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=St.updateQueue,e===null?(e={lastEffect:null,stores:null},St.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function wS(){return tr().memoizedState}function Hu(t,e,n,r){var i=Sr();St.flags|=t,i.memoizedState=pl(1|e,n,void 0,r===void 0?null:r)}function sd(t,e,n,r){var i=tr();r=r===void 0?null:r;var s=void 0;if(Wt!==null){var a=Wt.memoizedState;if(s=a.destroy,r!==null&&wp(r,a.deps)){i.memoizedState=pl(e,n,s,r);return}}St.flags|=t,i.memoizedState=pl(1|e,n,s,r)}function cv(t,e){return Hu(8390656,8,t,e)}function Cp(t,e){return sd(2048,8,t,e)}function SS(t,e){return sd(4,2,t,e)}function xS(t,e){return sd(4,4,t,e)}function CS(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function _S(t,e,n){return n=n!=null?n.concat([t]):null,sd(4,4,CS.bind(null,e,t),n)}function _p(){}function kS(t,e){var n=tr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&wp(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function ES(t,e){var n=tr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&wp(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function NS(t,e,n){return Es&21?(cr(n,e)||(n=Dw(),St.lanes|=n,Ns|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Mn=!0),t.memoizedState=n)}function uN(t,e){var n=nt;nt=n!==0&&4>n?n:4,t(!0);var r=wh.transition;wh.transition={};try{t(!1),e()}finally{nt=n,wh.transition=r}}function TS(){return tr().memoizedState}function cN(t,e,n){var r=Di(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},IS(t))jS(e,n);else if(n=cS(t,e,n,r),n!==null){var i=kn();lr(n,t,r,i),AS(n,e,r)}}function dN(t,e,n){var r=Di(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(IS(t))jS(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,u=s(a,n);if(i.hasEagerState=!0,i.eagerState=u,cr(u,a)){var o=e.interleaved;o===null?(i.next=i,pp(e)):(i.next=o.next,o.next=i),e.interleaved=i;return}}catch{}finally{}n=cS(t,e,i,r),n!==null&&(i=kn(),lr(n,t,r,i),AS(n,e,r))}}function IS(t){var e=t.alternate;return t===St||e!==null&&e===St}function jS(t,e){zo=Sc=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function AS(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,tp(t,n)}}var xc={readContext:er,useCallback:mn,useContext:mn,useEffect:mn,useImperativeHandle:mn,useInsertionEffect:mn,useLayoutEffect:mn,useMemo:mn,useReducer:mn,useRef:mn,useState:mn,useDebugValue:mn,useDeferredValue:mn,useTransition:mn,useMutableSource:mn,useSyncExternalStore:mn,useId:mn,unstable_isNewReconciler:!1},hN={readContext:er,useCallback:function(t,e){return Sr().memoizedState=[t,e===void 0?null:e],t},useContext:er,useEffect:cv,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Hu(4194308,4,CS.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Hu(4194308,4,t,e)},useInsertionEffect:function(t,e){return Hu(4,2,t,e)},useMemo:function(t,e){var n=Sr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Sr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=cN.bind(null,St,t),[r.memoizedState,t]},useRef:function(t){var e=Sr();return t={current:t},e.memoizedState=t},useState:uv,useDebugValue:_p,useDeferredValue:function(t){return Sr().memoizedState=t},useTransition:function(){var t=uv(!1),e=t[0];return t=uN.bind(null,t[1]),Sr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=St,i=Sr();if(yt){if(n===void 0)throw Error(oe(407));n=n()}else{if(n=e(),tn===null)throw Error(oe(349));Es&30||pS(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,cv(yS.bind(null,r,s,t),[t]),r.flags|=2048,pl(9,gS.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Sr(),e=tn.identifierPrefix;if(yt){var n=zr,r=Vr;n=(r&~(1<<32-or(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=fl++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=lN++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},fN={readContext:er,useCallback:kS,useContext:er,useEffect:Cp,useImperativeHandle:_S,useInsertionEffect:SS,useLayoutEffect:xS,useMemo:ES,useReducer:Sh,useRef:wS,useState:function(){return Sh(ml)},useDebugValue:_p,useDeferredValue:function(t){var e=tr();return NS(e,Wt.memoizedState,t)},useTransition:function(){var t=Sh(ml)[0],e=tr().memoizedState;return[t,e]},useMutableSource:fS,useSyncExternalStore:mS,useId:TS,unstable_isNewReconciler:!1},mN={readContext:er,useCallback:kS,useContext:er,useEffect:Cp,useImperativeHandle:_S,useInsertionEffect:SS,useLayoutEffect:xS,useMemo:ES,useReducer:xh,useRef:wS,useState:function(){return xh(ml)},useDebugValue:_p,useDeferredValue:function(t){var e=tr();return Wt===null?e.memoizedState=t:NS(e,Wt.memoizedState,t)},useTransition:function(){var t=xh(ml)[0],e=tr().memoizedState;return[t,e]},useMutableSource:fS,useSyncExternalStore:mS,useId:TS,unstable_isNewReconciler:!1};function ir(t,e){if(t&&t.defaultProps){e=Ct({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Rf(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ct({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var ad={isMounted:function(t){return(t=t._reactInternals)?Ls(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=kn(),i=Di(t),s=Br(r,i);s.payload=e,n!=null&&(s.callback=n),e=ji(t,s,i),e!==null&&(lr(e,t,i,r),Bu(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=kn(),i=Di(t),s=Br(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=ji(t,s,i),e!==null&&(lr(e,t,i,r),Bu(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=kn(),r=Di(t),i=Br(n,r);i.tag=2,e!=null&&(i.callback=e),e=ji(t,i,r),e!==null&&(lr(e,t,r,n),Bu(e,t,r))}};function dv(t,e,n,r,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,a):e.prototype&&e.prototype.isPureReactComponent?!ol(n,r)||!ol(i,s):!0}function DS(t,e,n){var r=!1,i=Vi,s=e.contextType;return typeof s=="object"&&s!==null?s=er(s):(i=On(e)?_s:Sn.current,r=e.contextTypes,s=(r=r!=null)?Ia(t,i):Vi),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=ad,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function hv(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&ad.enqueueReplaceState(e,e.state,null)}function Lf(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},gp(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=er(s):(s=On(e)?_s:Sn.current,i.context=Ia(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Rf(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&ad.enqueueReplaceState(i,i.state,null),bc(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Ma(t,e){try{var n="",r=e;do n+=Bk(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Ch(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Ff(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var pN=typeof WeakMap=="function"?WeakMap:Map;function MS(t,e,n){n=Br(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){_c||(_c=!0,Gf=r),Ff(t,e)},n}function PS(t,e,n){n=Br(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Ff(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Ff(t,e),typeof r!="function"&&(Ai===null?Ai=new Set([this]):Ai.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function fv(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new pN;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=IN.bind(null,t,e,n),e.then(t,t))}function mv(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function pv(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Br(-1,1),e.tag=2,ji(n,e,1))),n.lanes|=1),t)}var gN=Jr.ReactCurrentOwner,Mn=!1;function _n(t,e,n,r){e.child=t===null?uS(e,null,n,r):Aa(e,t.child,n,r)}function gv(t,e,n,r,i){n=n.render;var s=e.ref;return wa(e,i),r=Sp(t,e,n,r,s,i),n=xp(),t!==null&&!Mn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Gr(t,e,i)):(yt&&n&&up(e),e.flags|=1,_n(t,e,r,i),e.child)}function yv(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Dp(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,OS(t,e,s,r,i)):(t=Qu(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(n=n.compare,n=n!==null?n:ol,n(a,r)&&t.ref===e.ref)return Gr(t,e,i)}return e.flags|=1,t=Mi(s,r),t.ref=e.ref,t.return=e,e.child=t}function OS(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(ol(s,r)&&t.ref===e.ref)if(Mn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Mn=!0);else return e.lanes=t.lanes,Gr(t,e,i)}return Uf(t,e,n,r,i)}function RS(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ot(ma,Vn),Vn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ot(ma,Vn),Vn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,ot(ma,Vn),Vn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,ot(ma,Vn),Vn|=r;return _n(t,e,i,n),e.child}function LS(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Uf(t,e,n,r,i){var s=On(n)?_s:Sn.current;return s=Ia(e,s),wa(e,i),n=Sp(t,e,n,r,s,i),r=xp(),t!==null&&!Mn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Gr(t,e,i)):(yt&&r&&up(e),e.flags|=1,_n(t,e,n,i),e.child)}function vv(t,e,n,r,i){if(On(n)){var s=!0;mc(e)}else s=!1;if(wa(e,i),e.stateNode===null)qu(t,e),DS(e,n,r),Lf(e,n,r,i),r=!0;else if(t===null){var a=e.stateNode,u=e.memoizedProps;a.props=u;var o=a.context,d=n.contextType;typeof d=="object"&&d!==null?d=er(d):(d=On(n)?_s:Sn.current,d=Ia(e,d));var h=n.getDerivedStateFromProps,f=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function";f||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(u!==r||o!==d)&&hv(e,a,r,d),mi=!1;var p=e.memoizedState;a.state=p,bc(e,r,a,i),o=e.memoizedState,u!==r||p!==o||Pn.current||mi?(typeof h=="function"&&(Rf(e,n,h,r),o=e.memoizedState),(u=mi||dv(e,n,u,r,p,o,d))?(f||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=o),a.props=r,a.state=o,a.context=d,r=u):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,dS(t,e),u=e.memoizedProps,d=e.type===e.elementType?u:ir(e.type,u),a.props=d,f=e.pendingProps,p=a.context,o=n.contextType,typeof o=="object"&&o!==null?o=er(o):(o=On(n)?_s:Sn.current,o=Ia(e,o));var g=n.getDerivedStateFromProps;(h=typeof g=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(u!==f||p!==o)&&hv(e,a,r,o),mi=!1,p=e.memoizedState,a.state=p,bc(e,r,a,i);var b=e.memoizedState;u!==f||p!==b||Pn.current||mi?(typeof g=="function"&&(Rf(e,n,g,r),b=e.memoizedState),(d=mi||dv(e,n,d,r,p,b,o)||!1)?(h||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,b,o),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,b,o)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||u===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=b),a.props=r,a.state=b,a.context=o,r=d):(typeof a.componentDidUpdate!="function"||u===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return Vf(t,e,n,r,s,i)}function Vf(t,e,n,r,i,s){LS(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return i&&rv(e,n,!1),Gr(t,e,s);r=e.stateNode,gN.current=e;var u=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=Aa(e,t.child,null,s),e.child=Aa(e,null,u,s)):_n(t,e,u,s),e.memoizedState=r.state,i&&rv(e,n,!0),e.child}function FS(t){var e=t.stateNode;e.pendingContext?nv(t,e.pendingContext,e.pendingContext!==e.context):e.context&&nv(t,e.context,!1),yp(t,e.containerInfo)}function bv(t,e,n,r,i){return ja(),dp(i),e.flags|=256,_n(t,e,n,r),e.child}var zf={dehydrated:null,treeContext:null,retryLane:0};function Bf(t){return{baseLanes:t,cachePool:null,transitions:null}}function US(t,e,n){var r=e.pendingProps,i=wt.current,s=!1,a=(e.flags&128)!==0,u;if((u=a)||(u=t!==null&&t.memoizedState===null?!1:(i&2)!==0),u?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),ot(wt,i&1),t===null)return Pf(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,s?(r=e.mode,s=e.child,a={mode:"hidden",children:a},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=ud(a,r,0,null),t=Ss(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Bf(n),e.memoizedState=zf,t):kp(e,a));if(i=t.memoizedState,i!==null&&(u=i.dehydrated,u!==null))return yN(t,e,a,r,u,i,n);if(s){s=r.fallback,a=e.mode,i=t.child,u=i.sibling;var o={mode:"hidden",children:r.children};return!(a&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=o,e.deletions=null):(r=Mi(i,o),r.subtreeFlags=i.subtreeFlags&14680064),u!==null?s=Mi(u,s):(s=Ss(s,a,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,a=t.child.memoizedState,a=a===null?Bf(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~n,e.memoizedState=zf,r}return s=t.child,t=s.sibling,r=Mi(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function kp(t,e){return e=ud({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function gu(t,e,n,r){return r!==null&&dp(r),Aa(e,t.child,null,n),t=kp(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function yN(t,e,n,r,i,s,a){if(n)return e.flags&256?(e.flags&=-257,r=Ch(Error(oe(422))),gu(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=ud({mode:"visible",children:r.children},i,0,null),s=Ss(s,i,a,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Aa(e,t.child,null,a),e.child.memoizedState=Bf(a),e.memoizedState=zf,s);if(!(e.mode&1))return gu(t,e,a,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var u=r.dgst;return r=u,s=Error(oe(419)),r=Ch(s,r,void 0),gu(t,e,a,r)}if(u=(a&t.childLanes)!==0,Mn||u){if(r=tn,r!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Wr(t,i),lr(r,t,i,-1))}return Ap(),r=Ch(Error(oe(421))),gu(t,e,a,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=jN.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,zn=Ii(i.nextSibling),Hn=e,yt=!0,ar=null,t!==null&&(Kn[Xn++]=Vr,Kn[Xn++]=zr,Kn[Xn++]=ks,Vr=t.id,zr=t.overflow,ks=e),e=kp(e,r.children),e.flags|=4096,e)}function wv(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Of(t.return,e,n)}function _h(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function VS(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(_n(t,e,r.children,n),r=wt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&wv(t,n,e);else if(t.tag===19)wv(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ot(wt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&wc(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),_h(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&wc(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}_h(e,!0,n,null,s);break;case"together":_h(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function qu(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Gr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ns|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(oe(153));if(e.child!==null){for(t=e.child,n=Mi(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Mi(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function vN(t,e,n){switch(e.tag){case 3:FS(e),ja();break;case 5:hS(e);break;case 1:On(e.type)&&mc(e);break;case 4:yp(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;ot(yc,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ot(wt,wt.current&1),e.flags|=128,null):n&e.child.childLanes?US(t,e,n):(ot(wt,wt.current&1),t=Gr(t,e,n),t!==null?t.sibling:null);ot(wt,wt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return VS(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ot(wt,wt.current),r)break;return null;case 22:case 23:return e.lanes=0,RS(t,e,n)}return Gr(t,e,n)}var zS,$f,BS,$S;zS=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};$f=function(){};BS=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,ys(Tr.current);var s=null;switch(n){case"input":i=df(t,i),r=df(t,r),s=[];break;case"select":i=Ct({},i,{value:void 0}),r=Ct({},r,{value:void 0}),s=[];break;case"textarea":i=mf(t,i),r=mf(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=hc)}gf(n,r);var a;n=null;for(d in i)if(!r.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var u=i[d];for(a in u)u.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(el.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in r){var o=r[d];if(u=i!=null?i[d]:void 0,r.hasOwnProperty(d)&&o!==u&&(o!=null||u!=null))if(d==="style")if(u){for(a in u)!u.hasOwnProperty(a)||o&&o.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in o)o.hasOwnProperty(a)&&u[a]!==o[a]&&(n||(n={}),n[a]=o[a])}else n||(s||(s=[]),s.push(d,n)),n=o;else d==="dangerouslySetInnerHTML"?(o=o?o.__html:void 0,u=u?u.__html:void 0,o!=null&&u!==o&&(s=s||[]).push(d,o)):d==="children"?typeof o!="string"&&typeof o!="number"||(s=s||[]).push(d,""+o):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(el.hasOwnProperty(d)?(o!=null&&d==="onScroll"&&ht("scroll",t),s||u===o||(s=[])):(s=s||[]).push(d,o))}n&&(s=s||[]).push("style",n);var d=s;(e.updateQueue=d)&&(e.flags|=4)}};$S=function(t,e,n,r){n!==r&&(e.flags|=4)};function bo(t,e){if(!yt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function pn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function bN(t,e,n){var r=e.pendingProps;switch(cp(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return pn(e),null;case 1:return On(e.type)&&fc(),pn(e),null;case 3:return r=e.stateNode,Da(),mt(Pn),mt(Sn),bp(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(mu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ar!==null&&(Xf(ar),ar=null))),$f(t,e),pn(e),null;case 5:vp(e);var i=ys(hl.current);if(n=e.type,t!==null&&e.stateNode!=null)BS(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(oe(166));return pn(e),null}if(t=ys(Tr.current),mu(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Cr]=e,r[cl]=s,t=(e.mode&1)!==0,n){case"dialog":ht("cancel",r),ht("close",r);break;case"iframe":case"object":case"embed":ht("load",r);break;case"video":case"audio":for(i=0;i<jo.length;i++)ht(jo[i],r);break;case"source":ht("error",r);break;case"img":case"image":case"link":ht("error",r),ht("load",r);break;case"details":ht("toggle",r);break;case"input":Iy(r,s),ht("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},ht("invalid",r);break;case"textarea":Ay(r,s),ht("invalid",r)}gf(n,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var u=s[a];a==="children"?typeof u=="string"?r.textContent!==u&&(s.suppressHydrationWarning!==!0&&fu(r.textContent,u,t),i=["children",u]):typeof u=="number"&&r.textContent!==""+u&&(s.suppressHydrationWarning!==!0&&fu(r.textContent,u,t),i=["children",""+u]):el.hasOwnProperty(a)&&u!=null&&a==="onScroll"&&ht("scroll",r)}switch(n){case"input":su(r),jy(r,s,!0);break;case"textarea":su(r),Dy(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=hc)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=yw(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[Cr]=e,t[cl]=r,zS(t,e,!1,!1),e.stateNode=t;e:{switch(a=yf(n,r),n){case"dialog":ht("cancel",t),ht("close",t),i=r;break;case"iframe":case"object":case"embed":ht("load",t),i=r;break;case"video":case"audio":for(i=0;i<jo.length;i++)ht(jo[i],t);i=r;break;case"source":ht("error",t),i=r;break;case"img":case"image":case"link":ht("error",t),ht("load",t),i=r;break;case"details":ht("toggle",t),i=r;break;case"input":Iy(t,r),i=df(t,r),ht("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Ct({},r,{value:void 0}),ht("invalid",t);break;case"textarea":Ay(t,r),i=mf(t,r),ht("invalid",t);break;default:i=r}gf(n,i),u=i;for(s in u)if(u.hasOwnProperty(s)){var o=u[s];s==="style"?ww(t,o):s==="dangerouslySetInnerHTML"?(o=o?o.__html:void 0,o!=null&&vw(t,o)):s==="children"?typeof o=="string"?(n!=="textarea"||o!=="")&&tl(t,o):typeof o=="number"&&tl(t,""+o):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(el.hasOwnProperty(s)?o!=null&&s==="onScroll"&&ht("scroll",t):o!=null&&Km(t,s,o,a))}switch(n){case"input":su(t),jy(t,r,!1);break;case"textarea":su(t),Dy(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ui(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?ga(t,!!r.multiple,s,!1):r.defaultValue!=null&&ga(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=hc)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return pn(e),null;case 6:if(t&&e.stateNode!=null)$S(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(oe(166));if(n=ys(hl.current),ys(Tr.current),mu(e)){if(r=e.stateNode,n=e.memoizedProps,r[Cr]=e,(s=r.nodeValue!==n)&&(t=Hn,t!==null))switch(t.tag){case 3:fu(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&fu(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Cr]=e,e.stateNode=r}return pn(e),null;case 13:if(mt(wt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(yt&&zn!==null&&e.mode&1&&!(e.flags&128))oS(),ja(),e.flags|=98560,s=!1;else if(s=mu(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(oe(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(oe(317));s[Cr]=e}else ja(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;pn(e),s=!1}else ar!==null&&(Xf(ar),ar=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||wt.current&1?Gt===0&&(Gt=3):Ap())),e.updateQueue!==null&&(e.flags|=4),pn(e),null);case 4:return Da(),$f(t,e),t===null&&ll(e.stateNode.containerInfo),pn(e),null;case 10:return mp(e.type._context),pn(e),null;case 17:return On(e.type)&&fc(),pn(e),null;case 19:if(mt(wt),s=e.memoizedState,s===null)return pn(e),null;if(r=(e.flags&128)!==0,a=s.rendering,a===null)if(r)bo(s,!1);else{if(Gt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=wc(t),a!==null){for(e.flags|=128,bo(s,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ot(wt,wt.current&1|2),e.child}t=t.sibling}s.tail!==null&&Mt()>Pa&&(e.flags|=128,r=!0,bo(s,!1),e.lanes=4194304)}else{if(!r)if(t=wc(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),bo(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!yt)return pn(e),null}else 2*Mt()-s.renderingStartTime>Pa&&n!==1073741824&&(e.flags|=128,r=!0,bo(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(n=s.last,n!==null?n.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Mt(),e.sibling=null,n=wt.current,ot(wt,r?n&1|2:n&1),e):(pn(e),null);case 22:case 23:return jp(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Vn&1073741824&&(pn(e),e.subtreeFlags&6&&(e.flags|=8192)):pn(e),null;case 24:return null;case 25:return null}throw Error(oe(156,e.tag))}function wN(t,e){switch(cp(e),e.tag){case 1:return On(e.type)&&fc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Da(),mt(Pn),mt(Sn),bp(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return vp(e),null;case 13:if(mt(wt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(oe(340));ja()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return mt(wt),null;case 4:return Da(),null;case 10:return mp(e.type._context),null;case 22:case 23:return jp(),null;case 24:return null;default:return null}}var yu=!1,vn=!1,SN=typeof WeakSet=="function"?WeakSet:Set,ve=null;function fa(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Nt(t,e,r)}else n.current=null}function HS(t,e,n){try{n()}catch(r){Nt(t,e,r)}}var Sv=!1;function xN(t,e){if(Nf=uc,t=Qw(),lp(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var a=0,u=-1,o=-1,d=0,h=0,f=t,p=null;t:for(;;){for(var g;f!==n||i!==0&&f.nodeType!==3||(u=a+i),f!==s||r!==0&&f.nodeType!==3||(o=a+r),f.nodeType===3&&(a+=f.nodeValue.length),(g=f.firstChild)!==null;)p=f,f=g;for(;;){if(f===t)break t;if(p===n&&++d===i&&(u=a),p===s&&++h===r&&(o=a),(g=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=g}n=u===-1||o===-1?null:{start:u,end:o}}else n=null}n=n||{start:0,end:0}}else n=null;for(Tf={focusedElem:t,selectionRange:n},uc=!1,ve=e;ve!==null;)if(e=ve,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ve=t;else for(;ve!==null;){e=ve;try{var b=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(b!==null){var N=b.memoizedProps,D=b.memoizedState,v=e.stateNode,w=v.getSnapshotBeforeUpdate(e.elementType===e.type?N:ir(e.type,N),D);v.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var C=e.stateNode.containerInfo;C.nodeType===1?C.textContent="":C.nodeType===9&&C.documentElement&&C.removeChild(C.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(oe(163))}}catch(O){Nt(e,e.return,O)}if(t=e.sibling,t!==null){t.return=e.return,ve=t;break}ve=e.return}return b=Sv,Sv=!1,b}function Bo(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&HS(e,n,s)}i=i.next}while(i!==r)}}function od(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Hf(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function qS(t){var e=t.alternate;e!==null&&(t.alternate=null,qS(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Cr],delete e[cl],delete e[Af],delete e[iN],delete e[sN])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function WS(t){return t.tag===5||t.tag===3||t.tag===4}function xv(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||WS(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function qf(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=hc));else if(r!==4&&(t=t.child,t!==null))for(qf(t,e,n),t=t.sibling;t!==null;)qf(t,e,n),t=t.sibling}function Wf(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Wf(t,e,n),t=t.sibling;t!==null;)Wf(t,e,n),t=t.sibling}var on=null,sr=!1;function li(t,e,n){for(n=n.child;n!==null;)GS(t,e,n),n=n.sibling}function GS(t,e,n){if(Nr&&typeof Nr.onCommitFiberUnmount=="function")try{Nr.onCommitFiberUnmount(Zc,n)}catch{}switch(n.tag){case 5:vn||fa(n,e);case 6:var r=on,i=sr;on=null,li(t,e,n),on=r,sr=i,on!==null&&(sr?(t=on,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):on.removeChild(n.stateNode));break;case 18:on!==null&&(sr?(t=on,n=n.stateNode,t.nodeType===8?yh(t.parentNode,n):t.nodeType===1&&yh(t,n),sl(t)):yh(on,n.stateNode));break;case 4:r=on,i=sr,on=n.stateNode.containerInfo,sr=!0,li(t,e,n),on=r,sr=i;break;case 0:case 11:case 14:case 15:if(!vn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&HS(n,e,a),i=i.next}while(i!==r)}li(t,e,n);break;case 1:if(!vn&&(fa(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(u){Nt(n,e,u)}li(t,e,n);break;case 21:li(t,e,n);break;case 22:n.mode&1?(vn=(r=vn)||n.memoizedState!==null,li(t,e,n),vn=r):li(t,e,n);break;default:li(t,e,n)}}function Cv(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new SN),e.forEach(function(r){var i=AN.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function rr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,a=e,u=a;e:for(;u!==null;){switch(u.tag){case 5:on=u.stateNode,sr=!1;break e;case 3:on=u.stateNode.containerInfo,sr=!0;break e;case 4:on=u.stateNode.containerInfo,sr=!0;break e}u=u.return}if(on===null)throw Error(oe(160));GS(s,a,i),on=null,sr=!1;var o=i.alternate;o!==null&&(o.return=null),i.return=null}catch(d){Nt(i,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)QS(e,t),e=e.sibling}function QS(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(rr(e,t),vr(t),r&4){try{Bo(3,t,t.return),od(3,t)}catch(N){Nt(t,t.return,N)}try{Bo(5,t,t.return)}catch(N){Nt(t,t.return,N)}}break;case 1:rr(e,t),vr(t),r&512&&n!==null&&fa(n,n.return);break;case 5:if(rr(e,t),vr(t),r&512&&n!==null&&fa(n,n.return),t.flags&32){var i=t.stateNode;try{tl(i,"")}catch(N){Nt(t,t.return,N)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=n!==null?n.memoizedProps:s,u=t.type,o=t.updateQueue;if(t.updateQueue=null,o!==null)try{u==="input"&&s.type==="radio"&&s.name!=null&&pw(i,s),yf(u,a);var d=yf(u,s);for(a=0;a<o.length;a+=2){var h=o[a],f=o[a+1];h==="style"?ww(i,f):h==="dangerouslySetInnerHTML"?vw(i,f):h==="children"?tl(i,f):Km(i,h,f,d)}switch(u){case"input":hf(i,s);break;case"textarea":gw(i,s);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var g=s.value;g!=null?ga(i,!!s.multiple,g,!1):p!==!!s.multiple&&(s.defaultValue!=null?ga(i,!!s.multiple,s.defaultValue,!0):ga(i,!!s.multiple,s.multiple?[]:"",!1))}i[cl]=s}catch(N){Nt(t,t.return,N)}}break;case 6:if(rr(e,t),vr(t),r&4){if(t.stateNode===null)throw Error(oe(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(N){Nt(t,t.return,N)}}break;case 3:if(rr(e,t),vr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{sl(e.containerInfo)}catch(N){Nt(t,t.return,N)}break;case 4:rr(e,t),vr(t);break;case 13:rr(e,t),vr(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Tp=Mt())),r&4&&Cv(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(vn=(d=vn)||h,rr(e,t),vn=d):rr(e,t),vr(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(ve=t,h=t.child;h!==null;){for(f=ve=h;ve!==null;){switch(p=ve,g=p.child,p.tag){case 0:case 11:case 14:case 15:Bo(4,p,p.return);break;case 1:fa(p,p.return);var b=p.stateNode;if(typeof b.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,b.props=e.memoizedProps,b.state=e.memoizedState,b.componentWillUnmount()}catch(N){Nt(r,n,N)}}break;case 5:fa(p,p.return);break;case 22:if(p.memoizedState!==null){kv(f);continue}}g!==null?(g.return=p,ve=g):kv(f)}h=h.sibling}e:for(h=null,f=t;;){if(f.tag===5){if(h===null){h=f;try{i=f.stateNode,d?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(u=f.stateNode,o=f.memoizedProps.style,a=o!=null&&o.hasOwnProperty("display")?o.display:null,u.style.display=bw("display",a))}catch(N){Nt(t,t.return,N)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(N){Nt(t,t.return,N)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:rr(e,t),vr(t),r&4&&Cv(t);break;case 21:break;default:rr(e,t),vr(t)}}function vr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(WS(n)){var r=n;break e}n=n.return}throw Error(oe(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(tl(i,""),r.flags&=-33);var s=xv(t);Wf(t,s,i);break;case 3:case 4:var a=r.stateNode.containerInfo,u=xv(t);qf(t,u,a);break;default:throw Error(oe(161))}}catch(o){Nt(t,t.return,o)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function CN(t,e,n){ve=t,KS(t)}function KS(t,e,n){for(var r=(t.mode&1)!==0;ve!==null;){var i=ve,s=i.child;if(i.tag===22&&r){var a=i.memoizedState!==null||yu;if(!a){var u=i.alternate,o=u!==null&&u.memoizedState!==null||vn;u=yu;var d=vn;if(yu=a,(vn=o)&&!d)for(ve=i;ve!==null;)a=ve,o=a.child,a.tag===22&&a.memoizedState!==null?Ev(i):o!==null?(o.return=a,ve=o):Ev(i);for(;s!==null;)ve=s,KS(s),s=s.sibling;ve=i,yu=u,vn=d}_v(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ve=s):_v(t)}}function _v(t){for(;ve!==null;){var e=ve;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:vn||od(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!vn)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:ir(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&lv(e,s,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}lv(e,a,n)}break;case 5:var u=e.stateNode;if(n===null&&e.flags&4){n=u;var o=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":o.autoFocus&&n.focus();break;case"img":o.src&&(n.src=o.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&sl(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(oe(163))}vn||e.flags&512&&Hf(e)}catch(p){Nt(e,e.return,p)}}if(e===t){ve=null;break}if(n=e.sibling,n!==null){n.return=e.return,ve=n;break}ve=e.return}}function kv(t){for(;ve!==null;){var e=ve;if(e===t){ve=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ve=n;break}ve=e.return}}function Ev(t){for(;ve!==null;){var e=ve;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{od(4,e)}catch(o){Nt(e,n,o)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(o){Nt(e,i,o)}}var s=e.return;try{Hf(e)}catch(o){Nt(e,s,o)}break;case 5:var a=e.return;try{Hf(e)}catch(o){Nt(e,a,o)}}}catch(o){Nt(e,e.return,o)}if(e===t){ve=null;break}var u=e.sibling;if(u!==null){u.return=e.return,ve=u;break}ve=e.return}}var _N=Math.ceil,Cc=Jr.ReactCurrentDispatcher,Ep=Jr.ReactCurrentOwner,Zn=Jr.ReactCurrentBatchConfig,We=0,tn=null,Ft=null,cn=0,Vn=0,ma=Xi(0),Gt=0,gl=null,Ns=0,ld=0,Np=0,$o=null,An=null,Tp=0,Pa=1/0,Lr=null,_c=!1,Gf=null,Ai=null,vu=!1,xi=null,kc=0,Ho=0,Qf=null,Wu=-1,Gu=0;function kn(){return We&6?Mt():Wu!==-1?Wu:Wu=Mt()}function Di(t){return t.mode&1?We&2&&cn!==0?cn&-cn:oN.transition!==null?(Gu===0&&(Gu=Dw()),Gu):(t=nt,t!==0||(t=window.event,t=t===void 0?16:Uw(t.type)),t):1}function lr(t,e,n,r){if(50<Ho)throw Ho=0,Qf=null,Error(oe(185));Dl(t,n,r),(!(We&2)||t!==tn)&&(t===tn&&(!(We&2)&&(ld|=n),Gt===4&&gi(t,cn)),Rn(t,r),n===1&&We===0&&!(e.mode&1)&&(Pa=Mt()+500,id&&Yi()))}function Rn(t,e){var n=t.callbackNode;oE(t,e);var r=lc(t,t===tn?cn:0);if(r===0)n!==null&&Oy(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Oy(n),e===1)t.tag===0?aN(Nv.bind(null,t)):iS(Nv.bind(null,t)),nN(function(){!(We&6)&&Yi()}),n=null;else{switch(Mw(r)){case 1:n=ep;break;case 4:n=jw;break;case 16:n=oc;break;case 536870912:n=Aw;break;default:n=oc}n=r1(n,XS.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function XS(t,e){if(Wu=-1,Gu=0,We&6)throw Error(oe(327));var n=t.callbackNode;if(Sa()&&t.callbackNode!==n)return null;var r=lc(t,t===tn?cn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Ec(t,r);else{e=r;var i=We;We|=2;var s=JS();(tn!==t||cn!==e)&&(Lr=null,Pa=Mt()+500,ws(t,e));do try{NN();break}catch(u){YS(t,u)}while(!0);fp(),Cc.current=s,We=i,Ft!==null?e=0:(tn=null,cn=0,e=Gt)}if(e!==0){if(e===2&&(i=xf(t),i!==0&&(r=i,e=Kf(t,i))),e===1)throw n=gl,ws(t,0),gi(t,r),Rn(t,Mt()),n;if(e===6)gi(t,r);else{if(i=t.current.alternate,!(r&30)&&!kN(i)&&(e=Ec(t,r),e===2&&(s=xf(t),s!==0&&(r=s,e=Kf(t,s))),e===1))throw n=gl,ws(t,0),gi(t,r),Rn(t,Mt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(oe(345));case 2:hs(t,An,Lr);break;case 3:if(gi(t,r),(r&130023424)===r&&(e=Tp+500-Mt(),10<e)){if(lc(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){kn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=jf(hs.bind(null,t,An,Lr),e);break}hs(t,An,Lr);break;case 4:if(gi(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var a=31-or(r);s=1<<a,a=e[a],a>i&&(i=a),r&=~s}if(r=i,r=Mt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*_N(r/1960))-r,10<r){t.timeoutHandle=jf(hs.bind(null,t,An,Lr),r);break}hs(t,An,Lr);break;case 5:hs(t,An,Lr);break;default:throw Error(oe(329))}}}return Rn(t,Mt()),t.callbackNode===n?XS.bind(null,t):null}function Kf(t,e){var n=$o;return t.current.memoizedState.isDehydrated&&(ws(t,e).flags|=256),t=Ec(t,e),t!==2&&(e=An,An=n,e!==null&&Xf(e)),t}function Xf(t){An===null?An=t:An.push.apply(An,t)}function kN(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!cr(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function gi(t,e){for(e&=~Np,e&=~ld,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-or(e),r=1<<n;t[n]=-1,e&=~r}}function Nv(t){if(We&6)throw Error(oe(327));Sa();var e=lc(t,0);if(!(e&1))return Rn(t,Mt()),null;var n=Ec(t,e);if(t.tag!==0&&n===2){var r=xf(t);r!==0&&(e=r,n=Kf(t,r))}if(n===1)throw n=gl,ws(t,0),gi(t,e),Rn(t,Mt()),n;if(n===6)throw Error(oe(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,hs(t,An,Lr),Rn(t,Mt()),null}function Ip(t,e){var n=We;We|=1;try{return t(e)}finally{We=n,We===0&&(Pa=Mt()+500,id&&Yi())}}function Ts(t){xi!==null&&xi.tag===0&&!(We&6)&&Sa();var e=We;We|=1;var n=Zn.transition,r=nt;try{if(Zn.transition=null,nt=1,t)return t()}finally{nt=r,Zn.transition=n,We=e,!(We&6)&&Yi()}}function jp(){Vn=ma.current,mt(ma)}function ws(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,tN(n)),Ft!==null)for(n=Ft.return;n!==null;){var r=n;switch(cp(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&fc();break;case 3:Da(),mt(Pn),mt(Sn),bp();break;case 5:vp(r);break;case 4:Da();break;case 13:mt(wt);break;case 19:mt(wt);break;case 10:mp(r.type._context);break;case 22:case 23:jp()}n=n.return}if(tn=t,Ft=t=Mi(t.current,null),cn=Vn=e,Gt=0,gl=null,Np=ld=Ns=0,An=$o=null,gs!==null){for(e=0;e<gs.length;e++)if(n=gs[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var a=s.next;s.next=i,r.next=a}n.pending=r}gs=null}return t}function YS(t,e){do{var n=Ft;try{if(fp(),$u.current=xc,Sc){for(var r=St.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Sc=!1}if(Es=0,Zt=Wt=St=null,zo=!1,fl=0,Ep.current=null,n===null||n.return===null){Gt=1,gl=e,Ft=null;break}e:{var s=t,a=n.return,u=n,o=e;if(e=cn,u.flags|=32768,o!==null&&typeof o=="object"&&typeof o.then=="function"){var d=o,h=u,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var g=mv(a);if(g!==null){g.flags&=-257,pv(g,a,u,s,e),g.mode&1&&fv(s,d,e),e=g,o=d;var b=e.updateQueue;if(b===null){var N=new Set;N.add(o),e.updateQueue=N}else b.add(o);break e}else{if(!(e&1)){fv(s,d,e),Ap();break e}o=Error(oe(426))}}else if(yt&&u.mode&1){var D=mv(a);if(D!==null){!(D.flags&65536)&&(D.flags|=256),pv(D,a,u,s,e),dp(Ma(o,u));break e}}s=o=Ma(o,u),Gt!==4&&(Gt=2),$o===null?$o=[s]:$o.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=MS(s,o,e);ov(s,v);break e;case 1:u=o;var w=s.type,C=s.stateNode;if(!(s.flags&128)&&(typeof w.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(Ai===null||!Ai.has(C)))){s.flags|=65536,e&=-e,s.lanes|=e;var O=PS(s,u,e);ov(s,O);break e}}s=s.return}while(s!==null)}e1(n)}catch(R){e=R,Ft===n&&n!==null&&(Ft=n=n.return);continue}break}while(!0)}function JS(){var t=Cc.current;return Cc.current=xc,t===null?xc:t}function Ap(){(Gt===0||Gt===3||Gt===2)&&(Gt=4),tn===null||!(Ns&268435455)&&!(ld&268435455)||gi(tn,cn)}function Ec(t,e){var n=We;We|=2;var r=JS();(tn!==t||cn!==e)&&(Lr=null,ws(t,e));do try{EN();break}catch(i){YS(t,i)}while(!0);if(fp(),We=n,Cc.current=r,Ft!==null)throw Error(oe(261));return tn=null,cn=0,Gt}function EN(){for(;Ft!==null;)ZS(Ft)}function NN(){for(;Ft!==null&&!Jk();)ZS(Ft)}function ZS(t){var e=n1(t.alternate,t,Vn);t.memoizedProps=t.pendingProps,e===null?e1(t):Ft=e,Ep.current=null}function e1(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=wN(n,e),n!==null){n.flags&=32767,Ft=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Gt=6,Ft=null;return}}else if(n=bN(n,e,Vn),n!==null){Ft=n;return}if(e=e.sibling,e!==null){Ft=e;return}Ft=e=t}while(e!==null);Gt===0&&(Gt=5)}function hs(t,e,n){var r=nt,i=Zn.transition;try{Zn.transition=null,nt=1,TN(t,e,n,r)}finally{Zn.transition=i,nt=r}return null}function TN(t,e,n,r){do Sa();while(xi!==null);if(We&6)throw Error(oe(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(oe(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(lE(t,s),t===tn&&(Ft=tn=null,cn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||vu||(vu=!0,r1(oc,function(){return Sa(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Zn.transition,Zn.transition=null;var a=nt;nt=1;var u=We;We|=4,Ep.current=null,xN(t,n),QS(n,t),QE(Tf),uc=!!Nf,Tf=Nf=null,t.current=n,CN(n),Zk(),We=u,nt=a,Zn.transition=s}else t.current=n;if(vu&&(vu=!1,xi=t,kc=i),s=t.pendingLanes,s===0&&(Ai=null),nE(n.stateNode),Rn(t,Mt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(_c)throw _c=!1,t=Gf,Gf=null,t;return kc&1&&t.tag!==0&&Sa(),s=t.pendingLanes,s&1?t===Qf?Ho++:(Ho=0,Qf=t):Ho=0,Yi(),null}function Sa(){if(xi!==null){var t=Mw(kc),e=Zn.transition,n=nt;try{if(Zn.transition=null,nt=16>t?16:t,xi===null)var r=!1;else{if(t=xi,xi=null,kc=0,We&6)throw Error(oe(331));var i=We;for(We|=4,ve=t.current;ve!==null;){var s=ve,a=s.child;if(ve.flags&16){var u=s.deletions;if(u!==null){for(var o=0;o<u.length;o++){var d=u[o];for(ve=d;ve!==null;){var h=ve;switch(h.tag){case 0:case 11:case 15:Bo(8,h,s)}var f=h.child;if(f!==null)f.return=h,ve=f;else for(;ve!==null;){h=ve;var p=h.sibling,g=h.return;if(qS(h),h===d){ve=null;break}if(p!==null){p.return=g,ve=p;break}ve=g}}}var b=s.alternate;if(b!==null){var N=b.child;if(N!==null){b.child=null;do{var D=N.sibling;N.sibling=null,N=D}while(N!==null)}}ve=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,ve=a;else e:for(;ve!==null;){if(s=ve,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Bo(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,ve=v;break e}ve=s.return}}var w=t.current;for(ve=w;ve!==null;){a=ve;var C=a.child;if(a.subtreeFlags&2064&&C!==null)C.return=a,ve=C;else e:for(a=w;ve!==null;){if(u=ve,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:od(9,u)}}catch(R){Nt(u,u.return,R)}if(u===a){ve=null;break e}var O=u.sibling;if(O!==null){O.return=u.return,ve=O;break e}ve=u.return}}if(We=i,Yi(),Nr&&typeof Nr.onPostCommitFiberRoot=="function")try{Nr.onPostCommitFiberRoot(Zc,t)}catch{}r=!0}return r}finally{nt=n,Zn.transition=e}}return!1}function Tv(t,e,n){e=Ma(n,e),e=MS(t,e,1),t=ji(t,e,1),e=kn(),t!==null&&(Dl(t,1,e),Rn(t,e))}function Nt(t,e,n){if(t.tag===3)Tv(t,t,n);else for(;e!==null;){if(e.tag===3){Tv(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ai===null||!Ai.has(r))){t=Ma(n,t),t=PS(e,t,1),e=ji(e,t,1),t=kn(),e!==null&&(Dl(e,1,t),Rn(e,t));break}}e=e.return}}function IN(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=kn(),t.pingedLanes|=t.suspendedLanes&n,tn===t&&(cn&n)===n&&(Gt===4||Gt===3&&(cn&130023424)===cn&&500>Mt()-Tp?ws(t,0):Np|=n),Rn(t,e)}function t1(t,e){e===0&&(t.mode&1?(e=lu,lu<<=1,!(lu&130023424)&&(lu=4194304)):e=1);var n=kn();t=Wr(t,e),t!==null&&(Dl(t,e,n),Rn(t,n))}function jN(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),t1(t,n)}function AN(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(oe(314))}r!==null&&r.delete(e),t1(t,n)}var n1;n1=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Pn.current)Mn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Mn=!1,vN(t,e,n);Mn=!!(t.flags&131072)}else Mn=!1,yt&&e.flags&1048576&&sS(e,gc,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;qu(t,e),t=e.pendingProps;var i=Ia(e,Sn.current);wa(e,n),i=Sp(null,e,r,t,i,n);var s=xp();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,On(r)?(s=!0,mc(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,gp(e),i.updater=ad,e.stateNode=i,i._reactInternals=e,Lf(e,r,t,n),e=Vf(null,e,r,!0,s,n)):(e.tag=0,yt&&s&&up(e),_n(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(qu(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=MN(r),t=ir(r,t),i){case 0:e=Uf(null,e,r,t,n);break e;case 1:e=vv(null,e,r,t,n);break e;case 11:e=gv(null,e,r,t,n);break e;case 14:e=yv(null,e,r,ir(r.type,t),n);break e}throw Error(oe(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ir(r,i),Uf(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ir(r,i),vv(t,e,r,i,n);case 3:e:{if(FS(e),t===null)throw Error(oe(387));r=e.pendingProps,s=e.memoizedState,i=s.element,dS(t,e),bc(e,r,null,n);var a=e.memoizedState;if(r=a.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Ma(Error(oe(423)),e),e=bv(t,e,r,n,i);break e}else if(r!==i){i=Ma(Error(oe(424)),e),e=bv(t,e,r,n,i);break e}else for(zn=Ii(e.stateNode.containerInfo.firstChild),Hn=e,yt=!0,ar=null,n=uS(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ja(),r===i){e=Gr(t,e,n);break e}_n(t,e,r,n)}e=e.child}return e;case 5:return hS(e),t===null&&Pf(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,If(r,i)?a=null:s!==null&&If(r,s)&&(e.flags|=32),LS(t,e),_n(t,e,a,n),e.child;case 6:return t===null&&Pf(e),null;case 13:return US(t,e,n);case 4:return yp(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Aa(e,null,r,n):_n(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ir(r,i),gv(t,e,r,i,n);case 7:return _n(t,e,e.pendingProps,n),e.child;case 8:return _n(t,e,e.pendingProps.children,n),e.child;case 12:return _n(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,ot(yc,r._currentValue),r._currentValue=a,s!==null)if(cr(s.value,a)){if(s.children===i.children&&!Pn.current){e=Gr(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var u=s.dependencies;if(u!==null){a=s.child;for(var o=u.firstContext;o!==null;){if(o.context===r){if(s.tag===1){o=Br(-1,n&-n),o.tag=2;var d=s.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?o.next=o:(o.next=h.next,h.next=o),d.pending=o}}s.lanes|=n,o=s.alternate,o!==null&&(o.lanes|=n),Of(s.return,n,e),u.lanes|=n;break}o=o.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(oe(341));a.lanes|=n,u=a.alternate,u!==null&&(u.lanes|=n),Of(a,n,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}_n(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,wa(e,n),i=er(i),r=r(i),e.flags|=1,_n(t,e,r,n),e.child;case 14:return r=e.type,i=ir(r,e.pendingProps),i=ir(r.type,i),yv(t,e,r,i,n);case 15:return OS(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ir(r,i),qu(t,e),e.tag=1,On(r)?(t=!0,mc(e)):t=!1,wa(e,n),DS(e,r,i),Lf(e,r,i,n),Vf(null,e,r,!0,t,n);case 19:return VS(t,e,n);case 22:return RS(t,e,n)}throw Error(oe(156,e.tag))};function r1(t,e){return Iw(t,e)}function DN(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Jn(t,e,n,r){return new DN(t,e,n,r)}function Dp(t){return t=t.prototype,!(!t||!t.isReactComponent)}function MN(t){if(typeof t=="function")return Dp(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Ym)return 11;if(t===Jm)return 14}return 2}function Mi(t,e){var n=t.alternate;return n===null?(n=Jn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Qu(t,e,n,r,i,s){var a=2;if(r=t,typeof t=="function")Dp(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case ia:return Ss(n.children,i,s,e);case Xm:a=8,i|=8;break;case of:return t=Jn(12,n,e,i|2),t.elementType=of,t.lanes=s,t;case lf:return t=Jn(13,n,e,i),t.elementType=lf,t.lanes=s,t;case uf:return t=Jn(19,n,e,i),t.elementType=uf,t.lanes=s,t;case hw:return ud(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case cw:a=10;break e;case dw:a=9;break e;case Ym:a=11;break e;case Jm:a=14;break e;case fi:a=16,r=null;break e}throw Error(oe(130,t==null?t:typeof t,""))}return e=Jn(a,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Ss(t,e,n,r){return t=Jn(7,t,r,e),t.lanes=n,t}function ud(t,e,n,r){return t=Jn(22,t,r,e),t.elementType=hw,t.lanes=n,t.stateNode={isHidden:!1},t}function kh(t,e,n){return t=Jn(6,t,null,e),t.lanes=n,t}function Eh(t,e,n){return e=Jn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function PN(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ah(0),this.expirationTimes=ah(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ah(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Mp(t,e,n,r,i,s,a,u,o){return t=new PN(t,e,n,u,o),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Jn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},gp(s),t}function ON(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ra,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function i1(t){if(!t)return Vi;t=t._reactInternals;e:{if(Ls(t)!==t||t.tag!==1)throw Error(oe(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(On(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(oe(171))}if(t.tag===1){var n=t.type;if(On(n))return rS(t,n,e)}return e}function s1(t,e,n,r,i,s,a,u,o){return t=Mp(n,r,!0,t,i,s,a,u,o),t.context=i1(null),n=t.current,r=kn(),i=Di(n),s=Br(r,i),s.callback=e??null,ji(n,s,i),t.current.lanes=i,Dl(t,i,r),Rn(t,r),t}function cd(t,e,n,r){var i=e.current,s=kn(),a=Di(i);return n=i1(n),e.context===null?e.context=n:e.pendingContext=n,e=Br(s,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ji(i,e,a),t!==null&&(lr(t,i,a,s),Bu(t,i,a)),a}function Nc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Iv(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Pp(t,e){Iv(t,e),(t=t.alternate)&&Iv(t,e)}function RN(){return null}var a1=typeof reportError=="function"?reportError:function(t){console.error(t)};function Op(t){this._internalRoot=t}dd.prototype.render=Op.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(oe(409));cd(t,e,null,null)};dd.prototype.unmount=Op.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ts(function(){cd(null,t,null,null)}),e[qr]=null}};function dd(t){this._internalRoot=t}dd.prototype.unstable_scheduleHydration=function(t){if(t){var e=Rw();t={blockedOn:null,target:t,priority:e};for(var n=0;n<pi.length&&e!==0&&e<pi[n].priority;n++);pi.splice(n,0,t),n===0&&Fw(t)}};function Rp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function hd(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function jv(){}function LN(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var d=Nc(a);s.call(d)}}var a=s1(e,r,t,0,null,!1,!1,"",jv);return t._reactRootContainer=a,t[qr]=a.current,ll(t.nodeType===8?t.parentNode:t),Ts(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var u=r;r=function(){var d=Nc(o);u.call(d)}}var o=Mp(t,0,!1,null,null,!1,!1,"",jv);return t._reactRootContainer=o,t[qr]=o.current,ll(t.nodeType===8?t.parentNode:t),Ts(function(){cd(e,o,n,r)}),o}function fd(t,e,n,r,i){var s=n._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var u=i;i=function(){var o=Nc(a);u.call(o)}}cd(e,a,t,i)}else a=LN(n,e,t,i,r);return Nc(a)}Pw=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Io(e.pendingLanes);n!==0&&(tp(e,n|1),Rn(e,Mt()),!(We&6)&&(Pa=Mt()+500,Yi()))}break;case 13:Ts(function(){var r=Wr(t,1);if(r!==null){var i=kn();lr(r,t,1,i)}}),Pp(t,1)}};np=function(t){if(t.tag===13){var e=Wr(t,134217728);if(e!==null){var n=kn();lr(e,t,134217728,n)}Pp(t,134217728)}};Ow=function(t){if(t.tag===13){var e=Di(t),n=Wr(t,e);if(n!==null){var r=kn();lr(n,t,e,r)}Pp(t,e)}};Rw=function(){return nt};Lw=function(t,e){var n=nt;try{return nt=t,e()}finally{nt=n}};bf=function(t,e,n){switch(e){case"input":if(hf(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=rd(r);if(!i)throw Error(oe(90));mw(r),hf(r,i)}}}break;case"textarea":gw(t,n);break;case"select":e=n.value,e!=null&&ga(t,!!n.multiple,e,!1)}};Cw=Ip;_w=Ts;var FN={usingClientEntryPoint:!1,Events:[Pl,la,rd,Sw,xw,Ip]},wo={findFiberByHostInstance:ps,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},UN={bundleType:wo.bundleType,version:wo.version,rendererPackageName:wo.rendererPackageName,rendererConfig:wo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Jr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Nw(t),t===null?null:t.stateNode},findFiberByHostInstance:wo.findFiberByHostInstance||RN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bu.isDisabled&&bu.supportsFiber)try{Zc=bu.inject(UN),Nr=bu}catch{}}Wn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=FN;Wn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Rp(e))throw Error(oe(200));return ON(t,e,null,n)};Wn.createRoot=function(t,e){if(!Rp(t))throw Error(oe(299));var n=!1,r="",i=a1;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Mp(t,1,!1,null,null,n,!1,r,i),t[qr]=e.current,ll(t.nodeType===8?t.parentNode:t),new Op(e)};Wn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(oe(188)):(t=Object.keys(t).join(","),Error(oe(268,t)));return t=Nw(e),t=t===null?null:t.stateNode,t};Wn.flushSync=function(t){return Ts(t)};Wn.hydrate=function(t,e,n){if(!hd(e))throw Error(oe(200));return fd(null,t,e,!0,n)};Wn.hydrateRoot=function(t,e,n){if(!Rp(t))throw Error(oe(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",a=a1;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=s1(e,null,t,1,n??null,i,!1,s,a),t[qr]=e.current,ll(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new dd(e)};Wn.render=function(t,e,n){if(!hd(e))throw Error(oe(200));return fd(null,t,e,!1,n)};Wn.unmountComponentAtNode=function(t){if(!hd(t))throw Error(oe(40));return t._reactRootContainer?(Ts(function(){fd(null,null,t,!1,function(){t._reactRootContainer=null,t[qr]=null})}),!0):!1};Wn.unstable_batchedUpdates=Ip;Wn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!hd(n))throw Error(oe(200));if(t==null||t._reactInternals===void 0)throw Error(oe(38));return fd(t,e,n,!1,r)};Wn.version="18.3.1-next-f1338f8080-20240426";function o1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o1)}catch(t){console.error(t)}}o1(),aw.exports=Wn;var l1=aw.exports,Av=l1;sf.createRoot=Av.createRoot,sf.hydrateRoot=Av.hydrateRoot;/**
* @remix-run/router v1.23.0
*
* Copyright (c) Remix Software Inc.
*
* This source code is licensed under the MIT license found in the
* LICENSE.md file in the root directory of this source tree.
*
* @license MIT
*/function yl(){return yl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},yl.apply(this,arguments)}var Ci;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Ci||(Ci={}));const Dv="popstate";function VN(t){t===void 0&&(t={});function e(i,s){let{pathname:a="/",search:u="",hash:o=""}=Fs(i.location.hash.substr(1));return!a.startsWith("/")&&!a.startsWith(".")&&(a="/"+a),Yf("",{pathname:a,search:u,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(i,s){let a=i.document.querySelector("base"),u="";if(a&&a.getAttribute("href")){let o=i.location.href,d=o.indexOf("#");u=d===-1?o:o.slice(0,d)}return u+"#"+(typeof s=="string"?s:Tc(s))}function r(i,s){Lp(i.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(s)+")")}return BN(e,n,r,t)}function xt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Lp(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function zN(){return Math.random().toString(36).substr(2,8)}function Mv(t,e){return{usr:t.state,key:t.key,idx:e}}function Yf(t,e,n,r){return n===void 0&&(n=null),yl({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Fs(e):e,{state:n,key:e&&e.key||r||zN()})}function Tc(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Fs(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function BN(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,a=i.history,u=Ci.Pop,o=null,d=h();d==null&&(d=0,a.replaceState(yl({},a.state,{idx:d}),""));function h(){return(a.state||{idx:null}).idx}function f(){u=Ci.Pop;let D=h(),v=D==null?null:D-d;d=D,o&&o({action:u,location:N.location,delta:v})}function p(D,v){u=Ci.Push;let w=Yf(N.location,D,v);n&&n(w,D),d=h()+1;let C=Mv(w,d),O=N.createHref(w);try{a.pushState(C,"",O)}catch(R){if(R instanceof DOMException&&R.name==="DataCloneError")throw R;i.location.assign(O)}s&&o&&o({action:u,location:N.location,delta:1})}function g(D,v){u=Ci.Replace;let w=Yf(N.location,D,v);n&&n(w,D),d=h();let C=Mv(w,d),O=N.createHref(w);a.replaceState(C,"",O),s&&o&&o({action:u,location:N.location,delta:0})}function b(D){let v=i.location.origin!=="null"?i.location.origin:i.location.href,w=typeof D=="string"?D:Tc(D);return w=w.replace(/ $/,"%20"),xt(v,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,v)}let N={get action(){return u},get location(){return t(i,a)},listen(D){if(o)throw new Error("A history only accepts one active listener");return i.addEventListener(Dv,f),o=D,()=>{i.removeEventListener(Dv,f),o=null}},createHref(D){return e(i,D)},createURL:b,encodeLocation(D){let v=b(D);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:p,replace:g,go(D){return a.go(D)}};return N}var Pv;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Pv||(Pv={}));function $N(t,e,n){return n===void 0&&(n="/"),HN(t,e,n)}function HN(t,e,n,r){let i=typeof e=="string"?Fs(e):e,s=Oa(i.pathname||"/",n);if(s==null)return null;let a=u1(t);qN(a);let u=null;for(let o=0;u==null&&o<a.length;++o){let d=nT(s);u=eT(a[o],d)}return u}function u1(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(s,a,u)=>{let o={relativePath:u===void 0?s.path||"":u,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};o.relativePath.startsWith("/")&&(xt(o.relativePath.startsWith(r),'Absolute route path "'+o.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),o.relativePath=o.relativePath.slice(r.length));let d=Pi([r,o.relativePath]),h=n.concat(o);s.children&&s.children.length>0&&(xt(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),u1(s.children,e,h,d)),!(s.path==null&&!s.index)&&e.push({path:d,score:JN(d,s.index),routesMeta:h})};return t.forEach((s,a)=>{var u;if(s.path===""||!((u=s.path)!=null&&u.includes("?")))i(s,a);else for(let o of c1(s.path))i(s,a,o)}),e}function c1(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let a=c1(r.join("/")),u=[];return u.push(...a.map(o=>o===""?s:[s,o].join("/"))),i&&u.push(...a),u.map(o=>t.startsWith("/")&&o===""?"/":o)}function qN(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:ZN(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const WN=/^:[\w-]+$/,GN=3,QN=2,KN=1,XN=10,YN=-2,Ov=t=>t==="*";function JN(t,e){let n=t.split("/"),r=n.length;return n.some(Ov)&&(r+=YN),e&&(r+=QN),n.filter(i=>!Ov(i)).reduce((i,s)=>i+(WN.test(s)?GN:s===""?KN:XN),r)}function ZN(t,e){return t.length===e.length&&t.slice(0,-1).every((n,r)=>n===e[r])?t[t.length-1]-e[e.length-1]:0}function eT(t,e,n){let{routesMeta:r}=t,i={},s="/",a=[];for(let u=0;u<r.length;++u){let o=r[u],d=u===r.length-1,h=s==="/"?e:e.slice(s.length)||"/",f=Jf({path:o.relativePath,caseSensitive:o.caseSensitive,end:d},h),p=o.route;if(!f)return null;Object.assign(i,f.params),a.push({params:i,pathname:Pi([s,f.pathname]),pathnameBase:aT(Pi([s,f.pathnameBase])),route:p}),f.pathnameBase!=="/"&&(s=Pi([s,f.pathnameBase]))}return a}function Jf(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=tT(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let s=i[0],a=s.replace(/(.)\/+$/,"$1"),u=i.slice(1);return{params:r.reduce((o,d,h)=>{let{paramName:f,isOptional:p}=d;if(f==="*"){let b=u[h]||"";a=s.slice(0,s.length-b.length).replace(/(.)\/+$/,"$1")}const g=u[h];return p&&!g?o[f]=void 0:o[f]=(g||"").replace(/%2F/g,"/"),o},{}),pathname:s,pathnameBase:a,pattern:t}}function tT(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Lp(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,a,u)=>(r.push({paramName:a,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function nT(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Lp(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Oa(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function rT(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?Fs(t):t;return{pathname:n?n.startsWith("/")?n:iT(n,e):e,search:oT(r),hash:lT(i)}}function iT(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function Nh(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function sT(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Fp(t,e){let n=sT(t);return e?n.map((r,i)=>i===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function Up(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=Fs(t):(i=yl({},t),xt(!i.pathname||!i.pathname.includes("?"),Nh("?","pathname","search",i)),xt(!i.pathname||!i.pathname.includes("#"),Nh("#","pathname","hash",i)),xt(!i.search||!i.search.includes("#"),Nh("#","search","hash",i)));let s=t===""||i.pathname==="",a=s?"/":i.pathname,u;if(a==null)u=n;else{let f=e.length-1;if(!r&&a.startsWith("..")){let p=a.split("/");for(;p[0]==="..";)p.shift(),f-=1;i.pathname=p.join("/")}u=f>=0?e[f]:"/"}let o=rT(i,u),d=a&&a!=="/"&&a.endsWith("/"),h=(s||a===".")&&n.endsWith("/");return!o.pathname.endsWith("/")&&(d||h)&&(o.pathname+="/"),o}const Pi=t=>t.join("/").replace(/\/\/+/g,"/"),aT=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),oT=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,lT=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function uT(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const d1=["post","put","patch","delete"];new Set(d1);const cT=["get",...d1];new Set(cT);/**
* React Router v6.30.1
*
* Copyright (c) Remix Software Inc.
*
* This source code is licensed under the MIT license found in the
* LICENSE.md file in the root directory of this source tree.
*
* @license MIT
*/function vl(){return vl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},vl.apply(this,arguments)}const md=k.createContext(null),h1=k.createContext(null),Zr=k.createContext(null),pd=k.createContext(null),ei=k.createContext({outlet:null,matches:[],isDataRoute:!1}),f1=k.createContext(null);function dT(t,e){let{relative:n}=e===void 0?{}:e;Ga()||xt(!1);let{basename:r,navigator:i}=k.useContext(Zr),{hash:s,pathname:a,search:u}=gd(t,{relative:n}),o=a;return r!=="/"&&(o=a==="/"?r:Pi([r,a])),i.createHref({pathname:o,search:u,hash:s})}function Ga(){return k.useContext(pd)!=null}function Us(){return Ga()||xt(!1),k.useContext(pd).location}function m1(t){k.useContext(Zr).static||k.useLayoutEffect(t)}function Qa(){let{isDataRoute:t}=k.useContext(ei);return t?kT():hT()}function hT(){Ga()||xt(!1);let t=k.useContext(md),{basename:e,future:n,navigator:r}=k.useContext(Zr),{matches:i}=k.useContext(ei),{pathname:s}=Us(),a=JSON.stringify(Fp(i,n.v7_relativeSplatPath)),u=k.useRef(!1);return m1(()=>{u.current=!0}),k.useCallback(function(o,d){if(d===void 0&&(d={}),!u.current)return;if(typeof o=="number"){r.go(o);return}let h=Up(o,JSON.parse(a),s,d.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Pi([e,h.pathname])),(d.replace?r.replace:r.push)(h,d.state,d)},[e,r,a,s,t])}function fT(){let{matches:t}=k.useContext(ei),e=t[t.length-1];return e?e.params:{}}function gd(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=k.useContext(Zr),{matches:i}=k.useContext(ei),{pathname:s}=Us(),a=JSON.stringify(Fp(i,r.v7_relativeSplatPath));return k.useMemo(()=>Up(t,JSON.parse(a),s,n==="path"),[t,a,s,n])}function mT(t,e){return pT(t,e)}function pT(t,e,n,r){Ga()||xt(!1);let{navigator:i}=k.useContext(Zr),{matches:s}=k.useContext(ei),a=s[s.length-1],u=a?a.params:{};a&&a.pathname;let o=a?a.pathnameBase:"/";a&&a.route;let d=Us(),h;if(e){var f;let D=typeof e=="string"?Fs(e):e;o==="/"||(f=D.pathname)!=null&&f.startsWith(o)||xt(!1),h=D}else h=d;let p=h.pathname||"/",g=p;if(o!=="/"){let D=o.replace(/^\//,"").split("/");g="/"+p.replace(/^\//,"").split("/").slice(D.length).join("/")}let b=$N(t,{pathname:g}),N=wT(b&&b.map(D=>Object.assign({},D,{params:Object.assign({},u,D.params),pathname:Pi([o,i.encodeLocation?i.encodeLocation(D.pathname).pathname:D.pathname]),pathnameBase:D.pathnameBase==="/"?o:Pi([o,i.encodeLocation?i.encodeLocation(D.pathnameBase).pathname:D.pathnameBase])})),s,n,r);return e&&N?k.createElement(pd.Provider,{value:{location:vl({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:Ci.Pop}},N):N}function gT(){let t=_T(),e=uT(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return k.createElement(k.Fragment,null,k.createElement("h2",null,"Unexpected Application Error!"),k.createElement("h3",{style:{fontStyle:"italic"}},e),n?k.createElement("pre",{style:r},n):null,null)}const yT=k.createElement(gT,null);class vT extends k.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?k.createElement(ei.Provider,{value:this.props.routeContext},k.createElement(f1.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function bT(t){let{routeContext:e,match:n,children:r}=t,i=k.useContext(md);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),k.createElement(ei.Provider,{value:e},r)}function wT(t,e,n,r){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var s;if(!n)return null;if(n.errors)t=n.matches;else if((s=r)!=null&&s.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let a=t,u=(i=n)==null?void 0:i.errors;if(u!=null){let h=a.findIndex(f=>f.route.id&&(u==null?void 0:u[f.route.id])!==void 0);h>=0||xt(!1),a=a.slice(0,Math.min(a.length,h+1))}let o=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let h=0;h<a.length;h++){let f=a[h];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(d=h),f.route.id){let{loaderData:p,errors:g}=n,b=f.route.loader&&p[f.route.id]===void 0&&(!g||g[f.route.id]===void 0);if(f.route.lazy||b){o=!0,d>=0?a=a.slice(0,d+1):a=[a[0]];break}}}return a.reduceRight((h,f,p)=>{let g,b=!1,N=null,D=null;n&&(g=u&&f.route.id?u[f.route.id]:void 0,N=f.route.errorElement||yT,o&&(d<0&&p===0?(ET("route-fallback"),b=!0,D=null):d===p&&(b=!0,D=f.route.hydrateFallbackElement||null)));let v=e.concat(a.slice(0,p+1)),w=()=>{let C;return g?C=N:b?C=D:f.route.Component?C=k.createElement(f.route.Component,null):f.route.element?C=f.route.element:C=h,k.createElement(bT,{match:f,routeContext:{outlet:h,matches:v,isDataRoute:n!=null},children:C})};return n&&(f.route.ErrorBoundary||f.route.errorElement||p===0)?k.createElement(vT,{location:n.location,revalidation:n.revalidation,component:N,error:g,children:w(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):w()},null)}var p1=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(p1||{}),g1=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(g1||{});function ST(t){let e=k.useContext(md);return e||xt(!1),e}function xT(t){let e=k.useContext(h1);return e||xt(!1),e}function CT(t){let e=k.useContext(ei);return e||xt(!1),e}function y1(t){let e=CT(),n=e.matches[e.matches.length-1];return n.route.id||xt(!1),n.route.id}function _T(){var t;let e=k.useContext(f1),n=xT(),r=y1();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function kT(){let{router:t}=ST(p1.UseNavigateStable),e=y1(g1.UseNavigateStable),n=k.useRef(!1);return m1(()=>{n.current=!0}),k.useCallback(function(r,i){i===void 0&&(i={}),n.current&&(typeof r=="number"?t.navigate(r):t.navigate(r,vl({fromRouteId:e},i)))},[t,e])}const Rv={};function ET(t,e,n){Rv[t]||(Rv[t]=!0)}function NT(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function TT(t){let{to:e,replace:n,state:r,relative:i}=t;Ga()||xt(!1);let{future:s,static:a}=k.useContext(Zr),{matches:u}=k.useContext(ei),{pathname:o}=Us(),d=Qa(),h=Up(e,Fp(u,s.v7_relativeSplatPath),o,i==="path"),f=JSON.stringify(h);return k.useEffect(()=>d(JSON.parse(f),{replace:n,state:r,relative:i}),[d,f,i,n,r]),null}function hi(t){xt(!1)}function IT(t){let{basename:e="/",children:n=null,location:r,navigationType:i=Ci.Pop,navigator:s,static:a=!1,future:u}=t;Ga()&&xt(!1);let o=e.replace(/^\/*/,"/"),d=k.useMemo(()=>({basename:o,navigator:s,static:a,future:vl({v7_relativeSplatPath:!1},u)}),[o,u,s,a]);typeof r=="string"&&(r=Fs(r));let{pathname:h="/",search:f="",hash:p="",state:g=null,key:b="default"}=r,N=k.useMemo(()=>{let D=Oa(h,o);return D==null?null:{location:{pathname:D,search:f,hash:p,state:g,key:b},navigationType:i}},[o,h,f,p,g,b,i]);return N==null?null:k.createElement(Zr.Provider,{value:d},k.createElement(pd.Provider,{children:n,value:N}))}function jT(t){let{children:e,location:n}=t;return mT(Zf(e),n)}new Promise(()=>{});function Zf(t,e){e===void 0&&(e=[]);let n=[];return k.Children.forEach(t,(r,i)=>{if(!k.isValidElement(r))return;let s=[...e,i];if(r.type===k.Fragment){n.push.apply(n,Zf(r.props.children,s));return}r.type!==hi&&xt(!1),!r.props.index||!r.props.children||xt(!1);let a={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=Zf(r.props.children,s)),n.push(a)}),n}/**
* React Router DOM v6.30.1
*
* Copyright (c) Remix Software Inc.
*
* This source code is licensed under the MIT license found in the
* LICENSE.md file in the root directory of this source tree.
*
* @license MIT
*/function Ic(){return Ic=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ic.apply(this,arguments)}function v1(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function AT(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function DT(t,e){return t.button===0&&(!e||e==="_self")&&!AT(t)}const MT=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],PT=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],OT="6";try{window.__reactRouterVersion=OT}catch{}const RT=k.createContext({isTransitioning:!1}),LT="startTransition",Lv=Ik[LT];function FT(t){let{basename:e,children:n,future:r,window:i}=t,s=k.useRef();s.current==null&&(s.current=VN({window:i,v5Compat:!0}));let a=s.current,[u,o]=k.useState({action:a.action,location:a.location}),{v7_startTransition:d}=r||{},h=k.useCallback(f=>{d&&Lv?Lv(()=>o(f)):o(f)},[o,d]);return k.useLayoutEffect(()=>a.listen(h),[a,h]),k.useEffect(()=>NT(r),[r]),k.createElement(IT,{basename:e,children:n,location:u.location,navigationType:u.action,navigator:a,future:r})}const UT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",VT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,zT=k.forwardRef(function(t,e){let{onClick:n,relative:r,reloadDocument:i,replace:s,state:a,target:u,to:o,preventScrollReset:d,viewTransition:h}=t,f=v1(t,MT),{basename:p}=k.useContext(Zr),g,b=!1;if(typeof o=="string"&&VT.test(o)&&(g=o,UT))try{let w=new URL(window.location.href),C=o.startsWith("//")?new URL(w.protocol+o):new URL(o),O=Oa(C.pathname,p);C.origin===w.origin&&O!=null?o=O+C.search+C.hash:b=!0}catch{}let N=dT(o,{relative:r}),D=$T(o,{replace:s,state:a,target:u,preventScrollReset:d,relative:r,viewTransition:h});function v(w){n&&n(w),w.defaultPrevented||D(w)}return k.createElement("a",Ic({},f,{href:g||N,onClick:b||i?n:v,ref:e,target:u}))}),So=k.forwardRef(function(t,e){let{"aria-current":n="page",caseSensitive:r=!1,className:i="",end:s=!1,style:a,to:u,viewTransition:o,children:d}=t,h=v1(t,PT),f=gd(u,{relative:h.relative}),p=Us(),g=k.useContext(h1),{navigator:b,basename:N}=k.useContext(Zr),D=g!=null&&HT(f)&&o===!0,v=b.encodeLocation?b.encodeLocation(f).pathname:f.pathname,w=p.pathname,C=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;r||(w=w.toLowerCase(),C=C?C.toLowerCase():null,v=v.toLowerCase()),C&&N&&(C=Oa(C,N)||C);const O=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let R=w===v||!s&&w.startsWith(v)&&w.charAt(O)==="/",F=C!=null&&(C===v||!s&&C.startsWith(v)&&C.charAt(v.length)==="/"),E={isActive:R,isPending:F,isTransitioning:D},x=R?n:void 0,j;typeof i=="function"?j=i(E):j=[i,R?"active":null,F?"pending":null,D?"transitioning":null].filter(Boolean).join(" ");let S=typeof a=="function"?a(E):a;return k.createElement(zT,Ic({},h,{"aria-current":x,className:j,ref:e,style:S,to:u,viewTransition:o}),typeof d=="function"?d(E):d)});var em;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(em||(em={}));var Fv;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Fv||(Fv={}));function BT(t){let e=k.useContext(md);return e||xt(!1),e}function $T(t,e){let{target:n,replace:r,state:i,preventScrollReset:s,relative:a,viewTransition:u}=e===void 0?{}:e,o=Qa(),d=Us(),h=gd(t,{relative:a});return k.useCallback(f=>{if(DT(f,n)){f.preventDefault();let p=r!==void 0?r:Tc(d)===Tc(h);o(t,{replace:p,state:i,preventScrollReset:s,relative:a,viewTransition:u})}},[d,o,h,r,i,n,t,s,a,u])}function HT(t,e){e===void 0&&(e={});let n=k.useContext(RT);n==null&&xt(!1);let{basename:r}=BT(em.useViewTransitionState),i=gd(t,{relative:e.relative});if(!n.isTransitioning)return!1;let s=Oa(n.currentLocation.pathname,r)||n.currentLocation.pathname,a=Oa(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Jf(i.pathname,a)!=null||Jf(i.pathname,s)!=null}function qT(t={}){const{nonce:e,onScriptLoadSuccess:n,onScriptLoadError:r}=t,[i,s]=k.useState(!1),a=k.useRef(n);a.current=n;const u=k.useRef(r);return u.current=r,k.useEffect(()=>{const o=document.createElement("script");return o.src="https://accounts.google.com/gsi/client",o.async=!0,o.defer=!0,o.nonce=e,o.onload=()=>{var d;s(!0),(d=a.current)===null||d===void 0||d.call(a)},o.onerror=()=>{var d;s(!1),(d=u.current)===null||d===void 0||d.call(u)},document.body.appendChild(o),()=>{document.body.removeChild(o)}},[e]),i}const WT=k.createContext(null);function GT({clientId:t,nonce:e,onScriptLoadSuccess:n,onScriptLoadError:r,children:i}){const s=qT({nonce:e,onScriptLoadSuccess:n,onScriptLoadError:r}),a=k.useMemo(()=>({clientId:t,scriptLoadedSuccessfully:s}),[t,s]);return $e.createElement(WT.Provider,{value:a},i)}const QT=()=>{};var Uv={};/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const b1=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},KT=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],a=t[n++],u=t[n++],o=((i&7)<<18|(s&63)<<12|(a&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(o>>10)),e[r++]=String.fromCharCode(56320+(o&1023))}else{const s=t[n++],a=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},w1={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],a=i+1<t.length,u=a?t[i+1]:0,o=i+2<t.length,d=o?t[i+2]:0,h=s>>2,f=(s&3)<<4|u>>4;let p=(u&15)<<2|d>>6,g=d&63;o||(g=64,a||(p=64)),r.push(n[h],n[f],n[p],n[g])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(b1(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):KT(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const o=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||u==null||o==null)throw new XT;const d=s<<2|a>>4;if(r.push(d),u!==64){const h=a<<4&240|u>>2;if(r.push(h),o!==64){const f=u<<6&192|o;r.push(f)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class XT extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const YT=function(t){const e=b1(t);return w1.encodeByteArray(e,!0)},jc=function(t){return YT(t).replace(/\./g,"")},S1=function(t){try{return w1.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function JT(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const ZT=()=>JT().__FIREBASE_DEFAULTS__,e2=()=>{if(typeof process>"u"||typeof Uv>"u")return;const t=Uv.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},t2=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&S1(t[1]);return e&&JSON.parse(e)},yd=()=>{try{return QT()||ZT()||e2()||t2()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},n2=t=>{var e,n;return(n=(e=yd())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},x1=t=>{const e=n2(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},C1=()=>{var t;return(t=yd())==null?void 0:t.config},r2=t=>{var e;return(e=yd())==null?void 0:e[`_${t}`]};/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class i2{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
* @license
* Copyright 2025 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function Vs(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function _1(t){return(await fetch(t,{credentials:"include"})).ok}/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function k1(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...t};return[jc(JSON.stringify(n)),jc(JSON.stringify(a)),""].join(".")}const qo={};function s2(){const t={prod:[],emulator:[]};for(const e of Object.keys(qo))qo[e]?t.emulator.push(e):t.prod.push(e);return t}function a2(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Vv=!1;function E1(t,e){if(typeof window>"u"||typeof document>"u"||!Vs(window.location.host)||qo[t]===e||qo[t]||Vv)return;qo[t]=e;function n(f){return`__firebase__banner__${f}`}const r="__firebase__banner",i=s2().prod.length>0;function s(){const f=document.getElementById(r);f&&f.remove()}function a(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function u(f,p){f.setAttribute("width","24"),f.setAttribute("id",p),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function o(){const f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{Vv=!0,s()},f}function d(f,p){f.setAttribute("id",p),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function h(){const f=a2(r),p=n("text"),g=document.getElementById(p)||document.createElement("span"),b=n("learnmore"),N=document.getElementById(b)||document.createElement("a"),D=n("preprendIcon"),v=document.getElementById(D)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){const w=f.element;a(w),d(N,b);const C=o();u(v,D),w.append(v,g,N,C),document.body.appendChild(w)}i?(g.innerText="Preview backend disconnected.",v.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(v.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,g.innerText="Preview backend running in this workspace."),g.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function dr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function o2(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(dr())}function l2(){var t;const e=(t=yd())==null?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function u2(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function c2(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function d2(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function h2(){return!l2()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function f2(){try{return typeof indexedDB=="object"}catch{return!1}}function m2(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)==null?void 0:s.message)||"")}}catch(n){e(n)}})}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const p2="FirebaseError";class ti extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=p2,Object.setPrototypeOf(this,ti.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Rl.prototype.create)}}class Rl{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?g2(s,r):"Error",u=`${this.serviceName}: ${a} (${i}).`;return new ti(i,u,r)}}function g2(t,e){return t.replace(y2,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const y2=/\{\$([^}]+)}/g;function Ac(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],a=e[i];if(zv(s)&&zv(a)){if(!Ac(s,a))return!1}else if(s!==a)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function zv(t){return t!==null&&typeof t=="object"}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function N1(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function v2(t,e){const n=new b2(t,e);return n.subscribe.bind(n)}class b2{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");w2(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=Th),i.error===void 0&&(i.error=Th),i.complete===void 0&&(i.complete=Th);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function w2(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Th(){}/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function nn(t){return t&&t._delegate?t._delegate:t}class zi{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const fs="[DEFAULT]";/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class S2{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new i2;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(C2(e))try{this.getOrInitializeService({instanceIdentifier:fs})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=fs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=fs){return this.instances.has(e)}getOptions(e=fs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,a]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(s);r===u&&a.resolve(i)}return i}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:x2(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=fs){return this.component?this.component.multipleInstances?e:fs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function x2(t){return t===fs?void 0:t}function C2(t){return t.instantiationMode==="EAGER"}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class _2{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new S2(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var Fe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Fe||(Fe={}));const k2={debug:Fe.DEBUG,verbose:Fe.VERBOSE,info:Fe.INFO,warn:Fe.WARN,error:Fe.ERROR,silent:Fe.SILENT},E2=Fe.INFO,N2={[Fe.DEBUG]:"log",[Fe.VERBOSE]:"log",[Fe.INFO]:"info",[Fe.WARN]:"warn",[Fe.ERROR]:"error"},T2=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=N2[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Vp{constructor(e){this.name=e,this._logLevel=E2,this._logHandler=T2,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Fe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?k2[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Fe.DEBUG,...e),this._logHandler(this,Fe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Fe.VERBOSE,...e),this._logHandler(this,Fe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Fe.INFO,...e),this._logHandler(this,Fe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Fe.WARN,...e),this._logHandler(this,Fe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Fe.ERROR,...e),this._logHandler(this,Fe.ERROR,...e)}}const I2=(t,e)=>e.some(n=>t instanceof n);let Bv,$v;function j2(){return Bv||(Bv=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function A2(){return $v||($v=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const T1=new WeakMap,tm=new WeakMap,I1=new WeakMap,Ih=new WeakMap,zp=new WeakMap;function D2(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{n(Oi(t.result)),i()},a=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&T1.set(n,t)}).catch(()=>{}),zp.set(e,t),e}function M2(t){if(tm.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{n(),i()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});tm.set(t,e)}let nm={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return tm.get(t);if(e==="objectStoreNames")return t.objectStoreNames||I1.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Oi(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function P2(t){nm=t(nm)}function O2(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(jh(this),e,...n);return I1.set(r,e.sort?e.sort():[e]),Oi(r)}:A2().includes(t)?function(...e){return t.apply(jh(this),e),Oi(T1.get(this))}:function(...e){return Oi(t.apply(jh(this),e))}}function R2(t){return typeof t=="function"?O2(t):(t instanceof IDBTransaction&&M2(t),I2(t,j2())?new Proxy(t,nm):t)}function Oi(t){if(t instanceof IDBRequest)return D2(t);if(Ih.has(t))return Ih.get(t);const e=R2(t);return e!==t&&(Ih.set(t,e),zp.set(e,t)),e}const jh=t=>zp.get(t);function j1(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),u=Oi(a);return r&&a.addEventListener("upgradeneeded",o=>{r(Oi(a.result),o.oldVersion,o.newVersion,Oi(a.transaction),o)}),n&&a.addEventListener("blocked",o=>n(o.oldVersion,o.newVersion,o)),u.then(o=>{s&&o.addEventListener("close",()=>s()),i&&o.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}const L2=["get","getKey","getAll","getAllKeys","count"],F2=["put","add","delete","clear"],Ah=new Map;function Hv(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Ah.get(e))return Ah.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=F2.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||L2.includes(n)))return;const s=async function(a,...u){const o=this.transaction(a,i?"readwrite":"readonly");let d=o.store;return r&&(d=d.index(u.shift())),(await Promise.all([d[n](...u),i&&o.done]))[0]};return Ah.set(e,s),s}P2(t=>({...t,get:(e,n,r)=>Hv(e,n)||t.get(e,n,r),has:(e,n)=>!!Hv(e,n)||t.has(e,n)}));/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class U2{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(V2(e)){const n=e.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(e=>e).join(" ")}}function V2(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const rm="@firebase/app",qv="0.14.5";/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Qr=new Vp("@firebase/app"),z2="@firebase/app-compat",B2="@firebase/analytics-compat",$2="@firebase/analytics",H2="@firebase/app-check-compat",q2="@firebase/app-check",W2="@firebase/auth",G2="@firebase/auth-compat",Q2="@firebase/database",K2="@firebase/data-connect",X2="@firebase/database-compat",Y2="@firebase/functions",J2="@firebase/functions-compat",Z2="@firebase/installations",eI="@firebase/installations-compat",tI="@firebase/messaging",nI="@firebase/messaging-compat",rI="@firebase/performance",iI="@firebase/performance-compat",sI="@firebase/remote-config",aI="@firebase/remote-config-compat",oI="@firebase/storage",lI="@firebase/storage-compat",uI="@firebase/firestore",cI="@firebase/ai",dI="@firebase/firestore-compat",hI="firebase",fI="12.5.0";/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const im="[DEFAULT]",mI={[rm]:"fire-core",[z2]:"fire-core-compat",[$2]:"fire-analytics",[B2]:"fire-analytics-compat",[q2]:"fire-app-check",[H2]:"fire-app-check-compat",[W2]:"fire-auth",[G2]:"fire-auth-compat",[Q2]:"fire-rtdb",[K2]:"fire-data-connect",[X2]:"fire-rtdb-compat",[Y2]:"fire-fn",[J2]:"fire-fn-compat",[Z2]:"fire-iid",[eI]:"fire-iid-compat",[tI]:"fire-fcm",[nI]:"fire-fcm-compat",[rI]:"fire-perf",[iI]:"fire-perf-compat",[sI]:"fire-rc",[aI]:"fire-rc-compat",[oI]:"fire-gcs",[lI]:"fire-gcs-compat",[uI]:"fire-fst",[dI]:"fire-fst-compat",[cI]:"fire-vertex","fire-js":"fire-js",[hI]:"fire-js-all"};/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const bl=new Map,pI=new Map,sm=new Map;function Wv(t,e){try{t.container.addComponent(e)}catch(n){Qr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Is(t){const e=t.name;if(sm.has(e))return Qr.debug(`There were multiple attempts to register component ${e}.`),!1;sm.set(e,t);for(const n of bl.values())Wv(n,t);for(const n of pI.values())Wv(n,t);return!0}function A1(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function yi(t){return t==null?!1:t.settings!==void 0}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const gI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ri=new Rl("app","Firebase",gI);/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class yI{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new zi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ri.create("app-deleted",{appName:this._name})}}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Ll=fI;function D1(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:im,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Ri.create("bad-app-name",{appName:String(i)});if(n||(n=C1()),!n)throw Ri.create("no-options");const s=bl.get(i);if(s){if(Ac(n,s.options)&&Ac(r,s.config))return s;throw Ri.create("duplicate-app",{appName:i})}const a=new _2(i);for(const o of sm.values())a.addComponent(o);const u=new yI(n,r,a);return bl.set(i,u),u}function Bp(t=im){const e=bl.get(t);if(!e&&t===im&&C1())return D1();if(!e)throw Ri.create("no-app",{appName:t});return e}function Gv(){return Array.from(bl.values())}function Ir(t,e,n){let r=mI[t]??t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const a=[`Unable to register library "${r}" with version "${e}":`];i&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&a.push("and"),s&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Qr.warn(a.join(" "));return}Is(new zi(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const vI="firebase-heartbeat-database",bI=1,wl="firebase-heartbeat-store";let Dh=null;function M1(){return Dh||(Dh=j1(vI,bI,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(wl)}catch(n){console.warn(n)}}}}).catch(t=>{throw Ri.create("idb-open",{originalErrorMessage:t.message})})),Dh}async function wI(t){try{const e=(await M1()).transaction(wl),n=await e.objectStore(wl).get(P1(t));return await e.done,n}catch(e){if(e instanceof ti)Qr.warn(e.message);else{const n=Ri.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Qr.warn(n.message)}}}async function Qv(t,e){try{const n=(await M1()).transaction(wl,"readwrite");await n.objectStore(wl).put(e,P1(t)),await n.done}catch(n){if(n instanceof ti)Qr.warn(n.message);else{const r=Ri.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Qr.warn(r.message)}}}function P1(t){return`${t.name}!${t.options.appId}`}/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const SI=1024,xI=30;class CI{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new kI(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Kv();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(s=>s.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:r}),this._heartbeatsCache.heartbeats.length>xI){const s=EI(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Qr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Kv(),{heartbeatsToSend:r,unsentEntries:i}=_I(this._heartbeatsCache.heartbeats),s=jc(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Qr.warn(n),""}}}function Kv(){return new Date().toISOString().substring(0,10)}function _I(t,e=SI){const n=[];let r=t.slice();for(const i of t){const s=n.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),Xv(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Xv(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class kI{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return f2()?m2().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const e=await wI(this.app);return e!=null&&e.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Qv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Qv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function Xv(t){return jc(JSON.stringify({version:2,heartbeats:t})).length}function EI(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function NI(t){Is(new zi("platform-logger",e=>new U2(e),"PRIVATE")),Is(new zi("heartbeat",e=>new CI(e),"PRIVATE")),Ir(rm,qv,t),Ir(rm,qv,"esm2020"),Ir("fire-js","")}NI("");function O1(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const TI=O1,R1=new Rl("auth","Firebase",O1());/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Dc=new Vp("@firebase/auth");function II(t,...e){Dc.logLevel<=Fe.WARN&&Dc.warn(`Auth (${Ll}): ${t}`,...e)}function Ku(t,...e){Dc.logLevel<=Fe.ERROR&&Dc.error(`Auth (${Ll}): ${t}`,...e)}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function Yv(t,...e){throw $p(t,...e)}function L1(t,...e){return $p(t,...e)}function F1(t,e,n){const r={...TI(),[e]:n};return new Rl("auth","Firebase",r).create(e,{appName:t.name})}function Xu(t){return F1(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function $p(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return R1.create(t,...e)}function Ye(t,e,...n){if(!t)throw $p(e,...n)}function Wo(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Ku(e),new Error(e)}function Mc(t,e){t||Wo(e)}function jI(){return Jv()==="http:"||Jv()==="https:"}function Jv(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function AI(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(jI()||c2()||"connection"in navigator)?navigator.onLine:!0}function DI(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Fl{constructor(e,n){this.shortDelay=e,this.longDelay=n,Mc(n>e,"Short delay should be less than long delay!"),this.isMobile=o2()||d2()}get(){return AI()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function MI(t,e){Mc(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class U1{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Wo("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Wo("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Wo("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const PI={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const OI=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],RI=new Fl(3e4,6e4);function V1(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function vd(t,e,n,r,i={}){return z1(t,i,async()=>{let s={},a={};r&&(e==="GET"?a=r:s={body:JSON.stringify(r)});const u=N1({key:t.config.apiKey,...a}).slice(1),o=await t._getAdditionalHeaders();o["Content-Type"]="application/json",t.languageCode&&(o["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:o,...s};return u2()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&Vs(t.emulatorConfig.host)&&(d.credentials="include"),U1.fetch()(await B1(t,t.config.apiHost,n,u),d)})}async function z1(t,e,n){t._canInitEmulator=!1;const r={...PI,...e};try{const i=new LI(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw wu(t,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const u=s.ok?a.errorMessage:a.error.message,[o,d]=u.split(" : ");if(o==="FEDERATED_USER_ID_ALREADY_LINKED")throw wu(t,"credential-already-in-use",a);if(o==="EMAIL_EXISTS")throw wu(t,"email-already-in-use",a);if(o==="USER_DISABLED")throw wu(t,"user-disabled",a);const h=r[o]||o.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw F1(t,h,d);Yv(t,h)}}catch(i){if(i instanceof ti)throw i;Yv(t,"network-request-failed",{message:String(i)})}}async function B1(t,e,n,r){const i=`${e}${n}?${r}`,s=t,a=s.config.emulator?MI(t.config,i):`${t.config.apiScheme}://${i}`;return OI.includes(n)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(a).toString():a}class LI{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(L1(this.auth,"network-request-failed")),RI.get())})}}function wu(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=L1(t,e,r);return i.customData._tokenResponse=n,i}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/async function FI(t,e){return vd(t,"POST","/v1/accounts:delete",e)}async function Pc(t,e){return vd(t,"POST","/v1/accounts:lookup",e)}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function Go(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function UI(t,e=!1){const n=nn(t),r=await n.getIdToken(e),i=$1(r);Ye(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Go(Mh(i.auth_time)),issuedAtTime:Go(Mh(i.iat)),expirationTime:Go(Mh(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Mh(t){return Number(t)*1e3}function $1(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Ku("JWT malformed, contained fewer than 3 sections"),null;try{const i=S1(n);return i?JSON.parse(i):(Ku("Failed to decode base64 JWT payload"),null)}catch(i){return Ku("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function Zv(t){const e=$1(t);return Ye(e,"internal-error"),Ye(typeof e.exp<"u","internal-error"),Ye(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/async function am(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof ti&&VI(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function VI({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class zI{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class om{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Go(this.lastLoginAt),this.creationTime=Go(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/async function Oc(t){var e;const n=t.auth,r=await t.getIdToken(),i=await am(t,Pc(n,{idToken:r}));Ye(i==null?void 0:i.users.length,n,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const a=(e=s.providerUserInfo)!=null&&e.length?H1(s.providerUserInfo):[],u=$I(t.providerData,a),o=t.isAnonymous,d=!(t.email&&s.passwordHash)&&!(u!=null&&u.length),h=o?d:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:u,metadata:new om(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(t,f)}async function BI(t){const e=nn(t);await Oc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function $I(t,e){return[...t.filter(n=>!e.some(r=>r.providerId===n.providerId)),...e]}function H1(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/async function HI(t,e){const n=await z1(t,{},async()=>{const r=N1({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,a=await B1(t,i,"/v1/token",`key=${s}`),u=await t._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const o={method:"POST",headers:u,body:r};return t.emulatorConfig&&Vs(t.emulatorConfig.host)&&(o.credentials="include"),U1.fetch()(a,o)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function qI(t,e){return vd(t,"POST","/v2/accounts:revokeToken",V1(t,e))}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class xa{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ye(e.idToken,"internal-error"),Ye(typeof e.idToken<"u","internal-error"),Ye(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Zv(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Ye(e.length!==0,"internal-error");const n=Zv(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Ye(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await HI(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,a=new xa;return r&&(Ye(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(Ye(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(Ye(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new xa,this.toJSON())}_performRefresh(){return Wo("not implemented")}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function ui(t,e){Ye(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class kr{constructor({uid:e,auth:n,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new zI(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new om(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await am(this,this.stsTokenManager.getToken(this.auth,e));return Ye(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return UI(this,e)}reload(){return BI(this)}_assign(e){this!==e&&(Ye(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new kr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Ye(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Oc(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(yi(this.auth.app))return Promise.reject(Xu(this.auth));const e=await this.getIdToken();return await am(this,FI(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,i=n.email??void 0,s=n.phoneNumber??void 0,a=n.photoURL??void 0,u=n.tenantId??void 0,o=n._redirectEventId??void 0,d=n.createdAt??void 0,h=n.lastLoginAt??void 0,{uid:f,emailVerified:p,isAnonymous:g,providerData:b,stsTokenManager:N}=n;Ye(f&&N,e,"internal-error");const D=xa.fromJSON(this.name,N);Ye(typeof f=="string",e,"internal-error"),ui(r,e.name),ui(i,e.name),Ye(typeof p=="boolean",e,"internal-error"),Ye(typeof g=="boolean",e,"internal-error"),ui(s,e.name),ui(a,e.name),ui(u,e.name),ui(o,e.name),ui(d,e.name),ui(h,e.name);const v=new kr({uid:f,auth:e,email:i,emailVerified:p,displayName:r,isAnonymous:g,photoURL:a,phoneNumber:s,tenantId:u,stsTokenManager:D,createdAt:d,lastLoginAt:h});return b&&Array.isArray(b)&&(v.providerData=b.map(w=>({...w}))),o&&(v._redirectEventId=o),v}static async _fromIdTokenResponse(e,n,r=!1){const i=new xa;i.updateFromServerResponse(n);const s=new kr({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Oc(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];Ye(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?H1(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),u=new xa;u.updateFromIdToken(r);const o=new kr({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:a}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new om(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(o,d),o}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const eb=new Map;function vs(t){Mc(t instanceof Function,"Expected a class definition");let e=eb.get(t);return e?(Mc(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,eb.set(t,e),e)}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class q1{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}q1.type="NONE";const tb=q1;/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function Ph(t,e,n){return`firebase:${t}:${e}:${n}`}class Ca{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Ph(this.userKey,i.apiKey,s),this.fullPersistenceKey=Ph("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Pc(this.auth,{idToken:e}).catch(()=>{});return n?kr._fromGetAccountInfoResponse(this.auth,n,e):null}return kr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Ca(vs(tb),e,r);const i=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let s=i[0]||vs(tb);const a=Ph(r,e.config.apiKey,e.name);let u=null;for(const d of n)try{const h=await d._get(a);if(h){let f;if(typeof h=="string"){const p=await Pc(e,{idToken:h}).catch(()=>{});if(!p)break;f=await kr._fromGetAccountInfoResponse(e,p,h)}else f=kr._fromJSON(e,h);d!==s&&(u=f),s=d;break}}catch{}const o=i.filter(d=>d._shouldAllowMigration);return!s._shouldAllowMigration||!o.length?new Ca(s,e,r):(s=o[0],u&&await s._set(a,u.toJSON()),await Promise.all(n.map(async d=>{if(d!==s)try{await d._remove(a)}catch{}})),new Ca(s,e,r))}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function nb(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(KI(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(WI(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(YI(e))return"Blackberry";if(JI(e))return"Webos";if(GI(e))return"Safari";if((e.includes("chrome/")||QI(e))&&!e.includes("edge/"))return"Chrome";if(XI(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function WI(t=dr()){return/firefox\//i.test(t)}function GI(t=dr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function QI(t=dr()){return/crios\//i.test(t)}function KI(t=dr()){return/iemobile/i.test(t)}function XI(t=dr()){return/android/i.test(t)}function YI(t=dr()){return/blackberry/i.test(t)}function JI(t=dr()){return/webos/i.test(t)}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function W1(t,e=[]){let n;switch(t){case"Browser":n=nb(dr());break;case"Worker":n=`${nb(dr())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ll}/${r}`}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class ZI{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((a,u)=>{try{const o=e(s);a(o)}catch(o){u(o)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
* @license
* Copyright 2023 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/async function ej(t,e={}){return vd(t,"GET","/v2/passwordPolicy",V1(t,e))}/**
* @license
* Copyright 2023 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const tj=6;class nj{constructor(e){var n;const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??tj,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((n=e.allowedNonAlphanumericCharacters)==null?void 0:n.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class rj{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new rb(this),this.idTokenSubscription=new rb(this),this.beforeStateQueue=new ZI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=R1,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=vs(n)),this._initializationPromise=this.queue(async()=>{var r,i,s;if(!this._deleted&&(this.persistenceManager=await Ca.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)==null?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Pc(this,{idToken:e}),r=await kr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(yi(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(u,u))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(n=this.redirectUser)==null?void 0:n._redirectEventId,u=i==null?void 0:i._redirectEventId,o=await this.tryRedirectSignIn(e);(!a||a===u)&&o!=null&&o.user&&(i=o.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Ye(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Oc(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=DI()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(yi(this.app))return Promise.reject(Xu(this));const n=e?nn(e):null;return n&&Ye(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Ye(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return yi(this.app)?Promise.reject(Xu(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return yi(this.app)?Promise.reject(Xu(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(vs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await ej(this),n=new nj(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Rl("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await qI(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&vs(e)||this._popupRedirectResolver;Ye(n,this,"argument-error"),this.redirectPersistenceManager=await Ca.create(this,[vs(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=((e=this.currentUser)==null?void 0:e.uid)??null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let a=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ye(u,this,"internal-error"),u.then(()=>{a||s(this.currentUser)}),typeof n=="function"){const o=e.addObserver(n,r,i);return()=>{a=!0,o()}}else{const o=e.addObserver(n);return()=>{a=!0,o()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ye(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=W1(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;if(yi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:e.getToken());return n!=null&&n.error&&II(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function ij(t){return nn(t)}class rb{constructor(e){this.auth=e,this.observer=null,this.addObserver=v2(n=>this.observer=n)}get next(){return Ye(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function sj(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(vs);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}new Fl(3e4,6e4);/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/new Fl(2e3,1e4);/**
* @license
* Copyright 2020 Google LLC.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/new Fl(3e4,6e4);/**
* @license
* Copyright 2020 Google LLC.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/new Fl(5e3,15e3);var ib="@firebase/auth",sb="1.11.1";/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class aj{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Ye(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function oj(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function lj(t){Is(new zi("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:u}=r.options;Ye(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const o={apiKey:a,authDomain:u,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:W1(t)},d=new rj(r,i,s,o);return sj(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Is(new zi("auth-internal",e=>{const n=ij(e.getProvider("auth").getImmediate());return(r=>new aj(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ir(ib,sb,oj(t)),Ir(ib,sb,"esm2020")}r2("authIdTokenMaxAge");lj("Browser");var uj="firebase",cj="12.5.0";/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/Ir(uj,cj,"app");var ab=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Li,G1;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,x){function j(){}j.prototype=x.prototype,E.F=x.prototype,E.prototype=new j,E.prototype.constructor=E,E.D=function(S,_,I){for(var T=Array(arguments.length-2),te=2;te<arguments.length;te++)T[te-2]=arguments[te];return x.prototype[_].apply(S,T)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,x,j){j||(j=0);const S=Array(16);if(typeof x=="string")for(var _=0;_<16;++_)S[_]=x.charCodeAt(j++)|x.charCodeAt(j++)<<8|x.charCodeAt(j++)<<16|x.charCodeAt(j++)<<24;else for(_=0;_<16;++_)S[_]=x[j++]|x[j++]<<8|x[j++]<<16|x[j++]<<24;x=E.g[0],j=E.g[1],_=E.g[2];let I=E.g[3],T;T=x+(I^j&(_^I))+S[0]+3614090360&4294967295,x=j+(T<<7&4294967295|T>>>25),T=I+(_^x&(j^_))+S[1]+3905402710&4294967295,I=x+(T<<12&4294967295|T>>>20),T=_+(j^I&(x^j))+S[2]+606105819&4294967295,_=I+(T<<17&4294967295|T>>>15),T=j+(x^_&(I^x))+S[3]+3250441966&4294967295,j=_+(T<<22&4294967295|T>>>10),T=x+(I^j&(_^I))+S[4]+4118548399&4294967295,x=j+(T<<7&4294967295|T>>>25),T=I+(_^x&(j^_))+S[5]+1200080426&4294967295,I=x+(T<<12&4294967295|T>>>20),T=_+(j^I&(x^j))+S[6]+2821735955&4294967295,_=I+(T<<17&4294967295|T>>>15),T=j+(x^_&(I^x))+S[7]+4249261313&4294967295,j=_+(T<<22&4294967295|T>>>10),T=x+(I^j&(_^I))+S[8]+1770035416&4294967295,x=j+(T<<7&4294967295|T>>>25),T=I+(_^x&(j^_))+S[9]+2336552879&4294967295,I=x+(T<<12&4294967295|T>>>20),T=_+(j^I&(x^j))+S[10]+4294925233&4294967295,_=I+(T<<17&4294967295|T>>>15),T=j+(x^_&(I^x))+S[11]+2304563134&4294967295,j=_+(T<<22&4294967295|T>>>10),T=x+(I^j&(_^I))+S[12]+1804603682&4294967295,x=j+(T<<7&4294967295|T>>>25),T=I+(_^x&(j^_))+S[13]+4254626195&4294967295,I=x+(T<<12&4294967295|T>>>20),T=_+(j^I&(x^j))+S[14]+2792965006&4294967295,_=I+(T<<17&4294967295|T>>>15),T=j+(x^_&(I^x))+S[15]+1236535329&4294967295,j=_+(T<<22&4294967295|T>>>10),T=x+(_^I&(j^_))+S[1]+4129170786&4294967295,x=j+(T<<5&4294967295|T>>>27),T=I+(j^_&(x^j))+S[6]+3225465664&4294967295,I=x+(T<<9&4294967295|T>>>23),T=_+(x^j&(I^x))+S[11]+643717713&4294967295,_=I+(T<<14&4294967295|T>>>18),T=j+(I^x&(_^I))+S[0]+3921069994&4294967295,j=_+(T<<20&4294967295|T>>>12),T=x+(_^I&(j^_))+S[5]+3593408605&4294967295,x=j+(T<<5&4294967295|T>>>27),T=I+(j^_&(x^j))+S[10]+38016083&4294967295,I=x+(T<<9&4294967295|T>>>23),T=_+(x^j&(I^x))+S[15]+3634488961&4294967295,_=I+(T<<14&4294967295|T>>>18),T=j+(I^x&(_^I))+S[4]+3889429448&4294967295,j=_+(T<<20&4294967295|T>>>12),T=x+(_^I&(j^_))+S[9]+568446438&4294967295,x=j+(T<<5&4294967295|T>>>27),T=I+(j^_&(x^j))+S[14]+3275163606&4294967295,I=x+(T<<9&4294967295|T>>>23),T=_+(x^j&(I^x))+S[3]+4107603335&4294967295,_=I+(T<<14&4294967295|T>>>18),T=j+(I^x&(_^I))+S[8]+1163531501&4294967295,j=_+(T<<20&4294967295|T>>>12),T=x+(_^I&(j^_))+S[13]+2850285829&4294967295,x=j+(T<<5&4294967295|T>>>27),T=I+(j^_&(x^j))+S[2]+4243563512&4294967295,I=x+(T<<9&4294967295|T>>>23),T=_+(x^j&(I^x))+S[7]+1735328473&4294967295,_=I+(T<<14&4294967295|T>>>18),T=j+(I^x&(_^I))+S[12]+2368359562&4294967295,j=_+(T<<20&4294967295|T>>>12),T=x+(j^_^I)+S[5]+4294588738&4294967295,x=j+(T<<4&4294967295|T>>>28),T=I+(x^j^_)+S[8]+2272392833&4294967295,I=x+(T<<11&4294967295|T>>>21),T=_+(I^x^j)+S[11]+1839030562&4294967295,_=I+(T<<16&4294967295|T>>>16),T=j+(_^I^x)+S[14]+4259657740&4294967295,j=_+(T<<23&4294967295|T>>>9),T=x+(j^_^I)+S[1]+2763975236&4294967295,x=j+(T<<4&4294967295|T>>>28),T=I+(x^j^_)+S[4]+1272893353&4294967295,I=x+(T<<11&4294967295|T>>>21),T=_+(I^x^j)+S[7]+4139469664&4294967295,_=I+(T<<16&4294967295|T>>>16),T=j+(_^I^x)+S[10]+3200236656&4294967295,j=_+(T<<23&4294967295|T>>>9),T=x+(j^_^I)+S[13]+681279174&4294967295,x=j+(T<<4&4294967295|T>>>28),T=I+(x^j^_)+S[0]+3936430074&4294967295,I=x+(T<<11&4294967295|T>>>21),T=_+(I^x^j)+S[3]+3572445317&4294967295,_=I+(T<<16&4294967295|T>>>16),T=j+(_^I^x)+S[6]+76029189&4294967295,j=_+(T<<23&4294967295|T>>>9),T=x+(j^_^I)+S[9]+3654602809&4294967295,x=j+(T<<4&4294967295|T>>>28),T=I+(x^j^_)+S[12]+3873151461&4294967295,I=x+(T<<11&4294967295|T>>>21),T=_+(I^x^j)+S[15]+530742520&4294967295,_=I+(T<<16&4294967295|T>>>16),T=j+(_^I^x)+S[2]+3299628645&4294967295,j=_+(T<<23&4294967295|T>>>9),T=x+(_^(j|~I))+S[0]+4096336452&4294967295,x=j+(T<<6&4294967295|T>>>26),T=I+(j^(x|~_))+S[7]+1126891415&4294967295,I=x+(T<<10&4294967295|T>>>22),T=_+(x^(I|~j))+S[14]+2878612391&4294967295,_=I+(T<<15&4294967295|T>>>17),T=j+(I^(_|~x))+S[5]+4237533241&4294967295,j=_+(T<<21&4294967295|T>>>11),T=x+(_^(j|~I))+S[12]+1700485571&4294967295,x=j+(T<<6&4294967295|T>>>26),T=I+(j^(x|~_))+S[3]+2399980690&4294967295,I=x+(T<<10&4294967295|T>>>22),T=_+(x^(I|~j))+S[10]+4293915773&4294967295,_=I+(T<<15&4294967295|T>>>17),T=j+(I^(_|~x))+S[1]+2240044497&4294967295,j=_+(T<<21&4294967295|T>>>11),T=x+(_^(j|~I))+S[8]+1873313359&4294967295,x=j+(T<<6&4294967295|T>>>26),T=I+(j^(x|~_))+S[15]+4264355552&4294967295,I=x+(T<<10&4294967295|T>>>22),T=_+(x^(I|~j))+S[6]+2734768916&4294967295,_=I+(T<<15&4294967295|T>>>17),T=j+(I^(_|~x))+S[13]+1309151649&4294967295,j=_+(T<<21&4294967295|T>>>11),T=x+(_^(j|~I))+S[4]+4149444226&4294967295,x=j+(T<<6&4294967295|T>>>26),T=I+(j^(x|~_))+S[11]+3174756917&4294967295,I=x+(T<<10&4294967295|T>>>22),T=_+(x^(I|~j))+S[2]+718787259&4294967295,_=I+(T<<15&4294967295|T>>>17),T=j+(I^(_|~x))+S[9]+3951481745&4294967295,E.g[0]=E.g[0]+x&4294967295,E.g[1]=E.g[1]+(_+(T<<21&4294967295|T>>>11))&4294967295,E.g[2]=E.g[2]+_&4294967295,E.g[3]=E.g[3]+I&4294967295}r.prototype.v=function(E,x){x===void 0&&(x=E.length);const j=x-this.blockSize,S=this.C;let _=this.h,I=0;for(;I<x;){if(_==0)for(;I<=j;)i(this,E,I),I+=this.blockSize;if(typeof E=="string"){for(;I<x;)if(S[_++]=E.charCodeAt(I++),_==this.blockSize){i(this,S),_=0;break}}else for(;I<x;)if(S[_++]=E[I++],_==this.blockSize){i(this,S),_=0;break}}this.h=_,this.o+=x},r.prototype.A=function(){var E=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);E[0]=128;for(var x=1;x<E.length-8;++x)E[x]=0;x=this.o*8;for(var j=E.length-8;j<E.length;++j)E[j]=x&255,x/=256;for(this.v(E),E=Array(16),x=0,j=0;j<4;++j)for(let S=0;S<32;S+=8)E[x++]=this.g[j]>>>S&255;return E};function s(E,x){var j=u;return Object.prototype.hasOwnProperty.call(j,E)?j[E]:j[E]=x(E)}function a(E,x){this.h=x;const j=[];let S=!0;for(let _=E.length-1;_>=0;_--){const I=E[_]|0;S&&I==x||(j[_]=I,S=!1)}this.g=j}var u={};function o(E){return-128<=E&&E<128?s(E,function(x){return new a([x|0],x<0?-1:0)}):new a([E|0],E<0?-1:0)}function d(E){if(isNaN(E)||!isFinite(E))return f;if(E<0)return D(d(-E));const x=[];let j=1;for(let S=0;E>=j;S++)x[S]=E/j|0,j*=4294967296;return new a(x,0)}function h(E,x){if(E.length==0)throw Error("number format error: empty string");if(x=x||10,x<2||36<x)throw Error("radix out of range: "+x);if(E.charAt(0)=="-")return D(h(E.substring(1),x));if(E.indexOf("-")>=0)throw Error('number format error: interior "-" character');const j=d(Math.pow(x,8));let S=f;for(let I=0;I<E.length;I+=8){var _=Math.min(8,E.length-I);const T=parseInt(E.substring(I,I+_),x);_<8?(_=d(Math.pow(x,_)),S=S.j(_).add(d(T))):(S=S.j(j),S=S.add(d(T)))}return S}var f=o(0),p=o(1),g=o(16777216);t=a.prototype,t.m=function(){if(N(this))return-D(this).m();let E=0,x=1;for(let j=0;j<this.g.length;j++){const S=this.i(j);E+=(S>=0?S:4294967296+S)*x,x*=4294967296}return E},t.toString=function(E){if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(b(this))return"0";if(N(this))return"-"+D(this).toString(E);const x=d(Math.pow(E,6));var j=this;let S="";for(;;){const _=O(j,x).g;j=v(j,_.j(x));let I=((j.g.length>0?j.g[0]:j.h)>>>0).toString(E);if(j=_,b(j))return I+S;for(;I.length<6;)I="0"+I;S=I+S}},t.i=function(E){return E<0?0:E<this.g.length?this.g[E]:this.h};function b(E){if(E.h!=0)return!1;for(let x=0;x<E.g.length;x++)if(E.g[x]!=0)return!1;return!0}function N(E){return E.h==-1}t.l=function(E){return E=v(this,E),N(E)?-1:b(E)?0:1};function D(E){const x=E.g.length,j=[];for(let S=0;S<x;S++)j[S]=~E.g[S];return new a(j,~E.h).add(p)}t.abs=function(){return N(this)?D(this):this},t.add=function(E){const x=Math.max(this.g.length,E.g.length),j=[];let S=0;for(let _=0;_<=x;_++){let I=S+(this.i(_)&65535)+(E.i(_)&65535),T=(I>>>16)+(this.i(_)>>>16)+(E.i(_)>>>16);S=T>>>16,I&=65535,T&=65535,j[_]=T<<16|I}return new a(j,j[j.length-1]&-2147483648?-1:0)};function v(E,x){return E.add(D(x))}t.j=function(E){if(b(this)||b(E))return f;if(N(this))return N(E)?D(this).j(D(E)):D(D(this).j(E));if(N(E))return D(this.j(D(E)));if(this.l(g)<0&&E.l(g)<0)return d(this.m()*E.m());const x=this.g.length+E.g.length,j=[];for(var S=0;S<2*x;S++)j[S]=0;for(S=0;S<this.g.length;S++)for(let _=0;_<E.g.length;_++){const I=this.i(S)>>>16,T=this.i(S)&65535,te=E.i(_)>>>16,K=E.i(_)&65535;j[2*S+2*_]+=T*K,w(j,2*S+2*_),j[2*S+2*_+1]+=I*K,w(j,2*S+2*_+1),j[2*S+2*_+1]+=T*te,w(j,2*S+2*_+1),j[2*S+2*_+2]+=I*te,w(j,2*S+2*_+2)}for(E=0;E<x;E++)j[E]=j[2*E+1]<<16|j[2*E];for(E=x;E<2*x;E++)j[E]=0;return new a(j,0)};function w(E,x){for(;(E[x]&65535)!=E[x];)E[x+1]+=E[x]>>>16,E[x]&=65535,x++}function C(E,x){this.g=E,this.h=x}function O(E,x){if(b(x))throw Error("division by zero");if(b(E))return new C(f,f);if(N(E))return x=O(D(E),x),new C(D(x.g),D(x.h));if(N(x))return x=O(E,D(x)),new C(D(x.g),x.h);if(E.g.length>30){if(N(E)||N(x))throw Error("slowDivide_ only works with positive integers.");for(var j=p,S=x;S.l(E)<=0;)j=R(j),S=R(S);var _=F(j,1),I=F(S,1);for(S=F(S,2),j=F(j,2);!b(S);){var T=I.add(S);T.l(E)<=0&&(_=_.add(j),I=T),S=F(S,1),j=F(j,1)}return x=v(E,_.j(x)),new C(_,x)}for(_=f;E.l(x)>=0;){for(j=Math.max(1,Math.floor(E.m()/x.m())),S=Math.ceil(Math.log(j)/Math.LN2),S=S<=48?1:Math.pow(2,S-48),I=d(j),T=I.j(x);N(T)||T.l(E)>0;)j-=S,I=d(j),T=I.j(x);b(I)&&(I=p),_=_.add(I),E=v(E,T)}return new C(_,E)}t.B=function(E){return O(this,E).h},t.and=function(E){const x=Math.max(this.g.length,E.g.length),j=[];for(let S=0;S<x;S++)j[S]=this.i(S)&E.i(S);return new a(j,this.h&E.h)},t.or=function(E){const x=Math.max(this.g.length,E.g.length),j=[];for(let S=0;S<x;S++)j[S]=this.i(S)|E.i(S);return new a(j,this.h|E.h)},t.xor=function(E){const x=Math.max(this.g.length,E.g.length),j=[];for(let S=0;S<x;S++)j[S]=this.i(S)^E.i(S);return new a(j,this.h^E.h)};function R(E){const x=E.g.length+1,j=[];for(let S=0;S<x;S++)j[S]=E.i(S)<<1|E.i(S-1)>>>31;return new a(j,E.h)}function F(E,x){const j=x>>5;x%=32;const S=E.g.length-j,_=[];for(let I=0;I<S;I++)_[I]=x>0?E.i(I+j)>>>x|E.i(I+j+1)<<32-x:E.i(I+j);return new a(_,E.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,G1=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=h,Li=a}).apply(typeof ab<"u"?ab:typeof self<"u"?self:typeof window<"u"?window:{});var Su=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Q1,Ao,K1,Yu,lm,X1,Y1,J1;(function(){var t,e=Object.defineProperty;function n(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Su=="object"&&Su];for(var m=0;m<l.length;++m){var y=l[m];if(y&&y.Math==Math)return y}throw Error("Cannot find global object")}var r=n(this);function i(l,m){if(m)e:{var y=r;l=l.split(".");for(var A=0;A<l.length-1;A++){var H=l[A];if(!(H in y))break e;y=y[H]}l=l[l.length-1],A=y[l],m=m(A),m!=A&&m!=null&&e(y,l,{configurable:!0,writable:!0,value:m})}}i("Symbol.dispose",function(l){return l||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(l){return l||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(l){return l||function(m){var y=[],A;for(A in m)Object.prototype.hasOwnProperty.call(m,A)&&y.push([A,m[A]]);return y}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},a=this||self;function u(l){var m=typeof l;return m=="object"&&l!=null||m=="function"}function o(l,m,y){return l.call.apply(l.bind,arguments)}function d(l,m,y){return d=o,d.apply(null,arguments)}function h(l,m){var y=Array.prototype.slice.call(arguments,1);return function(){var A=y.slice();return A.push.apply(A,arguments),l.apply(this,A)}}function f(l,m){function y(){}y.prototype=m.prototype,l.Z=m.prototype,l.prototype=new y,l.prototype.constructor=l,l.Ob=function(A,H,Q){for(var fe=Array(arguments.length-2),De=2;De<arguments.length;De++)fe[De-2]=arguments[De];return m.prototype[H].apply(A,fe)}}var p=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?l=>l&&AsyncContext.Snapshot.wrap(l):l=>l;function g(l){const m=l.length;if(m>0){const y=Array(m);for(let A=0;A<m;A++)y[A]=l[A];return y}return[]}function b(l,m){for(let A=1;A<arguments.length;A++){const H=arguments[A];var y=typeof H;if(y=y!="object"?y:H?Array.isArray(H)?"array":y:"null",y=="array"||y=="object"&&typeof H.length=="number"){y=l.length||0;const Q=H.length||0;l.length=y+Q;for(let fe=0;fe<Q;fe++)l[y+fe]=H[fe]}else l.push(H)}}class N{constructor(m,y){this.i=m,this.j=y,this.h=0,this.g=null}get(){let m;return this.h>0?(this.h--,m=this.g,this.g=m.next,m.next=null):m=this.i(),m}}function D(l){a.setTimeout(()=>{throw l},0)}function v(){var l=E;let m=null;return l.g&&(m=l.g,l.g=l.g.next,l.g||(l.h=null),m.next=null),m}class w{constructor(){this.h=this.g=null}add(m,y){const A=C.get();A.set(m,y),this.h?this.h.next=A:this.g=A,this.h=A}}var C=new N(()=>new O,l=>l.reset());class O{constructor(){this.next=this.g=this.h=null}set(m,y){this.h=m,this.g=y,this.next=null}reset(){this.next=this.g=this.h=null}}let R,F=!1,E=new w,x=()=>{const l=Promise.resolve(void 0);R=()=>{l.then(j)}};function j(){for(var l;l=v();){try{l.h.call(l.g)}catch(y){D(y)}var m=C;m.j(l),m.h<100&&(m.h++,l.next=m.g,m.g=l)}F=!1}function S(){this.u=this.u,this.C=this.C}S.prototype.u=!1,S.prototype.dispose=function(){this.u||(this.u=!0,this.N())},S.prototype[Symbol.dispose]=function(){this.dispose()},S.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function _(l,m){this.type=l,this.g=this.target=m,this.defaultPrevented=!1}_.prototype.h=function(){this.defaultPrevented=!0};var I=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var l=!1,m=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const y=()=>{};a.addEventListener("test",y,m),a.removeEventListener("test",y,m)}catch{}return l}();function T(l){return/^[\s\xa0]*$/.test(l)}function te(l,m){_.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l&&this.init(l,m)}f(te,_),te.prototype.init=function(l,m){const y=this.type=l.type,A=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;this.target=l.target||l.srcElement,this.g=m,m=l.relatedTarget,m||(y=="mouseover"?m=l.fromElement:y=="mouseout"&&(m=l.toElement)),this.relatedTarget=m,A?(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=l.pointerType,this.state=l.state,this.i=l,l.defaultPrevented&&te.Z.h.call(this)},te.prototype.h=function(){te.Z.h.call(this);const l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var K="closure_listenable_"+(Math.random()*1e6|0),Y=0;function ce(l,m,y,A,H){this.listener=l,this.proxy=null,this.src=m,this.type=y,this.capture=!!A,this.ha=H,this.key=++Y,this.da=this.fa=!1}function L(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function G(l,m,y){for(const A in l)m.call(y,l[A],A,l)}function z(l,m){for(const y in l)m.call(void 0,l[y],y,l)}function $(l){const m={};for(const y in l)m[y]=l[y];return m}const W="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ee(l,m){let y,A;for(let H=1;H<arguments.length;H++){A=arguments[H];for(y in A)l[y]=A[y];for(let Q=0;Q<W.length;Q++)y=W[Q],Object.prototype.hasOwnProperty.call(A,y)&&(l[y]=A[y])}}function Z(l){this.src=l,this.g={},this.h=0}Z.prototype.add=function(l,m,y,A,H){const Q=l.toString();l=this.g[Q],l||(l=this.g[Q]=[],this.h++);const fe=P(l,m,A,H);return fe>-1?(m=l[fe],y||(m.fa=!1)):(m=new ce(m,this.src,Q,!!A,H),m.fa=y,l.push(m)),m};function ie(l,m){const y=m.type;if(y in l.g){var A=l.g[y],H=Array.prototype.indexOf.call(A,m,void 0),Q;(Q=H>=0)&&Array.prototype.splice.call(A,H,1),Q&&(L(m),l.g[y].length==0&&(delete l.g[y],l.h--))}}function P(l,m,y,A){for(let H=0;H<l.length;++H){const Q=l[H];if(!Q.da&&Q.listener==m&&Q.capture==!!y&&Q.ha==A)return H}return-1}var V="closure_lm_"+(Math.random()*1e6|0),U={};function q(l,m,y,A,H){if(Array.isArray(m)){for(let Q=0;Q<m.length;Q++)q(l,m[Q],y,A,H);return null}return y=pe(y),l&&l[K]?l.J(m,y,u(A)?!!A.capture:!1,H):se(l,m,y,!1,A,H)}function se(l,m,y,A,H,Q){if(!m)throw Error("Invalid event type");const fe=u(H)?!!H.capture:!!H;let De=de(l);if(De||(l[V]=De=new Z(l)),y=De.add(m,y,A,fe,Q),y.proxy)return y;if(A=me(),y.proxy=A,A.src=l,A.listener=y,l.addEventListener)I||(H=fe),H===void 0&&(H=!1),l.addEventListener(m.toString(),A,H);else if(l.attachEvent)l.attachEvent(X(m.toString()),A);else if(l.addListener&&l.removeListener)l.addListener(A);else throw Error("addEventListener and attachEvent are unavailable.");return y}function me(){function l(y){return m.call(l.src,l.listener,y)}const m=B;return l}function ae(l,m,y,A,H){if(Array.isArray(m))for(var Q=0;Q<m.length;Q++)ae(l,m[Q],y,A,H);else A=u(A)?!!A.capture:!!A,y=pe(y),l&&l[K]?(l=l.i,Q=String(m).toString(),Q in l.g&&(m=l.g[Q],y=P(m,y,A,H),y>-1&&(L(m[y]),Array.prototype.splice.call(m,y,1),m.length==0&&(delete l.g[Q],l.h--)))):l&&(l=de(l))&&(m=l.g[m.toString()],l=-1,m&&(l=P(m,y,A,H)),(y=l>-1?m[l]:null)&&M(y))}function M(l){if(typeof l!="number"&&l&&!l.da){var m=l.src;if(m&&m[K])ie(m.i,l);else{var y=l.type,A=l.proxy;m.removeEventListener?m.removeEventListener(y,A,l.capture):m.detachEvent?m.detachEvent(X(y),A):m.addListener&&m.removeListener&&m.removeListener(A),(y=de(m))?(ie(y,l),y.h==0&&(y.src=null,m[V]=null)):L(l)}}}function X(l){return l in U?U[l]:U[l]="on"+l}function B(l,m){if(l.da)l=!0;else{m=new te(m,this);const y=l.listener,A=l.ha||l.src;l.fa&&M(l),l=y.call(A,m)}return l}function de(l){return l=l[V],l instanceof Z?l:null}var re="__closure_events_fn_"+(Math.random()*1e9>>>0);function pe(l){return typeof l=="function"?l:(l[re]||(l[re]=function(m){return l.handleEvent(m)}),l[re])}function le(){S.call(this),this.i=new Z(this),this.M=this,this.G=null}f(le,S),le.prototype[K]=!0,le.prototype.removeEventListener=function(l,m,y,A){ae(this,l,m,y,A)};function xe(l,m){var y,A=l.G;if(A)for(y=[];A;A=A.G)y.push(A);if(l=l.M,A=m.type||m,typeof m=="string")m=new _(m,l);else if(m instanceof _)m.target=m.target||l;else{var H=m;m=new _(A,l),ee(m,H)}H=!0;let Q,fe;if(y)for(fe=y.length-1;fe>=0;fe--)Q=m.g=y[fe],H=Qe(Q,A,!0,m)&&H;if(Q=m.g=l,H=Qe(Q,A,!0,m)&&H,H=Qe(Q,A,!1,m)&&H,y)for(fe=0;fe<y.length;fe++)Q=m.g=y[fe],H=Qe(Q,A,!1,m)&&H}le.prototype.N=function(){if(le.Z.N.call(this),this.i){var l=this.i;for(const m in l.g){const y=l.g[m];for(let A=0;A<y.length;A++)L(y[A]);delete l.g[m],l.h--}}this.G=null},le.prototype.J=function(l,m,y,A){return this.i.add(String(l),m,!1,y,A)},le.prototype.K=function(l,m,y,A){return this.i.add(String(l),m,!0,y,A)};function Qe(l,m,y,A){if(m=l.i.g[String(m)],!m)return!0;m=m.concat();let H=!0;for(let Q=0;Q<m.length;++Q){const fe=m[Q];if(fe&&!fe.da&&fe.capture==y){const De=fe.listener,Ht=fe.ha||fe.src;fe.fa&&ie(l.i,fe),H=De.call(Ht,A)!==!1&&H}}return H&&!A.defaultPrevented}function rt(l,m){if(typeof l!="function")if(l&&typeof l.handleEvent=="function")l=d(l.handleEvent,l);else throw Error("Invalid listener argument");return Number(m)>2147483647?-1:a.setTimeout(l,m||0)}function ge(l){l.g=rt(()=>{l.g=null,l.i&&(l.i=!1,ge(l))},l.l);const m=l.h;l.h=null,l.m.apply(null,m)}class Ee extends S{constructor(m,y){super(),this.m=m,this.l=y,this.h=null,this.i=!1,this.g=null}j(m){this.h=arguments,this.g?this.i=!0:ge(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Me(l){S.call(this),this.h=l,this.g={}}f(Me,S);var He=[];function Kt(l){G(l.g,function(m,y){this.g.hasOwnProperty(y)&&M(m)},l),l.g={}}Me.prototype.N=function(){Me.Z.N.call(this),Kt(this)},Me.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var jt=a.JSON.stringify,fr=a.JSON.parse,zt=class{stringify(l){return a.JSON.stringify(l,void 0)}parse(l){return a.JSON.parse(l,void 0)}};function xn(){}function rn(){}var lt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function sn(){_.call(this,"d")}f(sn,_);function we(){_.call(this,"c")}f(we,_);var ze={},Bt=null;function vt(){return Bt=Bt||new le}ze.Ia="serverreachability";function fn(l){_.call(this,ze.Ia,l)}f(fn,_);function Tn(l){const m=vt();xe(m,new fn(m))}ze.STAT_EVENT="statevent";function ns(l,m){_.call(this,ze.STAT_EVENT,l),this.stat=m}f(ns,_);function an(l){const m=vt();xe(m,new ns(m,l))}ze.Ja="timingevent";function rs(l,m){_.call(this,ze.Ja,l),this.size=m}f(rs,_);function is(l,m){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){l()},m)}function ss(){this.g=!0}ss.prototype.ua=function(){this.g=!1};function $s(l,m,y,A,H,Q){l.info(function(){if(l.g)if(Q){var fe="",De=Q.split("&");for(let dt=0;dt<De.length;dt++){var Ht=De[dt].split("=");if(Ht.length>1){const Xt=Ht[0];Ht=Ht[1];const yr=Xt.split("_");fe=yr.length>=2&&yr[1]=="type"?fe+(Xt+"="+Ht+"&"):fe+(Xt+"=redacted&")}}}else fe=null;else fe=Q;return"XMLHTTP REQ ("+A+") [attempt "+H+"]: "+m+`
`+y+`
`+fe})}function $d(l,m,y,A,H,Q,fe){l.info(function(){return"XMLHTTP RESP ("+A+") [ attempt "+H+"]: "+m+`
`+y+`
`+Q+" "+fe})}function ni(l,m,y,A){l.info(function(){return"XMLHTTP TEXT ("+m+"): "+Pe(l,y)+(A?" "+A:"")})}function ue(l,m){l.info(function(){return"TIMEOUT: "+m})}ss.prototype.info=function(){};function Pe(l,m){if(!l.g)return m;if(!m)return null;try{const Q=JSON.parse(m);if(Q){for(l=0;l<Q.length;l++)if(Array.isArray(Q[l])){var y=Q[l];if(!(y.length<2)){var A=y[1];if(Array.isArray(A)&&!(A.length<1)){var H=A[0];if(H!="noop"&&H!="stop"&&H!="close")for(let fe=1;fe<A.length;fe++)A[fe]=""}}}}return jt(Q)}catch{return m}}var Ke={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ut={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Te;function it(){}f(it,xn),it.prototype.g=function(){return new XMLHttpRequest},Te=new it;function Le(l){return encodeURIComponent(String(l))}function Ot(l){var m=1;l=l.split(":");const y=[];for(;m>0&&l.length;)y.push(l.shift()),m--;return l.length&&y.push(l.join(":")),y}function $t(l,m,y,A){this.j=l,this.i=m,this.l=y,this.S=A||1,this.V=new Me(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ne}function Ne(){this.i=null,this.g="",this.h=!1}var Xe={},et={};function pt(l,m,y){l.M=1,l.A=Kl(gr(m)),l.u=y,l.R=!0,nr(l,null)}function nr(l,m){l.F=Date.now(),mr(l),l.B=gr(l.A);var y=l.B,A=l.S;Array.isArray(A)||(A=[String(A)]),ey(y.i,"t",A),l.C=0,y=l.j.L,l.h=new Ne,l.g=vy(l.j,y?m:null,!l.u),l.P>0&&(l.O=new Ee(d(l.Y,l,l.g),l.P)),m=l.V,y=l.g,A=l.ba;var H="readystatechange";Array.isArray(H)||(H&&(He[0]=H.toString()),H=He);for(let Q=0;Q<H.length;Q++){const fe=q(y,H[Q],A||m.handleEvent,!1,m.h||m);if(!fe)break;m.g[fe.key]=fe}m=l.J?$(l.J):{},l.u?(l.v||(l.v="POST"),m["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.B,l.v,l.u,m)):(l.v="GET",l.g.ea(l.B,l.v,null,m)),Tn(),$s(l.i,l.v,l.B,l.l,l.S,l.u)}$t.prototype.ba=function(l){l=l.target;const m=this.O;m&&si(l)==3?m.j():this.Y(l)},$t.prototype.Y=function(l){try{if(l==this.g)e:{const De=si(this.g),Ht=this.g.ya(),dt=this.g.ca();if(!(De<3)&&(De!=3||this.g&&(this.h.h||this.g.la()||oy(this.g)))){this.K||De!=4||Ht==7||(Ht==8||dt<=0?Tn(3):Tn(2)),Hd(this);var m=this.g.ca();this.X=m;var y=eo(this);if(this.o=m==200,$d(this.i,this.v,this.B,this.l,this.S,De,m),this.o){if(this.U&&!this.L){t:{if(this.g){var A,H=this.g;if((A=H.g?H.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!T(A)){var Q=A;break t}}Q=null}if(l=Q)ni(this.i,this.l,l,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,qd(this,l);else{this.o=!1,this.m=3,an(12),os(this),no(this);break e}}if(this.R){l=!0;let Xt;for(;!this.K&&this.C<y.length;)if(Xt=to(this,y),Xt==et){De==4&&(this.m=4,an(14),l=!1),ni(this.i,this.l,null,"[Incomplete Response]");break}else if(Xt==Xe){this.m=4,an(15),ni(this.i,this.l,y,"[Invalid Chunk]"),l=!1;break}else ni(this.i,this.l,Xt,null),qd(this,Xt);if(as(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),De!=4||y.length!=0||this.h.h||(this.m=1,an(16),l=!1),this.o=this.o&&l,!l)ni(this.i,this.l,y,"[Invalid Chunked Response]"),os(this),no(this);else if(y.length>0&&!this.W){this.W=!0;var fe=this.j;fe.g==this&&fe.aa&&!fe.P&&(fe.j.info("Great, no buffering proxy detected. Bytes received: "+y.length),Zd(fe),fe.P=!0,an(11))}}else ni(this.i,this.l,y,null),qd(this,y);De==4&&os(this),this.o&&!this.K&&(De==4?my(this.j,this):(this.o=!1,mr(this)))}else ok(this.g),m==400&&y.indexOf("Unknown SID")>0?(this.m=3,an(12)):(this.m=0,an(13)),os(this),no(this)}}}catch{}finally{}};function eo(l){if(!as(l))return l.g.la();const m=oy(l.g);if(m==="")return"";let y="";const A=m.length,H=si(l.g)==4;if(!l.h.i){if(typeof TextDecoder>"u")return os(l),no(l),"";l.h.i=new a.TextDecoder}for(let Q=0;Q<A;Q++)l.h.h=!0,y+=l.h.i.decode(m[Q],{stream:!(H&&Q==A-1)});return m.length=0,l.h.g+=y,l.C=0,l.h.g}function as(l){return l.g?l.v=="GET"&&l.M!=2&&l.j.Aa:!1}function to(l,m){var y=l.C,A=m.indexOf(`
`,y);return A==-1?et:(y=Number(m.substring(y,A)),isNaN(y)?Xe:(A+=1,A+y>m.length?et:(m=m.slice(A,A+y),l.C=A+y,m)))}$t.prototype.cancel=function(){this.K=!0,os(this)};function mr(l){l.T=Date.now()+l.H,pr(l,l.H)}function pr(l,m){if(l.D!=null)throw Error("WatchDog timer not null");l.D=is(d(l.aa,l),m)}function Hd(l){l.D&&(a.clearTimeout(l.D),l.D=null)}$t.prototype.aa=function(){this.D=null;const l=Date.now();l-this.T>=0?(ue(this.i,this.B),this.M!=2&&(Tn(),an(17)),os(this),this.m=2,no(this)):pr(this,this.T-l)};function no(l){l.j.I==0||l.K||my(l.j,l)}function os(l){Hd(l);var m=l.O;m&&typeof m.dispose=="function"&&m.dispose(),l.O=null,Kt(l.V),l.g&&(m=l.g,l.g=null,m.abort(),m.dispose())}function qd(l,m){try{var y=l.j;if(y.I!=0&&(y.g==l||Wd(y.h,l))){if(!l.L&&Wd(y.h,l)&&y.I==3){try{var A=y.Ba.g.parse(m)}catch{A=null}if(Array.isArray(A)&&A.length==3){var H=A;if(H[0]==0){e:if(!y.v){if(y.g)if(y.g.F+3e3<l.F)eu(y),Jl(y);else break e;Jd(y),an(18)}}else y.xa=H[1],0<y.xa-y.K&&H[2]<37500&&y.F&&y.A==0&&!y.C&&(y.C=is(d(y.Va,y),6e3));Wg(y.h)<=1&&y.ta&&(y.ta=void 0)}else us(y,11)}else if((l.L||y.g==l)&&eu(y),!T(m))for(H=y.Ba.g.parse(m),m=0;m<H.length;m++){let dt=H[m];const Xt=dt[0];if(!(Xt<=y.K))if(y.K=Xt,dt=dt[1],y.I==2)if(dt[0]=="c"){y.M=dt[1],y.ba=dt[2];const yr=dt[3];yr!=null&&(y.ka=yr,y.j.info("VER="+y.ka));const Ws=dt[4];Ws!=null&&(y.za=Ws,y.j.info("SVER="+y.za));const ai=dt[5];ai!=null&&typeof ai=="number"&&ai>0&&(A=1.5*ai,y.O=A,y.j.info("backChannelRequestTimeoutMs_="+A)),A=y;const oi=l.g;if(oi){const nu=oi.g?oi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(nu){var Q=A.h;Q.g||nu.indexOf("spdy")==-1&&nu.indexOf("quic")==-1&&nu.indexOf("h2")==-1||(Q.j=Q.l,Q.g=new Set,Q.h&&(Gd(Q,Q.h),Q.h=null))}if(A.G){const eh=oi.g?oi.g.getResponseHeader("X-HTTP-Session-Id"):null;eh&&(A.wa=eh,ct(A.J,A.G,eh))}}y.I=3,y.l&&y.l.ra(),y.aa&&(y.T=Date.now()-l.F,y.j.info("Handshake RTT: "+y.T+"ms")),A=y;var fe=l;if(A.na=yy(A,A.L?A.ba:null,A.W),fe.L){Gg(A.h,fe);var De=fe,Ht=A.O;Ht&&(De.H=Ht),De.D&&(Hd(De),mr(De)),A.g=fe}else hy(A);y.i.length>0&&Zl(y)}else dt[0]!="stop"&&dt[0]!="close"||us(y,7);else y.I==3&&(dt[0]=="stop"||dt[0]=="close"?dt[0]=="stop"?us(y,7):Yd(y):dt[0]!="noop"&&y.l&&y.l.qa(dt),y.A=0)}}Tn(4)}catch{}}var Q_=class{constructor(l,m){this.g=l,this.map=m}};function Hg(l){this.l=l||10,a.PerformanceNavigationTiming?(l=a.performance.getEntriesByType("navigation"),l=l.length>0&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function qg(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function Wg(l){return l.h?1:l.g?l.g.size:0}function Wd(l,m){return l.h?l.h==m:l.g?l.g.has(m):!1}function Gd(l,m){l.g?l.g.add(m):l.h=m}function Gg(l,m){l.h&&l.h==m?l.h=null:l.g&&l.g.has(m)&&l.g.delete(m)}Hg.prototype.cancel=function(){if(this.i=Qg(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function Qg(l){if(l.h!=null)return l.i.concat(l.h.G);if(l.g!=null&&l.g.size!==0){let m=l.i;for(const y of l.g.values())m=m.concat(y.G);return m}return g(l.i)}var Kg=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function K_(l,m){if(l){l=l.split("&");for(let y=0;y<l.length;y++){const A=l[y].indexOf("=");let H,Q=null;A>=0?(H=l[y].substring(0,A),Q=l[y].substring(A+1)):H=l[y],m(H,Q?decodeURIComponent(Q.replace(/\+/g," ")):"")}}}function ri(l){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let m;l instanceof ri?(this.l=l.l,ro(this,l.j),this.o=l.o,this.g=l.g,io(this,l.u),this.h=l.h,Qd(this,ty(l.i)),this.m=l.m):l&&(m=String(l).match(Kg))?(this.l=!1,ro(this,m[1]||"",!0),this.o=so(m[2]||""),this.g=so(m[3]||"",!0),io(this,m[4]),this.h=so(m[5]||"",!0),Qd(this,m[6]||"",!0),this.m=so(m[7]||"")):(this.l=!1,this.i=new oo(null,this.l))}ri.prototype.toString=function(){const l=[];var m=this.j;m&&l.push(ao(m,Xg,!0),":");var y=this.g;return(y||m=="file")&&(l.push("//"),(m=this.o)&&l.push(ao(m,Xg,!0),"@"),l.push(Le(y).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y=this.u,y!=null&&l.push(":",String(y))),(y=this.h)&&(this.g&&y.charAt(0)!="/"&&l.push("/"),l.push(ao(y,y.charAt(0)=="/"?J_:Y_,!0))),(y=this.i.toString())&&l.push("?",y),(y=this.m)&&l.push("#",ao(y,ek)),l.join("")},ri.prototype.resolve=function(l){const m=gr(this);let y=!!l.j;y?ro(m,l.j):y=!!l.o,y?m.o=l.o:y=!!l.g,y?m.g=l.g:y=l.u!=null;var A=l.h;if(y)io(m,l.u);else if(y=!!l.h){if(A.charAt(0)!="/")if(this.g&&!this.h)A="/"+A;else{var H=m.h.lastIndexOf("/");H!=-1&&(A=m.h.slice(0,H+1)+A)}if(H=A,H==".."||H==".")A="";else if(H.indexOf("./")!=-1||H.indexOf("/.")!=-1){A=H.lastIndexOf("/",0)==0,H=H.split("/");const Q=[];for(let fe=0;fe<H.length;){const De=H[fe++];De=="."?A&&fe==H.length&&Q.push(""):De==".."?((Q.length>1||Q.length==1&&Q[0]!="")&&Q.pop(),A&&fe==H.length&&Q.push("")):(Q.push(De),A=!0)}A=Q.join("/")}else A=H}return y?m.h=A:y=l.i.toString()!=="",y?Qd(m,ty(l.i)):y=!!l.m,y&&(m.m=l.m),m};function gr(l){return new ri(l)}function ro(l,m,y){l.j=y?so(m,!0):m,l.j&&(l.j=l.j.replace(/:$/,""))}function io(l,m){if(m){if(m=Number(m),isNaN(m)||m<0)throw Error("Bad port number "+m);l.u=m}else l.u=null}function Qd(l,m,y){m instanceof oo?(l.i=m,tk(l.i,l.l)):(y||(m=ao(m,Z_)),l.i=new oo(m,l.l))}function ct(l,m,y){l.i.set(m,y)}function Kl(l){return ct(l,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),l}function so(l,m){return l?m?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function ao(l,m,y){return typeof l=="string"?(l=encodeURI(l).replace(m,X_),y&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function X_(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var Xg=/[#\/\?@]/g,Y_=/[#\?:]/g,J_=/[#\?]/g,Z_=/[#\?@]/g,ek=/#/g;function oo(l,m){this.h=this.g=null,this.i=l||null,this.j=!!m}function ls(l){l.g||(l.g=new Map,l.h=0,l.i&&K_(l.i,function(m,y){l.add(decodeURIComponent(m.replace(/\+/g," ")),y)}))}t=oo.prototype,t.add=function(l,m){ls(this),this.i=null,l=Hs(this,l);let y=this.g.get(l);return y||this.g.set(l,y=[]),y.push(m),this.h+=1,this};function Yg(l,m){ls(l),m=Hs(l,m),l.g.has(m)&&(l.i=null,l.h-=l.g.get(m).length,l.g.delete(m))}function Jg(l,m){return ls(l),m=Hs(l,m),l.g.has(m)}t.forEach=function(l,m){ls(this),this.g.forEach(function(y,A){y.forEach(function(H){l.call(m,H,A,this)},this)},this)};function Zg(l,m){ls(l);let y=[];if(typeof m=="string")Jg(l,m)&&(y=y.concat(l.g.get(Hs(l,m))));else for(l=Array.from(l.g.values()),m=0;m<l.length;m++)y=y.concat(l[m]);return y}t.set=function(l,m){return ls(this),this.i=null,l=Hs(this,l),Jg(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[m]),this.h+=1,this},t.get=function(l,m){return l?(l=Zg(this,l),l.length>0?String(l[0]):m):m};function ey(l,m,y){Yg(l,m),y.length>0&&(l.i=null,l.g.set(Hs(l,m),g(y)),l.h+=y.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],m=Array.from(this.g.keys());for(let A=0;A<m.length;A++){var y=m[A];const H=Le(y);y=Zg(this,y);for(let Q=0;Q<y.length;Q++){let fe=H;y[Q]!==""&&(fe+="="+Le(y[Q])),l.push(fe)}}return this.i=l.join("&")};function ty(l){const m=new oo;return m.i=l.i,l.g&&(m.g=new Map(l.g),m.h=l.h),m}function Hs(l,m){return m=String(m),l.j&&(m=m.toLowerCase()),m}function tk(l,m){m&&!l.j&&(ls(l),l.i=null,l.g.forEach(function(y,A){const H=A.toLowerCase();A!=H&&(Yg(this,A),ey(this,H,y))},l)),l.j=m}function nk(l,m){const y=new ss;if(a.Image){const A=new Image;A.onload=h(ii,y,"TestLoadImage: loaded",!0,m,A),A.onerror=h(ii,y,"TestLoadImage: error",!1,m,A),A.onabort=h(ii,y,"TestLoadImage: abort",!1,m,A),A.ontimeout=h(ii,y,"TestLoadImage: timeout",!1,m,A),a.setTimeout(function(){A.ontimeout&&A.ontimeout()},1e4),A.src=l}else m(!1)}function rk(l,m){const y=new ss,A=new AbortController,H=setTimeout(()=>{A.abort(),ii(y,"TestPingServer: timeout",!1,m)},1e4);fetch(l,{signal:A.signal}).then(Q=>{clearTimeout(H),Q.ok?ii(y,"TestPingServer: ok",!0,m):ii(y,"TestPingServer: server error",!1,m)}).catch(()=>{clearTimeout(H),ii(y,"TestPingServer: error",!1,m)})}function ii(l,m,y,A,H){try{H&&(H.onload=null,H.onerror=null,H.onabort=null,H.ontimeout=null),A(y)}catch{}}function ik(){this.g=new zt}function Kd(l){this.i=l.Sb||null,this.h=l.ab||!1}f(Kd,xn),Kd.prototype.g=function(){return new Xl(this.i,this.h)};function Xl(l,m){le.call(this),this.H=l,this.o=m,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(Xl,le),t=Xl.prototype,t.open=function(l,m){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=l,this.D=m,this.readyState=1,uo(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const m={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};l&&(m.body=l),(this.H||a).fetch(new Request(this.D,m)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,lo(this)),this.readyState=0},t.Pa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,uo(this)),this.g&&(this.readyState=3,uo(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;ny(this)}else l.text().then(this.Oa.bind(this),this.ga.bind(this))};function ny(l){l.j.read().then(l.Ma.bind(l)).catch(l.ga.bind(l))}t.Ma=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var m=l.value?l.value:new Uint8Array(0);(m=this.B.decode(m,{stream:!l.done}))&&(this.response=this.responseText+=m)}l.done?lo(this):uo(this),this.readyState==3&&ny(this)}},t.Oa=function(l){this.g&&(this.response=this.responseText=l,lo(this))},t.Na=function(l){this.g&&(this.response=l,lo(this))},t.ga=function(){this.g&&lo(this)};function lo(l){l.readyState=4,l.l=null,l.j=null,l.B=null,uo(l)}t.setRequestHeader=function(l,m){this.A.append(l,m)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],m=this.h.entries();for(var y=m.next();!y.done;)y=y.value,l.push(y[0]+": "+y[1]),y=m.next();return l.join(`\r
`)};function uo(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(Xl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function ry(l){let m="";return G(l,function(y,A){m+=A,m+=":",m+=y,m+=`\r
`}),m}function Xd(l,m,y){e:{for(A in y){var A=!1;break e}A=!0}A||(y=ry(y),typeof l=="string"?y!=null&&Le(y):ct(l,m,y))}function kt(l){le.call(this),this.headers=new Map,this.L=l||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(kt,le);var sk=/^https?$/i,ak=["POST","PUT"];t=kt.prototype,t.Fa=function(l){this.H=l},t.ea=function(l,m,y,A){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);m=m?m.toUpperCase():"GET",this.D=l,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Te.g(),this.g.onreadystatechange=p(d(this.Ca,this));try{this.B=!0,this.g.open(m,String(l),!0),this.B=!1}catch(Q){iy(this,Q);return}if(l=y||"",y=new Map(this.headers),A)if(Object.getPrototypeOf(A)===Object.prototype)for(var H in A)y.set(H,A[H]);else if(typeof A.keys=="function"&&typeof A.get=="function")for(const Q of A.keys())y.set(Q,A.get(Q));else throw Error("Unknown input type for opt_headers: "+String(A));A=Array.from(y.keys()).find(Q=>Q.toLowerCase()=="content-type"),H=a.FormData&&l instanceof a.FormData,!(Array.prototype.indexOf.call(ak,m,void 0)>=0)||A||H||y.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Q,fe]of y)this.g.setRequestHeader(Q,fe);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(l),this.v=!1}catch(Q){iy(this,Q)}};function iy(l,m){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=m,l.o=5,sy(l),Yl(l)}function sy(l){l.A||(l.A=!0,xe(l,"complete"),xe(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=l||7,xe(this,"complete"),xe(this,"abort"),Yl(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Yl(this,!0)),kt.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?ay(this):this.Xa())},t.Xa=function(){ay(this)};function ay(l){if(l.h&&typeof s<"u"){if(l.v&&si(l)==4)setTimeout(l.Ca.bind(l),0);else if(xe(l,"readystatechange"),si(l)==4){l.h=!1;try{const Q=l.ca();e:switch(Q){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var m=!0;break e;default:m=!1}var y;if(!(y=m)){var A;if(A=Q===0){let fe=String(l.D).match(Kg)[1]||null;!fe&&a.self&&a.self.location&&(fe=a.self.location.protocol.slice(0,-1)),A=!sk.test(fe?fe.toLowerCase():"")}y=A}if(y)xe(l,"complete"),xe(l,"success");else{l.o=6;try{var H=si(l)>2?l.g.statusText:""}catch{H=""}l.l=H+" ["+l.ca()+"]",sy(l)}}finally{Yl(l)}}}}function Yl(l,m){if(l.g){l.m&&(clearTimeout(l.m),l.m=null);const y=l.g;l.g=null,m||xe(l,"ready");try{y.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function si(l){return l.g?l.g.readyState:0}t.ca=function(){try{return si(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(l){if(this.g){var m=this.g.responseText;return l&&m.indexOf(l)==0&&(m=m.substring(l.length)),fr(m)}};function oy(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.F){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function ok(l){const m={};l=(l.g&&si(l)>=2&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let A=0;A<l.length;A++){if(T(l[A]))continue;var y=Ot(l[A]);const H=y[0];if(y=y[1],typeof y!="string")continue;y=y.trim();const Q=m[H]||[];m[H]=Q,Q.push(y)}z(m,function(A){return A.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function co(l,m,y){return y&&y.internalChannelParams&&y.internalChannelParams[l]||m}function ly(l){this.za=0,this.i=[],this.j=new ss,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=co("failFast",!1,l),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=co("baseRetryDelayMs",5e3,l),this.Za=co("retryDelaySeedMs",1e4,l),this.Ta=co("forwardChannelMaxRetries",2,l),this.va=co("forwardChannelRequestTimeoutMs",2e4,l),this.ma=l&&l.xmlHttpFactory||void 0,this.Ua=l&&l.Rb||void 0,this.Aa=l&&l.useFetchStreams||!1,this.O=void 0,this.L=l&&l.supportsCrossDomainXhr||!1,this.M="",this.h=new Hg(l&&l.concurrentRequestLimit),this.Ba=new ik,this.S=l&&l.fastHandshake||!1,this.R=l&&l.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=l&&l.Pb||!1,l&&l.ua&&this.j.ua(),l&&l.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&l&&l.detectBufferingProxy||!1,this.ia=void 0,l&&l.longPollingTimeout&&l.longPollingTimeout>0&&(this.ia=l.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=ly.prototype,t.ka=8,t.I=1,t.connect=function(l,m,y,A){an(0),this.W=l,this.H=m||{},y&&A!==void 0&&(this.H.OSID=y,this.H.OAID=A),this.F=this.X,this.J=yy(this,null,this.W),Zl(this)};function Yd(l){if(uy(l),l.I==3){var m=l.V++,y=gr(l.J);if(ct(y,"SID",l.M),ct(y,"RID",m),ct(y,"TYPE","terminate"),ho(l,y),m=new $t(l,l.j,m),m.M=2,m.A=Kl(gr(y)),y=!1,a.navigator&&a.navigator.sendBeacon)try{y=a.navigator.sendBeacon(m.A.toString(),"")}catch{}!y&&a.Image&&(new Image().src=m.A,y=!0),y||(m.g=vy(m.j,null),m.g.ea(m.A)),m.F=Date.now(),mr(m)}gy(l)}function Jl(l){l.g&&(Zd(l),l.g.cancel(),l.g=null)}function uy(l){Jl(l),l.v&&(a.clearTimeout(l.v),l.v=null),eu(l),l.h.cancel(),l.m&&(typeof l.m=="number"&&a.clearTimeout(l.m),l.m=null)}function Zl(l){if(!qg(l.h)&&!l.m){l.m=!0;var m=l.Ea;R||x(),F||(R(),F=!0),E.add(m,l),l.D=0}}function lk(l,m){return Wg(l.h)>=l.h.j-(l.m?1:0)?!1:l.m?(l.i=m.G.concat(l.i),!0):l.I==1||l.I==2||l.D>=(l.Sa?0:l.Ta)?!1:(l.m=is(d(l.Ea,l,m),py(l,l.D)),l.D++,!0)}t.Ea=function(l){if(this.m)if(this.m=null,this.I==1){if(!l){this.V=Math.floor(Math.random()*1e5),l=this.V++;const H=new $t(this,this.j,l);let Q=this.o;if(this.U&&(Q?(Q=$(Q),ee(Q,this.U)):Q=this.U),this.u!==null||this.R||(H.J=Q,Q=null),this.S)e:{for(var m=0,y=0;y<this.i.length;y++){t:{var A=this.i[y];if("__data__"in A.map&&(A=A.map.__data__,typeof A=="string")){A=A.length;break t}A=void 0}if(A===void 0)break;if(m+=A,m>4096){m=y;break e}if(m===4096||y===this.i.length-1){m=y+1;break e}}m=1e3}else m=1e3;m=dy(this,H,m),y=gr(this.J),ct(y,"RID",l),ct(y,"CVER",22),this.G&&ct(y,"X-HTTP-Session-Id",this.G),ho(this,y),Q&&(this.R?m="headers="+Le(ry(Q))+"&"+m:this.u&&Xd(y,this.u,Q)),Gd(this.h,H),this.Ra&&ct(y,"TYPE","init"),this.S?(ct(y,"$req",m),ct(y,"SID","null"),H.U=!0,pt(H,y,null)):pt(H,y,m),this.I=2}}else this.I==3&&(l?cy(this,l):this.i.length==0||qg(this.h)||cy(this))};function cy(l,m){var y;m?y=m.l:y=l.V++;const A=gr(l.J);ct(A,"SID",l.M),ct(A,"RID",y),ct(A,"AID",l.K),ho(l,A),l.u&&l.o&&Xd(A,l.u,l.o),y=new $t(l,l.j,y,l.D+1),l.u===null&&(y.J=l.o),m&&(l.i=m.G.concat(l.i)),m=dy(l,y,1e3),y.H=Math.round(l.va*.5)+Math.round(l.va*.5*Math.random()),Gd(l.h,y),pt(y,A,m)}function ho(l,m){l.H&&G(l.H,function(y,A){ct(m,A,y)}),l.l&&G({},function(y,A){ct(m,A,y)})}function dy(l,m,y){y=Math.min(l.i.length,y);const A=l.l?d(l.l.Ka,l.l,l):null;e:{var H=l.i;let De=-1;for(;;){const Ht=["count="+y];De==-1?y>0?(De=H[0].g,Ht.push("ofs="+De)):De=0:Ht.push("ofs="+De);let dt=!0;for(let Xt=0;Xt<y;Xt++){var Q=H[Xt].g;const yr=H[Xt].map;if(Q-=De,Q<0)De=Math.max(0,H[Xt].g-100),dt=!1;else try{Q="req"+Q+"_"||"";try{var fe=yr instanceof Map?yr:Object.entries(yr);for(const[Ws,ai]of fe){let oi=ai;u(ai)&&(oi=jt(ai)),Ht.push(Q+Ws+"="+encodeURIComponent(oi))}}catch(Ws){throw Ht.push(Q+"type="+encodeURIComponent("_badmap")),Ws}}catch{A&&A(yr)}}if(dt){fe=Ht.join("&");break e}}fe=void 0}return l=l.i.splice(0,y),m.G=l,fe}function hy(l){if(!l.g&&!l.v){l.Y=1;var m=l.Da;R||x(),F||(R(),F=!0),E.add(m,l),l.A=0}}function Jd(l){return l.g||l.v||l.A>=3?!1:(l.Y++,l.v=is(d(l.Da,l),py(l,l.A)),l.A++,!0)}t.Da=function(){if(this.v=null,fy(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var l=4*this.T;this.j.info("BP detection timer enabled: "+l),this.B=is(d(this.Wa,this),l)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,an(10),Jl(this),fy(this))};function Zd(l){l.B!=null&&(a.clearTimeout(l.B),l.B=null)}function fy(l){l.g=new $t(l,l.j,"rpc",l.Y),l.u===null&&(l.g.J=l.o),l.g.P=0;var m=gr(l.na);ct(m,"RID","rpc"),ct(m,"SID",l.M),ct(m,"AID",l.K),ct(m,"CI",l.F?"0":"1"),!l.F&&l.ia&&ct(m,"TO",l.ia),ct(m,"TYPE","xmlhttp"),ho(l,m),l.u&&l.o&&Xd(m,l.u,l.o),l.O&&(l.g.H=l.O);var y=l.g;l=l.ba,y.M=1,y.A=Kl(gr(m)),y.u=null,y.R=!0,nr(y,l)}t.Va=function(){this.C!=null&&(this.C=null,Jl(this),Jd(this),an(19))};function eu(l){l.C!=null&&(a.clearTimeout(l.C),l.C=null)}function my(l,m){var y=null;if(l.g==m){eu(l),Zd(l),l.g=null;var A=2}else if(Wd(l.h,m))y=m.G,Gg(l.h,m),A=1;else return;if(l.I!=0){if(m.o)if(A==1){y=m.u?m.u.length:0,m=Date.now()-m.F;var H=l.D;A=vt(),xe(A,new rs(A,y)),Zl(l)}else hy(l);else if(H=m.m,H==3||H==0&&m.X>0||!(A==1&&lk(l,m)||A==2&&Jd(l)))switch(y&&y.length>0&&(m=l.h,m.i=m.i.concat(y)),H){case 1:us(l,5);break;case 4:us(l,10);break;case 3:us(l,6);break;default:us(l,2)}}}function py(l,m){let y=l.Qa+Math.floor(Math.random()*l.Za);return l.isActive()||(y*=2),y*m}function us(l,m){if(l.j.info("Error code "+m),m==2){var y=d(l.bb,l),A=l.Ua;const H=!A;A=new ri(A||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||ro(A,"https"),Kl(A),H?nk(A.toString(),y):rk(A.toString(),y)}else an(2);l.I=0,l.l&&l.l.pa(m),gy(l),uy(l)}t.bb=function(l){l?(this.j.info("Successfully pinged google.com"),an(2)):(this.j.info("Failed to ping google.com"),an(1))};function gy(l){if(l.I=0,l.ja=[],l.l){const m=Qg(l.h);(m.length!=0||l.i.length!=0)&&(b(l.ja,m),b(l.ja,l.i),l.h.i.length=0,g(l.i),l.i.length=0),l.l.oa()}}function yy(l,m,y){var A=y instanceof ri?gr(y):new ri(y);if(A.g!="")m&&(A.g=m+"."+A.g),io(A,A.u);else{var H=a.location;A=H.protocol,m=m?m+"."+H.hostname:H.hostname,H=+H.port;const Q=new ri(null);A&&ro(Q,A),m&&(Q.g=m),H&&io(Q,H),y&&(Q.h=y),A=Q}return y=l.G,m=l.wa,y&&m&&ct(A,y,m),ct(A,"VER",l.ka),ho(l,A),A}function vy(l,m,y){if(m&&!l.L)throw Error("Can't create secondary domain capable XhrIo object.");return m=l.Aa&&!l.ma?new kt(new Kd({ab:y})):new kt(l.ma),m.Fa(l.L),m}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function by(){}t=by.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function tu(){}tu.prototype.g=function(l,m){return new Ln(l,m)};function Ln(l,m){le.call(this),this.g=new ly(m),this.l=l,this.h=m&&m.messageUrlParams||null,l=m&&m.messageHeaders||null,m&&m.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=m&&m.initMessageHeaders||null,m&&m.messageContentType&&(l?l["X-WebChannel-Content-Type"]=m.messageContentType:l={"X-WebChannel-Content-Type":m.messageContentType}),m&&m.sa&&(l?l["X-WebChannel-Client-Profile"]=m.sa:l={"X-WebChannel-Client-Profile":m.sa}),this.g.U=l,(l=m&&m.Qb)&&!T(l)&&(this.g.u=l),this.A=m&&m.supportsCrossDomainXhr||!1,this.v=m&&m.sendRawJson||!1,(m=m&&m.httpSessionIdParam)&&!T(m)&&(this.g.G=m,l=this.h,l!==null&&m in l&&(l=this.h,m in l&&delete l[m])),this.j=new qs(this)}f(Ln,le),Ln.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Ln.prototype.close=function(){Yd(this.g)},Ln.prototype.o=function(l){var m=this.g;if(typeof l=="string"){var y={};y.__data__=l,l=y}else this.v&&(y={},y.__data__=jt(l),l=y);m.i.push(new Q_(m.Ya++,l)),m.I==3&&Zl(m)},Ln.prototype.N=function(){this.g.l=null,delete this.j,Yd(this.g),delete this.g,Ln.Z.N.call(this)};function wy(l){sn.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var m=l.__sm__;if(m){e:{for(const y in m){l=y;break e}l=void 0}(this.i=l)&&(l=this.i,m=m!==null&&l in m?m[l]:void 0),this.data=m}else this.data=l}f(wy,sn);function Sy(){we.call(this),this.status=1}f(Sy,we);function qs(l){this.g=l}f(qs,by),qs.prototype.ra=function(){xe(this.g,"a")},qs.prototype.qa=function(l){xe(this.g,new wy(l))},qs.prototype.pa=function(l){xe(this.g,new Sy)},qs.prototype.oa=function(){xe(this.g,"b")},tu.prototype.createWebChannel=tu.prototype.g,Ln.prototype.send=Ln.prototype.o,Ln.prototype.open=Ln.prototype.m,Ln.prototype.close=Ln.prototype.close,J1=function(){return new tu},Y1=function(){return vt()},X1=ze,lm={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Ke.NO_ERROR=0,Ke.TIMEOUT=8,Ke.HTTP_ERROR=6,Yu=Ke,ut.COMPLETE="complete",K1=ut,rn.EventType=lt,lt.OPEN="a",lt.CLOSE="b",lt.ERROR="c",lt.MESSAGE="d",le.prototype.listen=le.prototype.J,Ao=rn,kt.prototype.listenOnce=kt.prototype.K,kt.prototype.getLastError=kt.prototype.Ha,kt.prototype.getLastErrorCode=kt.prototype.ya,kt.prototype.getStatus=kt.prototype.ca,kt.prototype.getResponseJson=kt.prototype.La,kt.prototype.getResponseText=kt.prototype.la,kt.prototype.send=kt.prototype.ea,kt.prototype.setWithCredentials=kt.prototype.Fa,Q1=kt}).apply(typeof Su<"u"?Su:typeof self<"u"?self:typeof window<"u"?window:{});const ob="@firebase/firestore",lb="4.9.2";/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class yn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}yn.UNAUTHENTICATED=new yn(null),yn.GOOGLE_CREDENTIALS=new yn("google-credentials-uid"),yn.FIRST_PARTY=new yn("first-party-uid"),yn.MOCK_USER=new yn("mock-user");/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/let Ka="12.3.0";/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const js=new Vp("@firebase/firestore");function Js(){return js.logLevel}function ye(t,...e){if(js.logLevel<=Fe.DEBUG){const n=e.map(Hp);js.debug(`Firestore (${Ka}): ${t}`,...n)}}function Kr(t,...e){if(js.logLevel<=Fe.ERROR){const n=e.map(Hp);js.error(`Firestore (${Ka}): ${t}`,...n)}}function Ra(t,...e){if(js.logLevel<=Fe.WARN){const n=e.map(Hp);js.warn(`Firestore (${Ka}): ${t}`,...n)}}function Hp(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(e){return JSON.stringify(e)}(t)}catch{return t}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function _e(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,Z1(t,r,n)}function Z1(t,e,n){let r=`FIRESTORE (${Ka}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Kr(r),new Error(r)}function Ze(t,e,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,t||Z1(e,i,r)}function je(t,e){return t}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const J={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class he extends ti{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class $r{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class ex{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class dj{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(yn.UNAUTHENTICATED))}shutdown(){}}class hj{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class fj{constructor(e){this.t=e,this.currentUser=yn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Ze(this.o===void 0,42304);let r=this.i;const i=o=>this.i!==r?(r=this.i,n(o)):Promise.resolve();let s=new $r;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new $r,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const o=s;e.enqueueRetryable(async()=>{await o.promise,await i(this.currentUser)})},u=o=>{ye("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=o,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(o=>u(o)),setTimeout(()=>{if(!this.auth){const o=this.t.getImmediate({optional:!0});o?u(o):(ye("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new $r)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ye("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ze(typeof r.accessToken=="string",31837,{l:r}),new ex(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ze(e===null||typeof e=="string",2055,{h:e}),new yn(e)}}class mj{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=yn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class pj{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new mj(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(yn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class ub{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class gj{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,yi(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Ze(this.o===void 0,3512);const r=s=>{s.error!=null&&ye("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.m;return this.m=s.token,ye("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{ye("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):ye("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new ub(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Ze(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new ub(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function yj(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class qp{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=yj(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%62))}return r}}function Ue(t,e){return t<e?-1:t>e?1:0}function um(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const i=t.charAt(r),s=e.charAt(r);if(i!==s)return Oh(i)===Oh(s)?Ue(i,s):Oh(i)?1:-1}return Ue(t.length,e.length)}const vj=55296,bj=57343;function Oh(t){const e=t.charCodeAt(0);return e>=vj&&e<=bj}function La(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const cb="__name__";class xr{constructor(e,n,r){n===void 0?n=0:n>e.length&&_e(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&_e(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return xr.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof xr?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=xr.compareSegments(e.get(i),n.get(i));if(s!==0)return s}return Ue(e.length,n.length)}static compareSegments(e,n){const r=xr.isNumericId(e),i=xr.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?xr.extractNumericId(e).compare(xr.extractNumericId(n)):um(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Li.fromString(e.substring(4,e.length-2))}}class st extends xr{construct(e,n,r){return new st(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new he(J.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new st(n)}static emptyPath(){return new st([])}}const wj=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class un extends xr{construct(e,n,r){return new un(e,n,r)}static isValidIdentifier(e){return wj.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),un.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===cb}static keyField(){return new un([cb])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new he(J.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;i<e.length;){const u=e[i];if(u==="\\"){if(i+1===e.length)throw new he(J.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const o=e[i+1];if(o!=="\\"&&o!=="."&&o!=="`")throw new he(J.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=o,i+=2}else u==="`"?(a=!a,i++):u!=="."||a?(r+=u,i++):(s(),i++)}if(s(),a)throw new he(J.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new un(n)}static emptyPath(){return new un([])}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Se{constructor(e){this.path=e}static fromPath(e){return new Se(st.fromString(e))}static fromName(e){return new Se(st.fromString(e).popFirst(5))}static empty(){return new Se(st.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&st.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return st.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Se(new st(e.slice()))}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function tx(t,e,n){if(!n)throw new he(J.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Sj(t,e,n,r){if(e===!0&&r===!0)throw new he(J.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function db(t){if(!Se.isDocumentKey(t))throw new he(J.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function hb(t){if(Se.isDocumentKey(t))throw new he(J.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function nx(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function bd(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":_e(12329,{type:typeof t})}function Pr(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new he(J.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=bd(t);throw new he(J.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function xj(t,e){if(e<=0)throw new he(J.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
* @license
* Copyright 2025 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function Vt(t,e){const n={typeString:t};return e&&(n.value=e),n}function Ul(t,e){if(!nx(t))throw new he(J.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const a=t[r];if(i&&typeof a!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&a!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new he(J.INVALID_ARGUMENT,n);return!0}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const fb=-62135596800,mb=1e6;class ft{static now(){return ft.fromMillis(Date.now())}static fromDate(e){return ft.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*mb);return new ft(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new he(J.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new he(J.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<fb)throw new he(J.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new he(J.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/mb}_compareTo(e){return this.seconds===e.seconds?Ue(this.nanoseconds,e.nanoseconds):Ue(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ft._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ul(e,ft._jsonSchema))return new ft(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-fb;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ft._jsonSchemaVersion="firestore/timestamp/1.0",ft._jsonSchema={type:Vt("string",ft._jsonSchemaVersion),seconds:Vt("number"),nanoseconds:Vt("number")};/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Ie{static fromTimestamp(e){return new Ie(e)}static min(){return new Ie(new ft(0,0))}static max(){return new Ie(new ft(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Sl=-1;function Cj(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=Ie.fromTimestamp(r===1e9?new ft(n+1,0):new ft(n,r));return new Bi(i,Se.empty(),e)}function _j(t){return new Bi(t.readTime,t.key,Sl)}class Bi{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Bi(Ie.min(),Se.empty(),Sl)}static max(){return new Bi(Ie.max(),Se.empty(),Sl)}}function kj(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Se.comparator(t.documentKey,e.documentKey),n!==0?n:Ue(t.largestBatchId,e.largestBatchId))}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Ej="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Nj{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/async function Xa(t){if(t.code!==J.FAILED_PRECONDITION||t.message!==Ej)throw t;ye("LocalStore","Unexpectedly lost primary lease")}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class ne{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&_e(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new ne((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof ne?n:ne.resolve(n)}catch(n){return ne.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):ne.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):ne.reject(n)}static resolve(e){return new ne((n,r)=>{n(e)})}static reject(e){return new ne((n,r)=>{r(e)})}static waitFor(e){return new ne((n,r)=>{let i=0,s=0,a=!1;e.forEach(u=>{++i,u.next(()=>{++s,a&&s===i&&n()},o=>r(o))}),a=!0,s===i&&n()})}static or(e){let n=ne.resolve(!1);for(const r of e)n=n.next(i=>i?ne.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new ne((r,i)=>{const s=e.length,a=new Array(s);let u=0;for(let o=0;o<s;o++){const d=o;n(e[d]).next(h=>{a[d]=h,++u,u===s&&r(a)},h=>i(h))}})}static doWhile(e,n){return new ne((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}function Tj(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Ya(t){return t.name==="IndexedDbTransactionError"}/**
* @license
* Copyright 2018 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class wd{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}wd.ce=-1;/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Wp=-1;function Sd(t){return t==null}function Rc(t){return t===0&&1/t==-1/0}function Ij(t){return typeof t=="number"&&Number.isInteger(t)&&!Rc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const rx="";function jj(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=pb(e)),e=Aj(t.get(n),e);return pb(e)}function Aj(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case rx:n+="";break;default:n+=s}}return n}function pb(t){return t+rx+""}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function gb(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ji(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ix(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class _t{constructor(e,n){this.comparator=e,this.root=n||ln.EMPTY}insert(e,n){return new _t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ln.BLACK,null,null))}remove(e){return new _t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ln.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new xu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new xu(this.root,e,this.comparator,!1)}getReverseIterator(){return new xu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new xu(this.root,e,this.comparator,!0)}}class xu{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ln{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??ln.RED,this.left=i??ln.EMPTY,this.right=s??ln.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new ln(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return ln.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return ln.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ln.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ln.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw _e(43730,{key:this.key,value:this.value});if(this.right.isRed())throw _e(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw _e(27949);return e+(this.isRed()?0:1)}}ln.EMPTY=null,ln.RED=!0,ln.BLACK=!1;ln.EMPTY=new class{constructor(){this.size=0}get key(){throw _e(57766)}get value(){throw _e(16141)}get color(){throw _e(16727)}get left(){throw _e(29726)}get right(){throw _e(36894)}copy(t,e,n,r,i){return this}insert(t,e,n){return new ln(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Qt{constructor(e){this.comparator=e,this.data=new _t(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new yb(this.data.getIterator())}getIteratorFrom(e){return new yb(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Qt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Qt(this.comparator);return n.data=e,n}}class yb{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Bn{constructor(e){this.fields=e,e.sort(un.comparator)}static empty(){return new Bn([])}unionWith(e){let n=new Qt(un.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Bn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return La(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
* @license
* Copyright 2023 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class sx extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class hn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(r){try{return atob(r)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new sx("Invalid base64 string: "+i):i}}(e);return new hn(n)}static fromUint8Array(e){const n=function(r){let i="";for(let s=0;s<r.length;++s)i+=String.fromCharCode(r[s]);return i}(e);return new hn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(e){return btoa(e)}(this.binaryString)}toUint8Array(){return function(e){const n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ue(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}hn.EMPTY_BYTE_STRING=new hn("");const Dj=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function $i(t){if(Ze(!!t,39018),typeof t=="string"){let e=0;const n=Dj.exec(t);if(Ze(!!n,46558,{timestamp:t}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Dt(t.seconds),nanos:Dt(t.nanos)}}function Dt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Hi(t){return typeof t=="string"?hn.fromBase64String(t):hn.fromUint8Array(t)}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const ax="server_timestamp",ox="__type__",lx="__previous_value__",ux="__local_write_time__";function xd(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)==null?void 0:e.fields)||{})[ox])==null?void 0:n.stringValue)===ax}function Cd(t){const e=t.mapValue.fields[lx];return xd(e)?Cd(e):e}function xl(t){const e=$i(t.mapValue.fields[ux].timestampValue);return new ft(e.seconds,e.nanos)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Mj{constructor(e,n,r,i,s,a,u,o,d,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=o,this.useFetchStreams=d,this.isUsingEmulator=h}}const Lc="(default)";class Cl{constructor(e,n){this.projectId=e,this.database=n||Lc}static empty(){return new Cl("","")}get isDefaultDatabase(){return this.database===Lc}isEqual(e){return e instanceof Cl&&e.projectId===this.projectId&&e.database===this.database}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const cx="__type__",Pj="__max__",Cu={mapValue:{}},dx="__vector__",Fc="value";function qi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?xd(t)?4:Rj(t)?9007199254740991:Oj(t)?10:11:_e(28295,{value:t})}function Or(t,e){if(t===e)return!0;const n=qi(t);if(n!==qi(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return xl(t).isEqual(xl(e));case 3:return function(r,i){if(typeof r.timestampValue=="string"&&typeof i.timestampValue=="string"&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const s=$i(r.timestampValue),a=$i(i.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(r,i){return Hi(r.bytesValue).isEqual(Hi(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(r,i){return Dt(r.geoPointValue.latitude)===Dt(i.geoPointValue.latitude)&&Dt(r.geoPointValue.longitude)===Dt(i.geoPointValue.longitude)}(t,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return Dt(r.integerValue)===Dt(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const s=Dt(r.doubleValue),a=Dt(i.doubleValue);return s===a?Rc(s)===Rc(a):isNaN(s)&&isNaN(a)}return!1}(t,e);case 9:return La(t.arrayValue.values||[],e.arrayValue.values||[],Or);case 10:case 11:return function(r,i){const s=r.mapValue.fields||{},a=i.mapValue.fields||{};if(gb(s)!==gb(a))return!1;for(const u in s)if(s.hasOwnProperty(u)&&(a[u]===void 0||!Or(s[u],a[u])))return!1;return!0}(t,e);default:return _e(52216,{left:t})}}function _l(t,e){return(t.values||[]).find(n=>Or(n,e))!==void 0}function Fa(t,e){if(t===e)return 0;const n=qi(t),r=qi(e);if(n!==r)return Ue(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ue(t.booleanValue,e.booleanValue);case 2:return function(i,s){const a=Dt(i.integerValue||i.doubleValue),u=Dt(s.integerValue||s.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(t,e);case 3:return vb(t.timestampValue,e.timestampValue);case 4:return vb(xl(t),xl(e));case 5:return um(t.stringValue,e.stringValue);case 6:return function(i,s){const a=Hi(i),u=Hi(s);return a.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,s){const a=i.split("/"),u=s.split("/");for(let o=0;o<a.length&&o<u.length;o++){const d=Ue(a[o],u[o]);if(d!==0)return d}return Ue(a.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,s){const a=Ue(Dt(i.latitude),Dt(s.latitude));return a!==0?a:Ue(Dt(i.longitude),Dt(s.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return bb(t.arrayValue,e.arrayValue);case 10:return function(i,s){var a,u,o,d;const h=i.fields||{},f=s.fields||{},p=(a=h[Fc])==null?void 0:a.arrayValue,g=(u=f[Fc])==null?void 0:u.arrayValue,b=Ue(((o=p==null?void 0:p.values)==null?void 0:o.length)||0,((d=g==null?void 0:g.values)==null?void 0:d.length)||0);return b!==0?b:bb(p,g)}(t.mapValue,e.mapValue);case 11:return function(i,s){if(i===Cu.mapValue&&s===Cu.mapValue)return 0;if(i===Cu.mapValue)return 1;if(s===Cu.mapValue)return-1;const a=i.fields||{},u=Object.keys(a),o=s.fields||{},d=Object.keys(o);u.sort(),d.sort();for(let h=0;h<u.length&&h<d.length;++h){const f=um(u[h],d[h]);if(f!==0)return f;const p=Fa(a[u[h]],o[d[h]]);if(p!==0)return p}return Ue(u.length,d.length)}(t.mapValue,e.mapValue);default:throw _e(23264,{he:n})}}function vb(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ue(t,e);const n=$i(t),r=$i(e),i=Ue(n.seconds,r.seconds);return i!==0?i:Ue(n.nanos,r.nanos)}function bb(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=Fa(n[i],r[i]);if(s)return s}return Ue(n.length,r.length)}function Ua(t){return cm(t)}function cm(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(e){const n=$i(e);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(e){return Hi(e).toBase64()}(t.bytesValue):"referenceValue"in t?function(e){return Se.fromName(e).toString()}(t.referenceValue):"geoPointValue"in t?function(e){return`geo(${e.latitude},${e.longitude})`}(t.geoPointValue):"arrayValue"in t?function(e){let n="[",r=!0;for(const i of e.values||[])r?r=!1:n+=",",n+=cm(i);return n+"]"}(t.arrayValue):"mapValue"in t?function(e){const n=Object.keys(e.fields||{}).sort();let r="{",i=!0;for(const s of n)i?i=!1:r+=",",r+=`${s}:${cm(e.fields[s])}`;return r+"}"}(t.mapValue):_e(61005,{value:t})}function Ju(t){switch(qi(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Cd(t);return e?16+Ju(e):16;case 5:return 2*t.stringValue.length;case 6:return Hi(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((r,i)=>r+Ju(i),0)}(t.arrayValue);case 10:case 11:return function(n){let r=0;return Ji(n.fields,(i,s)=>{r+=i.length+Ju(s)}),r}(t.mapValue);default:throw _e(13486,{value:t})}}function Uc(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function dm(t){return!!t&&"integerValue"in t}function Gp(t){return!!t&&"arrayValue"in t}function wb(t){return!!t&&"nullValue"in t}function Sb(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Zu(t){return!!t&&"mapValue"in t}function Oj(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)==null?void 0:e.fields)||{})[cx])==null?void 0:n.stringValue)===dx}function Qo(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Ji(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Qo(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Qo(t.arrayValue.values[n]);return e}return{...t}}function Rj(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===Pj}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Dn{constructor(e){this.value=e}static empty(){return new Dn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Zu(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Qo(n)}setAll(e){let n=un.emptyPath(),r={},i=[];e.forEach((a,u)=>{if(!n.isImmediateParentOf(u)){const o=this.getFieldsMap(n);this.applyChanges(o,r,i),r={},i=[],n=u.popLast()}a?r[u.lastSegment()]=Qo(a):i.push(u.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Zu(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Or(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Zu(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Ji(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Dn(Qo(this.value))}}function hx(t){const e=[];return Ji(t.fields,(n,r)=>{const i=new un([n]);if(Zu(r)){const s=hx(r.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new Bn(e)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class bn{constructor(e,n,r,i,s,a,u){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=u}static newInvalidDocument(e){return new bn(e,0,Ie.min(),Ie.min(),Ie.min(),Dn.empty(),0)}static newFoundDocument(e,n,r,i){return new bn(e,1,n,Ie.min(),r,i,0)}static newNoDocument(e,n){return new bn(e,2,n,Ie.min(),Ie.min(),Dn.empty(),0)}static newUnknownDocument(e,n){return new bn(e,3,n,Ie.min(),Ie.min(),Dn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Ie.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Dn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Dn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ie.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof bn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new bn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Va{constructor(e,n){this.position=e,this.inclusive=n}}function xb(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],a=t.position[i];if(s.field.isKeyField()?r=Se.comparator(Se.fromName(a.referenceValue),n.key):r=Fa(a,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Cb(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Or(t.position[n],e.position[n]))return!1;return!0}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class kl{constructor(e,n="asc"){this.field=e,this.dir=n}}function Lj(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class fx{}class Ut extends fx{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new Uj(e,n,r):n==="array-contains"?new Bj(e,r):n==="in"?new $j(e,r):n==="not-in"?new Hj(e,r):n==="array-contains-any"?new qj(e,r):new Ut(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new Vj(e,r):new zj(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Fa(n,this.value)):n!==null&&qi(this.value)===qi(n)&&this.matchesComparison(Fa(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return _e(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class hr extends fx{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new hr(e,n)}matches(e){return mx(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function mx(t){return t.op==="and"}function px(t){return Fj(t)&&mx(t)}function Fj(t){for(const e of t.filters)if(e instanceof hr)return!1;return!0}function hm(t){if(t instanceof Ut)return t.field.canonicalString()+t.op.toString()+Ua(t.value);if(px(t))return t.filters.map(e=>hm(e)).join(",");{const e=t.filters.map(n=>hm(n)).join(",");return`${t.op}(${e})`}}function gx(t,e){return t instanceof Ut?function(n,r){return r instanceof Ut&&n.op===r.op&&n.field.isEqual(r.field)&&Or(n.value,r.value)}(t,e):t instanceof hr?function(n,r){return r instanceof hr&&n.op===r.op&&n.filters.length===r.filters.length?n.filters.reduce((i,s,a)=>i&&gx(s,r.filters[a]),!0):!1}(t,e):void _e(19439)}function yx(t){return t instanceof Ut?function(e){return`${e.field.canonicalString()} ${e.op} ${Ua(e.value)}`}(t):t instanceof hr?function(e){return e.op.toString()+" {"+e.getFilters().map(yx).join(" ,")+"}"}(t):"Filter"}class Uj extends Ut{constructor(e,n,r){super(e,n,r),this.key=Se.fromName(r.referenceValue)}matches(e){const n=Se.comparator(e.key,this.key);return this.matchesComparison(n)}}class Vj extends Ut{constructor(e,n){super(e,"in",n),this.keys=vx("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class zj extends Ut{constructor(e,n){super(e,"not-in",n),this.keys=vx("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function vx(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>Se.fromName(r.referenceValue))}class Bj extends Ut{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Gp(n)&&_l(n.arrayValue,this.value)}}class $j extends Ut{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&_l(this.value.arrayValue,n)}}class Hj extends Ut{constructor(e,n){super(e,"not-in",n)}matches(e){if(_l(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!_l(this.value.arrayValue,n)}}class qj extends Ut{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Gp(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>_l(this.value.arrayValue,r))}}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Wj{constructor(e,n=null,r=[],i=[],s=null,a=null,u=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=u,this.Te=null}}function _b(t,e=null,n=[],r=[],i=null,s=null,a=null){return new Wj(t,e,n,r,i,s,a)}function Qp(t){const e=je(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>hm(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Sd(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Ua(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Ua(r)).join(",")),e.Te=n}return e.Te}function Kp(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Lj(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!gx(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Cb(t.startAt,e.startAt)&&Cb(t.endAt,e.endAt)}function fm(t){return Se.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Zi{constructor(e,n=null,r=[],i=[],s=null,a="F",u=null,o=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=u,this.endAt=o,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Gj(t,e,n,r,i,s,a,u){return new Zi(t,e,n,r,i,s,a,u)}function Xp(t){return new Zi(t)}function kb(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Yp(t){return t.collectionGroup!==null}function _a(t){const e=je(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(i){let s=new Qt(un.comparator);return i.filters.forEach(a=>{a.getFlattenedFilters().forEach(u=>{u.isInequality()&&(s=s.add(u.field))})}),s})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new kl(i,r))}),n.has(un.keyField().canonicalString())||e.Ie.push(new kl(un.keyField(),r))}return e.Ie}function jr(t){const e=je(t);return e.Ee||(e.Ee=Qj(e,_a(t))),e.Ee}function Qj(t,e){if(t.limitType==="F")return _b(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new kl(i.field,s)});const n=t.endAt?new Va(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Va(t.startAt.position,t.startAt.inclusive):null;return _b(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function mm(t,e){const n=t.filters.concat([e]);return new Zi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Vc(t,e,n){return new Zi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function _d(t,e){return Kp(jr(t),jr(e))&&t.limitType===e.limitType}function bx(t){return`${Qp(jr(t))}|lt:${t.limitType}`}function Zs(t){return`Query(target=${function(e){let n=e.path.canonicalString();return e.collectionGroup!==null&&(n+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(n+=`, filters: [${e.filters.map(r=>yx(r)).join(", ")}]`),Sd(e.limit)||(n+=", limit: "+e.limit),e.orderBy.length>0&&(n+=`, orderBy: [${e.orderBy.map(r=>function(i){return`${i.field.canonicalString()} (${i.dir})`}(r)).join(", ")}]`),e.startAt&&(n+=", startAt: ",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Ua(r)).join(",")),e.endAt&&(n+=", endAt: ",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Ua(r)).join(",")),`Target(${n})`}(jr(t))}; limitType=${t.limitType})`}function kd(t,e){return e.isFoundDocument()&&function(n,r){const i=r.key.path;return n.collectionGroup!==null?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):Se.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(t,e)&&function(n,r){for(const i of _a(n))if(!i.field.isKeyField()&&r.data.field(i.field)===null)return!1;return!0}(t,e)&&function(n,r){for(const i of n.filters)if(!i.matches(r))return!1;return!0}(t,e)&&function(n,r){return!(n.startAt&&!function(i,s,a){const u=xb(i,s,a);return i.inclusive?u<=0:u<0}(n.startAt,_a(n),r)||n.endAt&&!function(i,s,a){const u=xb(i,s,a);return i.inclusive?u>=0:u>0}(n.endAt,_a(n),r))}(t,e)}function Kj(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function wx(t){return(e,n)=>{let r=!1;for(const i of _a(t)){const s=Xj(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function Xj(t,e,n){const r=t.field.isKeyField()?Se.comparator(e.key,n.key):function(i,s,a){const u=s.data.field(i),o=a.data.field(i);return u!==null&&o!==null?Fa(u,o):_e(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return _e(19790,{direction:t.dir})}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class zs{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Ji(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return ix(this.inner)}size(){return this.innerSize}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Yj=new _t(Se.comparator);function Xr(){return Yj}const Sx=new _t(Se.comparator);function Do(...t){let e=Sx;for(const n of t)e=e.insert(n.key,n);return e}function xx(t){let e=Sx;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function bs(){return Ko()}function Cx(){return Ko()}function Ko(){return new zs(t=>t.toString(),(t,e)=>t.isEqual(e))}const Jj=new _t(Se.comparator),Zj=new Qt(Se.comparator);function Ve(...t){let e=Zj;for(const n of t)e=e.add(n);return e}const eA=new Qt(Ue);function tA(){return eA}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function Jp(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Rc(e)?"-0":e}}function _x(t){return{integerValue:""+t}}function nA(t,e){return Ij(e)?_x(e):Jp(t,e)}/**
* @license
* Copyright 2018 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Ed{constructor(){this._=void 0}}function rA(t,e,n){return t instanceof zc?function(r,i){const s={fields:{[ox]:{stringValue:ax},[ux]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&xd(i)&&(i=Cd(i)),i&&(s.fields[lx]=i),{mapValue:s}}(n,e):t instanceof El?Ex(t,e):t instanceof Nl?Nx(t,e):function(r,i){const s=kx(r,i),a=Eb(s)+Eb(r.Ae);return dm(s)&&dm(r.Ae)?_x(a):Jp(r.serializer,a)}(t,e)}function iA(t,e,n){return t instanceof El?Ex(t,e):t instanceof Nl?Nx(t,e):n}function kx(t,e){return t instanceof Bc?function(n){return dm(n)||function(r){return!!r&&"doubleValue"in r}(n)}(e)?e:{integerValue:0}:null}class zc extends Ed{}class El extends Ed{constructor(e){super(),this.elements=e}}function Ex(t,e){const n=Tx(e);for(const r of t.elements)n.some(i=>Or(i,r))||n.push(r);return{arrayValue:{values:n}}}class Nl extends Ed{constructor(e){super(),this.elements=e}}function Nx(t,e){let n=Tx(e);for(const r of t.elements)n=n.filter(i=>!Or(i,r));return{arrayValue:{values:n}}}class Bc extends Ed{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function Eb(t){return Dt(t.integerValue||t.doubleValue)}function Tx(t){return Gp(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function sA(t,e){return t.field.isEqual(e.field)&&function(n,r){return n instanceof El&&r instanceof El||n instanceof Nl&&r instanceof Nl?La(n.elements,r.elements,Or):n instanceof Bc&&r instanceof Bc?Or(n.Ae,r.Ae):n instanceof zc&&r instanceof zc}(t.transform,e.transform)}class aA{constructor(e,n){this.version=e,this.transformResults=n}}class ur{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new ur}static exists(e){return new ur(void 0,e)}static updateTime(e){return new ur(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ec(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Nd{}function Ix(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Ax(t.key,ur.none()):new Vl(t.key,t.data,ur.none());{const n=t.data,r=Dn.empty();let i=new Qt(un.comparator);for(let s of e.fields)if(!i.has(s)){let a=n.field(s);a===null&&s.length>1&&(s=s.popLast(),a=n.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new es(t.key,r,new Bn(i.toArray()),ur.none())}}function oA(t,e,n){t instanceof Vl?function(r,i,s){const a=r.value.clone(),u=Tb(r.fieldTransforms,i,s.transformResults);a.setAll(u),i.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(t,e,n):t instanceof es?function(r,i,s){if(!ec(r.precondition,i))return void i.convertToUnknownDocument(s.version);const a=Tb(r.fieldTransforms,i,s.transformResults),u=i.data;u.setAll(jx(r)),u.setAll(a),i.convertToFoundDocument(s.version,u).setHasCommittedMutations()}(t,e,n):function(r,i,s){i.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,n)}function Xo(t,e,n,r){return t instanceof Vl?function(i,s,a,u){if(!ec(i.precondition,s))return a;const o=i.value.clone(),d=Ib(i.fieldTransforms,u,s);return o.setAll(d),s.convertToFoundDocument(s.version,o).setHasLocalMutations(),null}(t,e,n,r):t instanceof es?function(i,s,a,u){if(!ec(i.precondition,s))return a;const o=Ib(i.fieldTransforms,u,s),d=s.data;return d.setAll(jx(i)),d.setAll(o),s.convertToFoundDocument(s.version,d).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(h=>h.field))}(t,e,n,r):function(i,s,a){return ec(i.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a}(t,e,n)}function lA(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=kx(r.transform,i||null);s!=null&&(n===null&&(n=Dn.empty()),n.set(r.field,s))}return n||null}function Nb(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,r){return n===void 0&&r===void 0||!(!n||!r)&&La(n,r,(i,s)=>sA(i,s))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Vl extends Nd{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class es extends Nd{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function jx(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Tb(t,e,n){const r=new Map;Ze(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let i=0;i<n.length;i++){const s=t[i],a=s.transform,u=e.data.field(s.field);r.set(s.field,iA(a,u,n[i]))}return r}function Ib(t,e,n){const r=new Map;for(const i of t){const s=i.transform,a=n.data.field(i.field);r.set(i.field,rA(s,a,e))}return r}class Ax extends Nd{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class uA extends Nd{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class cA{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&oA(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Xo(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Xo(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=Cx();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let u=this.applyToLocalView(a,s.mutatedFields);u=n.has(i.key)?null:u;const o=Ix(a,u);o!==null&&r.set(i.key,o),a.isValidDocument()||a.convertToNoDocument(Ie.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Ve())}isEqual(e){return this.batchId===e.batchId&&La(this.mutations,e.mutations,(n,r)=>Nb(n,r))&&La(this.baseMutations,e.baseMutations,(n,r)=>Nb(n,r))}}class Zp{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){Ze(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=function(){return Jj}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new Zp(e,n,r,i)}}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class dA{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class hA{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var Rt,Be;function fA(t){switch(t){case J.OK:return _e(64938);case J.CANCELLED:case J.UNKNOWN:case J.DEADLINE_EXCEEDED:case J.RESOURCE_EXHAUSTED:case J.INTERNAL:case J.UNAVAILABLE:case J.UNAUTHENTICATED:return!1;case J.INVALID_ARGUMENT:case J.NOT_FOUND:case J.ALREADY_EXISTS:case J.PERMISSION_DENIED:case J.FAILED_PRECONDITION:case J.ABORTED:case J.OUT_OF_RANGE:case J.UNIMPLEMENTED:case J.DATA_LOSS:return!0;default:return _e(15467,{code:t})}}function Dx(t){if(t===void 0)return Kr("GRPC error has no .code"),J.UNKNOWN;switch(t){case Rt.OK:return J.OK;case Rt.CANCELLED:return J.CANCELLED;case Rt.UNKNOWN:return J.UNKNOWN;case Rt.DEADLINE_EXCEEDED:return J.DEADLINE_EXCEEDED;case Rt.RESOURCE_EXHAUSTED:return J.RESOURCE_EXHAUSTED;case Rt.INTERNAL:return J.INTERNAL;case Rt.UNAVAILABLE:return J.UNAVAILABLE;case Rt.UNAUTHENTICATED:return J.UNAUTHENTICATED;case Rt.INVALID_ARGUMENT:return J.INVALID_ARGUMENT;case Rt.NOT_FOUND:return J.NOT_FOUND;case Rt.ALREADY_EXISTS:return J.ALREADY_EXISTS;case Rt.PERMISSION_DENIED:return J.PERMISSION_DENIED;case Rt.FAILED_PRECONDITION:return J.FAILED_PRECONDITION;case Rt.ABORTED:return J.ABORTED;case Rt.OUT_OF_RANGE:return J.OUT_OF_RANGE;case Rt.UNIMPLEMENTED:return J.UNIMPLEMENTED;case Rt.DATA_LOSS:return J.DATA_LOSS;default:return _e(39323,{code:t})}}(Be=Rt||(Rt={}))[Be.OK=0]="OK",Be[Be.CANCELLED=1]="CANCELLED",Be[Be.UNKNOWN=2]="UNKNOWN",Be[Be.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Be[Be.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Be[Be.NOT_FOUND=5]="NOT_FOUND",Be[Be.ALREADY_EXISTS=6]="ALREADY_EXISTS",Be[Be.PERMISSION_DENIED=7]="PERMISSION_DENIED",Be[Be.UNAUTHENTICATED=16]="UNAUTHENTICATED",Be[Be.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Be[Be.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Be[Be.ABORTED=10]="ABORTED",Be[Be.OUT_OF_RANGE=11]="OUT_OF_RANGE",Be[Be.UNIMPLEMENTED=12]="UNIMPLEMENTED",Be[Be.INTERNAL=13]="INTERNAL",Be[Be.UNAVAILABLE=14]="UNAVAILABLE",Be[Be.DATA_LOSS=15]="DATA_LOSS";/**
* @license
* Copyright 2023 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function mA(){return new TextEncoder}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const pA=new Li([4294967295,4294967295],0);function jb(t){const e=mA().encode(t),n=new G1;return n.update(e),new Uint8Array(n.digest())}function Ab(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Li([n,r],0),new Li([i,s],0)]}class eg{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Mo(`Invalid padding: ${n}`);if(r<0)throw new Mo(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Mo(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Mo(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Li.fromNumber(this.ge)}ye(e,n,r){let i=e.add(n.multiply(Li.fromNumber(r)));return i.compare(pA)===1&&(i=new Li([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=jb(e),[r,i]=Ab(n);for(let s=0;s<this.hashCount;s++){const a=this.ye(r,i,s);if(!this.we(a))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new eg(s,i,n);return r.forEach(u=>a.insert(u)),a}insert(e){if(this.ge===0)return;const n=jb(e),[r,i]=Ab(n);for(let s=0;s<this.hashCount;s++){const a=this.ye(r,i,s);this.Se(a)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Mo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Td{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,zl.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Td(Ie.min(),i,new _t(Ue),Xr(),Ve())}}class zl{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new zl(r,n,Ve(),Ve(),Ve())}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class tc{constructor(e,n,r,i){this.be=e,this.removedTargetIds=n,this.key=r,this.De=i}}class Mx{constructor(e,n){this.targetId=e,this.Ce=n}}class Px{constructor(e,n,r=hn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class Db{constructor(){this.ve=0,this.Fe=Mb(),this.Me=hn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ve(),n=Ve(),r=Ve();return this.Fe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:_e(38017,{changeType:s})}}),new zl(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=Mb()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ze(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class gA{constructor(e){this.Ge=e,this.ze=new Map,this.je=Xr(),this.Je=_u(),this.He=_u(),this.Ye=new _t(Ue)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:_e(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,i)=>{this.rt(i)&&n(i)})}st(e){const n=e.targetId,r=e.Ce.count,i=this.ot(n);if(i){const s=i.target;if(fm(s))if(r===0){const a=new Se(s.path);this.et(n,a,bn.newNoDocument(a,Ie.min()))}else Ze(r===1,20013,{expectedCount:r});else{const a=this._t(n);if(a!==r){const u=this.ut(e),o=u?this.ct(u,e,a):1;if(o!==0){this.it(n);const d=o===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let a,u;try{a=Hi(r).toUint8Array()}catch(o){if(o instanceof sx)return Ra("Decoding the base64 bloom filter in existence filter failed ("+o.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw o}try{u=new eg(a,i,s)}catch(o){return Ra(o instanceof Mo?"BloomFilter error: ":"Applying bloom filter failed: ",o),null}return u.ge===0?null:u}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const a=this.Ge.ht(),u=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(u)||(this.et(n,s,null),i++)}),i}Tt(e){const n=new Map;this.ze.forEach((s,a)=>{const u=this.ot(a);if(u){if(s.current&&fm(u.target)){const o=new Se(u.target.path);this.It(o).has(a)||this.Et(a,o)||this.et(a,o,bn.newNoDocument(o,e))}s.Be&&(n.set(a,s.ke()),s.qe())}});let r=Ve();this.He.forEach((s,a)=>{let u=!0;a.forEachWhile(o=>{const d=this.ot(o);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(s))}),this.je.forEach((s,a)=>a.setReadTime(e));const i=new Td(e,n,this.Ye,this.je,r);return this.je=Xr(),this.Je=_u(),this.He=_u(),this.Ye=new _t(Ue),i}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,n)?i.Qe(n,1):i.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new Db,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Qt(Ue),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Qt(Ue),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||ye("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Db),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function _u(){return new _t(Se.comparator)}function Mb(){return new _t(Se.comparator)}const yA={asc:"ASCENDING",desc:"DESCENDING"},vA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},bA={and:"AND",or:"OR"};class wA{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function pm(t,e){return t.useProto3Json||Sd(e)?e:{value:e}}function $c(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ox(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function SA(t,e){return $c(t,e.toTimestamp())}function Ar(t){return Ze(!!t,49232),Ie.fromTimestamp(function(e){const n=$i(e);return new ft(n.seconds,n.nanos)}(t))}function tg(t,e){return gm(t,e).canonicalString()}function gm(t,e){const n=function(r){return new st(["projects",r.projectId,"databases",r.database])}(t).child("documents");return e===void 0?n:n.child(e)}function Rx(t){const e=st.fromString(t);return Ze(zx(e),10190,{key:e.toString()}),e}function ym(t,e){return tg(t.databaseId,e.path)}function Rh(t,e){const n=Rx(e);if(n.get(1)!==t.databaseId.projectId)throw new he(J.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new he(J.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Se(Fx(n))}function Lx(t,e){return tg(t.databaseId,e)}function xA(t){const e=Rx(t);return e.length===4?st.emptyPath():Fx(e)}function vm(t){return new st(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Fx(t){return Ze(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Pb(t,e,n){return{name:ym(t,e),fields:n.value.mapValue.fields}}function CA(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(o){return o==="NO_CHANGE"?0:o==="ADD"?1:o==="REMOVE"?2:o==="CURRENT"?3:o==="RESET"?4:_e(39313,{state:o})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(o,d){return o.useProto3Json?(Ze(d===void 0||typeof d=="string",58123),hn.fromBase64String(d||"")):(Ze(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),hn.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,u=a&&function(o){const d=o.code===void 0?J.UNKNOWN:Dx(o.code);return new he(d,o.message||"")}(a);n=new Px(r,i,s,u||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Rh(t,r.document.name),s=Ar(r.document.updateTime),a=r.document.createTime?Ar(r.document.createTime):Ie.min(),u=new Dn({mapValue:{fields:r.document.fields}}),o=bn.newFoundDocument(i,s,a,u),d=r.targetIds||[],h=r.removedTargetIds||[];n=new tc(d,h,o.key,o)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Rh(t,r.document),s=r.readTime?Ar(r.readTime):Ie.min(),a=bn.newNoDocument(i,s),u=r.removedTargetIds||[];n=new tc([],u,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Rh(t,r.document),s=r.removedTargetIds||[];n=new tc([],s,i,null)}else{if(!("filter"in e))return _e(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,a=new hA(i,s),u=r.targetId;n=new Mx(u,a)}}return n}function _A(t,e){let n;if(e instanceof Vl)n={update:Pb(t,e.key,e.value)};else if(e instanceof Ax)n={delete:ym(t,e.key)};else if(e instanceof es)n={update:Pb(t,e.key,e.data),updateMask:MA(e.fieldMask)};else{if(!(e instanceof uA))return _e(16599,{Vt:e.type});n={verify:ym(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,s){const a=s.transform;if(a instanceof zc)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof El)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Nl)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Bc)return{fieldPath:s.field.canonicalString(),increment:a.Ae};throw _e(20930,{transform:s.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(r,i){return i.updateTime!==void 0?{updateTime:SA(r,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:_e(27497)}(t,e.precondition)),n}function kA(t,e){return t&&t.length>0?(Ze(e!==void 0,14353),t.map(n=>function(r,i){let s=r.updateTime?Ar(r.updateTime):Ar(i);return s.isEqual(Ie.min())&&(s=Ar(i)),new aA(s,r.transformResults||[])}(n,e))):[]}function EA(t,e){return{documents:[Lx(t,e.path)]}}function NA(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Lx(t,i);const s=function(o){if(o.length!==0)return Vx(hr.create(o,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const a=function(o){if(o.length!==0)return o.map(d=>function(h){return{field:ea(h.field),direction:jA(h.dir)}}(d))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);const u=pm(t,e.limit);return u!==null&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=function(o){return{before:o.inclusive,values:o.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(o){return{before:!o.inclusive,values:o.position}}(e.endAt)),{ft:n,parent:i}}function TA(t){let e=xA(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Ze(r===1,65062);const h=n.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];n.where&&(s=function(h){const f=Ux(h);return f instanceof hr&&px(f)?f.getFilters():[f]}(n.where));let a=[];n.orderBy&&(a=function(h){return h.map(f=>function(p){return new kl(ta(p.field),function(g){switch(g){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(p.direction))}(f))}(n.orderBy));let u=null;n.limit&&(u=function(h){let f;return f=typeof h=="object"?h.value:h,Sd(f)?null:f}(n.limit));let o=null;n.startAt&&(o=function(h){const f=!!h.before,p=h.values||[];return new Va(p,f)}(n.startAt));let d=null;return n.endAt&&(d=function(h){const f=!h.before,p=h.values||[];return new Va(p,f)}(n.endAt)),Gj(e,i,a,s,u,"F",o,d)}function IA(t,e){const n=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return _e(28987,{purpose:r})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Ux(t){return t.unaryFilter!==void 0?function(e){switch(e.unaryFilter.op){case"IS_NAN":const n=ta(e.unaryFilter.field);return Ut.create(n,"==",{doubleValue:NaN});case"IS_NULL":const r=ta(e.unaryFilter.field);return Ut.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=ta(e.unaryFilter.field);return Ut.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=ta(e.unaryFilter.field);return Ut.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return _e(61313);default:return _e(60726)}}(t):t.fieldFilter!==void 0?function(e){return Ut.create(ta(e.fieldFilter.field),function(n){switch(n){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return _e(58110);default:return _e(50506)}}(e.fieldFilter.op),e.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(e){return hr.create(e.compositeFilter.filters.map(n=>Ux(n)),function(n){switch(n){case"AND":return"and";case"OR":return"or";default:return _e(1026)}}(e.compositeFilter.op))}(t):_e(30097,{filter:t})}function jA(t){return yA[t]}function AA(t){return vA[t]}function DA(t){return bA[t]}function ea(t){return{fieldPath:t.canonicalString()}}function ta(t){return un.fromServerFormat(t.fieldPath)}function Vx(t){return t instanceof Ut?function(e){if(e.op==="=="){if(Sb(e.value))return{unaryFilter:{field:ea(e.field),op:"IS_NAN"}};if(wb(e.value))return{unaryFilter:{field:ea(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(Sb(e.value))return{unaryFilter:{field:ea(e.field),op:"IS_NOT_NAN"}};if(wb(e.value))return{unaryFilter:{field:ea(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ea(e.field),op:AA(e.op),value:e.value}}}(t):t instanceof hr?function(e){const n=e.getFilters().map(r=>Vx(r));return n.length===1?n[0]:{compositeFilter:{op:DA(e.op),filters:n}}}(t):_e(54877,{filter:t})}function MA(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function zx(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class _i{constructor(e,n,r,i,s=Ie.min(),a=Ie.min(),u=hn.EMPTY_BYTE_STRING,o=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=u,this.expectedCount=o}withSequenceNumber(e){return new _i(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new _i(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new _i(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new _i(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class PA{constructor(e){this.yt=e}}function OA(t){const e=TA({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Vc(e,e.limit,"L"):e}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class RA{constructor(){this.Cn=new LA}addToCollectionParentIndex(e,n){return this.Cn.add(n),ne.resolve()}getCollectionParents(e,n){return ne.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return ne.resolve()}deleteFieldIndex(e,n){return ne.resolve()}deleteAllFieldIndexes(e){return ne.resolve()}createTargetIndexes(e,n){return ne.resolve()}getDocumentsMatchingTarget(e,n){return ne.resolve(null)}getIndexType(e,n){return ne.resolve(0)}getFieldIndexes(e,n){return ne.resolve([])}getNextCollectionGroupToUpdate(e){return ne.resolve(null)}getMinOffset(e,n){return ne.resolve(Bi.min())}getMinOffsetFromCollectionGroup(e,n){return ne.resolve(Bi.min())}updateCollectionGroup(e,n,r){return ne.resolve()}updateIndexEntries(e,n){return ne.resolve()}}class LA{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Qt(st.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Qt(st.comparator)).toArray()}}/**
* @license
* Copyright 2018 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Ob={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Bx=41943040;class jn{static withCacheSize(e){return new jn(e,jn.DEFAULT_COLLECTION_PERCENTILE,jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/jn.DEFAULT_COLLECTION_PERCENTILE=10,jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,jn.DEFAULT=new jn(Bx,jn.DEFAULT_COLLECTION_PERCENTILE,jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),jn.DISABLED=new jn(-1,0,0);/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class za{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new za(0)}static cr(){return new za(-1)}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Rb="LruGarbageCollector",FA=1048576;function Lb([t,e],[n,r]){const i=Ue(t,n);return i===0?Ue(e,r):i}class UA{constructor(e){this.Ir=e,this.buffer=new Qt(Lb),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Lb(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class VA{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ye(Rb,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Ya(n)?ye(Rb,"Ignoring IndexedDB error during garbage collection: ",n):await Xa(n)}await this.Vr(3e5)})}}class zA{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return ne.resolve(wd.ce);const r=new UA(n);return this.mr.forEachTarget(e,i=>r.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>r.Ar(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(ye("LruGarbageCollector","Garbage collection skipped; disabled"),ne.resolve(Ob)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(ye("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ob):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,i,s,a,u,o,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(ye("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,a=Date.now(),this.nthSequenceNumber(e,i))).next(f=>(r=f,u=Date.now(),this.removeTargets(e,r,n))).next(f=>(s=f,o=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(d=Date.now(),Js()<=Fe.DEBUG&&ye("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-h}ms
	Determined least recently used ${i} in `+(u-a)+`ms
	Removed ${s} targets in `+(o-u)+`ms
	Removed ${f} documents in `+(d-o)+`ms
Total Duration: ${d-h}ms`),ne.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:f})))}}function BA(t,e){return new zA(t,e)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class $A{constructor(){this.changes=new zs(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,bn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?ne.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*//**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class HA{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class qA{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Xo(r.mutation,i,Bn.empty(),ft.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Ve()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Ve()){const i=bs();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let a=Do();return s.forEach((u,o)=>{a=a.insert(u,o.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const r=bs();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Ve()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,u)=>{n.set(a,u)})})}computeViews(e,n,r,i){let s=Xr();const a=Ko(),u=function(){return Ko()}();return n.forEach((o,d)=>{const h=r.get(d.key);i.has(d.key)&&(h===void 0||h.mutation instanceof es)?s=s.insert(d.key,d):h!==void 0?(a.set(d.key,h.mutation.getFieldMask()),Xo(h.mutation,d,h.mutation.getFieldMask(),ft.now())):a.set(d.key,Bn.empty())}),this.recalculateAndSaveOverlays(e,s).next(o=>(o.forEach((d,h)=>a.set(d,h)),n.forEach((d,h)=>u.set(d,new HA(h,a.get(d)??null))),u))}recalculateAndSaveOverlays(e,n){const r=Ko();let i=new _t((a,u)=>a-u),s=Ve();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const u of a)u.keys().forEach(o=>{const d=n.get(o);if(d===null)return;let h=r.get(o)||Bn.empty();h=u.applyToLocalView(d,h),r.set(o,h);const f=(i.get(u.batchId)||Ve()).add(o);i=i.insert(u.batchId,f)})}).next(()=>{const a=[],u=i.getReverseIterator();for(;u.hasNext();){const o=u.getNext(),d=o.key,h=o.value,f=Cx();h.forEach(p=>{if(!s.has(p)){const g=Ix(n.get(p),r.get(p));g!==null&&f.set(p,g),s=s.add(p)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,f))}return ne.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(s){return Se.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Yp(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):ne.resolve(bs());let u=Sl,o=s;return a.next(d=>ne.forEach(d,(h,f)=>(u<f.largestBatchId&&(u=f.largestBatchId),s.get(h)?ne.resolve():this.remoteDocumentCache.getEntry(e,h).next(p=>{o=o.insert(h,p)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,o,d,Ve())).next(h=>({batchId:u,changes:xx(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Se(n)).next(r=>{let i=Do();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let a=Do();return this.indexManager.getCollectionParents(e,s).next(u=>ne.forEach(u,o=>{const d=function(h,f){return new Zi(f,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(n,o.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(h=>{h.forEach((f,p)=>{a=a.insert(f,p)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(a=>{s.forEach((o,d)=>{const h=d.getKey();a.get(h)===null&&(a=a.insert(h,bn.newInvalidDocument(h)))});let u=Do();return a.forEach((o,d)=>{const h=s.get(o);h!==void 0&&Xo(h.mutation,d,Bn.empty(),ft.now()),kd(n,d)&&(u=u.insert(o,d))}),u})}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class WA{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return ne.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(r){return{id:r.id,version:r.version,createTime:Ar(r.createTime)}}(n)),ne.resolve()}getNamedQuery(e,n){return ne.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(r){return{name:r.name,query:OA(r.bundledQuery),readTime:Ar(r.readTime)}}(n)),ne.resolve()}}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class GA{constructor(){this.overlays=new _t(Se.comparator),this.qr=new Map}getOverlay(e,n){return ne.resolve(this.overlays.get(n))}getOverlays(e,n){const r=bs();return ne.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.St(e,n,s)}),ne.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.qr.delete(r)),ne.resolve()}getOverlaysForCollection(e,n,r){const i=bs(),s=n.length+1,a=new Se(n.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){const o=u.getNext().value,d=o.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===s&&o.largestBatchId>r&&i.set(o.getKey(),o)}return ne.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new _t((d,h)=>d-h);const a=this.overlays.getIterator();for(;a.hasNext();){const d=a.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=s.get(d.largestBatchId);h===null&&(h=bs(),s=s.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const u=bs(),o=s.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach((d,h)=>u.set(d,h)),!(u.size()>=i)););return ne.resolve(u)}St(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const a=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new dA(n,r));let s=this.qr.get(n);s===void 0&&(s=Ve(),this.qr.set(n,s)),this.qr.set(n,s.add(r.key))}}/**
* @license
* Copyright 2024 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class QA{constructor(){this.sessionToken=hn.EMPTY_BYTE_STRING}getSessionToken(e){return ne.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,ne.resolve()}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class ng{constructor(){this.Qr=new Qt(Jt.$r),this.Ur=new Qt(Jt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new Jt(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new Jt(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new Se(new st([])),r=new Jt(n,e),i=new Jt(n,e+1),s=[];return this.Ur.forEachInRange([r,i],a=>{this.Gr(a),s.push(a.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new Se(new st([])),r=new Jt(n,e),i=new Jt(n,e+1);let s=Ve();return this.Ur.forEachInRange([r,i],a=>{s=s.add(a.key)}),s}containsKey(e){const n=new Jt(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Jt{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return Se.comparator(e.key,n.key)||Ue(e.Yr,n.Yr)}static Kr(e,n){return Ue(e.Yr,n.Yr)||Se.comparator(e.key,n.key)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class KA{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Qt(Jt.$r)}checkEmpty(e){return ne.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new cA(s,n,r,i);this.mutationQueue.push(a);for(const u of i)this.Zr=this.Zr.add(new Jt(u.key,s)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return ne.resolve(a)}lookupMutationBatch(e,n){return ne.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.ei(r),s=i<0?0:i;return ne.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ne.resolve(this.mutationQueue.length===0?Wp:this.tr-1)}getAllMutationBatches(e){return ne.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Jt(n,0),i=new Jt(n,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],a=>{const u=this.Xr(a.Yr);s.push(u)}),ne.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Qt(Ue);return n.forEach(i=>{const s=new Jt(i,0),a=new Jt(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,a],u=>{r=r.add(u.Yr)})}),ne.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;Se.isDocumentKey(s)||(s=s.child(""));const a=new Jt(new Se(s),0);let u=new Qt(Ue);return this.Zr.forEachWhile(o=>{const d=o.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(u=u.add(o.Yr)),!0)},a),ne.resolve(this.ti(u))}ti(e){const n=[];return e.forEach(r=>{const i=this.Xr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){Ze(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return ne.forEach(n.mutations,i=>{const s=new Jt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new Jt(n,0),i=this.Zr.firstAfterOrEqual(r);return ne.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,ne.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class XA{constructor(e){this.ri=e,this.docs=function(){return new _t(Se.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,a=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return ne.resolve(r?r.document.mutableCopy():bn.newInvalidDocument(n))}getEntries(e,n){let r=Xr();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():bn.newInvalidDocument(i))}),ne.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Xr();const a=n.path,u=new Se(a.child("__id-9223372036854775808__")),o=this.docs.getIteratorFrom(u);for(;o.hasNext();){const{key:d,value:{document:h}}=o.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||kj(_j(h),r)<=0||(i.has(h.key)||kd(n,h))&&(s=s.insert(h.key,h.mutableCopy()))}return ne.resolve(s)}getAllFromCollectionGroup(e,n,r,i){_e(9500)}ii(e,n){return ne.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new YA(this)}getSize(e){return ne.resolve(this.size)}}class YA extends $A{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)}),ne.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class JA{constructor(e){this.persistence=e,this.si=new zs(n=>Qp(n),Kp),this.lastRemoteSnapshotVersion=Ie.min(),this.highestTargetId=0,this.oi=0,this._i=new ng,this.targetCount=0,this.ai=za.ur()}forEachTarget(e,n){return this.si.forEach((r,i)=>n(i)),ne.resolve()}getLastRemoteSnapshotVersion(e){return ne.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ne.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ne.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),ne.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new za(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,ne.resolve()}updateTargetData(e,n){return this.Pr(n),ne.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,ne.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.si.forEach((a,u)=>{u.sequenceNumber<=n&&r.get(u.targetId)===null&&(this.si.delete(a),s.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),ne.waitFor(s).next(()=>i)}getTargetCount(e){return ne.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return ne.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),ne.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),ne.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),ne.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return ne.resolve(r)}containsKey(e,n){return ne.resolve(this._i.containsKey(n))}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class $x{constructor(e,n){this.ui={},this.overlays={},this.ci=new wd(0),this.li=!1,this.li=!0,this.hi=new QA,this.referenceDelegate=e(this),this.Pi=new JA(this),this.indexManager=new RA,this.remoteDocumentCache=function(r){return new XA(r)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new PA(n),this.Ii=new WA(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new GA,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new KA(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){ye("MemoryPersistence","Starting transaction:",e);const i=new ZA(this.ci.next());return this.referenceDelegate.Ei(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ai(e,n){return ne.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class ZA extends Nj{constructor(e){super(),this.currentSequenceNumber=e}}class rg{constructor(e){this.persistence=e,this.Ri=new ng,this.Vi=null}static mi(e){return new rg(e)}get fi(){if(this.Vi)return this.Vi;throw _e(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),ne.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),ne.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),ne.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(i=>this.fi.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.fi.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ne.forEach(this.fi,r=>{const i=Se.fromPath(r);return this.gi(e,i).next(s=>{s||n.removeEntry(i,Ie.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return ne.or([()=>ne.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class Hc{constructor(e,n){this.persistence=e,this.pi=new zs(r=>jj(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=BA(this,n)}static mi(e,n){return new Hc(e,n)}Ei(){}di(e){return ne.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return ne.forEach(this.pi,(r,i)=>this.br(e,r,i).next(s=>s?ne.resolve():n(i)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,a=>this.br(e,a,n).next(u=>{u||(r++,s.removeEntry(a,Ie.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),ne.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),ne.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),ne.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),ne.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Ju(e.data.value)),n}br(e,n,r){return ne.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.pi.get(n);return ne.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class ig{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=i}static As(e,n){let r=Ve(),i=Ve();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new ig(e,n.fromCache,r,i)}}/**
* @license
* Copyright 2023 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class eD{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class tD{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return h2()?8:Tj(dr())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.ys(e,n).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.ws(e,n,i,r).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new eD;return this.Ss(e,n,a).next(u=>{if(s.result=u,this.Vs)return this.bs(e,n,a,u.size)})}).next(()=>s.result)}bs(e,n,r,i){return r.documentReadCount<this.fs?(Js()<=Fe.DEBUG&&ye("QueryEngine","SDK will not create cache indexes for query:",Zs(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ne.resolve()):(Js()<=Fe.DEBUG&&ye("QueryEngine","Query:",Zs(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(Js()<=Fe.DEBUG&&ye("QueryEngine","The SDK decides to create cache indexes for query:",Zs(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,jr(n))):ne.resolve())}ys(e,n){if(kb(n))return ne.resolve(null);let r=jr(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Vc(n,null,"F"),r=jr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const a=Ve(...s);return this.ps.getDocuments(e,a).next(u=>this.indexManager.getMinOffset(e,r).next(o=>{const d=this.Ds(n,u);return this.Cs(n,d,a,o.readTime)?this.ys(e,Vc(n,null,"F")):this.vs(e,d,n,o)}))})))}ws(e,n,r,i){return kb(n)||i.isEqual(Ie.min())?ne.resolve(null):this.ps.getDocuments(e,r).next(s=>{const a=this.Ds(n,s);return this.Cs(n,a,r,i)?ne.resolve(null):(Js()<=Fe.DEBUG&&ye("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Zs(n)),this.vs(e,a,n,Cj(i,Sl)).next(u=>u))})}Ds(e,n){let r=new Qt(wx(e));return n.forEach((i,s)=>{kd(e,s)&&(r=r.add(s))}),r}Cs(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,n,r){return Js()<=Fe.DEBUG&&ye("QueryEngine","Using full collection scan to execute query:",Zs(n)),this.ps.getDocumentsMatchingQuery(e,n,Bi.min(),r)}vs(e,n,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const sg="LocalStore",nD=3e8;class rD{constructor(e,n,r,i){this.persistence=e,this.Fs=n,this.serializer=i,this.Ms=new _t(Ue),this.xs=new zs(s=>Qp(s),Kp),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new qA(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function iD(t,e,n,r){return new rD(t,e,n,r)}async function Hx(t,e){const n=je(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const a=[],u=[];let o=Ve();for(const d of i){a.push(d.batchId);for(const h of d.mutations)o=o.add(h.key)}for(const d of s){u.push(d.batchId);for(const h of d.mutations)o=o.add(h.key)}return n.localDocuments.getDocuments(r,o).next(d=>({Ls:d,removedBatchIds:a,addedBatchIds:u}))})})}function sD(t,e){const n=je(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.Ns.newChangeBuffer({trackRemovals:!0});return function(a,u,o,d){const h=o.batch,f=h.keys();let p=ne.resolve();return f.forEach(g=>{p=p.next(()=>d.getEntry(u,g)).next(b=>{const N=o.docVersions.get(g);Ze(N!==null,48541),b.version.compareTo(N)<0&&(h.applyToRemoteDocument(b,o),b.isValidDocument()&&(b.setReadTime(o.commitVersion),d.addEntry(b)))})}),p.next(()=>a.mutationQueue.removeMutationBatch(u,h))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let u=Ve();for(let o=0;o<a.mutationResults.length;++o)a.mutationResults[o].transformResults.length>0&&(u=u.add(a.batch.mutations[o].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function qx(t){const e=je(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function aD(t,e){const n=je(t),r=e.snapshotVersion;let i=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;const u=[];e.targetChanges.forEach((h,f)=>{const p=i.get(f);if(!p)return;u.push(n.Pi.removeMatchingKeys(s,h.removedDocuments,f).next(()=>n.Pi.addMatchingKeys(s,h.addedDocuments,f)));let g=p.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?g=g.withResumeToken(hn.EMPTY_BYTE_STRING,Ie.min()).withLastLimboFreeSnapshotVersion(Ie.min()):h.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(h.resumeToken,r)),i=i.insert(f,g),function(b,N,D){return b.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-b.snapshotVersion.toMicroseconds()>=nD?!0:D.addedDocuments.size+D.modifiedDocuments.size+D.removedDocuments.size>0}(p,g,h)&&u.push(n.Pi.updateTargetData(s,g))});let o=Xr(),d=Ve();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&u.push(n.persistence.referenceDelegate.updateLimboDocument(s,h))}),u.push(oD(s,a,e.documentUpdates).next(h=>{o=h.ks,d=h.qs})),!r.isEqual(Ie.min())){const h=n.Pi.getLastRemoteSnapshotVersion(s).next(f=>n.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r));u.push(h)}return ne.waitFor(u).next(()=>a.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,o,d)).next(()=>o)}).then(s=>(n.Ms=i,s))}function oD(t,e,n){let r=Ve(),i=Ve();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let a=Xr();return n.forEach((u,o)=>{const d=s.get(u);o.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(u)),o.isNoDocument()&&o.version.isEqual(Ie.min())?(e.removeEntry(u,o.readTime),a=a.insert(u,o)):!d.isValidDocument()||o.version.compareTo(d.version)>0||o.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(o),a=a.insert(u,o)):ye(sg,"Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",o.version)}),{ks:a,qs:i}})}function lD(t,e){const n=je(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Wp),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function uD(t,e){const n=je(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Pi.getTargetData(r,e).next(s=>s?(i=s,ne.resolve(i)):n.Pi.allocateTargetId(r).next(a=>(i=new _i(e,a,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function bm(t,e,n){const r=je(t),i=r.Ms.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,a=>r.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!Ya(a))throw a;ye(sg,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function Fb(t,e,n){const r=je(t);let i=Ie.min(),s=Ve();return r.persistence.runTransaction("Execute query","readwrite",a=>function(u,o,d){const h=je(u),f=h.xs.get(d);return f!==void 0?ne.resolve(h.Ms.get(f)):h.Pi.getTargetData(o,d)}(r,a,jr(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(a,u.targetId).next(o=>{s=o})}).next(()=>r.Fs.getDocumentsMatchingQuery(a,e,n?i:Ie.min(),n?s:Ve())).next(u=>(cD(r,Kj(e),u),{documents:u,Qs:s})))}function cD(t,e,n){let r=t.Os.get(e)||Ie.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.Os.set(e,r)}class Ub{constructor(){this.activeTargetIds=tA()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class dD{constructor(){this.Mo=new Ub,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Ub,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class hD{Oo(e){}shutdown(){}}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Vb="ConnectivityMonitor";class zb{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ye(Vb,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ye(Vb,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
* @license
* Copyright 2023 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/let ku=null;function wm(){return ku===null?ku=function(){return 268435456+Math.round(2147483648*Math.random())}():ku++,"0x"+ku.toString(16)}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Lh="RestConnection",fD={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class mD{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===Lc?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,n,r,i,s){const a=wm(),u=this.zo(e,n.toUriEncodedString());ye(Lh,`Sending RPC '${e}' ${a}:`,u,r);const o={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(o,i,s);const{host:d}=new URL(u),h=Vs(d);return this.Jo(e,u,o,r,h).then(f=>(ye(Lh,`Received RPC '${e}' ${a}: `,f),f),f=>{throw Ra(Lh,`RPC '${e}' ${a} failed with error: `,f,"url: ",u,"request:",r),f})}Ho(e,n,r,i,s,a){return this.Go(e,n,r,i,s)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ka}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}zo(e,n){const r=fD[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class pD{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const gn="WebChannelConnection";class gD extends mD{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,i,s){const a=wm();return new Promise((u,o)=>{const d=new Q1;d.setWithCredentials(!0),d.listenOnce(K1.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Yu.NO_ERROR:const f=d.getResponseJson();ye(gn,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(f)),u(f);break;case Yu.TIMEOUT:ye(gn,`RPC '${e}' ${a} timed out`),o(new he(J.DEADLINE_EXCEEDED,"Request time out"));break;case Yu.HTTP_ERROR:const p=d.getStatus();if(ye(gn,`RPC '${e}' ${a} failed with status:`,p,"response text:",d.getResponseText()),p>0){let g=d.getResponseJson();Array.isArray(g)&&(g=g[0]);const b=g==null?void 0:g.error;if(b&&b.status&&b.message){const N=function(D){const v=D.toLowerCase().replace(/_/g,"-");return Object.values(J).indexOf(v)>=0?v:J.UNKNOWN}(b.status);o(new he(N,b.message))}else o(new he(J.UNKNOWN,"Server responded with status "+d.getStatus()))}else o(new he(J.UNAVAILABLE,"Connection failed."));break;default:_e(9055,{l_:e,streamId:a,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{ye(gn,`RPC '${e}' ${a} completed.`)}});const h=JSON.stringify(i);ye(gn,`RPC '${e}' ${a} sending request:`,i),d.send(n,"POST",h,r,15)})}T_(e,n,r){const i=wm(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=J1(),u=Y1(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(o.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(o.useFetchStreams=!0),this.jo(o.initMessageHeaders,n,r),o.encodeInitMessageHeaders=!0;const h=s.join("");ye(gn,`Creating RPC '${e}' stream ${i}: ${h}`,o);const f=a.createWebChannel(h,o);this.I_(f);let p=!1,g=!1;const b=new pD({Yo:D=>{g?ye(gn,`Not sending because RPC '${e}' stream ${i} is closed:`,D):(p||(ye(gn,`Opening RPC '${e}' stream ${i} transport.`),f.open(),p=!0),ye(gn,`RPC '${e}' stream ${i} sending:`,D),f.send(D))},Zo:()=>f.close()}),N=(D,v,w)=>{D.listen(v,C=>{try{w(C)}catch(O){setTimeout(()=>{throw O},0)}})};return N(f,Ao.EventType.OPEN,()=>{g||(ye(gn,`RPC '${e}' stream ${i} transport opened.`),b.o_())}),N(f,Ao.EventType.CLOSE,()=>{g||(g=!0,ye(gn,`RPC '${e}' stream ${i} transport closed`),b.a_(),this.E_(f))}),N(f,Ao.EventType.ERROR,D=>{g||(g=!0,Ra(gn,`RPC '${e}' stream ${i} transport errored. Name:`,D.name,"Message:",D.message),b.a_(new he(J.UNAVAILABLE,"The operation could not be completed")))}),N(f,Ao.EventType.MESSAGE,D=>{var v;if(!g){const w=D.data[0];Ze(!!w,16349);const C=w,O=(C==null?void 0:C.error)||((v=C[0])==null?void 0:v.error);if(O){ye(gn,`RPC '${e}' stream ${i} received error:`,O);const R=O.status;let F=function(x){const j=Rt[x];if(j!==void 0)return Dx(j)}(R),E=O.message;F===void 0&&(F=J.INTERNAL,E="Unknown error status: "+R+" with message "+O.message),g=!0,b.a_(new he(F,E)),f.close()}else ye(gn,`RPC '${e}' stream ${i} received:`,w),b.u_(w)}}),N(u,X1.STAT_EVENT,D=>{D.stat===lm.PROXY?ye(gn,`RPC '${e}' stream ${i} detected buffering proxy`):D.stat===lm.NOPROXY&&ye(gn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{b.__()},0),b}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}function Fh(){return typeof document<"u"?document:null}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function Id(t){return new wA(t,!0)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Wx{constructor(e,n,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,n-r);i>0&&ye("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Bb="PersistentStream";class Gx{constructor(e,n,r,i,s,a,u,o){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=o,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Wx(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===J.RESOURCE_EXHAUSTED?(Kr(n.toString()),Kr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===J.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===n&&this.G_(r,i)},r=>{e(()=>{const i=new he(J.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return ye(Bb,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(ye(Bb,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class yD extends Gx{constructor(e,n,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,a),this.serializer=s}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=CA(this.serializer,e),r=function(i){if(!("targetChange"in i))return Ie.min();const s=i.targetChange;return s.targetIds&&s.targetIds.length?Ie.min():s.readTime?Ar(s.readTime):Ie.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=vm(this.serializer),n.addTarget=function(i,s){let a;const u=s.target;if(a=fm(u)?{documents:EA(i,u)}:{query:NA(i,u).ft},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){a.resumeToken=Ox(i,s.resumeToken);const o=pm(i,s.expectedCount);o!==null&&(a.expectedCount=o)}else if(s.snapshotVersion.compareTo(Ie.min())>0){a.readTime=$c(i,s.snapshotVersion.toTimestamp());const o=pm(i,s.expectedCount);o!==null&&(a.expectedCount=o)}return a}(this.serializer,e);const r=IA(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=vm(this.serializer),n.removeTarget=e,this.q_(n)}}class vD extends Gx{constructor(e,n,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,a),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return Ze(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ze(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ze(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=kA(e.writeResults,e.commitTime),r=Ar(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=vm(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>_A(this.serializer,r))};this.q_(n)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class bD{}class wD extends bD{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new he(J.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Go(e,gm(n,r),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===J.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new he(J.UNKNOWN,s.toString())})}Ho(e,n,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,u])=>this.connection.Ho(e,gm(n,r),i,a,u,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===J.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new he(J.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class SD{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Kr(n),this.aa=!1):ye("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const As="RemoteStore";class xD{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(a=>{r.enqueueAndForget(async()=>{Bs(this)&&(ye(As,"Restarting streams for network reachability change."),await async function(u){const o=je(u);o.Ea.add(4),await Bl(o),o.Ra.set("Unknown"),o.Ea.delete(4),await jd(o)}(this))})}),this.Ra=new SD(r,i)}}async function jd(t){if(Bs(t))for(const e of t.da)await e(!0)}async function Bl(t){for(const e of t.da)await e(!1)}function Qx(t,e){const n=je(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),ug(n)?lg(n):Ja(n).O_()&&og(n,e))}function ag(t,e){const n=je(t),r=Ja(n);n.Ia.delete(e),r.O_()&&Kx(n,e),n.Ia.size===0&&(r.O_()?r.L_():Bs(n)&&n.Ra.set("Unknown"))}function og(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ie.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Ja(t).Y_(e)}function Kx(t,e){t.Va.Ue(e),Ja(t).Z_(e)}function lg(t){t.Va=new gA({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Ja(t).start(),t.Ra.ua()}function ug(t){return Bs(t)&&!Ja(t).x_()&&t.Ia.size>0}function Bs(t){return je(t).Ea.size===0}function Xx(t){t.Va=void 0}async function CD(t){t.Ra.set("Online")}async function _D(t){t.Ia.forEach((e,n)=>{og(t,e)})}async function kD(t,e){Xx(t),ug(t)?(t.Ra.ha(e),lg(t)):t.Ra.set("Unknown")}async function ED(t,e,n){if(t.Ra.set("Online"),e instanceof Px&&e.state===2&&e.cause)try{await async function(r,i){const s=i.cause;for(const a of i.targetIds)r.Ia.has(a)&&(await r.remoteSyncer.rejectListen(a,s),r.Ia.delete(a),r.Va.removeTarget(a))}(t,e)}catch(r){ye(As,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await qc(t,r)}else if(e instanceof tc?t.Va.Ze(e):e instanceof Mx?t.Va.st(e):t.Va.tt(e),!n.isEqual(Ie.min()))try{const r=await qx(t.localStore);n.compareTo(r)>=0&&await function(i,s){const a=i.Va.Tt(s);return a.targetChanges.forEach((u,o)=>{if(u.resumeToken.approximateByteSize()>0){const d=i.Ia.get(o);d&&i.Ia.set(o,d.withResumeToken(u.resumeToken,s))}}),a.targetMismatches.forEach((u,o)=>{const d=i.Ia.get(u);if(!d)return;i.Ia.set(u,d.withResumeToken(hn.EMPTY_BYTE_STRING,d.snapshotVersion)),Kx(i,u);const h=new _i(d.target,u,o,d.sequenceNumber);og(i,h)}),i.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){ye(As,"Failed to raise snapshot:",r),await qc(t,r)}}async function qc(t,e,n){if(!Ya(e))throw e;t.Ea.add(1),await Bl(t),t.Ra.set("Offline"),n||(n=()=>qx(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ye(As,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await jd(t)})}function Yx(t,e){return e().catch(n=>qc(t,n,e))}async function Ad(t){const e=je(t),n=Wi(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Wp;for(;ND(e);)try{const i=await lD(e.localStore,r);if(i===null){e.Ta.length===0&&n.L_();break}r=i.batchId,TD(e,i)}catch(i){await qc(e,i)}Jx(e)&&Zx(e)}function ND(t){return Bs(t)&&t.Ta.length<10}function TD(t,e){t.Ta.push(e);const n=Wi(t);n.O_()&&n.X_&&n.ea(e.mutations)}function Jx(t){return Bs(t)&&!Wi(t).x_()&&t.Ta.length>0}function Zx(t){Wi(t).start()}async function ID(t){Wi(t).ra()}async function jD(t){const e=Wi(t);for(const n of t.Ta)e.ea(n.mutations)}async function AD(t,e,n){const r=t.Ta.shift(),i=Zp.from(r,e,n);await Yx(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Ad(t)}async function DD(t,e){e&&Wi(t).X_&&await async function(n,r){if(function(i){return fA(i)&&i!==J.ABORTED}(r.code)){const i=n.Ta.shift();Wi(n).B_(),await Yx(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,r)),await Ad(n)}}(t,e),Jx(t)&&Zx(t)}async function $b(t,e){const n=je(t);n.asyncQueue.verifyOperationInProgress(),ye(As,"RemoteStore received new credentials");const r=Bs(n);n.Ea.add(3),await Bl(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await jd(n)}async function MD(t,e){const n=je(t);e?(n.Ea.delete(2),await jd(n)):e||(n.Ea.add(2),await Bl(n),n.Ra.set("Unknown"))}function Ja(t){return t.ma||(t.ma=function(e,n,r){const i=je(e);return i.sa(),new yD(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(t.datastore,t.asyncQueue,{Xo:CD.bind(null,t),t_:_D.bind(null,t),r_:kD.bind(null,t),H_:ED.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),ug(t)?lg(t):t.Ra.set("Unknown")):(await t.ma.stop(),Xx(t))})),t.ma}function Wi(t){return t.fa||(t.fa=function(e,n,r){const i=je(e);return i.sa(),new vD(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:ID.bind(null,t),r_:DD.bind(null,t),ta:jD.bind(null,t),na:AD.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Ad(t)):(await t.fa.stop(),t.Ta.length>0&&(ye(As,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class cg{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new $r,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const a=Date.now()+r,u=new cg(e,n,a,i,s);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new he(J.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function dg(t,e){if(Kr("AsyncQueue",`${e}: ${t}`),Ya(t))return new he(J.UNAVAILABLE,`${e}: ${t}`);throw t}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class ka{static emptySet(e){return new ka(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||Se.comparator(n.key,r.key):(n,r)=>Se.comparator(n.key,r.key),this.keyedMap=Do(),this.sortedSet=new _t(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ka)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new ka;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Hb{constructor(){this.ga=new _t(Se.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):_e(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class Ba{constructor(e,n,r,i,s,a,u,o,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=u,this.excludesMetadataChanges=o,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,i,s){const a=[];return n.forEach(u=>{a.push({type:0,doc:u})}),new Ba(e,n,ka.emptySet(n),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&_d(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class PD{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class OD{constructor(){this.queries=qb(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(e,n){const r=je(e),i=r.queries;r.queries=qb(),i.forEach((s,a)=>{for(const u of a.Sa)u.onError(n)})})(this,new he(J.ABORTED,"Firestore shutting down"))}}function qb(){return new zs(t=>bx(t),_d)}async function eC(t,e){const n=je(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new PD,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await n.onListen(i,!0);break;case 1:s.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(a){const u=dg(a,`Initialization of query '${Zs(e.query)}' failed`);return void e.onError(u)}n.queries.set(i,s),s.Sa.push(e),e.va(n.onlineState),s.wa&&e.Fa(s.wa)&&hg(n)}async function tC(t,e){const n=je(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const a=s.Sa.indexOf(e);a>=0&&(s.Sa.splice(a,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function RD(t,e){const n=je(t);let r=!1;for(const i of e){const s=i.query,a=n.queries.get(s);if(a){for(const u of a.Sa)u.Fa(i)&&(r=!0);a.wa=i}}r&&hg(n)}function LD(t,e,n){const r=je(t),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(n);r.queries.delete(e)}function hg(t){t.Ca.forEach(e=>{e.next()})}var Sm,Wb;(Wb=Sm||(Sm={})).Ma="default",Wb.Cache="cache";class nC{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Ba(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Ba.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Sm.Cache}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class rC{constructor(e){this.key=e}}class iC{constructor(e){this.key=e}}class FD{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ve(),this.mutatedKeys=Ve(),this.eu=wx(e),this.tu=new ka(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new Hb,i=n?n.tu:this.tu;let s=n?n.mutatedKeys:this.mutatedKeys,a=i,u=!1;const o=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,f)=>{const p=i.get(h),g=kd(this.query,f)?f:null,b=!!p&&this.mutatedKeys.has(p.key),N=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let D=!1;p&&g?p.data.isEqual(g.data)?b!==N&&(r.track({type:3,doc:g}),D=!0):this.su(p,g)||(r.track({type:2,doc:g}),D=!0,(o&&this.eu(g,o)>0||d&&this.eu(g,d)<0)&&(u=!0)):!p&&g?(r.track({type:0,doc:g}),D=!0):p&&!g&&(r.track({type:1,doc:p}),D=!0,(o||d)&&(u=!0)),D&&(g?(a=a.add(g),s=N?s.add(h):s.delete(h)):(a=a.delete(h),s=s.delete(h)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const h=this.query.limitType==="F"?a.last():a.first();a=a.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{tu:a,iu:r,Cs:u,mutatedKeys:s}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort((h,f)=>function(p,g){const b=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return _e(20277,{Rt:N})}};return b(p)-b(g)}(h.type,f.type)||this.eu(h.doc,f.doc)),this.ou(r),i=i??!1;const u=n&&!i?this._u():[],o=this.Xa.size===0&&this.current&&!i?1:0,d=o!==this.Za;return this.Za=o,a.length!==0||d?{snapshot:new Ba(this.query,e.tu,s,a,e.mutatedKeys,o===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:u}:{au:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Hb,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ve(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new iC(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new rC(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=Ve();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Ba.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const fg="SyncEngine";class UD{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class VD{constructor(e){this.key=e,this.hu=!1}}class zD{constructor(e,n,r,i,s,a){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new zs(u=>bx(u),_d),this.Iu=new Map,this.Eu=new Set,this.du=new _t(Se.comparator),this.Au=new Map,this.Ru=new ng,this.Vu={},this.mu=new Map,this.fu=za.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function BD(t,e,n=!0){const r=cC(t);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await sC(r,e,n,!0),i}async function $D(t,e){const n=cC(t);await sC(n,e,!0,!1)}async function sC(t,e,n,r){const i=await uD(t.localStore,jr(e)),s=i.targetId,a=t.sharedClientState.addLocalQueryTarget(s,n);let u;return r&&(u=await HD(t,e,s,a==="current",i.resumeToken)),t.isPrimaryClient&&n&&Qx(t.remoteStore,i),u}async function HD(t,e,n,r,i){t.pu=(f,p,g)=>async function(b,N,D,v){let w=N.view.ru(D);w.Cs&&(w=await Fb(b.localStore,N.query,!1).then(({documents:F})=>N.view.ru(F,w)));const C=v&&v.targetChanges.get(N.targetId),O=v&&v.targetMismatches.get(N.targetId)!=null,R=N.view.applyChanges(w,b.isPrimaryClient,C,O);return Qb(b,N.targetId,R.au),R.snapshot}(t,f,p,g);const s=await Fb(t.localStore,e,!0),a=new FD(e,s.Qs),u=a.ru(s.documents),o=zl.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),d=a.applyChanges(u,t.isPrimaryClient,o);Qb(t,n,d.au);const h=new UD(e,n,a);return t.Tu.set(e,h),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function qD(t,e,n){const r=je(t),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter(a=>!_d(a,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await bm(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&ag(r.remoteStore,i.targetId),xm(r,i.targetId)}).catch(Xa)):(xm(r,i.targetId),await bm(r.localStore,i.targetId,!0))}async function WD(t,e){const n=je(t),r=n.Tu.get(e),i=n.Iu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),ag(n.remoteStore,r.targetId))}async function GD(t,e,n){const r=eM(t);try{const i=await function(s,a){const u=je(s),o=ft.now(),d=a.reduce((p,g)=>p.add(g.key),Ve());let h,f;return u.persistence.runTransaction("Locally write mutations","readwrite",p=>{let g=Xr(),b=Ve();return u.Ns.getEntries(p,d).next(N=>{g=N,g.forEach((D,v)=>{v.isValidDocument()||(b=b.add(D))})}).next(()=>u.localDocuments.getOverlayedDocuments(p,g)).next(N=>{h=N;const D=[];for(const v of a){const w=lA(v,h.get(v.key).overlayedDocument);w!=null&&D.push(new es(v.key,w,hx(w.value.mapValue),ur.exists(!0)))}return u.mutationQueue.addMutationBatch(p,o,D,a)}).next(N=>{f=N;const D=N.applyToLocalDocumentSet(h,b);return u.documentOverlayCache.saveOverlays(p,N.batchId,D)})}).then(()=>({batchId:f.batchId,changes:xx(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(s,a,u){let o=s.Vu[s.currentUser.toKey()];o||(o=new _t(Ue)),o=o.insert(a,u),s.Vu[s.currentUser.toKey()]=o}(r,i.batchId,n),await $l(r,i.changes),await Ad(r.remoteStore)}catch(i){const s=dg(i,"Failed to persist write");n.reject(s)}}async function aC(t,e){const n=je(t);try{const r=await aD(n.localStore,e);e.targetChanges.forEach((i,s)=>{const a=n.Au.get(s);a&&(Ze(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.hu=!0:i.modifiedDocuments.size>0?Ze(a.hu,14607):i.removedDocuments.size>0&&(Ze(a.hu,42227),a.hu=!1))}),await $l(n,r,e)}catch(r){await Xa(r)}}function Gb(t,e,n){const r=je(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Tu.forEach((s,a)=>{const u=a.view.va(e);u.snapshot&&i.push(u.snapshot)}),function(s,a){const u=je(s);u.onlineState=a;let o=!1;u.queries.forEach((d,h)=>{for(const f of h.Sa)f.va(a)&&(o=!0)}),o&&hg(u)}(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function QD(t,e,n){const r=je(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Au.get(e),s=i&&i.key;if(s){let a=new _t(Se.comparator);a=a.insert(s,bn.newNoDocument(s,Ie.min()));const u=Ve().add(s),o=new Td(Ie.min(),new Map,new _t(Ue),a,u);await aC(r,o),r.du=r.du.remove(s),r.Au.delete(e),mg(r)}else await bm(r.localStore,e,!1).then(()=>xm(r,e,n)).catch(Xa)}async function KD(t,e){const n=je(t),r=e.batch.batchId;try{const i=await sD(n.localStore,e);lC(n,r,null),oC(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await $l(n,i)}catch(i){await Xa(i)}}async function XD(t,e,n){const r=je(t);try{const i=await function(s,a){const u=je(s);return u.persistence.runTransaction("Reject batch","readwrite-primary",o=>{let d;return u.mutationQueue.lookupMutationBatch(o,a).next(h=>(Ze(h!==null,37113),d=h.keys(),u.mutationQueue.removeMutationBatch(o,h))).next(()=>u.mutationQueue.performConsistencyCheck(o)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(o,d,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(o,d)).next(()=>u.localDocuments.getDocuments(o,d))})}(r.localStore,e);lC(r,e,n),oC(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await $l(r,i)}catch(i){await Xa(i)}}function oC(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function lC(t,e,n){const r=je(t);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function xm(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||uC(t,r)})}function uC(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(ag(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),mg(t))}function Qb(t,e,n){for(const r of n)r instanceof rC?(t.Ru.addReference(r.key,e),YD(t,r)):r instanceof iC?(ye(fg,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||uC(t,r.key)):_e(19791,{wu:r})}function YD(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(ye(fg,"New document in limbo: "+n),t.Eu.add(r),mg(t))}function mg(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new Se(st.fromString(e)),r=t.fu.next();t.Au.set(r,new VD(n)),t.du=t.du.insert(n,r),Qx(t.remoteStore,new _i(jr(Xp(n.path)),r,"TargetPurposeLimboResolution",wd.ce))}}async function $l(t,e,n){const r=je(t),i=[],s=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach((u,o)=>{a.push(r.pu(o,e,n).then(d=>{var h;if((d||n)&&r.isPrimaryClient){const f=d?!d.fromCache:(h=n==null?void 0:n.targetChanges.get(o.targetId))==null?void 0:h.current;r.sharedClientState.updateQueryState(o.targetId,f?"current":"not-current")}if(d){i.push(d);const f=ig.As(o.targetId,d);s.push(f)}}))}),await Promise.all(a),r.Pu.H_(i),await async function(u,o){const d=je(u);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>ne.forEach(o,f=>ne.forEach(f.Es,p=>d.persistence.referenceDelegate.addReference(h,f.targetId,p)).next(()=>ne.forEach(f.ds,p=>d.persistence.referenceDelegate.removeReference(h,f.targetId,p)))))}catch(h){if(!Ya(h))throw h;ye(sg,"Failed to update sequence numbers: "+h)}for(const h of o){const f=h.targetId;if(!h.fromCache){const p=d.Ms.get(f),g=p.snapshotVersion,b=p.withLastLimboFreeSnapshotVersion(g);d.Ms=d.Ms.insert(f,b)}}}(r.localStore,s))}async function JD(t,e){const n=je(t);if(!n.currentUser.isEqual(e)){ye(fg,"User change. New user:",e.toKey());const r=await Hx(n.localStore,e);n.currentUser=e,function(i,s){i.mu.forEach(a=>{a.forEach(u=>{u.reject(new he(J.CANCELLED,s))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await $l(n,r.Ls)}}function ZD(t,e){const n=je(t),r=n.Au.get(e);if(r&&r.hu)return Ve().add(r.key);{let i=Ve();const s=n.Iu.get(e);if(!s)return i;for(const a of s){const u=n.Tu.get(a);i=i.unionWith(u.view.nu)}return i}}function cC(t){const e=je(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=aC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=ZD.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=QD.bind(null,e),e.Pu.H_=RD.bind(null,e.eventManager),e.Pu.yu=LD.bind(null,e.eventManager),e}function eM(t){const e=je(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=KD.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=XD.bind(null,e),e}class Wc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Id(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return iD(this.persistence,new tD,e.initialUser,this.serializer)}Cu(e){return new $x(rg.mi,this.serializer)}Du(e){return new dD}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Wc.provider={build:()=>new Wc};class tM extends Wc{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){Ze(this.persistence.referenceDelegate instanceof Hc,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new VA(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?jn.withCacheSize(this.cacheSizeBytes):jn.DEFAULT;return new $x(r=>Hc.mi(r,n),this.serializer)}}class Cm{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Gb(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=JD.bind(null,this.syncEngine),await MD(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new OD}()}createDatastore(e){const n=Id(e.databaseInfo.databaseId),r=function(i){return new gD(i)}(e.databaseInfo);return function(i,s,a,u){return new wD(i,s,a,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(n,r,i,s,a){return new xD(n,r,i,s,a)}(this.localStore,this.datastore,e.asyncQueue,n=>Gb(this.syncEngine,n,0),function(){return zb.v()?new zb:new hD}())}createSyncEngine(e,n){return function(r,i,s,a,u,o,d){const h=new zD(r,i,s,a,u,o);return d&&(h.gu=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(r){const i=je(r);ye(As,"RemoteStore shutting down."),i.Ea.add(5),await Bl(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}Cm.provider={build:()=>new Cm};/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*//**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class dC{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Kr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Gi="FirestoreClient";class nM{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=yn.UNAUTHENTICATED,this.clientId=qp.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async a=>{ye(Gi,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(ye(Gi,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new $r;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=dg(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Uh(t,e){t.asyncQueue.verifyOperationInProgress(),ye(Gi,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await Hx(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Kb(t,e){t.asyncQueue.verifyOperationInProgress();const n=await rM(t);ye(Gi,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>$b(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>$b(e.remoteStore,i)),t._onlineComponents=e}async function rM(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ye(Gi,"Using user provided OfflineComponentProvider");try{await Uh(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(r){return r.name==="FirebaseError"?r.code===J.FAILED_PRECONDITION||r.code===J.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(n))throw n;Ra("Error using user provided cache. Falling back to memory cache: "+n),await Uh(t,new Wc)}}else ye(Gi,"Using default OfflineComponentProvider"),await Uh(t,new tM(void 0));return t._offlineComponents}async function hC(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ye(Gi,"Using user provided OnlineComponentProvider"),await Kb(t,t._uninitializedComponentsProvider._online)):(ye(Gi,"Using default OnlineComponentProvider"),await Kb(t,new Cm))),t._onlineComponents}function iM(t){return hC(t).then(e=>e.syncEngine)}async function fC(t){const e=await hC(t),n=e.eventManager;return n.onListen=BD.bind(null,e.syncEngine),n.onUnlisten=qD.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=$D.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=WD.bind(null,e.syncEngine),n}function sM(t,e,n={}){const r=new $r;return t.asyncQueue.enqueueAndForget(async()=>function(i,s,a,u,o){const d=new dC({next:f=>{d.Nu(),s.enqueueAndForget(()=>tC(i,h));const p=f.docs.has(a);!p&&f.fromCache?o.reject(new he(J.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&f.fromCache&&u&&u.source==="server"?o.reject(new he(J.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):o.resolve(f)},error:f=>o.reject(f)}),h=new nC(Xp(a.path),d,{includeMetadataChanges:!0,qa:!0});return eC(i,h)}(await fC(t),t.asyncQueue,e,n,r)),r.promise}function aM(t,e,n={}){const r=new $r;return t.asyncQueue.enqueueAndForget(async()=>function(i,s,a,u,o){const d=new dC({next:f=>{d.Nu(),s.enqueueAndForget(()=>tC(i,h)),f.fromCache&&u.source==="server"?o.reject(new he(J.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(f)},error:f=>o.reject(f)}),h=new nC(a,d,{includeMetadataChanges:!0,qa:!0});return eC(i,h)}(await fC(t),t.asyncQueue,e,n,r)),r.promise}/**
* @license
* Copyright 2023 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function mC(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Xb=new Map;/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const pC="firestore.googleapis.com",Yb=!0;class Jb{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new he(J.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=pC,this.ssl=Yb}else this.host=e.host,this.ssl=e.ssl??Yb;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Bx;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<FA)throw new he(J.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Sj("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=mC(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new he(J.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new he(J.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new he(J.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,r){return n.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Dd{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Jb({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new he(J.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new he(J.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Jb(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new dj;switch(n.type){case"firstParty":return new pj(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new he(J.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const n=Xb.get(e);n&&(ye("ComponentProvider","Removing Datastore"),Xb.delete(e),n.terminate())}(this),Promise.resolve()}}function oM(t,e,n,r={}){var i;t=Pr(t,Dd);const s=Vs(e),a=t._getSettings(),u={...a,emulatorOptions:t._getEmulatorOptions()},o=`${e}:${n}`;s&&(_1(`https://${o}`),E1("Firestore",!0)),a.host!==pC&&a.host!==o&&Ra("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d={...a,host:o,ssl:s,emulatorOptions:r};if(!Ac(d,u)&&(t._setSettings(d),r.mockUserToken)){let h,f;if(typeof r.mockUserToken=="string")h=r.mockUserToken,f=yn.MOCK_USER;else{h=k1(r.mockUserToken,(i=t._app)==null?void 0:i.options.projectId);const p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new he(J.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new yn(p)}t._authCredentials=new hj(new ex(h,f))}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Rr{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Rr(this.firestore,e,this._query)}}class Pt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Fi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Pt(this.firestore,e,this._key)}toJSON(){return{type:Pt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(Ul(n,Pt._jsonSchema))return new Pt(e,r||null,new Se(st.fromString(n.referencePath)))}}Pt._jsonSchemaVersion="firestore/documentReference/1.0",Pt._jsonSchema={type:Vt("string",Pt._jsonSchemaVersion),referencePath:Vt("string")};class Fi extends Rr{constructor(e,n,r){super(e,n,Xp(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Pt(this.firestore,null,new Se(e))}withConverter(e){return new Fi(this.firestore,e,this._path)}}function lM(t,e,...n){if(t=nn(t),tx("collection","path",e),t instanceof Dd){const r=st.fromString(e,...n);return hb(r),new Fi(t,null,r)}{if(!(t instanceof Pt||t instanceof Fi))throw new he(J.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(st.fromString(e,...n));return hb(r),new Fi(t.firestore,null,r)}}function gC(t,e,...n){if(t=nn(t),arguments.length===1&&(e=qp.newId()),tx("doc","path",e),t instanceof Dd){const r=st.fromString(e,...n);return db(r),new Pt(t,null,new Se(r))}{if(!(t instanceof Pt||t instanceof Fi))throw new he(J.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(st.fromString(e,...n));return db(r),new Pt(t.firestore,t instanceof Fi?t.converter:null,new Se(r))}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Zb="AsyncQueue";class e0{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Wx(this,"async_queue_retry"),this._c=()=>{const r=Fh();r&&ye(Zb,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Fh();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Fh();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new $r;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ya(e))throw e;ye(Zb,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,Kr("INTERNAL UNHANDLED ERROR: ",t0(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const i=cg.createAndSchedule(this,e,n,r,s=>this.hc(s));return this.tc.push(i),i}uc(){this.nc&&_e(47125,{Pc:t0(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function t0(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Za extends Dd{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new e0,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new e0(e),this._firestoreClient=void 0,await e}}}function uM(t,e){const n=typeof t=="object"?t:Bp(),r=typeof t=="string"?t:Lc,i=A1(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=x1("firestore");s&&oM(i,...s)}return i}function pg(t){if(t._terminated)throw new he(J.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||cM(t),t._firestoreClient}function cM(t){var e,n,r;const i=t._freezeSettings(),s=function(a,u,o,d){return new Mj(a,u,o,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,mC(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(t._databaseId,((e=t._app)==null?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||(n=i.localCache)!=null&&n._offlineComponentProvider&&(r=i.localCache)!=null&&r._onlineComponentProvider&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new nM(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(a){const u=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(u),_online:u}}(t._componentsProvider))}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Yn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Yn(hn.fromBase64String(e))}catch(n){throw new he(J.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Yn(hn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Yn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ul(e,Yn._jsonSchema))return Yn.fromBase64String(e.bytes)}}Yn._jsonSchemaVersion="firestore/bytes/1.0",Yn._jsonSchema={type:Vt("string",Yn._jsonSchemaVersion),bytes:Vt("string")};/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Md{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new he(J.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new un(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class gg{constructor(e){this._methodName=e}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Dr{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new he(J.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new he(J.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ue(this._lat,e._lat)||Ue(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Dr._jsonSchemaVersion}}static fromJSON(e){if(Ul(e,Dr._jsonSchema))return new Dr(e.latitude,e.longitude)}}Dr._jsonSchemaVersion="firestore/geoPoint/1.0",Dr._jsonSchema={type:Vt("string",Dr._jsonSchemaVersion),latitude:Vt("number"),longitude:Vt("number")};/**
* @license
* Copyright 2024 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Mr{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,r){if(n.length!==r.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==r[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Mr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ul(e,Mr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Mr(e.vectorValues);throw new he(J.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Mr._jsonSchemaVersion="firestore/vectorValue/1.0",Mr._jsonSchema={type:Vt("string",Mr._jsonSchemaVersion),vectorValues:Vt("object")};/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const dM=/^__.*__$/;class hM{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new es(e,this.data,this.fieldMask,n,this.fieldTransforms):new Vl(e,this.data,n,this.fieldTransforms)}}class yC{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new es(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function vC(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw _e(40011,{Ac:t})}}class yg{constructor(e,n,r,i,s,a){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new yg({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var n;const r=(n=this.path)==null?void 0:n.child(e),i=this.Vc({path:r,fc:!1});return i.gc(e),i}yc(e){var n;const r=(n=this.path)==null?void 0:n.child(e),i=this.Vc({path:r,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Gc(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(vC(this.Ac)&&dM.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class fM{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Id(e)}Cc(e,n,r,i=!1){return new yg({Ac:e,methodName:n,Dc:r,path:un.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Hl(t){const e=t._freezeSettings(),n=Id(t._databaseId);return new fM(t._databaseId,!!e.ignoreUndefinedProperties,n)}function bC(t,e,n,r,i,s={}){const a=t.Cc(s.merge||s.mergeFields?2:0,e,n,i);vg("Data must be an object, but it was:",a,r);const u=SC(r,a);let o,d;if(s.merge)o=new Bn(a.fieldMask),d=a.fieldTransforms;else if(s.mergeFields){const h=[];for(const f of s.mergeFields){const p=_m(e,f,n);if(!a.contains(p))throw new he(J.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);CC(h,p)||h.push(p)}o=new Bn(h),d=a.fieldTransforms.filter(f=>o.covers(f.field))}else o=null,d=a.fieldTransforms;return new hM(new Dn(u),o,d)}class Pd extends gg{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Pd}}function mM(t,e,n,r){const i=t.Cc(1,e,n);vg("Data must be an object, but it was:",i,r);const s=[],a=Dn.empty();Ji(r,(o,d)=>{const h=bg(e,o,n);d=nn(d);const f=i.yc(h);if(d instanceof Pd)s.push(h);else{const p=ql(d,f);p!=null&&(s.push(h),a.set(h,p))}});const u=new Bn(s);return new yC(a,u,i.fieldTransforms)}function pM(t,e,n,r,i,s){const a=t.Cc(1,e,n),u=[_m(e,r,n)],o=[i];if(s.length%2!=0)throw new he(J.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<s.length;p+=2)u.push(_m(e,s[p])),o.push(s[p+1]);const d=[],h=Dn.empty();for(let p=u.length-1;p>=0;--p)if(!CC(d,u[p])){const g=u[p];let b=o[p];b=nn(b);const N=a.yc(g);if(b instanceof Pd)d.push(g);else{const D=ql(b,N);D!=null&&(d.push(g),h.set(g,D))}}const f=new Bn(d);return new yC(h,f,a.fieldTransforms)}function wC(t,e,n,r=!1){return ql(n,t.Cc(r?4:3,e))}function ql(t,e){if(xC(t=nn(t)))return vg("Unsupported field value:",e,t),SC(t,e);if(t instanceof gg)return function(n,r){if(!vC(r.Ac))throw r.Sc(`${n._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,r){const i=[];let s=0;for(const a of n){let u=ql(a,r.wc(s));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),s++}return{arrayValue:{values:i}}}(t,e)}return function(n,r){if((n=nn(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return nA(r.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=ft.fromDate(n);return{timestampValue:$c(r.serializer,i)}}if(n instanceof ft){const i=new ft(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:$c(r.serializer,i)}}if(n instanceof Dr)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Yn)return{bytesValue:Ox(r.serializer,n._byteString)};if(n instanceof Pt){const i=r.databaseId,s=n.firestore._databaseId;if(!s.isEqual(i))throw r.Sc(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:tg(n.firestore._databaseId||r.databaseId,n._key.path)}}if(n instanceof Mr)return function(i,s){return{mapValue:{fields:{[cx]:{stringValue:dx},[Fc]:{arrayValue:{values:i.toArray().map(a=>{if(typeof a!="number")throw s.Sc("VectorValues must only contain numeric values.");return Jp(s.serializer,a)})}}}}}}(n,r);throw r.Sc(`Unsupported field value: ${bd(n)}`)}(t,e)}function SC(t,e){const n={};return ix(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ji(t,(r,i)=>{const s=ql(i,e.mc(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function xC(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ft||t instanceof Dr||t instanceof Yn||t instanceof Pt||t instanceof gg||t instanceof Mr)}function vg(t,e,n){if(!xC(n)||!nx(n)){const r=bd(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function _m(t,e,n){if((e=nn(e))instanceof Md)return e._internalPath;if(typeof e=="string")return bg(t,e);throw Gc("Field path arguments must be of type string or ",t,!1,void 0,n)}const gM=new RegExp("[~\\*/\\[\\]]");function bg(t,e,n){if(e.search(gM)>=0)throw Gc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Md(...e.split("."))._internalPath}catch{throw Gc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Gc(t,e,n,r,i){const s=r&&!r.isEmpty(),a=i!==void 0;let u=`Function ${e}() called with invalid data`;n&&(u+=" (via `toFirestore()`)"),u+=". ";let o="";return(s||a)&&(o+=" (found",s&&(o+=` in field ${r}`),a&&(o+=` in document ${i}`),o+=")"),new he(J.INVALID_ARGUMENT,u+t+o)}function CC(t,e){return t.some(n=>n.isEqual(e))}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class wg{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Pt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new yM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Od("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class yM extends wg{data(){return super.data()}}function Od(t,e){return typeof e=="string"?bg(t,e):e instanceof Md?e._internalPath:e._delegate._internalPath}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function vM(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new he(J.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Sg{}class Wl extends Sg{}function Qc(t,e,...n){let r=[];e instanceof Sg&&r.push(e),r=r.concat(n),function(i){const s=i.filter(u=>u instanceof xg).length,a=i.filter(u=>u instanceof Rd).length;if(s>1||s>0&&a>0)throw new he(J.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class Rd extends Wl{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Rd(e,n,r)}_apply(e){const n=this._parse(e);return EC(e._query,n),new Rr(e.firestore,e.converter,mm(e._query,n))}_parse(e){const n=Hl(e.firestore);return function(r,i,s,a,u,o,d){let h;if(u.isKeyField()){if(o==="array-contains"||o==="array-contains-any")throw new he(J.INVALID_ARGUMENT,`Invalid Query. You can't perform '${o}' queries on documentId().`);if(o==="in"||o==="not-in"){r0(d,o);const f=[];for(const p of d)f.push(n0(a,r,p));h={arrayValue:{values:f}}}else h=n0(a,r,d)}else o!=="in"&&o!=="not-in"&&o!=="array-contains-any"||r0(d,o),h=wC(s,i,d,o==="in"||o==="not-in");return Ut.create(u,o,h)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function km(t,e,n){const r=e,i=Od("where",t);return Rd._create(i,r,n)}class xg extends Sg{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new xg(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:hr.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(r,i){let s=r;const a=i.getFlattenedFilters();for(const u of a)EC(s,u),s=mm(s,u)}(e._query,n),new Rr(e.firestore,e.converter,mm(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Cg extends Wl{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Cg(e,n)}_apply(e){const n=function(r,i,s){if(r.startAt!==null)throw new he(J.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new he(J.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new kl(i,s)}(e._query,this._field,this._direction);return new Rr(e.firestore,e.converter,function(r,i){const s=r.explicitOrderBy.concat([i]);return new Zi(r.path,r.collectionGroup,s,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,n))}}function _C(t,e="asc"){const n=e,r=Od("orderBy",t);return Cg._create(r,n)}class _g extends Wl{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new _g(e,n,r)}_apply(e){return new Rr(e.firestore,e.converter,Vc(e._query,this._limit,this._limitType))}}function bM(t){return xj("limit",t),_g._create("limit",t,"F")}class kg extends Wl{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new kg(e,n,r)}_apply(e){const n=kC(e,this.type,this._docOrFields,this._inclusive);return new Rr(e.firestore,e.converter,function(r,i){return new Zi(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,i,r.endAt)}(e._query,n))}}function wM(...t){return kg._create("startAt",t,!0)}class Eg extends Wl{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Eg(e,n,r)}_apply(e){const n=kC(e,this.type,this._docOrFields,this._inclusive);return new Rr(e.firestore,e.converter,function(r,i){return new Zi(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,i)}(e._query,n))}}function SM(...t){return Eg._create("endAt",t,!0)}function kC(t,e,n,r){if(n[0]=nn(n[0]),n[0]instanceof wg)return function(i,s,a,u,o){if(!u)throw new he(J.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const d=[];for(const h of _a(i))if(h.field.isKeyField())d.push(Uc(s,u.key));else{const f=u.data.field(h.field);if(xd(f))throw new he(J.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(f===null){const p=h.field.canonicalString();throw new he(J.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${p}' (used as the orderBy) does not exist.`)}d.push(f)}return new Va(d,o)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const i=Hl(t.firestore);return function(s,a,u,o,d,h){const f=s.explicitOrderBy;if(d.length>f.length)throw new he(J.INVALID_ARGUMENT,`Too many arguments provided to ${o}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const p=[];for(let g=0;g<d.length;g++){const b=d[g];if(f[g].field.isKeyField()){if(typeof b!="string")throw new he(J.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${o}(), but got a ${typeof b}`);if(!Yp(s)&&b.indexOf("/")!==-1)throw new he(J.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${o}() must be a plain document ID, but '${b}' contains a slash.`);const N=s.path.child(st.fromString(b));if(!Se.isDocumentKey(N))throw new he(J.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${o}() must result in a valid document path, but '${N}' is not because it contains an odd number of segments.`);const D=new Se(N);p.push(Uc(a,D))}else{const N=wC(u,o,b);p.push(N)}}return new Va(p,h)}(t._query,t.firestore._databaseId,i,e,n,r)}}function n0(t,e,n){if(typeof(n=nn(n))=="string"){if(n==="")throw new he(J.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Yp(e)&&n.indexOf("/")!==-1)throw new he(J.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(st.fromString(n));if(!Se.isDocumentKey(r))throw new he(J.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Uc(t,new Se(r))}if(n instanceof Pt)return Uc(t,n._key);throw new he(J.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${bd(n)}.`)}function r0(t,e){if(!Array.isArray(t)||t.length===0)throw new he(J.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function EC(t,e){const n=function(r,i){for(const s of r)for(const a of s.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new he(J.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new he(J.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class xM{convertValue(e,n="none"){switch(qi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Dt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Hi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw _e(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Ji(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var n,r,i;const s=(i=(r=(n=e.fields)==null?void 0:n[Fc].arrayValue)==null?void 0:r.values)==null?void 0:i.map(a=>Dt(a.doubleValue));return new Mr(s)}convertGeoPoint(e){return new Dr(Dt(e.latitude),Dt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Cd(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(xl(e));default:return null}}convertTimestamp(e){const n=$i(e);return new ft(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=st.fromString(e);Ze(zx(r),9688,{name:e});const i=new Cl(r.get(1),r.get(3)),s=new Se(r.popFirst(5));return i.isEqual(n)||Kr(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function NC(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class Po{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class xs extends wg{constructor(e,n,r,i,s,a){super(e,n,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new nc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Od("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new he(J.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=xs._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()||(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED")),n}}xs._jsonSchemaVersion="firestore/documentSnapshot/1.0",xs._jsonSchema={type:Vt("string",xs._jsonSchemaVersion),bundleSource:Vt("string","DocumentSnapshot"),bundleName:Vt("string"),bundle:Vt("string")};class nc extends xs{data(e={}){return super.data(e)}}class Ea{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Po(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new nc(this._firestore,this._userDataWriter,r.key,r,new Po(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new he(J.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let s=0;return r._snapshot.docChanges.map(a=>{const u=new nc(r._firestore,r._userDataWriter,a.doc.key,a.doc,new Po(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);return a.doc,{type:"added",doc:u,oldIndex:-1,newIndex:s++}})}{let s=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const u=new nc(r._firestore,r._userDataWriter,a.doc.key,a.doc,new Po(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);let o=-1,d=-1;return a.type!==0&&(o=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),a.type!==1&&(s=s.add(a.doc),d=s.indexOf(a.doc.key)),{type:CM(a.type),doc:u,oldIndex:o,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new he(J.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ea._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=qp.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(n.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function CM(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return _e(61501,{type:t})}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function TC(t){t=Pr(t,Pt);const e=Pr(t.firestore,Za);return sM(pg(e),t._key).then(n=>NM(e,t,n))}Ea._jsonSchemaVersion="firestore/querySnapshot/1.0",Ea._jsonSchema={type:Vt("string",Ea._jsonSchemaVersion),bundleSource:Vt("string","QuerySnapshot"),bundleName:Vt("string"),bundle:Vt("string")};class IC extends xM{constructor(e){super(),this.firestore=e}convertBytes(e){return new Yn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Pt(this.firestore,null,n)}}function rc(t){t=Pr(t,Rr);const e=Pr(t.firestore,Za),n=pg(e),r=new IC(e);return vM(t._query),aM(n,t._query).then(i=>new Ea(e,r,t,i))}function _M(t,e,n){t=Pr(t,Pt);const r=Pr(t.firestore,Za),i=NC(t.converter,e,n);return Ng(r,[bC(Hl(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,ur.none())])}function kM(t,e,n,...r){t=Pr(t,Pt);const i=Pr(t.firestore,Za),s=Hl(i);let a;return a=typeof(e=nn(e))=="string"||e instanceof Md?pM(s,"updateDoc",t._key,e,n,r):mM(s,"updateDoc",t._key,e),Ng(i,[a.toMutation(t._key,ur.exists(!0))])}function EM(t,e){const n=Pr(t.firestore,Za),r=gC(t),i=NC(t.converter,e);return Ng(n,[bC(Hl(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,ur.exists(!1))]).then(()=>r)}function Ng(t,e){return function(n,r){const i=new $r;return n.asyncQueue.enqueueAndForget(async()=>GD(await iM(n),r,i)),i.promise}(pg(t),e)}function NM(t,e,n){const r=n.docs.get(e._key),i=new IC(t);return new xs(t,i,e._key,r,new Po(n.hasPendingWrites,n.fromCache),e.converter)}(function(t,e=!0){(function(n){Ka=n})(Ll),Is(new zi("firestore",(n,{instanceIdentifier:r,options:i})=>{const s=n.getProvider("app").getImmediate(),a=new Za(new fj(n.getProvider("auth-internal")),new gj(s,n.getProvider("app-check-internal")),function(u,o){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new he(J.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Cl(u.options.projectId,o)}(s,r),s);return i={useFetchStreams:e,...i},a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),Ir(ob,lb,t),Ir(ob,lb,"esm2020")})();/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const jC="firebasestorage.googleapis.com",AC="storageBucket",TM=2*60*1e3,IM=10*60*1e3;/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class It extends ti{constructor(e,n,r=0){super(Vh(e),`Firebase Storage: ${n} (${Vh(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,It.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Vh(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Tt;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Tt||(Tt={}));function Vh(t){return"storage/"+t}function Tg(){const t="An unknown error occurred, please check the error payload for server response.";return new It(Tt.UNKNOWN,t)}function jM(t){return new It(Tt.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function AM(t){return new It(Tt.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function DM(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new It(Tt.UNAUTHENTICATED,t)}function MM(){return new It(Tt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function PM(t){return new It(Tt.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function OM(){return new It(Tt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function RM(){return new It(Tt.CANCELED,"User canceled the upload/download.")}function LM(t){return new It(Tt.INVALID_URL,"Invalid URL '"+t+"'.")}function FM(t){return new It(Tt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function UM(){return new It(Tt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+AC+"' property when initializing the app?")}function VM(){return new It(Tt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function zM(){return new It(Tt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function BM(t){return new It(Tt.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Em(t){return new It(Tt.INVALID_ARGUMENT,t)}function DC(){return new It(Tt.APP_DELETED,"The Firebase app was deleted.")}function $M(t){return new It(Tt.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Yo(t,e){return new It(Tt.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function xo(t){throw new It(Tt.INTERNAL_ERROR,"Internal error: "+t)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class $n{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=$n.makeFromUrl(e,n)}catch{return new $n(e,"")}if(r.path==="")return r;throw FM(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(C){C.path.charAt(C.path.length-1)==="/"&&(C.path_=C.path_.slice(0,-1))}const a="(/(.*))?$",u=new RegExp("^gs://"+i+a,"i"),o={bucket:1,path:3};function d(C){C.path_=decodeURIComponent(C.path)}const h="v[A-Za-z0-9_]+",f=n.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",g=new RegExp(`^https?://${f}/${h}/b/${i}/o${p}`,"i"),b={bucket:1,path:3},N=n===jC?"(?:storage.googleapis.com|storage.cloud.google.com)":n,D="([^?#]*)",v=new RegExp(`^https?://${N}/${i}/${D}`,"i"),w=[{regex:u,indices:o,postModify:s},{regex:g,indices:b,postModify:d},{regex:v,indices:{bucket:1,path:2},postModify:d}];for(let C=0;C<w.length;C++){const O=w[C],R=O.regex.exec(e);if(R){const F=R[O.indices.bucket];let E=R[O.indices.path];E||(E=""),r=new $n(F,E),O.postModify(r);break}}if(r==null)throw LM(e);return r}}class HM{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function qM(t,e,n){let r=1,i=null,s=null,a=!1,u=0;function o(){return u===2}let d=!1;function h(...D){d||(d=!0,e.apply(null,D))}function f(D){i=setTimeout(()=>{i=null,t(g,o())},D)}function p(){s&&clearTimeout(s)}function g(D,...v){if(d){p();return}if(D){p(),h.call(null,D,...v);return}if(o()||a){p(),h.call(null,D,...v);return}r<64&&(r*=2);let w;u===1?(u=2,w=0):w=(r+Math.random())*1e3,f(w)}let b=!1;function N(D){b||(b=!0,p(),!d&&(i!==null?(D||(u=2),clearTimeout(i),f(0)):D||(u=1)))}return f(0),s=setTimeout(()=>{a=!0,N(!0)},n),N}function WM(t){t(!1)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function GM(t){return t!==void 0}function QM(t){return typeof t=="object"&&!Array.isArray(t)}function Ig(t){return typeof t=="string"||t instanceof String}function i0(t){return jg()&&t instanceof Blob}function jg(){return typeof Blob<"u"}function s0(t,e,n,r){if(r<e)throw Em(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw Em(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function Ag(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function MC(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var Cs;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Cs||(Cs={}));/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function KM(t,e){const n=t>=500&&t<600,r=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||r||i}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class XM{constructor(e,n,r,i,s,a,u,o,d,h,f,p=!0,g=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=a,this.callback_=u,this.errorCallback_=o,this.timeout_=d,this.progressCallback_=h,this.connectionFactory_=f,this.retry=p,this.isUsingEmulator=g,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((b,N)=>{this.resolve_=b,this.reject_=N,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new Eu(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const a=u=>{const o=u.loaded,d=u.lengthComputable?u.total:-1;this.progressCallback_!==null&&this.progressCallback_(o,d)};this.progressCallback_!==null&&s.addUploadProgressListener(a),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(a),this.pendingConnection_=null;const u=s.getErrorCode()===Cs.NO_ERROR,o=s.getStatus();if(!u||KM(o,this.additionalRetryCodes_)&&this.retry){const h=s.getErrorCode()===Cs.ABORT;r(!1,new Eu(!1,null,h));return}const d=this.successCodes_.indexOf(o)!==-1;r(!0,new Eu(d,s))})},n=(r,i)=>{const s=this.resolve_,a=this.reject_,u=i.connection;if(i.wasSuccessCode)try{const o=this.callback_(u,u.getResponse());GM(o)?s(o):s()}catch(o){a(o)}else if(u!==null){const o=Tg();o.serverResponse=u.getErrorText(),this.errorCallback_?a(this.errorCallback_(u,o)):a(o)}else if(i.canceled){const o=this.appDelete_?DC():RM();a(o)}else{const o=OM();a(o)}};this.canceled_?n(!1,new Eu(!1,null,!0)):this.backoffId_=qM(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&WM(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Eu{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function YM(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function JM(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function ZM(t,e){e&&(t["X-Firebase-GMPID"]=e)}function eP(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function tP(t,e,n,r,i,s,a=!0,u=!1){const o=MC(t.urlParams),d=t.url+o,h=Object.assign({},t.headers);return ZM(h,e),YM(h,n),JM(h,s),eP(h,r),new XM(d,t.method,h,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,a,u)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function nP(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function rP(...t){const e=nP();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(jg())return new Blob(t);throw new It(Tt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function iP(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function sP(t){if(typeof atob>"u")throw BM("base-64");return atob(t)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Er={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class zh{constructor(e,n){this.data=e,this.contentType=n||null}}function aP(t,e){switch(t){case Er.RAW:return new zh(PC(e));case Er.BASE64:case Er.BASE64URL:return new zh(OC(t,e));case Er.DATA_URL:return new zh(lP(e),uP(e))}throw Tg()}function PC(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,s=t.charCodeAt(++n);r=65536|(i&1023)<<10|s&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function oP(t){let e;try{e=decodeURIComponent(t)}catch{throw Yo(Er.DATA_URL,"Malformed data URL.")}return PC(e)}function OC(t,e){switch(t){case Er.BASE64:{const i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw Yo(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case Er.BASE64URL:{const i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw Yo(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=sP(e)}catch(i){throw i.message.includes("polyfill")?i:Yo(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}class RC{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Yo(Er.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=cP(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function lP(t){const e=new RC(t);return e.base64?OC(Er.BASE64,e.rest):oP(e.rest)}function uP(t){return new RC(t).contentType}function cP(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class vi{constructor(e,n){let r=0,i="";i0(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,n){if(i0(this.data_)){const r=this.data_,i=iP(r,e,n);return i===null?null:new vi(i)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new vi(r,!0)}}static getBlob(...e){if(jg()){const n=e.map(r=>r instanceof vi?r.data_:r);return new vi(rP.apply(null,n))}else{const n=e.map(a=>Ig(a)?aP(Er.RAW,a).data:a.data_);let r=0;n.forEach(a=>{r+=a.byteLength});const i=new Uint8Array(r);let s=0;return n.forEach(a=>{for(let u=0;u<a.length;u++)i[s++]=a[u]}),new vi(i,!0)}}uploadData(){return this.data_}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function LC(t){let e;try{e=JSON.parse(t)}catch{return null}return QM(e)?e:null}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function dP(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function hP(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function FC(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function fP(t,e){return e}class Cn{constructor(e,n,r,i){this.server=e,this.local=n||e,this.writable=!!r,this.xform=i||fP}}let Nu=null;function mP(t){return!Ig(t)||t.length<2?t:FC(t)}function UC(){if(Nu)return Nu;const t=[];t.push(new Cn("bucket")),t.push(new Cn("generation")),t.push(new Cn("metageneration")),t.push(new Cn("name","fullPath",!0));function e(s,a){return mP(a)}const n=new Cn("name");n.xform=e,t.push(n);function r(s,a){return a!==void 0?Number(a):a}const i=new Cn("size");return i.xform=r,t.push(i),t.push(new Cn("timeCreated")),t.push(new Cn("updated")),t.push(new Cn("md5Hash",null,!0)),t.push(new Cn("cacheControl",null,!0)),t.push(new Cn("contentDisposition",null,!0)),t.push(new Cn("contentEncoding",null,!0)),t.push(new Cn("contentLanguage",null,!0)),t.push(new Cn("contentType",null,!0)),t.push(new Cn("metadata","customMetadata",!0)),Nu=t,Nu}function pP(t,e){function n(){const r=t.bucket,i=t.fullPath,s=new $n(r,i);return e._makeStorageReference(s)}Object.defineProperty(t,"ref",{get:n})}function gP(t,e,n){const r={};r.type="file";const i=n.length;for(let s=0;s<i;s++){const a=n[s];r[a.local]=a.xform(r,e[a.server])}return pP(r,t),r}function VC(t,e,n){const r=LC(e);return r===null?null:gP(t,r,n)}function yP(t,e,n,r){const i=LC(e);if(i===null||!Ig(i.downloadTokens))return null;const s=i.downloadTokens;if(s.length===0)return null;const a=encodeURIComponent;return s.split(",").map(u=>{const o=t.bucket,d=t.fullPath,h="/b/"+a(o)+"/o/"+a(d),f=Ag(h,n,r),p=MC({alt:"media",token:u});return f+p})[0]}function vP(t,e){const n={},r=e.length;for(let i=0;i<r;i++){const s=e[i];s.writable&&(n[s.server]=t[s.local])}return JSON.stringify(n)}class zC{constructor(e,n,r,i){this.url=e,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function BC(t){if(!t)throw Tg()}function bP(t,e){function n(r,i){const s=VC(t,i,e);return BC(s!==null),s}return n}function wP(t,e){function n(r,i){const s=VC(t,i,e);return BC(s!==null),yP(s,i,t.host,t._protocol)}return n}function $C(t){function e(n,r){let i;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?i=MM():i=DM():n.getStatus()===402?i=AM(t.bucket):n.getStatus()===403?i=PM(t.path):i=r,i.status=n.getStatus(),i.serverResponse=r.serverResponse,i}return e}function SP(t){const e=$C(t);function n(r,i){let s=e(r,i);return r.getStatus()===404&&(s=jM(t.path)),s.serverResponse=i.serverResponse,s}return n}function xP(t,e,n){const r=e.fullServerUrl(),i=Ag(r,t.host,t._protocol),s="GET",a=t.maxOperationRetryTime,u=new zC(i,s,wP(t,n),a);return u.errorHandler=SP(e),u}function CP(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function _P(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=CP(null,e)),r}function kP(t,e,n,r,i){const s=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};function u(){let C="";for(let O=0;O<2;O++)C=C+Math.random().toString().slice(2);return C}const o=u();a["Content-Type"]="multipart/related; boundary="+o;const d=_P(e,r,i),h=vP(d,n),f="--"+o+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+o+`\r
Content-Type: `+d.contentType+`\r
\r
`,p=`\r
--`+o+"--",g=vi.getBlob(f,r,p);if(g===null)throw VM();const b={name:d.fullPath},N=Ag(s,t.host,t._protocol),D="POST",v=t.maxUploadRetryTime,w=new zC(N,D,bP(t,n),v);return w.urlParams=b,w.headers=a,w.body=g.uploadData(),w.errorHandler=$C(e),w}class EP{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Cs.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Cs.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Cs.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,i,s){if(this.sent_)throw xo("cannot .send() more than once");if(Vs(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),s!==void 0)for(const a in s)s.hasOwnProperty(a)&&this.xhr_.setRequestHeader(a,s[a].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw xo("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw xo("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw xo("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw xo("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class NP extends EP{initXhr(){this.xhr_.responseType="text"}}function HC(){return new NP}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Ds{constructor(e,n){this._service=e,n instanceof $n?this._location=n:this._location=$n.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Ds(e,n)}get root(){const e=new $n(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return FC(this._location.path)}get storage(){return this._service}get parent(){const e=dP(this._location.path);if(e===null)return null;const n=new $n(this._location.bucket,e);return new Ds(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw $M(e)}}function TP(t,e,n){t._throwIfRoot("uploadBytes");const r=kP(t.storage,t._location,UC(),new vi(e,!0),n);return t.storage.makeRequestWithTokens(r,HC).then(i=>({metadata:i,ref:t}))}function IP(t){t._throwIfRoot("getDownloadURL");const e=xP(t.storage,t._location,UC());return t.storage.makeRequestWithTokens(e,HC).then(n=>{if(n===null)throw zM();return n})}function jP(t,e){const n=hP(t._location.path,e),r=new $n(t._location.bucket,n);return new Ds(t.storage,r)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function AP(t){return/^[A-Za-z]+:\/\//.test(t)}function DP(t,e){return new Ds(t,e)}function qC(t,e){if(t instanceof Dg){const n=t;if(n._bucket==null)throw UM();const r=new Ds(n,n._bucket);return e!=null?qC(r,e):r}else return e!==void 0?jP(t,e):t}function MP(t,e){if(e&&AP(e)){if(t instanceof Dg)return DP(t,e);throw Em("To use ref(service, url), the first argument must be a Storage instance.")}else return qC(t,e)}function a0(t,e){const n=e==null?void 0:e[AC];return n==null?null:$n.makeFromBucketSpec(n,t)}function PP(t,e,n,r={}){t.host=`${e}:${n}`;const i=Vs(e);i&&(_1(`https://${t.host}/b`),E1("Storage",!0)),t._isUsingEmulator=!0,t._protocol=i?"https":"http";const{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:k1(s,t.app.options.projectId))}class Dg{constructor(e,n,r,i,s,a=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._isUsingEmulator=a,this._bucket=null,this._host=jC,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=TM,this._maxUploadRetryTime=IM,this._requests=new Set,i!=null?this._bucket=$n.makeFromBucketSpec(i,this._host):this._bucket=a0(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=$n.makeFromBucketSpec(this._url,e):this._bucket=a0(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){s0("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){s0("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(yi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ds(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new HM(DC());{const a=tP(e,this._appId,r,i,n,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,n){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()}}const o0="@firebase/storage",l0="0.14.0";/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const WC="storage";function u0(t,e,n){return t=nn(t),TP(t,e,n)}function OP(t){return t=nn(t),IP(t)}function RP(t,e){return t=nn(t),MP(t,e)}function LP(t=Bp(),e){t=nn(t);const n=A1(t,WC).getImmediate({identifier:e}),r=x1("storage");return r&&FP(n,...r),n}function FP(t,e,n,r={}){PP(t,e,n,r)}function UP(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new Dg(n,r,i,e,Ll)}function VP(){Is(new zi(WC,UP,"PUBLIC").setMultipleInstances(!0)),Ir(o0,l0,""),Ir(o0,l0,"esm2020")}VP();const c0={apiKey:"AIzaSyBEFE5oeajyI6VXHG5T17xLue8eRQNRzzk",authDomain:"kusgan-6ca2f.firebaseapp.com",projectId:"kusgan-6ca2f",storageBucket:"kusgan-6ca2f.firebasestorage.app",appId:"1:653741419351:web:39de9b909a028bb89a6c12"};let cs,d0,Nm;function Mg(){if(!cs){if(Gv&&Gv().length)try{cs=Bp()}catch{}if(!cs){if(!c0.projectId)throw new Error("Missing Firebase config in VITE_FIREBASE_PROJECT_ID");cs=D1(c0)}d0=uM(cs);try{Nm=LP(cs)}catch{Nm=null}}return{app:cs,db:d0}}function Pg(){return Mg().db}function Ld(t){return lM(Pg(),t)}function Fd(t,e){return gC(Pg(),t,String(e))}async function zP(t,e={}){const n=Ld(t);if(e.where){const r=Qc(n,km(e.where.field,e.where.op||"==",e.where.value));return(await rc(r)).docs.map(i=>({id:i.id,...i.data()}))}if(e.orderBy){const r=Qc(n,_C(e.orderBy.field,e.orderBy.dir||"asc"));return(await rc(r)).docs.map(i=>({id:i.id,...i.data()}))}return(await rc(n)).docs.map(r=>({id:r.id,...r.data()}))}async function BP(t,e={}){const n=Ld(t),r=[];if(Array.isArray(e.wheres))for(const s of e.wheres)r.push(km(s.field,s.op||"==",s.value));else e.where&&r.push(km(e.where.field,e.where.op||"==",e.where.value));e.orderBy&&r.push(_C(e.orderBy.field,e.orderBy.dir||"asc")),e.startAt!==void 0&&r.push(wM(e.startAt)),e.endAt!==void 0&&r.push(SM(e.endAt)),e.limit&&r.push(bM(Number(e.limit)));const i=r.length?Qc(n,...r):Qc(n);return(await rc(i)).docs.map(s=>({id:s.id,...s.data()}))}function GC(){return Mg(),Nm}async function $P(t,e){const n=GC();if(!n)throw new Error("Firebase Storage not initialized or not configured");const r=RP(n,t);if(typeof e=="string"){const i=e.replace(/^data:.*;base64,/,""),s=atob(i),a=new Uint8Array(s.length);for(let u=0;u<s.length;u++)a[u]=s.charCodeAt(u);await u0(r,a)}else await u0(r,e);return await OP(r)}async function HP(t,e){const n=Fd(t,e),r=await TC(n);return r.exists()?{id:r.id,...r.data()}:null}async function qP(t,e){const n=Ld(t);return{id:(await EM(n,e)).id,...e}}async function WP(t,e,n){const r=Fd(t,e);return await _M(r,n,{merge:!0}),{id:e,...n}}async function GP(t,e,n){const r=Fd(t,e);await kM(r,n);const i=await TC(r);return{id:i.id,...i.data()}}const ke={ensureFirebase:Mg,getDB:Pg,colRef:Ld,docRef:Fd,getCollection:zP,queryCollection:BP,getDocById:HP,addDocument:qP,setDocument:WP,updateDocument:GP,getStorageInstance:GC,uploadFile:$P},Kc="authToken";function QP(t){if(!t){try{localStorage.removeItem(Kc)}catch{}return}try{localStorage.setItem(Kc,t)}catch{}}function Jo(){try{return localStorage.getItem(Kc)}catch{return null}}function KP(){try{localStorage.removeItem(Kc)}catch{}}async function XP(t,e={}){const n=Jo(),r=Object.assign({},e.headers||{});return n&&(r.Authorization=`Bearer ${n}`),await fetch(t,Object.assign({},e,{headers:r}))}const at={setToken:QP,getToken:Jo,clearToken:KP,fetchWithAuth:XP};function YP({setToken:t}){k.useEffect(()=>{},[]);const[e,n]=k.useState(""),[r,i]=k.useState(""),[s,a]=k.useState(""),[u,o]=k.useState(!1),d=Qa(),h=async f=>{if(f&&f.preventDefault(),a(""),!e||!r){a("Please enter username and password");return}o(!0);try{const p=await fetch("/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:r})});if(!p.ok){if((String(e).trim()==="frontdesk"&&String(r)==="Kusgan2025!")||(String(e).trim()==="johannaa"&&String(r)==="JohannaA")){const N=`local-token-${Date.now()}`;try{at.setToken(N)}catch{}t(N);try{console.log("Login: used client-side fallback for frontdesk/johannaa")}catch{}try{d("/")}catch{}o(!1);return}const b=await p.json().catch(()=>({}));a(b.error||"Invalid username or password"),o(!1);return}const g=await p.json();if((String(e).trim()==="frontdesk"&&String(r)==="Kusgan2025!")||(String(e).trim()==="johannaa"&&String(r)==="JohannaA"))const p=`local-token-${Date.now()}`;try{at.setToken(p)}catch{}t(p);try{console.log("Login: used client-side fallback for frontdesk (network error)")}catch{}try{d("/")}catch{}o(!1);return}a("Server error  please try again")}finally{o(!1)}};return c.jsx("div",{style:{minHeight:"100vh",width:"100%",margin:0,display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, rgba(255,182,213,0.94), rgba(180,196,255,0.92))",backgroundRepeat:"no-repeat",backgroundSize:"cover"},children:c.jsxs("div",{style:{width:420,minHeight:520,padding:"56px 48px",borderRadius:28,background:"#11121d",boxShadow:"0 36px 70px rgba(0,0,0,0.40)",display:"flex",flexDirection:"column",alignItems:"center",color:"#fff",textAlign:"center"},children:[c.jsx("img",{src:"/kusgan-logo.png",alt:"Kusgan Logo",style:{width:160,height:160,objectFit:"cover",borderRadius:"22px",boxShadow:"0 10px 28px rgba(215,38,96,0.35)",marginBottom:24,background:"#000"}}),c.jsx("h1",{style:{fontSize:"1.6rem",fontWeight:700,margin:"0 0 8px"},children:"Kusgan Fitness Gym"}),c.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:"column",gap:8},children:[c.jsx("div",{style:{fontSize:13,color:"#c9c9da",fontWeight:600,marginBottom:4,textAlign:"left"}}),c.jsxs("form",{onSubmit:h,style:{width:"100%",display:"flex",flexDirection:"column",gap:8},children:[c.jsx("label",{style:{fontSize:12,color:"#c9c9da",textAlign:"left"},children:"Username"}),c.jsx("input",{type:"text",value:e,onChange:f=>n(f.target.value),placeholder:"Enter staff username",style:{padding:10,fontSize:16,borderRadius:6,border:"1px solid #2a2a36",background:"#0f1114",color:"#fff"}}),c.jsx("label",{style:{fontSize:12,color:"#c9c9da",textAlign:"left"},children:"Password"}),c.jsx("input",{type:"password",value:r,onChange:f=>i(f.target.value),placeholder:"Enter staff password",style:{padding:10,fontSize:16,borderRadius:6,border:"1px solid #2a2a36",background:"#0f1114",color:"#fff"}}),s&&c.jsx("div",{style:{color:"#f44336",fontSize:13},children:s}),c.jsx("button",{type:"submit",disabled:u,style:{marginTop:6,padding:"14px 12px",borderRadius:6,background:"#1976d2",color:"#fff",border:"none",cursor:u?"default":"pointer",opacity:u?.8:1,fontSize:18,fontWeight:700},children:u?"Signing in":"Sign in"})]}),c.jsxs("div",{style:{marginTop:18,width:"100%",textAlign:"center"},children:[c.jsx("div",{style:{fontSize:13,color:"#c9c9da",fontWeight:600,marginBottom:8},children:"Sign in as Member"}),c.jsx("div",{style:{display:"flex",justifyContent:"center"},children:c.jsxs("button",{disabled:!0,style:{borderRadius:8,padding:"8px 12px",background:"#fff",color:"#888",cursor:"not-allowed",border:"1px solid #ddd",display:"inline-flex",alignItems:"center",gap:10},"aria-disabled":!0,children:[c.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,focusable:"false",children:[c.jsx("path",{fill:"#4285F4",d:"M24 9.5c3.9 0 7.2 1.4 9.6 3.7l7-7C36.4 2.4 30.6 0 24 0 14.8 0 6.9 5.5 3 13.4l8 6.2C13.5 13 18 9.5 24 9.5z"}),c.jsx("path",{fill:"#34A853",d:"M46.5 24c0-1.4-.1-2.7-.4-4H24v8h12.7c-.5 2.8-2 5.1-4.3 6.7l6.7 5.2C43.9 36.5 46.5 30.6 46.5 24z"}),c.jsx("path",{fill:"#FBBC05",d:"M11 29.6c-1.2-3.5-1.2-7.3 0-10.8L3 12.6C1.1 15.9 0 19.8 0 24s1.1 8.1 3 11.4l8-6.2z"}),c.jsx("path",{fill:"#EA4335",d:"M24 48c6.6 0 12.4-2.4 16.9-6.5l-6.7-5.2c-2.3 1.5-5 2.4-10.2 2.4-6 0-10.5-3.5-12.4-8.6l-8 6.2C6.9 42.5 14.8 48 24 48z"})]}),c.jsx("span",{style:{fontWeight:700,color:"#6b6b6b"},children:"Sign in with Google"})]})}),c.jsx("div",{style:{marginTop:8,color:"#8b8b9b",fontSize:13},children:"Member login via Google is not yet enabled."})]})]})]})})}function h0(){var t,e,n,r;const i=new Intl.DateTimeFormat("en-US",{timeZone:"Asia/Manila",weekday:"long",month:"short",day:"2-digit",year:"numeric"}).formatToParts(new Date),s=(((t=i.find(d=>d.type==="weekday"))==null?void 0:t.value)||"").toUpperCase(),a=((e=i.find(d=>d.type==="month"))==null?void 0:e.value)||"Jan",u=parseInt(((n=i.find(d=>d.type==="day"))==null?void 0:n.value)||"01",10),o=((r=i.find(d=>d.type==="year"))==null?void 0:r.value)||"0000";return{weekday:s,text:`${a}-${u}, ${o}`}}function JP({onLogout:t=()=>{}}){const[e,n]=k.useState(h0()),[r,i]=k.useState(!1);return k.useEffect(()=>{const s=()=>n(h0()),a=setInterval(s,6e4);return s(),()=>clearInterval(a)},[]),k.useEffect(()=>{let s=!0;return(async()=>{var a;try{const u=await at.fetchWithAuth("/auth/me");if(!s)return;if(!u.ok)return i(!1);const o=await u.json().catch(()=>({}));i(((a=o==null?void 0:o.user)==null?void 0:a.role)==="admin")}catch{i(!1)}})(),()=>{s=!1}},[]),c.jsxs("aside",{className:"sidebar",children:[c.jsx("div",{className:"brand",children:c.jsx("img",{src:"/kusgan-logo.png",alt:"Kusgan logo",className:"brand-logo",style:{width:350,height:"auto"}})}),c.jsx("div",{className:"sidebar-info",children:c.jsxs("div",{className:"date",children:[c.jsx("div",{style:{fontSize:"14px",fontStyle:"italic",color:"#e9e9ee",marginBottom:"5px"},children:"Today is"}),c.jsxs("div",{style:{fontWeight:"600",fontSize:"20px",color:"#e9e9ee",marginBottom:"25px"},children:[e.weekday," ",e.text]})]})}),c.jsxs("nav",{className:"nav",children:[c.jsx(So,{to:"/",end:!0,children:" Dashboard"}),c.jsx(So,{to:"/attendance",children:" Staff Attendance"}),c.jsx(So,{to:"/members",children:" All Members"}),c.jsx(So,{to:"/checkin",children:" Member Check-In"}),r&&c.jsx(So,{to:"/admin",children:" Admin"})]}),c.jsx("div",{className:"sidebar-footer",children:c.jsx("button",{className:"button logout-btn",onClick:t,children:"Logout"})})]})}const Ce={members:"members",gymEntries:"gymEntries",payments:"payments",progress:"progress",attendance:"attendance",pricing:"pricing"};function QC(t){if(!t)return null;const e=String(t).trim().toLowerCase();return e==="members"?Ce.members:e==="gymentries"||e==="gymentries"||e==="gymentries"?Ce.gymEntries:e==="payments"?Ce.payments:e==="progresstracker"||e==="progress"?Ce.progress:e==="attendance"?Ce.attendance:e==="pricing"?Ce.pricing:e}function KC(t){if(!t)return null;const e={...t};return e.memberid=String(t.memberId||t.MemberID||t.id||t.memberid||"").trim(),e.firstname=t.firstName||t.firstname||t.FirstName||"",e.lastname=t.lastName||t.lastname||t.LastName||"",e._raw=t,e}async function Ud(){return{rows:(await ke.getCollection(Ce.members)).map(t=>({...t}))}}async function XC(){return Ud()}async function Og(t){try{if(typeof fetch=="function"){const n=await fetch("/api/members/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(n&&n.status===201)try{return await n.json()}catch{}if(n&&n.status===409)try{return await n.json()}catch{return{ok:!1,error:"Nickname already taken"}}}}catch{}try{const n=String(t.NickName||t.nickName||t.nickname||"").trim();if(n){const r=[];try{const i=await ke.queryCollection(Ce.members,{wheres:[{field:"NickName",op:"==",value:n}]});r.push(...i||[])}catch{}try{const i=await ke.queryCollection(Ce.members,{wheres:[{field:"nickname",op:"==",value:n}]});r.push(...i||[])}catch{}if(r.length>0&&r.some(i=>String(i.NickName||i.nickname||i.nick_name||i.nickName||"").trim().toLowerCase()===n.toLowerCase()))return{ok:!1,error:"Nickname already taken"}}}catch{}const e=await ke.addDocument(Ce.members,t);return{ok:!0,id:e.id,row:e}}async function YC(t){return Og(t)}async function JC(t){const e=String(t.MemberID||t.memberId||t.id||t.memberid||"").trim();if(!e)throw new Error("MemberID required for update");try{return await ke.setDocument(Ce.members,e,t),{ok:!0}}catch(n){try{const r=await fetch(`/api/members/${encodeURIComponent(e)}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(r&&r.ok)try{return await r.json()}catch{return{ok:!0}}throw n}catch(r){throw r||n}}}async function Rg(t){if(!t)return null;const e=await ke.getDocById(Ce.members,String(t));return e?KC(e):null}async function ZC(t){return Rg(t)}async function e_(t){if(!t)throw new Error("memberId required");const[e,n,r,i]=await Promise.all([Ud(),ke.getCollection(Ce.payments),ke.getCollection(Ce.gymEntries),ke.getCollection(Ce.progress)]),s=String(t).trim(),a=(e.rows||[]).find(h=>String(h.MemberID||h.memberId||h.id||h.memberid||"").trim()===s)||null;KC(a);const u=(n||[]).filter(h=>String(h.MemberID||h.memberId||h.id||h.memberid||"").trim()===s),o=(r||[]).filter(h=>String(h.MemberID||h.memberId||h.id||h.memberid||"").trim()===s),d=(i||[]).filter(h=>String(h.MemberID||h.memberId||h.id||h.memberid||"").trim()===s);return{member:a,payments:u,gymEntries:o,progress:d}}async function Lg(){return{rows:await ke.getCollection(Ce.gymEntries)}}async function t_(){return Lg()}async function Ms(t){return{ok:!0,id:(await ke.addDocument(Ce.gymEntries,t)).id}}async function n_(t,e={}){if(!t)throw new Error("memberId required");const n=new Date().toISOString(),r=n.slice(0,10),i=!!e.wantsOut,s={...e};if(!i)return!s.TimeIn&&!s.timeIn&&(s.TimeIn=n),!s.Date&&!s.date&&(s.Date=r),s.MemberID=t,await Ms(s);const a=await ke.getCollection(Ce.gymEntries),u=f=>{try{if(String(f.MemberID||f.memberId||f.memberid||"").trim()!==String(t).trim())return!1;if(s.TimeIn&&s.Date){const p=String(f.TimeIn||f.timeIn||""),g=String(f.Date||f.date||"");if(p&&g&&String(s.TimeIn)===String(p)&&String(s.Date)===String(g))return!0}return!1}catch{return!1}};let o=null;if(s.TimeIn&&s.Date&&(o=a.find(u)||null),!o){const f=new Date;f.setHours(0,0,0,0);const p=a.filter(g=>{try{if(String(g.MemberID||g.memberId||g.memberid||"").trim()!==String(t).trim())return!1;const b=new Date(g.Date||g.date||g.DateTime||g.timestamp||g.TimeIn||"");if(isNaN(b))return!1;b.setHours(0,0,0,0);const N=b.getTime()===f.getTime(),D=g.TimeOut||g.timeOut||g.Timeout||g.TimeOUT;return N&&(!D||String(D).trim()==="")}catch{return!1}}).sort((g,b)=>{const N=g.TimeIn||g.timeIn||"",D=b.TimeIn||b.timeIn||"";return String(D).localeCompare(String(N))});o=p.length?p[0]:null}const d=new Date().toISOString();if(!o){const f={MemberID:t,TimeOut:d,Date:s.Date||r};return s.Workouts&&(f.Workouts=s.Workouts),s.Comments&&(f.Comments=s.Comments),s.Coach&&(f.Coach=s.Coach),s.Focus&&(f.Focus=s.Focus),await Ms(f)}const h={TimeOut:d};s.Workouts&&(h.Workouts=s.Workouts),s.Comments&&(h.Comments=s.Comments),s.Coach&&(h.Coach=s.Coach),s.Focus&&(h.Focus=s.Focus);try{const f=o.TimeIn||o.timeIn||"";if(f){const p=new Date(f),g=new Date(d);if(!isNaN(p)&&!isNaN(g)&&g>p){const b=(g-p)/36e5;h.TotalHours=Math.round(b*100)/100}}}catch{}return await ke.updateDocument(Ce.gymEntries,o.id,h),{ok:!0,id:o.id}}async function ZP(t,e={}){if(!t)throw new Error("memberId is required");const n=await ke.getCollection(Ce.gymEntries),r=new Date;r.setHours(0,0,0,0);const i=n.find(u=>{try{const o=String(u.MemberID||u.memberId||u.memberid||u.id||"");if(!o||o.trim()!==String(t).trim())return!1;const d=new Date(u.Date||u.date||u.DateTime||u.timestamp||"");if(isNaN(d))return!1;d.setHours(0,0,0,0);const h=d.getTime()===r.getTime(),f=u.TimeOut||u.timeOut||u.Timeout||u.TimeOUT;return h&&(!f||String(f).trim()==="")}catch{return!1}});if(i)return{ok:!0,id:i.id,existed:!0};const s=new Date().toISOString(),a=s.slice(0,10);return await Ms({MemberID:t,TimeIn:s,Date:a,...e})}async function eO(t,e={}){if(!t)throw new Error("memberId is required");const n=(await ke.getCollection(Ce.gymEntries)).filter(a=>String(a.MemberID||a.memberId||a.memberid||"").trim()===String(t).trim()&&!(a.TimeOut||a.timeOut||"").toString().trim()).sort((a,u)=>{const o=a.TimeIn||a.timeIn||"",d=u.TimeIn||u.timeIn||"";return String(o).localeCompare(String(d))});if(!n.length){const a=new Date().toISOString(),u=a.slice(0,10);return Ms({MemberID:t,TimeOut:a,Date:u,...e})}const r=n[n.length-1],i=new Date().toISOString(),s={TimeOut:i};e&&Object.assign(s,e);try{const a=r.TimeIn||r.timeIn||"";if(a){const u=new Date(a),o=new Date(i);if(!isNaN(u)&&!isNaN(o)&&o>u){const d=(o-u)/36e5;s.TotalHours=Math.round(d*100)/100}}}catch{}return await ke.updateDocument(Ce.gymEntries,r.id,s),{ok:!0,id:r.id}}async function tO(t){if(!t)throw new Error("payload required");const e=t.MemberID||t.memberId||t.memberid||"";if(t.id)return await ke.updateDocument(Ce.gymEntries,String(t.id),t),{ok:!0};const n=(await ke.getCollection(Ce.gymEntries)).find(r=>{try{const i=String(r.MemberID||r.memberId||r.memberid||"").trim();if(!i||String(i)!==String(e).trim())return!1;const s=String(r.TimeIn||r.timeIn||""),a=String(t.TimeIn||t.timeIn||""),u=String(r.Date||r.date||""),o=String(t.Date||t.date||"");return!!(a&&s&&a===s&&o&&u&&o===u||t.rowNumber&&String(r.rowNumber||"")===String(t.rowNumber))}catch{return!1}});if(n){try{const r=t.TimeIn||t.timeIn||"",i=t.TimeOut||t.timeOut||"";if(r&&i&&(t.TotalHours===void 0||t.TotalHours===null||t.TotalHours==="")){const s=new Date(r),a=new Date(i);if(!isNaN(s)&&!isNaN(a)&&a>s){const u=(a-s)/36e5;t.TotalHours=Math.round(u*100)/100}}}catch{}return await ke.updateDocument(Ce.gymEntries,n.id,t),{ok:!0,id:n.id}}return await Ms(t)}async function r_(t){if(!t)throw new Error("payload required");if(t.id)return await ke.updateDocument(Ce.attendance,String(t.id),t),{ok:!0};const e=(await ke.getCollection(Ce.attendance)).find(n=>{try{const r=String(n.Staff||n.staff_name||n.staff||"").trim(),i=String(t.Staff||t.staff_name||t.staff||"").trim();if(!r||!i||String(r).toLowerCase()!==String(i).toLowerCase())return!1;const s=String(n.TimeIn||n.time_in||""),a=String(t.TimeIn||t.time_in||""),u=String(n.Date||n.date||""),o=String(t.Date||t.date||"");return!!(a&&s&&a===s&&o&&u&&o===u||t.rowNumber&&String(n.rowNumber||"")===String(t.rowNumber))}catch{return!1}})||null;if(e){try{const n=t.TimeIn||t.time_in||"",r=t.TimeOut||t.time_out||"";if(n&&r&&(t.NoOfHours===void 0||t.NoOfHours===null||t.NoOfHours==="")){const i=new Date(n),s=new Date(r);if(!isNaN(i)&&!isNaN(s)&&s>i){const a=(s-i)/36e5;t.NoOfHours=Math.round(a*100)/100}}}catch{}return await ke.updateDocument(Ce.attendance,e.id,t),{ok:!0,id:e.id}}return{ok:!0,id:(await ke.addDocument(Ce.attendance,t)).id}}async function i_(){return{rows:await ke.getCollection(Ce.progress)}}async function s_(t){if(!t)throw new Error("row required");try{return{ok:!0,id:(await ke.addDocument(Ce.progress,t)).id}}catch(e){try{if(typeof fetch=="function"){const n=await fetch("/api/progress",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(n&&n.ok)try{return await n.json()}catch{return{ok:!0}}}}catch{}throw e}}async function a_({limit:t=200,days:e=90}={}){const n=new Date(Date.now()-e*24*60*60*1e3);let r=[],i=[],s=[];try{[r,i,s]=await Promise.all([ke.getCollection(Ce.members),ke.getCollection(Ce.payments),ke.getCollection(Ce.gymEntries)])}catch{r=i=s=[]}if((!r||r.length===0)&&typeof fetch=="function")try{const[h,f,p]=await Promise.all([fetch("/api/members"),fetch("/api/payments"),fetch("/api/gymEntries")]);h&&h.ok&&(r=await h.json()),f&&f.ok&&(i=await f.json()),p&&p.ok&&(s=await p.json())}catch{}const a=(r||[]).map(h=>({...h})),u=new Set,o=h=>{if(!h)return null;const f=h instanceof Date?h:new Date(h);return isNaN(f)?null:f};for(const h of a){const f=o(h.memberDate||h.member_date||h.member_since||h.membersince||h.MemberSince||h.MemberSince||h.MemberDate||h.memberSince||h.createdAt||h.created_at||h.joined||h.start_date);f&&f>=n&&u.add(String(h.memberId||h.MemberID||h.memberId||h.id||h.memberid||h.member||"").trim())}for(const h of i||[]){const f=o(h.date||h.Date||h.createdAt||h.created_at||h.timestamp);if(f&&f>=n){const p=String(h.MemberID||h.memberId||h.memberid||h.id||"").trim();p&&u.add(p)}}for(const h of s||[]){const f=o(h.Date||h.date||h.DateTime||h.timestamp||h.timeIn||h.TimeIn);if(f&&f>=n){const p=String(h.MemberID||h.memberId||h.memberid||h.id||"").trim();p&&u.add(p)}}let d=[];return u.size>0?d=a.filter(h=>u.has(String(h.memberId||h.MemberID||h.id||h.memberid||"").trim())):d=[...a].sort((h,f)=>{const p=o(h.memberDate||h.createdAt||h.joined),g=o(f.memberDate||f.createdAt||f.joined);return!p&&!g?0:p?g?g-p:-1:1}),{rows:d.slice(0,Math.max(0,Number(t)||200))}}const Bh=new Map,nO=1e3*30;async function o_(t,{limit:e=200}={}){if(!t||!String(t).trim())return{rows:[]};const n=String(t).trim().toLowerCase(),r=`search:${n}`,i=Bh.get(r);if(i&&Date.now()-i.ts<nO)return{rows:i.rows.slice(0,e)};const s=n+"",a=["firstName","firstname","lastName","lastname","nickname","nick_name","nickName"],u=new Map;try{for(const d of a)try{const h=await ke.queryCollection(Ce.members,{orderBy:{field:d},startAt:n,endAt:s,limit:e});for(const f of h)u.set(f.id||String(f.MemberID||f.memberId||f.id||""),f)}catch{continue}if(u.size===0){const d=await ke.getCollection(Ce.members);for(const h of d)JSON.stringify(h).toLowerCase().indexOf(n)!==-1&&u.set(h.id||String(h.MemberID||h.memberId||h.id||""),h)}const o=Array.from(u.values()).slice(0,e).map(d=>({...d}));return Bh.set(r,{rows:o,ts:Date.now()}),{rows:o}}catch{try{const o=(await ke.getCollection(Ce.members)||[]).filter(d=>JSON.stringify(d).toLowerCase().indexOf(n)!==-1).slice(0,e);return Bh.set(r,{rows:o,ts:Date.now()}),{rows:o}}catch{return{rows:[]}}}}async function rO(t){const e=QC(t);return e?{rows:await ke.getCollection(e)}:{rows:[]}}async function iO(t,e){const n=QC(t);if(!n)throw new Error("Unknown sheet: "+t);return{ok:!0,id:(await ke.addDocument(n,e)).id}}async function l_(){return{rows:await ke.getCollection(Ce.payments)}}async function u_(t){return{ok:!0,id:(await ke.addDocument(Ce.payments,t)).id}}async function c_(t,e){const n=r=>new Promise((i,s)=>{try{const a=new FileReader;a.onload=()=>i(a.result),a.onerror=u=>s(u),a.readAsDataURL(r)}catch(a){s(a)}});try{if(t instanceof Blob||typeof File<"u"&&t instanceof File){const o=t,d=o&&o.name||`photo-${Date.now()}.jpg`,h=`members/${String(e||"unknown")}/${d}`;return await ke.uploadFile(h,o)}const r=t||{},i=r.memberId||r.MemberID||e||"unknown",s=r.filename||`photo-${Date.now()}.jpg`,a=r.data||r.base64||"",u=`members/${String(i)}/${s}`;return await ke.uploadFile(u,a)}catch(r){try{let i="",s=`photo-${Date.now()}.jpg`;if(t instanceof Blob||typeof File<"u"&&t instanceof File){const o=t;i=await n(o),s=o&&o.name||s}else{const o=t||{};i=o.data||o.base64||"",s=o.filename||s}if(!i)throw new Error("no data for fallback upload");const a=await fetch("/api/upload-photo",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filename:s,data:i})});if(!a.ok)throw new Error("proxy upload failed");const u=await a.json();if(u&&u.url)return u.url.indexOf("http")===0?u.url:`${location.origin}${u.url}`;throw new Error("invalid proxy response")}catch(i){throw new Error("uploadMemberPhoto failed: "+String((i==null?void 0:i.message)||r))}}}async function d_(t){return c_(t)}async function h_(){return{rows:await ke.getCollection(Ce.pricing)}}async function f_(t){const e=await ke.addDocument(Ce.pricing,t);return{ok:!0,id:e.id,row:e}}async function m_(t,e){const n=await ke.updateDocument(Ce.pricing,String(t),e);return{ok:!0,id:n.id,row:n}}async function p_(t){const e=await ke.getCollection(Ce.attendance);return t?{rows:e.filter(n=>String(n.Date||"").startsWith(String(t)))}:{rows:e}}async function g_(t){if(!t)throw new Error("staff required");const e=new Date().toISOString();return{ok:!0,id:(await ke.addDocument(Ce.attendance,{Staff:t,TimeIn:e,Date:e.slice(0,10)})).id}}async function y_(t){const e=(await ke.getCollection(Ce.attendance)).filter(r=>String(r.Staff)===String(t)&&(!r.TimeOut||r.TimeOut==="")).sort((r,i)=>(r.TimeIn||"").localeCompare(i.TimeIn||""));if(!e.length)return{ok:!1,error:"no open entry"};const n=e[e.length-1];return await ke.updateDocument(Ce.attendance,n.id,{TimeOut:new Date().toISOString()}),{ok:!0}}async function v_(t,e={}){if(!t)throw new Error("staff required");const n=new Date().toISOString(),r=n.slice(0,10);if(e.wantsOut){const i=await ke.getCollection(Ce.attendance);let s=null;const a=o=>{try{if(String(o.Staff||o.staff||o.staff_name||"").trim()!==String(t).trim())return!1;if(e.TimeIn&&e.Date){const d=String(o.TimeIn||o.time_in||""),h=String(o.Date||o.date||"");if(d&&h&&String(e.TimeIn)===String(d)&&String(e.Date)===String(h))return!0}return!1}catch{return!1}};if(e.TimeIn&&e.Date&&(s=i.find(a)||null),!s){const o=new Date;o.setHours(0,0,0,0);const d=i.filter(h=>{try{if(String(h.Staff||h.staff||h.staff_name||"").trim()!==String(t).trim())return!1;const f=new Date(h.Date||h.date||h.TimeIn||h.time_in||"");if(isNaN(f))return!1;f.setHours(0,0,0,0);const p=f.getTime()===o.getTime(),g=h.TimeOut||h.time_out||h.timeout||"";return p&&(!g||String(g).trim()==="")}catch{return!1}}).sort((h,f)=>{const p=h.TimeIn||h.time_in||"",g=f.TimeIn||f.time_in||"";return String(g).localeCompare(String(p))});s=d.length?d[0]:null}if(!s){const o={Staff:t,TimeOut:n,Date:e.Date||r};return e.Notes&&(o.Notes=e.Notes),{ok:!0,id:(await ke.addDocument(Ce.attendance,o)).id}}const u={TimeOut:n};e.Notes&&(u.Notes=e.Notes);try{const o=s.TimeIn||s.time_in||s.TimeInISO||s.timeIn||"";if(o){const d=new Date(o),h=new Date(n);if(!isNaN(d)&&!isNaN(h)&&h>d){const f=(h-d)/36e5;u.NoOfHours=Math.round(f*100)/100}}}catch{}return e.TotalHours&&(u.TotalHours=e.TotalHours),await ke.updateDocument(Ce.attendance,s.id,u),{ok:!0,id:s.id}}return{ok:!0,id:(await ke.addDocument(Ce.attendance,{Staff:t,TimeIn:n,Date:r,...e})).id}}async function b_(){return{rows:[]}}const sO={fetchMembers:Ud,fetchMembersFresh:XC,addMember:Og,saveMember:YC,updateMember:JC,fetchMemberById:Rg,fetchMemberByIdFresh:ZC,fetchMemberBundle:e_,fetchAttendance:p_,clockIn:g_,clockOut:y_,attendanceQuickAppend:v_,fetchGymEntries:Lg,fetchGymEntriesFresh:t_,addGymEntry:Ms,gymQuickAppend:n_,fetchProgressTracker:i_,addProgressRow:s_,fetchPricing:h_,fetchPayments:l_,addPayment:u_,fetchDashboard:b_,fetchMembersRecent:a_,searchMembersByName:o_,addPricing:f_,updatePricing:m_,uploadPhoto:d_,upsertAttendance:r_},aO=Object.freeze(Object.defineProperty({__proto__:null,addGymEntry:Ms,addMember:Og,addPayment:u_,addPricing:f_,addProgressRow:s_,attendanceQuickAppend:v_,clockIn:g_,clockOut:y_,default:sO,fetchAttendance:p_,fetchDashboard:b_,fetchGymEntries:Lg,fetchGymEntriesFresh:t_,fetchMemberBundle:e_,fetchMemberById:Rg,fetchMemberByIdFresh:ZC,fetchMembers:Ud,fetchMembersFresh:XC,fetchMembersRecent:a_,fetchPayments:l_,fetchPricing:h_,fetchProgressTracker:i_,fetchSheet:rO,gymClockIn:ZP,gymClockOut:eO,gymQuickAppend:n_,insertRow:iO,saveMember:YC,searchMembersByName:o_,updateMember:JC,updatePricing:m_,uploadMemberPhoto:c_,uploadPhoto:d_,upsertAttendance:r_,upsertGymEntry:tO},Symbol.toStringTag,{value:"Module"})),Ae=aO,f0=k.createContext(!1);function ts({open:t,onClose:e,title:n,children:r,width:i=760,maxHeight:s="90vh",noWrapper:a=!1,noInternalScroll:u=!1}){if(!t)return null;const o=k.useContext(f0),d={width:"min(1000px, 96vw)",background:"#fff",borderRadius:14,padding:16,border:"1px solid var(--light-border)",boxShadow:"0 20px 60px rgba(0,0,0,.2)",maxHeight:s,overflowY:"auto",overflowX:"hidden",boxSizing:"border-box"};return o&&!a?c.jsx("div",{style:d,children:r}):c.jsx(f0.Provider,{value:!0,children:c.jsx("div",{onClick:h=>{h.target===h.currentTarget&&e&&e()},style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:a?(()=>{const h={width:`min(${i}px, 96vw)`,background:"#fff",borderRadius:14,padding:16,border:"1px solid var(--light-border)",boxShadow:"0 20px 60px rgba(0,0,0,.2)",maxHeight:"98vh",overflow:"visible",boxSizing:"border-box"};return c.jsxs("div",{style:h,onClick:f=>f.stopPropagation(),children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[n?c.jsx("div",{style:{fontWeight:800,fontSize:18},children:n}):c.jsx("div",{}),c.jsx("button",{type:"button",className:"button",onClick:e,style:{background:"#eee",color:"#333"},children:""})]}),r]})})():u?(()=>{const h={...d,maxHeight:"98vh",overflowY:"visible"};return c.jsxs("div",{style:h,onClick:f=>f.stopPropagation(),children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10},children:[n?c.jsx("div",{style:{fontWeight:800,fontSize:18},children:n}):c.jsx("div",{}),c.jsx("button",{type:"button",className:"button",onClick:e,style:{background:"#eee",color:"#333"},children:""})]}),r]})})():c.jsxs("div",{style:d,onClick:h=>h.stopPropagation(),children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10},children:[n?c.jsx("div",{style:{fontWeight:800,fontSize:18},children:n}):c.jsx("div",{}),c.jsx("button",{type:"button",className:"button",onClick:e,style:{background:"#eee",color:"#333"},children:""})]}),r]})})})}const Na=new Map;function oO(t,e){return Na.has(t)||Na.set(t,new Set),Na.get(t).add(e),()=>w_(t,e)}function w_(t,e){const n=Na.get(t);n&&(n.delete(e),n.size||Na.delete(t))}function lO(t,e){const n=Na.get(t);if(n)for(const r of Array.from(n))try{r(e)}catch(i){console.error("event handler error",i)}}const en={on:oO,off:w_,emit:lO},{addPayment:uO,fetchPricing:cO,fetchPayments:dO}=Ae,Gl="Asia/Manila",Tu=()=>new Intl.DateTimeFormat("en-CA",{timeZone:Gl,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date),Qs=t=>{if(!t)return"";const e=t instanceof Date?t:new Date(t);return isNaN(e)?"":new Intl.DateTimeFormat("en-CA",{timeZone:Gl,year:"numeric",month:"2-digit",day:"2-digit"}).format(e)},hO=()=>new Intl.DateTimeFormat("en-PH",{timeZone:Gl,hour:"2-digit",minute:"2-digit",hour12:!1}).format(new Date).replace(/^(\d{2}):(\d{2}).*$/,"$1:$2"),Iu=t=>{var e,n,r;if(!t)return"-";let i;if(typeof t=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(t)){const[d,h,f]=t.split("-").map(Number);i=new Date(Date.UTC(d,h-1,f))}else i=t instanceof Date?t:new Date(t);if(isNaN(i))return"-";const s=new Intl.DateTimeFormat("en-US",{timeZone:Gl,month:"short",day:"numeric",year:"numeric"}).formatToParts(i),a=((e=s.find(d=>d.type==="month"))==null?void 0:e.value)||"",u=((n=s.find(d=>d.type==="day"))==null?void 0:n.value)||"",o=((r=s.find(d=>d.type==="year"))==null?void 0:r.value)||"";return`${a}-${u}, ${o}`},Co=(t,e)=>{if(!t||!e)return"";const[n,r,i]=t.split("-").map(Number),s=new Date(Date.UTC(n,r-1,i));return s.setUTCDate(s.getUTCDate()+Math.max(0,Number(e)-1)),new Intl.DateTimeFormat("en-CA",{timeZone:"UTC",year:"numeric",month:"2-digit",day:"2-digit"}).format(s)},m0=t=>{const e=String(t??"").trim().toLowerCase();return e==="yes"||e==="y"||e==="true"||e==="1"},_o=t=>{if(!t)return{gym:!1,coach:!1};const e=Object.entries(t||{}),n=s=>{for(const[a,u]of e){const o=a.toLowerCase().replace(/\s+/g,"");if(s.some(d=>o===d.toLowerCase().replace(/\s+/g,"")))return u}},r=m0(n(["Gym membership","Gym Membership","GymMembership","Membership"])),i=m0(n(["Coach subscription","Coach Subscription","CoachSubscription","Coach"]));return{gym:r,coach:i}},Ks=(t,e=0)=>{if(!t)return"";const[n,r,i]=String(t).split("-").map(Number);if([n,r,i].some(a=>Number.isNaN(a)))return"";const s=new Date(Date.UTC(n,r-1,i));return s.setUTCDate(s.getUTCDate()+Number(e||0)),new Intl.DateTimeFormat("en-CA",{timeZone:"UTC",year:"numeric",month:"2-digit",day:"2-digit"}).format(s)};function fO({open:t,onClose:e,memberId:n,onSaved:r,membershipEnd:i,coachEnd:s,isStudent:a,birthDate:u}){const[o,d]=k.useState([]),[h,f]=k.useState(!1),[p,g]=k.useState([]),[b,N]=k.useState({Particulars:"",Mode:"",Cost:"",StartDate:"",EndDate:""}),[D,v]=k.useState("");k.useEffect(()=>{let S=!0;if(!t){d([]),N({Particulars:"",Mode:"",Cost:"",StartDate:"",EndDate:""}),v("");return}return(async()=>{try{v("");let _=[];try{const I=await cO();I&&Array.isArray(I.rows)?_=I.rows:I&&Array.isArray(I)&&(_=I)}catch{}if((!_||_.length===0)&&typeof fetch=="function"){const I=["/api/products","http://localhost:4000/products"];for(const T of I)try{const te=await fetch(T);if(te&&te.ok){const K=await te.json().catch(()=>null);if(K&&Array.isArray(K)){_=(K||[]).map(Y=>({Particulars:Y.name||Y.sku||`Product ${Y.id}`,Cost:typeof Y.price<"u"?Number(Y.price).toFixed(2):"",Validity:Y.validity_days||Y.validity||0,"Gym membership":Y.is_gym_membership?"Yes":"No","Coach subscription":Y.is_coach_subscription?"Yes":"No",Notes:Y.notes||""}));break}}}catch{}}S&&d(_||[])}catch(_){S&&v((_==null?void 0:_.message)||"Failed to load pricing")}})(),()=>{S=!1}},[t]),k.useEffect(()=>{if(!t||!n){g([]);return}let S=!0;return(async()=>{try{const _=await dO(),I=_&&Array.isArray(_.rows)?_.rows:Array.isArray(_)?_:[];if(!S)return;const T=String(n).trim(),te=(I||[]).filter(K=>String(K.MemberID||K.memberId||K.MemberID||K.memberid||"").trim()===T);g(te||[])}catch{g([])}})(),()=>{S=!1}},[t,n]);const w=k.useMemo(()=>{if(!u)return!1;const S=u instanceof Date?u:new Date(u);if(isNaN(S))return!1;const _=new Date;let I=_.getFullYear()-S.getFullYear();const T=_.getMonth()-S.getMonth();return(T<0||T===0&&_.getDate()<S.getDate())&&I--,I>=60},[u]),{manilaHour:C,isOffPeakWindow:O,isDailyWindow:R}=k.useMemo(()=>{var S;const _=new Intl.DateTimeFormat("en-US",{timeZone:Gl,hour12:!1,hour:"2-digit"}).formatToParts(new Date),I=Number(((S=_.find(K=>K.type==="hour"))==null?void 0:S.value)||"0"),T=I>=6&&I<15,te=I>=15&&I<22;return{manilaHour:I,isOffPeakWindow:T,isDailyWindow:te}},[]),F=k.useMemo(()=>{const S=!!(a||w);return(o||[]).filter(_=>{const I=String(_.Particulars||"").trim();I.toLowerCase();const T=/(student|senior|discount|disc)/i.test(I),te=/off\s*-?\s*peak|offpeak/i.test(I),K=/\bdaily\b|daily\s*pass|1[- ]?day/i.test(I),Y=_o(_);if(T&&!S)return!1;const ce=(()=>{try{if(!i)return!1;const W=new Date(i);W.setHours(0,0,0,0);const ee=new Date;return ee.setHours(0,0,0,0),W>=ee}catch{return!1}})(),L=(()=>{try{if(!s)return!1;const W=new Date(s);W.setHours(0,0,0,0);const ee=new Date;return ee.setHours(0,0,0,0),W>=ee}catch{return!1}})(),G=K&&Y.gym&&!Y.coach,z=K&&Y.coach&&!Y.gym,$=K&&Y.gym&&Y.coach;return!(G&&ce||z&&L||$&&(ce||L)||te&&!O&&!(K&&Y.coach&&!Y.gym)||K&&!te&&!R&&!(Y.coach&&!Y.gym))})},[o,a,w,O,R,i,s]);k.useEffect(()=>{b.Particulars&&(F.some(S=>String(S.Particulars)===String(b.Particulars))||N(S=>({...S,Particulars:"",Cost:"",EndDate:""})))},[F]);const E=k.useMemo(()=>{const S={gymOnly:[],coachOnly:[],bundle:[],merch:[]};return(F||[]).forEach(_=>{const I=_o(_);I.gym&&!I.coach?S.gymOnly.push(_):!I.gym&&I.coach?S.coachOnly.push(_):I.gym&&I.coach?S.bundle.push(_):S.merch.push(_)}),S},[F]),x=S=>{const _=(F||[]).find(ee=>String(ee.Particulars)===String(S)),I=_?(parseFloat(_.Cost)||0).toFixed(2):"",T=_?Number(_.Validity||0):0,te=_o(_),K=/\bdaily\b|daily\s*pass|1[- ]?day/i.test(String(S||""));let Y=!1;if(K&&p&&p.length){const ee=Date.now()-2592e6,Z=String(S||"").trim();(p||[]).filter(ie=>{try{if(String(ie.Particulars||ie.Particular||"").trim()!==Z)return!1;const P=ie.Date||ie.DatePaid||ie.DateTime||ie.timestamp||ie.Timestamp||ie.Time||null;if(!P)return!1;let V=new Date(P);if(isNaN(V))if(/^\d{4}-\d{2}-\d{2}$/.test(String(P)))V=new Date(String(P)+"T00:00:00");else return!1;return V.getTime()>=ee}catch{return!1}}).length>=12&&(Y=!0)}const ce=Tu(),L=i?Qs(i):"",G=s?Qs(s):"",z=te.gym?L&&L>=ce?Ks(L,1):ce:null,$=te.coach?G&&G>=ce?Ks(G,1):ce:null;let W=ce;te.gym&&te.coach?W=ce:te.gym&&z?W=z:te.coach&&$?W=$:W=ce,N(ee=>{const Z=W||ee.StartDate||ce;return{...ee,Particulars:S,Cost:Y?"0.00":I,StartDate:Z,EndDate:T?Co(Z,T):"",PromoApplied:Y}})},j=async S=>{if(S.preventDefault(),!n)return v("Missing MemberID");if(!b.Particulars)return v("Select Particulars.");if(!b.Mode)return v("Select a payment mode.");if(!b.Cost)return v("Cost is missing for this item.");f(!0),v("");try{const _=(F||[]).find(P=>String(P.Particulars)===String(b.Particulars)),I=_?Number(_.Validity||0):0,T=_o(_),te=String((_==null?void 0:_.Particulars)||"").toLowerCase(),K=/\bdaily\b|daily\s*pass|1[- ]?day/i.test(te),Y=/off\s*-?\s*peak|offpeak/i.test(te),ce=(()=>{try{if(!i)return!1;const P=new Date(i);P.setHours(0,0,0,0);const V=new Date;return V.setHours(0,0,0,0),P>=V}catch{return!1}})();if(K&&ce){v("Daily pass not allowed: member has active membership"),f(!1);return}if(K&&!Y&&!R){v("Daily pass only available 3pm-10pm (Manila time)"),f(!1);return}if(Y&&!O){v("Off-peak pass only available 6am-3pm (Manila time)"),f(!1);return}const L=(()=>{try{if(!s)return!1;const P=new Date(s);P.setHours(0,0,0,0);const V=new Date;return V.setHours(0,0,0,0),P>=V}catch{return!1}})();if(T.coach&&L){v("Coach session not allowed: member has active coach subscription"),f(!1);return}const G=Tu(),z=i?Qs(i):"",$=s?Qs(s):"",W=T.gym?z&&z>=G?Ks(z,1):b.StartDate||G:null,ee=T.coach?$&&$>=G?Ks($,1):b.StartDate||G:null,Z=W&&I?Co(W,I):"",ie=ee&&I?Co(ee,I):"";await uO({MemberID:n,Particulars:b.Particulars,StartDate:b.StartDate||"",EndDate:b.EndDate||"",GymValidUntil:Z,CoachValidUntil:ie,Mode:b.Mode,Cost:String(b.Cost).trim(),Date:Tu(),Time:hO()}),r&&r(),e&&e()}catch(_){const I=(_==null?void 0:_.message)||"Failed to add payment";v(I);try{en.emit("modal:error",{message:I,source:"PaymentModal",error:String(_)})}catch{}}finally{f(!1)}};return t?c.jsx(ts,{open:t,onClose:e,title:"Add Payment",width:560,noInternalScroll:!0,children:c.jsxs("form",{onSubmit:j,style:{width:"100%"},children:[D&&c.jsx("div",{className:"small-error",style:{marginBottom:8},children:D}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10,marginBottom:10},children:[c.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[c.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:4},children:"Gym Membership - Valid until"}),c.jsx("div",{style:{fontWeight:700},children:i?Iu(i):"-"})]}),c.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[c.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:4},children:"Coach Subscription - Valid until"}),c.jsx("div",{style:{fontWeight:700},children:s?Iu(s):"-"})]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[c.jsxs("label",{className:"field",style:{gridColumn:"1 / span 2"},children:[c.jsx("span",{className:"label",children:"Particulars"}),c.jsxs("select",{value:b.Particulars,onChange:S=>x(S.target.value),required:!0,children:[c.jsx("option",{value:"",children:"Choose product/service"}),E.gymOnly.length>0&&c.jsx("optgroup",{label:"Gym membership only",children:E.gymOnly.map((S,_)=>c.jsx("option",{value:S.Particulars,children:S.Particulars},`gym-${S.Particulars}-${_}`))}),E.coachOnly.length>0&&c.jsx("optgroup",{label:"Coach subscription only",children:E.coachOnly.map((S,_)=>c.jsx("option",{value:S.Particulars,children:S.Particulars},`coach-${S.Particulars}-${_}`))}),E.bundle.length>0&&c.jsx("optgroup",{label:"Gym & Coach bundle",children:E.bundle.map((S,_)=>c.jsx("option",{value:S.Particulars,children:S.Particulars},`bundle-${S.Particulars}-${_}`))}),E.merch.length>0&&c.jsx("optgroup",{label:"Merchandise",children:E.merch.map((S,_)=>c.jsx("option",{value:S.Particulars,children:S.Particulars},`merch-${S.Particulars}-${_}`))})]}),b.Particulars&&(()=>{const S=(F||[]).find(z=>String(z.Particulars)===String(b.Particulars)),_=_o(S),I=S?Number(S.Validity||0):0;if(!I)return null;const T=Tu(),te=i?Qs(i):"",K=s?Qs(s):"",Y=_.gym?te&&te>=T?Ks(te,1):b.StartDate||T:null,ce=_.coach?K&&K>=T?Ks(K,1):b.StartDate||T:null,L=Y?Co(Y,I):null,G=ce?Co(ce,I):null;return!L&&!G?null:c.jsxs("div",{style:{background:"#fde8ef",border:"1px solid #ffd7e3",color:"#8b1a3b",marginTop:8,padding:8,borderRadius:8,fontSize:13,lineHeight:1.35},children:[L&&c.jsxs("div",{children:["New Gym valid until: ",c.jsx("b",{children:Iu(L)})]}),G&&c.jsxs("div",{children:["New Coach valid until: ",c.jsx("b",{children:Iu(G)})]})]})})()]}),c.jsxs("label",{className:"field",children:[c.jsx("span",{className:"label",children:"Mode of Payment"}),c.jsxs("select",{value:b.Mode,onChange:S=>N(_=>({..._,Mode:S.target.value})),required:!0,children:[c.jsx("option",{value:"",children:"Select mode"}),c.jsx("option",{value:"Cash",children:"Cash"}),c.jsx("option",{value:"GCash",children:"GCash"})]})]}),c.jsxs("label",{className:"field",children:[c.jsx("span",{className:"label",children:"Cost"}),c.jsx("input",{type:"number",step:"0.01",min:"0",value:b.Cost,readOnly:!0,disabled:!0}),b.PromoApplied&&c.jsx("div",{style:{marginTop:6,fontSize:12,color:"#065f46"},children:"Promo applied  this item will be free (12 uses in last 30 days)"})]})]}),c.jsx("div",{style:{marginTop:8,color:"var(--muted)",fontSize:12},children:"Validity is applied inclusive of the Start Date."}),c.jsxs("div",{style:{marginTop:12,display:"flex",gap:10,justifyContent:"flex-end"},children:[c.jsx("button",{type:"button",className:"back-btn",onClick:e,style:{background:"#e5e7eb",color:"#111",fontWeight:700},children:"Cancel"}),c.jsx("button",{type:"submit",className:"primary-btn",disabled:h,children:"+ Add Payment"})]})]})}):null}function mO({open:t,onClose:e,onCapture:n,waitForAck:r=!1}){const i=k.useRef(null),s=k.useRef(null),a=k.useRef(!1),[u,o]=k.useState([]),[d,h]=k.useState(""),[f,p]=k.useState(""),[g,b]=k.useState(!1),N=()=>{s.current&&(s.current.getTracks().forEach(S=>S.stop()),s.current=null)},D=async(S="")=>{if(!a.current){a.current=!0,b(!0),p(""),N();try{const _=S?{video:{deviceId:{exact:S},width:{ideal:1280},height:{ideal:720}},audio:!1}:{video:{facingMode:{ideal:"environment"},width:{ideal:1280},height:{ideal:720}},audio:!1};let I;try{I=await navigator.mediaDevices.getUserMedia(_)}catch(T){try{const te=S?{video:{deviceId:{ideal:S}},audio:!1}:{video:!0,audio:!1};I=await navigator.mediaDevices.getUserMedia(te)}catch(te){const K=te||T,Y=K&&K.name?String(K.name):"";p(Y==="NotAllowedError"?"Camera permission denied. Please allow camera access in the browser site settings and macOS Privacy > Camera.":Y==="NotReadableError"?"Camera is busy or not readable. Close other apps using the camera (e.g., Zoom/Meet/FaceTime) and try again.":Y==="OverconstrainedError"||Y==="ConstraintNotSatisfiedError"?"Selected camera doesn't meet constraints. Try choosing a different camera.":Y==="NotFoundError"?"No camera found. Plug in a camera or check system permissions.":"Cannot access camera. Check site permissions and OS privacy settings.");return}}if(s.current=I,i.current){i.current.srcObject=I;try{await i.current.play()}catch{}}try{await v()}catch{}}catch{p("Cannot access camera. Check site permissions and OS privacy settings.")}finally{a.current=!1,b(!1)}}},v=async()=>{try{const S=(await navigator.mediaDevices.enumerateDevices()).filter(_=>_.kind==="videoinput");o(S),!d&&S[0]&&h(S[0].deviceId)}catch{}};k.useEffect(()=>{var S,_;if(!t){N();return}return(async()=>(p(""),await D(d||"")))(),(_=(S=navigator.mediaDevices)==null?void 0:S.addEventListener)==null||_.call(S,"devicechange",v),()=>{var I,T;(T=(I=navigator.mediaDevices)==null?void 0:I.removeEventListener)==null||T.call(I,"devicechange",v),N()}},[t]),k.useEffect(()=>{var S,_,I,T;if(!(!t||!d)){try{const te=((T=(I=(_=(S=s.current)==null?void 0:S.getVideoTracks)==null?void 0:_.call(S)[0])==null?void 0:I.getSettings)==null?void 0:T.call(I).deviceId)||"";if(te&&te===d)return}catch{}D(d)}},[d]);const w=async()=>{if(!i.current)return;const S=i.current,_=document.createElement("canvas"),I=S.videoWidth||1280,T=S.videoHeight||720,te=800,K=I>te?te/I:1,Y=Math.max(320,Math.round(I*K)),ce=Math.max(240,Math.round(T*K));_.width=Y,_.height=ce,_.getContext("2d").drawImage(S,0,0,Y,ce);const L=_.toDataURL("image/jpeg",.65);try{const G=n==null?void 0:n(L);if(r&&G&&typeof G.then=="function"){F(!0);try{await Promise.resolve(G)}catch(z){p(z&&z.message?z.message:String(z||"Failed to process photo"))}}else try{G&&typeof G.then=="function"&&G.catch(z=>{try{p(String((z==null?void 0:z.message)||z))}catch{}})}catch{}}catch(G){p(G&&G.message?G.message:String(G||"Failed to process photo"))}finally{try{F(!1)}catch{}N(),e==null||e()}},[C,O]=k.useState(null),[R,F]=k.useState(!1),E=async()=>{if(!C)return;p("");const S=n==null?void 0:n(C);if(r&&S&&typeof S.then=="function"){F(!0);try{await Promise.resolve(S)}catch(_){const I=_&&_.message?_.message:String(_||"Failed to process photo");p(I)}finally{F(!1),O(null),e==null||e()}return}try{S&&typeof S.then=="function"&&S.catch(_=>{try{p(String((_==null?void 0:_.message)||_))}catch{}})}catch{}O(null),e==null||e()},x=()=>{O(null),D(d||"")};if(!t)return null;const j=c.jsxs(ts,{open:t,onClose:e,width:720,noWrapper:!0,children:[c.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[c.jsx("label",{style:{fontWeight:600,fontSize:14},children:"Camera:"}),c.jsxs("select",{value:d,onChange:S=>h(S.target.value),style:{flex:1,padding:"8px 10px",borderRadius:8,border:"1px solid #e7e8ef"},children:[u.length===0&&c.jsx("option",{value:"",children:"(No camera found)"}),u.map(S=>c.jsx("option",{value:S.deviceId,children:S.label||"Camera"},S.deviceId))]})]}),!f&&!s.current&&c.jsx("div",{style:{color:"#666",marginBottom:8},children:"Initializing camera please allow the browser prompt."}),f?c.jsx("div",{style:{color:"#d33",marginBottom:12},children:f}):c.jsx("div",{style:{width:"100%"},children:C?c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[c.jsx("img",{src:C,alt:"preview",style:{width:"100%",borderRadius:10}}),c.jsx("div",{style:{color:"#666",fontSize:13},children:"Preview  accept to use this photo or retake."})]}):c.jsx("video",{ref:i,playsInline:!0,muted:!0,style:{width:"100%",borderRadius:10,background:"#000"}})}),c.jsx("div",{style:{display:"flex",gap:10,marginTop:12,justifyContent:"flex-end"},children:C?c.jsxs(c.Fragment,{children:[c.jsx("button",{type:"button",className:"button",onClick:x,disabled:R,children:"Retake"}),c.jsx("button",{type:"button",className:"button btn-lg",onClick:E,disabled:R,children:R?"Processing":"Use Photo"})]}):c.jsx(c.Fragment,{children:c.jsx("button",{type:"button",className:"button btn-lg",onClick:w,disabled:!!f||!s.current,children:"Capture"})})})]});return l1.createPortal(j,document.body)}const pO=["Isabel","Merida","Palompon","Ormoc","Matag-ob"],gO={Isabel:["Anislag","Antipolo","Apale","Bantigue","Binog","Bilwang","Can-andan","Cangag","Consolacion","Honan","Libertad","Mahayag","Marvel (Poblacion)","Matlang","Monte Alegre","Puting Bato","San Francisco","San Roque","Santa Cruz Relocation","Santo Nio (Poblacion)","Santo Rosario","Tabunok","Tolingon","Tubod"],Merida:["Benabaye","Cabaliwan","Calunangan","Calunasan","Cambalong","Can-unzo","Canbantug","Casilda","Lamanoc","Libas","Libjo","Lundag","Macario","Mahalit","Mahayag","Masumbang","Mat-e","Poblacion","Puerto Bello","San Isidro","San Jose","Tubod"],Palompon:["Baguinbin","Belen","Buenavista","Caduhaan","Cambakbak","Cambinoy","Cangcosme","Cangmuya","Canipaan","Cantandoy","Cantuhaon","Catigahan","Central 1 (Poblacion)","Central 2 (Poblacion)","Cruz","Duljugan","Guiwan 1 (Poblacion)","Guiwan 2 (Poblacion)","Himarco","Hinablayan (Poblacion)","Hinagbuan","Lat-osan","Liberty","Lomonon","Mabini","Magsaysay","Masaba","Mazawalo (Poblacion)","Parilla","Pinagdait (Poblacion Ypil I)","Pinaghi-usa (Poblacion Ypil II)","Plaridel","Rizal","Sabang","San Guillermo","San Isidro","San Joaquin","San Juan","San Miguel","San Pablo","San Pedro","San Roque","Santiago","Taberna","Tabunok","Tambis","Tinabilan","Tinago","Tinubdan","Bitaog (Poblacion Ypil III)"],Ormoc:["Airport","Alegria","Alta Vista","Bagongbong","Bagong Buhay","Bantigue","Batuan","Bayog","Biliboy","Borok","Cabaon-an","Cabintan","Cabulihan","Cagbuhangin","Camp Downes","Can-adieng","Can-untog","Catmon","Cogon Combado","Concepcion","Curva","Danhug","Dayhagan","Dolores","Domonar","Don Felipe Larrazabal","Don Potenciano Larrazabal","Doa Feliza Z. Mejia","Donghol","Esperanza","Gaas","Green Valley","Guintigui-an","Hibunawon","Hugpa","Ipil","Juaton","Kadaohan","Labrador (Balion)","Lao","Leondoni","Libertad","Liberty","Licuma","Liloan","Linao","Luna","Mabato","Mabini","Macabug","Magaswi","Mahayag","Mahayahay","Manlilinao","Margen","Mas-in","Matica-a","Milagro","Monterico","Nasunogan","Naungan","Nueva Sociedad","Nueva Vista","Patag","Punta","Quezon Jr.","Rufina M. Tan (Rawis)","Sabang Bao","Salvacion","San Antonio","San Isidro","San Jose","San Juan","San Pablo (Simangan)","San Vicente","Santo Nio","Sumangga","Tambulilid","Tongonan","Valencia","East (Poblacion)","West (Poblacion)","North (Poblacion)","South (Poblacion)"],"Matag-ob":["Balagtas","Bonoy","Bulak","Cambadbad","Candelaria","Cansoso","Imelda","Malazarte","Mansaha-on","Mansalip","Masaba","Naulayan","Riverside (Poblacion)","San Dionesio","San Guillermo (Poblacion)","San Marcelino","San Sebastian","San Vicente","Santa Rosa","Santo Rosario","Talisay (Poblacion)"]};function yO(t){return gO[t]||[]}const{updateMember:vO,uploadMemberPhoto:p0,fetchMemberById:bO,fetchMemberByIdFresh:wO}=Ae,SO=t=>{const e={};return Object.entries(t||{}).forEach(([n,r])=>e[String(n).toLowerCase()]=r),e},tt=(t,...e)=>{if(!t)return"";for(const n of e){if(t[n]!==void 0&&t[n]!==null&&t[n]!=="")return t[n];const r=String(n).toLowerCase(),i=SO(t);if(i[r]!==void 0&&i[r]!=="")return i[r];const s=r.replace(/\s+/g,"");if(i[s]!==void 0&&i[s]!=="")return i[s];const a=r.replace(/\s+/g,"_");if(i[a]!==void 0&&i[a]!=="")return i[a]}return""};function xO(t,e=`photo-${Date.now()}.jpg`){const n=t.split(","),r=n[0].match(/:(.*?);/)[1]||"image/jpeg",i=atob(n[1]);let s=i.length;const a=new Uint8Array(s);for(;s--;)a[s]=i.charCodeAt(s);return new File([a],e,{type:r})}function CO({open:t,onClose:e,member:n,onSaved:r}){const[i,s]=k.useState({lastName:"",firstName:"",middleName:"",nickName:"",gender:"",birthday:"",street:"",brgy:"",municipality:"",email:"",mobile:"",validId:"",student:!1}),[a,u]=k.useState(""),[o,d]=k.useState(""),[h,f]=k.useState(""),[p,g]=k.useState(null),b=k.useRef(null),[N,D]=k.useState(!1),[v,w]=k.useState(""),[C,O]=k.useState(!1),[R,F]=k.useState(""),E=k.useRef(!1),x=yO(i.municipality),j=K=>{const Y=String(K||"").match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return Y&&Y[1]?Y[1]:""},S=K=>{const Y=String(K||"");if(!Y)return"";const ce=Y.match(/https?:\/\/[^\s}]+/);if(ce){const G=ce[0];if(/googleusercontent\.com\//.test(G))return G;const z=G.match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return z&&z[1]?`https://drive.google.com/uc?export=view&id=${z[1]}`:G}if(/googleusercontent\.com\//.test(Y))return Y;const L=j(Y);return L?`https://drive.google.com/uc?export=view&id=${L}`:Y},_=K=>{const Y=String(K||"");if(/googleusercontent\.com\//.test(Y))return Y;const ce=j(Y);return ce?`https://drive.google.com/thumbnail?id=${ce}&sz=w1000`:Y};k.useEffect(()=>{let K=!1;if(!t){E.current=!1;return}if(E.current)return;const Y=n||{},ce=String(tt(Y,"MemberID","memberId","member_id","id")||"").trim();return u(ce),(async()=>{try{if(ce){const L=await bO(String(ce).trim());if(!K&&L){const G=tt(L,"LastName","lastName","last_name","Last"),z=tt(L,"FirstName","firstName","first_name","First"),$=tt(L,"MiddleName","middleName","middle_name"),W=tt(L,"NickName","nickname","nick_name","Nick Name"),ee=tt(L,"Gender","gender"),Z=tt(L,"Birthday","birth_date","dob","Birth Date"),ie=tt(L,"Street","street"),P=tt(L,"Brgy","Barangay","brgy","barangay"),V=tt(L,"Municipality","City","municipality","city"),U=tt(L,"Email","email"),q=tt(L,"Mobile","Phone","mobile","phone"),se=tt(L,"ValidID","Valid Id","Valid ID","validId","valid_id"),me=String(tt(L,"Student","student")||"").toLowerCase().startsWith("y"),ae=tt(L,"PhotoURL","photoUrl","photo_url","photo"),M=ae?_(S(ae)):"";d(ae||""),f(M),g(null),w("");const X=String(P||"");s({lastName:String(G||""),firstName:String(z||""),middleName:String($||""),nickName:String(W||""),gender:String(ee||""),birthday:Z?new Date(Z).toISOString().slice(0,10):"",street:String(ie||""),brgy:X,municipality:String(V||""),email:String(U||""),mobile:String(q||""),validId:String(se||""),student:me}),E.current=!0;return}}}catch{}if(!K){const L=tt(Y,"LastName","lastName","last_name","Last"),G=tt(Y,"FirstName","firstName","first_name","First"),z=tt(Y,"MiddleName","middleName","middle_name"),$=tt(Y,"NickName","nickname","nick_name","Nick Name"),W=tt(Y,"Gender","gender"),ee=tt(Y,"Birthday","birth_date","dob","Birth Date"),Z=tt(Y,"Street","street"),ie=tt(Y,"Brgy","Barangay","brgy","barangay"),P=tt(Y,"Municipality","City","municipality","city"),V=tt(Y,"Email","email"),U=tt(Y,"Mobile","Phone","mobile","phone"),q=tt(Y,"ValidID","Valid Id","Valid ID","validId","valid_id"),se=String(tt(Y,"Student","student")||"").toLowerCase().startsWith("y"),me=tt(Y,"PhotoURL","photoUrl","photo_url","photo"),ae=me?_(S(me)):"";d(me||""),f(ae),g(null),w("");const M=String(ie||"");s({lastName:String(L||""),firstName:String(G||""),middleName:String(z||""),nickName:String($||""),gender:String(W||""),birthday:ee?new Date(ee).toISOString().slice(0,10):"",street:String(Z||""),brgy:M,municipality:String(P||""),email:String(V||""),mobile:String(U||""),validId:String(q||""),student:se}),E.current=!0}})(),()=>{K=!0}},[t,n]);const I=K=>{const{name:Y,value:ce,type:L,checked:G}=K.target;if(Y==="student-select"){s(z=>({...z,student:String(ce)==="Yes"}));return}if(Y==="municipality"){s(z=>({...z,municipality:ce,brgy:""}));return}s(z=>({...z,[Y]:L==="checkbox"?G:ce}))},T=K=>{try{const Y=xO(K);b.current&&(URL.revokeObjectURL(b.current),b.current=null);const ce=URL.createObjectURL(Y);if(b.current=ce,g(Y),f(ce),a){const L=String(a).trim().toLowerCase(),G=(async()=>{try{const z=await p0(Y,L),$=typeof z=="string"?z:(z==null?void 0:z.url)||"";d($||o);const W=$?_(S($)):ce;return f(W),g(null),$}catch(z){try{w(String(z||"Photo upload failed"))}catch{}return null}})();return Promise.resolve(G).catch(()=>null)}}catch(Y){try{w(String(Y||"Failed to handle capture"))}catch{}return Promise.resolve(null)}return Promise.resolve(null)};k.useEffect(()=>()=>{b.current&&(URL.revokeObjectURL(b.current),b.current=null)},[]);const te=async K=>{var Y;try{(Y=K==null?void 0:K.preventDefault)==null||Y.call(K)}catch{}if(!a){w("Missing MemberID");return}try{console.debug("[EditMemberModal] save() starting for",a)}catch{}const ce={MemberID:a,LastName:i.lastName.trim(),FirstName:i.firstName.trim(),MiddleName:i.middleName.trim(),NickName:String(i.nickName||"").trim().toUpperCase(),Gender:i.gender,Birthday:i.birthday||"",Street:i.street.trim(),Brgy:i.brgy.trim(),Municipality:i.municipality.trim(),Email:i.email.trim(),Mobile:i.mobile.trim(),ValidID:i.validId.trim(),Student:i.student?"Yes":"No",PhotoURL:h||o||""};try{console.debug("[EditMemberModal] optimisticPayload",ce)}catch{}D(!0),w("");try{let L=o||"";if(p)try{const $=p0(p,String(a).toLowerCase()),W=await Promise.race([$,new Promise((ee,Z)=>setTimeout(()=>Z(new Error("photo upload timeout")),15e3))]);try{console.debug("[EditMemberModal] uploadMemberPhoto result",W)}catch{}L=typeof W=="string"?W:(W==null?void 0:W.url)||L,g(null)}catch($){try{console.debug("[EditMemberModal] uploadMemberPhoto failed",String($))}catch{}w(String($)||"Photo upload failed  saving without photo change")}const G={...ce,PhotoURL:L};let z=null;try{try{console.debug("[EditMemberModal] sending update payload",G)}catch{}const $=vO(G),W=await Promise.race([$,new Promise((ee,Z)=>setTimeout(()=>Z(new Error("update timeout")),2e4))]);try{console.debug("[EditMemberModal] updateMember response",W)}catch{}W&&typeof W=="object"&&(W.row&&typeof W.row=="object"?z=W.row:W.updated&&typeof W.updated=="object"?z=W.updated:W.data&&typeof W.data=="object"?z=W.data:["MemberID","memberid","LastName","FirstName"].some(ee=>Object.prototype.hasOwnProperty.call(W,ee))&&(z=W));try{console.debug("[EditMemberModal] authoritative after response",z)}catch{}}catch($){try{console.debug("[EditMemberModal] updateMember error",String($))}catch{}w(String($)||"Failed to update member"),en.emit("modal:error",{message:"Failed to update member",source:"EditMemberModal",error:String($)})}if(!z)try{try{console.debug("[EditMemberModal] fetching fresh member by id",String(a).trim())}catch{}const $=wO(String(a).trim()),W=await Promise.race([$,new Promise((ee,Z)=>setTimeout(()=>Z(new Error("fetch member timeout")),15e3))]);try{console.debug("[EditMemberModal] fetchMemberByIdFresh result",W)}catch{}W&&(z=W)}catch($){try{console.debug("[EditMemberModal] fetchMemberByIdFresh failed",String($))}catch{}}z||(z=G);try{console.debug("[EditMemberModal] final authoritative row passed to parent",z)}catch{}try{r==null||r(z)}catch{}try{e==null||e()}catch{}}catch(L){en.emit("modal:error",{message:"Background member update failed",source:"EditMemberModal",error:String(L)}),w(String(L)||"Background member update failed")}finally{D(!1)}};return t?c.jsx(ts,{open:t,onClose:e,title:i.nickName||"Edit Member",width:1e3,noInternalScroll:!0,children:c.jsxs("form",{onSubmit:te,style:{width:"100%",padding:0,background:"transparent",border:"none",boxShadow:"none",overflow:"visible"},children:[R&&c.jsx("div",{style:{position:"fixed",top:20,right:20,background:"#16a34a",color:"#fff",padding:"8px 12px",borderRadius:10,boxShadow:"0 6px 16px rgba(0,0,0,.15)",zIndex:1e4},children:R}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"240px 1fr",gap:16},children:[c.jsxs("div",{children:[c.jsx("div",{style:{width:240,height:240,border:"1px solid var(--light-border)",borderRadius:12,background:"#fafbff",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center"},children:h?c.jsx("img",{src:h,alt:"preview",style:{width:"100%",height:"100%",objectFit:"cover"}}):c.jsx("div",{style:{color:"var(--muted)"},children:"No photo"})}),c.jsx("div",{style:{display:"flex",gap:8,marginTop:10},children:c.jsx("button",{type:"button",className:"button",onClick:()=>O(!0),disabled:!0,title:"Camera disabled in this build",style:{flex:"1 1 auto",cursor:"not-allowed",opacity:.6},children:" Change Photo"})})]}),c.jsxs("div",{style:{display:"grid",gap:12},children:[c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 160px",gap:12,alignItems:"end"},children:[c.jsxs("label",{className:"field",style:{margin:0},children:[c.jsx("span",{className:"label",children:"Valid ID *"}),c.jsx("input",{name:"validId",value:i.validId,onChange:I,required:!0})]}),c.jsxs("label",{className:"field",style:{margin:0},children:[c.jsx("span",{className:"label",children:"Student"}),c.jsxs("select",{name:"student-select",value:i.student?"Yes":"No",onChange:I,children:[c.jsx("option",{children:"Yes"}),c.jsx("option",{children:"No"})]})]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12},children:[c.jsxs("label",{className:"field",children:[c.jsx("span",{className:"label",children:"Last Name *"}),c.jsx("input",{name:"lastName",value:i.lastName,onChange:I,required:!0})]}),c.jsxs("label",{className:"field",children:[c.jsx("span",{className:"label",children:"First Name *"}),c.jsx("input",{name:"firstName",value:i.firstName,onChange:I,required:!0})]}),c.jsxs("label",{className:"field",children:[c.jsx("span",{className:"label",children:"Middle Name"}),c.jsx("input",{name:"middleName",value:i.middleName,onChange:I})]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[c.jsxs("label",{className:"field",children:[c.jsx("span",{className:"label",children:"Birthday *"}),c.jsx("input",{type:"date",name:"birthday",value:i.birthday,onChange:I,required:!0})]}),c.jsxs("label",{className:"field",children:[c.jsx("span",{className:"label",children:"Gender *"}),c.jsxs("select",{name:"gender",value:i.gender,onChange:I,required:!0,children:[c.jsx("option",{value:"",children:" Select "}),c.jsx("option",{children:"Male"}),c.jsx("option",{children:"Female"})]})]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[c.jsxs("label",{className:"field",children:[c.jsx("span",{className:"label",children:"Mobile No. *"}),c.jsx("input",{name:"mobile",value:i.mobile,onChange:I,placeholder:"09XXXXXXXXX",required:!0})]}),c.jsxs("label",{className:"field",children:[c.jsx("span",{className:"label",children:"Email Address"}),c.jsx("input",{name:"email",value:i.email,onChange:I,placeholder:"name@example.com"})]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 2fr",gap:12},children:[c.jsxs("label",{className:"field",children:[c.jsx("span",{className:"label",children:"Municipality / City"}),c.jsxs("select",{name:"municipality",value:i.municipality,onChange:I,children:[c.jsx("option",{value:""}),pO.map(K=>c.jsx("option",{value:K,children:K},K))]})]}),c.jsxs("label",{className:"field",children:[c.jsx("span",{className:"label",children:"Brgy."}),c.jsxs("select",{name:"brgy",value:i.brgy,onChange:I,disabled:!i.municipality,children:[c.jsx("option",{value:""}),x.map(K=>c.jsx("option",{value:K,children:K},K))]})]}),c.jsxs("label",{className:"field",children:[c.jsx("span",{className:"label",children:"House No. / Street Name / Sitio"}),c.jsx("input",{name:"street",value:i.street,onChange:I})]})]}),v&&c.jsx("div",{style:{color:"#d33",fontSize:15,marginTop:8,fontWeight:600},children:v})]})]}),c.jsxs("div",{style:{marginTop:12,display:"flex",gap:10,justifyContent:"flex-end"},children:[c.jsx("button",{type:"button",className:"back-btn",onClick:e,style:{background:"#e5e7eb",color:"#111",fontWeight:700},children:"Cancel"}),c.jsx("button",{type:"button",className:"primary-btn",disabled:N,onClick:te,children:" Save Changes"})]}),c.jsx(mO,{open:C,onClose:()=>O(!1),onCapture:T})]})}):null}var _O=Object.defineProperty,Xc=Object.getOwnPropertySymbols,S_=Object.prototype.hasOwnProperty,x_=Object.prototype.propertyIsEnumerable,g0=(t,e,n)=>e in t?_O(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Tm=(t,e)=>{for(var n in e||(e={}))S_.call(e,n)&&g0(t,n,e[n]);if(Xc)for(var n of Xc(e))x_.call(e,n)&&g0(t,n,e[n]);return t},Im=(t,e)=>{var n={};for(var r in t)S_.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&Xc)for(var r of Xc(t))e.indexOf(r)<0&&x_.call(t,r)&&(n[r]=t[r]);return n};/**
* @license QR Code generator library (TypeScript)
* Copyright (c) Project Nayuki.
* SPDX-License-Identifier: MIT
*/var Ps;(t=>{const e=class Oe{constructor(o,d,h,f){if(this.version=o,this.errorCorrectionLevel=d,this.modules=[],this.isFunction=[],o<Oe.MIN_VERSION||o>Oe.MAX_VERSION)throw new RangeError("Version value out of range");if(f<-1||f>7)throw new RangeError("Mask value out of range");this.size=o*4+17;let p=[];for(let b=0;b<this.size;b++)p.push(!1);for(let b=0;b<this.size;b++)this.modules.push(p.slice()),this.isFunction.push(p.slice());this.drawFunctionPatterns();const g=this.addEccAndInterleave(h);if(this.drawCodewords(g),f==-1){let b=1e9;for(let N=0;N<8;N++){this.applyMask(N),this.drawFormatBits(N);const D=this.getPenaltyScore();D<b&&(f=N,b=D),this.applyMask(N)}}i(0<=f&&f<=7),this.mask=f,this.applyMask(f),this.drawFormatBits(f),this.isFunction=[]}static encodeText(o,d){const h=t.QrSegment.makeSegments(o);return Oe.encodeSegments(h,d)}static encodeBinary(o,d){const h=t.QrSegment.makeBytes(o);return Oe.encodeSegments([h],d)}static encodeSegments(o,d,h=1,f=40,p=-1,g=!0){if(!(Oe.MIN_VERSION<=h&&h<=f&&f<=Oe.MAX_VERSION)||p<-1||p>7)throw new RangeError("Invalid value");let b,N;for(b=h;;b++){const C=Oe.getNumDataCodewords(b,d)*8,O=a.getTotalBits(o,b);if(O<=C){N=O;break}if(b>=f)throw new RangeError("Data too long")}for(const C of[Oe.Ecc.MEDIUM,Oe.Ecc.QUARTILE,Oe.Ecc.HIGH])g&&N<=Oe.getNumDataCodewords(b,C)*8&&(d=C);let D=[];for(const C of o){n(C.mode.modeBits,4,D),n(C.numChars,C.mode.numCharCountBits(b),D);for(const O of C.getData())D.push(O)}i(D.length==N);const v=Oe.getNumDataCodewords(b,d)*8;i(D.length<=v),n(0,Math.min(4,v-D.length),D),n(0,(8-D.length%8)%8,D),i(D.length%8==0);for(let C=236;D.length<v;C^=253)n(C,8,D);let w=[];for(;w.length*8<D.length;)w.push(0);return D.forEach((C,O)=>w[O>>>3]|=C<<7-(O&7)),new Oe(b,d,w,p)}getModule(o,d){return 0<=o&&o<this.size&&0<=d&&d<this.size&&this.modules[d][o]}getModules(){return this.modules}drawFunctionPatterns(){for(let h=0;h<this.size;h++)this.setFunctionModule(6,h,h%2==0),this.setFunctionModule(h,6,h%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const o=this.getAlignmentPatternPositions(),d=o.length;for(let h=0;h<d;h++)for(let f=0;f<d;f++)h==0&&f==0||h==0&&f==d-1||h==d-1&&f==0||this.drawAlignmentPattern(o[h],o[f]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(o){const d=this.errorCorrectionLevel.formatBits<<3|o;let h=d;for(let p=0;p<10;p++)h=h<<1^(h>>>9)*1335;const f=(d<<10|h)^21522;i(f>>>15==0);for(let p=0;p<=5;p++)this.setFunctionModule(8,p,r(f,p));this.setFunctionModule(8,7,r(f,6)),this.setFunctionModule(8,8,r(f,7)),this.setFunctionModule(7,8,r(f,8));for(let p=9;p<15;p++)this.setFunctionModule(14-p,8,r(f,p));for(let p=0;p<8;p++)this.setFunctionModule(this.size-1-p,8,r(f,p));for(let p=8;p<15;p++)this.setFunctionModule(8,this.size-15+p,r(f,p));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let o=this.version;for(let h=0;h<12;h++)o=o<<1^(o>>>11)*7973;const d=this.version<<12|o;i(d>>>18==0);for(let h=0;h<18;h++){const f=r(d,h),p=this.size-11+h%3,g=Math.floor(h/3);this.setFunctionModule(p,g,f),this.setFunctionModule(g,p,f)}}drawFinderPattern(o,d){for(let h=-4;h<=4;h++)for(let f=-4;f<=4;f++){const p=Math.max(Math.abs(f),Math.abs(h)),g=o+f,b=d+h;0<=g&&g<this.size&&0<=b&&b<this.size&&this.setFunctionModule(g,b,p!=2&&p!=4)}}drawAlignmentPattern(o,d){for(let h=-2;h<=2;h++)for(let f=-2;f<=2;f++)this.setFunctionModule(o+f,d+h,Math.max(Math.abs(f),Math.abs(h))!=1)}setFunctionModule(o,d,h){this.modules[d][o]=h,this.isFunction[d][o]=!0}addEccAndInterleave(o){const d=this.version,h=this.errorCorrectionLevel;if(o.length!=Oe.getNumDataCodewords(d,h))throw new RangeError("Invalid argument");const f=Oe.NUM_ERROR_CORRECTION_BLOCKS[h.ordinal][d],p=Oe.ECC_CODEWORDS_PER_BLOCK[h.ordinal][d],g=Math.floor(Oe.getNumRawDataModules(d)/8),b=f-g%f,N=Math.floor(g/f);let D=[];const v=Oe.reedSolomonComputeDivisor(p);for(let C=0,O=0;C<f;C++){let R=o.slice(O,O+N-p+(C<b?0:1));O+=R.length;const F=Oe.reedSolomonComputeRemainder(R,v);C<b&&R.push(0),D.push(R.concat(F))}let w=[];for(let C=0;C<D[0].length;C++)D.forEach((O,R)=>{(C!=N-p||R>=b)&&w.push(O[C])});return i(w.length==g),w}drawCodewords(o){if(o.length!=Math.floor(Oe.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let d=0;for(let h=this.size-1;h>=1;h-=2){h==6&&(h=5);for(let f=0;f<this.size;f++)for(let p=0;p<2;p++){const g=h-p,b=h+1&2?f:this.size-1-f;!this.isFunction[b][g]&&d<o.length*8&&(this.modules[b][g]=r(o[d>>>3],7-(d&7)),d++)}}i(d==o.length*8)}applyMask(o){if(o<0||o>7)throw new RangeError("Mask value out of range");for(let d=0;d<this.size;d++)for(let h=0;h<this.size;h++){let f;switch(o){case 0:f=(h+d)%2==0;break;case 1:f=d%2==0;break;case 2:f=h%3==0;break;case 3:f=(h+d)%3==0;break;case 4:f=(Math.floor(h/3)+Math.floor(d/2))%2==0;break;case 5:f=h*d%2+h*d%3==0;break;case 6:f=(h*d%2+h*d%3)%2==0;break;case 7:f=((h+d)%2+h*d%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[d][h]&&f&&(this.modules[d][h]=!this.modules[d][h])}}getPenaltyScore(){let o=0;for(let p=0;p<this.size;p++){let g=!1,b=0,N=[0,0,0,0,0,0,0];for(let D=0;D<this.size;D++)this.modules[p][D]==g?(b++,b==5?o+=Oe.PENALTY_N1:b>5&&o++):(this.finderPenaltyAddHistory(b,N),g||(o+=this.finderPenaltyCountPatterns(N)*Oe.PENALTY_N3),g=this.modules[p][D],b=1);o+=this.finderPenaltyTerminateAndCount(g,b,N)*Oe.PENALTY_N3}for(let p=0;p<this.size;p++){let g=!1,b=0,N=[0,0,0,0,0,0,0];for(let D=0;D<this.size;D++)this.modules[D][p]==g?(b++,b==5?o+=Oe.PENALTY_N1:b>5&&o++):(this.finderPenaltyAddHistory(b,N),g||(o+=this.finderPenaltyCountPatterns(N)*Oe.PENALTY_N3),g=this.modules[D][p],b=1);o+=this.finderPenaltyTerminateAndCount(g,b,N)*Oe.PENALTY_N3}for(let p=0;p<this.size-1;p++)for(let g=0;g<this.size-1;g++){const b=this.modules[p][g];b==this.modules[p][g+1]&&b==this.modules[p+1][g]&&b==this.modules[p+1][g+1]&&(o+=Oe.PENALTY_N2)}let d=0;for(const p of this.modules)d=p.reduce((g,b)=>g+(b?1:0),d);const h=this.size*this.size,f=Math.ceil(Math.abs(d*20-h*10)/h)-1;return i(0<=f&&f<=9),o+=f*Oe.PENALTY_N4,i(0<=o&&o<=2568888),o}getAlignmentPatternPositions(){if(this.version==1)return[];{const o=Math.floor(this.version/7)+2,d=this.version==32?26:Math.ceil((this.version*4+4)/(o*2-2))*2;let h=[6];for(let f=this.size-7;h.length<o;f-=d)h.splice(1,0,f);return h}}static getNumRawDataModules(o){if(o<Oe.MIN_VERSION||o>Oe.MAX_VERSION)throw new RangeError("Version number out of range");let d=(16*o+128)*o+64;if(o>=2){const h=Math.floor(o/7)+2;d-=(25*h-10)*h-55,o>=7&&(d-=36)}return i(208<=d&&d<=29648),d}static getNumDataCodewords(o,d){return Math.floor(Oe.getNumRawDataModules(o)/8)-Oe.ECC_CODEWORDS_PER_BLOCK[d.ordinal][o]*Oe.NUM_ERROR_CORRECTION_BLOCKS[d.ordinal][o]}static reedSolomonComputeDivisor(o){if(o<1||o>255)throw new RangeError("Degree out of range");let d=[];for(let f=0;f<o-1;f++)d.push(0);d.push(1);let h=1;for(let f=0;f<o;f++){for(let p=0;p<d.length;p++)d[p]=Oe.reedSolomonMultiply(d[p],h),p+1<d.length&&(d[p]^=d[p+1]);h=Oe.reedSolomonMultiply(h,2)}return d}static reedSolomonComputeRemainder(o,d){let h=d.map(f=>0);for(const f of o){const p=f^h.shift();h.push(0),d.forEach((g,b)=>h[b]^=Oe.reedSolomonMultiply(g,p))}return h}static reedSolomonMultiply(o,d){if(o>>>8||d>>>8)throw new RangeError("Byte out of range");let h=0;for(let f=7;f>=0;f--)h=h<<1^(h>>>7)*285,h^=(d>>>f&1)*o;return i(h>>>8==0),h}finderPenaltyCountPatterns(o){const d=o[1];i(d<=this.size*3);const h=d>0&&o[2]==d&&o[3]==d*3&&o[4]==d&&o[5]==d;return(h&&o[0]>=d*4&&o[6]>=d?1:0)+(h&&o[6]>=d*4&&o[0]>=d?1:0)}finderPenaltyTerminateAndCount(o,d,h){return o&&(this.finderPenaltyAddHistory(d,h),d=0),d+=this.size,this.finderPenaltyAddHistory(d,h),this.finderPenaltyCountPatterns(h)}finderPenaltyAddHistory(o,d){d[0]==0&&(o+=this.size),d.pop(),d.unshift(o)}};e.MIN_VERSION=1,e.MAX_VERSION=40,e.PENALTY_N1=3,e.PENALTY_N2=3,e.PENALTY_N3=40,e.PENALTY_N4=10,e.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],e.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],t.QrCode=e;function n(u,o,d){if(o<0||o>31||u>>>o)throw new RangeError("Value out of range");for(let h=o-1;h>=0;h--)d.push(u>>>h&1)}function r(u,o){return(u>>>o&1)!=0}function i(u){if(!u)throw new Error("Assertion error")}const s=class Et{constructor(o,d,h){if(this.mode=o,this.numChars=d,this.bitData=h,d<0)throw new RangeError("Invalid argument");this.bitData=h.slice()}static makeBytes(o){let d=[];for(const h of o)n(h,8,d);return new Et(Et.Mode.BYTE,o.length,d)}static makeNumeric(o){if(!Et.isNumeric(o))throw new RangeError("String contains non-numeric characters");let d=[];for(let h=0;h<o.length;){const f=Math.min(o.length-h,3);n(parseInt(o.substring(h,h+f),10),f*3+1,d),h+=f}return new Et(Et.Mode.NUMERIC,o.length,d)}static makeAlphanumeric(o){if(!Et.isAlphanumeric(o))throw new RangeError("String contains unencodable characters in alphanumeric mode");let d=[],h;for(h=0;h+2<=o.length;h+=2){let f=Et.ALPHANUMERIC_CHARSET.indexOf(o.charAt(h))*45;f+=Et.ALPHANUMERIC_CHARSET.indexOf(o.charAt(h+1)),n(f,11,d)}return h<o.length&&n(Et.ALPHANUMERIC_CHARSET.indexOf(o.charAt(h)),6,d),new Et(Et.Mode.ALPHANUMERIC,o.length,d)}static makeSegments(o){return o==""?[]:Et.isNumeric(o)?[Et.makeNumeric(o)]:Et.isAlphanumeric(o)?[Et.makeAlphanumeric(o)]:[Et.makeBytes(Et.toUtf8ByteArray(o))]}static makeEci(o){let d=[];if(o<0)throw new RangeError("ECI assignment value out of range");if(o<128)n(o,8,d);else if(o<16384)n(2,2,d),n(o,14,d);else if(o<1e6)n(6,3,d),n(o,21,d);else throw new RangeError("ECI assignment value out of range");return new Et(Et.Mode.ECI,0,d)}static isNumeric(o){return Et.NUMERIC_REGEX.test(o)}static isAlphanumeric(o){return Et.ALPHANUMERIC_REGEX.test(o)}getData(){return this.bitData.slice()}static getTotalBits(o,d){let h=0;for(const f of o){const p=f.mode.numCharCountBits(d);if(f.numChars>=1<<p)return 1/0;h+=4+p+f.bitData.length}return h}static toUtf8ByteArray(o){o=encodeURI(o);let d=[];for(let h=0;h<o.length;h++)o.charAt(h)!="%"?d.push(o.charCodeAt(h)):(d.push(parseInt(o.substring(h+1,h+3),16)),h+=2);return d}};s.NUMERIC_REGEX=/^[0-9]*$/,s.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,s.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let a=s;t.QrSegment=s})(Ps||(Ps={}));(t=>{(e=>{const n=class{constructor(r,i){this.ordinal=r,this.formatBits=i}};n.LOW=new n(0,1),n.MEDIUM=new n(1,0),n.QUARTILE=new n(2,3),n.HIGH=new n(3,2),e.Ecc=n})(t.QrCode||(t.QrCode={}))})(Ps||(Ps={}));(t=>{(e=>{const n=class{constructor(r,i){this.modeBits=r,this.numBitsCharCount=i}numCharCountBits(r){return this.numBitsCharCount[Math.floor((r+7)/17)]}};n.NUMERIC=new n(1,[10,12,14]),n.ALPHANUMERIC=new n(2,[9,11,13]),n.BYTE=new n(4,[8,16,16]),n.KANJI=new n(8,[8,10,12]),n.ECI=new n(7,[0,0,0]),e.Mode=n})(t.QrSegment||(t.QrSegment={}))})(Ps||(Ps={}));var pa=Ps;/**
* @license qrcode.react
* Copyright (c) Paul O'Shannessy
* SPDX-License-Identifier: ISC
*/var kO={L:pa.QrCode.Ecc.LOW,M:pa.QrCode.Ecc.MEDIUM,Q:pa.QrCode.Ecc.QUARTILE,H:pa.QrCode.Ecc.HIGH},C_=128,__="L",k_="#FFFFFF",E_="#000000",N_=!1,T_=1,EO=4,NO=0,TO=.1;function I_(t,e=0){const n=[];return t.forEach(function(r,i){let s=null;r.forEach(function(a,u){if(!a&&s!==null){n.push(`M${s+e} ${i+e}h${u-s}v1H${s+e}z`),s=null;return}if(u===r.length-1){if(!a)return;s===null?n.push(`M${u+e},${i+e} h1v1H${u+e}z`):n.push(`M${s+e},${i+e} h${u+1-s}v1H${s+e}z`);return}a&&s===null&&(s=u)})}),n.join("")}function j_(t,e){return t.slice().map((n,r)=>r<e.y||r>=e.y+e.h?n:n.map((i,s)=>s<e.x||s>=e.x+e.w?i:!1))}function IO(t,e,n,r){if(r==null)return null;const i=t.length+n*2,s=Math.floor(e*TO),a=i/e,u=(r.width||s)*a,o=(r.height||s)*a,d=r.x==null?t.length/2-u/2:r.x*a,h=r.y==null?t.length/2-o/2:r.y*a,f=r.opacity==null?1:r.opacity;let p=null;if(r.excavate){let b=Math.floor(d),N=Math.floor(h),D=Math.ceil(u+d-b),v=Math.ceil(o+h-N);p={x:b,y:N,w:D,h:v}}const g=r.crossOrigin;return{x:d,y:h,h:o,w:u,excavation:p,opacity:f,crossOrigin:g}}function jO(t,e){return e!=null?Math.max(Math.floor(e),0):t?EO:NO}function A_({value:t,level:e,minVersion:n,includeMargin:r,marginSize:i,imageSettings:s,size:a,boostLevel:u}){let o=$e.useMemo(()=>{const g=(Array.isArray(t)?t:[t]).reduce((b,N)=>(b.push(...pa.QrSegment.makeSegments(N)),b),[]);return pa.QrCode.encodeSegments(g,kO[e],n,void 0,void 0,u)},[t,e,n,u]);const{cells:d,margin:h,numCells:f,calculatedImageSettings:p}=$e.useMemo(()=>{let g=o.getModules();const b=jO(r,i),N=g.length+b*2,D=IO(g,a,b,s);return{cells:g,margin:b,numCells:N,calculatedImageSettings:D}},[o,a,s,r,i]);return{qrcode:o,margin:h,cells:d,numCells:f,calculatedImageSettings:p}}var AO=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}(),DO=$e.forwardRef(function(t,e){const n=t,{value:r,size:i=C_,level:s=__,bgColor:a=k_,fgColor:u=E_,includeMargin:o=N_,minVersion:d=T_,boostLevel:h,marginSize:f,imageSettings:p}=n,g=Im(n,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:b}=g,N=Im(g,["style"]),D=p==null?void 0:p.src,v=$e.useRef(null),w=$e.useRef(null),C=$e.useCallback(I=>{v.current=I,typeof e=="function"?e(I):e&&(e.current=I)},[e]),[O,R]=$e.useState(!1),{margin:F,cells:E,numCells:x,calculatedImageSettings:j}=A_({value:r,level:s,minVersion:d,boostLevel:h,includeMargin:o,marginSize:f,imageSettings:p,size:i});$e.useEffect(()=>{if(v.current!=null){const I=v.current,T=I.getContext("2d");if(!T)return;let te=E;const K=w.current,Y=j!=null&&K!==null&&K.complete&&K.naturalHeight!==0&&K.naturalWidth!==0;Y&&j.excavation!=null&&(te=j_(E,j.excavation));const ce=window.devicePixelRatio||1;I.height=I.width=i*ce;const L=i/x*ce;T.scale(L,L),T.fillStyle=a,T.fillRect(0,0,x,x),T.fillStyle=u,AO?T.fill(new Path2D(I_(te,F))):E.forEach(function(G,z){G.forEach(function($,W){$&&T.fillRect(W+F,z+F,1,1)})}),j&&(T.globalAlpha=j.opacity),Y&&T.drawImage(K,j.x+F,j.y+F,j.w,j.h)}}),$e.useEffect(()=>{R(!1)},[D]);const S=Tm({height:i,width:i},b);let _=null;return D!=null&&(_=$e.createElement("img",{src:D,key:D,style:{display:"none"},onLoad:()=>{R(!0)},ref:w,crossOrigin:j==null?void 0:j.crossOrigin})),$e.createElement($e.Fragment,null,$e.createElement("canvas",Tm({style:S,height:i,width:i,ref:C,role:"img"},N)),_)});DO.displayName="QRCodeCanvas";var D_=$e.forwardRef(function(t,e){const n=t,{value:r,size:i=C_,level:s=__,bgColor:a=k_,fgColor:u=E_,includeMargin:o=N_,minVersion:d=T_,boostLevel:h,title:f,marginSize:p,imageSettings:g}=n,b=Im(n,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:N,cells:D,numCells:v,calculatedImageSettings:w}=A_({value:r,level:s,minVersion:d,boostLevel:h,includeMargin:o,marginSize:p,imageSettings:g,size:i});let C=D,O=null;g!=null&&w!=null&&(w.excavation!=null&&(C=j_(D,w.excavation)),O=$e.createElement("image",{href:g.src,height:w.h,width:w.w,x:w.x+N,y:w.y+N,preserveAspectRatio:"none",opacity:w.opacity,crossOrigin:w.crossOrigin}));const R=I_(C,N);return $e.createElement("svg",Tm({height:i,width:i,viewBox:`0 0 ${v} ${v}`,ref:e,role:"img"},b),!!f&&$e.createElement("title",null,f),$e.createElement("path",{fill:a,d:`M0,0 h${v}v${v}H0z`,shapeRendering:"crispEdges"}),$e.createElement("path",{fill:u,d:R,shapeRendering:"crispEdges"}),O)});D_.displayName="QRCodeSVG";function MO({open:t,onClose:e,memberId:n="",nickname:r="",firstName:i="",lastName:s=""}){if(k.useEffect(()=>{if(!t)return;function o(d){d.key==="Escape"&&e&&e()}return window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[t,e]),!t)return null;const a=r||i||s||"Member",u=String(n||a);return c.jsx("div",{onClick:o=>{o.target===o.currentTarget&&e&&e()},style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:c.jsxs("div",{style:{width:"min(98vw, 820px)",boxSizing:"border-box",padding:20,background:"#fff",borderRadius:14,border:"1px solid var(--light-border)",boxShadow:"0 20px 60px rgba(0,0,0,.2)",overflow:"visible"},onClick:o=>o.stopPropagation(),children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12},children:[c.jsx("div",{style:{fontWeight:800,fontSize:18}}),c.jsx("button",{type:"button",className:"button",onClick:e,style:{background:"#eee",color:"#333"},children:""})]}),c.jsx("div",{style:{display:"flex",justifyContent:"center"},children:c.jsx("div",{style:{width:520,maxWidth:"78vw",aspectRatio:"1 / 1",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:c.jsxs("div",{style:{width:"100%",height:"100%",borderRadius:10,border:"6px solid var(--kusgan-magenta, #c51c8a)",boxSizing:"border-box",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative",background:"#fff"},children:[c.jsx("div",{style:{position:"absolute",top:10,left:"50%",transform:"translateX(-50%)",fontSize:16,color:"var(--kusgan-magenta, #c51c8a)",fontWeight:700},children:"kusgan"}),c.jsx("div",{style:{width:"72%",height:"72%",display:"flex",alignItems:"center",justifyContent:"center"},children:c.jsx(D_,{value:u,size:Math.min(700,Math.floor(window.innerWidth*.7))})}),c.jsx("div",{style:{position:"absolute",bottom:10,left:"50%",transform:"translateX(-50%)",fontSize:16,color:"#333",fontWeight:600},children:a})]})})})]})})}const{addProgressRow:PO,uploadMemberPhoto:OO}=Ae,M_="Asia/Manila",RO=()=>new Intl.DateTimeFormat("en-CA",{timeZone:M_,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date),LO=t=>{var e,n,r;if(!t)return"-";let i;if(typeof t=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(t)){const[d,h,f]=t.split("-").map(Number);i=new Date(Date.UTC(d,h-1,f))}else i=t instanceof Date?t:new Date(t);if(isNaN(i))return"-";const s=new Intl.DateTimeFormat("en-US",{timeZone:M_,month:"short",day:"numeric",year:"numeric"}).formatToParts(i),a=((e=s.find(d=>d.type==="month"))==null?void 0:e.value)||"",u=((n=s.find(d=>d.type==="day"))==null?void 0:n.value)||"",o=((r=s.find(d=>d.type==="year"))==null?void 0:r.value)||"";return`${a}-${u}, ${o}`};function FO(t,e){if(!t||!e)return 1;const[n,r,i]=t.split("-").map(Number),[s,a,u]=e.split("-").map(Number),o=Date.UTC(n,r-1,i),d=Date.UTC(s,a-1,u),h=Math.floor((d-o)/864e5);return Math.max(1,h+1)}function UO({open:t,onClose:e,memberId:n,memberSinceYMD:r,onSaved:i,memberNick:s}){const a=RO(),u=k.useMemo(()=>FO(r,a),[r,a]),[o,d]=k.useState(""),[h,f]=k.useState(""),[p,g]=k.useState(""),[b,N]=k.useState(""),[D,v]=k.useState(""),[w,C]=k.useState(""),[O,R]=k.useState(""),[F,E]=k.useState(""),[x,j]=k.useState(""),[S,_]=k.useState(""),[I,T]=k.useState(""),[te,K]=k.useState(""),[Y,ce]=k.useState(""),[L,G]=k.useState(""),[z,$]=k.useState(""),[W,ee]=k.useState(""),[Z,ie]=k.useState([]),P=$e.useRef(null),[V,U]=k.useState(-1),[q,se]=k.useState(""),[me,ae]=k.useState(!1),M=k.useMemo(()=>{const re=Number(o)||0,pe=(Number(h)||0)/100;return!re||!pe?0:Math.round(re/(pe*pe)*10)/10},[o,h]);k.useMemo(()=>Math.round((Number(o)||0)*2.20462262185*10)/10,[o]),k.useMemo(()=>Math.round((Number(h)||0)/2.54*10)/10,[h]),k.useEffect(()=>{t&&(d(""),f(""),g(""),N(""),v(""),C(""),R(""),E(""),j(""),_(""),T(""),K(""),ce(""),G(""),$(""),ee(""),ie([]),U(-1),ae(!1))},[t]);const X=async re=>{if(re)try{const pe=String(n||"").toLowerCase(),le=await OO(re,pe),xe=typeof le=="string"?le:(le==null?void 0:le.url)||"";ie(Qe=>{const rt=Array.isArray(Qe)?[...Qe]:[];for(;rt.length<3;)rt.push("");const ge=V>=0&&V<3?V:rt.findIndex(Ee=>!Ee);return ge===-1||(rt[ge]=xe),rt})}catch(pe){const le=(pe==null?void 0:pe.message)||"Failed to upload photo";se(le);try{en.emit("modal:error",{message:le,source:"ProgressModal",error:String(pe)})}catch{}}finally{U(-1)}},B=re=>{ie(pe=>{const le=Array.isArray(pe)?[...pe]:[];if(re<0||re>=3)return le;if(le.length<3)for(;le.length<3;)le.push("");return le[re]="",le})},de=async re=>{var pe;if((pe=re==null?void 0:re.preventDefault)==null||pe.call(re),!n||me)return;ae(!0),se("");const le={MemberID:n,Date:a,No:`Day ${u}`,"Weight (kg)":o?String(o):"","Weight(kg)":o?String(o):"",WeightKg:o?String(o):"",Weight:o?String(o):"",BMI:M?String(M):"",MuscleMass:p?String(p):"",BodyFat:b?String(b):"",VisceralFat:D?String(D):"",Photo1URL:Z[0]||"",Photo2URL:Z[1]||"",Photo3URL:Z[2]||"","Height (cm)":h?String(h):"","Height(cm)":h?String(h):"",HeightCm:h?String(h):"",Height:h?String(h):"",Chest:w?String(w):"",Waist:O?String(O):"",Hips:F?String(F):"",Shoulders:x?String(x):"",Arms:S?String(S):"",Forearms:I?String(I):"",Thighs:te?String(te):"",Calves:Y?String(Y):"",BloodPressure:L,"RestingHeart Rate":z,Comments:W};try{await PO(le),i==null||i(),e==null||e()}catch(xe){const Qe=(xe==null?void 0:xe.message)||"Failed to save progress entry";se(Qe);try{en.emit("modal:error",{message:Qe,source:"ProgressModal",error:String(xe)})}catch{}}finally{ae(!1)}};return t?c.jsxs(ts,{open:t,onClose:e,title:"Progress Entry",width:1e3,children:[q&&c.jsx("div",{className:"small-error",style:{marginBottom:8},children:q}),c.jsxs("form",{onSubmit:de,style:{width:"100%",padding:0,background:"transparent",border:"none",boxShadow:"none",overflow:"visible"},children:[c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12,marginBottom:12},children:[c.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[c.jsx("div",{style:{fontSize:14,fontStyle:"italic",color:"var(--muted)",display:"block",marginBottom:4},children:"Nickname"}),c.jsx("div",{style:{fontWeight:700,fontSize:18},children:s||n})]}),c.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[c.jsx("div",{style:{fontSize:14,fontStyle:"italic",color:"var(--muted)",display:"block",marginBottom:4},children:"Date"}),c.jsx("div",{style:{fontWeight:700,fontSize:18},children:LO(a)})]}),c.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[c.jsx("div",{style:{fontSize:14,fontStyle:"italic",color:"var(--muted)",display:"block",marginBottom:4},children:"No."}),c.jsx("div",{style:{fontWeight:700,fontSize:18},children:`Day ${u}`})]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:12},children:[c.jsxs("label",{className:"field",children:[c.jsx("span",{className:"label",children:"Weight (kg)"}),c.jsx("input",{type:"number",step:"0.1",min:"0",value:o,onChange:re=>d(re.target.value)})]}),c.jsxs("label",{className:"field",children:[c.jsx("span",{className:"label",children:"Height (cm)"}),c.jsx("input",{type:"number",step:"0.1",min:"0",value:h,onChange:re=>f(re.target.value)})]}),c.jsxs("div",{className:"field",children:[c.jsx("span",{className:"label",children:"BMI"}),c.jsx("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10,fontWeight:700},children:M||"-"})]}),c.jsxs("label",{className:"field",children:[c.jsx("span",{className:"label",children:"Muscle Mass"}),c.jsx("input",{type:"number",step:"0.1",min:"0",value:p,onChange:re=>g(re.target.value)})]}),c.jsxs("label",{className:"field",children:[c.jsx("span",{className:"label",children:"Body Fat (%)"}),c.jsx("input",{type:"number",step:"0.1",min:"0",value:b,onChange:re=>N(re.target.value)})]}),c.jsxs("label",{className:"field",children:[c.jsx("span",{className:"label",children:"Visceral Fat"}),c.jsx("input",{type:"number",step:"0.1",min:"0",value:D,onChange:re=>v(re.target.value)})]}),c.jsxs("label",{className:"field",children:[c.jsx("span",{className:"label",children:"Chest (cm)"}),c.jsx("input",{type:"number",step:"0.1",min:"0",value:w,onChange:re=>C(re.target.value)})]}),c.jsxs("label",{className:"field",children:[c.jsx("span",{className:"label",children:"Waist (cm)"}),c.jsx("input",{type:"number",step:"0.1",min:"0",value:O,onChange:re=>R(re.target.value)})]}),c.jsxs("label",{className:"field",children:[c.jsx("span",{className:"label",children:"Hips (cm)"}),c.jsx("input",{type:"number",step:"0.1",min:"0",value:F,onChange:re=>E(re.target.value)})]}),c.jsxs("label",{className:"field",children:[c.jsx("span",{className:"label",children:"Shoulders (cm)"}),c.jsx("input",{type:"number",step:"0.1",min:"0",value:x,onChange:re=>j(re.target.value)})]}),c.jsxs("label",{className:"field",children:[c.jsx("span",{className:"label",children:"Arms (cm)"}),c.jsx("input",{type:"number",step:"0.1",min:"0",value:S,onChange:re=>_(re.target.value)})]}),c.jsxs("label",{className:"field",children:[c.jsx("span",{className:"label",children:"Forearms (cm)"}),c.jsx("input",{type:"number",step:"0.1",min:"0",value:I,onChange:re=>T(re.target.value)})]}),c.jsxs("label",{className:"field",children:[c.jsx("span",{className:"label",children:"Thighs (cm)"}),c.jsx("input",{type:"number",step:"0.1",min:"0",value:te,onChange:re=>K(re.target.value)})]}),c.jsxs("label",{className:"field",children:[c.jsx("span",{className:"label",children:"Calves (cm)"}),c.jsx("input",{type:"number",step:"0.1",min:"0",value:Y,onChange:re=>ce(re.target.value)})]}),c.jsxs("label",{className:"field",children:[c.jsx("span",{className:"label",children:"Blood Pressure"}),c.jsx("input",{placeholder:"120/80",value:L,onChange:re=>G(re.target.value)})]}),c.jsxs("label",{className:"field",children:[c.jsx("span",{className:"label",children:"Resting Heart Rate"}),c.jsx("input",{type:"number",step:"1",min:"0",value:z,onChange:re=>$(re.target.value)})]}),c.jsx("div",{})]}),c.jsxs("div",{style:{marginTop:12},children:[c.jsx("div",{className:"label",style:{marginBottom:6},children:"Photos (max 3)"}),c.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:12},children:[0,1,2].map(re=>{const pe=Z[re]||"";return c.jsxs("div",{style:{position:"relative"},children:[c.jsx("div",{onClick:()=>{},style:{position:"relative",width:"100%",height:0,paddingTop:"133.333%",borderRadius:8,border:pe?"1px solid #e5e7eb":"1px dashed #e5e7eb",cursor:"default",overflow:"hidden",background:pe?"#fff":"#fafafa",opacity:.65},children:pe?c.jsx("img",{src:pe,alt:`Photo ${re+1}`,style:{position:"absolute",inset:0,width:"100%",height:"100%",objectFit:"cover"}}):c.jsx("div",{style:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",color:"#999"},children:"Photo disabled"})}),pe&&c.jsx("button",{type:"button","aria-label":"Remove",onClick:()=>B(re),style:{position:"absolute",top:6,right:6,background:"rgba(0,0,0,.55)",color:"#fff",borderRadius:6,padding:"4px 6px",border:0},children:""})]},re)})})]}),c.jsx("input",{ref:P,type:"file",accept:"image/*",style:{display:"none"},onChange:re=>{var pe;const le=(pe=re.target.files)==null?void 0:pe[0];le&&X(le)}}),c.jsxs("div",{className:"field",style:{marginTop:12},children:[c.jsx("span",{className:"label",children:"Comments"}),c.jsx("textarea",{rows:4,value:W,onChange:re=>ee(re.target.value),style:{width:"100%",borderRadius:8,border:"1px solid #e5e7eb",padding:12,fontFamily:"inherit",resize:"vertical",fontSize:16}})]}),c.jsxs("div",{style:{marginTop:12,display:"flex",gap:10,justifyContent:"flex-end"},children:[c.jsx("button",{type:"button",className:"back-btn",onClick:e,style:{background:"#e5e7eb",color:"#111",fontWeight:700},children:"Cancel"}),c.jsx("button",{type:"submit",className:"primary-btn",disabled:me,children:me?"Saving...":" Save Progress"})]})]})]}):null}const VO=(t="")=>{const e=String(t||"").match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^\/&#?]+)/);return e&&e[1]?e[1]:""},zO=(t="")=>{const e=String(t||"");if(/googleusercontent\.com\//.test(e))return e;const n=VO(e);return n?`https://drive.google.com/thumbnail?id=${n}&sz=w1000`:e},bt=(t,e=[])=>{if(!t)return"";for(const n of e){if(Object.prototype.hasOwnProperty.call(t,n))return t[n];const r=Object.keys(t).find(i=>i.toLowerCase().replace(/\s+/g,"")===n.toLowerCase().replace(/\s+/g,""));if(r)return t[r]}return""};function BO({open:t,onClose:e,row:n,memberNick:r}){if(!t)return null;const i=n||{},s=bt(i,["MemberID","memberid","member_id","id"]),a=bt(i,["Date","date","recorded","log_date","timestamp"]),u=bt(i,["No","no","entry_no","seq","number"]),o=bt(i,["Weight (kg)","Weight(kg)","WeightKg","Weight (lbs)","Weight(lbs)","Weight","Weight_lbs","weight","weight_lbs","weight_(lbs)"]),d=bt(i,["BMI","bmi"]),h=bt(i,["Height (cm)","Height(cm)","HeightCm","Height (inches)","Height(inches)","Height_in","height_in","height_inches"]),f=bt(i,["MuscleMass","muscle_mass","muscle","Muscle"]),p=bt(i,["BodyFat","body_fat","bf"]),g=bt(i,["VisceralFat","visceral_fat"]),b=bt(i,["Chest"]),N=bt(i,["Waist"]),D=bt(i,["Hips"]),v=bt(i,["Shoulders"]),w=bt(i,["Arms"]),C=bt(i,["Forearms"]),O=bt(i,["Thighs"]),R=bt(i,["Calves"]),F=bt(i,["BloodPressure","blood_pressure"]),E=bt(i,["RestingHeart Rate","RestingHeartRate","resting_heart_rate"]),x=bt(i,["Comments","comments","notes"]),j=bt(i,["Photo1URL","Photo1","photo1","photo_url","photo"]),S=bt(i,["Photo2URL","Photo2","photo2"]),_=bt(i,["Photo3URL","Photo3","photo3"]);return c.jsxs(ts,{open:t,onClose:e,title:"Progress Details",width:1e3,children:[c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12,marginBottom:12},children:[c.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[c.jsx("span",{style:{fontSize:14,fontStyle:"italic",color:"var(--muted)",display:"block",marginBottom:4},children:"Nickname"}),c.jsx("div",{style:{fontWeight:700,fontSize:18},children:r||s||"-"})]}),c.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[c.jsx("span",{style:{fontSize:14,fontStyle:"italic",color:"var(--muted)",display:"block",marginBottom:4},children:"Date"}),c.jsx("div",{style:{fontWeight:700,fontSize:18},children:HO(a)||"-"})]}),c.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[c.jsx("span",{style:{fontSize:14,fontStyle:"italic",color:"var(--muted)",display:"block",marginBottom:4},children:"No."}),c.jsx("div",{style:{fontWeight:700,fontSize:18},children:u||"-"})]})]}),c.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:12},children:[["Weight (kg)",o],["Height (cm)",h],["BMI",d],["Muscle Mass (%)",f],["Body Fat (%)",p],["Visceral Fat (%)",g],["Chest (cm)",b],["Waist (cm)",N],["Hips (cm)",D],["Shoulders (cm)",v],["Arms (cm)",w],["Forearms (cm)",C],["Thighs (cm)",O],["Calves (cm)",R],["Blood Pressure (mmHg)",F],["Resting Heart Rate (bpm)",E]].map(([I,T])=>c.jsxs("div",{className:"field",children:[c.jsx("span",{className:"label",style:{display:"block",marginBottom:6},children:I}),c.jsx("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10,fontWeight:700,fontSize:18},children:!T||String(T).trim()==="0"?"-":String(T)})]},I))}),c.jsxs("div",{className:"field",style:{marginTop:12},children:[c.jsx("span",{className:"label",children:"Comments"}),c.jsx("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:12,fontSize:16,minHeight:72},children:x?String(x):"-"})]}),c.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:12,marginTop:12},children:[j,S,_].map((I,T)=>c.jsx("div",{style:{position:"relative"},children:c.jsx("div",{style:{position:"relative",width:"100%",height:0,paddingTop:"133.333%",borderRadius:8,border:I?"1px solid #e5e7eb":"1px dashed #e5e7eb",overflow:"hidden"},children:I?c.jsx("img",{src:zO(I),alt:`Photo ${T+1}`,style:{position:"absolute",inset:0,width:"100%",height:"100%",objectFit:"cover"}}):c.jsx("div",{style:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",color:"#999"},children:"No photo"})})},T))})]})}const $O="Asia/Manila";function HO(t){var e,n,r;if(!t)return"";let i;if(typeof t=="string")if(/^\d{4}-\d{2}-\d{2}$/.test(t)){const[d,h,f]=t.split("-").map(Number);i=new Date(Date.UTC(d,h-1,f))}else{const d=new Date(t);isNaN(d)||(i=d)}else t instanceof Date&&(i=t);if(!i||isNaN(i))return String(t);const s=new Intl.DateTimeFormat("en-US",{timeZone:$O,month:"short",day:"numeric",year:"numeric"}).formatToParts(i),a=((e=s.find(d=>d.type==="month"))==null?void 0:e.value)||"",u=((n=s.find(d=>d.type==="day"))==null?void 0:n.value)||"",o=((r=s.find(d=>d.type==="year"))==null?void 0:r.value)||"";return`${a}-${u}, ${o}`}function P_({width:t="100%",height:e=200}){return c.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-start"},children:[c.jsx("div",{style:{width:150,height:200,borderRadius:12,background:"#f3f4f6",boxShadow:"inset 0 0 0 1px rgba(0,0,0,0.02)"}}),c.jsxs("div",{style:{flex:1},children:[c.jsx("div",{style:{height:22,width:"60%",background:"#f3f4f6",borderRadius:6,marginBottom:8}}),c.jsx("div",{style:{height:18,width:"40%",background:"#f3f4f6",borderRadius:6,marginBottom:14}}),c.jsx("div",{style:{height:12,width:"80%",background:"#f3f4f6",borderRadius:6,marginBottom:6}}),c.jsx("div",{style:{height:12,width:"70%",background:"#f3f4f6",borderRadius:6,marginBottom:6}}),c.jsx("div",{style:{height:12,width:"50%",background:"#f3f4f6",borderRadius:6,marginTop:10}})]})]})}function Vd({text:t="Refreshing",show:e=!0}){return e?c.jsxs("span",{className:"refresh-badge",role:"status","aria-live":"polite",children:[c.jsx("span",{className:"refresh-spinner","aria-hidden":!0}),c.jsx("span",{style:{marginLeft:8},children:t})]}):null}const In=(t,e)=>e.map(n=>t[n]).find(n=>n!==void 0&&n!==""),y0=t=>{if(!t&&t!==0)return null;try{if(t&&typeof t.toDate=="function")return t.toDate()}catch{}if(t&&typeof t.seconds=="number")return new Date(t.seconds*1e3);if(t instanceof Date)return t;const e=new Date(t);return isNaN(e)?null:e},qO="Asia/Manila",ju=t=>{var e,n,r;if(!t)return"-";const i=t instanceof Date?t:new Date(t);if(isNaN(i))return"-";const s=new Intl.DateTimeFormat("en-US",{timeZone:qO,month:"short",day:"numeric",year:"numeric"}).formatToParts(i),a=((e=s.find(d=>d.type==="month"))==null?void 0:e.value)||"",u=((n=s.find(d=>d.type==="day"))==null?void 0:n.value)||"",o=((r=s.find(d=>d.type==="year"))==null?void 0:r.value)||"";return`${a}-${u}, ${o}`},br=t=>t==null||String(t).trim()===""?"-":String(t),Oo=t=>{const e=String(t||"").match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return e&&e[1]?e[1]:""},WO=t=>{const e=String(t||"");if(!e)return"";const n=e.match(/https?:\/\/[^\s}]+/);if(n){const s=n[0];if(/googleusercontent\.com\//.test(s))return s;const a=s.match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^\/&?#]+)/);return a&&a[1]?`https://drive.google.com/uc?export=view&id=${a[1]}`:s}if(/googleusercontent\.com\//.test(e))return e;const r=e.match(/\/file\/d\/([^/]+)/)||e.match(/[?&]id=([^&]+)/)||e.match(/\/uc\?[^#]*id=([^&]+)/),i=r?r[1]:"";return i?`https://drive.google.com/uc?export=view&id=${i}`:e},v0=t=>{const e=String(t||"");if(/googleusercontent\.com\//.test(e))return e;const n=Oo(e);return n?`https://drive.google.com/thumbnail?id=${n}&sz=w1000`:e};function GO({member:t,status:e={},isRefreshing:n=!1,onEdit:r=()=>{},onAddPayment:i=()=>{},onShowQr:s=()=>{},onShowProgress:a=()=>{},onCheckIn:u=()=>{}}){const[o,d]=k.useState(!1),h=In(t||{},["lastname","last_name"]),f=In(t||{},["firstname","first_name"]),p=In(t||{},["middlename","middle_name"]),g=In(t||{},["gender"]),b=In(t||{},["birthday","birth_date","dob"]),N=y0(b);In(t||{},["nick_name","nickname"]);const D=In(t||{},["street"]),v=In(t||{},["brgy","barangay"]),w=In(t||{},["municipality","city"]),C=In(t||{},["email"]),O=In(t||{},["mobile","phone"]),R=y0(In(t||{},["member_since","membersince","join_date"]));String(In(t||{},["memberid","member_id","id"])||"").trim();const F=In(t||{},["photourl","photo_url","photo"]),E=WO(F);v0(E),k.useEffect(()=>{d(!1)},[E]);const x=N?new Date().getFullYear()-N.getFullYear()-(new Date().getMonth()<N.getMonth()||new Date().getMonth()===N.getMonth()&&new Date().getDate()<N.getDate()?1:0):"-";return c.jsxs("div",{className:"member-card",style:{marginTop:12},children:[c.jsx("div",{className:"member-photo",children:c.jsx("div",{className:"photo-box",children:E&&!o?c.jsx("img",{src:v0(E),alt:"photo",onError:j=>{const S=j.currentTarget;if(!S.dataset.retry&&F){S.dataset.retry="1";const _=Oo(F)||Oo(E);_?S.src=`https://drive.google.com/uc?export=view&id=${_}`:S.style.display="none"}else if(S.dataset.retry==="1"){S.dataset.retry="2";const _=Oo(F)||Oo(E);_?S.src=`https://drive.google.com/uc?export=download&id=${_}`:d(!0)}else d(!0)}}):c.jsx("div",{style:{color:"var(--muted)",padding:16},children:"No photo"})})}),c.jsxs("div",{className:"member-info",children:[c.jsxs("div",{className:"member-grid",children:[c.jsxs("div",{className:"cell lastname",children:[c.jsx("div",{className:"label",children:"Last Name"}),c.jsx("div",{className:"value",children:br(h)})]}),c.jsxs("div",{className:"cell firstname",children:[c.jsx("div",{className:"label",children:"First Name"}),c.jsx("div",{className:"value",children:br(f)})]}),c.jsxs("div",{className:"cell middlename",children:[c.jsx("div",{className:"label",children:"Middle Name"}),c.jsx("div",{className:"value",children:br(p)})]}),c.jsxs("div",{className:"cell gender",children:[c.jsx("div",{className:"label",children:"Gender"}),c.jsx("div",{className:"value",children:br(g)})]}),c.jsxs("div",{className:"cell birthday",children:[c.jsx("div",{className:"label",children:"Birthday"}),c.jsx("div",{className:"value",children:ju(N)})]}),c.jsxs("div",{className:"cell age",children:[c.jsx("div",{className:"label",children:"Age"}),c.jsx("div",{className:"value",children:br(x)})]}),c.jsxs("div",{className:"cell street",children:[c.jsx("div",{className:"label",children:"House No. / Street Name / Sitio"}),c.jsx("div",{className:"value",children:br(D)})]}),c.jsxs("div",{className:"cell brgy",children:[c.jsx("div",{className:"label",children:"Brgy."}),c.jsx("div",{className:"value",children:br(v)})]}),c.jsxs("div",{className:"cell municipality",children:[c.jsx("div",{className:"label",children:"Municipality / City"}),c.jsx("div",{className:"value",children:br(w)})]}),c.jsxs("div",{className:"cell nickname",children:[c.jsx("div",{className:"label",children:"Member Since"}),c.jsx("div",{className:"value",children:ju(R)})]}),c.jsxs("div",{className:"cell mobile",children:[c.jsx("div",{className:"label",children:"Mobile"}),c.jsx("div",{className:"value",children:br(O)})]}),c.jsxs("div",{className:"cell email",children:[c.jsx("div",{className:"label",children:"Email"}),c.jsx("div",{className:"value",children:br(C)})]})]}),c.jsxs("div",{className:"status-tiles",children:[c.jsxs("div",{className:`status-tile ${e.membershipState==null?"none":e.membershipState}`,children:[c.jsx("div",{className:"title",children:"Gym Membership"}),c.jsxs("div",{style:{marginBottom:10},children:[e.membershipState==="active"&&c.jsx("span",{className:"pill ok",children:"Active"}),e.membershipState==="expired"&&c.jsx("span",{className:"pill bad",children:"Expired"}),(!e.membershipState||e.membershipState==="none")&&c.jsx("span",{className:"pill",style:{background:"#fff",color:"#555",borderColor:"#ddd"},children:"None"})]}),c.jsx("div",{className:"label",children:"Valid until"}),c.jsx("div",{className:"value",children:ju(e.membershipEnd)})]}),c.jsxs("div",{className:`status-tile ${e.coachEnd?e.coachActive?"active":"expired":"none"}`,children:[c.jsx("div",{className:"title",children:"Coach Subscription"}),c.jsxs("div",{style:{marginBottom:10},children:[e.coachActive&&c.jsx("span",{className:"pill ok",children:"Active"}),e.coachEnd&&!e.coachActive&&c.jsx("span",{className:"pill bad",children:"Expired"}),!e.coachEnd&&c.jsx("span",{className:"pill",style:{background:"#fff",color:"#555",borderColor:"#ddd"},children:"None"})]}),c.jsx("div",{className:"label",children:"Valid until"}),c.jsx("div",{className:"value",children:ju(e.coachEnd)})]})]}),c.jsxs("div",{className:"member-actions",children:[c.jsx("button",{className:"primary-btn",onClick:()=>r(),title:"Edit member details",children:" Edit"}),c.jsx("button",{className:"primary-btn",onClick:()=>i(),title:"Manage payments",children:" Add Payment"}),c.jsx("button",{className:"primary-btn",onClick:()=>s(),title:"Show QR code for this member",children:" QR Code"}),c.jsx("button",{className:"primary-btn",onClick:()=>a(),title:"Track or view progress",children:" Progress"})]})]})]})}const QO=t=>String(t||"").trim().toLowerCase().replace(/\s+/g,"_"),ci=(t,e)=>e.map(n=>(t||{})[n]).find(n=>n!==void 0&&n!==""),ko=t=>{if(!t&&t!==0)return null;try{if(t&&typeof t.toDate=="function")return t.toDate()}catch{}if(t&&typeof t.seconds=="number")return new Date(t.seconds*1e3);if(t instanceof Date)return t;if(typeof t=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(t))try{return new Date(`${t}T00:00:00+08:00`)}catch{}const e=new Date(t);return isNaN(e)?null:e},$h=t=>{const e={};return Object.entries(t||{}).forEach(([n,r])=>{e[QO(n)]=r}),e};function Yr(t,e,n=[]){const r=v=>{if(!v)return null;const w=v instanceof Date?v:ko(v);return w?new Intl.DateTimeFormat("en-CA",{timeZone:"Asia/Manila",year:"numeric",month:"2-digit",day:"2-digit"}).format(w):null},i=r(new Date);let s=null,a=null,u=null,o=null;const d=new Map,h=Array.isArray(n)?n:[],f=v=>{const w=String(v??"").trim().toLowerCase();return w==="yes"||w==="y"||w==="true"||w==="1"},p=(v,w)=>{for(const C of w){if(v&&Object.prototype.hasOwnProperty.call(v,C))return v[C];const O=Object.keys(v||{}).find(R=>R.toLowerCase().replace(/\s+/g,"")===C.toLowerCase().replace(/\s+/g,""));if(O)return v[O]}};h.forEach(v=>{const w=String(p(v,["Particulars"])||"").trim();if(!w)return;const C=f(p(v,["Gym membership","Gym Membership","GymMembership","Membership"])),O=f(p(v,["Coach subscription","Coach Subscription","CoachSubscription","Coach"]));d.set(String(w).toLowerCase(),{gym:C,coach:O})});let g=null;if(typeof e=="string")g=String(e||"").trim().toLowerCase();else if(e&&typeof e=="object"){const v=$h(e);g=String(ci(v,["memberid","member_id","id","member_id_"])||"").trim().toLowerCase()}const b=Array.isArray(t)?t:[];for(const v of b){const w=$h(v);if(g){const Y=String(ci(w,["memberid","member_id","id","member_id_"])||"").trim().toLowerCase();if(!Y||Y!==g)continue}const C=String(ci(w,["particulars","type","item","category","product","paymentfor","plan","description"])||"").trim(),O=ci(w,["gymvaliduntil","gym_valid_until","gym_until","enddate","end_date","valid_until","expiry","expires","until","end"]),R=ci(w,["coachvaliduntil","coach_valid_until","coach_until","coach_end","coachend"]),F=ci(w,["enddate","end_date","valid_until","expiry","expires","until","end"]),E=ko(O),x=ko(R),j=ko(F),S=r(E),_=r(x),I=r(j),T=d.get(String(C).toLowerCase())||{gym:null,coach:null},te=T.coach===!0||T.coach===null&&/coach|trainer|pt/i.test(C),K=T.gym===!0||T.gym===null&&/member|gym/i.test(C);S?(!u||S>u)&&(u=S,s=E):K&&I&&(!u||I>u)&&(u=I,s=j),_?(!o||_>o)&&(o=_,a=x):te&&I&&(!o||I>o)&&(o=I,a=j)}if((!s||s==null)&&e&&typeof e=="object"){const v=$h(e);if(String(ci(v,["membershipstate","membership_state","membership","status"])||"").trim().toLowerCase()==="active")return{membershipEnd:s,membershipState:"active",coachEnd:a,coachActive:!!(o&&o>=i)};const w=ci(v,["membershipend","membership_end","membershipEnd","membership_end","gymvaliduntil","gym_valid_until","gym_until","enddate","end_date","valid_until","expiry","expires","until","end","gym_valid","gym_validity","gymvalid"]);if(w){const C=ko(w),O=r(C);C&&!isNaN(C)&&(!u||O>u)&&(u=O,s=C)}}let N=null;u&&(N=u>=i?"active":"expired");let D=!1;return o&&(D=o>=i),{membershipEnd:s,membershipState:N,coachEnd:a,coachActive:D}}const{fetchMemberBundle:KO,fetchPricing:XO,gymQuickAppend:b0,gymClockOut:YO,upsertGymEntry:JO,gymClockIn:ZO,fetchMemberByIdFresh:eR}=Ae,na="Asia/Manila",Hh=t=>{var e,n,r;if(!t)return"-";const i=t instanceof Date?t:new Date(t);if(isNaN(i))return"-";const s=new Intl.DateTimeFormat("en-US",{timeZone:na,month:"short",day:"numeric",year:"numeric"}).formatToParts(i),a=((e=s.find(d=>d.type==="month"))==null?void 0:e.value)||"",u=((n=s.find(d=>d.type==="day"))==null?void 0:n.value)||"",o=((r=s.find(d=>d.type==="year"))==null?void 0:r.value)||"";return`${a}-${u}, ${o}`},O_=t=>{const e=String(t||"").match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return e&&e[1]?e[1]:""},tR=t=>{const e=String(t||"");if(!e)return"";const n=e.match(/https?:\/\/[^\s}]+/);if(n){const i=n[0];if(/googleusercontent\.com\//.test(i))return i;const s=i.match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return s&&s[1]?`https://drive.google.com/uc?export=view&id=${s[1]}`:i}if(/googleusercontent\.com\//.test(e))return e;const r=O_(e);return r?`https://drive.google.com/uc?export=view&id=${r}`:e},nR=t=>{const e=String(t||"");if(/googleusercontent\.com\//.test(e))return e;const n=O_(e);return n?`https://drive.google.com/thumbnail?id=${n}&sz=w1000`:e};function zd({open:t,onClose:e,memberId:n,initialEntry:r=null,onSuccess:i,status:s=null,mode:a=null,bundleOverride:u=null,pricingOverride:o=null}){const[d,h]=k.useState(null),[f,p]=k.useState([]),[g,b]=k.useState(null),[N,D]=k.useState(!1),[v,w]=k.useState(""),[C,O]=k.useState(""),[R,F]=k.useState(""),[E,x]=k.useState(""),[j,S]=k.useState(!1),[_,I]=k.useState(!1),T=["Coach Elmer","Coach Jojo","None"],te=["Full body","Upper body","Lower body","Chest","Other"];k.useEffect(()=>{let L=!0;if(!(!t||!n))return(async()=>{D(!0);try{if(u&&String(u.member&&(u.member.MemberID||u.member.memberId||u.member.id)||"").trim()===String(n).trim()){const U=u,q=(o==null?void 0:o.rows)||(o==null?void 0:o.data)||o||[];h(U),p(Array.isArray(q)?q:(q==null?void 0:q.rows)||(q==null?void 0:q.data)||[]);const se=s||Yr((U==null?void 0:U.payments)||[],n,Array.isArray(q)?q:(q==null?void 0:q.rows)||(q==null?void 0:q.data)||[]);b(se),D(!1);return}console.debug("[CheckInConfirmModal] loading bundle for",n);const[G,z]=await Promise.all([KO(n),XO()]);if(!L)return;if(G&&!G.member)try{console.debug("[CheckInConfirmModal] bundle missing member, trying fetchMemberByIdFresh",n);const U=await eR(n);U&&(G.member=U)}catch(U){console.debug("[CheckInConfirmModal] fetchMemberByIdFresh fallback failed",U)}h(G);const $=(z==null?void 0:z.rows)||(z==null?void 0:z.data)||[];p($);const W=s||Yr((G==null?void 0:G.payments)||[],n,$);b(W);const ee=new Intl.DateTimeFormat("en-CA",{timeZone:na,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date),Z=((G==null?void 0:G.gymEntries)||[]).filter(U=>{const q=(U==null?void 0:U.Date)||(U==null?void 0:U.date);if(!q)return!1;const se=new Date(q);return new Intl.DateTimeFormat("en-CA",{timeZone:na,year:"numeric",month:"2-digit",day:"2-digit"}).format(se)===ee}).find(U=>!String((U==null?void 0:U.TimeOut)||(U==null?void 0:U.timeout)||"").trim());let ie=!1;if(r){const U=r.Date||r.date||"";if(U){const q=new Date(U);new Intl.DateTimeFormat("en-CA",{timeZone:na,year:"numeric",month:"2-digit",day:"2-digit"}).format(q)===ee&&!String(r.TimeOut||"").trim()&&(ie=!0)}}let P=!!Z||ie;a==="in"&&(P=!1),a==="out"&&(P=!0),S(P);const V=ie?r:Z||null;if(P&&V){const U=V||{};w(String(U.Workouts??U.workouts??U.Done??"").trim()),O(String(U.Comments??U.comments??U.Notes??"").trim()),F(String(U.Coach??U.coach??"")||""),x(String(U.Focus??U.focus??"")||"")}else w(""),O(""),F(""),x("")}catch(G){try{console.debug("[CheckInConfirmModal] load error",G),en.emit("modal:error",{message:"Failed to load check-in data",source:"CheckInConfirmModal",error:String(G)})}catch{}}finally{L&&D(!1)}})(),()=>{L=!1}},[t,n,r==null?void 0:r.rowNumber,r==null?void 0:r.Date,r==null?void 0:r.TimeIn,s,u,o]);const K=(d==null?void 0:d.member)||null,Y=async()=>{if(n){I(!0);try{if(r){const L=r.Date||r.date||"",G=new Intl.DateTimeFormat("en-CA",{timeZone:na,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date),z=L?new Date(L):null,$=z?new Intl.DateTimeFormat("en-CA",{timeZone:na,year:"numeric",month:"2-digit",day:"2-digit"}).format(z):"",W=String(r.TimeOut||r.timeout||"").trim();if($===G&&!W){const ee=new Date().toISOString();try{const Z=r.TimeIn||r.Timein||r.timeIn||r.timein||null,ie=r.Date||r.date||null,P={memberId:n,timeOut:ee,Workouts:v,Comments:C};try{console.debug("[CheckInConfirmModal] upsert payload",P)}catch{}g!=null&&g.coachActive&&(R&&R!=="None"&&(P.Coach=R),E&&(P.Focus=E)),Z&&(P.TimeIn=Z),ie&&(P.Date=ie),r.rowNumber&&(P.rowNumber=r.rowNumber);const V=await JO(P);try{console.debug("[CheckInConfirmModal] upsertGymEntry res",V)}catch{}try{en.emit("gymEntry:added",{MemberID:n,...V||{},Workouts:v,Comments:C})}catch{}I(!1),i&&i(),e&&e();return}catch(Z){try{en.emit("modal:error",{message:"Failed to upsert gym entry",source:"CheckInConfirmModal",error:String(Z)})}catch{}}}}try{const L={wantsOut:!0,Workouts:v,Comments:C};if(g!=null&&g.coachActive&&(R&&R!=="None"&&(L.Coach=R),E&&(L.Focus=E)),r){const G=r.TimeIn||r.Timein||r.timeIn||r.timein||null,z=r.Date||r.date||null;G&&(L.TimeIn=G),z&&(L.Date=z),r.rowNumber&&(L.rowNumber=r.rowNumber)}try{console.debug("[CheckInConfirmModal] gymQuickAppend extra",L)}catch{}await b0(n,L)}catch(L){const G={Workouts:v,Comments:C};r&&(r.TimeIn&&(G.TimeIn=r.TimeIn),r.Date&&(G.Date=r.Date),r.rowNumber&&(G.rowNumber=r.rowNumber)),g!=null&&g.coachActive&&(R&&R!=="None"&&(G.Coach=R),E&&(G.Focus=E));try{console.debug("[CheckInConfirmModal] gymQuickAppend failed, falling back to gymClockOut",G,L)}catch{}await YO(n,G)}try{en.emit("gymEntry:added",{MemberID:n,Workouts:v,Comments:C})}catch{}I(!1),i&&i(),e&&e()}catch(L){try{en.emit("modal:error",{message:"Checkout failed",source:"CheckInConfirmModal",error:String(L)})}catch{}I(!1)}}},ce=async()=>{if(n){I(!0);try{const L={Workouts:v,Comments:C};g!=null&&g.coachActive&&(R&&R!=="None"&&(L.Coach=R),E&&(L.Focus=E));try{await b0(n,L)}catch{await ZO(n,L)}I(!1),i&&i(),e&&e()}catch(L){try{en.emit("modal:error",{message:"Checkin failed",source:"CheckInConfirmModal",error:String(L)})}catch{}I(!1)}}};return t?c.jsx(ts,{open:t,onClose:e,width:720,noInternalScroll:!0,children:N?c.jsx("div",{style:{padding:24},children:"Loading"}):K?c.jsxs(c.Fragment,{children:[c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"auto 1fr",gap:16,alignItems:"center"},children:[c.jsx("div",{style:{width:150,height:200,borderRadius:12,overflow:"hidden",border:"1px solid #e7e8ef",background:"#fafbff"},children:K.PhotoURL||K.Photo?c.jsx("img",{src:nR(tR(K.PhotoURL||K.Photo)),alt:"Member",style:{width:"100%",height:"100%",objectFit:"cover"}}):c.jsx("div",{style:{display:"flex",width:"100%",height:"100%",alignItems:"center",justifyContent:"center",color:"#999"},children:"No Photo"})}),c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:900,fontSize:28,lineHeight:1.1},children:K.NickName||K.Nickname||"-"}),c.jsx("div",{style:{fontWeight:700,fontSize:18,color:"#444",marginTop:4},children:[K.FirstName,K.LastName].filter(Boolean).join(" ")||"-"}),c.jsx("div",{style:{fontStyle:"italic",color:"#666",marginTop:8},children:"Member Since"}),c.jsx("div",{style:{fontWeight:800,fontSize:16},children:Hh(K.MemberSince||K["Member Since"]||K.Joined||K["Join Date"])})]})]}),c.jsxs("div",{className:"status-tiles",style:{marginTop:14},children:[c.jsxs("div",{className:`status-tile ${(g==null?void 0:g.membershipState)==null?"none":g.membershipState}`,children:[c.jsx("div",{className:"title",children:"Gym Membership"}),c.jsx("div",{style:{marginBottom:10},children:(g==null?void 0:g.membershipState)==="active"?c.jsx("span",{className:"pill ok",children:"Active"}):(g==null?void 0:g.membershipState)==="expired"?c.jsx("span",{className:"pill bad",children:"Expired"}):c.jsx("span",{className:"pill",children:"None"})}),c.jsx("div",{className:"label",children:"Valid until"}),c.jsx("div",{className:"value",children:Hh(g==null?void 0:g.membershipEnd)})]}),c.jsxs("div",{className:`status-tile ${g!=null&&g.coachActive?"active":g!=null&&g.coachEnd?"expired":"none"}`,children:[c.jsx("div",{className:"title",children:"Coach Subscription"}),c.jsx("div",{style:{marginBottom:10},children:g!=null&&g.coachActive?c.jsx("span",{className:"pill ok",children:"Active"}):g!=null&&g.coachEnd?c.jsx("span",{className:"pill bad",children:"Expired"}):c.jsx("span",{className:"pill",children:"None"})}),c.jsx("div",{className:"label",children:"Valid until"}),c.jsx("div",{className:"value",children:Hh(g==null?void 0:g.coachEnd)})]})]}),j&&c.jsx("div",{children:g!=null&&g.coachActive?c.jsxs(c.Fragment,{children:[c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:14},children:[c.jsxs("div",{className:"field",children:[c.jsx("label",{className:"label",children:"Coach"}),c.jsxs("select",{value:R,onChange:L=>F(L.target.value),children:[c.jsx("option",{value:"",children:"(Select)"}),T.map(L=>c.jsx("option",{value:L,children:L},L))]})]}),c.jsxs("div",{className:"field",children:[c.jsx("label",{className:"label",children:"Workout Focus"}),c.jsxs("select",{value:E,onChange:L=>x(L.target.value),children:[c.jsx("option",{value:"",children:"(none)"}),te.map(L=>c.jsx("option",{value:L,children:L},L))]})]})]}),c.jsxs("div",{className:"field",style:{marginTop:16},children:[c.jsx("label",{className:"label",children:"Workouts Done"}),c.jsx("textarea",{value:v,onChange:L=>w(L.target.value),placeholder:"Describe workouts done (optional)",style:{width:"100%",minHeight:48,borderRadius:8,border:"1px solid #e7e8ef",padding:"8px 12px",fontSize:15,resize:"vertical"}})]})]}):c.jsxs("div",{className:"field",style:{marginTop:16},children:[c.jsx("label",{className:"label",children:"Workouts Done"}),c.jsx("textarea",{value:v,onChange:L=>w(L.target.value),placeholder:"Describe workouts done (optional)",style:{width:"100%",minHeight:48,borderRadius:8,border:"1px solid #e7e8ef",padding:"8px 12px",fontSize:15,resize:"vertical"}})]})}),!j&&c.jsx("div",{children:(g==null?void 0:g.coachActive)&&c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:14},children:[c.jsxs("div",{className:"field",children:[c.jsx("label",{className:"label",children:"Coach"}),c.jsxs("select",{value:R,onChange:L=>F(L.target.value),children:[c.jsx("option",{value:"",children:"(Select)"}),T.map(L=>c.jsx("option",{value:L,children:L},L))]})]}),c.jsxs("div",{className:"field",children:[c.jsx("label",{className:"label",children:"Workout Focus"}),c.jsxs("select",{value:E,onChange:L=>x(L.target.value),children:[c.jsx("option",{value:"",children:"(none)"}),te.map(L=>c.jsx("option",{value:L,children:L},L))]})]})]})}),c.jsxs("div",{className:"field",style:{marginTop:16},children:[c.jsx("label",{className:"label",children:"Comments"}),c.jsx("textarea",{value:C,onChange:L=>O(L.target.value),placeholder:"Add comments (optional)",style:{width:"100%",minHeight:48,borderRadius:8,border:"1px solid #e7e8ef",padding:"8px 12px",fontSize:15,resize:"vertical"}})]}),c.jsx("div",{style:{marginTop:12,color:"#b91c1c",fontSize:13},children:!j&&(g==null?void 0:g.membershipState)!=="active"&&c.jsx("div",{style:{marginBottom:8},children:"Cannot check in: gym membership is not active."})}),c.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:16},children:j?c.jsx("button",{className:"primary-btn",onClick:Y,disabled:_||(g==null?void 0:g.coachActive)&&(!R||!E),children:_?"Checking out":"Confirm Check-Out"}):c.jsx("button",{className:"primary-btn",onClick:ce,disabled:_||(g==null?void 0:g.membershipState)!=="active"||(g==null?void 0:g.coachActive)&&(!R||!E),children:_?"Checking in":"Confirm Check-In"})})]}):c.jsx("div",{style:{padding:24},children:"Member not found."})}):null}const{fetchMemberById:rR,fetchMemberByIdFresh:w0}=Ae,Ge=(t,e=[])=>{if(!t)return"";for(const n of e){if(Object.prototype.hasOwnProperty.call(t,n))return t[n];const r=Object.keys(t).find(i=>i.toLowerCase().replace(/\s+/g,"")===n.toLowerCase().replace(/\s+/g,""));if(r)return t[r]}return""};function Fg({open:t,onClose:e,row:n,onCheckout:r}){Qa();const[i,s]=$e.useState(!1),[a,u]=$e.useState(null),o=n&&n.raw?n.raw:n||{},d=Ge(o,["MemberID","memberid","member_id","id"]);$e.useEffect(()=>{let R=!0;return(async()=>{try{if(!d)return;let F=await rR(d);if(!R)return;if(!F)try{const j=await(w0==null?void 0:w0(d));j&&(F=j)}catch{}if(!F){try{const j=Ge(o,["NickName","nickname","Nick","nick","Nick_Name","Nick Name"])||Ge(n,["NickName","nickname","Nick","nick","Nick_Name","Nick Name"]);if(j){u(String(j).trim());return}const S=Ge(o,["FirstName","firstname","first_name","first"])||Ge(n,["FirstName","firstname","first_name","first"]),_=Ge(o,["LastName","lastname","last_name","last"])||Ge(n,["LastName","lastname","last_name","last"]),I=(S||"").trim()||(_||"").trim()?`${(S||"").trim()} ${(_||"").trim()}`.trim():null;if(I){u(I);return}}catch{}return}const E=F._raw||F,x=Ge(E,["NickName","nickname","Nick","nick","Nick_Name","Nick Name"]);if(x)u(String(x).trim());else{const j=(F.firstname||F.firstName||F.FirstName||"").trim(),S=(F.lastname||F.lastName||F.LastName||"").trim(),_=j||S?`${j} ${S}`.trim():null;if(_&&u(_),!_)try{const I=Ge(o,["NickName","nickname","Nick","nick","Nick_Name","Nick Name"])||Ge(n,["NickName","nickname","Nick","nick","Nick_Name","Nick Name"]);if(I){u(String(I).trim());return}const T=Ge(o,["FirstName","firstname","first_name","first"])||Ge(n,["FirstName","firstname","first_name","first"]),te=Ge(o,["LastName","lastname","last_name","last"])||Ge(n,["LastName","lastname","last_name","last"]),K=(T||"").trim()||(te||"").trim()?`${(T||"").trim()} ${(te||"").trim()}`.trim():null;if(K){u(K);return}}catch{}}}catch{}})(),()=>{R=!1}},[d]);const h=Ge(o,["Date","date","visit_date","timestamp"])||Ge(n,["Date","date","visit_date","timestamp"]),f=Ge(o,["TimeIn","timein","time_in"])||Ge(n,["TimeIn","timein","time_in"]),p=Ge(o,["TimeOut","timeout","time_out"])||Ge(n,["TimeOut","timeout","time_out"]),g=Ge(o,["TotalHours","totalhours","NoOfHours","noofhours","hours"])||Ge(n,["TotalHours","totalhours","NoOfHours","noofhours","hours"]),b=Ge(o,["Coach","coach"])||Ge(n,["Coach","coach"]),N=Ge(o,["Focus","focus"])||Ge(n,["Focus","focus"]),D=Ge(o,["Workouts","workouts","done","workouts_done"])||Ge(n,["Workouts","workouts","done","workouts_done"]),v=Ge(o,["Comments","comments","notes"])||Ge(n,["Comments","comments","notes"]);Ge(o,["Photo","photo","photo_url","PhotoURL"])||Ge(n,["Photo","photo","photo_url","PhotoURL"]);const[w,C]=$e.useState(!1);if(!t)return null;const O=()=>{if(typeof r=="function")try{r(n,{checkedOut:!0})}catch(R){console.error(R)}};return c.jsxs(c.Fragment,{children:[c.jsxs(ts,{open:t,onClose:e,title:"Visit Details",noInternalScroll:!0,children:[c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:12},children:[c.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[c.jsx("span",{style:{fontSize:14,fontStyle:"italic",color:"var(--muted)",display:"block",marginBottom:4},children:"Nickname"}),c.jsx("div",{style:{fontWeight:700,fontSize:18},children:a||d||"-"})]}),c.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[c.jsx("span",{style:{fontSize:14,fontStyle:"italic",color:"var(--muted)",display:"block",marginBottom:4},children:"Date"}),c.jsx("div",{style:{fontWeight:700,fontSize:18},children:bi(h)||"-"})]})]}),c.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:12},children:[["Time In",f],["Time Out",p],["Total Hours",g]].map(([R,F])=>c.jsxs("div",{className:"field",children:[c.jsx("span",{className:"label",style:{display:"block",marginBottom:6},children:R}),c.jsx("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10,fontWeight:700,fontSize:18},children:R==="Time In"||R==="Time Out"?F?Tl(F):"-":F?String(F):"-"})]},R))}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:12},children:[c.jsxs("div",{className:"field",children:[c.jsx("span",{className:"label",children:"Coach"}),c.jsx("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:12,fontSize:16,minHeight:44},children:b||"-"})]}),c.jsxs("div",{className:"field",children:[c.jsx("span",{className:"label",children:"Focus"}),c.jsx("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:12,fontSize:16,minHeight:44},children:N||"-"})]})]}),c.jsxs("div",{className:"field",style:{marginTop:12},children:[c.jsx("span",{className:"label",children:"Workouts Done"}),c.jsx("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:12,fontSize:16,minHeight:72},children:D||"-"})]}),c.jsxs("div",{className:"field",style:{marginTop:12},children:[c.jsx("span",{className:"label",children:"Comments"}),c.jsx("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:12,fontSize:16,minHeight:72},children:v||"-"})]}),c.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:[!p&&(()=>{try{const R=String(h||"").trim();if(!R)return!1;let F="";if(/^\d{4}-\d{2}-\d{2}$/.test(R))F=R.slice(0,10);else{const x=new Date(R);if(isNaN(x))return!1;F=new Intl.DateTimeFormat("en-CA",{timeZone:"Asia/Manila"}).format(x)}const E=new Intl.DateTimeFormat("en-CA",{timeZone:"Asia/Manila"}).format(new Date);return F===E}catch{return!1}})()?c.jsx("button",{className:"primary-btn",onClick:()=>{try{if(typeof r=="function"){try{r(o)}catch(R){console.error(R)}e&&e();return}C(!0)}catch(R){console.error(R)}},children:"Check Out"}):null,c.jsx("button",{className:"primary-btn",onClick:e,children:"Close"})]})]}),w&&c.jsx(zd,{open:w,onClose:()=>{C(!1)},memberId:d,initialEntry:o,onSuccess:()=>{C(!1),e&&e(),O()}})]})}function Eo(t,e=[]){if(t)for(const n of e){if(Object.prototype.hasOwnProperty.call(t,n))return t[n];const r=Object.keys(t).find(i=>i.toLowerCase().replace(/\s+/g,"")===n.toLowerCase().replace(/\s+/g,""));if(r)return t[r]}}function Yc(t){if(!t)return"";if(typeof t=="string")return t;const e=Eo(t,["NickName","nickname","Nick","nick","Nick_Name","Nick Name","name","Name"]);if(e&&String(e).trim())return String(e).trim();const n=Eo(t,["FirstName","firstname","first_name","first"])||"",r=Eo(t,["LastName","lastname","last_name","last"])||"",i=`${String(n).trim()} ${String(r).trim()}`.trim();if(i)return i;const s=Eo(t,["DisplayName","displayname","display"]);if(s&&String(s).trim())return String(s).trim();const a=Eo(t,["MemberID","memberid","member_id","id"])||"";return a&&String(a).trim()?String(a).trim():""}const{fetchMembers:iR,fetchPayments:sR,fetchGymEntries:aR,fetchProgressTracker:oR,fetchMemberBundle:S0,fetchPricing:x0,fetchMemberByIdFresh:lR}=Ae,uR=t=>String(t||"").trim().toLowerCase().replace(/\s+/g,"_"),gt=t=>Object.fromEntries(Object.entries(t||{}).map(([e,n])=>[uR(e),n])),be=(t,e)=>e.map(n=>t[n]).find(n=>n!==void 0&&n!==""),Yt=t=>{if(!t&&t!==0)return null;try{if(t&&typeof t.toDate=="function")return t.toDate()}catch{}if(t&&typeof t.seconds=="number")return new Date(t.seconds*1e3);if(t instanceof Date)return t;const e=new Date(t);return isNaN(e)?null:e},ms="Asia/Manila",Tl=t=>{if(!t)return"-";if(/^\d{1,2}:\d{2}\s?(AM|PM)$/i.test(t))return t;const e=new Date(t);if(!isNaN(e))return new Intl.DateTimeFormat("en-US",{timeZone:ms,hour:"2-digit",minute:"2-digit",hour12:!0}).format(e);const n=String(t).match(/(\d{2}):(\d{2})/);if(n){let r=parseInt(n[1],10),i=n[2],s=r>=12?"PM":"AM";return r=r%12||12,`${r}:${i} ${s}`}return"-"},bi=t=>{var e,n,r;if(!t)return"-";const i=t instanceof Date?t:new Date(t);if(isNaN(i))return"-";const s=new Intl.DateTimeFormat("en-US",{timeZone:ms,month:"short",day:"numeric",year:"numeric"}).formatToParts(i),a=((e=s.find(d=>d.type==="month"))==null?void 0:e.value)||"",u=((n=s.find(d=>d.type==="day"))==null?void 0:n.value)||"",o=((r=s.find(d=>d.type==="year"))==null?void 0:r.value)||"";return`${a}-${u}, ${o}`},Lt=t=>t==null||String(t).trim()===""?"-":String(t),cR=t=>{const e=String(t||"");if(!e)return"";const n=e.match(/https?:\/\/[^\s}]+/);if(n){const s=n[0];if(/googleusercontent\.com\//.test(s))return s;const a=s.match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return a&&a[1]?`https://drive.google.com/uc?export=view&id=${a[1]}`:s}if(/googleusercontent\.com\//.test(e))return e;const r=e.match(/\/file\/d\/([^/]+)/)||e.match(/[?&]id=([^&]+)/)||e.match(/\/uc\?[^#]*id=([^&]+)/),i=r?r[1]:"";return i?`https://drive.google.com/uc?export=view&id=${i}`:e},dR=t=>{const e=String(t||"").match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return e&&e[1]?e[1]:""},hR=t=>{const e=String(t||"");if(/googleusercontent\.com\//.test(e))return e;const n=dR(e);return n?`https://drive.google.com/thumbnail?id=${n}&sz=w1000`:e};function fR(){var t;const[e,n]=k.useState(null),{id:r,memberId:i}=fT(),s=Qa(),a=Us(),u=$e.useMemo(()=>{var ue;return(ue=a.state)!=null&&ue.row?gt(a.state.row):null},[(t=a.state)==null?void 0:t.row]),[o,d]=k.useState(u||null),[h,f]=k.useState(!u),[p,g]=k.useState(!1),[b,N]=k.useState(""),[D,v]=k.useState({membershipState:null,coachActive:!1,membershipEnd:null,coachEnd:null}),[w,C]=k.useState([]),[O,R]=k.useState([]),[F,E]=k.useState([]),[x,j]=k.useState([]),{membershipState:S,coachActive:_}=D,I=be(o,["student"]),T=typeof I=="string"?I.trim().toLowerCase().startsWith("y"):!!I,te=be(o,["lastname","last_name"]),K=be(o,["firstname","first_name"]);be(o,["middlename","middle_name"]),be(o,["gender"]);const Y=be(o,["birthday","birth_date","dob"]),ce=Yt(Y),L=be(o,["nick_name","nickname"]);be(o,["street"]),be(o,["brgy","barangay"]),be(o,["municipality","city"]),be(o,["email"]),be(o,["mobile","phone"]);const G=Yt(be(o,["member_since","membersince","join_date"])),z=String(be(o,["memberid","member_id","member_id_","id"])||"").trim(),$=be(o,["photourl","photo_url","photo"]),W=cR($),ee=hR(W),[Z,ie]=k.useState(!1),[P,V]=k.useState(!1),[U,q]=k.useState(!1),[se,me]=k.useState(!1),[ae,M]=k.useState(!1),[X,B]=k.useState(null),[de,re]=k.useState(!1),[pe,le]=k.useState(!1),[xe,Qe]=k.useState(null),[rt,ge]=k.useState(-1),[Ee,Me]=k.useState(!1),[He,Kt]=k.useState(20),[jt,fr]=k.useState(20),[zt,xn]=k.useState(20);k.useEffect(()=>{Me(!1)},[W]);const rn=ue=>{try{const Pe=gt(ue||{}),Ke=[Pe.timeout,Pe.time_out,Pe.timeOut,Pe.timeout,Pe.time_out_];for(const Te of Ke)if(Te&&String(Te).trim()!==""&&(Yt(Te)||/\d/.test(String(Te))))return!1;const ut=String((ue==null?void 0:ue.TimeOut)||(ue==null?void 0:ue.Time_Out)||(ue==null?void 0:ue.TimeOUT)||(ue==null?void 0:ue.Timeout)||"").trim();if(ut){try{if(Yt(ut))return!1}catch{}if(/\d/.test(ut))return!1}return!0}catch{return!0}},lt=$e.useRef(null),sn=()=>{lt.current&&clearTimeout(lt.current),lt.current=setTimeout(()=>{we(),lt.current=null},200)};if(k.useEffect(()=>{let ue=!0;(async()=>{const Te=decodeURIComponent(i||r||"").trim(),it=String(be(u||{},["memberid","member_id","id"])||"").trim(),Le=Te||it;if(!Le){f(!1);return}if(u){d(u),f(!1);try{sn(),typeof window<"u"&&setTimeout(()=>{try{sn()}catch{}},600)}catch{}return}async function Ot(){const[Ne,Xe]=await Promise.all([S0(Le,{ttlMs:0}),x0()]),et=Ne.member?gt(Ne.member):null,pt=(Ne.payments||[]).map(gt),nr=(Ne.gymEntries||[]).map(mr=>mr),eo=nr.map(gt),as=(Ne.progress||[]).map(gt);R(nr);const to=((Xe==null?void 0:Xe.rows)||(Xe==null?void 0:Xe.data)||[]).map(mr=>mr);return{m:et,pays:pt,gyms:eo,progs:as,pricingRows:to}}async function $t(){const[Ne,Xe,et,pt]=await Promise.all([iR(),sR(),aR(),oR()]),nr=((Ne==null?void 0:Ne.rows)??(Ne==null?void 0:Ne.data)??[]).map(gt).find(pr=>String(be(pr,["memberid","member_id","member_id_","id"])||"").trim().toLowerCase()===Le.toLowerCase())||null,eo=((Xe==null?void 0:Xe.rows)??(Xe==null?void 0:Xe.data)??[]).filter(pr=>String(be(gt(pr),["memberid","member_id","member_id_","id"])||"").trim().toLowerCase()===Le.toLowerCase()),as=((et==null?void 0:et.rows)??(et==null?void 0:et.data)??[]).filter(pr=>String(be(gt(pr),["memberid","member_id","member_id_","id"])||"").trim().toLowerCase()===Le.toLowerCase()),to=as.map(gt);R(as);const mr=((pt==null?void 0:pt.rows)??(pt==null?void 0:pt.data)??[]).filter(pr=>String(be(gt(pr),["memberid","member_id","member_id_","id"])||"").trim().toLowerCase()===Le.toLowerCase());return{m:nr,pays:eo,gyms:to,progs:mr}}try{let Ne;try{Ne=await Ot()}catch{Ne=await $t()}if(!ue)return;if(Ne.m){d(Ne.m);const Xe=String(be(Ne.m,["memberid","member_id","id"])||"").trim();E((Ne.pays||[]).map(gt).sort((et,pt)=>{const nr=Yt(be(et,["date","paid_on","created","timestamp"]))||new Date(0);return(Yt(be(pt,["date","paid_on","created","timestamp"]))||new Date(0))-nr})),C(Ne.gyms.map(et=>{const pt=gt(et);return{date:Yt(be(pt,["date"])),timeIn:be(pt,["timein","time_in"]),timeOut:be(pt,["timeout","time_out"]),totalHours:be(pt,["totalhours","total_hours","hours"]),coach:be(pt,["coach"]),focus:be(pt,["focus"]),raw:et,memberId:String(be(pt,["memberid","member_id","MemberID","id"])||"").trim()}}).filter(et=>!!et.date).sort((et,pt)=>pt.date-et.date)),j(Ne.progs.map(gt).sort((et,pt)=>{const nr=Yt(be(et,["date","recorded","log_date","timestamp"]))||new Date(0);return(Yt(be(pt,["date","recorded","log_date","timestamp"]))||new Date(0))-nr})),v(Yr((Ne.pays||[]).map(gt),Ne.m,Ne.pricingRows||[]))}else u||(d(null),N("Member not found"))}catch(Ne){ue&&!u&&N(Ne.message||"Failed to load member")}finally{ue&&f(!1)}})();const Pe=en.on("member:updated",Te=>{try{const it=Te&&Te.request?Te.request:Te,Le=String(be(it||{},["MemberID","memberid","member_id","id"])||"").trim(),Ot=decodeURIComponent(i||r||"").trim(),$t=String(be(u||{},["memberid","member_id","id"])||"").trim(),Ne=Ot||$t;Le&&Ne&&Le.toLowerCase()===Ne.toLowerCase()&&setTimeout(()=>sn(),120)}catch{}}),Ke=en.on("gymEntry:added",Te=>{try{const it=String(be(o||{},["memberid","member_id","id"])||"").trim();if(!it)return;const Le=String((Te==null?void 0:Te.MemberID)||(Te==null?void 0:Te.memberid)||(Te==null?void 0:Te.Member)||"").trim();Le&&Le===it&&sn()}catch{}}),ut=en.on("payment:added",Te=>{try{const it=String(be(o||{},["memberid","member_id","id"])||"").trim();if(!it)return;const Le=Te&&Te.request?Te.request:Te,Ot=Te&&Te.response?Te.response:null,$t=String((Le==null?void 0:Le.MemberID)||(Le==null?void 0:Le.memberid)||(Ot==null?void 0:Ot.MemberID)||(Ot==null?void 0:Ot.memberid)||(Le==null?void 0:Le.Member)||(Ot==null?void 0:Ot.Member)||"").trim();$t&&$t===it&&setTimeout(()=>sn(),120)}catch(it){console.debug("payment event handler error",it)}});return()=>{ue=!1;try{Pe()}catch{}try{Ke()}catch{}try{ut()}catch{}try{lt.current&&(clearTimeout(lt.current),lt.current=null)}catch{}}},[i,r,u]),h)return c.jsx("div",{className:"content",children:c.jsx(P_,{})});if(!o)return c.jsxs("div",{className:"content",children:[c.jsx("button",{className:"back-btn",onClick:()=>s(-1),children:" Back"}),c.jsx("div",{children:b||"Member not found"})]});async function we(){g(!0);try{const ue=String(z||"").trim();if(!ue)return;console.debug("refreshBundle: fetching bundle for",ue);const[Pe,Ke]=await Promise.all([S0(ue,{ttlMs:0}),x0()]);console.debug("refreshBundle: fetched bundle",Pe,Ke);const ut=Pe.member?gt(Pe.member):null,Te=(Pe.payments||[]).map(gt),it=(Pe.gymEntries||[]).map(Ne=>Ne),Le=it.map(gt),Ot=(Pe.progress||[]).map(gt);ut&&d(ut),R(it),E(Te.sort((Ne,Xe)=>{const et=Yt(be(Ne,["date","paid_on","created","timestamp"]))||new Date(0);return(Yt(be(Xe,["date","paid_on","created","timestamp"]))||new Date(0))-et})),C(Le.map(Ne=>{const Xe=gt(Ne);return{date:Yt(be(Xe,["date"])),timeIn:be(Xe,["timein","time_in"]),timeOut:be(Xe,["timeout","time_out"]),totalHours:be(Xe,["totalhours","total_hours","hours"]),coach:be(Xe,["coach"]),focus:be(Xe,["focus"]),raw:Ne,memberId:String(be(Xe,["memberid","member_id","MemberID","id"])||"").trim()}}).filter(Ne=>!!Ne.date).sort((Ne,Xe)=>Xe.date-Ne.date)),j(Ot.sort((Ne,Xe)=>{const et=Yt(be(Ne,["date","recorded","log_date","timestamp"]))||new Date(0);return(Yt(be(Xe,["date","recorded","log_date","timestamp"]))||new Date(0))-et}));const $t=((Ke==null?void 0:Ke.rows)||(Ke==null?void 0:Ke.data)||[]).map(Ne=>Ne);v(Yr(Te,ue,$t))}catch(ue){console.error("refreshBundle failed",ue);try{N(String((ue==null?void 0:ue.message)||ue||"Failed to refresh member data"))}catch{}}finally{g(!1)}}const ze=new Intl.DateTimeFormat("en-CA",{timeZone:ms,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date),Bt=(w||[]).find(ue=>{try{const Pe=ue==null?void 0:ue.date;if(!Pe)return!1;const Ke=new Date(Pe);return new Intl.DateTimeFormat("en-CA",{timeZone:ms,year:"numeric",month:"2-digit",day:"2-digit"}).format(Ke)!==ze?!1:rn(ue)}catch{return!1}}),vt=(O||[]).find(ue=>{try{const Pe=gt(ue||{}),Ke=be(Pe,["date","Date","log_date","date_time"]);if(!Ke)return!1;const ut=new Date(Ke);return new Intl.DateTimeFormat("en-CA",{timeZone:ms,year:"numeric",month:"2-digit",day:"2-digit"}).format(ut)!==ze?!1:rn(ue)}catch{return!1}})||null,fn=!!Bt||!!vt,Tn=(w||[]).length,ns=Tn?1:0,an=Math.min(He||0,Tn),rs=(x||[]).length,is=rs?1:0,ss=Math.min(jt||0,rs),$s=(F||[]).length,$d=$s?1:0,ni=Math.min(zt||0,$s);return c.jsxs("div",{className:"content",children:[c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[c.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[c.jsx("button",{className:"back-btn",onClick:()=>s(-1),children:" Back"}),c.jsxs("div",{style:{display:"flex",gap:8},children:[c.jsx("button",{className:"back-btn",onClick:()=>{Qe("in"),le(!0)},disabled:!(!fn&&S==="active"),title:fn?"Member already has an open visit for today":S==="active"?"Check in":"Gym membership is not active",style:{opacity:!fn&&S==="active"?1:.5,cursor:!fn&&S==="active"?"pointer":"not-allowed"},children:"Check In"}),c.jsx("button",{className:"back-btn",onClick:()=>{Qe("out"),le(!0)},disabled:!fn,title:fn?"Member has an open visit today  checkout":"No open visit to check out",style:{opacity:fn?1:.5,cursor:fn?"pointer":"not-allowed"},children:"Check Out"})]})]})}),c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginTop:8,marginBottom:8},children:[c.jsx("h2",{style:{margin:0},children:Lt(Yc(o)||L||K||"Member")}),c.jsx("div",{children:c.jsx(Vd,{show:p&&!h})})]})]}),c.jsx(GO,{member:o,status:D,isRefreshing:p,onEdit:()=>V(!0),onAddPayment:()=>ie(!0),onShowQr:()=>q(!0),onShowProgress:()=>me(!0),onCheckIn:()=>{Qe("in"),le(!0)}}),c.jsx(fO,{open:Z,onClose:()=>ie(!1),memberId:z,onSaved:()=>{ie(!1),we()},membershipEnd:D.membershipEnd,coachEnd:D.coachEnd,isStudent:T,birthDate:ce}),c.jsx(CO,{open:P,onClose:()=>V(!1),member:o,onSaved:ue=>{V(!1);try{if(ue){const Pe=gt(ue)||{},Ke=Object.fromEntries(Object.entries(Pe).filter(([ut,Te])=>Te!=null&&String(Te).trim()!==""));Object.keys(Ke).length&&d(ut=>({...ut||{},...Ke}))}}catch(Pe){console.debug("onSaved merge error",Pe)}(async()=>{try{const Pe=String(be(ue||o||{},["memberid","member_id","id","MemberID"])||"").trim();if(Pe)try{const Ke=await lR(Pe);if(Ke)try{const ut=gt(Ke)||{},Te=Object.fromEntries(Object.entries(ut).filter(([it,Le])=>Le!=null&&String(Le).trim()!==""));if(Object.keys(Te).length)d(it=>({...it||{},...Te}));else try{we()}catch{}}catch{try{we()}catch{}}}catch{try{we()}catch{}}else try{we()}catch{}}catch{try{we()}catch{}}})()}}),c.jsx(MO,{open:U,onClose:()=>q(!1),memberId:z,nickname:L||K||"",firstName:K||"",lastName:te||"",memberSince:G||null,photo:ee}),c.jsx(UO,{open:se,onClose:()=>me(!1),memberId:z,memberNick:L||K||"",memberSinceYMD:G?`${G.getFullYear()}-${String(G.getMonth()+1).padStart(2,"0")}-${String(G.getDate()).padStart(2,"0")}`:"",onSaved:()=>{me(!1),we()}}),c.jsx(BO,{open:ae,onClose:()=>{M(!1),ge(-1)},row:rt>=0?x[rt]:null,memberNick:L||K||""}),c.jsxs("div",{className:"panel",children:[c.jsx("div",{className:"panel-header",children:"Gym Visits"}),c.jsxs("table",{className:"aligned",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Date"}),c.jsx("th",{children:"Time In"}),c.jsx("th",{children:"Time Out"}),c.jsx("th",{children:"Total Hours"}),c.jsx("th",{children:"Coach"}),c.jsx("th",{children:"Focus"})]})}),c.jsx("tbody",{children:w.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:6,children:"-"})}):w.slice(0,He).map((ue,Pe)=>c.jsxs("tr",{style:{cursor:"pointer"},onClick:()=>n(ue),children:[c.jsx("td",{children:bi(ue.date)}),c.jsx("td",{children:Tl(ue.timeIn)}),c.jsx("td",{children:Tl(ue.timeOut)}),c.jsx("td",{children:Lt(ue.totalHours)}),c.jsx("td",{children:Lt(ue.coach)}),c.jsx("td",{children:Lt(ue.focus)})]},Pe))})]}),c.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8},children:c.jsx("div",{className:"table-range",children:Tn===0?"Showing 0 of 0":`Showing ${ns}${an} of ${Tn}`})}),w.length>He&&c.jsx("div",{style:{textAlign:"center",marginTop:8},children:c.jsx("button",{className:"button",onClick:()=>Kt(ue=>ue<w.length?Math.min(ue+20,w.length):20),children:He<w.length?`Load ${Math.min(20,w.length-He)} more`:"Show less"})})]}),e&&c.jsx(Fg,{open:!!e,onClose:()=>n(null),row:e,onCheckout:ue=>{try{const Pe=(O||[]).find(Ke=>{try{const ut=gt(Ke||{}),Te=be(ut,["date","Date","log_date","date_time"]),it=be(ut,["timein","TimeIn","time_in"]);if(!Te)return!1;const Le=new Date(Te),Ot=new Date((ue==null?void 0:ue.date)||(ue==null?void 0:ue.Date)||(ue==null?void 0:ue.date_time)||""),$t=new Intl.DateTimeFormat("en-CA",{timeZone:ms,year:"numeric",month:"2-digit",day:"2-digit"}).format(Le),Ne=new Intl.DateTimeFormat("en-CA",{timeZone:ms,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date(Ot));if($t!==Ne)return!1;if(it&&(ue!=null&&ue.timeIn||ue!=null&&ue.TimeIn)){const Xe=String(it).trim(),et=String(ue.timeIn||ue.TimeIn||ue.timein||"").trim();if(Xe&&et&&Xe.indexOf(et)===-1&&et.indexOf(Xe)===-1)return!1}return!0}catch{return!1}})||null;B(Pe)}catch{B(null)}Qe("out"),le(!0)}}),c.jsx(zd,{open:!!pe,memberId:z,initialEntry:xe==="out"?X||vt:null,mode:xe,onClose:()=>{le(!1),Qe(null),B(null)},status:D,onSuccess:async()=>{le(!1),Qe(null),B(null);try{await sn()}catch{}}}),w.length>200&&c.jsx("div",{style:{textAlign:"center",marginTop:8},children:c.jsx("button",{className:"button",onClick:()=>re(ue=>!ue),children:de?"Show less":`Show all (${w.length})`})}),c.jsxs("div",{className:"panel",children:[c.jsx("div",{className:"panel-header",children:"Progress"}),c.jsxs("table",{className:"aligned",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Date"}),c.jsx("th",{children:"No"}),c.jsx("th",{children:"Weight"}),c.jsx("th",{children:"BMI"}),c.jsx("th",{children:"Muscle Mass"}),c.jsx("th",{children:"Body Fat"})]})}),c.jsx("tbody",{children:x.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:6,children:"-"})}):x.slice(0,jt).map((ue,Pe)=>{const Ke=Yt(be(ue,["date","recorded","log_date","timestamp"])),ut=be(ue,["no","entry_no","seq","number"]),Te=be(ue,["weight","weight_kg","weight_lbs","weight_(lbs)","weight_(kg)","weight(lbs)","weightkg","weightlbs"]),it=be(ue,["bmi"]),Le=be(ue,["musclemass","muscle_mass","muscle"]),Ot=be(ue,["bodyfat","body_fat","bf"]);return c.jsxs("tr",{style:{cursor:"pointer"},onClick:()=>{ge(Pe),M(!0)},children:[c.jsx("td",{children:bi(Ke)}),c.jsx("td",{children:Lt(ut)}),c.jsx("td",{children:Lt(Te)}),c.jsx("td",{children:Lt(it)}),c.jsx("td",{children:Lt(Le)}),c.jsx("td",{children:Lt(Ot)})]},Pe)})})]}),c.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8},children:c.jsx("div",{className:"table-range",children:rs===0?"Showing 0 of 0":`Showing ${is}${ss} of ${rs}`})}),x.length>jt&&c.jsx("div",{style:{textAlign:"center",marginTop:8},children:c.jsx("button",{className:"button",onClick:()=>fr(ue=>ue<x.length?Math.min(ue+20,x.length):20),children:jt<x.length?`Load ${Math.min(20,x.length-jt)} more`:"Show less"})})]}),c.jsxs("div",{className:"panel",children:[c.jsx("div",{className:"panel-header",children:"Payments"}),c.jsxs("table",{className:"aligned payments-table",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Date"}),c.jsx("th",{children:"Particulars"}),c.jsxs("th",{children:["Gym Membership",c.jsx("br",{}),c.jsx("span",{className:"th-sub",children:"Valid Until"})]}),c.jsxs("th",{children:["Coach Subscription",c.jsx("br",{}),c.jsx("span",{className:"th-sub",children:"Valid Until"})]}),c.jsx("th",{children:"Mode"}),c.jsx("th",{children:"Cost"})]})}),c.jsx("tbody",{children:F.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:6,children:"-"})}):F.slice(0,zt).map((ue,Pe)=>{const Ke=Yt(be(ue,["date","paid_on","created","timestamp"])),ut=be(ue,["particulars","type","item","category","product","paymentfor","plan","description"]),Te=Yt(be(ue,["gymvaliduntil","gym_valid_until","gym_until"])),it=Yt(be(ue,["coachvaliduntil","coach_valid_until","coach_until"])),Le=be(ue,["mode","payment_mode","method","via"]),Ot=be(ue,["cost","amount","price","total","paid"]);return c.jsxs("tr",{children:[c.jsx("td",{children:bi(Ke)}),c.jsx("td",{children:Lt(ut)}),c.jsx("td",{children:bi(Te)}),c.jsx("td",{children:bi(it)}),c.jsx("td",{children:Lt(Le)}),c.jsx("td",{children:Lt(Ot)})]},Pe)})})]}),c.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8},children:c.jsx("div",{className:"table-range",children:$s===0?"Showing 0 of 0":`Showing ${$d}${ni} of ${$s}`})}),F.length>zt&&c.jsx("div",{style:{textAlign:"center",marginTop:8},children:c.jsx("button",{className:"button",onClick:()=>xn(ue=>ue<F.length?Math.min(ue+20,F.length):20),children:zt<F.length?`Load ${Math.min(20,F.length-zt)} more`:"Show less"})})]})]})}const mR=t=>String(t||"").trim().toLowerCase().replace(/\s+/g,"_"),pR=t=>Object.fromEntries(Object.entries(t||{}).map(([e,n])=>[mR(e),n])),gR=(t,e)=>{try{const n=t||{};for(const r of e){if(Object.prototype.hasOwnProperty.call(n,r))return n[r];const i=Object.keys(n).find(s=>s.toLowerCase().replace(/\s+/g,"")===r.toLowerCase().replace(/\s+/g,""));if(i)return n[i]}}catch{}},C0=t=>{if(!t&&t!==0)return null;try{if(t&&typeof t.toDate=="function")return t.toDate()}catch{}if(t&&typeof t.seconds=="number")return new Date(t.seconds*1e3);if(t instanceof Date)return t;const e=new Date(t);return isNaN(e)?null:e},_0=t=>{try{const e=pR(t||{}),n=[e.timeout,e.time_out,e.timeOut,e.time_out_];for(const i of n)if(i&&String(i).trim()!==""&&(C0(i)||/\d/.test(String(i))))return!1;const r=String((t==null?void 0:t.TimeOut)||(t==null?void 0:t.Time_Out)||(t==null?void 0:t.TimeOUT)||(t==null?void 0:t.Timeout)||"").trim();if(r){try{if(C0(r))return!1}catch{}if(/\d/.test(r))return!1}return!0}catch{return!0}};function jm(t){try{const e=new Set;return(t||[]).forEach(n=>{try{let r=String((n==null?void 0:n.MemberID)||(n==null?void 0:n.memberid)||(n==null?void 0:n.Member)||(n==null?void 0:n.member)||(n==null?void 0:n.id)||"").trim().toLowerCase();r||(r=String((n==null?void 0:n.NickName)||(n==null?void 0:n.nickname)||(n==null?void 0:n.Nick)||(n==null?void 0:n.nick)||(n==null?void 0:n.MemberName)||(n==null?void 0:n.member_name)||"").trim().toLowerCase());let i=String((n==null?void 0:n.Coach)||(n==null?void 0:n.coach)||(n==null?void 0:n.coach_name)||"").trim().toLowerCase()||"none";try{i=i.replace(/\bcoach\b/g,"").replace(/\s+/g,"").trim()||"none"}catch{}const s=(n==null?void 0:n.Date)||(n==null?void 0:n.date)||(n==null?void 0:n.time_in)||(n==null?void 0:n.Timestamp)||"";let a="";if(s&&typeof s=="string"&&/^\d{4}-\d{2}-\d{2}/.test(s))a=s.slice(0,10);else if(s&&typeof s=="string")try{a=new Date(s).toISOString().slice(0,10)}catch{a=String(s).slice(0,10)}r&&a&&e.add(`${r}::${i}::${a}`)}catch{}}),e.size}catch{return(t||[]).length}}const{fetchMembers:qh,fetchPayments:k0,fetchGymEntries:E0,fetchGymEntriesFresh:Wh,fetchPricing:N0,fetchDashboard:yR}=Ae;function Au(){return new Date().toLocaleDateString("en-CA",{year:"numeric",month:"2-digit",day:"2-digit"})}const Fn=(t,e)=>gR(t,e);function vR(){const[t,e]=k.useState({totalMembers:0,activeGym:0,activeCoach:0,visitedToday:0,coachToday:0,checkedIn:0,cashToday:0,gcashToday:0}),[n,r]=k.useState(!0),[i,s]=k.useState(!1),[a,u]=k.useState([]),[o,d]=k.useState([]),[h,f]=k.useState([]),[p,g]=k.useState([]),[b,N]=k.useState(!1),[D,v]=k.useState(!1),[w,C]=k.useState(20),[O,R]=k.useState(20),[F,E]=k.useState(null),[x,j]=k.useState(!1),[S,_]=k.useState(null),[I,T]=k.useState(null),te=k.useMemo(()=>{const Z=(h||[]).filter(ie=>{const P=ie.Date||ie.date;return(P?new Date(P).toLocaleDateString("en-CA",{year:"numeric",month:"2-digit",day:"2-digit"}):"")===Au()});return Z.sort((ie,P)=>{const V=String(Fn(ie,["TimeOut","timeout","time_out"])||"").trim(),U=String(Fn(P,["TimeOut","timeout","time_out"])||"").trim(),q=V===""||V==="-"||V==="",se=U===""||U==="-"||U==="";if(q&&!se)return-1;if(!q&&se)return 1;const me=String(Fn(ie,["TimeIn","timein","time_in"])||"").trim(),ae=String(Fn(P,["TimeIn","timein","time_in"])||"").trim();return String(ae).localeCompare(String(me))}),Z.map((ie,P)=>{const V=String(Fn(ie,["MemberID","memberid","member_id","member","id"])||"").trim(),U=(a||[]).find(M=>String(Fn(M,["MemberID","memberid","member_id","id"])||"").trim()===V),q=Fn(ie,["TimeIn","timein","time_in"])||"",se=Fn(ie,["TimeOut","timeout","time_out"])||"",me=String(se).trim()===""||String(se).trim()==="-"||String(se).trim()==="",ae=Fn(ie,["TotalHours","totalhours","NoOfHours","noofhours","hours"])||"";return c.jsxs("tr",{style:{cursor:"pointer"},onClick:()=>E(ie),children:[c.jsx("td",{className:"td-fullname",style:{textAlign:"left"},children:c.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:8},children:[c.jsx("span",{children:Yc(U)}),me&&c.jsx("span",{className:"status-badge on",children:"On"})]})}),c.jsx("td",{children:Tl(q)}),c.jsx("td",{children:Tl(se)}),c.jsx("td",{children:Lt(ae)}),c.jsx("td",{children:Lt(ie.Coach||ie.coach)}),c.jsx("td",{children:Lt(ie.Focus||ie.focus)})]},P)})},[h,a]),K=(te||[]).length,Y=K?1:0,ce=Math.min(w||0,K),L=(Z,ie,P,V)=>{const U=new Map,q=ge=>{const Ee=String(ge??"").trim().toLowerCase();return Ee==="yes"||Ee==="y"||Ee==="true"||Ee==="1"},se=(ge,Ee)=>{for(const Me of Ee){if(ge&&Object.prototype.hasOwnProperty.call(ge,Me))return ge[Me];const He=Object.keys(ge||{}).find(Kt=>Kt.toLowerCase().replace(/\s+/g,"")===Me.toLowerCase().replace(/\s+/g,""));if(He)return ge[He]}};(V||[]).forEach(ge=>{const Ee=String(se(ge,["Particulars"])||"").trim();if(!Ee)return;const Me=q(se(ge,["Gym membership","Gym Membership","GymMembership","Membership"])),He=q(se(ge,["Coach subscription","Coach Subscription","CoachSubscription","Coach"]));U.set(Ee.toLowerCase(),{gym:Me,coach:He})});const me=new Map;(ie||[]).forEach(ge=>{const Ee=String(ge.MemberID||ge.member_id||ge.id||ge.member||"").trim();Ee&&(me.has(Ee)||me.set(Ee,[]),me.get(Ee).push(ge))});let ae=0,M=0;for(const ge of Z||[]){const Ee=String(ge.MemberID||ge.member_id||ge.id||"").trim(),Me=me.get(Ee)||[],He=Yr(Me,ge,V);if(He.membershipState!=="active")if((ge.membershipState||ge.membership_state||ge.status||"").toLowerCase()==="active")He.membershipState="active";else{const Kt=se(ge,["membershipEnd","membership_end","gymvaliduntil","gym_valid_until","gym_until","enddate","end_date","valid_until","expiry","expires","until","end","gym_valid","gym_validity","gymvalid"]);if(Kt){const jt=new Date(Kt);if(!isNaN(jt)){jt.setHours(0,0,0,0);const fr=new Date;fr.setHours(0,0,0,0),jt>=fr&&(He.membershipState="active")}}}He.membershipState==="active"&&ae++,He.coachActive&&M++}const X=Au(),B=(P||[]).filter(ge=>{const Ee=ge.Date||ge.date;return Ee?new Date(Ee).toLocaleDateString("en-CA",{year:"numeric",month:"2-digit",day:"2-digit"})===X:!1}),de=new Set(B.map(ge=>String(ge.MemberID||ge.member_id||ge.id||"").trim()).filter(Boolean)).size,re=jm(B),pe=new Set;for(const ge of B){const Ee=String(Fn(ge,["TimeIn","timein","time_in"])||"").trim(),Me=String(Fn(ge,["MemberID","memberid","member_id","id"])||"").trim(),He=!_0(ge);Ee&&!He&&Me&&pe.add(Me)}const le=pe.size;let xe=0,Qe=0,rt=0;for(const ge of ie||[]){const Ee=ge.Date||ge.date||ge.pay_date;if(!Ee||new Date(Ee).toLocaleDateString("en-CA",{year:"numeric",month:"2-digit",day:"2-digit"})!==X)continue;const Me=parseFloat(ge.Cost||ge.amount||0)||0;rt+=Me;const He=String(ge.Mode||ge.mode||ge.method||"").toLowerCase();He==="cash"&&(xe+=Me),He==="gcash"&&(Qe+=Me)}return{totalMembers:(Z||[]).length,activeGym:ae,activeCoach:M,visitedToday:de,coachToday:re,checkedIn:le,cashToday:xe,gcashToday:Qe,totalPaymentsToday:rt}},G=k.useMemo(()=>{const Z=Au(),ie=V=>V.Date||V.date||V.pay_date||V.created||V.timestamp||null,P=V=>{if(!V&&V!==0)return 0;if(typeof V=="number")return V;try{if(V&&typeof V.seconds=="number")return V.seconds*1e3}catch{}const U=Date.parse(String(V));return isNaN(U)?0:U};return(o||[]).filter(V=>{const U=ie(V);return(U?new Date(U).toLocaleDateString("en-CA",{year:"numeric",month:"2-digit",day:"2-digit"}):"")===Z}).sort((V,U)=>{const q=P(ie(V));return(P(ie(U))||0)-(q||0)}).map((V,U)=>{const q=(a||[]).find(X=>{const B=String(V.MemberID||V.member_id||V.id||V.member||"").trim();return B?String(X.MemberID||X.member_id||X.id||"").trim()===B:!1}),se=V.gymvaliduntil||V.GymValidUntil||V.gym_valid_until||V.gym_until||V.EndDate||V.Enddate||V.enddate||V.end_date||V.end||V.valid_until||V.expiry||V.expires||V.until||"",me=V.coachvaliduntil||V.CoachValidUntil||V.coach_valid_until||V.coach_until||"",ae=bi(se),M=bi(me);return c.jsxs("tr",{children:[c.jsx("td",{children:Yc(q)}),c.jsx("td",{children:Lt(V.Particulars||V.particulars||V.type||V.item||V.category||V.product||V.paymentfor||V.plan||V.description)}),c.jsx("td",{children:Lt(ae)}),c.jsx("td",{children:Lt(M)}),c.jsx("td",{children:Lt(V.Mode||V.mode||V.method)}),c.jsx("td",{children:Lt((parseFloat(V.Cost||V.amount||0)||0).toLocaleString())})]},U)})},[o,a]),z=(G||[]).length,$=z?1:0,W=Math.min(O||0,z);k.useEffect(()=>{async function Z(){r(!0);try{const xe=await yR();if(xe&&xe.ok){const{totalMembers:Qe=0,activeGym:rt=0,activeCoach:ge=0,visitedToday:Ee=0,coachToday:Me=0,checkedIn:He=0,cashToday:Kt=0,gcashToday:jt=0,totalPaymentsToday:fr=0}=xe;e({totalMembers:Qe,activeGym:rt,activeCoach:ge,visitedToday:Ee,coachToday:Me,checkedIn:He,cashToday:Kt,gcashToday:jt,totalPaymentsToday:fr}),r(!1),(async()=>{s(!0);try{const[zt,xn,rn,lt]=await Promise.all([qh(),k0(),E0(),N0()]);u((zt==null?void 0:zt.rows)||(zt==null?void 0:zt.data)||[]),d((xn==null?void 0:xn.rows)||(xn==null?void 0:xn.data)||[]),f((rn==null?void 0:rn.rows)||(rn==null?void 0:rn.data)||[]),g((lt==null?void 0:lt.rows)||(lt==null?void 0:lt.data)||[]);try{const sn=L((zt==null?void 0:zt.rows)||(zt==null?void 0:zt.data)||[],(xn==null?void 0:xn.rows)||(xn==null?void 0:xn.data)||[],(rn==null?void 0:rn.rows)||(rn==null?void 0:rn.data)||[],(lt==null?void 0:lt.rows)||(lt==null?void 0:lt.data)||[]);e(sn)}catch(sn){console.warn("Failed to recompute stats after background fetch",sn)}}catch{}finally{s(!1)}})();return}}catch{}s(!0);const[U,q,se,me]=await Promise.all([qh(),k0(),E0(),N0()]),ae=(U==null?void 0:U.rows)||(U==null?void 0:U.data)||[],M=(q==null?void 0:q.rows)||(q==null?void 0:q.data)||[],X=(se==null?void 0:se.rows)||(se==null?void 0:se.data)||[],B=(me==null?void 0:me.rows)||(me==null?void 0:me.data)||[];u(ae),d(M),f(X),g(B),s(!1);const de=ae,re=M,pe=X,le=B;e(xe=>({...xe,totalMembers:de.length})),setTimeout(()=>{const xe=new Map,Qe=we=>{const ze=String(we??"").trim().toLowerCase();return ze==="yes"||ze==="y"||ze==="true"||ze==="1"},rt=(we,ze)=>{for(const Bt of ze){if(we&&Object.prototype.hasOwnProperty.call(we,Bt))return we[Bt];const vt=Object.keys(we||{}).find(fn=>fn.toLowerCase().replace(/\s+/g,"")===Bt.toLowerCase().replace(/\s+/g,""));if(vt)return we[vt]}};le.forEach(we=>{const ze=String(rt(we,["Particulars"])||"").trim();if(!ze)return;const Bt=Qe(rt(we,["Gym membership","Gym Membership","GymMembership","Membership"])),vt=Qe(rt(we,["Coach subscription","Coach Subscription","CoachSubscription","Coach"]));xe.set(ze.toLowerCase(),{gym:Bt,coach:vt})});const ge=new Map;re.forEach(we=>{const ze=String(we.MemberID||we.member_id||we.id||we.member||"").trim();ze&&(ge.has(ze)||ge.set(ze,[]),ge.get(ze).push(we))});let Ee=0,Me=0;for(const we of de){const ze=String(we.MemberID||we.member_id||we.id||"").trim(),Bt=ge.get(ze)||[],vt=Yr(Bt,we,le);if(vt.membershipState!=="active")if((we.membershipState||we.membership_state||we.status||"").toLowerCase()==="active")vt.membershipState="active";else{const fn=rt(we,["membershipEnd","membership_end","gymvaliduntil","gym_valid_until","gym_until","enddate","end_date","valid_until","expiry","expires","until","end","gym_valid","gym_validity","gymvalid"]);if(fn){const Tn=new Date(fn);if(!isNaN(Tn)){Tn.setHours(0,0,0,0);const ns=new Date;ns.setHours(0,0,0,0),Tn>=ns&&(vt.membershipState="active")}}}vt.membershipState==="active"&&Ee++,vt.coachActive&&Me++}const He=Au(),Kt=[];for(const we of pe){const ze=we.Date||we.date;ze&&new Date(ze).toLocaleDateString("en-CA",{year:"numeric",month:"2-digit",day:"2-digit"})===He&&Kt.push(we)}const jt=new Set(Kt.map(we=>String(we.MemberID||we.member_id||we.id||"").trim()).filter(Boolean)).size,fr=jm(Kt),zt=new Set;for(const we of Kt){const ze=String(Fn(we,["TimeIn","timein","time_in"])||"").trim(),Bt=String(Fn(we,["MemberID","memberid","member_id","id"])||"").trim(),vt=!_0(we);ze&&!vt&&Bt&&zt.add(Bt)}const xn=zt.size;let rn=0,lt=0,sn=0;for(const we of re){const ze=we.Date||we.date||we.pay_date;if(!ze||new Date(ze).toLocaleDateString("en-CA",{year:"numeric",month:"2-digit",day:"2-digit"})!==He)continue;const Bt=parseFloat(we.Cost||we.amount||0)||0;sn+=Bt;const vt=String(we.Mode||we.mode||we.method||"").toLowerCase();vt==="cash"&&(rn+=Bt),vt==="gcash"&&(lt+=Bt)}e({totalMembers:de.length,activeGym:Ee,activeCoach:Me,visitedToday:jt,coachToday:fr,checkedIn:xn,cashToday:rn,gcashToday:lt,totalPaymentsToday:sn}),r(!1),setShowLoadingToast(!1)},20)}Z();const ie=en.on("gymEntry:added",async U=>{try{s(!0);const q=await Wh();f((q==null?void 0:q.rows)||(q==null?void 0:q.data)||[]),s(!1)}catch{}}),P=en.on("member:updated",async()=>{try{const U=await qh();u((U==null?void 0:U.rows)||(U==null?void 0:U.data)||[])}catch{}}),V=setInterval(async()=>{try{const U=await Wh();f((U==null?void 0:U.rows)||(U==null?void 0:U.data)||[])}catch{}},15e3);return()=>{ie(),P(),clearInterval(V)}},[]),k.useEffect(()=>{try{const Z=L(a||[],o||[],h||[],p||[]);e(Z)}catch(Z){console.warn("Failed to recompute stats on data change",Z)}},[a,o,h,p]);const ee=Z=>{if(!Z)return;const ie=String(Z.MemberID||Z.member_id||Z.id||Z.member||"").trim();ie&&(_(ie),T(Z||null),j(!0),E(null))};return c.jsxs("div",{className:"dashboard-content",children:[c.jsxs("h2",{className:"dashboard-title",children:["Daily Dashboard ",c.jsx(Vd,{show:i&&!n})]}),c.jsxs("div",{className:"dashboard-grid-3x3",children:[c.jsxs("div",{className:"dashboard-card",children:[c.jsx("div",{className:"dashboard-label",children:"Total Members"}),c.jsx("div",{className:"dashboard-value magenta",children:t.totalMembers})]}),c.jsxs("div",{className:"dashboard-card",children:[c.jsx("div",{className:"dashboard-label",children:"Active Gym Memberships"}),c.jsx("div",{className:"dashboard-value magenta",children:t.activeGym})]}),c.jsxs("div",{className:"dashboard-card",children:[c.jsx("div",{className:"dashboard-label",children:"Active Coach Subscriptions"}),c.jsx("div",{className:"dashboard-value magenta",children:t.activeCoach})]}),c.jsxs("div",{className:"dashboard-card",children:[c.jsx("div",{className:"dashboard-label",children:"Member Visits"}),c.jsx("div",{className:"dashboard-value magenta",children:t.visitedToday})]}),c.jsxs("div",{className:"dashboard-card",children:[c.jsx("div",{className:"dashboard-label",children:"Coaching Sessions"}),c.jsx("div",{className:"dashboard-value magenta",children:t.coachToday})]}),c.jsxs("div",{className:"dashboard-card",children:[c.jsx("div",{className:"dashboard-label",children:"Currently Checked-In"}),c.jsx("div",{className:"dashboard-value magenta",children:t.checkedIn})]}),c.jsxs("div",{className:"dashboard-card",children:[c.jsx("div",{className:"dashboard-label",children:"Cash Revenue"}),c.jsxs("div",{className:"dashboard-value magenta",children:[" ",t.cashToday.toLocaleString()]})]}),c.jsxs("div",{className:"dashboard-card",children:[c.jsx("div",{className:"dashboard-label",children:"GCash Revenue"}),c.jsxs("div",{className:"dashboard-value magenta",children:[" ",t.gcashToday.toLocaleString()]})]}),c.jsxs("div",{className:"dashboard-card",children:[c.jsx("div",{className:"dashboard-label",children:"Total Revenue"}),c.jsxs("div",{className:"dashboard-value magenta",children:[" ",(t.totalPaymentsToday||0).toLocaleString()]})]})]}),c.jsxs("div",{style:{marginTop:24},className:"panel",children:[c.jsx("div",{className:"panel-header",children:"Gym Entries Today"}),c.jsxs("table",{className:"aligned",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Nickname"}),c.jsx("th",{children:"Time In"}),c.jsx("th",{children:"Time Out"}),c.jsx("th",{children:"Total Hours"}),c.jsx("th",{children:"Coach"}),c.jsx("th",{children:"Focus"})]})}),c.jsx("tbody",{children:!te||Array.isArray(te)&&te.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:6,children:"-"})}):(te||[]).slice(0,w)})]}),c.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8},children:c.jsx("div",{className:"table-range",children:K===0?"Showing 0 of 0":`Showing ${Y}${ce} of ${K}`})}),K>w&&c.jsx("div",{style:{textAlign:"center",marginTop:8},children:c.jsx("button",{className:"button",onClick:()=>C(Z=>Z<K?Math.min(Z+20,K):20),children:w<K?`Load ${Math.min(20,K-w)} more`:"Show less"})})]}),c.jsx(Fg,{open:!!F,onClose:()=>E(null),row:F,onCheckout:Z=>ee(Z)}),c.jsx(zd,{open:x,memberId:S,initialEntry:I,onClose:()=>{j(!1),_(null),T(null)},onSuccess:async()=>{try{const Z=await Wh();f((Z==null?void 0:Z.rows)||(Z==null?void 0:Z.data)||[])}catch(Z){console.error(Z)}j(!1),_(null),T(null)}}),c.jsxs("div",{style:{marginTop:24},className:"panel",children:[c.jsx("div",{className:"panel-header",children:"Payments Today"}),c.jsxs("table",{className:"aligned payments-table",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Nickname"}),c.jsx("th",{children:"Particulars"}),c.jsxs("th",{children:["Gym Membership",c.jsx("br",{}),"Valid Until"]}),c.jsxs("th",{children:["Coach Subscription",c.jsx("br",{}),"Valid Until"]}),c.jsx("th",{children:"Mode"}),c.jsx("th",{children:"Cost"})]})}),c.jsx("tbody",{children:!G||Array.isArray(G)&&G.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:6,children:"-"})}):(G||[]).slice(0,O)})]}),c.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8},children:c.jsx("div",{className:"table-range",children:z===0?"Showing 0 of 0":`Showing ${$}${W} of ${z}`})}),z>O&&c.jsx("div",{style:{textAlign:"center",marginTop:8},children:c.jsx("button",{className:"button",onClick:()=>R(Z=>Z<z?Math.min(Z+20,z):20),children:O<z?`Load ${Math.min(20,z-O)} more`:"Show less"})})]}),n&&c.jsx("div",{style:{marginTop:24},children:"Loading"})]})}const bR="modulepreload",wR=function(t){return"/"+t},T0={},SR=function(t,e,n){let r=Promise.resolve();if(e&&e.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),a=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));r=Promise.allSettled(e.map(u=>{if(u=wR(u),u in T0)return;T0[u]=!0;const o=u.endsWith(".css"),d=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${d}`))return;const h=document.createElement("link");if(h.rel=o?"stylesheet":bR,o||(h.as="script"),h.crossOrigin="",h.href=u,a&&h.setAttribute("nonce",a),document.head.appendChild(h),o)return new Promise((f,p)=>{h.addEventListener("load",f),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(s){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s}return r.then(s=>{for(const a of s||[])a.status==="rejected"&&i(a.reason);return t().catch(i)})};var R_={exports:{}},L_={};/**
* @license React
* use-sync-external-store-shim.production.js
*
* Copyright (c) Meta Platforms, Inc. and affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var $a=k;function xR(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var CR=typeof Object.is=="function"?Object.is:xR,_R=$a.useState,kR=$a.useEffect,ER=$a.useLayoutEffect,NR=$a.useDebugValue;function TR(t,e){var n=e(),r=_R({inst:{value:n,getSnapshot:e}}),i=r[0].inst,s=r[1];return ER(function(){i.value=n,i.getSnapshot=e,Gh(i)&&s({inst:i})},[t,n,e]),kR(function(){return Gh(i)&&s({inst:i}),t(function(){Gh(i)&&s({inst:i})})},[t]),NR(n),n}function Gh(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!CR(t,n)}catch{return!0}}function IR(t,e){return e()}var jR=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?IR:TR;L_.useSyncExternalStore=$a.useSyncExternalStore!==void 0?$a.useSyncExternalStore:jR;R_.exports=L_;var AR=R_.exports;const F_=0,U_=1,V_=2,I0=3;var j0=Object.prototype.hasOwnProperty;function Am(t,e){var n,r;if(t===e)return!0;if(t&&e&&(n=t.constructor)===e.constructor){if(n===Date)return t.getTime()===e.getTime();if(n===RegExp)return t.toString()===e.toString();if(n===Array){if((r=t.length)===e.length)for(;r--&&Am(t[r],e[r]););return r===-1}if(!n||typeof t=="object"){r=0;for(n in t)if(j0.call(t,n)&&++r&&!j0.call(e,n)||!(n in e)||!Am(t[n],e[n]))return!1;return Object.keys(e).length===r}}return t!==t&&e!==e}const Ur=new WeakMap,ki=()=>{},wn=ki(),Dm=Object,qe=t=>t===wn,_r=t=>typeof t=="function",Qi=(t,e)=>({...t,...e}),z_=t=>_r(t.then),Qh={},Du={},Ug="undefined",Ql=typeof window!=Ug,Mm=typeof document!=Ug,DR=Ql&&"Deno"in window,MR=()=>Ql&&typeof window.requestAnimationFrame!=Ug,B_=(t,e)=>{const n=Ur.get(t);return[()=>!qe(e)&&t.get(e)||Qh,r=>{if(!qe(e)){const i=t.get(e);e in Du||(Du[e]=i),n[5](e,Qi(i,r),i||Qh)}},n[6],()=>!qe(e)&&e in Du?Du[e]:!qe(e)&&t.get(e)||Qh]};let Pm=!0;const PR=()=>Pm,[Om,Rm]=Ql&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[ki,ki],OR=()=>{const t=Mm&&document.visibilityState;return qe(t)||t!=="hidden"},RR=t=>(Mm&&document.addEventListener("visibilitychange",t),Om("focus",t),()=>{Mm&&document.removeEventListener("visibilitychange",t),Rm("focus",t)}),LR=t=>{const e=()=>{Pm=!0,t()},n=()=>{Pm=!1};return Om("online",e),Om("offline",n),()=>{Rm("online",e),Rm("offline",n)}},FR={isOnline:PR,isVisible:OR},UR={initFocus:RR,initReconnect:LR},A0=!$e.useId,Il=!Ql||DR,VR=t=>MR()?window.requestAnimationFrame(t):setTimeout(t,1),Kh=Il?k.useEffect:k.useLayoutEffect,Xh=typeof navigator<"u"&&navigator.connection,D0=!Il&&Xh&&(["slow-2g","2g"].includes(Xh.effectiveType)||Xh.saveData),Mu=new WeakMap,zR=t=>Dm.prototype.toString.call(t),Yh=(t,e)=>t===`[object ${e}]`;let BR=0;const Lm=t=>{const e=typeof t,n=zR(t),r=Yh(n,"Date"),i=Yh(n,"RegExp"),s=Yh(n,"Object");let a,u;if(Dm(t)===t&&!r&&!i){if(a=Mu.get(t),a)return a;if(a=++BR+"~",Mu.set(t,a),Array.isArray(t)){for(a="@",u=0;u<t.length;u++)a+=Lm(t[u])+",";Mu.set(t,a)}if(s){a="#";const o=Dm.keys(t).sort();for(;!qe(u=o.pop());)qe(t[u])||(a+=u+":"+Lm(t[u])+",");Mu.set(t,a)}}else a=r?t.toJSON():e=="symbol"?t.toString():e=="string"?JSON.stringify(t):""+t;return a},Vg=t=>{if(_r(t))try{t=t()}catch{t=""}const e=t;return t=typeof t=="string"?t:(Array.isArray(t)?t.length:t)?Lm(t):"",[t,e]};let $R=0;const Fm=()=>++$R;async function $_(...t){const[e,n,r,i]=t,s=Qi({populateCache:!0,throwOnError:!0},typeof i=="boolean"?{revalidate:i}:i||{});let a=s.populateCache;const u=s.rollbackOnError;let o=s.optimisticData;const d=p=>typeof u=="function"?u(p):u!==!1,h=s.throwOnError;if(_r(n)){const p=n,g=[],b=e.keys();for(const N of b)!/^\$(inf|sub)\$/.test(N)&&p(e.get(N)._k)&&g.push(N);return Promise.all(g.map(f))}return f(n);async function f(p){const[g]=Vg(p);if(!g)return;const[b,N]=B_(e,g),[D,v,w,C]=Ur.get(e),O=()=>{const te=D[g];return(_r(s.revalidate)?s.revalidate(b().data,p):s.revalidate!==!1)&&(delete w[g],delete C[g],te&&te[0])?te[0](V_).then(()=>b().data):b().data};if(t.length<3)return O();let R=r,F,E=!1;const x=Fm();v[g]=[x,0];const j=!qe(o),S=b(),_=S.data,I=S._c,T=qe(I)?_:I;if(j&&(o=_r(o)?o(T,_):o,N({data:o,_c:T})),_r(R))try{R=R(T)}catch(te){F=te,E=!0}if(R&&z_(R))if(R=await R.catch(te=>{F=te,E=!0}),x!==v[g][0]){if(E)throw F;return R}else E&&j&&d(F)&&(a=!0,N({data:T,_c:wn}));if(a&&!E)if(_r(a)){const te=a(R,T);N({data:te,error:wn,_c:wn})}else N({data:R,error:wn,_c:wn});if(v[g][1]=Fm(),Promise.resolve(O()).then(()=>{N({_c:wn})}),E){if(h)throw F;return}return R}}const M0=(t,e)=>{for(const n in t)t[n][0]&&t[n][0](e)},HR=(t,e)=>{if(!Ur.has(t)){const n=Qi(UR,e),r=Object.create(null),i=$_.bind(wn,t);let s=ki;const a=Object.create(null),u=(h,f)=>{const p=a[h]||[];return a[h]=p,p.push(f),()=>p.splice(p.indexOf(f),1)},o=(h,f,p)=>{t.set(h,f);const g=a[h];if(g)for(const b of g)b(f,p)},d=()=>{if(!Ur.has(t)&&(Ur.set(t,[r,Object.create(null),Object.create(null),Object.create(null),i,o,u]),!Il)){const h=n.initFocus(setTimeout.bind(wn,M0.bind(wn,r,F_))),f=n.initReconnect(setTimeout.bind(wn,M0.bind(wn,r,U_)));s=()=>{h&&h(),f&&f(),Ur.delete(t)}}};return d(),[t,i,d,s]}return[t,Ur.get(t)[4]]},qR=(t,e,n,r,i)=>{const s=n.errorRetryCount,a=i.retryCount,u=~~((Math.random()+.5)*(1<<(a<8?a:8)))*n.errorRetryInterval;!qe(s)&&a>s||setTimeout(r,u,i)},WR=Am,[H_,GR]=HR(new Map),QR=Qi({onLoadingSlow:ki,onSuccess:ki,onError:ki,onErrorRetry:qR,onDiscarded:ki,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:D0?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:D0?5e3:3e3,compare:WR,isPaused:()=>!1,cache:H_,mutate:GR,fallback:{}},FR),KR=(t,e)=>{const n=Qi(t,e);if(e){const{use:r,fallback:i}=t,{use:s,fallback:a}=e;r&&s&&(n.use=r.concat(s)),i&&a&&(n.fallback=Qi(i,a))}return n},XR=k.createContext({}),YR="$inf$",q_=Ql&&window.__SWR_DEVTOOLS_USE__,JR=q_?window.__SWR_DEVTOOLS_USE__:[],ZR=()=>{q_&&(window.__SWR_DEVTOOLS_REACT__=$e)},eL=t=>_r(t[1])?[t[0],t[1],t[2]||{}]:[t[0],null,(t[1]===null?t[2]:t[1])||{}],tL=()=>{const t=k.useContext(XR);return k.useMemo(()=>Qi(QR,t),[t])},nL=t=>(e,n,r)=>t(e,n&&((...i)=>{const[s]=Vg(e),[,,,a]=Ur.get(H_);if(s.startsWith(YR))return n(...i);const u=a[s];return qe(u)?n(...i):(delete a[s],u)}),r),rL=JR.concat(nL),iL=t=>function(...e){const n=tL(),[r,i,s]=eL(e),a=KR(n,s);let u=t;const{use:o}=a,d=(o||[]).concat(rL);for(let h=d.length;h--;)u=d[h](u);return u(r,i||a.fetcher||null,a)},sL=(t,e,n)=>{const r=e[t]||(e[t]=[]);return r.push(n),()=>{const i=r.indexOf(n);i>=0&&(r[i]=r[r.length-1],r.pop())}};ZR();const Jh=$e.use||(t=>{switch(t.status){case"pending":throw t;case"fulfilled":return t.value;case"rejected":throw t.reason;default:throw t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}),t}}),Zh={dedupe:!0},P0=Promise.resolve(wn),aL=(t,e,n)=>{const{cache:r,compare:i,suspense:s,fallbackData:a,revalidateOnMount:u,revalidateIfStale:o,refreshInterval:d,refreshWhenHidden:h,refreshWhenOffline:f,keepPreviousData:p}=n,[g,b,N,D]=Ur.get(r),[v,w]=Vg(t),C=k.useRef(!1),O=k.useRef(!1),R=k.useRef(v),F=k.useRef(e),E=k.useRef(n),x=()=>E.current,j=()=>x().isVisible()&&x().isOnline(),[S,_,I,T]=B_(r,v),te=k.useRef({}).current,K=qe(a)?qe(n.fallback)?wn:n.fallback[v]:a,Y=(ae,M)=>{for(const X in te){const B=X;if(B==="data"){if(!i(ae[B],M[B])&&(!qe(ae[B])||!i(ie,M[B])))return!1}else if(M[B]!==ae[B])return!1}return!0},ce=k.useMemo(()=>{const ae=!v||!e?!1:qe(u)?x().isPaused()||s?!1:o!==!1:u,M=le=>{const xe=Qi(le);return delete xe._k,ae?{isValidating:!0,isLoading:!0,...xe}:xe},X=S(),B=T(),de=M(X),re=X===B?de:M(B);let pe=de;return[()=>{const le=M(S());return Y(le,pe)?(pe.data=le.data,pe.isLoading=le.isLoading,pe.isValidating=le.isValidating,pe.error=le.error,pe):(pe=le,le)},()=>re]},[r,v]),L=AR.useSyncExternalStore(k.useCallback(ae=>I(v,(M,X)=>{Y(X,M)||ae()}),[r,v]),ce[0],ce[1]),G=!C.current,z=g[v]&&g[v].length>0,$=L.data,W=qe($)?K&&z_(K)?Jh(K):K:$,ee=L.error,Z=k.useRef(W),ie=p?qe($)?qe(Z.current)?W:Z.current:$:W,P=z&&!qe(ee)?!1:G&&!qe(u)?u:x().isPaused()?!1:s?qe(W)?!1:o:qe(W)||o,V=!!(v&&e&&G&&P),U=qe(L.isValidating)?V:L.isValidating,q=qe(L.isLoading)?V:L.isLoading,se=k.useCallback(async ae=>{const M=F.current;if(!v||!M||O.current||x().isPaused())return!1;let X,B,de=!0;const re=ae||{},pe=!N[v]||!re.dedupe,le=()=>A0?!O.current&&v===R.current&&C.current:v===R.current,xe={isValidating:!1,isLoading:!1},Qe=()=>{_(xe)},rt=()=>{const Ee=N[v];Ee&&Ee[1]===B&&delete N[v]},ge={isValidating:!0};qe(S().data)&&(ge.isLoading=!0);try{if(pe&&(_(ge),n.loadingTimeout&&qe(S().data)&&setTimeout(()=>{de&&le()&&x().onLoadingSlow(v,n)},n.loadingTimeout),N[v]=[M(w),Fm()]),[X,B]=N[v],X=await X,pe&&setTimeout(rt,n.dedupingInterval),!N[v]||N[v][1]!==B)return pe&&le()&&x().onDiscarded(v),!1;xe.error=wn;const Ee=b[v];if(!qe(Ee)&&(B<=Ee[0]||B<=Ee[1]||Ee[1]===0))return Qe(),pe&&le()&&x().onDiscarded(v),!1;const Me=S().data;xe.data=i(Me,X)?Me:X,pe&&le()&&x().onSuccess(X,v,n)}catch(Ee){rt();const Me=x(),{shouldRetryOnError:He}=Me;Me.isPaused()||(xe.error=Ee,pe&&le()&&(Me.onError(Ee,v,Me),(He===!0||_r(He)&&He(Ee))&&(!x().revalidateOnFocus||!x().revalidateOnReconnect||j())&&Me.onErrorRetry(Ee,v,Me,Kt=>{const jt=g[v];jt&&jt[0]&&jt[0](I0,Kt)},{retryCount:(re.retryCount||0)+1,dedupe:!0})))}return de=!1,Qe(),!0},[v,r]),me=k.useCallback((...ae)=>$_(r,R.current,...ae),[]);if(Kh(()=>{F.current=e,E.current=n,qe($)||(Z.current=$)}),Kh(()=>{if(!v)return;const ae=se.bind(wn,Zh);let M=0;x().revalidateOnFocus&&(M=Date.now()+x().focusThrottleInterval);const X=sL(v,g,(B,de={})=>{if(B==F_){const re=Date.now();x().revalidateOnFocus&&re>M&&j()&&(M=re+x().focusThrottleInterval,ae())}else if(B==U_)x().revalidateOnReconnect&&j()&&ae();else{if(B==V_)return se();if(B==I0)return se(de)}});return O.current=!1,R.current=v,C.current=!0,_({_k:w}),P&&(N[v]||(qe(W)||Il?ae():VR(ae))),()=>{O.current=!0,X()}},[v]),Kh(()=>{let ae;function M(){const B=_r(d)?d(S().data):d;B&&ae!==-1&&(ae=setTimeout(X,B))}function X(){!S().error&&(h||x().isVisible())&&(f||x().isOnline())?se(Zh).then(M):M()}return M(),()=>{ae&&(clearTimeout(ae),ae=-1)}},[d,h,f,v]),k.useDebugValue(ie),s){const ae=v&&qe(W);if(!A0&&Il&&ae)throw new Error("Fallback data is required when using Suspense in SSR.");ae&&(F.current=e,E.current=n,O.current=!1);const M=D[v],X=!qe(M)&&ae?me(M):P0;if(Jh(X),!qe(ee)&&ae)throw ee;const B=ae?se(Zh):P0;!qe(ie)&&ae&&(B.status="fulfilled",B.value=!0),Jh(B)}return{mutate:me,get data(){return te.data=!0,ie},get error(){return te.error=!0,ee},get isValidating(){return te.isValidating=!0,U},get isLoading(){return te.isLoading=!0,q}}},oL=iL(aL);function Um(){return Um=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Um.apply(null,arguments)}function O0(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Vm(t,e){return Vm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},Vm(t,e)}function lL(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,Vm(t,e)}var R0=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function uL(t,e){return!!(t===e||R0(t)&&R0(e))}function cL(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!uL(t[n],e[n]))return!1;return!0}function ef(t,e){e===void 0&&(e=cL);var n,r=[],i,s=!1;function a(){for(var u=[],o=0;o<arguments.length;o++)u[o]=arguments[o];return s&&n===this&&e(u,r)||(i=t.apply(this,u),s=!0,n=this,r=u),i}return a}var dL=typeof performance=="object"&&typeof performance.now=="function",L0=dL?function(){return performance.now()}:function(){return Date.now()};function F0(t){cancelAnimationFrame(t.id)}function hL(t,e){var n=L0();function r(){L0()-n>=e?t.call(null):i.id=requestAnimationFrame(r)}var i={id:requestAnimationFrame(r)};return i}var tf=-1;function U0(t){if(t===void 0&&(t=!1),tf===-1||t){var e=document.createElement("div"),n=e.style;n.width="50px",n.height="50px",n.overflow="scroll",document.body.appendChild(e),tf=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return tf}var Xs=null;function V0(t){if(t===void 0&&(t=!1),Xs===null||t){var e=document.createElement("div"),n=e.style;n.width="50px",n.height="50px",n.overflow="scroll",n.direction="rtl";var r=document.createElement("div"),i=r.style;return i.width="100px",i.height="100px",e.appendChild(r),document.body.appendChild(e),e.scrollLeft>0?Xs="positive-descending":(e.scrollLeft=1,e.scrollLeft===0?Xs="negative":Xs="positive-ascending"),document.body.removeChild(e),Xs}return Xs}var fL=150,mL=function(t,e){return t};function pL(t){var e,n=t.getItemOffset,r=t.getEstimatedTotalSize,i=t.getItemSize,s=t.getOffsetForIndexAndAlignment,a=t.getStartIndexForOffset,u=t.getStopIndexForStartIndex,o=t.initInstanceProps,d=t.validateProps;return e=function(h){lL(f,h);function f(g){var b;return b=h.call(this,g)||this,b._instanceProps=o(b.props,O0(b)),b._outerRef=void 0,b._resetIsScrollingTimeoutId=null,b.state={instance:O0(b),isScrolling:!1,scrollDirection:"forward",scrollOffset:typeof b.props.initialScrollOffset=="number"?b.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},b._callOnItemsRendered=void 0,b._callOnItemsRendered=ef(function(N,D,v,w){return b.props.onItemsRendered({overscanStartIndex:N,overscanStopIndex:D,visibleStartIndex:v,visibleStopIndex:w})}),b._callOnScroll=void 0,b._callOnScroll=ef(function(N,D,v){return b.props.onScroll({scrollDirection:N,scrollOffset:D,scrollUpdateWasRequested:v})}),b._getItemStyle=void 0,b._getItemStyle=function(N){var D=b.props,v=D.direction,w=D.itemSize,C=D.layout,O=b._getItemStyleCache(w,C,v),R;if(O.hasOwnProperty(N))R=O[N];else{var F=n(b.props,N,b._instanceProps),E=i(b.props,N,b._instanceProps),x=v==="horizontal"||C==="horizontal",j=v==="rtl",S=x?F:0;O[N]=R={position:"absolute",left:j?void 0:S,right:j?S:void 0,top:x?0:F,height:x?"100%":E,width:x?E:"100%"}}return R},b._getItemStyleCache=void 0,b._getItemStyleCache=ef(function(N,D,v){return{}}),b._onScrollHorizontal=function(N){var D=N.currentTarget,v=D.clientWidth,w=D.scrollLeft,C=D.scrollWidth;b.setState(function(O){if(O.scrollOffset===w)return null;var R=b.props.direction,F=w;if(R==="rtl")switch(V0()){case"negative":F=-w;break;case"positive-descending":F=C-v-w;break}return F=Math.max(0,Math.min(F,C-v)),{isScrolling:!0,scrollDirection:O.scrollOffset<F?"forward":"backward",scrollOffset:F,scrollUpdateWasRequested:!1}},b._resetIsScrollingDebounced)},b._onScrollVertical=function(N){var D=N.currentTarget,v=D.clientHeight,w=D.scrollHeight,C=D.scrollTop;b.setState(function(O){if(O.scrollOffset===C)return null;var R=Math.max(0,Math.min(C,w-v));return{isScrolling:!0,scrollDirection:O.scrollOffset<R?"forward":"backward",scrollOffset:R,scrollUpdateWasRequested:!1}},b._resetIsScrollingDebounced)},b._outerRefSetter=function(N){var D=b.props.outerRef;b._outerRef=N,typeof D=="function"?D(N):D!=null&&typeof D=="object"&&D.hasOwnProperty("current")&&(D.current=N)},b._resetIsScrollingDebounced=function(){b._resetIsScrollingTimeoutId!==null&&F0(b._resetIsScrollingTimeoutId),b._resetIsScrollingTimeoutId=hL(b._resetIsScrolling,fL)},b._resetIsScrolling=function(){b._resetIsScrollingTimeoutId=null,b.setState({isScrolling:!1},function(){b._getItemStyleCache(-1,null)})},b}f.getDerivedStateFromProps=function(g,b){return gL(g,b),d(g),null};var p=f.prototype;return p.scrollTo=function(g){g=Math.max(0,g),this.setState(function(b){return b.scrollOffset===g?null:{scrollDirection:b.scrollOffset<g?"forward":"backward",scrollOffset:g,scrollUpdateWasRequested:!0}},this._resetIsScrollingDebounced)},p.scrollToItem=function(g,b){b===void 0&&(b="auto");var N=this.props,D=N.itemCount,v=N.layout,w=this.state.scrollOffset;g=Math.max(0,Math.min(g,D-1));var C=0;if(this._outerRef){var O=this._outerRef;v==="vertical"?C=O.scrollWidth>O.clientWidth?U0():0:C=O.scrollHeight>O.clientHeight?U0():0}this.scrollTo(s(this.props,g,b,w,this._instanceProps,C))},p.componentDidMount=function(){var g=this.props,b=g.direction,N=g.initialScrollOffset,D=g.layout;if(typeof N=="number"&&this._outerRef!=null){var v=this._outerRef;b==="horizontal"||D==="horizontal"?v.scrollLeft=N:v.scrollTop=N}this._callPropsCallbacks()},p.componentDidUpdate=function(){var g=this.props,b=g.direction,N=g.layout,D=this.state,v=D.scrollOffset,w=D.scrollUpdateWasRequested;if(w&&this._outerRef!=null){var C=this._outerRef;if(b==="horizontal"||N==="horizontal")if(b==="rtl")switch(V0()){case"negative":C.scrollLeft=-v;break;case"positive-ascending":C.scrollLeft=v;break;default:var O=C.clientWidth,R=C.scrollWidth;C.scrollLeft=R-O-v;break}else C.scrollLeft=v;else C.scrollTop=v}this._callPropsCallbacks()},p.componentWillUnmount=function(){this._resetIsScrollingTimeoutId!==null&&F0(this._resetIsScrollingTimeoutId)},p.render=function(){var g=this.props,b=g.children,N=g.className,D=g.direction,v=g.height,w=g.innerRef,C=g.innerElementType,O=g.innerTagName,R=g.itemCount,F=g.itemData,E=g.itemKey,x=E===void 0?mL:E,j=g.layout,S=g.outerElementType,_=g.outerTagName,I=g.style,T=g.useIsScrolling,te=g.width,K=this.state.isScrolling,Y=D==="horizontal"||j==="horizontal",ce=Y?this._onScrollHorizontal:this._onScrollVertical,L=this._getRangeToRender(),G=L[0],z=L[1],$=[];if(R>0)for(var W=G;W<=z;W++)$.push(k.createElement(b,{data:F,key:x(W,F),index:W,isScrolling:T?K:void 0,style:this._getItemStyle(W)}));var ee=r(this.props,this._instanceProps);return k.createElement(S||_||"div",{className:N,onScroll:ce,ref:this._outerRefSetter,style:Um({position:"relative",height:v,width:te,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:D},I)},k.createElement(C||O||"div",{children:$,ref:w,style:{height:Y?"100%":ee,pointerEvents:K?"none":void 0,width:Y?ee:"100%"}}))},p._callPropsCallbacks=function(){if(typeof this.props.onItemsRendered=="function"){var g=this.props.itemCount;if(g>0){var b=this._getRangeToRender(),N=b[0],D=b[1],v=b[2],w=b[3];this._callOnItemsRendered(N,D,v,w)}}if(typeof this.props.onScroll=="function"){var C=this.state,O=C.scrollDirection,R=C.scrollOffset,F=C.scrollUpdateWasRequested;this._callOnScroll(O,R,F)}},p._getRangeToRender=function(){var g=this.props,b=g.itemCount,N=g.overscanCount,D=this.state,v=D.isScrolling,w=D.scrollDirection,C=D.scrollOffset;if(b===0)return[0,0,0,0];var O=a(this.props,C,this._instanceProps),R=u(this.props,O,C,this._instanceProps),F=!v||w==="backward"?Math.max(1,N):1,E=!v||w==="forward"?Math.max(1,N):1;return[Math.max(0,O-F),Math.max(0,Math.min(b-1,R+E)),O,R]},f}(k.PureComponent),e.defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},e}var gL=function(t,e){t.children,t.direction,t.height,t.layout,t.innerTagName,t.outerTagName,t.width,e.instance},yL=pL({getItemOffset:function(t,e){var n=t.itemSize;return e*n},getItemSize:function(t,e){var n=t.itemSize;return n},getEstimatedTotalSize:function(t){var e=t.itemCount,n=t.itemSize;return n*e},getOffsetForIndexAndAlignment:function(t,e,n,r,i,s){var a=t.direction,u=t.height,o=t.itemCount,d=t.itemSize,h=t.layout,f=t.width,p=a==="horizontal"||h==="horizontal",g=p?f:u,b=Math.max(0,o*d-g),N=Math.min(b,e*d),D=Math.max(0,e*d-g+d+s);switch(n==="smart"&&(r>=D-g&&r<=N+g?n="auto":n="center"),n){case"start":return N;case"end":return D;case"center":{var v=Math.round(D+(N-D)/2);return v<Math.ceil(g/2)?0:v>b+Math.floor(g/2)?b:v}case"auto":default:return r>=D&&r<=N?r:r<D?D:N}},getStartIndexForOffset:function(t,e){var n=t.itemCount,r=t.itemSize;return Math.max(0,Math.min(n-1,Math.floor(e/r)))},getStopIndexForStartIndex:function(t,e,n){var r=t.direction,i=t.height,s=t.itemCount,a=t.itemSize,u=t.layout,o=t.width,d=r==="horizontal"||u==="horizontal",h=e*a,f=d?o:i,p=Math.ceil((f+n-h)/a);return Math.max(0,Math.min(s-1,e+p-1))},initInstanceProps:function(t){},validateProps:function(t){t.itemSize}});const vL="kusgan-local-cache",bL=1,jl="kv",zg="state",nf="__kusgan_sync_lock__";let Je={members:[],attendance:[],payments:[],gymEntries:[],progress:[],queue:[]},rf=null;function Bg(){return rf||(rf=j1(vL,bL,{upgrade(t){t.objectStoreNames.contains(jl)||t.createObjectStore(jl)}})),rf}async function wL(){try{const t=await(await Bg()).get(jl,zg);t&&typeof t=="object"&&(Je=Object.assign(Je,t),Je.members||(Je.members=[]),Je.attendance||(Je.attendance=[]),Je.queue||(Je.queue=[]),Je.payments||(Je.payments=[]),Je.gymEntries||(Je.gymEntries=[]),Je.progress||(Je.progress=[]))}catch(t){console.warn("localCache: failed to load from idb",t&&t.message)}}async function Bd(t){try{await(await Bg()).put(jl,t,zg)}catch(e){console.warn("localCache: failed to write to idb",e&&e.message)}}function Os(){return Je||(Je={members:[],attendance:[],payments:[],gymEntries:[],progress:[],queue:[]}),Je.members||(Je.members=[]),Je.attendance||(Je.attendance=[]),Je.queue||(Je.queue=[]),Je.payments||(Je.payments=[]),Je.gymEntries||(Je.gymEntries=[]),Je.progress||(Je.progress=[]),Je}wL();function SL(t){return Os()[t]||[]}function xL(t,e){const n=Os();n[t]=Array.isArray(e)?e:[],Bd(n).catch(()=>{})}function CL(t){const e=Os();e.queue.unshift(t),Bd(e).catch(()=>{})}function W_(t){CL({id:"q-"+Date.now()+"-"+Math.floor(Math.random()*1e3),...t}),$g()}function _L(t){const e=new Date().toISOString(),n=e.slice(0,10),r=e.slice(11,16),i="local-"+Date.now(),s={id:i,Staff:t,staff_name:t,Date:n,TimeIn:r,time_in:e,status:"On Duty",_localPending:!0},a=Os();return a.attendance=[s,...a.attendance||[]],Bd(a).catch(()=>{}),W_({method:"POST",path:"/attendance/kiosk",body:{staff_name:t},tempId:i,collection:"attendance"}),s}async function kL(t){try{const e=Jo&&typeof Jo=="function"?Jo():null,n={"Content-Type":"application/json"};e&&(n.Authorization=`Bearer ${e}`);const r=await fetch(t.path,{method:t.method||"POST",headers:n,body:JSON.stringify(t.body||{})}),i=await r.json().catch(()=>({}));if(!r.ok)throw new Error(i&&i.error?i.error:"Request failed");return{ok:!0,json:i}}catch(e){return{ok:!1,error:String(e&&e.message||e)}}}async function $g(){if(!window[nf]){window[nf]=!0;try{let t=Os();for(;(t.queue||[]).length;){const e=t.queue[t.queue.length-1];if(!e)break;const n=await kL(e);if(n.ok){if(t=Os(),t.queue=(t.queue||[]).filter(r=>r.id!==e.id),e.collection==="attendance"&&e.tempId)try{const r=n.json&&(n.json.row||n.json);r&&(t.attendance=(t.attendance||[]).map(i=>i.id===e.tempId?r:i))}catch{}if(e.collection==="members"&&e.tempId)try{const r=n.json&&(n.json.row||n.json);r&&(t.members=(t.members||[]).map(i=>i.id===e.tempId?r:i))}catch{}Bd(t).catch(()=>{})}else break}}finally{window[nf]=!1}}}window.addEventListener&&window.addEventListener("online",()=>{$g()});async function EL(){try{Je={members:[],attendance:[],payments:[],gymEntries:[],progress:[],queue:[]},await(await Bg()).delete(jl,zg)}catch(t){console.warn("localCache.clearCache failed",t&&t.message)}}Os();const Un={getCached:SL,setCached:xL,addOptimisticAttendance:_L,enqueueWrite:W_,processQueue:$g,clearCache:EL},NL=$e.lazy(()=>SR(()=>dk(()=>import("./AddMemberModal-Ct2x2RWu-D3HRJlMQ.js"),[]),[])),At={members:null,payments:null,gymEntries:null,ts:{members:0,payments:0,gymEntries:0}},zm="kusgan.members.cache.v1",TL=1e3*60*60;function IL(){try{if(typeof window>"u"||!window.localStorage)return;const t=window.localStorage.getItem(zm);if(!t)return;const e=JSON.parse(t);if(!e||!e.ts||Date.now()-(e.ts.members||0)>TL)return;At.members=e.members||null,At.payments=e.payments||null,At.gymEntries=e.gymEntries||null,At.ts=e.ts||At.ts}catch(t){console.debug("Members: failed to load cache from localStorage",t)}}function jL(){try{if(typeof window>"u"||!window.localStorage)return;const t={members:At.members,payments:At.payments,gymEntries:At.gymEntries,ts:At.ts};typeof window.requestIdleCallback=="function"?window.requestIdleCallback(()=>{try{window.localStorage.setItem(zm,JSON.stringify(t))}catch(e){console.debug("Members: failed to save cache to localStorage",e)}},{timeout:2e3}):setTimeout(()=>{try{window.localStorage.setItem(zm,JSON.stringify(t))}catch(e){console.debug("Members: failed to save cache to localStorage",e)}},0)}catch(t){console.debug("Members: failed to save cache to localStorage",t)}}try{IL()}catch{}const AL=t=>String(t||"").trim().toLowerCase().replace(/\s+/g,"_"),z0=t=>["yes","y","true","1"].includes(String(t||"").trim().toLowerCase()),qt=(t,e)=>e.map(n=>t[n]).find(n=>n!==void 0&&n!==""),wi=t=>{if(t instanceof Date)return t;const e=new Date(t);return isNaN(e)?null:e},DL=(t,e)=>t&&e&&t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate(),Zo=t=>{const e={};return Object.entries(t||{}).forEach(([n,r])=>{e[AL(n)]=r}),e},B0=t=>{if(!t)return null;let e=wi(qt(t,["member_since","membersince","member_date","memberdate","createdat","created_at","created","join_date","joined","start_date","memberdateexcel","membersinceexcel"]));if(e)return e;try{const n=t._raw||t;if(e=qt(n,["MemberSince","Member Since","MemberDate","Member Date","createdAt","created_at","Created","Joined","Join Date","start_date"]),e)return wi(e)}catch{}return null},$0=t=>String(t||"").toLowerCase().replace(/(?:^|[\s\-])([a-z])/g,(e,n)=>e.replace(n,n.toUpperCase())),di=t=>t?`${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()]}-${t.getDate()}, ${t.getFullYear()}`:"",Pu=t=>{if(!t)return!1;const e=t instanceof Date?new Date(t):new Date(t);if(isNaN(e))return!1;const n=new Date;return n.setHours(0,0,0,0),e.setHours(0,0,0,0),e>=n};function H0(t){const e=new Map;for(const r of t){const i=Zo(r),s=qt(i,["memberid","member_id","id","member_id_"]);s&&(e.has(s)||e.set(s,[]),e.get(s).push(r))}const n=new Map;for(const[r,i]of e){const s=Yr(i);n.set(r,{membershipEnd:s.membershipEnd||null,coachEnd:s.coachEnd||null,membershipState:s.membershipState||null,coachActive:!!s.coachActive})}return n}function q0(t){const e=new Map;for(const n of t){const r=Zo(n),i=qt(r,["memberid","member_id","id","member_id_"]);if(!i)continue;const s=wi(qt(r,["date","visit_date","entry_date","log_date","timestamp","checkin"]));if(!s)continue;const a=e.get(i);(!a||s>a)&&e.set(i,s)}return e}function ML(){const t=Qa(),[e,n]=k.useState(20),[r,i]=k.useState([]),[s,a]=k.useState(new Map),[u,o]=k.useState(new Map),[d,h]=k.useState(!0),[f,p]=k.useState(!1),[g,b]=k.useState(""),[N,D]=k.useState(""),[v,w]=k.useState(""),[C,O]=k.useState(!1),R=k.useRef(null),[F,E]=k.useState(!1),x=k.useRef(null),[j,S]=k.useState(600);k.useEffect(()=>{function $(){try{const W=window.innerHeight||800,ee=Math.max(300,W-220);S(ee)}catch{S(600)}}return $(),window.addEventListener("resize",$),()=>window.removeEventListener("resize",$)},[]);const _=async()=>{const[$,W,ee]=await Promise.all([Ae.fetchMembersRecent({days:5}),Ae.fetchPayments(),Ae.fetchGymEntries()]);return{members:(($==null?void 0:$.rows)??($==null?void 0:$.data)??[]).map(Zo),payments:(W==null?void 0:W.rows)??(W==null?void 0:W.data)??[],gymEntries:(ee==null?void 0:ee.rows)??(ee==null?void 0:ee.data)??[]}},{data:I,error:T,isLoading:te,isValidating:K,mutate:Y}=oL("members:recent",_,{revalidateOnFocus:!0,dedupingInterval:2e3,fallbackData:At.members?{members:At.members,payments:At.payments,gymEntries:At.gymEntries}:void 0});k.useEffect(()=>{if(I)try{i(I.members||[]),a(H0(I.payments||[])),o(q0(I.gymEntries||[])),At.members=I.members||[],At.payments=I.payments||[],At.gymEntries=I.gymEntries||[],At.ts=At.ts||{},At.ts.members=Date.now(),At.ts.payments=Date.now(),At.ts.gymEntries=Date.now(),jL()}catch($){console.error("Members: failed to hydrate from SWR data",$)}},[I]),k.useEffect(()=>{try{const $=Un.getCached("members")||[];$&&$.length&&i(W=>W&&W.length?W:$.map(Zo))}catch{}},[]),k.useEffect(()=>{let $=!1;async function W(){if(v){h(!0);try{const[ee,Z,ie]=await Promise.all([Ae.searchMembersByName(v),Ae.fetchPayments(),Ae.fetchGymEntries()]);if($)return;const P=((ee==null?void 0:ee.rows)??[]).map(Zo);i(P),a(H0((Z==null?void 0:Z.rows)||[])),o(q0((ie==null?void 0:ie.rows)||[]))}catch(ee){$||b((ee==null?void 0:ee.message)||String(ee))}finally{$||h(!1)}}}return v&&W(),()=>{$=!0}},[v]),k.useEffect(()=>{h(!!te),p(!!te),T&&b(T.message||String(T))},[te,T]),k.useEffect(()=>(R.current&&clearTimeout(R.current),R.current=setTimeout(()=>w(N.trim()),250),()=>{R.current&&clearTimeout(R.current)}),[N]);const ce=k.useMemo(()=>{const $=v.trim().toLowerCase();let W=r;$&&(W=r.filter(ie=>["first_name","firstname","last_name","lastname","nick_name","nickname","mobile","email"].some(P=>String(ie[P]??"").toLowerCase().includes($))));const ee=new Date,Z=W.map(ie=>{const P=qt(ie,["memberid","member_id","id","member_id_"]),V=P?u.get(P):null,U=V?DL(V,ee):!1,q=wi(qt(ie,["member_since","membersince","member_date","memberdate","member_date","createdat","created_at","join_date","joined","start_date"])),se=q?q.getTime():0,me=V?V.getTime():-1;return{r:ie,lastVisit:V,isToday:U,joinTs:se,visitTs:me,memberId:P}});return Z.sort((ie,P)=>P.joinTs-ie.joinTs||P.visitTs-ie.visitTs),Z},[r,v,u]),L=(ce||[]).length,G=L?1:0,z=Math.min(e||0,L);return k.useCallback(($,W)=>{$&&t(`/members/${encodeURIComponent($)}`,{state:{row:W}})},[t]),c.jsxs("div",{className:"content",ref:x,style:{minHeight:"calc(100vh - 120px)",display:"flex",flexDirection:"column"},children:[c.jsxs("h2",{className:"dashboard-title",children:["All Members ",c.jsx(Vd,{show:K&&!te})]}),c.jsxs("div",{className:"toolbar",style:{display:"flex",justifyContent:"center",alignItems:"center",gap:12,marginBottom:12},children:[c.jsx("input",{className:"search-wide",style:{width:"60%",maxWidth:960,minWidth:320},placeholder:"Search members by name",value:N,onChange:$=>D($.target.value)}),c.jsx("button",{className:"button",onClick:()=>E(!0),children:"+ Add Member"})]}),d&&c.jsx("div",{style:{color:"var(--muted)",textAlign:"center",padding:16},children:"Loading"}),g&&c.jsxs("div",{children:["Error: ",g]}),!d&&!g&&c.jsxs("div",{className:"panel",style:{display:"flex",flexDirection:"column"},children:[r.length===0&&c.jsxs("div",{style:{padding:24,textAlign:"center",color:"#b91c1c",fontWeight:600},children:["No member data loaded.",c.jsx("br",{}),"Please check your API connection or try again later."]}),c.jsx("div",{style:{width:"100%"},children:ce.length===0?c.jsx("div",{style:{padding:12},children:"No members found."}):ce.length<=120?c.jsx("div",{className:"members-list-wrapper",style:{display:"flex",justifyContent:"center"},children:c.jsxs("table",{className:"attendance-table aligned",style:{width:"100%"},children:[c.jsxs("colgroup",{children:[c.jsx("col",{style:{width:"15%"}}),c.jsx("col",{style:{width:"25%"}}),c.jsx("col",{style:{width:"15%"}}),c.jsx("col",{style:{width:"15%"}}),c.jsx("col",{style:{width:"15%"}}),c.jsx("col",{style:{width:"15%"}})]}),c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{style:{textAlign:"center"},children:"Nick Name"}),c.jsx("th",{style:{textAlign:"center"},children:"Full Name"}),c.jsx("th",{style:{textAlign:"center"},children:"Member Since"}),c.jsx("th",{style:{textAlign:"center"},children:"Last Gym Visit"}),c.jsx("th",{style:{textAlign:"center"},children:"Gym Valid Until"}),c.jsx("th",{style:{textAlign:"center"},children:"Coach Valid Until"})]})}),c.jsx("tbody",{children:ce.slice(0,e).map(({r:$,lastVisit:W,isToday:ee,memberId:Z},ie)=>{const P=Z?s.get(Z):void 0,V=z0(qt($,["student","is_student","student?"]));let U=Number(qt($,["age","years_old"]));if(isNaN(U)){const re=qt($,["birthday","birth_date","dob"]),pe=wi(re);if(pe){const le=new Date;U=le.getFullYear()-pe.getFullYear()-(le.getMonth()<pe.getMonth()||le.getMonth()===pe.getMonth()&&le.getDate()<pe.getDate()?1:0)}}const q=!isNaN(U)&&U>=60,se=String(qt($,["first_name","firstname","first","given_name"])??""),me=String(qt($,["last_name","lastname","last","surname"])??""),ae=[se,me].filter(Boolean).map($0).join(" "),M=String($.nick_name??$.nickname??"").toUpperCase(),X=B0($)||wi(qt($,["member_since","membersince","member_date","memberdate","member_date","createdat","created_at","join_date","joined","start_date"])),B=(P==null?void 0:P.membershipEnd)||null,de=(P==null?void 0:P.coachEnd)||null;return c.jsxs("tr",{className:"row-link",onClick:()=>t(`/members/${encodeURIComponent(Z)}`,{state:{row:$}}),style:{cursor:"pointer"},children:[c.jsx("td",{style:{textAlign:"center"},children:c.jsx("strong",{children:M})}),c.jsxs("td",{style:{textAlign:"left"},children:[ae," ",c.jsxs("span",{style:{display:"inline-flex",gap:6,marginLeft:8},children:[V&&c.jsx("span",{className:"pill student",children:"Student"}),q&&c.jsx("span",{className:"pill senior",children:"Senior"})]})]}),c.jsx("td",{style:{textAlign:"center"},children:di(X)}),c.jsx("td",{style:{textAlign:"center"},children:ee?c.jsx("span",{className:"pill ok",children:"Visited today"}):W?di(new Date(W)):""}),c.jsx("td",{style:{textAlign:"center",color:B?Pu(B)?"green":"red":"inherit"},children:B?di(new Date(B)):""}),c.jsx("td",{style:{textAlign:"center",color:de?Pu(de)?"green":"red":"inherit"},children:de?di(new Date(de)):""})]},ie)})})]})}):c.jsxs("div",{className:"members-list-wrapper",style:{width:"100%",display:"flex",flexDirection:"column",flex:1},children:[c.jsxs("div",{style:{display:"flex",padding:"8px 12px",fontWeight:700,borderBottom:"1px solid var(--light-border)",background:"var(--panel-header-bg)"},children:[c.jsx("div",{style:{width:"15%",textAlign:"center"},children:"Nick Name"}),c.jsx("div",{style:{width:"25%",textAlign:"left"},children:"Full Name"}),c.jsx("div",{style:{width:"15%",textAlign:"center"},children:"Member Since"}),c.jsx("div",{style:{width:"15%",textAlign:"center"},children:"Last Gym Visit"}),c.jsx("div",{style:{width:"15%",textAlign:"center"},children:"Gym Valid Until"}),c.jsx("div",{style:{width:"15%",textAlign:"center"},children:"Coach Valid Until"})]}),c.jsx(yL,{height:Math.min(j,Math.max(200,Math.min(ce.length,e)*56)),itemCount:Math.min(ce.length,e),itemSize:56,width:"100%",children:({index:$,style:W})=>{const{r:ee,lastVisit:Z,isToday:ie,memberId:P}=ce[$],V=P?s.get(P):void 0,U=z0(qt(ee,["student","is_student","student?"]));let q=Number(qt(ee,["age","years_old"]));if(isNaN(q)){const pe=qt(ee,["birthday","birth_date","dob"]),le=wi(pe);if(le){const xe=new Date;q=xe.getFullYear()-le.getFullYear()-(xe.getMonth()<le.getMonth()||xe.getMonth()===le.getMonth()&&xe.getDate()<le.getDate()?1:0)}}const se=!isNaN(q)&&q>=60,me=String(qt(ee,["first_name","firstname","first","given_name"])??""),ae=String(qt(ee,["last_name","lastname","last","surname"])??""),M=[me,ae].filter(Boolean).map($0).join(" "),X=String(ee.nick_name??ee.nickname??"").toUpperCase(),B=B0(ee)||wi(qt(ee,["member_since","membersince","member_date","memberdate","member_date","createdat","created_at","join_date","joined","start_date"])),de=(V==null?void 0:V.membershipEnd)||null,re=(V==null?void 0:V.coachEnd)||null;return c.jsxs("div",{style:{...W,display:"flex",alignItems:"center",padding:"8px 12px",borderBottom:"1px solid rgba(0,0,0,0.04)",cursor:"pointer"},className:"row-link",onClick:()=>t(`/members/${encodeURIComponent(P)}`,{state:{row:ee}}),children:[c.jsx("div",{style:{width:"15%",textAlign:"center"},children:c.jsx("strong",{children:X})}),c.jsxs("div",{style:{width:"25%"},children:[M,c.jsxs("span",{style:{display:"inline-flex",gap:6,marginLeft:8,verticalAlign:"middle"},children:[U&&c.jsx("span",{className:"pill student",children:"Student"}),se&&c.jsx("span",{className:"pill senior",children:"Senior"})]})]}),c.jsx("div",{style:{width:"15%",textAlign:"center"},children:di(B)}),c.jsx("div",{style:{width:"15%",textAlign:"center"},children:ie?c.jsx("span",{className:"pill ok",children:"Visited today"}):Z?di(new Date(Z)):""}),c.jsx("div",{style:{width:"15%",textAlign:"center",color:de?Pu(de)?"green":"red":"inherit"},children:de?di(new Date(de)):""}),c.jsx("div",{style:{width:"15%",textAlign:"center",color:re?Pu(re)?"green":"red":"inherit"},children:re?di(new Date(re)):""})]},$)}})]})}),c.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8},children:c.jsx("div",{className:"table-range",children:L===0?"Showing 0 of 0":`Showing ${G}${z} of ${L}`})}),L>e&&c.jsx("div",{style:{textAlign:"center",marginTop:8},children:c.jsx("button",{className:"button",onClick:()=>n($=>$<L?Math.min($+20,L):20),children:e<L?`Load ${Math.min(20,L-e)} more`:"Show less"})})]}),c.jsx(k.Suspense,{fallback:c.jsx(P_,{}),children:c.jsx(NL,{open:F,onClose:()=>E(!1),onSaved:async()=>{try{await Y()}catch{}}})})]})}function PL({open:t,onClose:e,onDetected:n}){const r=k.useRef(null),i=k.useRef(null),[s,a]=k.useState(""),u=k.useRef(0),o=k.useRef(null),d=()=>{u.current&&cancelAnimationFrame(u.current),u.current=0,i.current&&(i.current.getTracks().forEach(p=>p.stop()),i.current=null)};async function h(){var p,g;try{if("BarcodeDetector"in window){const b=await((g=(p=window.BarcodeDetector).getSupportedFormats)==null?void 0:g.call(p))||[];if(b.includes("qr_code")||b.includes("qr"))return o.current=new window.BarcodeDetector({formats:["qr_code"]}),!0}}catch{}return o.current=null,!1}async function f(){a("");const p=await h();try{const g=await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"}},audio:!1});i.current=g;const b=r.current;if(b&&(b.srcObject=g,await b.play().catch(()=>{})),p){const N=async()=>{if(!r.current||r.current.readyState<2){u.current=requestAnimationFrame(N);return}try{const D=await o.current.detect(r.current);if(D&&D.length){const v=String(D[0].rawValue||D[0].raw||"").trim();if(v){n==null||n(v),e==null||e();return}}}catch{}u.current=requestAnimationFrame(N)};u.current=requestAnimationFrame(N)}else a("QR scanning isn't supported by this browser. Type the ID instead.")}catch(g){const b=(g==null?void 0:g.name)||"";a(b==="NotAllowedError"?"Camera permission denied. Allow access in browser/site settings.":b==="NotFoundError"?"No camera found.":"Cannot access camera.")}}return k.useEffect(()=>{if(!t){d();return}return f(),d},[t]),t?c.jsx("div",{style:W0.overlay,children:c.jsxs("div",{style:W0.modal,children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[c.jsx("div",{style:{fontWeight:800},children:"Scan QR Code"}),c.jsx("button",{className:"button btn-lg",style:{background:"#555"},onClick:e,children:"Close"})]}),s&&c.jsx("div",{style:{color:"#d33",marginBottom:8},children:s}),c.jsx("video",{ref:r,playsInline:!0,muted:!0,style:{width:"100%",borderRadius:10,background:"#000"}}),c.jsx("div",{style:{color:"#666",fontSize:12,marginTop:8},children:"Point the camera at the QR code."})]})}):null}const W0={overlay:{position:"fixed",inset:0,background:"rgba(0,0,0,.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},modal:{width:"min(720px, 92vw)",background:"#fff",borderRadius:12,padding:16,border:"1px solid #e7e8ef",boxShadow:"0 6px 24px rgba(0,0,0,.2)"}},{fetchMemberBundle:OL,fetchPricing:G0,fetchMembers:RL,fetchPayments:LL,fetchGymEntries:FL}=Ae,Ou="Asia/Manila",UL=t=>{if(!t)return!1;const e=t instanceof Date?new Date(t):new Date(t);if(isNaN(e))return!1;const n=new Date;return n.setHours(0,0,0,0),e.setHours(0,0,0,0),e>=n},G_=t=>{const e=String(t||"").match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return e&&e[1]?e[1]:""},VL=t=>{const e=String(t||"");if(!e)return"";const n=e.match(/https?:\/\/[^\s}]+/);if(n){const i=n[0];if(/googleusercontent\.com\//.test(i))return i;const s=i.match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return s&&s[1]?`https://drive.google.com/uc?export=view&id=${s[1]}`:i}if(/googleusercontent\.com\//.test(e))return e;const r=G_(e);return r?`https://drive.google.com/uc?export=view&id=${r}`:e},zL=t=>{const e=String(t||"");if(/googleusercontent\.com\//.test(e))return e;const n=G_(e);return n?`https://drive.google.com/thumbnail?id=${n}&sz=w1000`:e};function BL(){const[t,e]=k.useState(!1),[n,r]=k.useState(""),[i,s]=k.useState([]),[a,u]=k.useState(null),[o,d]=k.useState([]),[h,f]=k.useState(null),[p,g]=k.useState(!1),[b,N]=k.useState(null),[D,v]=k.useState(""),[w,C]=k.useState(""),[O,R]=k.useState(""),[F,E]=k.useState(!1),[x,j]=k.useState(""),[S,_]=k.useState(""),[I,T]=k.useState(!1),[te,K]=k.useState(!1),Y=k.useRef(null),ce=k.useRef(null);k.useEffect(()=>{let z=!0;return(async()=>{try{const[$,W,ee]=await Promise.all([RL(),LL(),G0()]);if(!z)return;const Z=(($==null?void 0:$.rows)||($==null?void 0:$.data)||[]).slice(),ie=(W==null?void 0:W.rows)||(W==null?void 0:W.data)||[],P=(ee==null?void 0:ee.rows)||(ee==null?void 0:ee.data)||[],V=await FL(),U=(V==null?void 0:V.rows)||(V==null?void 0:V.data)||[],q=new Intl.DateTimeFormat("en-CA",{timeZone:Ou,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date),se=Z.filter(me=>{const ae=(me.MemberID||me.member_id||me.id||"").toString().trim(),M=ie.filter(B=>String(B.MemberID||B.member_id||B.id||"").trim()===String(ae).trim()),X=Yr(M,ae,P);return X.membershipState==="active"||UL(X==null?void 0:X.membershipEnd)?!U.filter(B=>{try{const de=String(B.MemberID||B.memberId||B.memberid||B.id||"").trim();if(!de||String(de)!==String(ae))return!1;const re=B.Date||B.date||B.DateTime||B.timestamp||B.checkin;return re?new Intl.DateTimeFormat("en-CA",{timeZone:Ou,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date(re))===q:!1}catch{return!1}}).some(B=>{try{const de=String(B.TimeOut||B.timeOut||B.time_out||B.Timeout||"").trim();return de?/\d/.test(de)?!1:["-","","",""].includes(de):!0}catch{return!0}}):!1});se.sort((me,ae)=>{const M=String(me.Nickname||me.NickName||me["Nick Name"]||"").toLowerCase(),X=String(ae.Nickname||ae.NickName||ae["Nick Name"]||"").toLowerCase();return M.localeCompare(X)}),s(se)}catch($){console.error($)}})(),()=>{z=!1}},[]),k.useEffect(()=>{K(!1)},[a==null?void 0:a.member]);const L=async z=>{const[$,W]=await Promise.all([OL(z),G0()]),ee=(W==null?void 0:W.rows)||(W==null?void 0:W.data)||[];u($),d(ee);const Z=Yr($.payments||[],z,ee);return f(Z),{b:$,rows:ee,status:Z}},G=async z=>{var $,W;const ee=String(z||"").trim();if(!ee)return;r(ee),g(!0),R(""),u(null),f(null);const Z=await L(ee),ie=(($=Z==null?void 0:Z.b)==null?void 0:$.member)||null,P=Z==null?void 0:Z.status;if(ie&&(ie.NickName||ie.Nickname||ie["Nick Name"]||ie.nick_name||ie.nickname),!ie||(P==null?void 0:P.membershipState)!=="active"){R(null),setTimeout(()=>{R("NO ACTIVE GYM MEMBERSHIP")},100);return}const V=new Intl.DateTimeFormat("en-CA",{timeZone:Ou,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date),U=(((W=Z==null?void 0:Z.b)==null?void 0:W.gymEntries)||[]).filter(q=>{const se=(q==null?void 0:q.Date)||(q==null?void 0:q.date);if(!se)return!1;const me=new Date(se);return new Intl.DateTimeFormat("en-CA",{timeZone:Ou,year:"numeric",month:"2-digit",day:"2-digit"}).format(me)===V}).find(q=>!String((q==null?void 0:q.TimeOut)||"").trim());U?(T(!0),R(""),N(U||null)):(T(!1),R(""),N(null))};return k.useEffect(()=>{const z=async W=>{try{const ee=String(W&&(W.MemberID||W.memberid||W.Member)||"").trim();if(!ee||!n||String(ee)!==String(n))return;await L(n),N(null)}catch(ee){console.debug("CheckIn: gymEntry event handler failed",ee)}},$=en.on("gymEntry:added",z);return()=>{try{$()}catch{}}},[n]),k.useMemo(()=>{const z=(a==null?void 0:a.member)||null;if(!z)return null;const $=U=>U.map(q=>z[q]).find(q=>q!==void 0&&q!==""),W=$(["FirstName","First","first"]),ee=$(["LastName","Last","last"]),Z=$(["NickName","Nickname","Nick Name","nick_name","nickname"]),ie=$(["PhotoURL","Photo","photo","photo_url"]),P=zL(VL(ie)),V=z.MemberSince||z["Member Since"]||z.Joined||z["Join Date"]||z.join_date;return{first:W,last:ee,nick:Z,photo:P,memberSince:V}},[a]),c.jsxs("div",{className:"content",children:[c.jsx("h2",{className:"dashboard-title",children:"Member Check-In"}),c.jsx("div",{className:"card",style:{marginTop:8,marginBottom:12,maxWidth:480,minHeight:600,marginLeft:"auto",marginRight:"auto",padding:16,border:"2px solid #d7d9e5",background:"#fff",boxShadow:"0 10px 24px rgba(0,0,0,.12)",display:"flex",alignItems:"center",justifyContent:"center"},children:c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12,alignItems:"center",width:"100%"},children:[c.jsx("img",{src:"/favicon.png",onError:z=>{try{z.currentTarget.onerror=null,z.currentTarget.src="/kusgan-logo.png"}catch{}},alt:"Kusgan logo",style:{width:250,height:250,objectFit:"contain",opacity:1,marginBottom:8}}),c.jsx("div",{style:{maxWidth:420,width:"100%",margin:"0 auto"},children:c.jsx("button",{className:"primary-btn",style:{fontSize:"1.1rem",height:54,width:"100%"},onClick:()=>e(!0),children:" Scan QR Code"})}),c.jsx("div",{style:{color:"#666",textAlign:"center",marginTop:24},children:"or select a member below"}),c.jsx("div",{style:{maxWidth:420,width:"100%",margin:"0 auto"},children:c.jsxs("select",{value:n,onChange:z=>r(z.target.value),style:{width:"100%",height:44,padding:"8px 12px",border:"1px solid #e7e8ef",borderRadius:10},children:[c.jsx("option",{value:"",children:"Select member"}),i.map(z=>{const $=String(z.MemberID||z.memberId||z.id||z.memberid||"").trim();return c.jsxs("option",{value:$,children:[z.Nickname||z.NickName||z["Nick Name"]||"Member","  ",z.FirstName||z.First||""," ",z.LastName||z.Last||""]},$||JSON.stringify(z))})]})}),c.jsx("div",{style:{maxWidth:420,width:"100%",margin:"0 auto"},children:c.jsx("button",{className:"primary-btn",style:{fontSize:"1.1rem",height:54,width:"100%"},onClick:()=>{n&&G(String(n).trim())},children:"Proceed"})})]})}),c.jsx(PL,{open:t,onClose:()=>e(!1),onDetected:G}),c.jsx(zd,{open:p,memberId:n,initialEntry:b,onClose:()=>{g(!1),R("")},bundleOverride:a,pricingOverride:{rows:o},status:h,onSuccess:()=>{g(!1),R(""),u(null),f(null),N(null)}}),F&&c.jsx("div",{style:{position:"fixed",top:24,right:24,zIndex:2e3,pointerEvents:Y.current?"auto":"none"},children:c.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",background:"#333",color:"#fff",fontWeight:600,fontSize:16,borderRadius:8,boxShadow:"0 2px 12px rgba(0,0,0,.12)",padding:"10px 14px",minWidth:220,textAlign:"left",letterSpacing:.1},children:[c.jsx("div",{style:{flex:1},children:O}),Y.current?c.jsx("button",{style:{background:"transparent",color:"#fff",border:"1px solid rgba(255,255,255,0.18)",padding:"6px 10px",borderRadius:6,cursor:"pointer"},onClick:()=>{const z=Y.current;if(z){try{z.timer&&clearTimeout(z.timer)}catch{}Y.current=null,z.type==="checkin"?(T(!1),u($=>{if(!$)return $;const W=($.gymEntries||[]).filter(ee=>!(String(ee.MemberID||"")===String(z.memberId)&&String(ee.TimeIn||"")===String(z.nowIso)));return{...$,gymEntries:W}})):z.type==="checkout"&&(T(!0),u($=>{if(!$)return $;const W=($.gymEntries||[]).map(ee=>String(ee.MemberID||"")===String(z.memberId)&&String(ee.TimeOut||"").length>0?{...ee,TimeOut:""}:ee);return{...$,gymEntries:W}})),R("Action cancelled"),E(!0),ce.current&&clearTimeout(ce.current),ce.current=setTimeout(()=>{E(!1),R("")},1800)}},children:"Undo"}):null]})})]})}const $L=["Coach Jojo","Coach Elmer","Bezza","Jeanette","Johanna","Patpat","Sheena","Xyza"],Qn="Asia/Manila",Bm=t=>{if(!t)return"";try{const e=new Date(t);return new Intl.DateTimeFormat("en-PH",{hour:"numeric",minute:"2-digit",hour12:!0,timeZone:Qn}).format(e)}catch{return String(t)}},Q0=t=>{var e,n,r;if(!t)return"";try{const i=String(t||"");let s=null;if(/^\d{4}-\d{2}-\d{2}$/.test(i)?s=new Date(i+"T00:00:00"):s=new Date(i),isNaN(s))return i.slice(0,10);const a=new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",timeZone:Qn}).formatToParts(s),u=((e=a.find(h=>h.type==="month"))==null?void 0:e.value)||"",o=((n=a.find(h=>h.type==="day"))==null?void 0:n.value)||"",d=((r=a.find(h=>h.type==="year"))==null?void 0:r.value)||"";return`${u}-${o}, ${d}`}catch{return String(t)}},Ru=t=>{try{const e=(t==null?void 0:t.time_in)||(t==null?void 0:t.timeIn)||(t==null?void 0:t.TimeIn)||(t==null?void 0:t.TimeInISO)||null,n=(t==null?void 0:t.TimeIn)||(t==null?void 0:t.time_in_short)||null;if(e)return Bm(e);const r=String((t==null?void 0:t.TimeIn)||(t==null?void 0:t.time_in)||(t==null?void 0:t.TimeIn)||"");if(/^\d{1,2}:\d{2}$/.test(r)){const[i,s]=r.split(":").map(u=>Number(u)),a=new Date;return a.setHours(i,s,0,0),new Intl.DateTimeFormat("en-PH",{hour:"numeric",minute:"2-digit",hour12:!0,timeZone:Qn}).format(a)}return r||""}catch{return""}},wr=t=>{try{const e=(t==null?void 0:t.Date)||(t==null?void 0:t.date)||(t==null?void 0:t.time_in)||(t==null?void 0:t.timeIn)||(t==null?void 0:t.Timestamp)||(t==null?void 0:t.timestamp)||(t==null?void 0:t.TimestampISO)||(t==null?void 0:t.timestampISO)||"";if(e&&typeof e=="object"&&(e.seconds||e._seconds)){const i=e.seconds||e._seconds,s=new Date(i*1e3);return new Intl.DateTimeFormat("en-CA",{timeZone:Qn}).format(s)}const n=String(e||"").trim();if(!n)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(n))return n.slice(0,10);const r=new Date(n);return isNaN(r)?n.slice(0,10):new Intl.DateTimeFormat("en-CA",{timeZone:Qn}).format(r)}catch{return""}};function HL(){const[t,e]=k.useState(""),[n,r]=k.useState([]),[i,s]=k.useState([]),[a,u]=k.useState([]),[o,d]=k.useState(null),[h,f]=k.useState(!1),[p,g]=k.useState(!1),[b,N]=k.useState(""),D=P=>{if(!P)return!1;const V=String(P).trim().toLowerCase(),U=new Intl.DateTimeFormat("en-CA",{timeZone:Qn}).format(new Date);for(const q of n||[])try{const se=String((q==null?void 0:q.Staff)||(q==null?void 0:q.staff)||(q==null?void 0:q.staff_name)||"").trim().toLowerCase(),me=wr(q)||"",ae=String((q==null?void 0:q.TimeIn)||(q==null?void 0:q.time_in)||(q==null?void 0:q.timein)||"").trim(),M=String((q==null?void 0:q.TimeOut)||(q==null?void 0:q.time_out)||(q==null?void 0:q.timeout)||"").trim();if(se===V&&me===U&&ae&&(M===""||M==="-"||M===""||M===null||typeof M>"u"))return!0}catch{}return!1},v=async()=>{f(!0),N("");try{const P=Un.getCached("attendance")||[];P&&P.length&&r(P);let V=[];try{if(Ae&&typeof Ae.fetchAttendance=="function"){const U=await Ae.fetchAttendance();V=U&&(U.rows||U.data)?U.rows||U.data:Array.isArray(U)?U:[]}else{const U=await(await fetch("/attendance")).json();V=Array.isArray(U)?U:[]}}catch(U){console.warn("fetch attendance failed",U&&U.message),V=[]}r(V),Un.setCached("attendance",V);try{const U=await Ae.fetchMembers(),q=U&&(U.rows||U.data)?U.rows||U.data:Array.isArray(U)?U:[];u(Array.isArray(q)?q:[])}catch{}try{const U=await Ae.fetchGymEntries(),q=U&&(U.rows||U.data)?U.rows||U.data:Array.isArray(U)?U:[];s(Array.isArray(q)?q:[])}catch{}Un.processQueue()}catch(P){console.error("load attendance",P),N("Failed to load attendance")}finally{f(!1)}};k.useEffect(()=>{v()},[]);const w=new Intl.DateTimeFormat("en-CA",{timeZone:Qn}).format(new Date),[C,O]=k.useState(20),[R,F]=k.useState(20),E=["Coach Jojo","Coach Elmer"],[x,j]=k.useState(E[0]),[S,_]=k.useState([]),[I,T]=k.useState(0),te=k.useMemo(()=>{try{const P=new Set;(i||[]).forEach(U=>{const q=String((U==null?void 0:U.Coach)||(U==null?void 0:U.coach)||"").trim();q&&P.add(q)});const V=Array.from(P);return V.length?V:E}catch{return E}},[i]);k.useEffect(()=>{try{!x&&te&&te.length&&j(te[0]),x&&te&&te.length&&!te.includes(x)&&j(te[0])}catch{}},[te]);const K=(P,V)=>{try{if(!P||!V)return[];const U=new Date(P.getFullYear(),P.getMonth(),1),q=new Date(V.getFullYear(),V.getMonth(),V.getDate()),se=[];let me=new Date(U);for(;me<=q;){const M=me.getFullYear(),X=me.getMonth(),B=new Date(M,X,1),de=new Date(M,X,15),re=new Date(M,X+1,0);se.push({label:`${B.toLocaleString("en-US",{month:"short"})} 1-15, ${M}`,start:new Intl.DateTimeFormat("en-CA",{timeZone:Qn}).format(B),end:new Intl.DateTimeFormat("en-CA",{timeZone:Qn}).format(de)}),se.push({label:`${B.toLocaleString("en-US",{month:"short"})} 16-${re.getDate()}, ${M}`,start:new Intl.DateTimeFormat("en-CA",{timeZone:Qn}).format(new Date(M,X,16)),end:new Intl.DateTimeFormat("en-CA",{timeZone:Qn}).format(re)}),me=new Date(M,X+1,1)}const ae=[];for(const M of se)ae.find(X=>X.label===M.label)||ae.push(M);return ae}catch{return[]}};k.useEffect(()=>{try{if(!i||i.length===0){const X=new Date,B="2025-11-16",de=K(new Date(2025,10,16),X).filter(le=>le.end>=B);_(de);const re=w,pe=de.findIndex(le=>le.start<=re&&le.end>=re);pe>=0&&T(pe);return}let P=null;for(const X of i){const B=wr(X)||"";if(!B)continue;const de=new Date(B+"T00:00:00");isNaN(de)||(!P||de<P)&&(P=de)}const V=new Date,U=P||new Date(V.getFullYear(),V.getMonth(),1),q=K(U,V),se="2025-11-16",me=q.filter(X=>X.end>=se);_(me);const ae=w,M=me.findIndex(X=>X.start<=ae&&X.end>=ae);M>=0&&T(M)}catch{}},[i]);const Y=k.useMemo(()=>{try{const P=(()=>{const V=new Date;return V.setDate(V.getDate()-19),new Intl.DateTimeFormat("en-CA",{timeZone:Qn}).format(V)})();return(n||[]).filter(V=>{const U=wr(V)||"";return U&&U>=P&&(V.Staff||V.staff||V.staff_name)}).sort((V,U)=>{const q=(wr(V)||"0000-00-00")+"T"+String((V==null?void 0:V.TimeIn)||(V==null?void 0:V.time_in)||"00:00");return((wr(U)||"0000-00-00")+"T"+String((U==null?void 0:U.TimeIn)||(U==null?void 0:U.time_in)||"00:00")).localeCompare(q)})}catch{return[]}},[n]),ce=(Y||[]).length,L=ce?1:0,G=Math.min(C||0,ce),z=k.useMemo(()=>{try{if(!S||S.length===0)return[];const P=S[I]||S[0],V=(P==null?void 0:P.start)||"",U=(P==null?void 0:P.end)||"";return(i||[]).filter(q=>{try{const se=String((q==null?void 0:q.Coach)||(q==null?void 0:q.coach)||"").trim();if(!se)return!1;if(x){const ae=se.toLowerCase().replace(/\s+/g,""),M=String(x).toLowerCase().replace(/\s+/g,"");if(!(ae.includes(M)||M.includes(ae)))return!1}const me=wr(q)||"";return me?me>=V&&me<=U:!1}catch{return!1}}).sort((q,se)=>String((se==null?void 0:se.TimeIn)||(se==null?void 0:se.time_in)||"").localeCompare(String((q==null?void 0:q.TimeIn)||(q==null?void 0:q.time_in)||"")))}catch{return[]}},[i,S,x,I]),$=k.useMemo(()=>jm(z),[z]),W=(z||[]).length,ee=W?1:0,Z=Math.min(R||0,W),ie=async()=>{if(t){g(!0),N("");try{await v()}catch{}try{if(D(t)){const P=new Date().toISOString();r(V=>V&&(V||[]).map(U=>{try{const q=String((U==null?void 0:U.Staff)||(U==null?void 0:U.staff)||(U==null?void 0:U.staff_name)||"").trim(),se=wr(U)||"",me=w,ae=String((U==null?void 0:U.TimeOut)||(U==null?void 0:U.time_out)||(U==null?void 0:U.timeout)||"").trim();if(q===String(t).trim()&&se===me&&(!ae||ae==="-"||ae===""))return{...U,TimeOut:P}}catch{}return U}));try{if(Ae&&typeof Ae.attendanceQuickAppend=="function"){await Ae.attendanceQuickAppend(t,{wantsOut:!0});const V=q=>new Promise(se=>setTimeout(se,q));let U=!1;for(let q=0;q<8;q++){try{const se=await Ae.fetchAttendance(w),me=(se==null?void 0:se.rows)||(se==null?void 0:se.data)||[];r(me);const ae=new Date;if(ae.setHours(0,0,0,0),(me||[]).some(M=>{try{const X=String((M==null?void 0:M.Staff)||(M==null?void 0:M.staff)||(M==null?void 0:M.staff_name)||"").trim();if(!X||X.toLowerCase()!==String(t).trim().toLowerCase())return!1;const B=new Date(M.Date||M.date||M.TimeIn||M.time_in||"");if(isNaN(B)||(B.setHours(0,0,0,0),B.getTime()!==ae.getTime()))return!1;const de=String((M==null?void 0:M.TimeOut)||(M==null?void 0:M.time_out)||(M==null?void 0:M.timeout)||"").trim();return!!de&&de!=="-"&&de!==""}catch{return!1}})){U=!0;break}}catch{}await V(300)}if(!U){const q=await Ae.fetchAttendance(w);r((q==null?void 0:q.rows)||(q==null?void 0:q.data)||[])}}else Ae&&typeof Ae.clockOut=="function"?(await Ae.clockOut(t),await v()):(Un.enqueueWrite({method:"POST",path:"/attendance/kiosk",body:{staff_name:t,wantsOut:!0},collection:"attendance"}),await Un.processQueue(),await v())}catch(V){console.warn("attendance clockOut failed, falling back to queue",V&&V.message),Un.enqueueWrite({method:"POST",path:"/attendance/kiosk",body:{staff_name:t,wantsOut:!0},collection:"attendance"}),await Un.processQueue(),await v()}}else{const P=Un.addOptimisticAttendance(t);r(V=>{const U=(V||[]).filter(q=>String(q.id)!==String(P.id));return[P,...U]});try{if(Ae&&typeof Ae.attendanceQuickAppend=="function"){await Ae.attendanceQuickAppend(t,{});const V=q=>new Promise(se=>setTimeout(se,q));let U=!1;for(let q=0;q<8;q++){try{const se=await Ae.fetchAttendance(w),me=(se==null?void 0:se.rows)||(se==null?void 0:se.data)||[];r(me);const ae=new Date;if(ae.setHours(0,0,0,0),(me||[]).some(M=>{try{const X=String((M==null?void 0:M.Staff)||(M==null?void 0:M.staff)||(M==null?void 0:M.staff_name)||"").trim();if(!X||X.toLowerCase()!==String(t).trim().toLowerCase())return!1;const B=new Date(M.Date||M.date||M.TimeIn||M.time_in||"");return isNaN(B)||(B.setHours(0,0,0,0),B.getTime()!==ae.getTime())?!1:!!String((M==null?void 0:M.TimeIn)||(M==null?void 0:M.time_in)||(M==null?void 0:M.TimeInISO)||(M==null?void 0:M.timeIn)||"").trim()}catch{return!1}})){U=!0;break}}catch{}await V(300)}if(!U){const q=await Ae.fetchAttendance(w);r((q==null?void 0:q.rows)||(q==null?void 0:q.data)||[])}}else Ae&&typeof Ae.clockIn=="function"?(await Ae.clockIn(t),await v()):(Un.enqueueWrite({method:"POST",path:"/attendance/kiosk",body:{staff_name:t},tempId:P.id,collection:"attendance"}),await Un.processQueue(),await v())}catch(V){console.warn("attendance client write failed, falling back to queue",V&&V.message),Un.enqueueWrite({method:"POST",path:"/attendance/kiosk",body:{staff_name:t},tempId:P.id,collection:"attendance"}),await Un.processQueue(),await v()}}}catch(P){console.error("kiosk error",P),N((P==null?void 0:P.message)||"Action failed")}finally{g(!1)}}};return c.jsxs("div",{className:"dashboard-content",children:[c.jsxs("h2",{className:"dashboard-title",children:["Staff Attendance ",c.jsx(Vd,{show:h&&!p})]}),c.jsxs("div",{className:"panel",children:[c.jsx("div",{className:"panel-header",children:"Select Staff Member"}),c.jsx("div",{style:{display:"flex",justifyContent:"center"},children:c.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",padding:12},children:[c.jsxs("select",{value:t,onChange:P=>e(P.target.value),style:{width:300,height:44,padding:"8px 12px",border:"1px solid #e7e8ef",borderRadius:10,fontSize:18},children:[c.jsx("option",{value:"",children:"(choose)"}),$L.map(P=>c.jsx("option",{value:P,children:P},P))]}),c.jsx("button",{className:"primary-btn",onClick:ie,disabled:!t||p,children:p?"Processing":t&&D(t)?"Sign Out":"Sign In"})]})})]}),c.jsxs("div",{className:"panel",children:[c.jsx("div",{className:"panel-header",children:"Attendance Records"}),b&&c.jsx("div",{className:"small-error",children:b}),c.jsx("div",{style:{overflowX:"auto",padding:8},children:c.jsxs("table",{className:"attendance-table aligned",style:{width:"100%"},children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Date"}),c.jsx("th",{children:"Staff"}),c.jsx("th",{children:"Time In"}),c.jsx("th",{children:"Time Out"}),c.jsx("th",{style:{textAlign:"center"},children:"Hours"})]})}),c.jsx("tbody",{children:Y.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:5,style:{textAlign:"center",color:"var(--muted)"},children:"No records."})}):Y.slice(0,C).map((P,V)=>{const U=wr(P)||"",q=Ru(P),se=(P==null?void 0:P.time_out)||(P==null?void 0:P.TimeOut)||(P==null?void 0:P.timeOut)||"",me=se?se.length===5?Ru({TimeIn:se}):Bm(se):"",ae=typeof(P==null?void 0:P.TotalHours)<"u"&&(P==null?void 0:P.TotalHours)!==null?String(P==null?void 0:P.TotalHours):typeof(P==null?void 0:P.NoOfHours)<"u"&&(P==null?void 0:P.NoOfHours)!==null?String(P==null?void 0:P.NoOfHours):typeof(P==null?void 0:P.hours)<"u"&&(P==null?void 0:P.hours)!==null?String(P==null?void 0:P.hours):"",M=String((P==null?void 0:P.TimeOut)||(P==null?void 0:P.time_out)||(P==null?void 0:P.timeout)||"").trim(),X=M===""||M==="-"||M===""||M==="null"||typeof M>"u",B=String((P==null?void 0:P.Staff)||(P==null?void 0:P.staff)||(P==null?void 0:P.staff_name)||""),de=(wr(P)||"")===w;return c.jsxs("tr",{children:[c.jsx("td",{children:Q0(U)}),c.jsxs("td",{style:{fontWeight:700},children:[B,X&&de&&c.jsx("span",{style:{marginLeft:8},className:"status-badge on",children:"On"})]}),c.jsx("td",{children:q}),c.jsx("td",{children:me}),c.jsx("td",{style:{textAlign:"center"},children:ae})]},(U||"")+"|"+String((P==null?void 0:P.Staff)||(P==null?void 0:P.staff)||V))})})]})}),c.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8},children:c.jsx("div",{className:"table-range",children:ce===0?"Showing 0 of 0":`Showing ${L}${G} of ${ce}`})}),ce>C&&c.jsx("div",{style:{textAlign:"center",marginTop:8},children:c.jsx("button",{className:"button",onClick:()=>O(P=>P<ce?Math.min(P+20,ce):20),children:C<ce?`Load ${Math.min(20,ce-C)} more`:"Show less"})})]}),c.jsxs("div",{className:"panel",style:{marginTop:18},children:[c.jsx("div",{className:"panel-header",children:"Coaching Sessions"}),c.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",justifyContent:"center",flexWrap:"wrap",padding:"8px 0 6px 0"},children:[c.jsxs("div",{children:[c.jsx("div",{style:{fontSize:12,color:"var(--muted)",marginBottom:6},children:"Coach"}),c.jsx("select",{value:x,onChange:P=>j(P.target.value),style:{width:260,height:44,padding:"8px 12px",border:"1px solid #e7e8ef",borderRadius:10,fontSize:16},children:te.map(P=>c.jsx("option",{value:P,children:P},P))})]}),c.jsxs("div",{children:[c.jsx("div",{style:{fontSize:12,color:"var(--muted)",marginBottom:6},children:"Period"}),c.jsx("select",{value:I,onChange:P=>T(Number(P.target.value)),style:{width:260,height:44,padding:"8px 12px",border:"1px solid #e7e8ef",borderRadius:10,fontSize:16},children:S.map((P,V)=>c.jsx("option",{value:V,children:P.label},P.label))})]})]}),c.jsxs("div",{style:{paddingTop:6,paddingBottom:12,fontWeight:700,paddingLeft:8},children:["Sessions: ",$||0]}),c.jsx("div",{style:{overflowX:"auto",padding:8},children:c.jsxs("table",{className:"attendance-table aligned",style:{width:"100%"},children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Date"}),c.jsx("th",{children:"Member"}),c.jsx("th",{children:"Time In"}),c.jsx("th",{children:"Time Out"}),c.jsx("th",{style:{textAlign:"center"},children:"Hours"}),c.jsx("th",{children:"Focus"})]})}),c.jsx("tbody",{children:S.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:6,children:"No periods"})}):z.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:6,children:"No sessions for selected coach / period."})}):z.slice(0,R).map((P,V)=>{const U=wr(P)||"",q=Ru(P),se=(P==null?void 0:P.time_out)||(P==null?void 0:P.TimeOut)||(P==null?void 0:P.timeOut)||"",me=se?se.length===5?Ru({TimeIn:se}):Bm(se):"",ae=typeof(P==null?void 0:P.TotalHours)<"u"&&(P==null?void 0:P.TotalHours)!==null?String(P==null?void 0:P.TotalHours):typeof(P==null?void 0:P.NoOfHours)<"u"&&(P==null?void 0:P.NoOfHours)!==null?String(P==null?void 0:P.NoOfHours):typeof(P==null?void 0:P.hours)<"u"&&(P==null?void 0:P.hours)!==null?String(P==null?void 0:P.hours):"",M=String((P==null?void 0:P.MemberID)||(P==null?void 0:P.memberid)||(P==null?void 0:P.member)||(P==null?void 0:P.Member)||(P==null?void 0:P.id)||"").trim(),X=(a||[]).find(de=>String((de==null?void 0:de.MemberID)||(de==null?void 0:de.memberid)||(de==null?void 0:de.id)||"").trim()===M)||null,B=X?Yc(X):String((P==null?void 0:P.NickName)||(P==null?void 0:P.nickname)||(P==null?void 0:P.Member)||(P==null?void 0:P.member)||"")||"";return c.jsxs("tr",{style:{cursor:"pointer"},onClick:()=>d(P),children:[c.jsx("td",{children:Q0(U)}),c.jsx("td",{style:{fontWeight:700},children:B}),c.jsx("td",{children:q}),c.jsx("td",{children:me}),c.jsx("td",{style:{textAlign:"center"},children:ae}),c.jsx("td",{children:String((P==null?void 0:P.Focus)||(P==null?void 0:P.focus)||"")})]},(U||"")+"|"+B+"|"+V)})})]})}),c.jsx(Fg,{open:!!o,onClose:()=>d(null),row:o,onCheckout:async P=>{try{await v()}catch{}d(null)}}),c.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8},children:c.jsx("div",{className:"table-range",children:W===0?"Showing 0 of 0":`Showing ${ee}${Z} of ${W}`})}),W>R&&c.jsx("div",{style:{textAlign:"center",marginTop:8},children:c.jsx("button",{className:"button",onClick:()=>F(P=>P<W?Math.min(P+20,W):20),children:R<W?`Load ${Math.min(20,W-R)} more`:"Show less"})})]})]})}const{fetchPricing:Ys}=Ae;function qL(){const[t,e]=k.useState(""),[n,r]=k.useState("Staff"),[i,s]=k.useState(""),[a,u]=k.useState(!1),[o,d]=k.useState(""),[h,f]=k.useState(null),[p,g]=k.useState(""),[b,N]=k.useState([]),[D,v]=k.useState(null),[w,C]=k.useState(""),O={padding:"8px 12px",fontSize:14,lineHeight:"1",minHeight:36},[R,F]=k.useState([]),[E,x]=k.useState(""),[j,S]=k.useState(""),[_,I]=k.useState([]),[T,te]=k.useState("No"),[K,Y]=k.useState("No"),[ce,L]=k.useState(""),[G,z]=k.useState(""),[$,W]=k.useState(!1),[ee,Z]=k.useState(""),[ie,P]=k.useState("");k.useEffect(()=>{let M=!0;return(async()=>{try{const X=await at.fetchWithAuth("/products");if(!M)return;if(!X.ok){F([]);return}const B=await X.json().catch(()=>[]);F(B||[])}catch{F([])}})(),()=>{M=!1}},[]),k.useEffect(()=>{let M=!0;return(async()=>{try{const X=await Ys();if(!M)return;I((X==null?void 0:X.rows)||(X==null?void 0:X.data)||[])}catch{I([])}})(),()=>{M=!1}},[]);const V=(()=>{const M={};(_||[]).forEach(B=>{const de=String(B.Particulars||B.particulars||B.name||"").trim();de&&(M[de.toLowerCase()]=B)});const X=[];return(_||[]).forEach(B=>{const de=String(B.Particulars||B.particulars||B.name||"").trim();de&&X.push({id:B.id||B.ID||B._id||null,particulars:de,gym:(B["Gym membership"]??B["Gym Membership"]??B.gym_membership??B.is_gym_membership??"")||"",coach:(B["Coach subscription"]??B["Coach Subscription"]??B.coach_subscription??B.is_coach_subscription??"")||"",cost:B.Cost||B.cost||B.Price||B.price||"",validity:B.Validity||B.validity||B.validity_days||B.ValidityDays||0,source:"pricing",raw:B})}),(R||[]).forEach(B=>{const de=String(B.name||B.Particulars||B.particulars||"").trim();de&&(M[de.toLowerCase()]||X.push({id:B.id||null,particulars:de,gym:(B.is_gym_membership||B.is_gym||B.gym,B.is_gym_membership||B.gym?"Yes":"No"),coach:(B.is_coach_subscription||B.is_coach||B.coach,B.is_coach_subscription||B.coach?"Yes":"No"),cost:B.price||B.Cost||B.cost||"",validity:B.validity_days||B.Validity||B.validity||0,source:"products",raw:B}))}),X})(),U=(()=>{const M=[],X=[],B=[],de=[];return V.forEach(re=>{const pe=String(re.gym||"").toLowerCase().startsWith("y"),le=String(re.coach||"").toLowerCase().startsWith("y");pe&&!le?M.push(re):!pe&&le?X.push(re):pe&&le?B.push(re):de.push(re)}),{gymOnly:M,coachOnly:X,bundle:B,merch:de}})();k.useEffect(()=>{let M=!0;return(async()=>{var X;try{const B=await at.fetchWithAuth("/users");if(!M)return;if(B&&B.ok){const de=await B.json().catch(()=>[]);N(de||[]);return}try{const de=await at.fetchWithAuth("/auth/me");if(de&&de.ok){const re=await de.json().catch(()=>({})),pe=((X=re==null?void 0:re.user)==null?void 0:X.username)||"";N(pe?[{id:null,username:pe}]:[]);return}}catch{}N([])}catch{}})(),()=>{M=!1}},[]);const q=async()=>{try{let M;try{M=await at.fetchWithAuth("/users")}catch{M=null}if(!M||!M.ok)try{const B=`${window.location.protocol}//${window.location.hostname}:4000`,de=at.getToken&&at.getToken(),re={};de&&(re.Authorization=`Bearer ${de}`);const pe=await fetch(`${B}/users`,{headers:re});if(!pe.ok){N([]);return}const le=await pe.json().catch(()=>[]);N(le||[]);return}catch{N([]);return}const X=await M.json().catch(()=>[]);N(X||[])}catch{N([])}},se=async()=>{try{const M=await at.fetchWithAuth("/products");if(!M.ok)return;const X=await M.json().catch(()=>[]);F(X||[])}catch{}},me=async M=>{if(M&&M.preventDefault(),s(""),!t)return s("Please enter username");u(!0);try{const X=await at.fetchWithAuth("/staff",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({full_name:t,role:n})});if(!X.ok){const de=await X.json().catch(()=>({}));return s(de.error||"Failed to add staff")}const B=await X.json().catch(()=>({}));try{const de=Math.random().toString(36).slice(-10),re=o||de;let pe;try{pe=await at.fetchWithAuth("/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:re,role:n==="Admin"?"admin":"staff"})})}catch{pe=null}if(!pe||!pe.ok)try{const le=`${window.location.protocol}//${window.location.hostname}:4000`,xe=at.getToken&&at.getToken(),Qe={"Content-Type":"application/json"};xe&&(Qe.Authorization=`Bearer ${xe}`);const rt=await fetch(`${le}/users`,{method:"POST",headers:Qe,body:JSON.stringify({username:t,password:re,role:n==="Admin"?"admin":"staff"})});if(!rt.ok){let ge="";try{ge=await rt.text()}catch{ge=""}s(`Staff added. User creation failed: ${rt.status} ${ge||rt.statusText||"error"}`),e(""),d(""),u(!1);return}await q(),s(`Staff added. User created (password: ${re})`),e(""),d(""),u(!1);return}catch{s("Staff added. User creation failed (network)"),e(""),d(""),u(!1);return}try{await pe.json().catch(()=>({}))}catch{}await q(),s(`Staff added. User created (password: ${re})`),e(""),d(""),u(!1)}catch{s("Staff added. User creation failed"),e(""),d(""),u(!1);return}}catch{s("Server error"),u(!1)}},ae=M=>{if(!M.id){s("Cannot change status for current user from here");return}(async()=>{try{const X=!M.active;if(!(await at.fetchWithAuth(`/users/${M.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...M,active:X})})).ok)return s("Update failed");await q(),s(X?"User activated":"User deactivated")}catch{s("Server error")}})()};return c.jsx("div",{className:"content",children:c.jsxs("div",{className:"panel",children:[c.jsx("div",{className:"panel-header",children:"Admin Console"}),c.jsx("div",{style:{color:"var(--muted)",marginBottom:8},children:"Add staff accounts and manage products/services."}),c.jsxs("div",{className:"panel",style:{marginTop:12},children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsx("div",{className:"panel-header",children:"Users"}),c.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[c.jsx("div",{style:{color:"var(--muted)",fontSize:13}}),c.jsx("button",{className:"button",style:O,onClick:()=>{q(),s("Refreshed users")},children:"Refresh"})]})]}),c.jsxs("div",{style:{marginTop:6},children:[c.jsxs("form",{onSubmit:me,style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap",marginBottom:12},children:[c.jsx("input",{className:"input-compact",value:t,onChange:M=>e(M.target.value),placeholder:"username (e.g. jsmith)",style:{width:240}}),c.jsxs("select",{className:"select-compact",value:n,onChange:M=>r(M.target.value),style:{width:140},children:[c.jsx("option",{children:"Staff"}),c.jsx("option",{children:"Admin"})]}),c.jsx("input",{type:"password",className:"input-compact",placeholder:"password (optional)",value:o,onChange:M=>d(M.target.value),style:{width:180}}),c.jsx("button",{type:"submit",className:"button btn-compact",disabled:a,style:O,children:"Add"}),a&&c.jsx("div",{style:{color:"var(--muted)",marginLeft:8},children:"Adding..."})]}),c.jsx("div",{style:{marginTop:0,color:"var(--muted)",fontSize:13,marginBottom:12},children:"Creates a staff record; a login user will be created automatically (you may provide a password)."}),c.jsxs("ul",{style:{listStyle:"none",paddingLeft:0},children:[b.map(M=>c.jsxs("li",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 0",borderBottom:"1px solid var(--light-border)"},children:[c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:700},children:M.username}),c.jsx("div",{style:{color:"var(--muted)",fontSize:13},children:M.role||(M.id?"":"You")})]}),c.jsx("div",{style:{display:"flex",gap:8,alignItems:"center"},children:D===(M.id??"self")?c.jsxs(c.Fragment,{children:[c.jsx("input",{className:"input-compact",value:w,onChange:X=>C(X.target.value),placeholder:"new password",style:{width:140}}),c.jsx("button",{className:"button btn-compact",style:O,onClick:async()=>{if(!w)return s("Enter new password");try{let X;if(M.id?X=await at.fetchWithAuth(`/api/users/${M.id}/password`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:w})}):X=await at.fetchWithAuth("/api/users/self/password",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:w})}),!X.ok){const B=await X.json().catch(()=>({}));s(B.error||"Reset failed");return}s("Password reset"),v(null),C(""),await q()}catch{s("Server error")}},children:"Save"}),c.jsx("button",{className:"button",style:O,onClick:()=>{v(null),C("")},children:"Cancel"})]}):c.jsxs(c.Fragment,{children:[c.jsx("button",{className:"button btn-compact",style:O,onClick:()=>{v(M.id??"self"),C("")},children:"Reset"}),M.id?c.jsx("button",{className:"button",style:O,onClick:()=>ae(M),children:M.active??!0?"Deactivate":"Activate"}):null]})})]},M.id??M.username)),b.length===0&&c.jsx("li",{style:{color:"#888",padding:12},children:"No users found."})]})]}),c.jsx("div",{className:"panel-header",style:{marginTop:18},children:"Pricing Rules"}),c.jsxs("div",{style:{marginTop:8},children:[c.jsx("div",{style:{color:"var(--muted)",marginBottom:8},children:"This table lists the product rules used by the app to decide whether a Particulars value grants gym access and/or coach subscription."}),c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[c.jsx("div",{style:{color:"var(--muted)"},children:"This table lists the product rules used by the app to decide whether a Particulars value grants gym access and/or coach subscription."}),c.jsx("div",{children:$?c.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[c.jsx("input",{placeholder:"Merchandise name",value:ee,onChange:M=>Z(M.target.value),style:{width:240}}),c.jsx("input",{placeholder:"Price",value:ie,onChange:M=>P(M.target.value),style:{width:120}}),c.jsx("button",{className:"button",onClick:async()=>{if(!ee)return s("Enter merchandise name");try{const M={Particulars:ee,Cost:Number(ie)||0,Validity:0,"Gym membership":"No","Coach subscription":"No"};await Ae.addPricing(M);const X=await Ys();I((X==null?void 0:X.rows)||[]),Z(""),P(""),W(!1),s("Merchandise added")}catch{s("Add failed")}},children:"Add"}),c.jsx("button",{className:"button",onClick:()=>{W(!1),Z(""),P("")},children:"Cancel"})]}):c.jsx("button",{className:"button",onClick:()=>W(!0),children:"Add Merchandise"})})]}),c.jsxs("table",{className:"aligned",style:{width:"100%",borderCollapse:"collapse"},children:[c.jsxs("colgroup",{children:[c.jsx("col",{style:{width:"36%"}}),c.jsx("col",{style:{width:"14%"}}),c.jsx("col",{style:{width:"14%"}}),c.jsx("col",{style:{width:"14%"}}),c.jsx("col",{style:{width:"12%"}}),c.jsx("col",{style:{width:"10%"}})]}),c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Particulars"}),c.jsx("th",{children:"Gym Membership"}),c.jsx("th",{children:"Coach Subscription"}),c.jsx("th",{children:"Cost"}),c.jsx("th",{children:"Validity (days)"}),c.jsx("th",{children:"Actions"})]})}),c.jsx("tbody",{children:U.gymOnly.length+U.coachOnly.length+U.bundle.length+U.merch.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:6,style:{color:"#888",padding:12},children:"No pricing rules configured."})}):c.jsxs(c.Fragment,{children:[U.gymOnly.length>0&&c.jsxs(c.Fragment,{children:[c.jsx("tr",{style:{background:"var(--muted-background)",fontWeight:700},children:c.jsx("td",{colSpan:6,style:{padding:8},children:"Gym Membership Only"})}),U.gymOnly.map(M=>{const X=h===(M.id||M.particulars);return c.jsxs("tr",{style:{borderTop:"1px solid var(--light-border)"},children:[c.jsx("td",{style:{padding:"6px 8px"},children:M.particulars}),c.jsx("td",{style:{textAlign:"center"},children:M.gym}),c.jsx("td",{style:{textAlign:"center"},children:M.coach}),c.jsx("td",{style:{textAlign:"center"},children:X?c.jsx("input",{value:p,onChange:B=>g(B.target.value),style:{width:96}}):M.cost||""}),c.jsx("td",{style:{textAlign:"center"},children:M.validity||""}),c.jsx("td",{style:{textAlign:"right"},children:X?c.jsxs(c.Fragment,{children:[c.jsx("button",{className:"button",onClick:async()=>{try{if(M.source==="pricing"){await Ae.updatePricing(M.id,{Cost:Number(p)||0});const B=await Ys();I((B==null?void 0:B.rows)||[])}else M.source==="products"&&M.id&&(await at.fetchWithAuth(`/products/${M.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...M.raw,price:Number(p)||0})}),await se());f(null),g(""),s("Pricing updated")}catch{s("Update failed")}},children:"Save"}),c.jsx("button",{className:"button",onClick:()=>{f(null),g("")},children:"Cancel"})]}):c.jsx("button",{className:"button",onClick:()=>{f(M.id||M.particulars),g(M.cost||"")},children:"Edit"})})]},M.id||M.particulars)})]}),U.coachOnly.length>0&&c.jsxs(c.Fragment,{children:[c.jsx("tr",{style:{background:"var(--muted-background)",fontWeight:700},children:c.jsx("td",{colSpan:6,style:{padding:8},children:"Coach Subscription Only"})}),U.coachOnly.map(M=>{const X=h===(M.id||M.particulars);return c.jsxs("tr",{style:{borderTop:"1px solid var(--light-border)"},children:[c.jsx("td",{style:{padding:"6px 8px"},children:M.particulars}),c.jsx("td",{style:{textAlign:"center"},children:M.gym}),c.jsx("td",{style:{textAlign:"center"},children:M.coach}),c.jsx("td",{style:{textAlign:"center"},children:X?c.jsx("input",{value:p,onChange:B=>g(B.target.value),style:{width:96}}):M.cost||""}),c.jsx("td",{style:{textAlign:"center"},children:M.validity||""}),c.jsx("td",{style:{textAlign:"right"},children:X?c.jsxs(c.Fragment,{children:[c.jsx("button",{className:"button",onClick:async()=>{try{if(M.source==="pricing"){await Ae.updatePricing(M.id,{Cost:Number(p)||0});const B=await Ys();I((B==null?void 0:B.rows)||[])}else M.source==="products"&&M.id&&(await at.fetchWithAuth(`/products/${M.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...M.raw,price:Number(p)||0})}),await se());f(null),g(""),s("Pricing updated")}catch{s("Update failed")}},children:"Save"}),c.jsx("button",{className:"button",onClick:()=>{f(null),g("")},children:"Cancel"})]}):c.jsx("button",{className:"button",onClick:()=>{f(M.id||M.particulars),g(M.cost||"")},children:"Edit"})})]},M.id||M.particulars)})]}),U.bundle.length>0&&c.jsxs(c.Fragment,{children:[c.jsx("tr",{style:{background:"var(--muted-background)",fontWeight:700},children:c.jsx("td",{colSpan:6,style:{padding:8},children:"Gym & Coach Bundle"})}),U.bundle.map(M=>{const X=h===(M.id||M.particulars);return c.jsxs("tr",{style:{borderTop:"1px solid var(--light-border)"},children:[c.jsx("td",{style:{padding:"6px 8px"},children:M.particulars}),c.jsx("td",{style:{textAlign:"center"},children:M.gym}),c.jsx("td",{style:{textAlign:"center"},children:M.coach}),c.jsx("td",{style:{textAlign:"center"},children:X?c.jsx("input",{value:p,onChange:B=>g(B.target.value),style:{width:96}}):M.cost||""}),c.jsx("td",{style:{textAlign:"center"},children:M.validity||""}),c.jsx("td",{style:{textAlign:"right"},children:X?c.jsxs(c.Fragment,{children:[c.jsx("button",{className:"button",onClick:async()=>{try{if(M.source==="pricing"){await Ae.updatePricing(M.id,{Cost:Number(p)||0});const B=await Ys();I((B==null?void 0:B.rows)||[])}else M.source==="products"&&M.id&&(await at.fetchWithAuth(`/products/${M.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...M.raw,price:Number(p)||0})}),await se());f(null),g(""),s("Pricing updated")}catch{s("Update failed")}},children:"Save"}),c.jsx("button",{className:"button",onClick:()=>{f(null),g("")},children:"Cancel"})]}):c.jsx("button",{className:"button",onClick:()=>{f(M.id||M.particulars),g(M.cost||"")},children:"Edit"})})]},M.id||M.particulars)})]}),U.merch.length>0&&c.jsxs(c.Fragment,{children:[c.jsx("tr",{style:{background:"var(--muted-background)",fontWeight:700},children:c.jsx("td",{colSpan:6,style:{padding:8},children:"Merchandise"})}),U.merch.map(M=>{const X=h===(M.id||M.particulars);return c.jsxs("tr",{style:{borderTop:"1px solid var(--light-border)"},children:[c.jsx("td",{style:{padding:"6px 8px"},children:M.particulars}),c.jsx("td",{style:{textAlign:"center"},children:M.gym}),c.jsx("td",{style:{textAlign:"center"},children:M.coach}),c.jsx("td",{style:{textAlign:"center"},children:X?c.jsx("input",{value:p,onChange:B=>g(B.target.value),style:{width:96}}):M.cost||""}),c.jsx("td",{style:{textAlign:"center"},children:M.validity||""}),c.jsx("td",{style:{textAlign:"right"},children:X?c.jsxs(c.Fragment,{children:[c.jsx("button",{className:"button",onClick:async()=>{try{if(M.source==="pricing"){await Ae.updatePricing(M.id,{Cost:Number(p)||0});const B=await Ys();I((B==null?void 0:B.rows)||[])}else M.source==="products"&&M.id&&(await at.fetchWithAuth(`/products/${M.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...M.raw,price:Number(p)||0})}),await se());f(null),g(""),s("Pricing updated")}catch{s("Update failed")}},children:"Save"}),c.jsx("button",{className:"button",onClick:()=>{f(null),g("")},children:"Cancel"})]}):c.jsx("button",{className:"button",onClick:()=>{f(M.id||M.particulars),g(M.cost||"")},children:"Edit"})})]},M.id||M.particulars)})]})]})})]})]})]}),i&&c.jsx("div",{style:{marginTop:12,color:"#2b7",fontWeight:600},children:i})]})})}function WL(){const[t,e]=k.useState([]);return k.useEffect(()=>{const n=en.on("modal:error",r=>{const i=Date.now()+Math.random(),s={id:i,message:(r==null?void 0:r.message)||"An error occurred",source:(r==null?void 0:r.source)||""};e(a=>[...a,s]),setTimeout(()=>e(a=>a.filter(u=>u.id!==i)),6e3)});return()=>n()},[]),t.length?c.jsx("div",{style:{position:"fixed",top:20,right:20,zIndex:99999,display:"flex",flexDirection:"column",gap:8},children:t.map(n=>c.jsxs("div",{style:{background:"#111",color:"#fff",padding:"10px 14px",borderRadius:10,minWidth:240,boxShadow:"0 8px 24px rgba(0,0,0,.2)"},children:[c.jsx("div",{style:{fontWeight:700,marginBottom:4},children:n.source||"Error"}),c.jsx("div",{style:{fontSize:13},children:n.message})]},n.id))}):null}function GL({open:t,onClose:e}){const[n,r]=k.useState(""),[i,s]=k.useState(""),[a,u]=k.useState(!1),[o,d]=k.useState(""),h=n.length>=6&&n===i;async function f(p){if(p.preventDefault(),d(""),!h){d("Passwords must match and be at least 6 characters");return}u(!0);try{const g=await at.fetchWithAuth("/api/users/self/password",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:n})});if(!g.ok){const b=await g.text().catch(()=>"");d("Password change failed: "+(b||g.statusText||g.status));return}alert("Password changed successfully"),r(""),s(""),e&&e()}catch{d("Password change error")}finally{u(!1)}}return c.jsx(ts,{open:t,onClose:e,title:"Reset password",children:c.jsxs("form",{className:"reset-password-form",onSubmit:f,children:[c.jsxs("div",{className:"reset-password-row",children:[c.jsx("label",{children:"New password"}),c.jsx("input",{type:"password",value:n,onChange:p=>r(p.target.value),placeholder:"At least 6 characters",autoFocus:!0})]}),c.jsxs("div",{className:"reset-password-row",children:[c.jsx("label",{children:"Confirm password"}),c.jsx("input",{type:"password",value:i,onChange:p=>s(p.target.value),placeholder:"Repeat new password"})]}),o?c.jsx("div",{className:"reset-password-error",children:o}):null,c.jsxs("div",{className:"reset-password-actions",children:[c.jsx("button",{type:"button",className:"button",onClick:e,disabled:a,style:{background:"#eee",color:"#333"},children:"Cancel"}),c.jsx("button",{type:"submit",className:"button",disabled:!h||a,style:{opacity:!h||a?.6:1},children:a?c.jsx("span",{className:"spinner"}):"Change password"})]})]})})}function QL(){const[t,e]=k.useState(""),[n,r]=k.useState(""),[i,s]=k.useState(!1);k.useEffect(()=>{const o=at.getToken();o&&e(o)},[]);const a=o=>{e(o);try{at.setToken(o)}catch{}},u=()=>{e(""),localStorage.removeItem("authToken")};return k.useEffect(()=>{let o=!0;if(t){try{if(String(t).startsWith("local-token-")){r("FRONTDESK");return}}catch{}return(async()=>{try{const d=await at.fetchWithAuth("/auth/me");if(!o)return;if(!d.ok)return r("");const h=await d.json().catch(()=>({})),f=h&&h.user&&h.user.username?h.user.username:"";r(f||"")}catch{r("")}})(),()=>{o=!1}}},[t]),t?c.jsxs("div",{className:"app",children:[c.jsx(WL,{}),c.jsx(JP,{onLogout:u}),c.jsxs("div",{className:"main-content",children:[c.jsxs("div",{className:"topbar",children:[c.jsxs("div",{className:"topbar-left",children:["Welcome, ",String(n||"YOU").toUpperCase()]}),c.jsx("div",{className:"topbar-right",children:c.jsx("button",{className:"button",onClick:()=>s(!0),children:"Reset password"})})]}),c.jsx(GL,{open:i,onClose:()=>s(!1)}),c.jsxs(jT,{children:[c.jsx(hi,{path:"/",element:c.jsx(vR,{})}),c.jsx(hi,{path:"/attendance",element:c.jsx(HL,{})}),c.jsx(hi,{path:"/members",element:c.jsx(ML,{})}),c.jsx(hi,{path:"/members/:memberId",element:c.jsx(fR,{})}),c.jsx(hi,{path:"/checkin",element:c.jsx(BL,{})}),c.jsx(hi,{path:"/admin",element:c.jsx(qL,{})}),c.jsx(hi,{path:"*",element:c.jsx(TT,{to:"/",replace:!0})})]})]})]}):c.jsx(YP,{setToken:a})}class KL extends $e.Component{constructor(e){super(e),this.state={error:null,info:null}}componentDidCatch(e,n){this.setState({error:e,info:n})}render(){const{error:e,info:n}=this.state;return e?c.jsxs("div",{style:{padding:24,fontFamily:"sans-serif"},children:[c.jsx("h2",{style:{color:"#c92a2a"},children:"Application error"}),c.jsx("div",{style:{marginBottom:12,color:"#444"},children:"An uncaught error occurred while rendering the app."}),c.jsxs("details",{style:{whiteSpace:"pre-wrap",background:"#fff8f8",padding:12,borderRadius:6,border:"1px solid #ffd6d6"},children:[c.jsx("summary",{style:{cursor:"pointer",fontWeight:700},children:"Error details"}),c.jsx("div",{style:{marginTop:8},children:String(e&&e.toString())}),c.jsx("div",{style:{marginTop:8},children:n&&n.componentStack})]})]}):this.props.children}}try{console.log("[app] starting main.jsx",{base:"/",hasClientId:!1});const t=document.getElementById("root");t&&(t.innerHTML='<div style="padding:20px;font-family:sans-serif;color:#333">Mounting Kusgan app...</div>')}catch{}try{sf.createRoot(document.getElementById("root")).render(c.jsx($e.StrictMode,{children:c.jsx(GT,{clientId:"",children:c.jsx(FT,{children:c.jsx(KL,{children:c.jsx(QL,{})})})})}))}catch(t){console.error("[app] render failure",t);const e=document.getElementById("root");e&&(e.innerHTML=`<div style="padding:20px;font-family:sans-serif;color:#900"><h2>Render error</h2><pre>${String(t)}</pre></div>`)}export{k as C,Un as F,Ae as R,Qa as Y,mO as d,pO as h,yO as m,ts as n,en as s,c as u};
