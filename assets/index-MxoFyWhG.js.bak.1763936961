(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();function BE(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Fg={exports:{}},Fc={};var oS;function AR(){if(oS)return Fc;oS=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(s,a,l){var u=null;if(l!==void 0&&(u=""+l),a.key!==void 0&&(u=""+a.key),"key"in a){l={};for(var g in a)g!=="key"&&(l[g]=a[g])}else l=a;return a=l.ref,{$$typeof:n,type:s,key:u,ref:a!==void 0?a:null,props:l}}return Fc.Fragment=e,Fc.jsx=t,Fc.jsxs=t,Fc}var lS;function CR(){return lS||(lS=1,Fg.exports=AR()),Fg.exports}var f=CR(),Hg={exports:{}},et={};var cS;function xR(){if(cS)return et;cS=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),u=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),_=Symbol.for("react.activity"),S=Symbol.iterator;function C(I){return I===null||typeof I!="object"?null:(I=S&&I[S]||I["@@iterator"],typeof I=="function"?I:null)}var O={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},L=Object.assign,U={};function z(I,B,K){this.props=I,this.context=B,this.refs=U,this.updater=K||O}z.prototype.isReactComponent={},z.prototype.setState=function(I,B){if(typeof I!="object"&&typeof I!="function"&&I!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,I,B,"setState")},z.prototype.forceUpdate=function(I){this.updater.enqueueForceUpdate(this,I,"forceUpdate")};function X(){}X.prototype=z.prototype;function q(I,B,K){this.props=I,this.context=B,this.refs=U,this.updater=K||O}var ne=q.prototype=new X;ne.constructor=q,L(ne,z.prototype),ne.isPureReactComponent=!0;var ee=Array.isArray;function de(){}var k={H:null,A:null,T:null,S:null},M=Object.prototype.hasOwnProperty;function P(I,B,K){var le=K.ref;return{$$typeof:n,type:I,key:B,ref:le!==void 0?le:null,props:K}}function x(I,B){return P(I.type,B,I.props)}function A(I){return typeof I=="object"&&I!==null&&I.$$typeof===n}function V(I){var B={"=":"=0",":":"=2"};return"$"+I.replace(/[=:]/g,function(K){return B[K]})}var N=/\/+/g;function fe(I,B){return typeof I=="object"&&I!==null&&I.key!=null?V(""+I.key):B.toString(36)}function F(I){switch(I.status){case"fulfilled":return I.value;case"rejected":throw I.reason;default:switch(typeof I.status=="string"?I.then(de,de):(I.status="pending",I.then(function(B){I.status==="pending"&&(I.status="fulfilled",I.value=B)},function(B){I.status==="pending"&&(I.status="rejected",I.reason=B)})),I.status){case"fulfilled":return I.value;case"rejected":throw I.reason}}throw I}function D(I,B,K,le,we){var Ee=typeof I;(Ee==="undefined"||Ee==="boolean")&&(I=null);var Se=!1;if(I===null)Se=!0;else switch(Ee){case"bigint":case"string":case"number":Se=!0;break;case"object":switch(I.$$typeof){case n:case e:Se=!0;break;case v:return Se=I._init,D(Se(I._payload),B,K,le,we)}}if(Se)return we=we(I),Se=le===""?"."+fe(I,0):le,ee(we)?(K="",Se!=null&&(K=Se.replace(N,"$&/")+"/"),D(we,B,K,"",function(Ae){return Ae})):we!=null&&(A(we)&&(we=x(we,K+(we.key==null||I&&I.key===we.key?"":(""+we.key).replace(N,"$&/")+"/")+Se)),B.push(we)),1;Se=0;var Me=le===""?".":le+":";if(ee(I))for(var ke=0;ke<I.length;ke++)le=I[ke],Ee=Me+fe(le,ke),Se+=D(le,B,K,Ee,we);else if(ke=C(I),typeof ke=="function")for(I=ke.call(I),ke=0;!(le=I.next()).done;)le=le.value,Ee=Me+fe(le,ke++),Se+=D(le,B,K,Ee,we);else if(Ee==="object"){if(typeof I.then=="function")return D(F(I),B,K,le,we);throw B=String(I),Error("Objects are not valid as a React child (found: "+(B==="[object Object]"?"object with keys {"+Object.keys(I).join(", ")+"}":B)+"). If you meant to render a collection of children, use an array instead.")}return Se}function $(I,B,K){if(I==null)return I;var le=[],we=0;return D(I,le,"","",function(Ee){return B.call(K,Ee,we++)}),le}function Q(I){if(I._status===-1){var B=I._result;B=B(),B.then(function(K){(I._status===0||I._status===-1)&&(I._status=1,I._result=K)},function(K){(I._status===0||I._status===-1)&&(I._status=2,I._result=K)}),I._status===-1&&(I._status=0,I._result=B)}if(I._status===1)return I._result.default;throw I._result}var J=typeof reportError=="function"?reportError:function(I){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var B=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof I=="object"&&I!==null&&typeof I.message=="string"?String(I.message):String(I),error:I});if(!window.dispatchEvent(B))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",I);return}console.error(I)},Y={map:$,forEach:function(I,B,K){$(I,function(){B.apply(this,arguments)},K)},count:function(I){var B=0;return $(I,function(){B++}),B},toArray:function(I){return $(I,function(B){return B})||[]},only:function(I){if(!A(I))throw Error("React.Children.only expected to receive a single React element child.");return I}};return et.Activity=_,et.Children=Y,et.Component=z,et.Fragment=t,et.Profiler=a,et.PureComponent=q,et.StrictMode=s,et.Suspense=d,et.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,et.__COMPILER_RUNTIME={__proto__:null,c:function(I){return k.H.useMemoCache(I)}},et.cache=function(I){return function(){return I.apply(null,arguments)}},et.cacheSignal=function(){return null},et.cloneElement=function(I,B,K){if(I==null)throw Error("The argument must be a React element, but you passed "+I+".");var le=L({},I.props),we=I.key;if(B!=null)for(Ee in B.key!==void 0&&(we=""+B.key),B)!M.call(B,Ee)||Ee==="key"||Ee==="__self"||Ee==="__source"||Ee==="ref"&&B.ref===void 0||(le[Ee]=B[Ee]);var Ee=arguments.length-2;if(Ee===1)le.children=K;else if(1<Ee){for(var Se=Array(Ee),Me=0;Me<Ee;Me++)Se[Me]=arguments[Me+2];le.children=Se}return P(I.type,we,le)},et.createContext=function(I){return I={$$typeof:u,_currentValue:I,_currentValue2:I,_threadCount:0,Provider:null,Consumer:null},I.Provider=I,I.Consumer={$$typeof:l,_context:I},I},et.createElement=function(I,B,K){var le,we={},Ee=null;if(B!=null)for(le in B.key!==void 0&&(Ee=""+B.key),B)M.call(B,le)&&le!=="key"&&le!=="__self"&&le!=="__source"&&(we[le]=B[le]);var Se=arguments.length-2;if(Se===1)we.children=K;else if(1<Se){for(var Me=Array(Se),ke=0;ke<Se;ke++)Me[ke]=arguments[ke+2];we.children=Me}if(I&&I.defaultProps)for(le in Se=I.defaultProps,Se)we[le]===void 0&&(we[le]=Se[le]);return P(I,Ee,we)},et.createRef=function(){return{current:null}},et.forwardRef=function(I){return{$$typeof:g,render:I}},et.isValidElement=A,et.lazy=function(I){return{$$typeof:v,_payload:{_status:-1,_result:I},_init:Q}},et.memo=function(I,B){return{$$typeof:p,type:I,compare:B===void 0?null:B}},et.startTransition=function(I){var B=k.T,K={};k.T=K;try{var le=I(),we=k.S;we!==null&&we(K,le),typeof le=="object"&&le!==null&&typeof le.then=="function"&&le.then(de,J)}catch(Ee){J(Ee)}finally{B!==null&&K.types!==null&&(B.types=K.types),k.T=B}},et.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},et.use=function(I){return k.H.use(I)},et.useActionState=function(I,B,K){return k.H.useActionState(I,B,K)},et.useCallback=function(I,B){return k.H.useCallback(I,B)},et.useContext=function(I){return k.H.useContext(I)},et.useDebugValue=function(){},et.useDeferredValue=function(I,B){return k.H.useDeferredValue(I,B)},et.useEffect=function(I,B){return k.H.useEffect(I,B)},et.useEffectEvent=function(I){return k.H.useEffectEvent(I)},et.useId=function(){return k.H.useId()},et.useImperativeHandle=function(I,B,K){return k.H.useImperativeHandle(I,B,K)},et.useInsertionEffect=function(I,B){return k.H.useInsertionEffect(I,B)},et.useLayoutEffect=function(I,B){return k.H.useLayoutEffect(I,B)},et.useMemo=function(I,B){return k.H.useMemo(I,B)},et.useOptimistic=function(I,B){return k.H.useOptimistic(I,B)},et.useReducer=function(I,B,K){return k.H.useReducer(I,B,K)},et.useRef=function(I){return k.H.useRef(I)},et.useState=function(I){return k.H.useState(I)},et.useSyncExternalStore=function(I,B,K){return k.H.useSyncExternalStore(I,B,K)},et.useTransition=function(){return k.H.useTransition()},et.version="19.2.0",et}var uS;function ff(){return uS||(uS=1,Hg.exports=xR()),Hg.exports}var T=ff();const Ct=BE(T);var qg={exports:{}},Hc={},Gg={exports:{}},$g={};var hS;function RR(){return hS||(hS=1,(function(n){function e(D,$){var Q=D.length;D.push($);e:for(;0<Q;){var J=Q-1>>>1,Y=D[J];if(0<a(Y,$))D[J]=$,D[Q]=Y,Q=J;else break e}}function t(D){return D.length===0?null:D[0]}function s(D){if(D.length===0)return null;var $=D[0],Q=D.pop();if(Q!==$){D[0]=Q;e:for(var J=0,Y=D.length,I=Y>>>1;J<I;){var B=2*(J+1)-1,K=D[B],le=B+1,we=D[le];if(0>a(K,Q))le<Y&&0>a(we,K)?(D[J]=we,D[le]=Q,J=le):(D[J]=K,D[B]=Q,J=B);else if(le<Y&&0>a(we,Q))D[J]=we,D[le]=Q,J=le;else break e}}return $}function a(D,$){var Q=D.sortIndex-$.sortIndex;return Q!==0?Q:D.id-$.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var u=Date,g=u.now();n.unstable_now=function(){return u.now()-g}}var d=[],p=[],v=1,_=null,S=3,C=!1,O=!1,L=!1,U=!1,z=typeof setTimeout=="function"?setTimeout:null,X=typeof clearTimeout=="function"?clearTimeout:null,q=typeof setImmediate<"u"?setImmediate:null;function ne(D){for(var $=t(p);$!==null;){if($.callback===null)s(p);else if($.startTime<=D)s(p),$.sortIndex=$.expirationTime,e(d,$);else break;$=t(p)}}function ee(D){if(L=!1,ne(D),!O)if(t(d)!==null)O=!0,de||(de=!0,V());else{var $=t(p);$!==null&&F(ee,$.startTime-D)}}var de=!1,k=-1,M=5,P=-1;function x(){return U?!0:!(n.unstable_now()-P<M)}function A(){if(U=!1,de){var D=n.unstable_now();P=D;var $=!0;try{e:{O=!1,L&&(L=!1,X(k),k=-1),C=!0;var Q=S;try{t:{for(ne(D),_=t(d);_!==null&&!(_.expirationTime>D&&x());){var J=_.callback;if(typeof J=="function"){_.callback=null,S=_.priorityLevel;var Y=J(_.expirationTime<=D);if(D=n.unstable_now(),typeof Y=="function"){_.callback=Y,ne(D),$=!0;break t}_===t(d)&&s(d),ne(D)}else s(d);_=t(d)}if(_!==null)$=!0;else{var I=t(p);I!==null&&F(ee,I.startTime-D),$=!1}}break e}finally{_=null,S=Q,C=!1}$=void 0}}finally{$?V():de=!1}}}var V;if(typeof q=="function")V=function(){q(A)};else if(typeof MessageChannel<"u"){var N=new MessageChannel,fe=N.port2;N.port1.onmessage=A,V=function(){fe.postMessage(null)}}else V=function(){z(A,0)};function F(D,$){k=z(function(){D(n.unstable_now())},$)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(D){D.callback=null},n.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<D?Math.floor(1e3/D):5},n.unstable_getCurrentPriorityLevel=function(){return S},n.unstable_next=function(D){switch(S){case 1:case 2:case 3:var $=3;break;default:$=S}var Q=S;S=$;try{return D()}finally{S=Q}},n.unstable_requestPaint=function(){U=!0},n.unstable_runWithPriority=function(D,$){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var Q=S;S=D;try{return $()}finally{S=Q}},n.unstable_scheduleCallback=function(D,$,Q){var J=n.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?J+Q:J):Q=J,D){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=Q+Y,D={id:v++,callback:$,priorityLevel:D,startTime:Q,expirationTime:Y,sortIndex:-1},Q>J?(D.sortIndex=Q,e(p,D),t(d)===null&&D===t(p)&&(L?(X(k),k=-1):L=!0,F(ee,Q-J))):(D.sortIndex=Y,e(d,D),O||C||(O=!0,de||(de=!0,V()))),D},n.unstable_shouldYield=x,n.unstable_wrapCallback=function(D){var $=S;return function(){var Q=S;S=$;try{return D.apply(this,arguments)}finally{S=Q}}}})($g)),$g}var dS;function IR(){return dS||(dS=1,Gg.exports=RR()),Gg.exports}var Qg={exports:{}},ei={};var fS;function NR(){if(fS)return ei;fS=1;var n=ff();function e(d){var p="https://react.dev/errors/"+d;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)p+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+d+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var s={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(d,p,v){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:_==null?null:""+_,children:d,containerInfo:p,implementation:v}}var u=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function g(d,p){if(d==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return ei.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,ei.createPortal=function(d,p){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return l(d,p,null,v)},ei.flushSync=function(d){var p=u.T,v=s.p;try{if(u.T=null,s.p=2,d)return d()}finally{u.T=p,s.p=v,s.d.f()}},ei.preconnect=function(d,p){typeof d=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,s.d.C(d,p))},ei.prefetchDNS=function(d){typeof d=="string"&&s.d.D(d)},ei.preinit=function(d,p){if(typeof d=="string"&&p&&typeof p.as=="string"){var v=p.as,_=g(v,p.crossOrigin),S=typeof p.integrity=="string"?p.integrity:void 0,C=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;v==="style"?s.d.S(d,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:_,integrity:S,fetchPriority:C}):v==="script"&&s.d.X(d,{crossOrigin:_,integrity:S,fetchPriority:C,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},ei.preinitModule=function(d,p){if(typeof d=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var v=g(p.as,p.crossOrigin);s.d.M(d,{crossOrigin:v,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&s.d.M(d)},ei.preload=function(d,p){if(typeof d=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var v=p.as,_=g(v,p.crossOrigin);s.d.L(d,v,{crossOrigin:_,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},ei.preloadModule=function(d,p){if(typeof d=="string")if(p){var v=g(p.as,p.crossOrigin);s.d.m(d,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:v,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else s.d.m(d)},ei.requestFormReset=function(d){s.d.r(d)},ei.unstable_batchedUpdates=function(d,p){return d(p)},ei.useFormState=function(d,p,v){return u.H.useFormState(d,p,v)},ei.useFormStatus=function(){return u.H.useHostTransitionStatus()},ei.version="19.2.0",ei}var mS;function FE(){if(mS)return Qg.exports;mS=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Qg.exports=NR(),Qg.exports}var gS;function DR(){if(gS)return Hc;gS=1;var n=IR(),e=ff(),t=FE();function s(i){var r="https://react.dev/errors/"+i;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)r+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+i+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function l(i){var r=i,o=i;if(i.alternate)for(;r.return;)r=r.return;else{i=r;do r=i,(r.flags&4098)!==0&&(o=r.return),i=r.return;while(i)}return r.tag===3?o:null}function u(i){if(i.tag===13){var r=i.memoizedState;if(r===null&&(i=i.alternate,i!==null&&(r=i.memoizedState)),r!==null)return r.dehydrated}return null}function g(i){if(i.tag===31){var r=i.memoizedState;if(r===null&&(i=i.alternate,i!==null&&(r=i.memoizedState)),r!==null)return r.dehydrated}return null}function d(i){if(l(i)!==i)throw Error(s(188))}function p(i){var r=i.alternate;if(!r){if(r=l(i),r===null)throw Error(s(188));return r!==i?null:i}for(var o=i,c=r;;){var m=o.return;if(m===null)break;var y=m.alternate;if(y===null){if(c=m.return,c!==null){o=c;continue}break}if(m.child===y.child){for(y=m.child;y;){if(y===o)return d(m),i;if(y===c)return d(m),r;y=y.sibling}throw Error(s(188))}if(o.return!==c.return)o=m,c=y;else{for(var w=!1,R=m.child;R;){if(R===o){w=!0,o=m,c=y;break}if(R===c){w=!0,c=m,o=y;break}R=R.sibling}if(!w){for(R=y.child;R;){if(R===o){w=!0,o=y,c=m;break}if(R===c){w=!0,c=y,o=m;break}R=R.sibling}if(!w)throw Error(s(189))}}if(o.alternate!==c)throw Error(s(190))}if(o.tag!==3)throw Error(s(188));return o.stateNode.current===o?i:r}function v(i){var r=i.tag;if(r===5||r===26||r===27||r===6)return i;for(i=i.child;i!==null;){if(r=v(i),r!==null)return r;i=i.sibling}return null}var _=Object.assign,S=Symbol.for("react.element"),C=Symbol.for("react.transitional.element"),O=Symbol.for("react.portal"),L=Symbol.for("react.fragment"),U=Symbol.for("react.strict_mode"),z=Symbol.for("react.profiler"),X=Symbol.for("react.consumer"),q=Symbol.for("react.context"),ne=Symbol.for("react.forward_ref"),ee=Symbol.for("react.suspense"),de=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),M=Symbol.for("react.lazy"),P=Symbol.for("react.activity"),x=Symbol.for("react.memo_cache_sentinel"),A=Symbol.iterator;function V(i){return i===null||typeof i!="object"?null:(i=A&&i[A]||i["@@iterator"],typeof i=="function"?i:null)}var N=Symbol.for("react.client.reference");function fe(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===N?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case L:return"Fragment";case z:return"Profiler";case U:return"StrictMode";case ee:return"Suspense";case de:return"SuspenseList";case P:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case O:return"Portal";case q:return i.displayName||"Context";case X:return(i._context.displayName||"Context")+".Consumer";case ne:var r=i.render;return i=i.displayName,i||(i=r.displayName||r.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case k:return r=i.displayName||null,r!==null?r:fe(i.type)||"Memo";case M:r=i._payload,i=i._init;try{return fe(i(r))}catch{}}return null}var F=Array.isArray,D=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q={pending:!1,data:null,method:null,action:null},J=[],Y=-1;function I(i){return{current:i}}function B(i){0>Y||(i.current=J[Y],J[Y]=null,Y--)}function K(i,r){Y++,J[Y]=i.current,i.current=r}var le=I(null),we=I(null),Ee=I(null),Se=I(null);function Me(i,r){switch(K(Ee,r),K(we,i),K(le,null),r.nodeType){case 9:case 11:i=(i=r.documentElement)&&(i=i.namespaceURI)?N0(i):0;break;default:if(i=r.tagName,r=r.namespaceURI)r=N0(r),i=D0(r,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}B(le),K(le,i)}function ke(){B(le),B(we),B(Ee)}function Ae(i){i.memoizedState!==null&&K(Se,i);var r=le.current,o=D0(r,i.type);r!==o&&(K(we,i),K(le,o))}function De(i){we.current===i&&(B(le),B(we)),Se.current===i&&(B(Se),Lc._currentValue=Q)}var ze,G;function he(i){if(ze===void 0)try{throw Error()}catch(o){var r=o.stack.trim().match(/\n( *(at )?)/);ze=r&&r[1]||"",G=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ze+i+G}var oe=!1;function Te(i,r){if(!i||oe)return"";oe=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(r){var ye=function(){throw Error()};if(Object.defineProperty(ye.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ye,[])}catch(ue){var se=ue}Reflect.construct(i,[],ye)}else{try{ye.call()}catch(ue){se=ue}i.call(ye.prototype)}}else{try{throw Error()}catch(ue){se=ue}(ye=i())&&typeof ye.catch=="function"&&ye.catch(function(){})}}catch(ue){if(ue&&se&&typeof ue.stack=="string")return[ue.stack,se.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=c.DetermineComponentFrameRoot(),w=y[0],R=y[1];if(w&&R){var H=w.split(`
`),re=R.split(`
`);for(m=c=0;c<H.length&&!H[c].includes("DetermineComponentFrameRoot");)c++;for(;m<re.length&&!re[m].includes("DetermineComponentFrameRoot");)m++;if(c===H.length||m===re.length)for(c=H.length-1,m=re.length-1;1<=c&&0<=m&&H[c]!==re[m];)m--;for(;1<=c&&0<=m;c--,m--)if(H[c]!==re[m]){if(c!==1||m!==1)do if(c--,m--,0>m||H[c]!==re[m]){var me=`
`+H[c].replace(" at new "," at ");return i.displayName&&me.includes("<anonymous>")&&(me=me.replace("<anonymous>",i.displayName)),me}while(1<=c&&0<=m);break}}}finally{oe=!1,Error.prepareStackTrace=o}return(o=i?i.displayName||i.name:"")?he(o):""}function be(i,r){switch(i.tag){case 26:case 27:case 5:return he(i.type);case 16:return he("Lazy");case 13:return i.child!==r&&r!==null?he("Suspense Fallback"):he("Suspense");case 19:return he("SuspenseList");case 0:case 15:return Te(i.type,!1);case 11:return Te(i.type.render,!1);case 1:return Te(i.type,!0);case 31:return he("Activity");default:return""}}function Ce(i){try{var r="",o=null;do r+=be(i,o),o=i,i=i.return;while(i);return r}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var ae=Object.prototype.hasOwnProperty,Ne=n.unstable_scheduleCallback,We=n.unstable_cancelCallback,St=n.unstable_shouldYield,tn=n.unstable_requestPaint,xt=n.unstable_now,Tt=n.unstable_getCurrentPriorityLevel,wt=n.unstable_ImmediatePriority,Bt=n.unstable_UserBlockingPriority,Wt=n.unstable_NormalPriority,un=n.unstable_LowPriority,ci=n.unstable_IdlePriority,Pe=n.log,Ze=n.unstable_setDisableYieldValue,at=null,Xe=null;function Xt(i){if(typeof Pe=="function"&&Ze(i),Xe&&typeof Xe.setStrictMode=="function")try{Xe.setStrictMode(at,i)}catch{}}var lt=Math.clz32?Math.clz32:xe,kn=Math.log,Qt=Math.LN2;function xe(i){return i>>>=0,i===0?32:31-(kn(i)/Qt|0)|0}var Be=256,ct=262144,$e=4194304;function ve(i){var r=i&42;if(r!==0)return r;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Oe(i,r,o){var c=i.pendingLanes;if(c===0)return 0;var m=0,y=i.suspendedLanes,w=i.pingedLanes;i=i.warmLanes;var R=c&134217727;return R!==0?(c=R&~y,c!==0?m=ve(c):(w&=R,w!==0?m=ve(w):o||(o=R&~i,o!==0&&(m=ve(o))))):(R=c&~y,R!==0?m=ve(R):w!==0?m=ve(w):o||(o=c&~i,o!==0&&(m=ve(o)))),m===0?0:r!==0&&r!==m&&(r&y)===0&&(y=m&-m,o=r&-r,y>=o||y===32&&(o&4194048)!==0)?r:m}function Le(i,r){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&r)===0}function ut(i,r){switch(i){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function pn(){var i=$e;return $e<<=1,($e&62914560)===0&&($e=4194304),i}function He(i){for(var r=[],o=0;31>o;o++)r.push(i);return r}function mt(i,r){i.pendingLanes|=r,r!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function Ot(i,r,o,c,m,y){var w=i.pendingLanes;i.pendingLanes=o,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=o,i.entangledLanes&=o,i.errorRecoveryDisabledLanes&=o,i.shellSuspendCounter=0;var R=i.entanglements,H=i.expirationTimes,re=i.hiddenUpdates;for(o=w&~o;0<o;){var me=31-lt(o),ye=1<<me;R[me]=0,H[me]=-1;var se=re[me];if(se!==null)for(re[me]=null,me=0;me<se.length;me++){var ue=se[me];ue!==null&&(ue.lane&=-536870913)}o&=~ye}c!==0&&Ft(i,c,0),y!==0&&m===0&&i.tag!==0&&(i.suspendedLanes|=y&~(w&~r))}function Ft(i,r,o){i.pendingLanes|=r,i.suspendedLanes&=~r;var c=31-lt(r);i.entangledLanes|=r,i.entanglements[c]=i.entanglements[c]|1073741824|o&261930}function Si(i,r){var o=i.entangledLanes|=r;for(i=i.entanglements;o;){var c=31-lt(o),m=1<<c;m&r|i[c]&r&&(i[c]|=r),o&=~m}}function Xi(i,r){var o=r&-r;return o=(o&42)!==0?1:Zi(o),(o&(i.suspendedLanes|r))!==0?0:o}function Zi(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function ui(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function fr(){var i=$.p;return i!==0?i:(i=window.event,i===void 0?32:eS(i.type))}function wi(i,r){var o=$.p;try{return $.p=i,r()}finally{$.p=o}}var Pn=Math.random().toString(36).slice(2),En="__reactFiber$"+Pn,zn="__reactProps$"+Pn,mr="__reactContainer$"+Pn,Ao="__reactEvents$"+Pn,Yf="__reactListeners$"+Pn,Hu="__reactHandles$"+Pn,qu="__reactResources$"+Pn,gr="__reactMarker$"+Pn;function Co(i){delete i[En],delete i[zn],delete i[Ao],delete i[Yf],delete i[Hu]}function pr(i){var r=i[En];if(r)return r;for(var o=i.parentNode;o;){if(r=o[mr]||o[En]){if(o=r.alternate,r.child!==null||o!==null&&o.child!==null)for(i=L0(i);i!==null;){if(o=i[En])return o;i=L0(i)}return r}i=o,o=i.parentNode}return null}function Pi(i){if(i=i[En]||i[mr]){var r=i.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return i}return null}function Ei(i){var r=i.tag;if(r===5||r===26||r===27||r===6)return i.stateNode;throw Error(s(33))}function yr(i){var r=i[qu];return r||(r=i[qu]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function Tn(i){i[gr]=!0}var Gl=new Set,$l={};function vr(i,r){_r(i,r),_r(i+"Capture",r)}function _r(i,r){for($l[i]=r,i=0;i<r.length;i++)Gl.add(r[i])}var Ql=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Yl={},Kl={};function Gu(i){return ae.call(Kl,i)?!0:ae.call(Yl,i)?!1:Ql.test(i)?Kl[i]=!0:(Yl[i]=!0,!1)}function xo(i,r,o){if(Gu(r))if(o===null)i.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":i.removeAttribute(r);return;case"boolean":var c=r.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){i.removeAttribute(r);return}}i.setAttribute(r,""+o)}}function Ti(i,r,o){if(o===null)i.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(r);return}i.setAttribute(r,""+o)}}function An(i,r,o,c){if(c===null)i.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(o);return}i.setAttributeNS(r,o,""+c)}}function Bn(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Ts(i){var r=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function Wl(i,r,o){var c=Object.getOwnPropertyDescriptor(i.constructor.prototype,r);if(!i.hasOwnProperty(r)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var m=c.get,y=c.set;return Object.defineProperty(i,r,{configurable:!0,get:function(){return m.call(this)},set:function(w){o=""+w,y.call(this,w)}}),Object.defineProperty(i,r,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(w){o=""+w},stopTracking:function(){i._valueTracker=null,delete i[r]}}}}function Vt(i){if(!i._valueTracker){var r=Ts(i)?"checked":"value";i._valueTracker=Wl(i,r,""+i[r])}}function Da(i){if(!i)return!1;var r=i._valueTracker;if(!r)return!0;var o=r.getValue(),c="";return i&&(c=Ts(i)?i.checked?"true":"false":i.value),i=c,i!==o?(r.setValue(i),!0):!1}function br(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var Ma=/[\n"\\]/g;function hi(i){return i.replace(Ma,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function Ro(i,r,o,c,m,y,w,R){i.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?i.type=w:i.removeAttribute("type"),r!=null?w==="number"?(r===0&&i.value===""||i.value!=r)&&(i.value=""+Bn(r)):i.value!==""+Bn(r)&&(i.value=""+Bn(r)):w!=="submit"&&w!=="reset"||i.removeAttribute("value"),r!=null?Xl(i,w,Bn(r)):o!=null?Xl(i,w,Bn(o)):c!=null&&i.removeAttribute("value"),m==null&&y!=null&&(i.defaultChecked=!!y),m!=null&&(i.checked=m&&typeof m!="function"&&typeof m!="symbol"),R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"?i.name=""+Bn(R):i.removeAttribute("name")}function $u(i,r,o,c,m,y,w,R){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(i.type=y),r!=null||o!=null){if(!(y!=="submit"&&y!=="reset"||r!=null)){Vt(i);return}o=o!=null?""+Bn(o):"",r=r!=null?""+Bn(r):o,R||r===i.value||(i.value=r),i.defaultValue=r}c=c??m,c=typeof c!="function"&&typeof c!="symbol"&&!!c,i.checked=R?i.checked:!!c,i.defaultChecked=!!c,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(i.name=w),Vt(i)}function Xl(i,r,o){r==="number"&&br(i.ownerDocument)===i||i.defaultValue===""+o||(i.defaultValue=""+o)}function As(i,r,o,c){if(i=i.options,r){r={};for(var m=0;m<o.length;m++)r["$"+o[m]]=!0;for(o=0;o<i.length;o++)m=r.hasOwnProperty("$"+i[o].value),i[o].selected!==m&&(i[o].selected=m),m&&c&&(i[o].defaultSelected=!0)}else{for(o=""+Bn(o),r=null,m=0;m<i.length;m++){if(i[m].value===o){i[m].selected=!0,c&&(i[m].defaultSelected=!0);return}r!==null||i[m].disabled||(r=i[m])}r!==null&&(r.selected=!0)}}function Qu(i,r,o){if(r!=null&&(r=""+Bn(r),r!==i.value&&(i.value=r),o==null)){i.defaultValue!==r&&(i.defaultValue=r);return}i.defaultValue=o!=null?""+Bn(o):""}function Cs(i,r,o,c){if(r==null){if(c!=null){if(o!=null)throw Error(s(92));if(F(c)){if(1<c.length)throw Error(s(93));c=c[0]}o=c}o==null&&(o=""),r=o}o=Bn(r),i.defaultValue=o,c=i.textContent,c===o&&c!==""&&c!==null&&(i.value=c),Vt(i)}function di(i,r){if(r){var o=i.firstChild;if(o&&o===i.lastChild&&o.nodeType===3){o.nodeValue=r;return}}i.textContent=r}var Yu=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Zl(i,r,o){var c=r.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?i.setProperty(r,""):r==="float"?i.cssFloat="":i[r]="":c?i.setProperty(r,o):typeof o!="number"||o===0||Yu.has(r)?r==="float"?i.cssFloat=o:i[r]=(""+o).trim():i[r]=o+"px"}function Jl(i,r,o){if(r!=null&&typeof r!="object")throw Error(s(62));if(i=i.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||r!=null&&r.hasOwnProperty(c)||(c.indexOf("--")===0?i.setProperty(c,""):c==="float"?i.cssFloat="":i[c]="");for(var m in r)c=r[m],r.hasOwnProperty(m)&&o[m]!==c&&Zl(i,m,c)}else for(var y in r)r.hasOwnProperty(y)&&Zl(i,y,r[y])}function Io(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ku=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),xs=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function No(i){return xs.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function Ji(){}var ec=null;function Vi(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Rs=null,Sr=null;function Oa(i){var r=Pi(i);if(r&&(i=r.stateNode)){var o=i[zn]||null;e:switch(i=r.stateNode,r.type){case"input":if(Ro(i,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),r=o.name,o.type==="radio"&&r!=null){for(o=i;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+hi(""+r)+'"][type="radio"]'),r=0;r<o.length;r++){var c=o[r];if(c!==i&&c.form===i.form){var m=c[zn]||null;if(!m)throw Error(s(90));Ro(c,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(r=0;r<o.length;r++)c=o[r],c.form===i.form&&Da(c)}break e;case"textarea":Qu(i,o.value,o.defaultValue);break e;case"select":r=o.value,r!=null&&As(i,!!o.multiple,r,!1)}}}var Do=!1;function Is(i,r,o){if(Do)return i(r,o);Do=!0;try{var c=i(r);return c}finally{if(Do=!1,(Rs!==null||Sr!==null)&&(Fh(),Rs&&(r=Rs,i=Sr,Sr=Rs=null,Oa(r),i)))for(r=0;r<i.length;r++)Oa(i[r])}}function er(i,r){var o=i.stateNode;if(o===null)return null;var c=o[zn]||null;if(c===null)return null;o=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(i=i.type,c=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!c;break e;default:i=!1}if(i)return null;if(o&&typeof o!="function")throw Error(s(231,r,typeof o));return o}var Li=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=!1;if(Li)try{var Ht={};Object.defineProperty(Ht,"passive",{get:function(){ja=!0}}),window.addEventListener("test",Ht,Ht),window.removeEventListener("test",Ht,Ht)}catch{ja=!1}var wr=null,tc=null,ka=null;function nc(){if(ka)return ka;var i,r=tc,o=r.length,c,m="value"in wr?wr.value:wr.textContent,y=m.length;for(i=0;i<o&&r[i]===m[i];i++);var w=o-i;for(c=1;c<=w&&r[o-c]===m[y-c];c++);return ka=m.slice(i,1<c?1-c:void 0)}function Pa(i){var r=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&r===13&&(i=13)):i=r,i===10&&(i=13),32<=i||i===13?i:0}function $r(){return!0}function tr(){return!1}function $n(i){function r(o,c,m,y,w){this._reactName=o,this._targetInst=m,this.type=c,this.nativeEvent=y,this.target=w,this.currentTarget=null;for(var R in i)i.hasOwnProperty(R)&&(o=i[R],this[R]=o?o(y):y[R]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?$r:tr,this.isPropagationStopped=tr,this}return _(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=$r)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=$r)},persist:function(){},isPersistent:$r}),r}var Qr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Er=$n(Qr),Ns=_({},Qr,{view:0,detail:0}),ic=$n(Ns),Ds,Mo,Tr,Oo=_({},Ns,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ms,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Tr&&(Tr&&i.type==="mousemove"?(Ds=i.screenX-Tr.screenX,Mo=i.screenY-Tr.screenY):Mo=Ds=0,Tr=i),Ds)},movementY:function(i){return"movementY"in i?i.movementY:Mo}}),rc=$n(Oo),Va=_({},Oo,{dataTransfer:0}),Wu=$n(Va),Xu=_({},Ns,{relatedTarget:0}),La=$n(Xu),sc=_({},Qr,{animationName:0,elapsedTime:0,pseudoElement:0}),Zu=$n(sc),jo=_({},Qr,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Ju=$n(jo),eh=_({},Qr,{data:0}),Ar=$n(eh),th={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},nh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ih={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rh(i){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(i):(i=ih[i])?!!r[i]:!1}function Ms(){return rh}var ai=_({},Ns,{key:function(i){if(i.key){var r=th[i.key]||i.key;if(r!=="Unidentified")return r}return i.type==="keypress"?(i=Pa(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?nh[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ms,charCode:function(i){return i.type==="keypress"?Pa(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Pa(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),sh=$n(ai),ah=_({},Oo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Yr=$n(ah),h=_({},Ns,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ms}),b=$n(h),E=_({},Qr,{propertyName:0,elapsedTime:0,pseudoElement:0}),j=$n(E),te=_({},Oo,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),ce=$n(te),Re=_({},Qr,{newState:0,oldState:0}),it=$n(Re),yn=[9,13,27,32],Dt=Li&&"CompositionEvent"in window,nn=null;Li&&"documentMode"in document&&(nn=document.documentMode);var Ui=Li&&"TextEvent"in window&&!nn,Cr=Li&&(!Dt||nn&&8<nn&&11>=nn),nr=" ",ir=!1;function Ua(i,r){switch(i){case"keyup":return yn.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ko(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Po=!1;function KC(i,r){switch(i){case"compositionend":return ko(r);case"keypress":return r.which!==32?null:(ir=!0,nr);case"textInput":return i=r.data,i===nr&&ir?null:i;default:return null}}function WC(i,r){if(Po)return i==="compositionend"||!Dt&&Ua(i,r)?(i=nc(),ka=tc=wr=null,Po=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return Cr&&r.locale!=="ko"?null:r.data;default:return null}}var XC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Bv(i){var r=i&&i.nodeName&&i.nodeName.toLowerCase();return r==="input"?!!XC[i.type]:r==="textarea"}function Fv(i,r,o,c){Rs?Sr?Sr.push(c):Sr=[c]:Rs=c,r=Kh(r,"onChange"),0<r.length&&(o=new Er("onChange","change",null,o,c),i.push({event:o,listeners:r}))}var ac=null,oc=null;function ZC(i){T0(i,0)}function oh(i){var r=Ei(i);if(Da(r))return i}function Hv(i,r){if(i==="change")return r}var qv=!1;if(Li){var Kf;if(Li){var Wf="oninput"in document;if(!Wf){var Gv=document.createElement("div");Gv.setAttribute("oninput","return;"),Wf=typeof Gv.oninput=="function"}Kf=Wf}else Kf=!1;qv=Kf&&(!document.documentMode||9<document.documentMode)}function $v(){ac&&(ac.detachEvent("onpropertychange",Qv),oc=ac=null)}function Qv(i){if(i.propertyName==="value"&&oh(oc)){var r=[];Fv(r,oc,i,Vi(i)),Is(ZC,r)}}function JC(i,r,o){i==="focusin"?($v(),ac=r,oc=o,ac.attachEvent("onpropertychange",Qv)):i==="focusout"&&$v()}function ex(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return oh(oc)}function tx(i,r){if(i==="click")return oh(r)}function nx(i,r){if(i==="input"||i==="change")return oh(r)}function ix(i,r){return i===r&&(i!==0||1/i===1/r)||i!==i&&r!==r}var Ai=typeof Object.is=="function"?Object.is:ix;function lc(i,r){if(Ai(i,r))return!0;if(typeof i!="object"||i===null||typeof r!="object"||r===null)return!1;var o=Object.keys(i),c=Object.keys(r);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var m=o[c];if(!ae.call(r,m)||!Ai(i[m],r[m]))return!1}return!0}function Yv(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Kv(i,r){var o=Yv(i);i=0;for(var c;o;){if(o.nodeType===3){if(c=i+o.textContent.length,i<=r&&c>=r)return{node:o,offset:r-i};i=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Yv(o)}}function Wv(i,r){return i&&r?i===r?!0:i&&i.nodeType===3?!1:r&&r.nodeType===3?Wv(i,r.parentNode):"contains"in i?i.contains(r):i.compareDocumentPosition?!!(i.compareDocumentPosition(r)&16):!1:!1}function Xv(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var r=br(i.document);r instanceof i.HTMLIFrameElement;){try{var o=typeof r.contentWindow.location.href=="string"}catch{o=!1}if(o)i=r.contentWindow;else break;r=br(i.document)}return r}function Xf(i){var r=i&&i.nodeName&&i.nodeName.toLowerCase();return r&&(r==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||r==="textarea"||i.contentEditable==="true")}var rx=Li&&"documentMode"in document&&11>=document.documentMode,Vo=null,Zf=null,cc=null,Jf=!1;function Zv(i,r,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Jf||Vo==null||Vo!==br(c)||(c=Vo,"selectionStart"in c&&Xf(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),cc&&lc(cc,c)||(cc=c,c=Kh(Zf,"onSelect"),0<c.length&&(r=new Er("onSelect","select",null,r,o),i.push({event:r,listeners:c}),r.target=Vo)))}function za(i,r){var o={};return o[i.toLowerCase()]=r.toLowerCase(),o["Webkit"+i]="webkit"+r,o["Moz"+i]="moz"+r,o}var Lo={animationend:za("Animation","AnimationEnd"),animationiteration:za("Animation","AnimationIteration"),animationstart:za("Animation","AnimationStart"),transitionrun:za("Transition","TransitionRun"),transitionstart:za("Transition","TransitionStart"),transitioncancel:za("Transition","TransitionCancel"),transitionend:za("Transition","TransitionEnd")},em={},Jv={};Li&&(Jv=document.createElement("div").style,"AnimationEvent"in window||(delete Lo.animationend.animation,delete Lo.animationiteration.animation,delete Lo.animationstart.animation),"TransitionEvent"in window||delete Lo.transitionend.transition);function Ba(i){if(em[i])return em[i];if(!Lo[i])return i;var r=Lo[i],o;for(o in r)if(r.hasOwnProperty(o)&&o in Jv)return em[i]=r[o];return i}var e_=Ba("animationend"),t_=Ba("animationiteration"),n_=Ba("animationstart"),sx=Ba("transitionrun"),ax=Ba("transitionstart"),ox=Ba("transitioncancel"),i_=Ba("transitionend"),r_=new Map,tm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");tm.push("scrollEnd");function rr(i,r){r_.set(i,r),vr(r,[i])}var lh=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},zi=[],Uo=0,nm=0;function ch(){for(var i=Uo,r=nm=Uo=0;r<i;){var o=zi[r];zi[r++]=null;var c=zi[r];zi[r++]=null;var m=zi[r];zi[r++]=null;var y=zi[r];if(zi[r++]=null,c!==null&&m!==null){var w=c.pending;w===null?m.next=m:(m.next=w.next,w.next=m),c.pending=m}y!==0&&s_(o,m,y)}}function uh(i,r,o,c){zi[Uo++]=i,zi[Uo++]=r,zi[Uo++]=o,zi[Uo++]=c,nm|=c,i.lanes|=c,i=i.alternate,i!==null&&(i.lanes|=c)}function im(i,r,o,c){return uh(i,r,o,c),hh(i)}function Fa(i,r){return uh(i,null,null,r),hh(i)}function s_(i,r,o){i.lanes|=o;var c=i.alternate;c!==null&&(c.lanes|=o);for(var m=!1,y=i.return;y!==null;)y.childLanes|=o,c=y.alternate,c!==null&&(c.childLanes|=o),y.tag===22&&(i=y.stateNode,i===null||i._visibility&1||(m=!0)),i=y,y=y.return;return i.tag===3?(y=i.stateNode,m&&r!==null&&(m=31-lt(o),i=y.hiddenUpdates,c=i[m],c===null?i[m]=[r]:c.push(r),r.lane=o|536870912),y):null}function hh(i){if(50<Dc)throw Dc=0,dg=null,Error(s(185));for(var r=i.return;r!==null;)i=r,r=i.return;return i.tag===3?i.stateNode:null}var zo={};function lx(i,r,o,c){this.tag=i,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ci(i,r,o,c){return new lx(i,r,o,c)}function rm(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Kr(i,r){var o=i.alternate;return o===null?(o=Ci(i.tag,r,i.key,i.mode),o.elementType=i.elementType,o.type=i.type,o.stateNode=i.stateNode,o.alternate=i,i.alternate=o):(o.pendingProps=r,o.type=i.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=i.flags&65011712,o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,r=i.dependencies,o.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},o.sibling=i.sibling,o.index=i.index,o.ref=i.ref,o.refCleanup=i.refCleanup,o}function a_(i,r){i.flags&=65011714;var o=i.alternate;return o===null?(i.childLanes=0,i.lanes=r,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,r=o.dependencies,i.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),i}function dh(i,r,o,c,m,y){var w=0;if(c=i,typeof i=="function")rm(i)&&(w=1);else if(typeof i=="string")w=fR(i,o,le.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case P:return i=Ci(31,o,r,m),i.elementType=P,i.lanes=y,i;case L:return Ha(o.children,m,y,r);case U:w=8,m|=24;break;case z:return i=Ci(12,o,r,m|2),i.elementType=z,i.lanes=y,i;case ee:return i=Ci(13,o,r,m),i.elementType=ee,i.lanes=y,i;case de:return i=Ci(19,o,r,m),i.elementType=de,i.lanes=y,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case q:w=10;break e;case X:w=9;break e;case ne:w=11;break e;case k:w=14;break e;case M:w=16,c=null;break e}w=29,o=Error(s(130,i===null?"null":typeof i,"")),c=null}return r=Ci(w,o,r,m),r.elementType=i,r.type=c,r.lanes=y,r}function Ha(i,r,o,c){return i=Ci(7,i,c,r),i.lanes=o,i}function sm(i,r,o){return i=Ci(6,i,null,r),i.lanes=o,i}function o_(i){var r=Ci(18,null,null,0);return r.stateNode=i,r}function am(i,r,o){return r=Ci(4,i.children!==null?i.children:[],i.key,r),r.lanes=o,r.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},r}var l_=new WeakMap;function Bi(i,r){if(typeof i=="object"&&i!==null){var o=l_.get(i);return o!==void 0?o:(r={value:i,source:r,stack:Ce(r)},l_.set(i,r),r)}return{value:i,source:r,stack:Ce(r)}}var Bo=[],Fo=0,fh=null,uc=0,Fi=[],Hi=0,Os=null,xr=1,Rr="";function Wr(i,r){Bo[Fo++]=uc,Bo[Fo++]=fh,fh=i,uc=r}function c_(i,r,o){Fi[Hi++]=xr,Fi[Hi++]=Rr,Fi[Hi++]=Os,Os=i;var c=xr;i=Rr;var m=32-lt(c)-1;c&=~(1<<m),o+=1;var y=32-lt(r)+m;if(30<y){var w=m-m%5;y=(c&(1<<w)-1).toString(32),c>>=w,m-=w,xr=1<<32-lt(r)+m|o<<m|c,Rr=y+i}else xr=1<<y|o<<m|c,Rr=i}function om(i){i.return!==null&&(Wr(i,1),c_(i,1,0))}function lm(i){for(;i===fh;)fh=Bo[--Fo],Bo[Fo]=null,uc=Bo[--Fo],Bo[Fo]=null;for(;i===Os;)Os=Fi[--Hi],Fi[Hi]=null,Rr=Fi[--Hi],Fi[Hi]=null,xr=Fi[--Hi],Fi[Hi]=null}function u_(i,r){Fi[Hi++]=xr,Fi[Hi++]=Rr,Fi[Hi++]=Os,xr=r.id,Rr=r.overflow,Os=i}var Qn=null,Zt=null,bt=!1,js=null,qi=!1,cm=Error(s(519));function ks(i){var r=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw hc(Bi(r,i)),cm}function h_(i){var r=i.stateNode,o=i.type,c=i.memoizedProps;switch(r[En]=i,r[zn]=c,o){case"dialog":dt("cancel",r),dt("close",r);break;case"iframe":case"object":case"embed":dt("load",r);break;case"video":case"audio":for(o=0;o<Oc.length;o++)dt(Oc[o],r);break;case"source":dt("error",r);break;case"img":case"image":case"link":dt("error",r),dt("load",r);break;case"details":dt("toggle",r);break;case"input":dt("invalid",r),$u(r,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":dt("invalid",r);break;case"textarea":dt("invalid",r),Cs(r,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||r.textContent===""+o||c.suppressHydrationWarning===!0||R0(r.textContent,o)?(c.popover!=null&&(dt("beforetoggle",r),dt("toggle",r)),c.onScroll!=null&&dt("scroll",r),c.onScrollEnd!=null&&dt("scrollend",r),c.onClick!=null&&(r.onclick=Ji),r=!0):r=!1,r||ks(i,!0)}function d_(i){for(Qn=i.return;Qn;)switch(Qn.tag){case 5:case 31:case 13:qi=!1;return;case 27:case 3:qi=!0;return;default:Qn=Qn.return}}function Ho(i){if(i!==Qn)return!1;if(!bt)return d_(i),bt=!0,!1;var r=i.tag,o;if((o=r!==3&&r!==27)&&((o=r===5)&&(o=i.type,o=!(o!=="form"&&o!=="button")||xg(i.type,i.memoizedProps)),o=!o),o&&Zt&&ks(i),d_(i),r===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(s(317));Zt=V0(i)}else if(r===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(s(317));Zt=V0(i)}else r===27?(r=Zt,Ks(i.type)?(i=Mg,Mg=null,Zt=i):Zt=r):Zt=Qn?$i(i.stateNode.nextSibling):null;return!0}function qa(){Zt=Qn=null,bt=!1}function um(){var i=js;return i!==null&&(pi===null?pi=i:pi.push.apply(pi,i),js=null),i}function hc(i){js===null?js=[i]:js.push(i)}var hm=I(null),Ga=null,Xr=null;function Ps(i,r,o){K(hm,r._currentValue),r._currentValue=o}function Zr(i){i._currentValue=hm.current,B(hm)}function dm(i,r,o){for(;i!==null;){var c=i.alternate;if((i.childLanes&r)!==r?(i.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),i===o)break;i=i.return}}function fm(i,r,o,c){var m=i.child;for(m!==null&&(m.return=i);m!==null;){var y=m.dependencies;if(y!==null){var w=m.child;y=y.firstContext;e:for(;y!==null;){var R=y;y=m;for(var H=0;H<r.length;H++)if(R.context===r[H]){y.lanes|=o,R=y.alternate,R!==null&&(R.lanes|=o),dm(y.return,o,i),c||(w=null);break e}y=R.next}}else if(m.tag===18){if(w=m.return,w===null)throw Error(s(341));w.lanes|=o,y=w.alternate,y!==null&&(y.lanes|=o),dm(w,o,i),w=null}else w=m.child;if(w!==null)w.return=m;else for(w=m;w!==null;){if(w===i){w=null;break}if(m=w.sibling,m!==null){m.return=w.return,w=m;break}w=w.return}m=w}}function qo(i,r,o,c){i=null;for(var m=r,y=!1;m!==null;){if(!y){if((m.flags&524288)!==0)y=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var w=m.alternate;if(w===null)throw Error(s(387));if(w=w.memoizedProps,w!==null){var R=m.type;Ai(m.pendingProps.value,w.value)||(i!==null?i.push(R):i=[R])}}else if(m===Se.current){if(w=m.alternate,w===null)throw Error(s(387));w.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(i!==null?i.push(Lc):i=[Lc])}m=m.return}i!==null&&fm(r,i,o,c),r.flags|=262144}function mh(i){for(i=i.firstContext;i!==null;){if(!Ai(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function $a(i){Ga=i,Xr=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Yn(i){return f_(Ga,i)}function gh(i,r){return Ga===null&&$a(i),f_(i,r)}function f_(i,r){var o=r._currentValue;if(r={context:r,memoizedValue:o,next:null},Xr===null){if(i===null)throw Error(s(308));Xr=r,i.dependencies={lanes:0,firstContext:r},i.flags|=524288}else Xr=Xr.next=r;return o}var cx=typeof AbortController<"u"?AbortController:function(){var i=[],r=this.signal={aborted:!1,addEventListener:function(o,c){i.push(c)}};this.abort=function(){r.aborted=!0,i.forEach(function(o){return o()})}},ux=n.unstable_scheduleCallback,hx=n.unstable_NormalPriority,Cn={$$typeof:q,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function mm(){return{controller:new cx,data:new Map,refCount:0}}function dc(i){i.refCount--,i.refCount===0&&ux(hx,function(){i.controller.abort()})}var fc=null,gm=0,Go=0,$o=null;function dx(i,r){if(fc===null){var o=fc=[];gm=0,Go=vg(),$o={status:"pending",value:void 0,then:function(c){o.push(c)}}}return gm++,r.then(m_,m_),r}function m_(){if(--gm===0&&fc!==null){$o!==null&&($o.status="fulfilled");var i=fc;fc=null,Go=0,$o=null;for(var r=0;r<i.length;r++)(0,i[r])()}}function fx(i,r){var o=[],c={status:"pending",value:null,reason:null,then:function(m){o.push(m)}};return i.then(function(){c.status="fulfilled",c.value=r;for(var m=0;m<o.length;m++)(0,o[m])(r)},function(m){for(c.status="rejected",c.reason=m,m=0;m<o.length;m++)(0,o[m])(void 0)}),c}var g_=D.S;D.S=function(i,r){Zb=xt(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&dx(i,r),g_!==null&&g_(i,r)};var Qa=I(null);function pm(){var i=Qa.current;return i!==null?i:Yt.pooledCache}function ph(i,r){r===null?K(Qa,Qa.current):K(Qa,r.pool)}function p_(){var i=pm();return i===null?null:{parent:Cn._currentValue,pool:i}}var Qo=Error(s(460)),ym=Error(s(474)),yh=Error(s(542)),vh={then:function(){}};function y_(i){return i=i.status,i==="fulfilled"||i==="rejected"}function v_(i,r,o){switch(o=i[o],o===void 0?i.push(r):o!==r&&(r.then(Ji,Ji),r=o),r.status){case"fulfilled":return r.value;case"rejected":throw i=r.reason,b_(i),i;default:if(typeof r.status=="string")r.then(Ji,Ji);else{if(i=Yt,i!==null&&100<i.shellSuspendCounter)throw Error(s(482));i=r,i.status="pending",i.then(function(c){if(r.status==="pending"){var m=r;m.status="fulfilled",m.value=c}},function(c){if(r.status==="pending"){var m=r;m.status="rejected",m.reason=c}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw i=r.reason,b_(i),i}throw Ka=r,Qo}}function Ya(i){try{var r=i._init;return r(i._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(Ka=o,Qo):o}}var Ka=null;function __(){if(Ka===null)throw Error(s(459));var i=Ka;return Ka=null,i}function b_(i){if(i===Qo||i===yh)throw Error(s(483))}var Yo=null,mc=0;function _h(i){var r=mc;return mc+=1,Yo===null&&(Yo=[]),v_(Yo,i,r)}function gc(i,r){r=r.props.ref,i.ref=r!==void 0?r:null}function bh(i,r){throw r.$$typeof===S?Error(s(525)):(i=Object.prototype.toString.call(r),Error(s(31,i==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":i)))}function S_(i){function r(Z,W){if(i){var ie=Z.deletions;ie===null?(Z.deletions=[W],Z.flags|=16):ie.push(W)}}function o(Z,W){if(!i)return null;for(;W!==null;)r(Z,W),W=W.sibling;return null}function c(Z){for(var W=new Map;Z!==null;)Z.key!==null?W.set(Z.key,Z):W.set(Z.index,Z),Z=Z.sibling;return W}function m(Z,W){return Z=Kr(Z,W),Z.index=0,Z.sibling=null,Z}function y(Z,W,ie){return Z.index=ie,i?(ie=Z.alternate,ie!==null?(ie=ie.index,ie<W?(Z.flags|=67108866,W):ie):(Z.flags|=67108866,W)):(Z.flags|=1048576,W)}function w(Z){return i&&Z.alternate===null&&(Z.flags|=67108866),Z}function R(Z,W,ie,pe){return W===null||W.tag!==6?(W=sm(ie,Z.mode,pe),W.return=Z,W):(W=m(W,ie),W.return=Z,W)}function H(Z,W,ie,pe){var Ge=ie.type;return Ge===L?me(Z,W,ie.props.children,pe,ie.key):W!==null&&(W.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===M&&Ya(Ge)===W.type)?(W=m(W,ie.props),gc(W,ie),W.return=Z,W):(W=dh(ie.type,ie.key,ie.props,null,Z.mode,pe),gc(W,ie),W.return=Z,W)}function re(Z,W,ie,pe){return W===null||W.tag!==4||W.stateNode.containerInfo!==ie.containerInfo||W.stateNode.implementation!==ie.implementation?(W=am(ie,Z.mode,pe),W.return=Z,W):(W=m(W,ie.children||[]),W.return=Z,W)}function me(Z,W,ie,pe,Ge){return W===null||W.tag!==7?(W=Ha(ie,Z.mode,pe,Ge),W.return=Z,W):(W=m(W,ie),W.return=Z,W)}function ye(Z,W,ie){if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return W=sm(""+W,Z.mode,ie),W.return=Z,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case C:return ie=dh(W.type,W.key,W.props,null,Z.mode,ie),gc(ie,W),ie.return=Z,ie;case O:return W=am(W,Z.mode,ie),W.return=Z,W;case M:return W=Ya(W),ye(Z,W,ie)}if(F(W)||V(W))return W=Ha(W,Z.mode,ie,null),W.return=Z,W;if(typeof W.then=="function")return ye(Z,_h(W),ie);if(W.$$typeof===q)return ye(Z,gh(Z,W),ie);bh(Z,W)}return null}function se(Z,W,ie,pe){var Ge=W!==null?W.key:null;if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return Ge!==null?null:R(Z,W,""+ie,pe);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case C:return ie.key===Ge?H(Z,W,ie,pe):null;case O:return ie.key===Ge?re(Z,W,ie,pe):null;case M:return ie=Ya(ie),se(Z,W,ie,pe)}if(F(ie)||V(ie))return Ge!==null?null:me(Z,W,ie,pe,null);if(typeof ie.then=="function")return se(Z,W,_h(ie),pe);if(ie.$$typeof===q)return se(Z,W,gh(Z,ie),pe);bh(Z,ie)}return null}function ue(Z,W,ie,pe,Ge){if(typeof pe=="string"&&pe!==""||typeof pe=="number"||typeof pe=="bigint")return Z=Z.get(ie)||null,R(W,Z,""+pe,Ge);if(typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case C:return Z=Z.get(pe.key===null?ie:pe.key)||null,H(W,Z,pe,Ge);case O:return Z=Z.get(pe.key===null?ie:pe.key)||null,re(W,Z,pe,Ge);case M:return pe=Ya(pe),ue(Z,W,ie,pe,Ge)}if(F(pe)||V(pe))return Z=Z.get(ie)||null,me(W,Z,pe,Ge,null);if(typeof pe.then=="function")return ue(Z,W,ie,_h(pe),Ge);if(pe.$$typeof===q)return ue(Z,W,ie,gh(W,pe),Ge);bh(W,pe)}return null}function Ve(Z,W,ie,pe){for(var Ge=null,Rt=null,Fe=W,ot=W=0,pt=null;Fe!==null&&ot<ie.length;ot++){Fe.index>ot?(pt=Fe,Fe=null):pt=Fe.sibling;var It=se(Z,Fe,ie[ot],pe);if(It===null){Fe===null&&(Fe=pt);break}i&&Fe&&It.alternate===null&&r(Z,Fe),W=y(It,W,ot),Rt===null?Ge=It:Rt.sibling=It,Rt=It,Fe=pt}if(ot===ie.length)return o(Z,Fe),bt&&Wr(Z,ot),Ge;if(Fe===null){for(;ot<ie.length;ot++)Fe=ye(Z,ie[ot],pe),Fe!==null&&(W=y(Fe,W,ot),Rt===null?Ge=Fe:Rt.sibling=Fe,Rt=Fe);return bt&&Wr(Z,ot),Ge}for(Fe=c(Fe);ot<ie.length;ot++)pt=ue(Fe,Z,ot,ie[ot],pe),pt!==null&&(i&&pt.alternate!==null&&Fe.delete(pt.key===null?ot:pt.key),W=y(pt,W,ot),Rt===null?Ge=pt:Rt.sibling=pt,Rt=pt);return i&&Fe.forEach(function(ea){return r(Z,ea)}),bt&&Wr(Z,ot),Ge}function Qe(Z,W,ie,pe){if(ie==null)throw Error(s(151));for(var Ge=null,Rt=null,Fe=W,ot=W=0,pt=null,It=ie.next();Fe!==null&&!It.done;ot++,It=ie.next()){Fe.index>ot?(pt=Fe,Fe=null):pt=Fe.sibling;var ea=se(Z,Fe,It.value,pe);if(ea===null){Fe===null&&(Fe=pt);break}i&&Fe&&ea.alternate===null&&r(Z,Fe),W=y(ea,W,ot),Rt===null?Ge=ea:Rt.sibling=ea,Rt=ea,Fe=pt}if(It.done)return o(Z,Fe),bt&&Wr(Z,ot),Ge;if(Fe===null){for(;!It.done;ot++,It=ie.next())It=ye(Z,It.value,pe),It!==null&&(W=y(It,W,ot),Rt===null?Ge=It:Rt.sibling=It,Rt=It);return bt&&Wr(Z,ot),Ge}for(Fe=c(Fe);!It.done;ot++,It=ie.next())It=ue(Fe,Z,ot,It.value,pe),It!==null&&(i&&It.alternate!==null&&Fe.delete(It.key===null?ot:It.key),W=y(It,W,ot),Rt===null?Ge=It:Rt.sibling=It,Rt=It);return i&&Fe.forEach(function(TR){return r(Z,TR)}),bt&&Wr(Z,ot),Ge}function $t(Z,W,ie,pe){if(typeof ie=="object"&&ie!==null&&ie.type===L&&ie.key===null&&(ie=ie.props.children),typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case C:e:{for(var Ge=ie.key;W!==null;){if(W.key===Ge){if(Ge=ie.type,Ge===L){if(W.tag===7){o(Z,W.sibling),pe=m(W,ie.props.children),pe.return=Z,Z=pe;break e}}else if(W.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===M&&Ya(Ge)===W.type){o(Z,W.sibling),pe=m(W,ie.props),gc(pe,ie),pe.return=Z,Z=pe;break e}o(Z,W);break}else r(Z,W);W=W.sibling}ie.type===L?(pe=Ha(ie.props.children,Z.mode,pe,ie.key),pe.return=Z,Z=pe):(pe=dh(ie.type,ie.key,ie.props,null,Z.mode,pe),gc(pe,ie),pe.return=Z,Z=pe)}return w(Z);case O:e:{for(Ge=ie.key;W!==null;){if(W.key===Ge)if(W.tag===4&&W.stateNode.containerInfo===ie.containerInfo&&W.stateNode.implementation===ie.implementation){o(Z,W.sibling),pe=m(W,ie.children||[]),pe.return=Z,Z=pe;break e}else{o(Z,W);break}else r(Z,W);W=W.sibling}pe=am(ie,Z.mode,pe),pe.return=Z,Z=pe}return w(Z);case M:return ie=Ya(ie),$t(Z,W,ie,pe)}if(F(ie))return Ve(Z,W,ie,pe);if(V(ie)){if(Ge=V(ie),typeof Ge!="function")throw Error(s(150));return ie=Ge.call(ie),Qe(Z,W,ie,pe)}if(typeof ie.then=="function")return $t(Z,W,_h(ie),pe);if(ie.$$typeof===q)return $t(Z,W,gh(Z,ie),pe);bh(Z,ie)}return typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint"?(ie=""+ie,W!==null&&W.tag===6?(o(Z,W.sibling),pe=m(W,ie),pe.return=Z,Z=pe):(o(Z,W),pe=sm(ie,Z.mode,pe),pe.return=Z,Z=pe),w(Z)):o(Z,W)}return function(Z,W,ie,pe){try{mc=0;var Ge=$t(Z,W,ie,pe);return Yo=null,Ge}catch(Fe){if(Fe===Qo||Fe===yh)throw Fe;var Rt=Ci(29,Fe,null,Z.mode);return Rt.lanes=pe,Rt.return=Z,Rt}finally{}}}var Wa=S_(!0),w_=S_(!1),Vs=!1;function vm(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function _m(i,r){i=i.updateQueue,r.updateQueue===i&&(r.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Ls(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Us(i,r,o){var c=i.updateQueue;if(c===null)return null;if(c=c.shared,(Mt&2)!==0){var m=c.pending;return m===null?r.next=r:(r.next=m.next,m.next=r),c.pending=r,r=hh(i),s_(i,null,o),r}return uh(i,c,r,o),hh(i)}function pc(i,r,o){if(r=r.updateQueue,r!==null&&(r=r.shared,(o&4194048)!==0)){var c=r.lanes;c&=i.pendingLanes,o|=c,r.lanes=o,Si(i,o)}}function bm(i,r){var o=i.updateQueue,c=i.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var m=null,y=null;if(o=o.firstBaseUpdate,o!==null){do{var w={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};y===null?m=y=w:y=y.next=w,o=o.next}while(o!==null);y===null?m=y=r:y=y.next=r}else m=y=r;o={baseState:c.baseState,firstBaseUpdate:m,lastBaseUpdate:y,shared:c.shared,callbacks:c.callbacks},i.updateQueue=o;return}i=o.lastBaseUpdate,i===null?o.firstBaseUpdate=r:i.next=r,o.lastBaseUpdate=r}var Sm=!1;function yc(){if(Sm){var i=$o;if(i!==null)throw i}}function vc(i,r,o,c){Sm=!1;var m=i.updateQueue;Vs=!1;var y=m.firstBaseUpdate,w=m.lastBaseUpdate,R=m.shared.pending;if(R!==null){m.shared.pending=null;var H=R,re=H.next;H.next=null,w===null?y=re:w.next=re,w=H;var me=i.alternate;me!==null&&(me=me.updateQueue,R=me.lastBaseUpdate,R!==w&&(R===null?me.firstBaseUpdate=re:R.next=re,me.lastBaseUpdate=H))}if(y!==null){var ye=m.baseState;w=0,me=re=H=null,R=y;do{var se=R.lane&-536870913,ue=se!==R.lane;if(ue?(gt&se)===se:(c&se)===se){se!==0&&se===Go&&(Sm=!0),me!==null&&(me=me.next={lane:0,tag:R.tag,payload:R.payload,callback:null,next:null});e:{var Ve=i,Qe=R;se=r;var $t=o;switch(Qe.tag){case 1:if(Ve=Qe.payload,typeof Ve=="function"){ye=Ve.call($t,ye,se);break e}ye=Ve;break e;case 3:Ve.flags=Ve.flags&-65537|128;case 0:if(Ve=Qe.payload,se=typeof Ve=="function"?Ve.call($t,ye,se):Ve,se==null)break e;ye=_({},ye,se);break e;case 2:Vs=!0}}se=R.callback,se!==null&&(i.flags|=64,ue&&(i.flags|=8192),ue=m.callbacks,ue===null?m.callbacks=[se]:ue.push(se))}else ue={lane:se,tag:R.tag,payload:R.payload,callback:R.callback,next:null},me===null?(re=me=ue,H=ye):me=me.next=ue,w|=se;if(R=R.next,R===null){if(R=m.shared.pending,R===null)break;ue=R,R=ue.next,ue.next=null,m.lastBaseUpdate=ue,m.shared.pending=null}}while(!0);me===null&&(H=ye),m.baseState=H,m.firstBaseUpdate=re,m.lastBaseUpdate=me,y===null&&(m.shared.lanes=0),qs|=w,i.lanes=w,i.memoizedState=ye}}function E_(i,r){if(typeof i!="function")throw Error(s(191,i));i.call(r)}function T_(i,r){var o=i.callbacks;if(o!==null)for(i.callbacks=null,i=0;i<o.length;i++)E_(o[i],r)}var Ko=I(null),Sh=I(0);function A_(i,r){i=os,K(Sh,i),K(Ko,r),os=i|r.baseLanes}function wm(){K(Sh,os),K(Ko,Ko.current)}function Em(){os=Sh.current,B(Ko),B(Sh)}var xi=I(null),Gi=null;function zs(i){var r=i.alternate;K(vn,vn.current&1),K(xi,i),Gi===null&&(r===null||Ko.current!==null||r.memoizedState!==null)&&(Gi=i)}function Tm(i){K(vn,vn.current),K(xi,i),Gi===null&&(Gi=i)}function C_(i){i.tag===22?(K(vn,vn.current),K(xi,i),Gi===null&&(Gi=i)):Bs()}function Bs(){K(vn,vn.current),K(xi,xi.current)}function Ri(i){B(xi),Gi===i&&(Gi=null),B(vn)}var vn=I(0);function wh(i){for(var r=i;r!==null;){if(r.tag===13){var o=r.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||Ng(o)||Dg(o)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===i)break;for(;r.sibling===null;){if(r.return===null||r.return===i)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Jr=0,rt=null,qt=null,xn=null,Eh=!1,Wo=!1,Xa=!1,Th=0,_c=0,Xo=null,mx=0;function hn(){throw Error(s(321))}function Am(i,r){if(r===null)return!1;for(var o=0;o<r.length&&o<i.length;o++)if(!Ai(i[o],r[o]))return!1;return!0}function Cm(i,r,o,c,m,y){return Jr=y,rt=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,D.H=i===null||i.memoizedState===null?cb:Bm,Xa=!1,y=o(c,m),Xa=!1,Wo&&(y=R_(r,o,c,m)),x_(i),y}function x_(i){D.H=wc;var r=qt!==null&&qt.next!==null;if(Jr=0,xn=qt=rt=null,Eh=!1,_c=0,Xo=null,r)throw Error(s(300));i===null||Rn||(i=i.dependencies,i!==null&&mh(i)&&(Rn=!0))}function R_(i,r,o,c){rt=i;var m=0;do{if(Wo&&(Xo=null),_c=0,Wo=!1,25<=m)throw Error(s(301));if(m+=1,xn=qt=null,i.updateQueue!=null){var y=i.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}D.H=ub,y=r(o,c)}while(Wo);return y}function gx(){var i=D.H,r=i.useState()[0];return r=typeof r.then=="function"?bc(r):r,i=i.useState()[0],(qt!==null?qt.memoizedState:null)!==i&&(rt.flags|=1024),r}function xm(){var i=Th!==0;return Th=0,i}function Rm(i,r,o){r.updateQueue=i.updateQueue,r.flags&=-2053,i.lanes&=~o}function Im(i){if(Eh){for(i=i.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}Eh=!1}Jr=0,xn=qt=rt=null,Wo=!1,_c=Th=0,Xo=null}function oi(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xn===null?rt.memoizedState=xn=i:xn=xn.next=i,xn}function _n(){if(qt===null){var i=rt.alternate;i=i!==null?i.memoizedState:null}else i=qt.next;var r=xn===null?rt.memoizedState:xn.next;if(r!==null)xn=r,qt=i;else{if(i===null)throw rt.alternate===null?Error(s(467)):Error(s(310));qt=i,i={memoizedState:qt.memoizedState,baseState:qt.baseState,baseQueue:qt.baseQueue,queue:qt.queue,next:null},xn===null?rt.memoizedState=xn=i:xn=xn.next=i}return xn}function Ah(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function bc(i){var r=_c;return _c+=1,Xo===null&&(Xo=[]),i=v_(Xo,i,r),r=rt,(xn===null?r.memoizedState:xn.next)===null&&(r=r.alternate,D.H=r===null||r.memoizedState===null?cb:Bm),i}function Ch(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return bc(i);if(i.$$typeof===q)return Yn(i)}throw Error(s(438,String(i)))}function Nm(i){var r=null,o=rt.updateQueue;if(o!==null&&(r=o.memoCache),r==null){var c=rt.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(r={data:c.data.map(function(m){return m.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),o===null&&(o=Ah(),rt.updateQueue=o),o.memoCache=r,o=r.data[r.index],o===void 0)for(o=r.data[r.index]=Array(i),c=0;c<i;c++)o[c]=x;return r.index++,o}function es(i,r){return typeof r=="function"?r(i):r}function xh(i){var r=_n();return Dm(r,qt,i)}function Dm(i,r,o){var c=i.queue;if(c===null)throw Error(s(311));c.lastRenderedReducer=o;var m=i.baseQueue,y=c.pending;if(y!==null){if(m!==null){var w=m.next;m.next=y.next,y.next=w}r.baseQueue=m=y,c.pending=null}if(y=i.baseState,m===null)i.memoizedState=y;else{r=m.next;var R=w=null,H=null,re=r,me=!1;do{var ye=re.lane&-536870913;if(ye!==re.lane?(gt&ye)===ye:(Jr&ye)===ye){var se=re.revertLane;if(se===0)H!==null&&(H=H.next={lane:0,revertLane:0,gesture:null,action:re.action,hasEagerState:re.hasEagerState,eagerState:re.eagerState,next:null}),ye===Go&&(me=!0);else if((Jr&se)===se){re=re.next,se===Go&&(me=!0);continue}else ye={lane:0,revertLane:re.revertLane,gesture:null,action:re.action,hasEagerState:re.hasEagerState,eagerState:re.eagerState,next:null},H===null?(R=H=ye,w=y):H=H.next=ye,rt.lanes|=se,qs|=se;ye=re.action,Xa&&o(y,ye),y=re.hasEagerState?re.eagerState:o(y,ye)}else se={lane:ye,revertLane:re.revertLane,gesture:re.gesture,action:re.action,hasEagerState:re.hasEagerState,eagerState:re.eagerState,next:null},H===null?(R=H=se,w=y):H=H.next=se,rt.lanes|=ye,qs|=ye;re=re.next}while(re!==null&&re!==r);if(H===null?w=y:H.next=R,!Ai(y,i.memoizedState)&&(Rn=!0,me&&(o=$o,o!==null)))throw o;i.memoizedState=y,i.baseState=w,i.baseQueue=H,c.lastRenderedState=y}return m===null&&(c.lanes=0),[i.memoizedState,c.dispatch]}function Mm(i){var r=_n(),o=r.queue;if(o===null)throw Error(s(311));o.lastRenderedReducer=i;var c=o.dispatch,m=o.pending,y=r.memoizedState;if(m!==null){o.pending=null;var w=m=m.next;do y=i(y,w.action),w=w.next;while(w!==m);Ai(y,r.memoizedState)||(Rn=!0),r.memoizedState=y,r.baseQueue===null&&(r.baseState=y),o.lastRenderedState=y}return[y,c]}function I_(i,r,o){var c=rt,m=_n(),y=bt;if(y){if(o===void 0)throw Error(s(407));o=o()}else o=r();var w=!Ai((qt||m).memoizedState,o);if(w&&(m.memoizedState=o,Rn=!0),m=m.queue,km(M_.bind(null,c,m,i),[i]),m.getSnapshot!==r||w||xn!==null&&xn.memoizedState.tag&1){if(c.flags|=2048,Zo(9,{destroy:void 0},D_.bind(null,c,m,o,r),null),Yt===null)throw Error(s(349));y||(Jr&127)!==0||N_(c,r,o)}return o}function N_(i,r,o){i.flags|=16384,i={getSnapshot:r,value:o},r=rt.updateQueue,r===null?(r=Ah(),rt.updateQueue=r,r.stores=[i]):(o=r.stores,o===null?r.stores=[i]:o.push(i))}function D_(i,r,o,c){r.value=o,r.getSnapshot=c,O_(r)&&j_(i)}function M_(i,r,o){return o(function(){O_(r)&&j_(i)})}function O_(i){var r=i.getSnapshot;i=i.value;try{var o=r();return!Ai(i,o)}catch{return!0}}function j_(i){var r=Fa(i,2);r!==null&&yi(r,i,2)}function Om(i){var r=oi();if(typeof i=="function"){var o=i;if(i=o(),Xa){Xt(!0);try{o()}finally{Xt(!1)}}}return r.memoizedState=r.baseState=i,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:es,lastRenderedState:i},r}function k_(i,r,o,c){return i.baseState=o,Dm(i,qt,typeof c=="function"?c:es)}function px(i,r,o,c,m){if(Nh(i))throw Error(s(485));if(i=r.action,i!==null){var y={payload:m,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){y.listeners.push(w)}};D.T!==null?o(!0):y.isTransition=!1,c(y),o=r.pending,o===null?(y.next=r.pending=y,P_(r,y)):(y.next=o.next,r.pending=o.next=y)}}function P_(i,r){var o=r.action,c=r.payload,m=i.state;if(r.isTransition){var y=D.T,w={};D.T=w;try{var R=o(m,c),H=D.S;H!==null&&H(w,R),V_(i,r,R)}catch(re){jm(i,r,re)}finally{y!==null&&w.types!==null&&(y.types=w.types),D.T=y}}else try{y=o(m,c),V_(i,r,y)}catch(re){jm(i,r,re)}}function V_(i,r,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){L_(i,r,c)},function(c){return jm(i,r,c)}):L_(i,r,o)}function L_(i,r,o){r.status="fulfilled",r.value=o,U_(r),i.state=o,r=i.pending,r!==null&&(o=r.next,o===r?i.pending=null:(o=o.next,r.next=o,P_(i,o)))}function jm(i,r,o){var c=i.pending;if(i.pending=null,c!==null){c=c.next;do r.status="rejected",r.reason=o,U_(r),r=r.next;while(r!==c)}i.action=null}function U_(i){i=i.listeners;for(var r=0;r<i.length;r++)(0,i[r])()}function z_(i,r){return r}function B_(i,r){if(bt){var o=Yt.formState;if(o!==null){e:{var c=rt;if(bt){if(Zt){t:{for(var m=Zt,y=qi;m.nodeType!==8;){if(!y){m=null;break t}if(m=$i(m.nextSibling),m===null){m=null;break t}}y=m.data,m=y==="F!"||y==="F"?m:null}if(m){Zt=$i(m.nextSibling),c=m.data==="F!";break e}}ks(c)}c=!1}c&&(r=o[0])}}return o=oi(),o.memoizedState=o.baseState=r,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:z_,lastRenderedState:r},o.queue=c,o=ab.bind(null,rt,c),c.dispatch=o,c=Om(!1),y=zm.bind(null,rt,!1,c.queue),c=oi(),m={state:r,dispatch:null,action:i,pending:null},c.queue=m,o=px.bind(null,rt,m,y,o),m.dispatch=o,c.memoizedState=i,[r,o,!1]}function F_(i){var r=_n();return H_(r,qt,i)}function H_(i,r,o){if(r=Dm(i,r,z_)[0],i=xh(es)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var c=bc(r)}catch(w){throw w===Qo?yh:w}else c=r;r=_n();var m=r.queue,y=m.dispatch;return o!==r.memoizedState&&(rt.flags|=2048,Zo(9,{destroy:void 0},yx.bind(null,m,o),null)),[c,y,i]}function yx(i,r){i.action=r}function q_(i){var r=_n(),o=qt;if(o!==null)return H_(r,o,i);_n(),r=r.memoizedState,o=_n();var c=o.queue.dispatch;return o.memoizedState=i,[r,c,!1]}function Zo(i,r,o,c){return i={tag:i,create:o,deps:c,inst:r,next:null},r=rt.updateQueue,r===null&&(r=Ah(),rt.updateQueue=r),o=r.lastEffect,o===null?r.lastEffect=i.next=i:(c=o.next,o.next=i,i.next=c,r.lastEffect=i),i}function G_(){return _n().memoizedState}function Rh(i,r,o,c){var m=oi();rt.flags|=i,m.memoizedState=Zo(1|r,{destroy:void 0},o,c===void 0?null:c)}function Ih(i,r,o,c){var m=_n();c=c===void 0?null:c;var y=m.memoizedState.inst;qt!==null&&c!==null&&Am(c,qt.memoizedState.deps)?m.memoizedState=Zo(r,y,o,c):(rt.flags|=i,m.memoizedState=Zo(1|r,y,o,c))}function $_(i,r){Rh(8390656,8,i,r)}function km(i,r){Ih(2048,8,i,r)}function vx(i){rt.flags|=4;var r=rt.updateQueue;if(r===null)r=Ah(),rt.updateQueue=r,r.events=[i];else{var o=r.events;o===null?r.events=[i]:o.push(i)}}function Q_(i){var r=_n().memoizedState;return vx({ref:r,nextImpl:i}),function(){if((Mt&2)!==0)throw Error(s(440));return r.impl.apply(void 0,arguments)}}function Y_(i,r){return Ih(4,2,i,r)}function K_(i,r){return Ih(4,4,i,r)}function W_(i,r){if(typeof r=="function"){i=i();var o=r(i);return function(){typeof o=="function"?o():r(null)}}if(r!=null)return i=i(),r.current=i,function(){r.current=null}}function X_(i,r,o){o=o!=null?o.concat([i]):null,Ih(4,4,W_.bind(null,r,i),o)}function Pm(){}function Z_(i,r){var o=_n();r=r===void 0?null:r;var c=o.memoizedState;return r!==null&&Am(r,c[1])?c[0]:(o.memoizedState=[i,r],i)}function J_(i,r){var o=_n();r=r===void 0?null:r;var c=o.memoizedState;if(r!==null&&Am(r,c[1]))return c[0];if(c=i(),Xa){Xt(!0);try{i()}finally{Xt(!1)}}return o.memoizedState=[c,r],c}function Vm(i,r,o){return o===void 0||(Jr&1073741824)!==0&&(gt&261930)===0?i.memoizedState=r:(i.memoizedState=o,i=e0(),rt.lanes|=i,qs|=i,o)}function eb(i,r,o,c){return Ai(o,r)?o:Ko.current!==null?(i=Vm(i,o,c),Ai(i,r)||(Rn=!0),i):(Jr&42)===0||(Jr&1073741824)!==0&&(gt&261930)===0?(Rn=!0,i.memoizedState=o):(i=e0(),rt.lanes|=i,qs|=i,r)}function tb(i,r,o,c,m){var y=$.p;$.p=y!==0&&8>y?y:8;var w=D.T,R={};D.T=R,zm(i,!1,r,o);try{var H=m(),re=D.S;if(re!==null&&re(R,H),H!==null&&typeof H=="object"&&typeof H.then=="function"){var me=fx(H,c);Sc(i,r,me,Di(i))}else Sc(i,r,c,Di(i))}catch(ye){Sc(i,r,{then:function(){},status:"rejected",reason:ye},Di())}finally{$.p=y,w!==null&&R.types!==null&&(w.types=R.types),D.T=w}}function _x(){}function Lm(i,r,o,c){if(i.tag!==5)throw Error(s(476));var m=nb(i).queue;tb(i,m,r,Q,o===null?_x:function(){return ib(i),o(c)})}function nb(i){var r=i.memoizedState;if(r!==null)return r;r={memoizedState:Q,baseState:Q,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:es,lastRenderedState:Q},next:null};var o={};return r.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:es,lastRenderedState:o},next:null},i.memoizedState=r,i=i.alternate,i!==null&&(i.memoizedState=r),r}function ib(i){var r=nb(i);r.next===null&&(r=i.alternate.memoizedState),Sc(i,r.next.queue,{},Di())}function Um(){return Yn(Lc)}function rb(){return _n().memoizedState}function sb(){return _n().memoizedState}function bx(i){for(var r=i.return;r!==null;){switch(r.tag){case 24:case 3:var o=Di();i=Ls(o);var c=Us(r,i,o);c!==null&&(yi(c,r,o),pc(c,r,o)),r={cache:mm()},i.payload=r;return}r=r.return}}function Sx(i,r,o){var c=Di();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},Nh(i)?ob(r,o):(o=im(i,r,o,c),o!==null&&(yi(o,i,c),lb(o,r,c)))}function ab(i,r,o){var c=Di();Sc(i,r,o,c)}function Sc(i,r,o,c){var m={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(Nh(i))ob(r,m);else{var y=i.alternate;if(i.lanes===0&&(y===null||y.lanes===0)&&(y=r.lastRenderedReducer,y!==null))try{var w=r.lastRenderedState,R=y(w,o);if(m.hasEagerState=!0,m.eagerState=R,Ai(R,w))return uh(i,r,m,0),Yt===null&&ch(),!1}catch{}finally{}if(o=im(i,r,m,c),o!==null)return yi(o,i,c),lb(o,r,c),!0}return!1}function zm(i,r,o,c){if(c={lane:2,revertLane:vg(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Nh(i)){if(r)throw Error(s(479))}else r=im(i,o,c,2),r!==null&&yi(r,i,2)}function Nh(i){var r=i.alternate;return i===rt||r!==null&&r===rt}function ob(i,r){Wo=Eh=!0;var o=i.pending;o===null?r.next=r:(r.next=o.next,o.next=r),i.pending=r}function lb(i,r,o){if((o&4194048)!==0){var c=r.lanes;c&=i.pendingLanes,o|=c,r.lanes=o,Si(i,o)}}var wc={readContext:Yn,use:Ch,useCallback:hn,useContext:hn,useEffect:hn,useImperativeHandle:hn,useLayoutEffect:hn,useInsertionEffect:hn,useMemo:hn,useReducer:hn,useRef:hn,useState:hn,useDebugValue:hn,useDeferredValue:hn,useTransition:hn,useSyncExternalStore:hn,useId:hn,useHostTransitionStatus:hn,useFormState:hn,useActionState:hn,useOptimistic:hn,useMemoCache:hn,useCacheRefresh:hn};wc.useEffectEvent=hn;var cb={readContext:Yn,use:Ch,useCallback:function(i,r){return oi().memoizedState=[i,r===void 0?null:r],i},useContext:Yn,useEffect:$_,useImperativeHandle:function(i,r,o){o=o!=null?o.concat([i]):null,Rh(4194308,4,W_.bind(null,r,i),o)},useLayoutEffect:function(i,r){return Rh(4194308,4,i,r)},useInsertionEffect:function(i,r){Rh(4,2,i,r)},useMemo:function(i,r){var o=oi();r=r===void 0?null:r;var c=i();if(Xa){Xt(!0);try{i()}finally{Xt(!1)}}return o.memoizedState=[c,r],c},useReducer:function(i,r,o){var c=oi();if(o!==void 0){var m=o(r);if(Xa){Xt(!0);try{o(r)}finally{Xt(!1)}}}else m=r;return c.memoizedState=c.baseState=m,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:m},c.queue=i,i=i.dispatch=Sx.bind(null,rt,i),[c.memoizedState,i]},useRef:function(i){var r=oi();return i={current:i},r.memoizedState=i},useState:function(i){i=Om(i);var r=i.queue,o=ab.bind(null,rt,r);return r.dispatch=o,[i.memoizedState,o]},useDebugValue:Pm,useDeferredValue:function(i,r){var o=oi();return Vm(o,i,r)},useTransition:function(){var i=Om(!1);return i=tb.bind(null,rt,i.queue,!0,!1),oi().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,r,o){var c=rt,m=oi();if(bt){if(o===void 0)throw Error(s(407));o=o()}else{if(o=r(),Yt===null)throw Error(s(349));(gt&127)!==0||N_(c,r,o)}m.memoizedState=o;var y={value:o,getSnapshot:r};return m.queue=y,$_(M_.bind(null,c,y,i),[i]),c.flags|=2048,Zo(9,{destroy:void 0},D_.bind(null,c,y,o,r),null),o},useId:function(){var i=oi(),r=Yt.identifierPrefix;if(bt){var o=Rr,c=xr;o=(c&~(1<<32-lt(c)-1)).toString(32)+o,r="_"+r+"R_"+o,o=Th++,0<o&&(r+="H"+o.toString(32)),r+="_"}else o=mx++,r="_"+r+"r_"+o.toString(32)+"_";return i.memoizedState=r},useHostTransitionStatus:Um,useFormState:B_,useActionState:B_,useOptimistic:function(i){var r=oi();r.memoizedState=r.baseState=i;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=o,r=zm.bind(null,rt,!0,o),o.dispatch=r,[i,r]},useMemoCache:Nm,useCacheRefresh:function(){return oi().memoizedState=bx.bind(null,rt)},useEffectEvent:function(i){var r=oi(),o={impl:i};return r.memoizedState=o,function(){if((Mt&2)!==0)throw Error(s(440));return o.impl.apply(void 0,arguments)}}},Bm={readContext:Yn,use:Ch,useCallback:Z_,useContext:Yn,useEffect:km,useImperativeHandle:X_,useInsertionEffect:Y_,useLayoutEffect:K_,useMemo:J_,useReducer:xh,useRef:G_,useState:function(){return xh(es)},useDebugValue:Pm,useDeferredValue:function(i,r){var o=_n();return eb(o,qt.memoizedState,i,r)},useTransition:function(){var i=xh(es)[0],r=_n().memoizedState;return[typeof i=="boolean"?i:bc(i),r]},useSyncExternalStore:I_,useId:rb,useHostTransitionStatus:Um,useFormState:F_,useActionState:F_,useOptimistic:function(i,r){var o=_n();return k_(o,qt,i,r)},useMemoCache:Nm,useCacheRefresh:sb};Bm.useEffectEvent=Q_;var ub={readContext:Yn,use:Ch,useCallback:Z_,useContext:Yn,useEffect:km,useImperativeHandle:X_,useInsertionEffect:Y_,useLayoutEffect:K_,useMemo:J_,useReducer:Mm,useRef:G_,useState:function(){return Mm(es)},useDebugValue:Pm,useDeferredValue:function(i,r){var o=_n();return qt===null?Vm(o,i,r):eb(o,qt.memoizedState,i,r)},useTransition:function(){var i=Mm(es)[0],r=_n().memoizedState;return[typeof i=="boolean"?i:bc(i),r]},useSyncExternalStore:I_,useId:rb,useHostTransitionStatus:Um,useFormState:q_,useActionState:q_,useOptimistic:function(i,r){var o=_n();return qt!==null?k_(o,qt,i,r):(o.baseState=i,[i,o.queue.dispatch])},useMemoCache:Nm,useCacheRefresh:sb};ub.useEffectEvent=Q_;function Fm(i,r,o,c){r=i.memoizedState,o=o(c,r),o=o==null?r:_({},r,o),i.memoizedState=o,i.lanes===0&&(i.updateQueue.baseState=o)}var Hm={enqueueSetState:function(i,r,o){i=i._reactInternals;var c=Di(),m=Ls(c);m.payload=r,o!=null&&(m.callback=o),r=Us(i,m,c),r!==null&&(yi(r,i,c),pc(r,i,c))},enqueueReplaceState:function(i,r,o){i=i._reactInternals;var c=Di(),m=Ls(c);m.tag=1,m.payload=r,o!=null&&(m.callback=o),r=Us(i,m,c),r!==null&&(yi(r,i,c),pc(r,i,c))},enqueueForceUpdate:function(i,r){i=i._reactInternals;var o=Di(),c=Ls(o);c.tag=2,r!=null&&(c.callback=r),r=Us(i,c,o),r!==null&&(yi(r,i,o),pc(r,i,o))}};function hb(i,r,o,c,m,y,w){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(c,y,w):r.prototype&&r.prototype.isPureReactComponent?!lc(o,c)||!lc(m,y):!0}function db(i,r,o,c){i=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(o,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(o,c),r.state!==i&&Hm.enqueueReplaceState(r,r.state,null)}function Za(i,r){var o=r;if("ref"in r){o={};for(var c in r)c!=="ref"&&(o[c]=r[c])}if(i=i.defaultProps){o===r&&(o=_({},o));for(var m in i)o[m]===void 0&&(o[m]=i[m])}return o}function fb(i){lh(i)}function mb(i){console.error(i)}function gb(i){lh(i)}function Dh(i,r){try{var o=i.onUncaughtError;o(r.value,{componentStack:r.stack})}catch(c){setTimeout(function(){throw c})}}function pb(i,r,o){try{var c=i.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function qm(i,r,o){return o=Ls(o),o.tag=3,o.payload={element:null},o.callback=function(){Dh(i,r)},o}function yb(i){return i=Ls(i),i.tag=3,i}function vb(i,r,o,c){var m=o.type.getDerivedStateFromError;if(typeof m=="function"){var y=c.value;i.payload=function(){return m(y)},i.callback=function(){pb(r,o,c)}}var w=o.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(i.callback=function(){pb(r,o,c),typeof m!="function"&&(Gs===null?Gs=new Set([this]):Gs.add(this));var R=c.stack;this.componentDidCatch(c.value,{componentStack:R!==null?R:""})})}function wx(i,r,o,c,m){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(r=o.alternate,r!==null&&qo(r,o,m,!0),o=xi.current,o!==null){switch(o.tag){case 31:case 13:return Gi===null?Hh():o.alternate===null&&dn===0&&(dn=3),o.flags&=-257,o.flags|=65536,o.lanes=m,c===vh?o.flags|=16384:(r=o.updateQueue,r===null?o.updateQueue=new Set([c]):r.add(c),gg(i,c,m)),!1;case 22:return o.flags|=65536,c===vh?o.flags|=16384:(r=o.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=r):(o=r.retryQueue,o===null?r.retryQueue=new Set([c]):o.add(c)),gg(i,c,m)),!1}throw Error(s(435,o.tag))}return gg(i,c,m),Hh(),!1}if(bt)return r=xi.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=m,c!==cm&&(i=Error(s(422),{cause:c}),hc(Bi(i,o)))):(c!==cm&&(r=Error(s(423),{cause:c}),hc(Bi(r,o))),i=i.current.alternate,i.flags|=65536,m&=-m,i.lanes|=m,c=Bi(c,o),m=qm(i.stateNode,c,m),bm(i,m),dn!==4&&(dn=2)),!1;var y=Error(s(520),{cause:c});if(y=Bi(y,o),Nc===null?Nc=[y]:Nc.push(y),dn!==4&&(dn=2),r===null)return!0;c=Bi(c,o),o=r;do{switch(o.tag){case 3:return o.flags|=65536,i=m&-m,o.lanes|=i,i=qm(o.stateNode,c,i),bm(o,i),!1;case 1:if(r=o.type,y=o.stateNode,(o.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Gs===null||!Gs.has(y))))return o.flags|=65536,m&=-m,o.lanes|=m,m=yb(m),vb(m,i,o,c),bm(o,m),!1}o=o.return}while(o!==null);return!1}var Gm=Error(s(461)),Rn=!1;function Kn(i,r,o,c){r.child=i===null?w_(r,null,o,c):Wa(r,i.child,o,c)}function _b(i,r,o,c,m){o=o.render;var y=r.ref;if("ref"in c){var w={};for(var R in c)R!=="ref"&&(w[R]=c[R])}else w=c;return $a(r),c=Cm(i,r,o,w,y,m),R=xm(),i!==null&&!Rn?(Rm(i,r,m),ts(i,r,m)):(bt&&R&&om(r),r.flags|=1,Kn(i,r,c,m),r.child)}function bb(i,r,o,c,m){if(i===null){var y=o.type;return typeof y=="function"&&!rm(y)&&y.defaultProps===void 0&&o.compare===null?(r.tag=15,r.type=y,Sb(i,r,y,c,m)):(i=dh(o.type,null,c,r,r.mode,m),i.ref=r.ref,i.return=r,r.child=i)}if(y=i.child,!Jm(i,m)){var w=y.memoizedProps;if(o=o.compare,o=o!==null?o:lc,o(w,c)&&i.ref===r.ref)return ts(i,r,m)}return r.flags|=1,i=Kr(y,c),i.ref=r.ref,i.return=r,r.child=i}function Sb(i,r,o,c,m){if(i!==null){var y=i.memoizedProps;if(lc(y,c)&&i.ref===r.ref)if(Rn=!1,r.pendingProps=c=y,Jm(i,m))(i.flags&131072)!==0&&(Rn=!0);else return r.lanes=i.lanes,ts(i,r,m)}return $m(i,r,o,c,m)}function wb(i,r,o,c){var m=c.children,y=i!==null?i.memoizedState:null;if(i===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((r.flags&128)!==0){if(y=y!==null?y.baseLanes|o:o,i!==null){for(c=r.child=i.child,m=0;c!==null;)m=m|c.lanes|c.childLanes,c=c.sibling;c=m&~y}else c=0,r.child=null;return Eb(i,r,y,o,c)}if((o&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},i!==null&&ph(r,y!==null?y.cachePool:null),y!==null?A_(r,y):wm(),C_(r);else return c=r.lanes=536870912,Eb(i,r,y!==null?y.baseLanes|o:o,o,c)}else y!==null?(ph(r,y.cachePool),A_(r,y),Bs(),r.memoizedState=null):(i!==null&&ph(r,null),wm(),Bs());return Kn(i,r,m,o),r.child}function Ec(i,r){return i!==null&&i.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function Eb(i,r,o,c,m){var y=pm();return y=y===null?null:{parent:Cn._currentValue,pool:y},r.memoizedState={baseLanes:o,cachePool:y},i!==null&&ph(r,null),wm(),C_(r),i!==null&&qo(i,r,c,!0),r.childLanes=m,null}function Mh(i,r){return r=jh({mode:r.mode,children:r.children},i.mode),r.ref=i.ref,i.child=r,r.return=i,r}function Tb(i,r,o){return Wa(r,i.child,null,o),i=Mh(r,r.pendingProps),i.flags|=2,Ri(r),r.memoizedState=null,i}function Ex(i,r,o){var c=r.pendingProps,m=(r.flags&128)!==0;if(r.flags&=-129,i===null){if(bt){if(c.mode==="hidden")return i=Mh(r,c),r.lanes=536870912,Ec(null,i);if(Tm(r),(i=Zt)?(i=P0(i,qi),i=i!==null&&i.data==="&"?i:null,i!==null&&(r.memoizedState={dehydrated:i,treeContext:Os!==null?{id:xr,overflow:Rr}:null,retryLane:536870912,hydrationErrors:null},o=o_(i),o.return=r,r.child=o,Qn=r,Zt=null)):i=null,i===null)throw ks(r);return r.lanes=536870912,null}return Mh(r,c)}var y=i.memoizedState;if(y!==null){var w=y.dehydrated;if(Tm(r),m)if(r.flags&256)r.flags&=-257,r=Tb(i,r,o);else if(r.memoizedState!==null)r.child=i.child,r.flags|=128,r=null;else throw Error(s(558));else if(Rn||qo(i,r,o,!1),m=(o&i.childLanes)!==0,Rn||m){if(c=Yt,c!==null&&(w=Xi(c,o),w!==0&&w!==y.retryLane))throw y.retryLane=w,Fa(i,w),yi(c,i,w),Gm;Hh(),r=Tb(i,r,o)}else i=y.treeContext,Zt=$i(w.nextSibling),Qn=r,bt=!0,js=null,qi=!1,i!==null&&u_(r,i),r=Mh(r,c),r.flags|=4096;return r}return i=Kr(i.child,{mode:c.mode,children:c.children}),i.ref=r.ref,r.child=i,i.return=r,i}function Oh(i,r){var o=r.ref;if(o===null)i!==null&&i.ref!==null&&(r.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(s(284));(i===null||i.ref!==o)&&(r.flags|=4194816)}}function $m(i,r,o,c,m){return $a(r),o=Cm(i,r,o,c,void 0,m),c=xm(),i!==null&&!Rn?(Rm(i,r,m),ts(i,r,m)):(bt&&c&&om(r),r.flags|=1,Kn(i,r,o,m),r.child)}function Ab(i,r,o,c,m,y){return $a(r),r.updateQueue=null,o=R_(r,c,o,m),x_(i),c=xm(),i!==null&&!Rn?(Rm(i,r,y),ts(i,r,y)):(bt&&c&&om(r),r.flags|=1,Kn(i,r,o,y),r.child)}function Cb(i,r,o,c,m){if($a(r),r.stateNode===null){var y=zo,w=o.contextType;typeof w=="object"&&w!==null&&(y=Yn(w)),y=new o(c,y),r.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=Hm,r.stateNode=y,y._reactInternals=r,y=r.stateNode,y.props=c,y.state=r.memoizedState,y.refs={},vm(r),w=o.contextType,y.context=typeof w=="object"&&w!==null?Yn(w):zo,y.state=r.memoizedState,w=o.getDerivedStateFromProps,typeof w=="function"&&(Fm(r,o,w,c),y.state=r.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(w=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),w!==y.state&&Hm.enqueueReplaceState(y,y.state,null),vc(r,c,y,m),yc(),y.state=r.memoizedState),typeof y.componentDidMount=="function"&&(r.flags|=4194308),c=!0}else if(i===null){y=r.stateNode;var R=r.memoizedProps,H=Za(o,R);y.props=H;var re=y.context,me=o.contextType;w=zo,typeof me=="object"&&me!==null&&(w=Yn(me));var ye=o.getDerivedStateFromProps;me=typeof ye=="function"||typeof y.getSnapshotBeforeUpdate=="function",R=r.pendingProps!==R,me||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(R||re!==w)&&db(r,y,c,w),Vs=!1;var se=r.memoizedState;y.state=se,vc(r,c,y,m),yc(),re=r.memoizedState,R||se!==re||Vs?(typeof ye=="function"&&(Fm(r,o,ye,c),re=r.memoizedState),(H=Vs||hb(r,o,H,c,se,re,w))?(me||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(r.flags|=4194308)):(typeof y.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=re),y.props=c,y.state=re,y.context=w,c=H):(typeof y.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{y=r.stateNode,_m(i,r),w=r.memoizedProps,me=Za(o,w),y.props=me,ye=r.pendingProps,se=y.context,re=o.contextType,H=zo,typeof re=="object"&&re!==null&&(H=Yn(re)),R=o.getDerivedStateFromProps,(re=typeof R=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(w!==ye||se!==H)&&db(r,y,c,H),Vs=!1,se=r.memoizedState,y.state=se,vc(r,c,y,m),yc();var ue=r.memoizedState;w!==ye||se!==ue||Vs||i!==null&&i.dependencies!==null&&mh(i.dependencies)?(typeof R=="function"&&(Fm(r,o,R,c),ue=r.memoizedState),(me=Vs||hb(r,o,me,c,se,ue,H)||i!==null&&i.dependencies!==null&&mh(i.dependencies))?(re||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(c,ue,H),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(c,ue,H)),typeof y.componentDidUpdate=="function"&&(r.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof y.componentDidUpdate!="function"||w===i.memoizedProps&&se===i.memoizedState||(r.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||w===i.memoizedProps&&se===i.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=ue),y.props=c,y.state=ue,y.context=H,c=me):(typeof y.componentDidUpdate!="function"||w===i.memoizedProps&&se===i.memoizedState||(r.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||w===i.memoizedProps&&se===i.memoizedState||(r.flags|=1024),c=!1)}return y=c,Oh(i,r),c=(r.flags&128)!==0,y||c?(y=r.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:y.render(),r.flags|=1,i!==null&&c?(r.child=Wa(r,i.child,null,m),r.child=Wa(r,null,o,m)):Kn(i,r,o,m),r.memoizedState=y.state,i=r.child):i=ts(i,r,m),i}function xb(i,r,o,c){return qa(),r.flags|=256,Kn(i,r,o,c),r.child}var Qm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ym(i){return{baseLanes:i,cachePool:p_()}}function Km(i,r,o){return i=i!==null?i.childLanes&~o:0,r&&(i|=Ni),i}function Rb(i,r,o){var c=r.pendingProps,m=!1,y=(r.flags&128)!==0,w;if((w=y)||(w=i!==null&&i.memoizedState===null?!1:(vn.current&2)!==0),w&&(m=!0,r.flags&=-129),w=(r.flags&32)!==0,r.flags&=-33,i===null){if(bt){if(m?zs(r):Bs(),(i=Zt)?(i=P0(i,qi),i=i!==null&&i.data!=="&"?i:null,i!==null&&(r.memoizedState={dehydrated:i,treeContext:Os!==null?{id:xr,overflow:Rr}:null,retryLane:536870912,hydrationErrors:null},o=o_(i),o.return=r,r.child=o,Qn=r,Zt=null)):i=null,i===null)throw ks(r);return Dg(i)?r.lanes=32:r.lanes=536870912,null}var R=c.children;return c=c.fallback,m?(Bs(),m=r.mode,R=jh({mode:"hidden",children:R},m),c=Ha(c,m,o,null),R.return=r,c.return=r,R.sibling=c,r.child=R,c=r.child,c.memoizedState=Ym(o),c.childLanes=Km(i,w,o),r.memoizedState=Qm,Ec(null,c)):(zs(r),Wm(r,R))}var H=i.memoizedState;if(H!==null&&(R=H.dehydrated,R!==null)){if(y)r.flags&256?(zs(r),r.flags&=-257,r=Xm(i,r,o)):r.memoizedState!==null?(Bs(),r.child=i.child,r.flags|=128,r=null):(Bs(),R=c.fallback,m=r.mode,c=jh({mode:"visible",children:c.children},m),R=Ha(R,m,o,null),R.flags|=2,c.return=r,R.return=r,c.sibling=R,r.child=c,Wa(r,i.child,null,o),c=r.child,c.memoizedState=Ym(o),c.childLanes=Km(i,w,o),r.memoizedState=Qm,r=Ec(null,c));else if(zs(r),Dg(R)){if(w=R.nextSibling&&R.nextSibling.dataset,w)var re=w.dgst;w=re,c=Error(s(419)),c.stack="",c.digest=w,hc({value:c,source:null,stack:null}),r=Xm(i,r,o)}else if(Rn||qo(i,r,o,!1),w=(o&i.childLanes)!==0,Rn||w){if(w=Yt,w!==null&&(c=Xi(w,o),c!==0&&c!==H.retryLane))throw H.retryLane=c,Fa(i,c),yi(w,i,c),Gm;Ng(R)||Hh(),r=Xm(i,r,o)}else Ng(R)?(r.flags|=192,r.child=i.child,r=null):(i=H.treeContext,Zt=$i(R.nextSibling),Qn=r,bt=!0,js=null,qi=!1,i!==null&&u_(r,i),r=Wm(r,c.children),r.flags|=4096);return r}return m?(Bs(),R=c.fallback,m=r.mode,H=i.child,re=H.sibling,c=Kr(H,{mode:"hidden",children:c.children}),c.subtreeFlags=H.subtreeFlags&65011712,re!==null?R=Kr(re,R):(R=Ha(R,m,o,null),R.flags|=2),R.return=r,c.return=r,c.sibling=R,r.child=c,Ec(null,c),c=r.child,R=i.child.memoizedState,R===null?R=Ym(o):(m=R.cachePool,m!==null?(H=Cn._currentValue,m=m.parent!==H?{parent:H,pool:H}:m):m=p_(),R={baseLanes:R.baseLanes|o,cachePool:m}),c.memoizedState=R,c.childLanes=Km(i,w,o),r.memoizedState=Qm,Ec(i.child,c)):(zs(r),o=i.child,i=o.sibling,o=Kr(o,{mode:"visible",children:c.children}),o.return=r,o.sibling=null,i!==null&&(w=r.deletions,w===null?(r.deletions=[i],r.flags|=16):w.push(i)),r.child=o,r.memoizedState=null,o)}function Wm(i,r){return r=jh({mode:"visible",children:r},i.mode),r.return=i,i.child=r}function jh(i,r){return i=Ci(22,i,null,r),i.lanes=0,i}function Xm(i,r,o){return Wa(r,i.child,null,o),i=Wm(r,r.pendingProps.children),i.flags|=2,r.memoizedState=null,i}function Ib(i,r,o){i.lanes|=r;var c=i.alternate;c!==null&&(c.lanes|=r),dm(i.return,r,o)}function Zm(i,r,o,c,m,y){var w=i.memoizedState;w===null?i.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:m,treeForkCount:y}:(w.isBackwards=r,w.rendering=null,w.renderingStartTime=0,w.last=c,w.tail=o,w.tailMode=m,w.treeForkCount=y)}function Nb(i,r,o){var c=r.pendingProps,m=c.revealOrder,y=c.tail;c=c.children;var w=vn.current,R=(w&2)!==0;if(R?(w=w&1|2,r.flags|=128):w&=1,K(vn,w),Kn(i,r,c,o),c=bt?uc:0,!R&&i!==null&&(i.flags&128)!==0)e:for(i=r.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Ib(i,o,r);else if(i.tag===19)Ib(i,o,r);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break e;for(;i.sibling===null;){if(i.return===null||i.return===r)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(m){case"forwards":for(o=r.child,m=null;o!==null;)i=o.alternate,i!==null&&wh(i)===null&&(m=o),o=o.sibling;o=m,o===null?(m=r.child,r.child=null):(m=o.sibling,o.sibling=null),Zm(r,!1,m,o,y,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,m=r.child,r.child=null;m!==null;){if(i=m.alternate,i!==null&&wh(i)===null){r.child=m;break}i=m.sibling,m.sibling=o,o=m,m=i}Zm(r,!0,o,null,y,c);break;case"together":Zm(r,!1,null,null,void 0,c);break;default:r.memoizedState=null}return r.child}function ts(i,r,o){if(i!==null&&(r.dependencies=i.dependencies),qs|=r.lanes,(o&r.childLanes)===0)if(i!==null){if(qo(i,r,o,!1),(o&r.childLanes)===0)return null}else return null;if(i!==null&&r.child!==i.child)throw Error(s(153));if(r.child!==null){for(i=r.child,o=Kr(i,i.pendingProps),r.child=o,o.return=r;i.sibling!==null;)i=i.sibling,o=o.sibling=Kr(i,i.pendingProps),o.return=r;o.sibling=null}return r.child}function Jm(i,r){return(i.lanes&r)!==0?!0:(i=i.dependencies,!!(i!==null&&mh(i)))}function Tx(i,r,o){switch(r.tag){case 3:Me(r,r.stateNode.containerInfo),Ps(r,Cn,i.memoizedState.cache),qa();break;case 27:case 5:Ae(r);break;case 4:Me(r,r.stateNode.containerInfo);break;case 10:Ps(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,Tm(r),null;break;case 13:var c=r.memoizedState;if(c!==null)return c.dehydrated!==null?(zs(r),r.flags|=128,null):(o&r.child.childLanes)!==0?Rb(i,r,o):(zs(r),i=ts(i,r,o),i!==null?i.sibling:null);zs(r);break;case 19:var m=(i.flags&128)!==0;if(c=(o&r.childLanes)!==0,c||(qo(i,r,o,!1),c=(o&r.childLanes)!==0),m){if(c)return Nb(i,r,o);r.flags|=128}if(m=r.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),K(vn,vn.current),c)break;return null;case 22:return r.lanes=0,wb(i,r,o,r.pendingProps);case 24:Ps(r,Cn,i.memoizedState.cache)}return ts(i,r,o)}function Db(i,r,o){if(i!==null)if(i.memoizedProps!==r.pendingProps)Rn=!0;else{if(!Jm(i,o)&&(r.flags&128)===0)return Rn=!1,Tx(i,r,o);Rn=(i.flags&131072)!==0}else Rn=!1,bt&&(r.flags&1048576)!==0&&c_(r,uc,r.index);switch(r.lanes=0,r.tag){case 16:e:{var c=r.pendingProps;if(i=Ya(r.elementType),r.type=i,typeof i=="function")rm(i)?(c=Za(i,c),r.tag=1,r=Cb(null,r,i,c,o)):(r.tag=0,r=$m(null,r,i,c,o));else{if(i!=null){var m=i.$$typeof;if(m===ne){r.tag=11,r=_b(null,r,i,c,o);break e}else if(m===k){r.tag=14,r=bb(null,r,i,c,o);break e}}throw r=fe(i)||i,Error(s(306,r,""))}}return r;case 0:return $m(i,r,r.type,r.pendingProps,o);case 1:return c=r.type,m=Za(c,r.pendingProps),Cb(i,r,c,m,o);case 3:e:{if(Me(r,r.stateNode.containerInfo),i===null)throw Error(s(387));c=r.pendingProps;var y=r.memoizedState;m=y.element,_m(i,r),vc(r,c,null,o);var w=r.memoizedState;if(c=w.cache,Ps(r,Cn,c),c!==y.cache&&fm(r,[Cn],o,!0),yc(),c=w.element,y.isDehydrated)if(y={element:c,isDehydrated:!1,cache:w.cache},r.updateQueue.baseState=y,r.memoizedState=y,r.flags&256){r=xb(i,r,c,o);break e}else if(c!==m){m=Bi(Error(s(424)),r),hc(m),r=xb(i,r,c,o);break e}else{switch(i=r.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(Zt=$i(i.firstChild),Qn=r,bt=!0,js=null,qi=!0,o=w_(r,null,c,o),r.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling}else{if(qa(),c===m){r=ts(i,r,o);break e}Kn(i,r,c,o)}r=r.child}return r;case 26:return Oh(i,r),i===null?(o=F0(r.type,null,r.pendingProps,null))?r.memoizedState=o:bt||(o=r.type,i=r.pendingProps,c=Wh(Ee.current).createElement(o),c[En]=r,c[zn]=i,Wn(c,o,i),Tn(c),r.stateNode=c):r.memoizedState=F0(r.type,i.memoizedProps,r.pendingProps,i.memoizedState),null;case 27:return Ae(r),i===null&&bt&&(c=r.stateNode=U0(r.type,r.pendingProps,Ee.current),Qn=r,qi=!0,m=Zt,Ks(r.type)?(Mg=m,Zt=$i(c.firstChild)):Zt=m),Kn(i,r,r.pendingProps.children,o),Oh(i,r),i===null&&(r.flags|=4194304),r.child;case 5:return i===null&&bt&&((m=c=Zt)&&(c=eR(c,r.type,r.pendingProps,qi),c!==null?(r.stateNode=c,Qn=r,Zt=$i(c.firstChild),qi=!1,m=!0):m=!1),m||ks(r)),Ae(r),m=r.type,y=r.pendingProps,w=i!==null?i.memoizedProps:null,c=y.children,xg(m,y)?c=null:w!==null&&xg(m,w)&&(r.flags|=32),r.memoizedState!==null&&(m=Cm(i,r,gx,null,null,o),Lc._currentValue=m),Oh(i,r),Kn(i,r,c,o),r.child;case 6:return i===null&&bt&&((i=o=Zt)&&(o=tR(o,r.pendingProps,qi),o!==null?(r.stateNode=o,Qn=r,Zt=null,i=!0):i=!1),i||ks(r)),null;case 13:return Rb(i,r,o);case 4:return Me(r,r.stateNode.containerInfo),c=r.pendingProps,i===null?r.child=Wa(r,null,c,o):Kn(i,r,c,o),r.child;case 11:return _b(i,r,r.type,r.pendingProps,o);case 7:return Kn(i,r,r.pendingProps,o),r.child;case 8:return Kn(i,r,r.pendingProps.children,o),r.child;case 12:return Kn(i,r,r.pendingProps.children,o),r.child;case 10:return c=r.pendingProps,Ps(r,r.type,c.value),Kn(i,r,c.children,o),r.child;case 9:return m=r.type._context,c=r.pendingProps.children,$a(r),m=Yn(m),c=c(m),r.flags|=1,Kn(i,r,c,o),r.child;case 14:return bb(i,r,r.type,r.pendingProps,o);case 15:return Sb(i,r,r.type,r.pendingProps,o);case 19:return Nb(i,r,o);case 31:return Ex(i,r,o);case 22:return wb(i,r,o,r.pendingProps);case 24:return $a(r),c=Yn(Cn),i===null?(m=pm(),m===null&&(m=Yt,y=mm(),m.pooledCache=y,y.refCount++,y!==null&&(m.pooledCacheLanes|=o),m=y),r.memoizedState={parent:c,cache:m},vm(r),Ps(r,Cn,m)):((i.lanes&o)!==0&&(_m(i,r),vc(r,null,null,o),yc()),m=i.memoizedState,y=r.memoizedState,m.parent!==c?(m={parent:c,cache:c},r.memoizedState=m,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=m),Ps(r,Cn,c)):(c=y.cache,Ps(r,Cn,c),c!==m.cache&&fm(r,[Cn],o,!0))),Kn(i,r,r.pendingProps.children,o),r.child;case 29:throw r.pendingProps}throw Error(s(156,r.tag))}function ns(i){i.flags|=4}function eg(i,r,o,c,m){if((r=(i.mode&32)!==0)&&(r=!1),r){if(i.flags|=16777216,(m&335544128)===m)if(i.stateNode.complete)i.flags|=8192;else if(r0())i.flags|=8192;else throw Ka=vh,ym}else i.flags&=-16777217}function Mb(i,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!Q0(r))if(r0())i.flags|=8192;else throw Ka=vh,ym}function kh(i,r){r!==null&&(i.flags|=4),i.flags&16384&&(r=i.tag!==22?pn():536870912,i.lanes|=r,nl|=r)}function Tc(i,r){if(!bt)switch(i.tailMode){case"hidden":r=i.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?i.tail=null:o.sibling=null;break;case"collapsed":o=i.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?r||i.tail===null?i.tail=null:i.tail.sibling=null:c.sibling=null}}function Jt(i){var r=i.alternate!==null&&i.alternate.child===i.child,o=0,c=0;if(r)for(var m=i.child;m!==null;)o|=m.lanes|m.childLanes,c|=m.subtreeFlags&65011712,c|=m.flags&65011712,m.return=i,m=m.sibling;else for(m=i.child;m!==null;)o|=m.lanes|m.childLanes,c|=m.subtreeFlags,c|=m.flags,m.return=i,m=m.sibling;return i.subtreeFlags|=c,i.childLanes=o,r}function Ax(i,r,o){var c=r.pendingProps;switch(lm(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jt(r),null;case 1:return Jt(r),null;case 3:return o=r.stateNode,c=null,i!==null&&(c=i.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),Zr(Cn),ke(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(i===null||i.child===null)&&(Ho(r)?ns(r):i===null||i.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,um())),Jt(r),null;case 26:var m=r.type,y=r.memoizedState;return i===null?(ns(r),y!==null?(Jt(r),Mb(r,y)):(Jt(r),eg(r,m,null,c,o))):y?y!==i.memoizedState?(ns(r),Jt(r),Mb(r,y)):(Jt(r),r.flags&=-16777217):(i=i.memoizedProps,i!==c&&ns(r),Jt(r),eg(r,m,i,c,o)),null;case 27:if(De(r),o=Ee.current,m=r.type,i!==null&&r.stateNode!=null)i.memoizedProps!==c&&ns(r);else{if(!c){if(r.stateNode===null)throw Error(s(166));return Jt(r),null}i=le.current,Ho(r)?h_(r):(i=U0(m,c,o),r.stateNode=i,ns(r))}return Jt(r),null;case 5:if(De(r),m=r.type,i!==null&&r.stateNode!=null)i.memoizedProps!==c&&ns(r);else{if(!c){if(r.stateNode===null)throw Error(s(166));return Jt(r),null}if(y=le.current,Ho(r))h_(r);else{var w=Wh(Ee.current);switch(y){case 1:y=w.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:y=w.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":y=w.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":y=w.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":y=w.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof c.is=="string"?w.createElement("select",{is:c.is}):w.createElement("select"),c.multiple?y.multiple=!0:c.size&&(y.size=c.size);break;default:y=typeof c.is=="string"?w.createElement(m,{is:c.is}):w.createElement(m)}}y[En]=r,y[zn]=c;e:for(w=r.child;w!==null;){if(w.tag===5||w.tag===6)y.appendChild(w.stateNode);else if(w.tag!==4&&w.tag!==27&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===r)break e;for(;w.sibling===null;){if(w.return===null||w.return===r)break e;w=w.return}w.sibling.return=w.return,w=w.sibling}r.stateNode=y;e:switch(Wn(y,m,c),m){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&ns(r)}}return Jt(r),eg(r,r.type,i===null?null:i.memoizedProps,r.pendingProps,o),null;case 6:if(i&&r.stateNode!=null)i.memoizedProps!==c&&ns(r);else{if(typeof c!="string"&&r.stateNode===null)throw Error(s(166));if(i=Ee.current,Ho(r)){if(i=r.stateNode,o=r.memoizedProps,c=null,m=Qn,m!==null)switch(m.tag){case 27:case 5:c=m.memoizedProps}i[En]=r,i=!!(i.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||R0(i.nodeValue,o)),i||ks(r,!0)}else i=Wh(i).createTextNode(c),i[En]=r,r.stateNode=i}return Jt(r),null;case 31:if(o=r.memoizedState,i===null||i.memoizedState!==null){if(c=Ho(r),o!==null){if(i===null){if(!c)throw Error(s(318));if(i=r.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(s(557));i[En]=r}else qa(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Jt(r),i=!1}else o=um(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=o),i=!0;if(!i)return r.flags&256?(Ri(r),r):(Ri(r),null);if((r.flags&128)!==0)throw Error(s(558))}return Jt(r),null;case 13:if(c=r.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(m=Ho(r),c!==null&&c.dehydrated!==null){if(i===null){if(!m)throw Error(s(318));if(m=r.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(s(317));m[En]=r}else qa(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Jt(r),m=!1}else m=um(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=m),m=!0;if(!m)return r.flags&256?(Ri(r),r):(Ri(r),null)}return Ri(r),(r.flags&128)!==0?(r.lanes=o,r):(o=c!==null,i=i!==null&&i.memoizedState!==null,o&&(c=r.child,m=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(m=c.alternate.memoizedState.cachePool.pool),y=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(y=c.memoizedState.cachePool.pool),y!==m&&(c.flags|=2048)),o!==i&&o&&(r.child.flags|=8192),kh(r,r.updateQueue),Jt(r),null);case 4:return ke(),i===null&&wg(r.stateNode.containerInfo),Jt(r),null;case 10:return Zr(r.type),Jt(r),null;case 19:if(B(vn),c=r.memoizedState,c===null)return Jt(r),null;if(m=(r.flags&128)!==0,y=c.rendering,y===null)if(m)Tc(c,!1);else{if(dn!==0||i!==null&&(i.flags&128)!==0)for(i=r.child;i!==null;){if(y=wh(i),y!==null){for(r.flags|=128,Tc(c,!1),i=y.updateQueue,r.updateQueue=i,kh(r,i),r.subtreeFlags=0,i=o,o=r.child;o!==null;)a_(o,i),o=o.sibling;return K(vn,vn.current&1|2),bt&&Wr(r,c.treeForkCount),r.child}i=i.sibling}c.tail!==null&&xt()>zh&&(r.flags|=128,m=!0,Tc(c,!1),r.lanes=4194304)}else{if(!m)if(i=wh(y),i!==null){if(r.flags|=128,m=!0,i=i.updateQueue,r.updateQueue=i,kh(r,i),Tc(c,!0),c.tail===null&&c.tailMode==="hidden"&&!y.alternate&&!bt)return Jt(r),null}else 2*xt()-c.renderingStartTime>zh&&o!==536870912&&(r.flags|=128,m=!0,Tc(c,!1),r.lanes=4194304);c.isBackwards?(y.sibling=r.child,r.child=y):(i=c.last,i!==null?i.sibling=y:r.child=y,c.last=y)}return c.tail!==null?(i=c.tail,c.rendering=i,c.tail=i.sibling,c.renderingStartTime=xt(),i.sibling=null,o=vn.current,K(vn,m?o&1|2:o&1),bt&&Wr(r,c.treeForkCount),i):(Jt(r),null);case 22:case 23:return Ri(r),Em(),c=r.memoizedState!==null,i!==null?i.memoizedState!==null!==c&&(r.flags|=8192):c&&(r.flags|=8192),c?(o&536870912)!==0&&(r.flags&128)===0&&(Jt(r),r.subtreeFlags&6&&(r.flags|=8192)):Jt(r),o=r.updateQueue,o!==null&&kh(r,o.retryQueue),o=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(o=i.memoizedState.cachePool.pool),c=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),c!==o&&(r.flags|=2048),i!==null&&B(Qa),null;case 24:return o=null,i!==null&&(o=i.memoizedState.cache),r.memoizedState.cache!==o&&(r.flags|=2048),Zr(Cn),Jt(r),null;case 25:return null;case 30:return null}throw Error(s(156,r.tag))}function Cx(i,r){switch(lm(r),r.tag){case 1:return i=r.flags,i&65536?(r.flags=i&-65537|128,r):null;case 3:return Zr(Cn),ke(),i=r.flags,(i&65536)!==0&&(i&128)===0?(r.flags=i&-65537|128,r):null;case 26:case 27:case 5:return De(r),null;case 31:if(r.memoizedState!==null){if(Ri(r),r.alternate===null)throw Error(s(340));qa()}return i=r.flags,i&65536?(r.flags=i&-65537|128,r):null;case 13:if(Ri(r),i=r.memoizedState,i!==null&&i.dehydrated!==null){if(r.alternate===null)throw Error(s(340));qa()}return i=r.flags,i&65536?(r.flags=i&-65537|128,r):null;case 19:return B(vn),null;case 4:return ke(),null;case 10:return Zr(r.type),null;case 22:case 23:return Ri(r),Em(),i!==null&&B(Qa),i=r.flags,i&65536?(r.flags=i&-65537|128,r):null;case 24:return Zr(Cn),null;case 25:return null;default:return null}}function Ob(i,r){switch(lm(r),r.tag){case 3:Zr(Cn),ke();break;case 26:case 27:case 5:De(r);break;case 4:ke();break;case 31:r.memoizedState!==null&&Ri(r);break;case 13:Ri(r);break;case 19:B(vn);break;case 10:Zr(r.type);break;case 22:case 23:Ri(r),Em(),i!==null&&B(Qa);break;case 24:Zr(Cn)}}function Ac(i,r){try{var o=r.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var m=c.next;o=m;do{if((o.tag&i)===i){c=void 0;var y=o.create,w=o.inst;c=y(),w.destroy=c}o=o.next}while(o!==m)}}catch(R){Ut(r,r.return,R)}}function Fs(i,r,o){try{var c=r.updateQueue,m=c!==null?c.lastEffect:null;if(m!==null){var y=m.next;c=y;do{if((c.tag&i)===i){var w=c.inst,R=w.destroy;if(R!==void 0){w.destroy=void 0,m=r;var H=o,re=R;try{re()}catch(me){Ut(m,H,me)}}}c=c.next}while(c!==y)}}catch(me){Ut(r,r.return,me)}}function jb(i){var r=i.updateQueue;if(r!==null){var o=i.stateNode;try{T_(r,o)}catch(c){Ut(i,i.return,c)}}}function kb(i,r,o){o.props=Za(i.type,i.memoizedProps),o.state=i.memoizedState;try{o.componentWillUnmount()}catch(c){Ut(i,r,c)}}function Cc(i,r){try{var o=i.ref;if(o!==null){switch(i.tag){case 26:case 27:case 5:var c=i.stateNode;break;case 30:c=i.stateNode;break;default:c=i.stateNode}typeof o=="function"?i.refCleanup=o(c):o.current=c}}catch(m){Ut(i,r,m)}}function Ir(i,r){var o=i.ref,c=i.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(m){Ut(i,r,m)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(m){Ut(i,r,m)}else o.current=null}function Pb(i){var r=i.type,o=i.memoizedProps,c=i.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(m){Ut(i,i.return,m)}}function tg(i,r,o){try{var c=i.stateNode;Yx(c,i.type,o,r),c[zn]=r}catch(m){Ut(i,i.return,m)}}function Vb(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Ks(i.type)||i.tag===4}function ng(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Vb(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Ks(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function ig(i,r,o){var c=i.tag;if(c===5||c===6)i=i.stateNode,r?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(i,r):(r=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,r.appendChild(i),o=o._reactRootContainer,o!=null||r.onclick!==null||(r.onclick=Ji));else if(c!==4&&(c===27&&Ks(i.type)&&(o=i.stateNode,r=null),i=i.child,i!==null))for(ig(i,r,o),i=i.sibling;i!==null;)ig(i,r,o),i=i.sibling}function Ph(i,r,o){var c=i.tag;if(c===5||c===6)i=i.stateNode,r?o.insertBefore(i,r):o.appendChild(i);else if(c!==4&&(c===27&&Ks(i.type)&&(o=i.stateNode),i=i.child,i!==null))for(Ph(i,r,o),i=i.sibling;i!==null;)Ph(i,r,o),i=i.sibling}function Lb(i){var r=i.stateNode,o=i.memoizedProps;try{for(var c=i.type,m=r.attributes;m.length;)r.removeAttributeNode(m[0]);Wn(r,c,o),r[En]=i,r[zn]=o}catch(y){Ut(i,i.return,y)}}var is=!1,In=!1,rg=!1,Ub=typeof WeakSet=="function"?WeakSet:Set,Fn=null;function xx(i,r){if(i=i.containerInfo,Ag=id,i=Xv(i),Xf(i)){if("selectionStart"in i)var o={start:i.selectionStart,end:i.selectionEnd};else e:{o=(o=i.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var m=c.anchorOffset,y=c.focusNode;c=c.focusOffset;try{o.nodeType,y.nodeType}catch{o=null;break e}var w=0,R=-1,H=-1,re=0,me=0,ye=i,se=null;t:for(;;){for(var ue;ye!==o||m!==0&&ye.nodeType!==3||(R=w+m),ye!==y||c!==0&&ye.nodeType!==3||(H=w+c),ye.nodeType===3&&(w+=ye.nodeValue.length),(ue=ye.firstChild)!==null;)se=ye,ye=ue;for(;;){if(ye===i)break t;if(se===o&&++re===m&&(R=w),se===y&&++me===c&&(H=w),(ue=ye.nextSibling)!==null)break;ye=se,se=ye.parentNode}ye=ue}o=R===-1||H===-1?null:{start:R,end:H}}else o=null}o=o||{start:0,end:0}}else o=null;for(Cg={focusedElem:i,selectionRange:o},id=!1,Fn=r;Fn!==null;)if(r=Fn,i=r.child,(r.subtreeFlags&1028)!==0&&i!==null)i.return=r,Fn=i;else for(;Fn!==null;){switch(r=Fn,y=r.alternate,i=r.flags,r.tag){case 0:if((i&4)!==0&&(i=r.updateQueue,i=i!==null?i.events:null,i!==null))for(o=0;o<i.length;o++)m=i[o],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&y!==null){i=void 0,o=r,m=y.memoizedProps,y=y.memoizedState,c=o.stateNode;try{var Ve=Za(o.type,m);i=c.getSnapshotBeforeUpdate(Ve,y),c.__reactInternalSnapshotBeforeUpdate=i}catch(Qe){Ut(o,o.return,Qe)}}break;case 3:if((i&1024)!==0){if(i=r.stateNode.containerInfo,o=i.nodeType,o===9)Ig(i);else if(o===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":Ig(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(s(163))}if(i=r.sibling,i!==null){i.return=r.return,Fn=i;break}Fn=r.return}}function zb(i,r,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:ss(i,o),c&4&&Ac(5,o);break;case 1:if(ss(i,o),c&4)if(i=o.stateNode,r===null)try{i.componentDidMount()}catch(w){Ut(o,o.return,w)}else{var m=Za(o.type,r.memoizedProps);r=r.memoizedState;try{i.componentDidUpdate(m,r,i.__reactInternalSnapshotBeforeUpdate)}catch(w){Ut(o,o.return,w)}}c&64&&jb(o),c&512&&Cc(o,o.return);break;case 3:if(ss(i,o),c&64&&(i=o.updateQueue,i!==null)){if(r=null,o.child!==null)switch(o.child.tag){case 27:case 5:r=o.child.stateNode;break;case 1:r=o.child.stateNode}try{T_(i,r)}catch(w){Ut(o,o.return,w)}}break;case 27:r===null&&c&4&&Lb(o);case 26:case 5:ss(i,o),r===null&&c&4&&Pb(o),c&512&&Cc(o,o.return);break;case 12:ss(i,o);break;case 31:ss(i,o),c&4&&Hb(i,o);break;case 13:ss(i,o),c&4&&qb(i,o),c&64&&(i=o.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(o=Px.bind(null,o),nR(i,o))));break;case 22:if(c=o.memoizedState!==null||is,!c){r=r!==null&&r.memoizedState!==null||In,m=is;var y=In;is=c,(In=r)&&!y?as(i,o,(o.subtreeFlags&8772)!==0):ss(i,o),is=m,In=y}break;case 30:break;default:ss(i,o)}}function Bb(i){var r=i.alternate;r!==null&&(i.alternate=null,Bb(r)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(r=i.stateNode,r!==null&&Co(r)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var rn=null,fi=!1;function rs(i,r,o){for(o=o.child;o!==null;)Fb(i,r,o),o=o.sibling}function Fb(i,r,o){if(Xe&&typeof Xe.onCommitFiberUnmount=="function")try{Xe.onCommitFiberUnmount(at,o)}catch{}switch(o.tag){case 26:In||Ir(o,r),rs(i,r,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:In||Ir(o,r);var c=rn,m=fi;Ks(o.type)&&(rn=o.stateNode,fi=!1),rs(i,r,o),kc(o.stateNode),rn=c,fi=m;break;case 5:In||Ir(o,r);case 6:if(c=rn,m=fi,rn=null,rs(i,r,o),rn=c,fi=m,rn!==null)if(fi)try{(rn.nodeType===9?rn.body:rn.nodeName==="HTML"?rn.ownerDocument.body:rn).removeChild(o.stateNode)}catch(y){Ut(o,r,y)}else try{rn.removeChild(o.stateNode)}catch(y){Ut(o,r,y)}break;case 18:rn!==null&&(fi?(i=rn,j0(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,o.stateNode),ul(i)):j0(rn,o.stateNode));break;case 4:c=rn,m=fi,rn=o.stateNode.containerInfo,fi=!0,rs(i,r,o),rn=c,fi=m;break;case 0:case 11:case 14:case 15:Fs(2,o,r),In||Fs(4,o,r),rs(i,r,o);break;case 1:In||(Ir(o,r),c=o.stateNode,typeof c.componentWillUnmount=="function"&&kb(o,r,c)),rs(i,r,o);break;case 21:rs(i,r,o);break;case 22:In=(c=In)||o.memoizedState!==null,rs(i,r,o),In=c;break;default:rs(i,r,o)}}function Hb(i,r){if(r.memoizedState===null&&(i=r.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{ul(i)}catch(o){Ut(r,r.return,o)}}}function qb(i,r){if(r.memoizedState===null&&(i=r.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{ul(i)}catch(o){Ut(r,r.return,o)}}function Rx(i){switch(i.tag){case 31:case 13:case 19:var r=i.stateNode;return r===null&&(r=i.stateNode=new Ub),r;case 22:return i=i.stateNode,r=i._retryCache,r===null&&(r=i._retryCache=new Ub),r;default:throw Error(s(435,i.tag))}}function Vh(i,r){var o=Rx(i);r.forEach(function(c){if(!o.has(c)){o.add(c);var m=Vx.bind(null,i,c);c.then(m,m)}})}function mi(i,r){var o=r.deletions;if(o!==null)for(var c=0;c<o.length;c++){var m=o[c],y=i,w=r,R=w;e:for(;R!==null;){switch(R.tag){case 27:if(Ks(R.type)){rn=R.stateNode,fi=!1;break e}break;case 5:rn=R.stateNode,fi=!1;break e;case 3:case 4:rn=R.stateNode.containerInfo,fi=!0;break e}R=R.return}if(rn===null)throw Error(s(160));Fb(y,w,m),rn=null,fi=!1,y=m.alternate,y!==null&&(y.return=null),m.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)Gb(r,i),r=r.sibling}var sr=null;function Gb(i,r){var o=i.alternate,c=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:mi(r,i),gi(i),c&4&&(Fs(3,i,i.return),Ac(3,i),Fs(5,i,i.return));break;case 1:mi(r,i),gi(i),c&512&&(In||o===null||Ir(o,o.return)),c&64&&is&&(i=i.updateQueue,i!==null&&(c=i.callbacks,c!==null&&(o=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var m=sr;if(mi(r,i),gi(i),c&512&&(In||o===null||Ir(o,o.return)),c&4){var y=o!==null?o.memoizedState:null;if(c=i.memoizedState,o===null)if(c===null)if(i.stateNode===null){e:{c=i.type,o=i.memoizedProps,m=m.ownerDocument||m;t:switch(c){case"title":y=m.getElementsByTagName("title")[0],(!y||y[gr]||y[En]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=m.createElement(c),m.head.insertBefore(y,m.querySelector("head > title"))),Wn(y,c,o),y[En]=i,Tn(y),c=y;break e;case"link":var w=G0("link","href",m).get(c+(o.href||""));if(w){for(var R=0;R<w.length;R++)if(y=w[R],y.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&y.getAttribute("rel")===(o.rel==null?null:o.rel)&&y.getAttribute("title")===(o.title==null?null:o.title)&&y.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){w.splice(R,1);break t}}y=m.createElement(c),Wn(y,c,o),m.head.appendChild(y);break;case"meta":if(w=G0("meta","content",m).get(c+(o.content||""))){for(R=0;R<w.length;R++)if(y=w[R],y.getAttribute("content")===(o.content==null?null:""+o.content)&&y.getAttribute("name")===(o.name==null?null:o.name)&&y.getAttribute("property")===(o.property==null?null:o.property)&&y.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&y.getAttribute("charset")===(o.charSet==null?null:o.charSet)){w.splice(R,1);break t}}y=m.createElement(c),Wn(y,c,o),m.head.appendChild(y);break;default:throw Error(s(468,c))}y[En]=i,Tn(y),c=y}i.stateNode=c}else $0(m,i.type,i.stateNode);else i.stateNode=q0(m,c,i.memoizedProps);else y!==c?(y===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):y.count--,c===null?$0(m,i.type,i.stateNode):q0(m,c,i.memoizedProps)):c===null&&i.stateNode!==null&&tg(i,i.memoizedProps,o.memoizedProps)}break;case 27:mi(r,i),gi(i),c&512&&(In||o===null||Ir(o,o.return)),o!==null&&c&4&&tg(i,i.memoizedProps,o.memoizedProps);break;case 5:if(mi(r,i),gi(i),c&512&&(In||o===null||Ir(o,o.return)),i.flags&32){m=i.stateNode;try{di(m,"")}catch(Ve){Ut(i,i.return,Ve)}}c&4&&i.stateNode!=null&&(m=i.memoizedProps,tg(i,m,o!==null?o.memoizedProps:m)),c&1024&&(rg=!0);break;case 6:if(mi(r,i),gi(i),c&4){if(i.stateNode===null)throw Error(s(162));c=i.memoizedProps,o=i.stateNode;try{o.nodeValue=c}catch(Ve){Ut(i,i.return,Ve)}}break;case 3:if(Jh=null,m=sr,sr=Xh(r.containerInfo),mi(r,i),sr=m,gi(i),c&4&&o!==null&&o.memoizedState.isDehydrated)try{ul(r.containerInfo)}catch(Ve){Ut(i,i.return,Ve)}rg&&(rg=!1,$b(i));break;case 4:c=sr,sr=Xh(i.stateNode.containerInfo),mi(r,i),gi(i),sr=c;break;case 12:mi(r,i),gi(i);break;case 31:mi(r,i),gi(i),c&4&&(c=i.updateQueue,c!==null&&(i.updateQueue=null,Vh(i,c)));break;case 13:mi(r,i),gi(i),i.child.flags&8192&&i.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Uh=xt()),c&4&&(c=i.updateQueue,c!==null&&(i.updateQueue=null,Vh(i,c)));break;case 22:m=i.memoizedState!==null;var H=o!==null&&o.memoizedState!==null,re=is,me=In;if(is=re||m,In=me||H,mi(r,i),In=me,is=re,gi(i),c&8192)e:for(r=i.stateNode,r._visibility=m?r._visibility&-2:r._visibility|1,m&&(o===null||H||is||In||Ja(i)),o=null,r=i;;){if(r.tag===5||r.tag===26){if(o===null){H=o=r;try{if(y=H.stateNode,m)w=y.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{R=H.stateNode;var ye=H.memoizedProps.style,se=ye!=null&&ye.hasOwnProperty("display")?ye.display:null;R.style.display=se==null||typeof se=="boolean"?"":(""+se).trim()}}catch(Ve){Ut(H,H.return,Ve)}}}else if(r.tag===6){if(o===null){H=r;try{H.stateNode.nodeValue=m?"":H.memoizedProps}catch(Ve){Ut(H,H.return,Ve)}}}else if(r.tag===18){if(o===null){H=r;try{var ue=H.stateNode;m?k0(ue,!0):k0(H.stateNode,!1)}catch(Ve){Ut(H,H.return,Ve)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===i)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===i)break e;for(;r.sibling===null;){if(r.return===null||r.return===i)break e;o===r&&(o=null),r=r.return}o===r&&(o=null),r.sibling.return=r.return,r=r.sibling}c&4&&(c=i.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,Vh(i,o))));break;case 19:mi(r,i),gi(i),c&4&&(c=i.updateQueue,c!==null&&(i.updateQueue=null,Vh(i,c)));break;case 30:break;case 21:break;default:mi(r,i),gi(i)}}function gi(i){var r=i.flags;if(r&2){try{for(var o,c=i.return;c!==null;){if(Vb(c)){o=c;break}c=c.return}if(o==null)throw Error(s(160));switch(o.tag){case 27:var m=o.stateNode,y=ng(i);Ph(i,y,m);break;case 5:var w=o.stateNode;o.flags&32&&(di(w,""),o.flags&=-33);var R=ng(i);Ph(i,R,w);break;case 3:case 4:var H=o.stateNode.containerInfo,re=ng(i);ig(i,re,H);break;default:throw Error(s(161))}}catch(me){Ut(i,i.return,me)}i.flags&=-3}r&4096&&(i.flags&=-4097)}function $b(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var r=i;$b(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),i=i.sibling}}function ss(i,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)zb(i,r.alternate,r),r=r.sibling}function Ja(i){for(i=i.child;i!==null;){var r=i;switch(r.tag){case 0:case 11:case 14:case 15:Fs(4,r,r.return),Ja(r);break;case 1:Ir(r,r.return);var o=r.stateNode;typeof o.componentWillUnmount=="function"&&kb(r,r.return,o),Ja(r);break;case 27:kc(r.stateNode);case 26:case 5:Ir(r,r.return),Ja(r);break;case 22:r.memoizedState===null&&Ja(r);break;case 30:Ja(r);break;default:Ja(r)}i=i.sibling}}function as(i,r,o){for(o=o&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var c=r.alternate,m=i,y=r,w=y.flags;switch(y.tag){case 0:case 11:case 15:as(m,y,o),Ac(4,y);break;case 1:if(as(m,y,o),c=y,m=c.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(re){Ut(c,c.return,re)}if(c=y,m=c.updateQueue,m!==null){var R=c.stateNode;try{var H=m.shared.hiddenCallbacks;if(H!==null)for(m.shared.hiddenCallbacks=null,m=0;m<H.length;m++)E_(H[m],R)}catch(re){Ut(c,c.return,re)}}o&&w&64&&jb(y),Cc(y,y.return);break;case 27:Lb(y);case 26:case 5:as(m,y,o),o&&c===null&&w&4&&Pb(y),Cc(y,y.return);break;case 12:as(m,y,o);break;case 31:as(m,y,o),o&&w&4&&Hb(m,y);break;case 13:as(m,y,o),o&&w&4&&qb(m,y);break;case 22:y.memoizedState===null&&as(m,y,o),Cc(y,y.return);break;case 30:break;default:as(m,y,o)}r=r.sibling}}function sg(i,r){var o=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(o=i.memoizedState.cachePool.pool),i=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(i=r.memoizedState.cachePool.pool),i!==o&&(i!=null&&i.refCount++,o!=null&&dc(o))}function ag(i,r){i=null,r.alternate!==null&&(i=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==i&&(r.refCount++,i!=null&&dc(i))}function ar(i,r,o,c){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Qb(i,r,o,c),r=r.sibling}function Qb(i,r,o,c){var m=r.flags;switch(r.tag){case 0:case 11:case 15:ar(i,r,o,c),m&2048&&Ac(9,r);break;case 1:ar(i,r,o,c);break;case 3:ar(i,r,o,c),m&2048&&(i=null,r.alternate!==null&&(i=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==i&&(r.refCount++,i!=null&&dc(i)));break;case 12:if(m&2048){ar(i,r,o,c),i=r.stateNode;try{var y=r.memoizedProps,w=y.id,R=y.onPostCommit;typeof R=="function"&&R(w,r.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(H){Ut(r,r.return,H)}}else ar(i,r,o,c);break;case 31:ar(i,r,o,c);break;case 13:ar(i,r,o,c);break;case 23:break;case 22:y=r.stateNode,w=r.alternate,r.memoizedState!==null?y._visibility&2?ar(i,r,o,c):xc(i,r):y._visibility&2?ar(i,r,o,c):(y._visibility|=2,Jo(i,r,o,c,(r.subtreeFlags&10256)!==0||!1)),m&2048&&sg(w,r);break;case 24:ar(i,r,o,c),m&2048&&ag(r.alternate,r);break;default:ar(i,r,o,c)}}function Jo(i,r,o,c,m){for(m=m&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var y=i,w=r,R=o,H=c,re=w.flags;switch(w.tag){case 0:case 11:case 15:Jo(y,w,R,H,m),Ac(8,w);break;case 23:break;case 22:var me=w.stateNode;w.memoizedState!==null?me._visibility&2?Jo(y,w,R,H,m):xc(y,w):(me._visibility|=2,Jo(y,w,R,H,m)),m&&re&2048&&sg(w.alternate,w);break;case 24:Jo(y,w,R,H,m),m&&re&2048&&ag(w.alternate,w);break;default:Jo(y,w,R,H,m)}r=r.sibling}}function xc(i,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var o=i,c=r,m=c.flags;switch(c.tag){case 22:xc(o,c),m&2048&&sg(c.alternate,c);break;case 24:xc(o,c),m&2048&&ag(c.alternate,c);break;default:xc(o,c)}r=r.sibling}}var Rc=8192;function el(i,r,o){if(i.subtreeFlags&Rc)for(i=i.child;i!==null;)Yb(i,r,o),i=i.sibling}function Yb(i,r,o){switch(i.tag){case 26:el(i,r,o),i.flags&Rc&&i.memoizedState!==null&&mR(o,sr,i.memoizedState,i.memoizedProps);break;case 5:el(i,r,o);break;case 3:case 4:var c=sr;sr=Xh(i.stateNode.containerInfo),el(i,r,o),sr=c;break;case 22:i.memoizedState===null&&(c=i.alternate,c!==null&&c.memoizedState!==null?(c=Rc,Rc=16777216,el(i,r,o),Rc=c):el(i,r,o));break;default:el(i,r,o)}}function Kb(i){var r=i.alternate;if(r!==null&&(i=r.child,i!==null)){r.child=null;do r=i.sibling,i.sibling=null,i=r;while(i!==null)}}function Ic(i){var r=i.deletions;if((i.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];Fn=c,Xb(c,i)}Kb(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Wb(i),i=i.sibling}function Wb(i){switch(i.tag){case 0:case 11:case 15:Ic(i),i.flags&2048&&Fs(9,i,i.return);break;case 3:Ic(i);break;case 12:Ic(i);break;case 22:var r=i.stateNode;i.memoizedState!==null&&r._visibility&2&&(i.return===null||i.return.tag!==13)?(r._visibility&=-3,Lh(i)):Ic(i);break;default:Ic(i)}}function Lh(i){var r=i.deletions;if((i.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];Fn=c,Xb(c,i)}Kb(i)}for(i=i.child;i!==null;){switch(r=i,r.tag){case 0:case 11:case 15:Fs(8,r,r.return),Lh(r);break;case 22:o=r.stateNode,o._visibility&2&&(o._visibility&=-3,Lh(r));break;default:Lh(r)}i=i.sibling}}function Xb(i,r){for(;Fn!==null;){var o=Fn;switch(o.tag){case 0:case 11:case 15:Fs(8,o,r);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:dc(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,Fn=c;else e:for(o=i;Fn!==null;){c=Fn;var m=c.sibling,y=c.return;if(Bb(c),c===o){Fn=null;break e}if(m!==null){m.return=y,Fn=m;break e}Fn=y}}}var Ix={getCacheForType:function(i){var r=Yn(Cn),o=r.data.get(i);return o===void 0&&(o=i(),r.data.set(i,o)),o},cacheSignal:function(){return Yn(Cn).controller.signal}},Nx=typeof WeakMap=="function"?WeakMap:Map,Mt=0,Yt=null,ht=null,gt=0,Lt=0,Ii=null,Hs=!1,tl=!1,og=!1,os=0,dn=0,qs=0,eo=0,lg=0,Ni=0,nl=0,Nc=null,pi=null,cg=!1,Uh=0,Zb=0,zh=1/0,Bh=null,Gs=null,Vn=0,$s=null,il=null,ls=0,ug=0,hg=null,Jb=null,Dc=0,dg=null;function Di(){return(Mt&2)!==0&&gt!==0?gt&-gt:D.T!==null?vg():fr()}function e0(){if(Ni===0)if((gt&536870912)===0||bt){var i=ct;ct<<=1,(ct&3932160)===0&&(ct=262144),Ni=i}else Ni=536870912;return i=xi.current,i!==null&&(i.flags|=32),Ni}function yi(i,r,o){(i===Yt&&(Lt===2||Lt===9)||i.cancelPendingCommit!==null)&&(rl(i,0),Qs(i,gt,Ni,!1)),mt(i,o),((Mt&2)===0||i!==Yt)&&(i===Yt&&((Mt&2)===0&&(eo|=o),dn===4&&Qs(i,gt,Ni,!1)),Nr(i))}function t0(i,r,o){if((Mt&6)!==0)throw Error(s(327));var c=!o&&(r&127)===0&&(r&i.expiredLanes)===0||Le(i,r),m=c?Ox(i,r):mg(i,r,!0),y=c;do{if(m===0){tl&&!c&&Qs(i,r,0,!1);break}else{if(o=i.current.alternate,y&&!Dx(o)){m=mg(i,r,!1),y=!1;continue}if(m===2){if(y=r,i.errorRecoveryDisabledLanes&y)var w=0;else w=i.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){r=w;e:{var R=i;m=Nc;var H=R.current.memoizedState.isDehydrated;if(H&&(rl(R,w).flags|=256),w=mg(R,w,!1),w!==2){if(og&&!H){R.errorRecoveryDisabledLanes|=y,eo|=y,m=4;break e}y=pi,pi=m,y!==null&&(pi===null?pi=y:pi.push.apply(pi,y))}m=w}if(y=!1,m!==2)continue}}if(m===1){rl(i,0),Qs(i,r,0,!0);break}e:{switch(c=i,y=m,y){case 0:case 1:throw Error(s(345));case 4:if((r&4194048)!==r)break;case 6:Qs(c,r,Ni,!Hs);break e;case 2:pi=null;break;case 3:case 5:break;default:throw Error(s(329))}if((r&62914560)===r&&(m=Uh+300-xt(),10<m)){if(Qs(c,r,Ni,!Hs),Oe(c,0,!0)!==0)break e;ls=r,c.timeoutHandle=M0(n0.bind(null,c,o,pi,Bh,cg,r,Ni,eo,nl,Hs,y,"Throttled",-0,0),m);break e}n0(c,o,pi,Bh,cg,r,Ni,eo,nl,Hs,y,null,-0,0)}}break}while(!0);Nr(i)}function n0(i,r,o,c,m,y,w,R,H,re,me,ye,se,ue){if(i.timeoutHandle=-1,ye=r.subtreeFlags,ye&8192||(ye&16785408)===16785408){ye={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ji},Yb(r,y,ye);var Ve=(y&62914560)===y?Uh-xt():(y&4194048)===y?Zb-xt():0;if(Ve=gR(ye,Ve),Ve!==null){ls=y,i.cancelPendingCommit=Ve(u0.bind(null,i,r,y,o,c,m,w,R,H,me,ye,null,se,ue)),Qs(i,y,w,!re);return}}u0(i,r,y,o,c,m,w,R,H)}function Dx(i){for(var r=i;;){var o=r.tag;if((o===0||o===11||o===15)&&r.flags&16384&&(o=r.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var m=o[c],y=m.getSnapshot;m=m.value;try{if(!Ai(y(),m))return!1}catch{return!1}}if(o=r.child,r.subtreeFlags&16384&&o!==null)o.return=r,r=o;else{if(r===i)break;for(;r.sibling===null;){if(r.return===null||r.return===i)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Qs(i,r,o,c){r&=~lg,r&=~eo,i.suspendedLanes|=r,i.pingedLanes&=~r,c&&(i.warmLanes|=r),c=i.expirationTimes;for(var m=r;0<m;){var y=31-lt(m),w=1<<y;c[y]=-1,m&=~w}o!==0&&Ft(i,o,r)}function Fh(){return(Mt&6)===0?(Mc(0),!1):!0}function fg(){if(ht!==null){if(Lt===0)var i=ht.return;else i=ht,Xr=Ga=null,Im(i),Yo=null,mc=0,i=ht;for(;i!==null;)Ob(i.alternate,i),i=i.return;ht=null}}function rl(i,r){var o=i.timeoutHandle;o!==-1&&(i.timeoutHandle=-1,Xx(o)),o=i.cancelPendingCommit,o!==null&&(i.cancelPendingCommit=null,o()),ls=0,fg(),Yt=i,ht=o=Kr(i.current,null),gt=r,Lt=0,Ii=null,Hs=!1,tl=Le(i,r),og=!1,nl=Ni=lg=eo=qs=dn=0,pi=Nc=null,cg=!1,(r&8)!==0&&(r|=r&32);var c=i.entangledLanes;if(c!==0)for(i=i.entanglements,c&=r;0<c;){var m=31-lt(c),y=1<<m;r|=i[m],c&=~y}return os=r,ch(),o}function i0(i,r){rt=null,D.H=wc,r===Qo||r===yh?(r=__(),Lt=3):r===ym?(r=__(),Lt=4):Lt=r===Gm?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Ii=r,ht===null&&(dn=1,Dh(i,Bi(r,i.current)))}function r0(){var i=xi.current;return i===null?!0:(gt&4194048)===gt?Gi===null:(gt&62914560)===gt||(gt&536870912)!==0?i===Gi:!1}function s0(){var i=D.H;return D.H=wc,i===null?wc:i}function a0(){var i=D.A;return D.A=Ix,i}function Hh(){dn=4,Hs||(gt&4194048)!==gt&&xi.current!==null||(tl=!0),(qs&134217727)===0&&(eo&134217727)===0||Yt===null||Qs(Yt,gt,Ni,!1)}function mg(i,r,o){var c=Mt;Mt|=2;var m=s0(),y=a0();(Yt!==i||gt!==r)&&(Bh=null,rl(i,r)),r=!1;var w=dn;e:do try{if(Lt!==0&&ht!==null){var R=ht,H=Ii;switch(Lt){case 8:fg(),w=6;break e;case 3:case 2:case 9:case 6:xi.current===null&&(r=!0);var re=Lt;if(Lt=0,Ii=null,sl(i,R,H,re),o&&tl){w=0;break e}break;default:re=Lt,Lt=0,Ii=null,sl(i,R,H,re)}}Mx(),w=dn;break}catch(me){i0(i,me)}while(!0);return r&&i.shellSuspendCounter++,Xr=Ga=null,Mt=c,D.H=m,D.A=y,ht===null&&(Yt=null,gt=0,ch()),w}function Mx(){for(;ht!==null;)o0(ht)}function Ox(i,r){var o=Mt;Mt|=2;var c=s0(),m=a0();Yt!==i||gt!==r?(Bh=null,zh=xt()+500,rl(i,r)):tl=Le(i,r);e:do try{if(Lt!==0&&ht!==null){r=ht;var y=Ii;t:switch(Lt){case 1:Lt=0,Ii=null,sl(i,r,y,1);break;case 2:case 9:if(y_(y)){Lt=0,Ii=null,l0(r);break}r=function(){Lt!==2&&Lt!==9||Yt!==i||(Lt=7),Nr(i)},y.then(r,r);break e;case 3:Lt=7;break e;case 4:Lt=5;break e;case 7:y_(y)?(Lt=0,Ii=null,l0(r)):(Lt=0,Ii=null,sl(i,r,y,7));break;case 5:var w=null;switch(ht.tag){case 26:w=ht.memoizedState;case 5:case 27:var R=ht;if(w?Q0(w):R.stateNode.complete){Lt=0,Ii=null;var H=R.sibling;if(H!==null)ht=H;else{var re=R.return;re!==null?(ht=re,qh(re)):ht=null}break t}}Lt=0,Ii=null,sl(i,r,y,5);break;case 6:Lt=0,Ii=null,sl(i,r,y,6);break;case 8:fg(),dn=6;break e;default:throw Error(s(462))}}jx();break}catch(me){i0(i,me)}while(!0);return Xr=Ga=null,D.H=c,D.A=m,Mt=o,ht!==null?0:(Yt=null,gt=0,ch(),dn)}function jx(){for(;ht!==null&&!St();)o0(ht)}function o0(i){var r=Db(i.alternate,i,os);i.memoizedProps=i.pendingProps,r===null?qh(i):ht=r}function l0(i){var r=i,o=r.alternate;switch(r.tag){case 15:case 0:r=Ab(o,r,r.pendingProps,r.type,void 0,gt);break;case 11:r=Ab(o,r,r.pendingProps,r.type.render,r.ref,gt);break;case 5:Im(r);default:Ob(o,r),r=ht=a_(r,os),r=Db(o,r,os)}i.memoizedProps=i.pendingProps,r===null?qh(i):ht=r}function sl(i,r,o,c){Xr=Ga=null,Im(r),Yo=null,mc=0;var m=r.return;try{if(wx(i,m,r,o,gt)){dn=1,Dh(i,Bi(o,i.current)),ht=null;return}}catch(y){if(m!==null)throw ht=m,y;dn=1,Dh(i,Bi(o,i.current)),ht=null;return}r.flags&32768?(bt||c===1?i=!0:tl||(gt&536870912)!==0?i=!1:(Hs=i=!0,(c===2||c===9||c===3||c===6)&&(c=xi.current,c!==null&&c.tag===13&&(c.flags|=16384))),c0(r,i)):qh(r)}function qh(i){var r=i;do{if((r.flags&32768)!==0){c0(r,Hs);return}i=r.return;var o=Ax(r.alternate,r,os);if(o!==null){ht=o;return}if(r=r.sibling,r!==null){ht=r;return}ht=r=i}while(r!==null);dn===0&&(dn=5)}function c0(i,r){do{var o=Cx(i.alternate,i);if(o!==null){o.flags&=32767,ht=o;return}if(o=i.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!r&&(i=i.sibling,i!==null)){ht=i;return}ht=i=o}while(i!==null);dn=6,ht=null}function u0(i,r,o,c,m,y,w,R,H){i.cancelPendingCommit=null;do Gh();while(Vn!==0);if((Mt&6)!==0)throw Error(s(327));if(r!==null){if(r===i.current)throw Error(s(177));if(y=r.lanes|r.childLanes,y|=nm,Ot(i,o,y,w,R,H),i===Yt&&(ht=Yt=null,gt=0),il=r,$s=i,ls=o,ug=y,hg=m,Jb=c,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,Lx(Wt,function(){return g0(),null})):(i.callbackNode=null,i.callbackPriority=0),c=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||c){c=D.T,D.T=null,m=$.p,$.p=2,w=Mt,Mt|=4;try{xx(i,r,o)}finally{Mt=w,$.p=m,D.T=c}}Vn=1,h0(),d0(),f0()}}function h0(){if(Vn===1){Vn=0;var i=$s,r=il,o=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||o){o=D.T,D.T=null;var c=$.p;$.p=2;var m=Mt;Mt|=4;try{Gb(r,i);var y=Cg,w=Xv(i.containerInfo),R=y.focusedElem,H=y.selectionRange;if(w!==R&&R&&R.ownerDocument&&Wv(R.ownerDocument.documentElement,R)){if(H!==null&&Xf(R)){var re=H.start,me=H.end;if(me===void 0&&(me=re),"selectionStart"in R)R.selectionStart=re,R.selectionEnd=Math.min(me,R.value.length);else{var ye=R.ownerDocument||document,se=ye&&ye.defaultView||window;if(se.getSelection){var ue=se.getSelection(),Ve=R.textContent.length,Qe=Math.min(H.start,Ve),$t=H.end===void 0?Qe:Math.min(H.end,Ve);!ue.extend&&Qe>$t&&(w=$t,$t=Qe,Qe=w);var Z=Kv(R,Qe),W=Kv(R,$t);if(Z&&W&&(ue.rangeCount!==1||ue.anchorNode!==Z.node||ue.anchorOffset!==Z.offset||ue.focusNode!==W.node||ue.focusOffset!==W.offset)){var ie=ye.createRange();ie.setStart(Z.node,Z.offset),ue.removeAllRanges(),Qe>$t?(ue.addRange(ie),ue.extend(W.node,W.offset)):(ie.setEnd(W.node,W.offset),ue.addRange(ie))}}}}for(ye=[],ue=R;ue=ue.parentNode;)ue.nodeType===1&&ye.push({element:ue,left:ue.scrollLeft,top:ue.scrollTop});for(typeof R.focus=="function"&&R.focus(),R=0;R<ye.length;R++){var pe=ye[R];pe.element.scrollLeft=pe.left,pe.element.scrollTop=pe.top}}id=!!Ag,Cg=Ag=null}finally{Mt=m,$.p=c,D.T=o}}i.current=r,Vn=2}}function d0(){if(Vn===2){Vn=0;var i=$s,r=il,o=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||o){o=D.T,D.T=null;var c=$.p;$.p=2;var m=Mt;Mt|=4;try{zb(i,r.alternate,r)}finally{Mt=m,$.p=c,D.T=o}}Vn=3}}function f0(){if(Vn===4||Vn===3){Vn=0,tn();var i=$s,r=il,o=ls,c=Jb;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Vn=5:(Vn=0,il=$s=null,m0(i,i.pendingLanes));var m=i.pendingLanes;if(m===0&&(Gs=null),ui(o),r=r.stateNode,Xe&&typeof Xe.onCommitFiberRoot=="function")try{Xe.onCommitFiberRoot(at,r,void 0,(r.current.flags&128)===128)}catch{}if(c!==null){r=D.T,m=$.p,$.p=2,D.T=null;try{for(var y=i.onRecoverableError,w=0;w<c.length;w++){var R=c[w];y(R.value,{componentStack:R.stack})}}finally{D.T=r,$.p=m}}(ls&3)!==0&&Gh(),Nr(i),m=i.pendingLanes,(o&261930)!==0&&(m&42)!==0?i===dg?Dc++:(Dc=0,dg=i):Dc=0,Mc(0)}}function m0(i,r){(i.pooledCacheLanes&=r)===0&&(r=i.pooledCache,r!=null&&(i.pooledCache=null,dc(r)))}function Gh(){return h0(),d0(),f0(),g0()}function g0(){if(Vn!==5)return!1;var i=$s,r=ug;ug=0;var o=ui(ls),c=D.T,m=$.p;try{$.p=32>o?32:o,D.T=null,o=hg,hg=null;var y=$s,w=ls;if(Vn=0,il=$s=null,ls=0,(Mt&6)!==0)throw Error(s(331));var R=Mt;if(Mt|=4,Wb(y.current),Qb(y,y.current,w,o),Mt=R,Mc(0,!1),Xe&&typeof Xe.onPostCommitFiberRoot=="function")try{Xe.onPostCommitFiberRoot(at,y)}catch{}return!0}finally{$.p=m,D.T=c,m0(i,r)}}function p0(i,r,o){r=Bi(o,r),r=qm(i.stateNode,r,2),i=Us(i,r,2),i!==null&&(mt(i,2),Nr(i))}function Ut(i,r,o){if(i.tag===3)p0(i,i,o);else for(;r!==null;){if(r.tag===3){p0(r,i,o);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Gs===null||!Gs.has(c))){i=Bi(o,i),o=yb(2),c=Us(r,o,2),c!==null&&(vb(o,c,r,i),mt(c,2),Nr(c));break}}r=r.return}}function gg(i,r,o){var c=i.pingCache;if(c===null){c=i.pingCache=new Nx;var m=new Set;c.set(r,m)}else m=c.get(r),m===void 0&&(m=new Set,c.set(r,m));m.has(o)||(og=!0,m.add(o),i=kx.bind(null,i,r,o),r.then(i,i))}function kx(i,r,o){var c=i.pingCache;c!==null&&c.delete(r),i.pingedLanes|=i.suspendedLanes&o,i.warmLanes&=~o,Yt===i&&(gt&o)===o&&(dn===4||dn===3&&(gt&62914560)===gt&&300>xt()-Uh?(Mt&2)===0&&rl(i,0):lg|=o,nl===gt&&(nl=0)),Nr(i)}function y0(i,r){r===0&&(r=pn()),i=Fa(i,r),i!==null&&(mt(i,r),Nr(i))}function Px(i){var r=i.memoizedState,o=0;r!==null&&(o=r.retryLane),y0(i,o)}function Vx(i,r){var o=0;switch(i.tag){case 31:case 13:var c=i.stateNode,m=i.memoizedState;m!==null&&(o=m.retryLane);break;case 19:c=i.stateNode;break;case 22:c=i.stateNode._retryCache;break;default:throw Error(s(314))}c!==null&&c.delete(r),y0(i,o)}function Lx(i,r){return Ne(i,r)}var $h=null,al=null,pg=!1,Qh=!1,yg=!1,Ys=0;function Nr(i){i!==al&&i.next===null&&(al===null?$h=al=i:al=al.next=i),Qh=!0,pg||(pg=!0,zx())}function Mc(i,r){if(!yg&&Qh){yg=!0;do for(var o=!1,c=$h;c!==null;){if(i!==0){var m=c.pendingLanes;if(m===0)var y=0;else{var w=c.suspendedLanes,R=c.pingedLanes;y=(1<<31-lt(42|i)+1)-1,y&=m&~(w&~R),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(o=!0,S0(c,y))}else y=gt,y=Oe(c,c===Yt?y:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(y&3)===0||Le(c,y)||(o=!0,S0(c,y));c=c.next}while(o);yg=!1}}function Ux(){v0()}function v0(){Qh=pg=!1;var i=0;Ys!==0&&Wx()&&(i=Ys);for(var r=xt(),o=null,c=$h;c!==null;){var m=c.next,y=_0(c,r);y===0?(c.next=null,o===null?$h=m:o.next=m,m===null&&(al=o)):(o=c,(i!==0||(y&3)!==0)&&(Qh=!0)),c=m}Vn!==0&&Vn!==5||Mc(i),Ys!==0&&(Ys=0)}function _0(i,r){for(var o=i.suspendedLanes,c=i.pingedLanes,m=i.expirationTimes,y=i.pendingLanes&-62914561;0<y;){var w=31-lt(y),R=1<<w,H=m[w];H===-1?((R&o)===0||(R&c)!==0)&&(m[w]=ut(R,r)):H<=r&&(i.expiredLanes|=R),y&=~R}if(r=Yt,o=gt,o=Oe(i,i===r?o:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),c=i.callbackNode,o===0||i===r&&(Lt===2||Lt===9)||i.cancelPendingCommit!==null)return c!==null&&c!==null&&We(c),i.callbackNode=null,i.callbackPriority=0;if((o&3)===0||Le(i,o)){if(r=o&-o,r===i.callbackPriority)return r;switch(c!==null&&We(c),ui(o)){case 2:case 8:o=Bt;break;case 32:o=Wt;break;case 268435456:o=ci;break;default:o=Wt}return c=b0.bind(null,i),o=Ne(o,c),i.callbackPriority=r,i.callbackNode=o,r}return c!==null&&c!==null&&We(c),i.callbackPriority=2,i.callbackNode=null,2}function b0(i,r){if(Vn!==0&&Vn!==5)return i.callbackNode=null,i.callbackPriority=0,null;var o=i.callbackNode;if(Gh()&&i.callbackNode!==o)return null;var c=gt;return c=Oe(i,i===Yt?c:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),c===0?null:(t0(i,c,r),_0(i,xt()),i.callbackNode!=null&&i.callbackNode===o?b0.bind(null,i):null)}function S0(i,r){if(Gh())return null;t0(i,r,!0)}function zx(){Zx(function(){(Mt&6)!==0?Ne(wt,Ux):v0()})}function vg(){if(Ys===0){var i=Go;i===0&&(i=Be,Be<<=1,(Be&261888)===0&&(Be=256)),Ys=i}return Ys}function w0(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:No(""+i)}function E0(i,r){var o=r.ownerDocument.createElement("input");return o.name=r.name,o.value=r.value,i.id&&o.setAttribute("form",i.id),r.parentNode.insertBefore(o,r),i=new FormData(i),o.parentNode.removeChild(o),i}function Bx(i,r,o,c,m){if(r==="submit"&&o&&o.stateNode===m){var y=w0((m[zn]||null).action),w=c.submitter;w&&(r=(r=w[zn]||null)?w0(r.formAction):w.getAttribute("formAction"),r!==null&&(y=r,w=null));var R=new Er("action","action",null,c,m);i.push({event:R,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Ys!==0){var H=w?E0(m,w):new FormData(m);Lm(o,{pending:!0,data:H,method:m.method,action:y},null,H)}}else typeof y=="function"&&(R.preventDefault(),H=w?E0(m,w):new FormData(m),Lm(o,{pending:!0,data:H,method:m.method,action:y},y,H))},currentTarget:m}]})}}for(var _g=0;_g<tm.length;_g++){var bg=tm[_g],Fx=bg.toLowerCase(),Hx=bg[0].toUpperCase()+bg.slice(1);rr(Fx,"on"+Hx)}rr(e_,"onAnimationEnd"),rr(t_,"onAnimationIteration"),rr(n_,"onAnimationStart"),rr("dblclick","onDoubleClick"),rr("focusin","onFocus"),rr("focusout","onBlur"),rr(sx,"onTransitionRun"),rr(ax,"onTransitionStart"),rr(ox,"onTransitionCancel"),rr(i_,"onTransitionEnd"),_r("onMouseEnter",["mouseout","mouseover"]),_r("onMouseLeave",["mouseout","mouseover"]),_r("onPointerEnter",["pointerout","pointerover"]),_r("onPointerLeave",["pointerout","pointerover"]),vr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),vr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),vr("onBeforeInput",["compositionend","keypress","textInput","paste"]),vr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),vr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),vr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Oc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),qx=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Oc));function T0(i,r){r=(r&4)!==0;for(var o=0;o<i.length;o++){var c=i[o],m=c.event;c=c.listeners;e:{var y=void 0;if(r)for(var w=c.length-1;0<=w;w--){var R=c[w],H=R.instance,re=R.currentTarget;if(R=R.listener,H!==y&&m.isPropagationStopped())break e;y=R,m.currentTarget=re;try{y(m)}catch(me){lh(me)}m.currentTarget=null,y=H}else for(w=0;w<c.length;w++){if(R=c[w],H=R.instance,re=R.currentTarget,R=R.listener,H!==y&&m.isPropagationStopped())break e;y=R,m.currentTarget=re;try{y(m)}catch(me){lh(me)}m.currentTarget=null,y=H}}}}function dt(i,r){var o=r[Ao];o===void 0&&(o=r[Ao]=new Set);var c=i+"__bubble";o.has(c)||(A0(r,i,2,!1),o.add(c))}function Sg(i,r,o){var c=0;r&&(c|=4),A0(o,i,c,r)}var Yh="_reactListening"+Math.random().toString(36).slice(2);function wg(i){if(!i[Yh]){i[Yh]=!0,Gl.forEach(function(o){o!=="selectionchange"&&(qx.has(o)||Sg(o,!1,i),Sg(o,!0,i))});var r=i.nodeType===9?i:i.ownerDocument;r===null||r[Yh]||(r[Yh]=!0,Sg("selectionchange",!1,r))}}function A0(i,r,o,c){switch(eS(r)){case 2:var m=vR;break;case 8:m=_R;break;default:m=Vg}o=m.bind(null,r,o,i),m=void 0,!ja||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(m=!0),c?m!==void 0?i.addEventListener(r,o,{capture:!0,passive:m}):i.addEventListener(r,o,!0):m!==void 0?i.addEventListener(r,o,{passive:m}):i.addEventListener(r,o,!1)}function Eg(i,r,o,c,m){var y=c;if((r&1)===0&&(r&2)===0&&c!==null)e:for(;;){if(c===null)return;var w=c.tag;if(w===3||w===4){var R=c.stateNode.containerInfo;if(R===m)break;if(w===4)for(w=c.return;w!==null;){var H=w.tag;if((H===3||H===4)&&w.stateNode.containerInfo===m)return;w=w.return}for(;R!==null;){if(w=pr(R),w===null)return;if(H=w.tag,H===5||H===6||H===26||H===27){c=y=w;continue e}R=R.parentNode}}c=c.return}Is(function(){var re=y,me=Vi(o),ye=[];e:{var se=r_.get(i);if(se!==void 0){var ue=Er,Ve=i;switch(i){case"keypress":if(Pa(o)===0)break e;case"keydown":case"keyup":ue=sh;break;case"focusin":Ve="focus",ue=La;break;case"focusout":Ve="blur",ue=La;break;case"beforeblur":case"afterblur":ue=La;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ue=rc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ue=Wu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ue=b;break;case e_:case t_:case n_:ue=Zu;break;case i_:ue=j;break;case"scroll":case"scrollend":ue=ic;break;case"wheel":ue=ce;break;case"copy":case"cut":case"paste":ue=Ju;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ue=Yr;break;case"toggle":case"beforetoggle":ue=it}var Qe=(r&4)!==0,$t=!Qe&&(i==="scroll"||i==="scrollend"),Z=Qe?se!==null?se+"Capture":null:se;Qe=[];for(var W=re,ie;W!==null;){var pe=W;if(ie=pe.stateNode,pe=pe.tag,pe!==5&&pe!==26&&pe!==27||ie===null||Z===null||(pe=er(W,Z),pe!=null&&Qe.push(jc(W,pe,ie))),$t)break;W=W.return}0<Qe.length&&(se=new ue(se,Ve,null,o,me),ye.push({event:se,listeners:Qe}))}}if((r&7)===0){e:{if(se=i==="mouseover"||i==="pointerover",ue=i==="mouseout"||i==="pointerout",se&&o!==ec&&(Ve=o.relatedTarget||o.fromElement)&&(pr(Ve)||Ve[mr]))break e;if((ue||se)&&(se=me.window===me?me:(se=me.ownerDocument)?se.defaultView||se.parentWindow:window,ue?(Ve=o.relatedTarget||o.toElement,ue=re,Ve=Ve?pr(Ve):null,Ve!==null&&($t=l(Ve),Qe=Ve.tag,Ve!==$t||Qe!==5&&Qe!==27&&Qe!==6)&&(Ve=null)):(ue=null,Ve=re),ue!==Ve)){if(Qe=rc,pe="onMouseLeave",Z="onMouseEnter",W="mouse",(i==="pointerout"||i==="pointerover")&&(Qe=Yr,pe="onPointerLeave",Z="onPointerEnter",W="pointer"),$t=ue==null?se:Ei(ue),ie=Ve==null?se:Ei(Ve),se=new Qe(pe,W+"leave",ue,o,me),se.target=$t,se.relatedTarget=ie,pe=null,pr(me)===re&&(Qe=new Qe(Z,W+"enter",Ve,o,me),Qe.target=ie,Qe.relatedTarget=$t,pe=Qe),$t=pe,ue&&Ve)t:{for(Qe=Gx,Z=ue,W=Ve,ie=0,pe=Z;pe;pe=Qe(pe))ie++;pe=0;for(var Ge=W;Ge;Ge=Qe(Ge))pe++;for(;0<ie-pe;)Z=Qe(Z),ie--;for(;0<pe-ie;)W=Qe(W),pe--;for(;ie--;){if(Z===W||W!==null&&Z===W.alternate){Qe=Z;break t}Z=Qe(Z),W=Qe(W)}Qe=null}else Qe=null;ue!==null&&C0(ye,se,ue,Qe,!1),Ve!==null&&$t!==null&&C0(ye,$t,Ve,Qe,!0)}}e:{if(se=re?Ei(re):window,ue=se.nodeName&&se.nodeName.toLowerCase(),ue==="select"||ue==="input"&&se.type==="file")var Rt=Hv;else if(Bv(se))if(qv)Rt=nx;else{Rt=ex;var Fe=JC}else ue=se.nodeName,!ue||ue.toLowerCase()!=="input"||se.type!=="checkbox"&&se.type!=="radio"?re&&Io(re.elementType)&&(Rt=Hv):Rt=tx;if(Rt&&(Rt=Rt(i,re))){Fv(ye,Rt,o,me);break e}Fe&&Fe(i,se,re),i==="focusout"&&re&&se.type==="number"&&re.memoizedProps.value!=null&&Xl(se,"number",se.value)}switch(Fe=re?Ei(re):window,i){case"focusin":(Bv(Fe)||Fe.contentEditable==="true")&&(Vo=Fe,Zf=re,cc=null);break;case"focusout":cc=Zf=Vo=null;break;case"mousedown":Jf=!0;break;case"contextmenu":case"mouseup":case"dragend":Jf=!1,Zv(ye,o,me);break;case"selectionchange":if(rx)break;case"keydown":case"keyup":Zv(ye,o,me)}var ot;if(Dt)e:{switch(i){case"compositionstart":var pt="onCompositionStart";break e;case"compositionend":pt="onCompositionEnd";break e;case"compositionupdate":pt="onCompositionUpdate";break e}pt=void 0}else Po?Ua(i,o)&&(pt="onCompositionEnd"):i==="keydown"&&o.keyCode===229&&(pt="onCompositionStart");pt&&(Cr&&o.locale!=="ko"&&(Po||pt!=="onCompositionStart"?pt==="onCompositionEnd"&&Po&&(ot=nc()):(wr=me,tc="value"in wr?wr.value:wr.textContent,Po=!0)),Fe=Kh(re,pt),0<Fe.length&&(pt=new Ar(pt,i,null,o,me),ye.push({event:pt,listeners:Fe}),ot?pt.data=ot:(ot=ko(o),ot!==null&&(pt.data=ot)))),(ot=Ui?KC(i,o):WC(i,o))&&(pt=Kh(re,"onBeforeInput"),0<pt.length&&(Fe=new Ar("onBeforeInput","beforeinput",null,o,me),ye.push({event:Fe,listeners:pt}),Fe.data=ot)),Bx(ye,i,re,o,me)}T0(ye,r)})}function jc(i,r,o){return{instance:i,listener:r,currentTarget:o}}function Kh(i,r){for(var o=r+"Capture",c=[];i!==null;){var m=i,y=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||y===null||(m=er(i,o),m!=null&&c.unshift(jc(i,m,y)),m=er(i,r),m!=null&&c.push(jc(i,m,y))),i.tag===3)return c;i=i.return}return[]}function Gx(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function C0(i,r,o,c,m){for(var y=r._reactName,w=[];o!==null&&o!==c;){var R=o,H=R.alternate,re=R.stateNode;if(R=R.tag,H!==null&&H===c)break;R!==5&&R!==26&&R!==27||re===null||(H=re,m?(re=er(o,y),re!=null&&w.unshift(jc(o,re,H))):m||(re=er(o,y),re!=null&&w.push(jc(o,re,H)))),o=o.return}w.length!==0&&i.push({event:r,listeners:w})}var $x=/\r\n?/g,Qx=/\u0000|\uFFFD/g;function x0(i){return(typeof i=="string"?i:""+i).replace($x,`
`).replace(Qx,"")}function R0(i,r){return r=x0(r),x0(i)===r}function Gt(i,r,o,c,m,y){switch(o){case"children":typeof c=="string"?r==="body"||r==="textarea"&&c===""||di(i,c):(typeof c=="number"||typeof c=="bigint")&&r!=="body"&&di(i,""+c);break;case"className":Ti(i,"class",c);break;case"tabIndex":Ti(i,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":Ti(i,o,c);break;case"style":Jl(i,c,y);break;case"data":if(r!=="object"){Ti(i,"data",c);break}case"src":case"href":if(c===""&&(r!=="a"||o!=="href")){i.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){i.removeAttribute(o);break}c=No(""+c),i.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){i.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(o==="formAction"?(r!=="input"&&Gt(i,r,"name",m.name,m,null),Gt(i,r,"formEncType",m.formEncType,m,null),Gt(i,r,"formMethod",m.formMethod,m,null),Gt(i,r,"formTarget",m.formTarget,m,null)):(Gt(i,r,"encType",m.encType,m,null),Gt(i,r,"method",m.method,m,null),Gt(i,r,"target",m.target,m,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){i.removeAttribute(o);break}c=No(""+c),i.setAttribute(o,c);break;case"onClick":c!=null&&(i.onclick=Ji);break;case"onScroll":c!=null&&dt("scroll",i);break;case"onScrollEnd":c!=null&&dt("scrollend",i);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(s(61));if(o=c.__html,o!=null){if(m.children!=null)throw Error(s(60));i.innerHTML=o}}break;case"multiple":i.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":i.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){i.removeAttribute("xlink:href");break}o=No(""+c),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?i.setAttribute(o,""+c):i.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?i.setAttribute(o,""):i.removeAttribute(o);break;case"capture":case"download":c===!0?i.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?i.setAttribute(o,c):i.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?i.setAttribute(o,c):i.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?i.removeAttribute(o):i.setAttribute(o,c);break;case"popover":dt("beforetoggle",i),dt("toggle",i),xo(i,"popover",c);break;case"xlinkActuate":An(i,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":An(i,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":An(i,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":An(i,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":An(i,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":An(i,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":An(i,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":An(i,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":An(i,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":xo(i,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Ku.get(o)||o,xo(i,o,c))}}function Tg(i,r,o,c,m,y){switch(o){case"style":Jl(i,c,y);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(s(61));if(o=c.__html,o!=null){if(m.children!=null)throw Error(s(60));i.innerHTML=o}}break;case"children":typeof c=="string"?di(i,c):(typeof c=="number"||typeof c=="bigint")&&di(i,""+c);break;case"onScroll":c!=null&&dt("scroll",i);break;case"onScrollEnd":c!=null&&dt("scrollend",i);break;case"onClick":c!=null&&(i.onclick=Ji);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!$l.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(m=o.endsWith("Capture"),r=o.slice(2,m?o.length-7:void 0),y=i[zn]||null,y=y!=null?y[o]:null,typeof y=="function"&&i.removeEventListener(r,y,m),typeof c=="function")){typeof y!="function"&&y!==null&&(o in i?i[o]=null:i.hasAttribute(o)&&i.removeAttribute(o)),i.addEventListener(r,c,m);break e}o in i?i[o]=c:c===!0?i.setAttribute(o,""):xo(i,o,c)}}}function Wn(i,r,o){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":dt("error",i),dt("load",i);var c=!1,m=!1,y;for(y in o)if(o.hasOwnProperty(y)){var w=o[y];if(w!=null)switch(y){case"src":c=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,r));default:Gt(i,r,y,w,o,null)}}m&&Gt(i,r,"srcSet",o.srcSet,o,null),c&&Gt(i,r,"src",o.src,o,null);return;case"input":dt("invalid",i);var R=y=w=m=null,H=null,re=null;for(c in o)if(o.hasOwnProperty(c)){var me=o[c];if(me!=null)switch(c){case"name":m=me;break;case"type":w=me;break;case"checked":H=me;break;case"defaultChecked":re=me;break;case"value":y=me;break;case"defaultValue":R=me;break;case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(s(137,r));break;default:Gt(i,r,c,me,o,null)}}$u(i,y,R,H,re,w,m,!1);return;case"select":dt("invalid",i),c=w=y=null;for(m in o)if(o.hasOwnProperty(m)&&(R=o[m],R!=null))switch(m){case"value":y=R;break;case"defaultValue":w=R;break;case"multiple":c=R;default:Gt(i,r,m,R,o,null)}r=y,o=w,i.multiple=!!c,r!=null?As(i,!!c,r,!1):o!=null&&As(i,!!c,o,!0);return;case"textarea":dt("invalid",i),y=m=c=null;for(w in o)if(o.hasOwnProperty(w)&&(R=o[w],R!=null))switch(w){case"value":c=R;break;case"defaultValue":m=R;break;case"children":y=R;break;case"dangerouslySetInnerHTML":if(R!=null)throw Error(s(91));break;default:Gt(i,r,w,R,o,null)}Cs(i,c,m,y);return;case"option":for(H in o)if(o.hasOwnProperty(H)&&(c=o[H],c!=null))switch(H){case"selected":i.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:Gt(i,r,H,c,o,null)}return;case"dialog":dt("beforetoggle",i),dt("toggle",i),dt("cancel",i),dt("close",i);break;case"iframe":case"object":dt("load",i);break;case"video":case"audio":for(c=0;c<Oc.length;c++)dt(Oc[c],i);break;case"image":dt("error",i),dt("load",i);break;case"details":dt("toggle",i);break;case"embed":case"source":case"link":dt("error",i),dt("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(re in o)if(o.hasOwnProperty(re)&&(c=o[re],c!=null))switch(re){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,r));default:Gt(i,r,re,c,o,null)}return;default:if(Io(r)){for(me in o)o.hasOwnProperty(me)&&(c=o[me],c!==void 0&&Tg(i,r,me,c,o,void 0));return}}for(R in o)o.hasOwnProperty(R)&&(c=o[R],c!=null&&Gt(i,r,R,c,o,null))}function Yx(i,r,o,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,y=null,w=null,R=null,H=null,re=null,me=null;for(ue in o){var ye=o[ue];if(o.hasOwnProperty(ue)&&ye!=null)switch(ue){case"checked":break;case"value":break;case"defaultValue":H=ye;default:c.hasOwnProperty(ue)||Gt(i,r,ue,null,c,ye)}}for(var se in c){var ue=c[se];if(ye=o[se],c.hasOwnProperty(se)&&(ue!=null||ye!=null))switch(se){case"type":y=ue;break;case"name":m=ue;break;case"checked":re=ue;break;case"defaultChecked":me=ue;break;case"value":w=ue;break;case"defaultValue":R=ue;break;case"children":case"dangerouslySetInnerHTML":if(ue!=null)throw Error(s(137,r));break;default:ue!==ye&&Gt(i,r,se,ue,c,ye)}}Ro(i,w,R,H,re,me,y,m);return;case"select":ue=w=R=se=null;for(y in o)if(H=o[y],o.hasOwnProperty(y)&&H!=null)switch(y){case"value":break;case"multiple":ue=H;default:c.hasOwnProperty(y)||Gt(i,r,y,null,c,H)}for(m in c)if(y=c[m],H=o[m],c.hasOwnProperty(m)&&(y!=null||H!=null))switch(m){case"value":se=y;break;case"defaultValue":R=y;break;case"multiple":w=y;default:y!==H&&Gt(i,r,m,y,c,H)}r=R,o=w,c=ue,se!=null?As(i,!!o,se,!1):!!c!=!!o&&(r!=null?As(i,!!o,r,!0):As(i,!!o,o?[]:"",!1));return;case"textarea":ue=se=null;for(R in o)if(m=o[R],o.hasOwnProperty(R)&&m!=null&&!c.hasOwnProperty(R))switch(R){case"value":break;case"children":break;default:Gt(i,r,R,null,c,m)}for(w in c)if(m=c[w],y=o[w],c.hasOwnProperty(w)&&(m!=null||y!=null))switch(w){case"value":se=m;break;case"defaultValue":ue=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(s(91));break;default:m!==y&&Gt(i,r,w,m,c,y)}Qu(i,se,ue);return;case"option":for(var Ve in o)if(se=o[Ve],o.hasOwnProperty(Ve)&&se!=null&&!c.hasOwnProperty(Ve))switch(Ve){case"selected":i.selected=!1;break;default:Gt(i,r,Ve,null,c,se)}for(H in c)if(se=c[H],ue=o[H],c.hasOwnProperty(H)&&se!==ue&&(se!=null||ue!=null))switch(H){case"selected":i.selected=se&&typeof se!="function"&&typeof se!="symbol";break;default:Gt(i,r,H,se,c,ue)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Qe in o)se=o[Qe],o.hasOwnProperty(Qe)&&se!=null&&!c.hasOwnProperty(Qe)&&Gt(i,r,Qe,null,c,se);for(re in c)if(se=c[re],ue=o[re],c.hasOwnProperty(re)&&se!==ue&&(se!=null||ue!=null))switch(re){case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(s(137,r));break;default:Gt(i,r,re,se,c,ue)}return;default:if(Io(r)){for(var $t in o)se=o[$t],o.hasOwnProperty($t)&&se!==void 0&&!c.hasOwnProperty($t)&&Tg(i,r,$t,void 0,c,se);for(me in c)se=c[me],ue=o[me],!c.hasOwnProperty(me)||se===ue||se===void 0&&ue===void 0||Tg(i,r,me,se,c,ue);return}}for(var Z in o)se=o[Z],o.hasOwnProperty(Z)&&se!=null&&!c.hasOwnProperty(Z)&&Gt(i,r,Z,null,c,se);for(ye in c)se=c[ye],ue=o[ye],!c.hasOwnProperty(ye)||se===ue||se==null&&ue==null||Gt(i,r,ye,se,c,ue)}function I0(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Kx(){if(typeof performance.getEntriesByType=="function"){for(var i=0,r=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var m=o[c],y=m.transferSize,w=m.initiatorType,R=m.duration;if(y&&R&&I0(w)){for(w=0,R=m.responseEnd,c+=1;c<o.length;c++){var H=o[c],re=H.startTime;if(re>R)break;var me=H.transferSize,ye=H.initiatorType;me&&I0(ye)&&(H=H.responseEnd,w+=me*(H<R?1:(R-re)/(H-re)))}if(--c,r+=8*(y+w)/(m.duration/1e3),i++,10<i)break}}if(0<i)return r/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var Ag=null,Cg=null;function Wh(i){return i.nodeType===9?i:i.ownerDocument}function N0(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function D0(i,r){if(i===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&r==="foreignObject"?0:i}function xg(i,r){return i==="textarea"||i==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var Rg=null;function Wx(){var i=window.event;return i&&i.type==="popstate"?i===Rg?!1:(Rg=i,!0):(Rg=null,!1)}var M0=typeof setTimeout=="function"?setTimeout:void 0,Xx=typeof clearTimeout=="function"?clearTimeout:void 0,O0=typeof Promise=="function"?Promise:void 0,Zx=typeof queueMicrotask=="function"?queueMicrotask:typeof O0<"u"?function(i){return O0.resolve(null).then(i).catch(Jx)}:M0;function Jx(i){setTimeout(function(){throw i})}function Ks(i){return i==="head"}function j0(i,r){var o=r,c=0;do{var m=o.nextSibling;if(i.removeChild(o),m&&m.nodeType===8)if(o=m.data,o==="/$"||o==="/&"){if(c===0){i.removeChild(m),ul(r);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")kc(i.ownerDocument.documentElement);else if(o==="head"){o=i.ownerDocument.head,kc(o);for(var y=o.firstChild;y;){var w=y.nextSibling,R=y.nodeName;y[gr]||R==="SCRIPT"||R==="STYLE"||R==="LINK"&&y.rel.toLowerCase()==="stylesheet"||o.removeChild(y),y=w}}else o==="body"&&kc(i.ownerDocument.body);o=m}while(o);ul(r)}function k0(i,r){var o=i;i=0;do{var c=o.nextSibling;if(o.nodeType===1?r?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(r?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(i===0)break;i--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||i++;o=c}while(o)}function Ig(i){var r=i.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var o=r;switch(r=r.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":Ig(o),Co(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}i.removeChild(o)}}function eR(i,r,o,c){for(;i.nodeType===1;){var m=o;if(i.nodeName.toLowerCase()!==r.toLowerCase()){if(!c&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(c){if(!i[gr])switch(r){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(y=i.getAttribute("rel"),y==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(y!==m.rel||i.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||i.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||i.getAttribute("title")!==(m.title==null?null:m.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(y=i.getAttribute("src"),(y!==(m.src==null?null:m.src)||i.getAttribute("type")!==(m.type==null?null:m.type)||i.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&y&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(r==="input"&&i.type==="hidden"){var y=m.name==null?null:""+m.name;if(m.type==="hidden"&&i.getAttribute("name")===y)return i}else return i;if(i=$i(i.nextSibling),i===null)break}return null}function tR(i,r,o){if(r==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!o||(i=$i(i.nextSibling),i===null))return null;return i}function P0(i,r){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!r||(i=$i(i.nextSibling),i===null))return null;return i}function Ng(i){return i.data==="$?"||i.data==="$~"}function Dg(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function nR(i,r){var o=i.ownerDocument;if(i.data==="$~")i._reactRetry=r;else if(i.data!=="$?"||o.readyState!=="loading")r();else{var c=function(){r(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),i._reactRetry=c}}function $i(i){for(;i!=null;i=i.nextSibling){var r=i.nodeType;if(r===1||r===3)break;if(r===8){if(r=i.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return i}var Mg=null;function V0(i){i=i.nextSibling;for(var r=0;i;){if(i.nodeType===8){var o=i.data;if(o==="/$"||o==="/&"){if(r===0)return $i(i.nextSibling);r--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||r++}i=i.nextSibling}return null}function L0(i){i=i.previousSibling;for(var r=0;i;){if(i.nodeType===8){var o=i.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(r===0)return i;r--}else o!=="/$"&&o!=="/&"||r++}i=i.previousSibling}return null}function U0(i,r,o){switch(r=Wh(o),i){case"html":if(i=r.documentElement,!i)throw Error(s(452));return i;case"head":if(i=r.head,!i)throw Error(s(453));return i;case"body":if(i=r.body,!i)throw Error(s(454));return i;default:throw Error(s(451))}}function kc(i){for(var r=i.attributes;r.length;)i.removeAttributeNode(r[0]);Co(i)}var Qi=new Map,z0=new Set;function Xh(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var cs=$.d;$.d={f:iR,r:rR,D:sR,C:aR,L:oR,m:lR,X:uR,S:cR,M:hR};function iR(){var i=cs.f(),r=Fh();return i||r}function rR(i){var r=Pi(i);r!==null&&r.tag===5&&r.type==="form"?ib(r):cs.r(i)}var ol=typeof document>"u"?null:document;function B0(i,r,o){var c=ol;if(c&&typeof r=="string"&&r){var m=hi(r);m='link[rel="'+i+'"][href="'+m+'"]',typeof o=="string"&&(m+='[crossorigin="'+o+'"]'),z0.has(m)||(z0.add(m),i={rel:i,crossOrigin:o,href:r},c.querySelector(m)===null&&(r=c.createElement("link"),Wn(r,"link",i),Tn(r),c.head.appendChild(r)))}}function sR(i){cs.D(i),B0("dns-prefetch",i,null)}function aR(i,r){cs.C(i,r),B0("preconnect",i,r)}function oR(i,r,o){cs.L(i,r,o);var c=ol;if(c&&i&&r){var m='link[rel="preload"][as="'+hi(r)+'"]';r==="image"&&o&&o.imageSrcSet?(m+='[imagesrcset="'+hi(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(m+='[imagesizes="'+hi(o.imageSizes)+'"]')):m+='[href="'+hi(i)+'"]';var y=m;switch(r){case"style":y=ll(i);break;case"script":y=cl(i)}Qi.has(y)||(i=_({rel:"preload",href:r==="image"&&o&&o.imageSrcSet?void 0:i,as:r},o),Qi.set(y,i),c.querySelector(m)!==null||r==="style"&&c.querySelector(Pc(y))||r==="script"&&c.querySelector(Vc(y))||(r=c.createElement("link"),Wn(r,"link",i),Tn(r),c.head.appendChild(r)))}}function lR(i,r){cs.m(i,r);var o=ol;if(o&&i){var c=r&&typeof r.as=="string"?r.as:"script",m='link[rel="modulepreload"][as="'+hi(c)+'"][href="'+hi(i)+'"]',y=m;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=cl(i)}if(!Qi.has(y)&&(i=_({rel:"modulepreload",href:i},r),Qi.set(y,i),o.querySelector(m)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Vc(y)))return}c=o.createElement("link"),Wn(c,"link",i),Tn(c),o.head.appendChild(c)}}}function cR(i,r,o){cs.S(i,r,o);var c=ol;if(c&&i){var m=yr(c).hoistableStyles,y=ll(i);r=r||"default";var w=m.get(y);if(!w){var R={loading:0,preload:null};if(w=c.querySelector(Pc(y)))R.loading=5;else{i=_({rel:"stylesheet",href:i,"data-precedence":r},o),(o=Qi.get(y))&&Og(i,o);var H=w=c.createElement("link");Tn(H),Wn(H,"link",i),H._p=new Promise(function(re,me){H.onload=re,H.onerror=me}),H.addEventListener("load",function(){R.loading|=1}),H.addEventListener("error",function(){R.loading|=2}),R.loading|=4,Zh(w,r,c)}w={type:"stylesheet",instance:w,count:1,state:R},m.set(y,w)}}}function uR(i,r){cs.X(i,r);var o=ol;if(o&&i){var c=yr(o).hoistableScripts,m=cl(i),y=c.get(m);y||(y=o.querySelector(Vc(m)),y||(i=_({src:i,async:!0},r),(r=Qi.get(m))&&jg(i,r),y=o.createElement("script"),Tn(y),Wn(y,"link",i),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},c.set(m,y))}}function hR(i,r){cs.M(i,r);var o=ol;if(o&&i){var c=yr(o).hoistableScripts,m=cl(i),y=c.get(m);y||(y=o.querySelector(Vc(m)),y||(i=_({src:i,async:!0,type:"module"},r),(r=Qi.get(m))&&jg(i,r),y=o.createElement("script"),Tn(y),Wn(y,"link",i),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},c.set(m,y))}}function F0(i,r,o,c){var m=(m=Ee.current)?Xh(m):null;if(!m)throw Error(s(446));switch(i){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(r=ll(o.href),o=yr(m).hoistableStyles,c=o.get(r),c||(c={type:"style",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){i=ll(o.href);var y=yr(m).hoistableStyles,w=y.get(i);if(w||(m=m.ownerDocument||m,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(i,w),(y=m.querySelector(Pc(i)))&&!y._p&&(w.instance=y,w.state.loading=5),Qi.has(i)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},Qi.set(i,o),y||dR(m,i,o,w.state))),r&&c===null)throw Error(s(528,""));return w}if(r&&c!==null)throw Error(s(529,""));return null;case"script":return r=o.async,o=o.src,typeof o=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=cl(o),o=yr(m).hoistableScripts,c=o.get(r),c||(c={type:"script",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,i))}}function ll(i){return'href="'+hi(i)+'"'}function Pc(i){return'link[rel="stylesheet"]['+i+"]"}function H0(i){return _({},i,{"data-precedence":i.precedence,precedence:null})}function dR(i,r,o,c){i.querySelector('link[rel="preload"][as="style"]['+r+"]")?c.loading=1:(r=i.createElement("link"),c.preload=r,r.addEventListener("load",function(){return c.loading|=1}),r.addEventListener("error",function(){return c.loading|=2}),Wn(r,"link",o),Tn(r),i.head.appendChild(r))}function cl(i){return'[src="'+hi(i)+'"]'}function Vc(i){return"script[async]"+i}function q0(i,r,o){if(r.count++,r.instance===null)switch(r.type){case"style":var c=i.querySelector('style[data-href~="'+hi(o.href)+'"]');if(c)return r.instance=c,Tn(c),c;var m=_({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(i.ownerDocument||i).createElement("style"),Tn(c),Wn(c,"style",m),Zh(c,o.precedence,i),r.instance=c;case"stylesheet":m=ll(o.href);var y=i.querySelector(Pc(m));if(y)return r.state.loading|=4,r.instance=y,Tn(y),y;c=H0(o),(m=Qi.get(m))&&Og(c,m),y=(i.ownerDocument||i).createElement("link"),Tn(y);var w=y;return w._p=new Promise(function(R,H){w.onload=R,w.onerror=H}),Wn(y,"link",c),r.state.loading|=4,Zh(y,o.precedence,i),r.instance=y;case"script":return y=cl(o.src),(m=i.querySelector(Vc(y)))?(r.instance=m,Tn(m),m):(c=o,(m=Qi.get(y))&&(c=_({},o),jg(c,m)),i=i.ownerDocument||i,m=i.createElement("script"),Tn(m),Wn(m,"link",c),i.head.appendChild(m),r.instance=m);case"void":return null;default:throw Error(s(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(c=r.instance,r.state.loading|=4,Zh(c,o.precedence,i));return r.instance}function Zh(i,r,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=c.length?c[c.length-1]:null,y=m,w=0;w<c.length;w++){var R=c[w];if(R.dataset.precedence===r)y=R;else if(y!==m)break}y?y.parentNode.insertBefore(i,y.nextSibling):(r=o.nodeType===9?o.head:o,r.insertBefore(i,r.firstChild))}function Og(i,r){i.crossOrigin==null&&(i.crossOrigin=r.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=r.referrerPolicy),i.title==null&&(i.title=r.title)}function jg(i,r){i.crossOrigin==null&&(i.crossOrigin=r.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=r.referrerPolicy),i.integrity==null&&(i.integrity=r.integrity)}var Jh=null;function G0(i,r,o){if(Jh===null){var c=new Map,m=Jh=new Map;m.set(o,c)}else m=Jh,c=m.get(o),c||(c=new Map,m.set(o,c));if(c.has(i))return c;for(c.set(i,null),o=o.getElementsByTagName(i),m=0;m<o.length;m++){var y=o[m];if(!(y[gr]||y[En]||i==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var w=y.getAttribute(r)||"";w=i+w;var R=c.get(w);R?R.push(y):c.set(w,[y])}}return c}function $0(i,r,o){i=i.ownerDocument||i,i.head.insertBefore(o,r==="title"?i.querySelector("head > title"):null)}function fR(i,r,o){if(o===1||r.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;switch(r.rel){case"stylesheet":return i=r.disabled,typeof r.precedence=="string"&&i==null;default:return!0}case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function Q0(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function mR(i,r,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var m=ll(c.href),y=r.querySelector(Pc(m));if(y){r=y._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(i.count++,i=ed.bind(i),r.then(i,i)),o.state.loading|=4,o.instance=y,Tn(y);return}y=r.ownerDocument||r,c=H0(c),(m=Qi.get(m))&&Og(c,m),y=y.createElement("link"),Tn(y);var w=y;w._p=new Promise(function(R,H){w.onload=R,w.onerror=H}),Wn(y,"link",c),o.instance=y}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(o,r),(r=o.state.preload)&&(o.state.loading&3)===0&&(i.count++,o=ed.bind(i),r.addEventListener("load",o),r.addEventListener("error",o))}}var kg=0;function gR(i,r){return i.stylesheets&&i.count===0&&nd(i,i.stylesheets),0<i.count||0<i.imgCount?function(o){var c=setTimeout(function(){if(i.stylesheets&&nd(i,i.stylesheets),i.unsuspend){var y=i.unsuspend;i.unsuspend=null,y()}},6e4+r);0<i.imgBytes&&kg===0&&(kg=62500*Kx());var m=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&nd(i,i.stylesheets),i.unsuspend)){var y=i.unsuspend;i.unsuspend=null,y()}},(i.imgBytes>kg?50:800)+r);return i.unsuspend=o,function(){i.unsuspend=null,clearTimeout(c),clearTimeout(m)}}:null}function ed(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)nd(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var td=null;function nd(i,r){i.stylesheets=null,i.unsuspend!==null&&(i.count++,td=new Map,r.forEach(pR,i),td=null,ed.call(i))}function pR(i,r){if(!(r.state.loading&4)){var o=td.get(i);if(o)var c=o.get(null);else{o=new Map,td.set(i,o);for(var m=i.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<m.length;y++){var w=m[y];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(o.set(w.dataset.precedence,w),c=w)}c&&o.set(null,c)}m=r.instance,w=m.getAttribute("data-precedence"),y=o.get(w)||c,y===c&&o.set(null,m),o.set(w,m),this.count++,c=ed.bind(this),m.addEventListener("load",c),m.addEventListener("error",c),y?y.parentNode.insertBefore(m,y.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(m,i.firstChild)),r.state.loading|=4}}var Lc={$$typeof:q,Provider:null,Consumer:null,_currentValue:Q,_currentValue2:Q,_threadCount:0};function yR(i,r,o,c,m,y,w,R,H){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=He(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=He(0),this.hiddenUpdates=He(null),this.identifierPrefix=c,this.onUncaughtError=m,this.onCaughtError=y,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=H,this.incompleteTransitions=new Map}function Y0(i,r,o,c,m,y,w,R,H,re,me,ye){return i=new yR(i,r,o,w,H,re,me,ye,R),r=1,y===!0&&(r|=24),y=Ci(3,null,null,r),i.current=y,y.stateNode=i,r=mm(),r.refCount++,i.pooledCache=r,r.refCount++,y.memoizedState={element:c,isDehydrated:o,cache:r},vm(y),i}function K0(i){return i?(i=zo,i):zo}function W0(i,r,o,c,m,y){m=K0(m),c.context===null?c.context=m:c.pendingContext=m,c=Ls(r),c.payload={element:o},y=y===void 0?null:y,y!==null&&(c.callback=y),o=Us(i,c,r),o!==null&&(yi(o,i,r),pc(o,i,r))}function X0(i,r){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var o=i.retryLane;i.retryLane=o!==0&&o<r?o:r}}function Pg(i,r){X0(i,r),(i=i.alternate)&&X0(i,r)}function Z0(i){if(i.tag===13||i.tag===31){var r=Fa(i,67108864);r!==null&&yi(r,i,67108864),Pg(i,67108864)}}function J0(i){if(i.tag===13||i.tag===31){var r=Di();r=Zi(r);var o=Fa(i,r);o!==null&&yi(o,i,r),Pg(i,r)}}var id=!0;function vR(i,r,o,c){var m=D.T;D.T=null;var y=$.p;try{$.p=2,Vg(i,r,o,c)}finally{$.p=y,D.T=m}}function _R(i,r,o,c){var m=D.T;D.T=null;var y=$.p;try{$.p=8,Vg(i,r,o,c)}finally{$.p=y,D.T=m}}function Vg(i,r,o,c){if(id){var m=Lg(c);if(m===null)Eg(i,r,c,rd,o),tS(i,c);else if(SR(m,i,r,o,c))c.stopPropagation();else if(tS(i,c),r&4&&-1<bR.indexOf(i)){for(;m!==null;){var y=Pi(m);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var w=ve(y.pendingLanes);if(w!==0){var R=y;for(R.pendingLanes|=2,R.entangledLanes|=2;w;){var H=1<<31-lt(w);R.entanglements[1]|=H,w&=~H}Nr(y),(Mt&6)===0&&(zh=xt()+500,Mc(0))}}break;case 31:case 13:R=Fa(y,2),R!==null&&yi(R,y,2),Fh(),Pg(y,2)}if(y=Lg(c),y===null&&Eg(i,r,c,rd,o),y===m)break;m=y}m!==null&&c.stopPropagation()}else Eg(i,r,c,null,o)}}function Lg(i){return i=Vi(i),Ug(i)}var rd=null;function Ug(i){if(rd=null,i=pr(i),i!==null){var r=l(i);if(r===null)i=null;else{var o=r.tag;if(o===13){if(i=u(r),i!==null)return i;i=null}else if(o===31){if(i=g(r),i!==null)return i;i=null}else if(o===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;i=null}else r!==i&&(i=null)}}return rd=i,null}function eS(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Tt()){case wt:return 2;case Bt:return 8;case Wt:case un:return 32;case ci:return 268435456;default:return 32}default:return 32}}var zg=!1,Ws=null,Xs=null,Zs=null,Uc=new Map,zc=new Map,Js=[],bR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function tS(i,r){switch(i){case"focusin":case"focusout":Ws=null;break;case"dragenter":case"dragleave":Xs=null;break;case"mouseover":case"mouseout":Zs=null;break;case"pointerover":case"pointerout":Uc.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":zc.delete(r.pointerId)}}function Bc(i,r,o,c,m,y){return i===null||i.nativeEvent!==y?(i={blockedOn:r,domEventName:o,eventSystemFlags:c,nativeEvent:y,targetContainers:[m]},r!==null&&(r=Pi(r),r!==null&&Z0(r)),i):(i.eventSystemFlags|=c,r=i.targetContainers,m!==null&&r.indexOf(m)===-1&&r.push(m),i)}function SR(i,r,o,c,m){switch(r){case"focusin":return Ws=Bc(Ws,i,r,o,c,m),!0;case"dragenter":return Xs=Bc(Xs,i,r,o,c,m),!0;case"mouseover":return Zs=Bc(Zs,i,r,o,c,m),!0;case"pointerover":var y=m.pointerId;return Uc.set(y,Bc(Uc.get(y)||null,i,r,o,c,m)),!0;case"gotpointercapture":return y=m.pointerId,zc.set(y,Bc(zc.get(y)||null,i,r,o,c,m)),!0}return!1}function nS(i){var r=pr(i.target);if(r!==null){var o=l(r);if(o!==null){if(r=o.tag,r===13){if(r=u(o),r!==null){i.blockedOn=r,wi(i.priority,function(){J0(o)});return}}else if(r===31){if(r=g(o),r!==null){i.blockedOn=r,wi(i.priority,function(){J0(o)});return}}else if(r===3&&o.stateNode.current.memoizedState.isDehydrated){i.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}i.blockedOn=null}function sd(i){if(i.blockedOn!==null)return!1;for(var r=i.targetContainers;0<r.length;){var o=Lg(i.nativeEvent);if(o===null){o=i.nativeEvent;var c=new o.constructor(o.type,o);ec=c,o.target.dispatchEvent(c),ec=null}else return r=Pi(o),r!==null&&Z0(r),i.blockedOn=o,!1;r.shift()}return!0}function iS(i,r,o){sd(i)&&o.delete(r)}function wR(){zg=!1,Ws!==null&&sd(Ws)&&(Ws=null),Xs!==null&&sd(Xs)&&(Xs=null),Zs!==null&&sd(Zs)&&(Zs=null),Uc.forEach(iS),zc.forEach(iS)}function ad(i,r){i.blockedOn===r&&(i.blockedOn=null,zg||(zg=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,wR)))}var od=null;function rS(i){od!==i&&(od=i,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){od===i&&(od=null);for(var r=0;r<i.length;r+=3){var o=i[r],c=i[r+1],m=i[r+2];if(typeof c!="function"){if(Ug(c||o)===null)continue;break}var y=Pi(o);y!==null&&(i.splice(r,3),r-=3,Lm(y,{pending:!0,data:m,method:o.method,action:c},c,m))}}))}function ul(i){function r(H){return ad(H,i)}Ws!==null&&ad(Ws,i),Xs!==null&&ad(Xs,i),Zs!==null&&ad(Zs,i),Uc.forEach(r),zc.forEach(r);for(var o=0;o<Js.length;o++){var c=Js[o];c.blockedOn===i&&(c.blockedOn=null)}for(;0<Js.length&&(o=Js[0],o.blockedOn===null);)nS(o),o.blockedOn===null&&Js.shift();if(o=(i.ownerDocument||i).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var m=o[c],y=o[c+1],w=m[zn]||null;if(typeof y=="function")w||rS(o);else if(w){var R=null;if(y&&y.hasAttribute("formAction")){if(m=y,w=y[zn]||null)R=w.formAction;else if(Ug(m)!==null)continue}else R=w.action;typeof R=="function"?o[c+1]=R:(o.splice(c,3),c-=3),rS(o)}}}function sS(){function i(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(w){return m=w})},focusReset:"manual",scroll:"manual"})}function r(){m!==null&&(m(),m=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,m=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),m!==null&&(m(),m=null)}}}function Bg(i){this._internalRoot=i}ld.prototype.render=Bg.prototype.render=function(i){var r=this._internalRoot;if(r===null)throw Error(s(409));var o=r.current,c=Di();W0(o,c,i,r,null,null)},ld.prototype.unmount=Bg.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var r=i.containerInfo;W0(i.current,2,null,i,null,null),Fh(),r[mr]=null}};function ld(i){this._internalRoot=i}ld.prototype.unstable_scheduleHydration=function(i){if(i){var r=fr();i={blockedOn:null,target:i,priority:r};for(var o=0;o<Js.length&&r!==0&&r<Js[o].priority;o++);Js.splice(o,0,i),o===0&&nS(i)}};var aS=e.version;if(aS!=="19.2.0")throw Error(s(527,aS,"19.2.0"));$.findDOMNode=function(i){var r=i._reactInternals;if(r===void 0)throw typeof i.render=="function"?Error(s(188)):(i=Object.keys(i).join(","),Error(s(268,i)));return i=p(r),i=i!==null?v(i):null,i=i===null?null:i.stateNode,i};var ER={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:D,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var cd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!cd.isDisabled&&cd.supportsFiber)try{at=cd.inject(ER),Xe=cd}catch{}}return Hc.createRoot=function(i,r){if(!a(i))throw Error(s(299));var o=!1,c="",m=fb,y=mb,w=gb;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onUncaughtError!==void 0&&(m=r.onUncaughtError),r.onCaughtError!==void 0&&(y=r.onCaughtError),r.onRecoverableError!==void 0&&(w=r.onRecoverableError)),r=Y0(i,1,!1,null,null,o,c,null,m,y,w,sS),i[mr]=r.current,wg(i),new Bg(r)},Hc.hydrateRoot=function(i,r,o){if(!a(i))throw Error(s(299));var c=!1,m="",y=fb,w=mb,R=gb,H=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(m=o.identifierPrefix),o.onUncaughtError!==void 0&&(y=o.onUncaughtError),o.onCaughtError!==void 0&&(w=o.onCaughtError),o.onRecoverableError!==void 0&&(R=o.onRecoverableError),o.formState!==void 0&&(H=o.formState)),r=Y0(i,1,!0,r,o??null,c,m,H,y,w,R,sS),r.context=K0(null),o=r.current,c=Di(),c=Zi(c),m=Ls(c),m.callback=null,Us(o,m,c),o=c,r.current.lanes=o,mt(r,o),Nr(r),i[mr]=r.current,wg(i),new ld(r)},Hc.version="19.2.0",Hc}var pS;function MR(){if(pS)return qg.exports;pS=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),qg.exports=DR(),qg.exports}var OR=MR();const jR=BE(OR);var yS="popstate";function kR(n={}){function e(a,l){let{pathname:u="/",search:g="",hash:d=""}=bo(a.location.hash.substring(1));return!u.startsWith("/")&&!u.startsWith(".")&&(u="/"+u),Rp("",{pathname:u,search:g,hash:d},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function t(a,l){let u=a.document.querySelector("base"),g="";if(u&&u.getAttribute("href")){let d=a.location.href,p=d.indexOf("#");g=p===-1?d:d.slice(0,p)}return g+"#"+(typeof l=="string"?l:hu(l))}function s(a,l){ki(a.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(l)})`)}return VR(e,t,s,n)}function an(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function ki(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function PR(){return Math.random().toString(36).substring(2,10)}function vS(n,e){return{usr:n.state,key:n.key,idx:e}}function Rp(n,e,t=null,s){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?bo(e):e,state:t,key:e&&e.key||s||PR()}}function hu({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function bo(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let s=n.indexOf("?");s>=0&&(e.search=n.substring(s),n=n.substring(0,s)),n&&(e.pathname=n)}return e}function VR(n,e,t,s={}){let{window:a=document.defaultView,v5Compat:l=!1}=s,u=a.history,g="POP",d=null,p=v();p==null&&(p=0,u.replaceState({...u.state,idx:p},""));function v(){return(u.state||{idx:null}).idx}function _(){g="POP";let U=v(),z=U==null?null:U-p;p=U,d&&d({action:g,location:L.location,delta:z})}function S(U,z){g="PUSH";let X=Rp(L.location,U,z);t&&t(X,U),p=v()+1;let q=vS(X,p),ne=L.createHref(X);try{u.pushState(q,"",ne)}catch(ee){if(ee instanceof DOMException&&ee.name==="DataCloneError")throw ee;a.location.assign(ne)}l&&d&&d({action:g,location:L.location,delta:1})}function C(U,z){g="REPLACE";let X=Rp(L.location,U,z);t&&t(X,U),p=v();let q=vS(X,p),ne=L.createHref(X);u.replaceState(q,"",ne),l&&d&&d({action:g,location:L.location,delta:0})}function O(U){return LR(U)}let L={get action(){return g},get location(){return n(a,u)},listen(U){if(d)throw new Error("A history only accepts one active listener");return a.addEventListener(yS,_),d=U,()=>{a.removeEventListener(yS,_),d=null}},createHref(U){return e(a,U)},createURL:O,encodeLocation(U){let z=O(U);return{pathname:z.pathname,search:z.search,hash:z.hash}},push:S,replace:C,go(U){return u.go(U)}};return L}function LR(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),an(t,"No window.location.(origin|href) available to create URL");let s=typeof n=="string"?n:hu(n);return s=s.replace(/ $/,"%20"),!e&&s.startsWith("//")&&(s=t+s),new URL(s,t)}function HE(n,e,t="/"){return UR(n,e,t,!1)}function UR(n,e,t,s){let a=typeof e=="string"?bo(e):e,l=vs(a.pathname||"/",t);if(l==null)return null;let u=qE(n);zR(u);let g=null;for(let d=0;g==null&&d<u.length;++d){let p=XR(l);g=KR(u[d],p,s)}return g}function qE(n,e=[],t=[],s="",a=!1){let l=(u,g,d=a,p)=>{let v={relativePath:p===void 0?u.path||"":p,caseSensitive:u.caseSensitive===!0,childrenIndex:g,route:u};if(v.relativePath.startsWith("/")){if(!v.relativePath.startsWith(s)&&d)return;an(v.relativePath.startsWith(s),`Absolute route path "${v.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),v.relativePath=v.relativePath.slice(s.length)}let _=ps([s,v.relativePath]),S=t.concat(v);u.children&&u.children.length>0&&(an(u.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${_}".`),qE(u.children,e,S,_,d)),!(u.path==null&&!u.index)&&e.push({path:_,score:QR(_,u.index),routesMeta:S})};return n.forEach((u,g)=>{if(u.path===""||!u.path?.includes("?"))l(u,g);else for(let d of GE(u.path))l(u,g,!0,d)}),e}function GE(n){let e=n.split("/");if(e.length===0)return[];let[t,...s]=e,a=t.endsWith("?"),l=t.replace(/\?$/,"");if(s.length===0)return a?[l,""]:[l];let u=GE(s.join("/")),g=[];return g.push(...u.map(d=>d===""?l:[l,d].join("/"))),a&&g.push(...u),g.map(d=>n.startsWith("/")&&d===""?"/":d)}function zR(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:YR(e.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}var BR=/^:[\w-]+$/,FR=3,HR=2,qR=1,GR=10,$R=-2,_S=n=>n==="*";function QR(n,e){let t=n.split("/"),s=t.length;return t.some(_S)&&(s+=$R),e&&(s+=HR),t.filter(a=>!_S(a)).reduce((a,l)=>a+(BR.test(l)?FR:l===""?qR:GR),s)}function YR(n,e){return n.length===e.length&&n.slice(0,-1).every((s,a)=>s===e[a])?n[n.length-1]-e[e.length-1]:0}function KR(n,e,t=!1){let{routesMeta:s}=n,a={},l="/",u=[];for(let g=0;g<s.length;++g){let d=s[g],p=g===s.length-1,v=l==="/"?e:e.slice(l.length)||"/",_=Fd({path:d.relativePath,caseSensitive:d.caseSensitive,end:p},v),S=d.route;if(!_&&p&&t&&!s[s.length-1].route.index&&(_=Fd({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},v)),!_)return null;Object.assign(a,_.params),u.push({params:a,pathname:ps([l,_.pathname]),pathnameBase:nI(ps([l,_.pathnameBase])),route:S}),_.pathnameBase!=="/"&&(l=ps([l,_.pathnameBase]))}return u}function Fd(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,s]=WR(n.path,n.caseSensitive,n.end),a=e.match(t);if(!a)return null;let l=a[0],u=l.replace(/(.)\/+$/,"$1"),g=a.slice(1);return{params:s.reduce((p,{paramName:v,isOptional:_},S)=>{if(v==="*"){let O=g[S]||"";u=l.slice(0,l.length-O.length).replace(/(.)\/+$/,"$1")}const C=g[S];return _&&!C?p[v]=void 0:p[v]=(C||"").replace(/%2F/g,"/"),p},{}),pathname:l,pathnameBase:u,pattern:n}}function WR(n,e=!1,t=!0){ki(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let s=[],a="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(u,g,d)=>(s.push({paramName:g,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(s.push({paramName:"*"}),a+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":n!==""&&n!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),s]}function XR(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ki(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function vs(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,s=n.charAt(t);return s&&s!=="/"?null:n.slice(t)||"/"}var ZR=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,JR=n=>ZR.test(n);function eI(n,e="/"){let{pathname:t,search:s="",hash:a=""}=typeof n=="string"?bo(n):n,l;if(t)if(JR(t))l=t;else{if(t.includes("//")){let u=t;t=t.replace(/\/\/+/g,"/"),ki(!1,`Pathnames cannot have embedded double slashes - normalizing ${u} -> ${t}`)}t.startsWith("/")?l=bS(t.substring(1),"/"):l=bS(t,e)}else l=e;return{pathname:l,search:iI(s),hash:rI(a)}}function bS(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function Yg(n,e,t,s){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function tI(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Sy(n){let e=tI(n);return e.map((t,s)=>s===e.length-1?t.pathname:t.pathnameBase)}function wy(n,e,t,s=!1){let a;typeof n=="string"?a=bo(n):(a={...n},an(!a.pathname||!a.pathname.includes("?"),Yg("?","pathname","search",a)),an(!a.pathname||!a.pathname.includes("#"),Yg("#","pathname","hash",a)),an(!a.search||!a.search.includes("#"),Yg("#","search","hash",a)));let l=n===""||a.pathname==="",u=l?"/":a.pathname,g;if(u==null)g=t;else{let _=e.length-1;if(!s&&u.startsWith("..")){let S=u.split("/");for(;S[0]==="..";)S.shift(),_-=1;a.pathname=S.join("/")}g=_>=0?e[_]:"/"}let d=eI(a,g),p=u&&u!=="/"&&u.endsWith("/"),v=(l||u===".")&&t.endsWith("/");return!d.pathname.endsWith("/")&&(p||v)&&(d.pathname+="/"),d}var ps=n=>n.join("/").replace(/\/\/+/g,"/"),nI=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),iI=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,rI=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function sI(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var $E=["POST","PUT","PATCH","DELETE"];new Set($E);var aI=["GET",...$E];new Set(aI);var Pl=T.createContext(null);Pl.displayName="DataRouter";var mf=T.createContext(null);mf.displayName="DataRouterState";T.createContext(!1);var QE=T.createContext({isTransitioning:!1});QE.displayName="ViewTransition";var oI=T.createContext(new Map);oI.displayName="Fetchers";var lI=T.createContext(null);lI.displayName="Await";var hr=T.createContext(null);hr.displayName="Navigation";var Cu=T.createContext(null);Cu.displayName="Location";var dr=T.createContext({outlet:null,matches:[],isDataRoute:!1});dr.displayName="Route";var Ey=T.createContext(null);Ey.displayName="RouteError";function cI(n,{relative:e}={}){an(Vl(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:s}=T.useContext(hr),{hash:a,pathname:l,search:u}=xu(n,{relative:e}),g=l;return t!=="/"&&(g=l==="/"?t:ps([t,l])),s.createHref({pathname:g,search:u,hash:a})}function Vl(){return T.useContext(Cu)!=null}function Es(){return an(Vl(),"useLocation() may be used only in the context of a <Router> component."),T.useContext(Cu).location}var YE="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function KE(n){T.useContext(hr).static||T.useLayoutEffect(n)}function Ll(){let{isDataRoute:n}=T.useContext(dr);return n?EI():uI()}function uI(){an(Vl(),"useNavigate() may be used only in the context of a <Router> component.");let n=T.useContext(Pl),{basename:e,navigator:t}=T.useContext(hr),{matches:s}=T.useContext(dr),{pathname:a}=Es(),l=JSON.stringify(Sy(s)),u=T.useRef(!1);return KE(()=>{u.current=!0}),T.useCallback((d,p={})=>{if(ki(u.current,YE),!u.current)return;if(typeof d=="number"){t.go(d);return}let v=wy(d,JSON.parse(l),a,p.relative==="path");n==null&&e!=="/"&&(v.pathname=v.pathname==="/"?e:ps([e,v.pathname])),(p.replace?t.replace:t.push)(v,p.state,p)},[e,t,l,a,n])}T.createContext(null);function hI(){let{matches:n}=T.useContext(dr),e=n[n.length-1];return e?e.params:{}}function xu(n,{relative:e}={}){let{matches:t}=T.useContext(dr),{pathname:s}=Es(),a=JSON.stringify(Sy(t));return T.useMemo(()=>wy(n,JSON.parse(a),s,e==="path"),[n,a,s,e])}function dI(n,e){return WE(n,e)}function WE(n,e,t,s,a){an(Vl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=T.useContext(hr),{matches:u}=T.useContext(dr),g=u[u.length-1],d=g?g.params:{},p=g?g.pathname:"/",v=g?g.pathnameBase:"/",_=g&&g.route;{let X=_&&_.path||"";XE(p,!_||X.endsWith("*")||X.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${p}" (under <Route path="${X}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${X}"> to <Route path="${X==="/"?"*":`${X}/*`}">.`)}let S=Es(),C;if(e){let X=typeof e=="string"?bo(e):e;an(v==="/"||X.pathname?.startsWith(v),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${v}" but pathname "${X.pathname}" was given in the \`location\` prop.`),C=X}else C=S;let O=C.pathname||"/",L=O;if(v!=="/"){let X=v.replace(/^\//,"").split("/");L="/"+O.replace(/^\//,"").split("/").slice(X.length).join("/")}let U=HE(n,{pathname:L});ki(_||U!=null,`No routes matched location "${C.pathname}${C.search}${C.hash}" `),ki(U==null||U[U.length-1].route.element!==void 0||U[U.length-1].route.Component!==void 0||U[U.length-1].route.lazy!==void 0,`Matched leaf route at location "${C.pathname}${C.search}${C.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let z=yI(U&&U.map(X=>Object.assign({},X,{params:Object.assign({},d,X.params),pathname:ps([v,l.encodeLocation?l.encodeLocation(X.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:X.pathname]),pathnameBase:X.pathnameBase==="/"?v:ps([v,l.encodeLocation?l.encodeLocation(X.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:X.pathnameBase])})),u,t,s,a);return e&&z?T.createElement(Cu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...C},navigationType:"POP"}},z):z}function fI(){let n=wI(),e=sI(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,s="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:s},l={padding:"2px 4px",backgroundColor:s},u=null;return console.error("Error handled by React Router default ErrorBoundary:",n),u=T.createElement(T.Fragment,null,T.createElement("p",null," Hey developer "),T.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",T.createElement("code",{style:l},"ErrorBoundary")," or"," ",T.createElement("code",{style:l},"errorElement")," prop on your route.")),T.createElement(T.Fragment,null,T.createElement("h2",null,"Unexpected Application Error!"),T.createElement("h3",{style:{fontStyle:"italic"}},e),t?T.createElement("pre",{style:a},t):null,u)}var mI=T.createElement(fI,null),gI=class extends T.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){return this.state.error!==void 0?T.createElement(dr.Provider,{value:this.props.routeContext},T.createElement(Ey.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function pI({routeContext:n,match:e,children:t}){let s=T.useContext(Pl);return s&&s.static&&s.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=e.route.id),T.createElement(dr.Provider,{value:n},t)}function yI(n,e=[],t=null,s=null,a=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let l=n,u=t?.errors;if(u!=null){let v=l.findIndex(_=>_.route.id&&u?.[_.route.id]!==void 0);an(v>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(u).join(",")}`),l=l.slice(0,Math.min(l.length,v+1))}let g=!1,d=-1;if(t)for(let v=0;v<l.length;v++){let _=l[v];if((_.route.HydrateFallback||_.route.hydrateFallbackElement)&&(d=v),_.route.id){let{loaderData:S,errors:C}=t,O=_.route.loader&&!S.hasOwnProperty(_.route.id)&&(!C||C[_.route.id]===void 0);if(_.route.lazy||O){g=!0,d>=0?l=l.slice(0,d+1):l=[l[0]];break}}}let p=t&&s?(v,_)=>{s(v,{location:t.location,params:t.matches?.[0]?.params??{},errorInfo:_})}:void 0;return l.reduceRight((v,_,S)=>{let C,O=!1,L=null,U=null;t&&(C=u&&_.route.id?u[_.route.id]:void 0,L=_.route.errorElement||mI,g&&(d<0&&S===0?(XE("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),O=!0,U=null):d===S&&(O=!0,U=_.route.hydrateFallbackElement||null)));let z=e.concat(l.slice(0,S+1)),X=()=>{let q;return C?q=L:O?q=U:_.route.Component?q=T.createElement(_.route.Component,null):_.route.element?q=_.route.element:q=v,T.createElement(pI,{match:_,routeContext:{outlet:v,matches:z,isDataRoute:t!=null},children:q})};return t&&(_.route.ErrorBoundary||_.route.errorElement||S===0)?T.createElement(gI,{location:t.location,revalidation:t.revalidation,component:L,error:C,children:X(),routeContext:{outlet:null,matches:z,isDataRoute:!0},onError:p}):X()},null)}function Ty(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function vI(n){let e=T.useContext(Pl);return an(e,Ty(n)),e}function _I(n){let e=T.useContext(mf);return an(e,Ty(n)),e}function bI(n){let e=T.useContext(dr);return an(e,Ty(n)),e}function Ay(n){let e=bI(n),t=e.matches[e.matches.length-1];return an(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function SI(){return Ay("useRouteId")}function wI(){let n=T.useContext(Ey),e=_I("useRouteError"),t=Ay("useRouteError");return n!==void 0?n:e.errors?.[t]}function EI(){let{router:n}=vI("useNavigate"),e=Ay("useNavigate"),t=T.useRef(!1);return KE(()=>{t.current=!0}),T.useCallback(async(a,l={})=>{ki(t.current,YE),t.current&&(typeof a=="number"?n.navigate(a):await n.navigate(a,{fromRouteId:e,...l}))},[n,e])}var SS={};function XE(n,e,t){!e&&!SS[n]&&(SS[n]=!0,ki(!1,t))}T.memo(TI);function TI({routes:n,future:e,state:t,unstable_onError:s}){return WE(n,void 0,t,s,e)}function AI({to:n,replace:e,state:t,relative:s}){an(Vl(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=T.useContext(hr);ki(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=T.useContext(dr),{pathname:u}=Es(),g=Ll(),d=wy(n,Sy(l),u,s==="path"),p=JSON.stringify(d);return T.useEffect(()=>{g(JSON.parse(p),{replace:e,state:t,relative:s})},[g,p,s,e,t]),null}function ra(n){an(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function CI({basename:n="/",children:e=null,location:t,navigationType:s="POP",navigator:a,static:l=!1}){an(!Vl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=n.replace(/^\/*/,"/"),g=T.useMemo(()=>({basename:u,navigator:a,static:l,future:{}}),[u,a,l]);typeof t=="string"&&(t=bo(t));let{pathname:d="/",search:p="",hash:v="",state:_=null,key:S="default"}=t,C=T.useMemo(()=>{let O=vs(d,u);return O==null?null:{location:{pathname:O,search:p,hash:v,state:_,key:S},navigationType:s}},[u,d,p,v,_,S,s]);return ki(C!=null,`<Router basename="${u}"> is not able to match the URL "${d}${p}${v}" because it does not start with the basename, so the <Router> won't render anything.`),C==null?null:T.createElement(hr.Provider,{value:g},T.createElement(Cu.Provider,{children:e,value:C}))}function xI({children:n,location:e}){return dI(Ip(n),e)}function Ip(n,e=[]){let t=[];return T.Children.forEach(n,(s,a)=>{if(!T.isValidElement(s))return;let l=[...e,a];if(s.type===T.Fragment){t.push.apply(t,Ip(s.props.children,l));return}an(s.type===ra,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),an(!s.props.index||!s.props.children,"An index route cannot have child routes.");let u={id:s.props.id||l.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,middleware:s.props.middleware,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(u.children=Ip(s.props.children,l)),t.push(u)}),t}var Id="get",Nd="application/x-www-form-urlencoded";function gf(n){return n!=null&&typeof n.tagName=="string"}function RI(n){return gf(n)&&n.tagName.toLowerCase()==="button"}function II(n){return gf(n)&&n.tagName.toLowerCase()==="form"}function NI(n){return gf(n)&&n.tagName.toLowerCase()==="input"}function DI(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function MI(n,e){return n.button===0&&(!e||e==="_self")&&!DI(n)}var ud=null;function OI(){if(ud===null)try{new FormData(document.createElement("form"),0),ud=!1}catch{ud=!0}return ud}var jI=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Kg(n){return n!=null&&!jI.has(n)?(ki(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Nd}"`),null):n}function kI(n,e){let t,s,a,l,u;if(II(n)){let g=n.getAttribute("action");s=g?vs(g,e):null,t=n.getAttribute("method")||Id,a=Kg(n.getAttribute("enctype"))||Nd,l=new FormData(n)}else if(RI(n)||NI(n)&&(n.type==="submit"||n.type==="image")){let g=n.form;if(g==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=n.getAttribute("formaction")||g.getAttribute("action");if(s=d?vs(d,e):null,t=n.getAttribute("formmethod")||g.getAttribute("method")||Id,a=Kg(n.getAttribute("formenctype"))||Kg(g.getAttribute("enctype"))||Nd,l=new FormData(g,n),!OI()){let{name:p,type:v,value:_}=n;if(v==="image"){let S=p?`${p}.`:"";l.append(`${S}x`,"0"),l.append(`${S}y`,"0")}else p&&l.append(p,_)}}else{if(gf(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Id,s=null,a=Nd,u=n}return l&&a==="text/plain"&&(u=l,l=void 0),{action:s,method:t.toLowerCase(),encType:a,formData:l,body:u}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Cy(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function PI(n,e,t){let s=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return s.pathname==="/"?s.pathname=`_root.${t}`:e&&vs(s.pathname,e)==="/"?s.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${t}`,s}async function VI(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function LI(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function UI(n,e,t){let s=await Promise.all(n.map(async a=>{let l=e.routes[a.route.id];if(l){let u=await VI(l,t);return u.links?u.links():[]}return[]}));return HI(s.flat(1).filter(LI).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function wS(n,e,t,s,a,l){let u=(d,p)=>t[p]?d.route.id!==t[p].route.id:!0,g=(d,p)=>t[p].pathname!==d.pathname||t[p].route.path?.endsWith("*")&&t[p].params["*"]!==d.params["*"];return l==="assets"?e.filter((d,p)=>u(d,p)||g(d,p)):l==="data"?e.filter((d,p)=>{let v=s.routes[d.route.id];if(!v||!v.hasLoader)return!1;if(u(d,p)||g(d,p))return!0;if(d.route.shouldRevalidate){let _=d.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof _=="boolean")return _}return!0}):[]}function zI(n,e,{includeHydrateFallback:t}={}){return BI(n.map(s=>{let a=e.routes[s.route.id];if(!a)return[];let l=[a.module];return a.clientActionModule&&(l=l.concat(a.clientActionModule)),a.clientLoaderModule&&(l=l.concat(a.clientLoaderModule)),t&&a.hydrateFallbackModule&&(l=l.concat(a.hydrateFallbackModule)),a.imports&&(l=l.concat(a.imports)),l}).flat(1))}function BI(n){return[...new Set(n)]}function FI(n){let e={},t=Object.keys(n).sort();for(let s of t)e[s]=n[s];return e}function HI(n,e){let t=new Set;return new Set(e),n.reduce((s,a)=>{let l=JSON.stringify(FI(a));return t.has(l)||(t.add(l),s.push({key:l,link:a})),s},[])}function ZE(){let n=T.useContext(Pl);return Cy(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function qI(){let n=T.useContext(mf);return Cy(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var xy=T.createContext(void 0);xy.displayName="FrameworkContext";function JE(){let n=T.useContext(xy);return Cy(n,"You must render this element inside a <HydratedRouter> element"),n}function GI(n,e){let t=T.useContext(xy),[s,a]=T.useState(!1),[l,u]=T.useState(!1),{onFocus:g,onBlur:d,onMouseEnter:p,onMouseLeave:v,onTouchStart:_}=e,S=T.useRef(null);T.useEffect(()=>{if(n==="render"&&u(!0),n==="viewport"){let L=z=>{z.forEach(X=>{u(X.isIntersecting)})},U=new IntersectionObserver(L,{threshold:.5});return S.current&&U.observe(S.current),()=>{U.disconnect()}}},[n]),T.useEffect(()=>{if(s){let L=setTimeout(()=>{u(!0)},100);return()=>{clearTimeout(L)}}},[s]);let C=()=>{a(!0)},O=()=>{a(!1),u(!1)};return t?n!=="intent"?[l,S,{}]:[l,S,{onFocus:qc(g,C),onBlur:qc(d,O),onMouseEnter:qc(p,C),onMouseLeave:qc(v,O),onTouchStart:qc(_,C)}]:[!1,S,{}]}function qc(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function $I({page:n,...e}){let{router:t}=ZE(),s=T.useMemo(()=>HE(t.routes,n,t.basename),[t.routes,n,t.basename]);return s?T.createElement(YI,{page:n,matches:s,...e}):null}function QI(n){let{manifest:e,routeModules:t}=JE(),[s,a]=T.useState([]);return T.useEffect(()=>{let l=!1;return UI(n,e,t).then(u=>{l||a(u)}),()=>{l=!0}},[n,e,t]),s}function YI({page:n,matches:e,...t}){let s=Es(),{manifest:a,routeModules:l}=JE(),{basename:u}=ZE(),{loaderData:g,matches:d}=qI(),p=T.useMemo(()=>wS(n,e,d,a,s,"data"),[n,e,d,a,s]),v=T.useMemo(()=>wS(n,e,d,a,s,"assets"),[n,e,d,a,s]),_=T.useMemo(()=>{if(n===s.pathname+s.search+s.hash)return[];let O=new Set,L=!1;if(e.forEach(z=>{let X=a.routes[z.route.id];!X||!X.hasLoader||(!p.some(q=>q.route.id===z.route.id)&&z.route.id in g&&l[z.route.id]?.shouldRevalidate||X.hasClientLoader?L=!0:O.add(z.route.id))}),O.size===0)return[];let U=PI(n,u,"data");return L&&O.size>0&&U.searchParams.set("_routes",e.filter(z=>O.has(z.route.id)).map(z=>z.route.id).join(",")),[U.pathname+U.search]},[u,g,s,a,p,e,n,l]),S=T.useMemo(()=>zI(v,a),[v,a]),C=QI(v);return T.createElement(T.Fragment,null,_.map(O=>T.createElement("link",{key:O,rel:"prefetch",as:"fetch",href:O,...t})),S.map(O=>T.createElement("link",{key:O,rel:"modulepreload",href:O,...t})),C.map(({key:O,link:L})=>T.createElement("link",{key:O,nonce:t.nonce,...L})))}function KI(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var eT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{eT&&(window.__reactRouterVersion="7.9.6")}catch{}function WI({basename:n,children:e,window:t}){let s=T.useRef();s.current==null&&(s.current=kR({window:t,v5Compat:!0}));let a=s.current,[l,u]=T.useState({action:a.action,location:a.location}),g=T.useCallback(d=>{T.startTransition(()=>u(d))},[u]);return T.useLayoutEffect(()=>a.listen(g),[a,g]),T.createElement(CI,{basename:n,children:e,location:l.location,navigationType:l.action,navigator:a})}var tT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,nT=T.forwardRef(function({onClick:e,discover:t="render",prefetch:s="none",relative:a,reloadDocument:l,replace:u,state:g,target:d,to:p,preventScrollReset:v,viewTransition:_,...S},C){let{basename:O}=T.useContext(hr),L=typeof p=="string"&&tT.test(p),U,z=!1;if(typeof p=="string"&&L&&(U=p,eT))try{let P=new URL(window.location.href),x=p.startsWith("//")?new URL(P.protocol+p):new URL(p),A=vs(x.pathname,O);x.origin===P.origin&&A!=null?p=A+x.search+x.hash:z=!0}catch{ki(!1,`<Link to="${p}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let X=cI(p,{relative:a}),[q,ne,ee]=GI(s,S),de=JI(p,{replace:u,state:g,target:d,preventScrollReset:v,relative:a,viewTransition:_});function k(P){e&&e(P),P.defaultPrevented||de(P)}let M=T.createElement("a",{...S,...ee,href:U||X,onClick:z||l?e:k,ref:KI(C,ne),target:d,"data-discover":!L&&t==="render"?"true":void 0});return q&&!L?T.createElement(T.Fragment,null,M,T.createElement($I,{page:X})):M});nT.displayName="Link";var ml=T.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:s="",end:a=!1,style:l,to:u,viewTransition:g,children:d,...p},v){let _=xu(u,{relative:p.relative}),S=Es(),C=T.useContext(mf),{navigator:O,basename:L}=T.useContext(hr),U=C!=null&&rN(_)&&g===!0,z=O.encodeLocation?O.encodeLocation(_).pathname:_.pathname,X=S.pathname,q=C&&C.navigation&&C.navigation.location?C.navigation.location.pathname:null;t||(X=X.toLowerCase(),q=q?q.toLowerCase():null,z=z.toLowerCase()),q&&L&&(q=vs(q,L)||q);const ne=z!=="/"&&z.endsWith("/")?z.length-1:z.length;let ee=X===z||!a&&X.startsWith(z)&&X.charAt(ne)==="/",de=q!=null&&(q===z||!a&&q.startsWith(z)&&q.charAt(z.length)==="/"),k={isActive:ee,isPending:de,isTransitioning:U},M=ee?e:void 0,P;typeof s=="function"?P=s(k):P=[s,ee?"active":null,de?"pending":null,U?"transitioning":null].filter(Boolean).join(" ");let x=typeof l=="function"?l(k):l;return T.createElement(nT,{...p,"aria-current":M,className:P,ref:v,style:x,to:u,viewTransition:g},typeof d=="function"?d(k):d)});ml.displayName="NavLink";var XI=T.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:s,replace:a,state:l,method:u=Id,action:g,onSubmit:d,relative:p,preventScrollReset:v,viewTransition:_,...S},C)=>{let O=nN(),L=iN(g,{relative:p}),U=u.toLowerCase()==="get"?"get":"post",z=typeof g=="string"&&tT.test(g),X=q=>{if(d&&d(q),q.defaultPrevented)return;q.preventDefault();let ne=q.nativeEvent.submitter,ee=ne?.getAttribute("formmethod")||u;O(ne||q.currentTarget,{fetcherKey:e,method:ee,navigate:t,replace:a,state:l,relative:p,preventScrollReset:v,viewTransition:_})};return T.createElement("form",{ref:C,method:U,action:L,onSubmit:s?d:X,...S,"data-discover":!z&&n==="render"?"true":void 0})});XI.displayName="Form";function ZI(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function iT(n){let e=T.useContext(Pl);return an(e,ZI(n)),e}function JI(n,{target:e,replace:t,state:s,preventScrollReset:a,relative:l,viewTransition:u}={}){let g=Ll(),d=Es(),p=xu(n,{relative:l});return T.useCallback(v=>{if(MI(v,e)){v.preventDefault();let _=t!==void 0?t:hu(d)===hu(p);g(n,{replace:_,state:s,preventScrollReset:a,relative:l,viewTransition:u})}},[d,g,p,t,s,e,n,a,l,u])}var eN=0,tN=()=>`__${String(++eN)}__`;function nN(){let{router:n}=iT("useSubmit"),{basename:e}=T.useContext(hr),t=SI();return T.useCallback(async(s,a={})=>{let{action:l,method:u,encType:g,formData:d,body:p}=kI(s,e);if(a.navigate===!1){let v=a.fetcherKey||tN();await n.fetch(v,t,a.action||l,{preventScrollReset:a.preventScrollReset,formData:d,body:p,formMethod:a.method||u,formEncType:a.encType||g,flushSync:a.flushSync})}else await n.navigate(a.action||l,{preventScrollReset:a.preventScrollReset,formData:d,body:p,formMethod:a.method||u,formEncType:a.encType||g,replace:a.replace,state:a.state,fromRouteId:t,flushSync:a.flushSync,viewTransition:a.viewTransition})},[n,e,t])}function iN(n,{relative:e}={}){let{basename:t}=T.useContext(hr),s=T.useContext(dr);an(s,"useFormAction must be used inside a RouteContext");let[a]=s.matches.slice(-1),l={...xu(n||".",{relative:e})},u=Es();if(n==null){l.search=u.search;let g=new URLSearchParams(l.search),d=g.getAll("index");if(d.some(v=>v==="")){g.delete("index"),d.filter(_=>_).forEach(_=>g.append("index",_));let v=g.toString();l.search=v?`?${v}`:""}}return(!n||n===".")&&a.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(l.pathname=l.pathname==="/"?t:ps([t,l.pathname])),hu(l)}function rN(n,{relative:e}={}){let t=T.useContext(QE);an(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=iT("useViewTransitionState"),a=xu(n,{relative:e});if(!t.isTransitioning)return!1;let l=vs(t.currentLocation.pathname,s)||t.currentLocation.pathname,u=vs(t.nextLocation.pathname,s)||t.nextLocation.pathname;return Fd(a.pathname,u)!=null||Fd(a.pathname,l)!=null}var sN=FE();function aN(n={}){const{nonce:e,onScriptLoadSuccess:t,onScriptLoadError:s}=n,[a,l]=T.useState(!1),u=T.useRef(t);u.current=t;const g=T.useRef(s);return g.current=s,T.useEffect(()=>{const d=document.createElement("script");return d.src="https://accounts.google.com/gsi/client",d.async=!0,d.defer=!0,d.nonce=e,d.onload=()=>{var p;l(!0),(p=u.current)===null||p===void 0||p.call(u)},d.onerror=()=>{var p;l(!1),(p=g.current)===null||p===void 0||p.call(g)},document.body.appendChild(d),()=>{document.body.removeChild(d)}},[e]),a}const oN=T.createContext(null);function lN({clientId:n,nonce:e,onScriptLoadSuccess:t,onScriptLoadError:s,children:a}){const l=aN({nonce:e,onScriptLoadSuccess:t,onScriptLoadError:s}),u=T.useMemo(()=>({clientId:n,scriptLoadedSuccessfully:l}),[n,l]);return Ct.createElement(oN.Provider,{value:u},a)}const cN=()=>{};var ES={};const rT=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let a=n.charCodeAt(s);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(a=65536+((a&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},uN=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const a=n[t++];if(a<128)e[s++]=String.fromCharCode(a);else if(a>191&&a<224){const l=n[t++];e[s++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=n[t++],u=n[t++],g=n[t++],d=((a&7)<<18|(l&63)<<12|(u&63)<<6|g&63)-65536;e[s++]=String.fromCharCode(55296+(d>>10)),e[s++]=String.fromCharCode(56320+(d&1023))}else{const l=n[t++],u=n[t++];e[s++]=String.fromCharCode((a&15)<<12|(l&63)<<6|u&63)}}return e.join("")},sT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let a=0;a<n.length;a+=3){const l=n[a],u=a+1<n.length,g=u?n[a+1]:0,d=a+2<n.length,p=d?n[a+2]:0,v=l>>2,_=(l&3)<<4|g>>4;let S=(g&15)<<2|p>>6,C=p&63;d||(C=64,u||(S=64)),s.push(t[v],t[_],t[S],t[C])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(rT(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):uN(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let a=0;a<n.length;){const l=t[n.charAt(a++)],g=a<n.length?t[n.charAt(a)]:0;++a;const p=a<n.length?t[n.charAt(a)]:64;++a;const _=a<n.length?t[n.charAt(a)]:64;if(++a,l==null||g==null||p==null||_==null)throw new hN;const S=l<<2|g>>4;if(s.push(S),p!==64){const C=g<<4&240|p>>2;if(s.push(C),_!==64){const O=p<<6&192|_;s.push(O)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class hN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const dN=function(n){const e=rT(n);return sT.encodeByteArray(e,!0)},Hd=function(n){return dN(n).replace(/\./g,"")},aT=function(n){try{return sT.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function fN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const mN=()=>fN().__FIREBASE_DEFAULTS__,gN=()=>{if(typeof process>"u"||typeof ES>"u")return;const n=ES.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},pN=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&aT(n[1]);return e&&JSON.parse(e)},pf=()=>{try{return cN()||mN()||gN()||pN()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},oT=n=>pf()?.emulatorHosts?.[n],lT=n=>{const e=oT(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),s]:[e.substring(0,t),s]},cT=()=>pf()?.config,uT=n=>pf()?.[`_${n}`];class yN{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}function xa(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Ry(n){return(await fetch(n,{credentials:"include"})).ok}function hT(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",a=n.iat||0,l=n.sub||n.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u={iss:`https://securetoken.google.com/${s}`,aud:s,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Hd(JSON.stringify(t)),Hd(JSON.stringify(u)),""].join(".")}const nu={};function vN(){const n={prod:[],emulator:[]};for(const e of Object.keys(nu))nu[e]?n.emulator.push(e):n.prod.push(e);return n}function _N(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let TS=!1;function Iy(n,e){if(typeof window>"u"||typeof document>"u"||!xa(window.location.host)||nu[n]===e||nu[n]||TS)return;nu[n]=e;function t(S){return`__firebase__banner__${S}`}const s="__firebase__banner",l=vN().prod.length>0;function u(){const S=document.getElementById(s);S&&S.remove()}function g(S){S.style.display="flex",S.style.background="#7faaf0",S.style.position="fixed",S.style.bottom="5px",S.style.left="5px",S.style.padding=".5em",S.style.borderRadius="5px",S.style.alignItems="center"}function d(S,C){S.setAttribute("width","24"),S.setAttribute("id",C),S.setAttribute("height","24"),S.setAttribute("viewBox","0 0 24 24"),S.setAttribute("fill","none"),S.style.marginLeft="-6px"}function p(){const S=document.createElement("span");return S.style.cursor="pointer",S.style.marginLeft="16px",S.style.fontSize="24px",S.innerHTML=" &times;",S.onclick=()=>{TS=!0,u()},S}function v(S,C){S.setAttribute("id",C),S.innerText="Learn more",S.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",S.setAttribute("target","__blank"),S.style.paddingLeft="5px",S.style.textDecoration="underline"}function _(){const S=_N(s),C=t("text"),O=document.getElementById(C)||document.createElement("span"),L=t("learnmore"),U=document.getElementById(L)||document.createElement("a"),z=t("preprendIcon"),X=document.getElementById(z)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(S.created){const q=S.element;g(q),v(U,L);const ne=p();d(X,z),q.append(X,O,U,ne),document.body.appendChild(q)}l?(O.innerText="Preview backend disconnected.",X.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(X.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,O.innerText="Preview backend running in this workspace."),O.setAttribute("id",C)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",_):_()}function si(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function bN(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(si())}function SN(){const n=pf()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function wN(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function EN(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function TN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function AN(){const n=si();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function CN(){return!SN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function xN(){try{return typeof indexedDB=="object"}catch{return!1}}function RN(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(s);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{e(a.error?.message||"")}}catch(t){e(t)}})}const IN="FirebaseError";class qr extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=IN,Object.setPrototypeOf(this,qr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ru.prototype.create)}}class Ru{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},a=`${this.service}/${e}`,l=this.errors[e],u=l?NN(l,s):"Error",g=`${this.serviceName}: ${u} (${a}).`;return new qr(a,g,s)}}function NN(n,e){return n.replace(DN,(t,s)=>{const a=e[s];return a!=null?String(a):`<${s}?>`})}const DN=/\{\$([^}]+)}/g;function MN(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function uo(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const a of t){if(!s.includes(a))return!1;const l=n[a],u=e[a];if(AS(l)&&AS(u)){if(!uo(l,u))return!1}else if(l!==u)return!1}for(const a of s)if(!t.includes(a))return!1;return!0}function AS(n){return n!==null&&typeof n=="object"}function Iu(n){const e=[];for(const[t,s]of Object.entries(n))Array.isArray(s)?s.forEach(a=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function ON(n,e){const t=new jN(n,e);return t.subscribe.bind(t)}class jN{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,s){let a;if(e===void 0&&t===void 0&&s===void 0)throw new Error("Missing Observer.");kN(e,["next","error","complete"])?a=e:a={next:e,error:t,complete:s},a.next===void 0&&(a.next=Wg),a.error===void 0&&(a.error=Wg),a.complete===void 0&&(a.complete=Wg);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function kN(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Wg(){}function jn(n){return n&&n._delegate?n._delegate:n}class va{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const no="[DEFAULT]";class PN{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new yN;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&s.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),s=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(a){if(s)return null;throw a}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(LN(e))try{this.getOrInitializeService({instanceIdentifier:no})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:a});s.resolve(l)}catch{}}}}clearInstance(e=no){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=no){return this.instances.has(e)}getOptions(e=no){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[l,u]of this.instancesDeferred.entries()){const g=this.normalizeInstanceIdentifier(l);s===g&&u.resolve(a)}return a}onInit(e,t){const s=this.normalizeInstanceIdentifier(t),a=this.onInitCallbacks.get(s)??new Set;a.add(e),this.onInitCallbacks.set(s,a);const l=this.instances.get(s);return l&&e(l,s),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const a of s)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:VN(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=no){return this.component?this.component.multipleInstances?e:no:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function VN(n){return n===no?void 0:n}function LN(n){return n.instantiationMode==="EAGER"}class UN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new PN(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var yt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(yt||(yt={}));const zN={debug:yt.DEBUG,verbose:yt.VERBOSE,info:yt.INFO,warn:yt.WARN,error:yt.ERROR,silent:yt.SILENT},BN=yt.INFO,FN={[yt.DEBUG]:"log",[yt.VERBOSE]:"log",[yt.INFO]:"info",[yt.WARN]:"warn",[yt.ERROR]:"error"},HN=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),a=FN[e];if(a)console[a](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ny{constructor(e){this.name=e,this._logLevel=BN,this._logHandler=HN,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in yt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?zN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,yt.DEBUG,...e),this._logHandler(this,yt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,yt.VERBOSE,...e),this._logHandler(this,yt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,yt.INFO,...e),this._logHandler(this,yt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,yt.WARN,...e),this._logHandler(this,yt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,yt.ERROR,...e),this._logHandler(this,yt.ERROR,...e)}}const qN=(n,e)=>e.some(t=>n instanceof t);let CS,xS;function GN(){return CS||(CS=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function $N(){return xS||(xS=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const dT=new WeakMap,Np=new WeakMap,fT=new WeakMap,Xg=new WeakMap,Dy=new WeakMap;function QN(n){const e=new Promise((t,s)=>{const a=()=>{n.removeEventListener("success",l),n.removeEventListener("error",u)},l=()=>{t(fa(n.result)),a()},u=()=>{s(n.error),a()};n.addEventListener("success",l),n.addEventListener("error",u)});return e.then(t=>{t instanceof IDBCursor&&dT.set(t,n)}).catch(()=>{}),Dy.set(e,n),e}function YN(n){if(Np.has(n))return;const e=new Promise((t,s)=>{const a=()=>{n.removeEventListener("complete",l),n.removeEventListener("error",u),n.removeEventListener("abort",u)},l=()=>{t(),a()},u=()=>{s(n.error||new DOMException("AbortError","AbortError")),a()};n.addEventListener("complete",l),n.addEventListener("error",u),n.addEventListener("abort",u)});Np.set(n,e)}let Dp={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Np.get(n);if(e==="objectStoreNames")return n.objectStoreNames||fT.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return fa(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function KN(n){Dp=n(Dp)}function WN(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(Zg(this),e,...t);return fT.set(s,e.sort?e.sort():[e]),fa(s)}:$N().includes(n)?function(...e){return n.apply(Zg(this),e),fa(dT.get(this))}:function(...e){return fa(n.apply(Zg(this),e))}}function XN(n){return typeof n=="function"?WN(n):(n instanceof IDBTransaction&&YN(n),qN(n,GN())?new Proxy(n,Dp):n)}function fa(n){if(n instanceof IDBRequest)return QN(n);if(Xg.has(n))return Xg.get(n);const e=XN(n);return e!==n&&(Xg.set(n,e),Dy.set(e,n)),e}const Zg=n=>Dy.get(n);function ZN(n,e,{blocked:t,upgrade:s,blocking:a,terminated:l}={}){const u=indexedDB.open(n,e),g=fa(u);return s&&u.addEventListener("upgradeneeded",d=>{s(fa(u.result),d.oldVersion,d.newVersion,fa(u.transaction),d)}),t&&u.addEventListener("blocked",d=>t(d.oldVersion,d.newVersion,d)),g.then(d=>{l&&d.addEventListener("close",()=>l()),a&&d.addEventListener("versionchange",p=>a(p.oldVersion,p.newVersion,p))}).catch(()=>{}),g}const JN=["get","getKey","getAll","getAllKeys","count"],e2=["put","add","delete","clear"],Jg=new Map;function RS(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Jg.get(e))return Jg.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,a=e2.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(a||JN.includes(t)))return;const l=async function(u,...g){const d=this.transaction(u,a?"readwrite":"readonly");let p=d.store;return s&&(p=p.index(g.shift())),(await Promise.all([p[t](...g),a&&d.done]))[0]};return Jg.set(e,l),l}KN(n=>({...n,get:(e,t,s)=>RS(e,t)||n.get(e,t,s),has:(e,t)=>!!RS(e,t)||n.has(e,t)}));class t2{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(n2(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function n2(n){return n.getComponent()?.type==="VERSION"}const Mp="@firebase/app",IS="0.14.6";const _s=new Ny("@firebase/app"),i2="@firebase/app-compat",r2="@firebase/analytics-compat",s2="@firebase/analytics",a2="@firebase/app-check-compat",o2="@firebase/app-check",l2="@firebase/auth",c2="@firebase/auth-compat",u2="@firebase/database",h2="@firebase/data-connect",d2="@firebase/database-compat",f2="@firebase/functions",m2="@firebase/functions-compat",g2="@firebase/installations",p2="@firebase/installations-compat",y2="@firebase/messaging",v2="@firebase/messaging-compat",_2="@firebase/performance",b2="@firebase/performance-compat",S2="@firebase/remote-config",w2="@firebase/remote-config-compat",E2="@firebase/storage",T2="@firebase/storage-compat",A2="@firebase/firestore",C2="@firebase/ai",x2="@firebase/firestore-compat",R2="firebase",I2="12.6.0";const Op="[DEFAULT]",N2={[Mp]:"fire-core",[i2]:"fire-core-compat",[s2]:"fire-analytics",[r2]:"fire-analytics-compat",[o2]:"fire-app-check",[a2]:"fire-app-check-compat",[l2]:"fire-auth",[c2]:"fire-auth-compat",[u2]:"fire-rtdb",[h2]:"fire-data-connect",[d2]:"fire-rtdb-compat",[f2]:"fire-fn",[m2]:"fire-fn-compat",[g2]:"fire-iid",[p2]:"fire-iid-compat",[y2]:"fire-fcm",[v2]:"fire-fcm-compat",[_2]:"fire-perf",[b2]:"fire-perf-compat",[S2]:"fire-rc",[w2]:"fire-rc-compat",[E2]:"fire-gcs",[T2]:"fire-gcs-compat",[A2]:"fire-fst",[x2]:"fire-fst-compat",[C2]:"fire-vertex","fire-js":"fire-js",[R2]:"fire-js-all"};const du=new Map,D2=new Map,jp=new Map;function NS(n,e){try{n.container.addComponent(e)}catch(t){_s.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ho(n){const e=n.name;if(jp.has(e))return _s.debug(`There were multiple attempts to register component ${e}.`),!1;jp.set(e,n);for(const t of du.values())NS(t,n);for(const t of D2.values())NS(t,n);return!0}function yf(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ki(n){return n==null?!1:n.settings!==void 0}const M2={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ma=new Ru("app","Firebase",M2);class O2{constructor(e,t,s){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new va("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ma.create("app-deleted",{appName:this._name})}}const So=I2;function mT(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s={name:Op,automaticDataCollectionEnabled:!0,...e},a=s.name;if(typeof a!="string"||!a)throw ma.create("bad-app-name",{appName:String(a)});if(t||(t=cT()),!t)throw ma.create("no-options");const l=du.get(a);if(l){if(uo(t,l.options)&&uo(s,l.config))return l;throw ma.create("duplicate-app",{appName:a})}const u=new UN(a);for(const d of jp.values())u.addComponent(d);const g=new O2(t,s,u);return du.set(a,g),g}function vf(n=Op){const e=du.get(n);if(!e&&n===Op&&cT())return mT();if(!e)throw ma.create("no-app",{appName:n});return e}function DS(){return Array.from(du.values())}function kr(n,e,t){let s=N2[n]??n;t&&(s+=`-${t}`);const a=s.match(/\s|\//),l=e.match(/\s|\//);if(a||l){const u=[`Unable to register library "${s}" with version "${e}":`];a&&u.push(`library name "${s}" contains illegal characters (whitespace or "/")`),a&&l&&u.push("and"),l&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),_s.warn(u.join(" "));return}ho(new va(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}const j2="firebase-heartbeat-database",k2=1,fu="firebase-heartbeat-store";let ep=null;function gT(){return ep||(ep=ZN(j2,k2,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(fu)}catch(t){console.warn(t)}}}}).catch(n=>{throw ma.create("idb-open",{originalErrorMessage:n.message})})),ep}async function P2(n){try{const t=(await gT()).transaction(fu),s=await t.objectStore(fu).get(pT(n));return await t.done,s}catch(e){if(e instanceof qr)_s.warn(e.message);else{const t=ma.create("idb-get",{originalErrorMessage:e?.message});_s.warn(t.message)}}}async function MS(n,e){try{const s=(await gT()).transaction(fu,"readwrite");await s.objectStore(fu).put(e,pT(n)),await s.done}catch(t){if(t instanceof qr)_s.warn(t.message);else{const s=ma.create("idb-set",{originalErrorMessage:t?.message});_s.warn(s.message)}}}function pT(n){return`${n.name}!${n.options.appId}`}const V2=1024,L2=30;class U2{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new B2(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=OS();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:t}),this._heartbeatsCache.heartbeats.length>L2){const a=F2(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){_s.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=OS(),{heartbeatsToSend:t,unsentEntries:s}=z2(this._heartbeatsCache.heartbeats),a=Hd(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(e){return _s.warn(e),""}}}function OS(){return new Date().toISOString().substring(0,10)}function z2(n,e=V2){const t=[];let s=n.slice();for(const a of n){const l=t.find(u=>u.agent===a.agent);if(l){if(l.dates.push(a.date),jS(t)>e){l.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),jS(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class B2{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return xN()?RN().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await P2(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return MS(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return MS(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function jS(n){return Hd(JSON.stringify({version:2,heartbeats:n})).length}function F2(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let s=1;s<n.length;s++)n[s].date<t&&(t=n[s].date,e=s);return e}function H2(n){ho(new va("platform-logger",e=>new t2(e),"PRIVATE")),ho(new va("heartbeat",e=>new U2(e),"PRIVATE")),kr(Mp,IS,n),kr(Mp,IS,"esm2020"),kr("fire-js","")}H2("");function yT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const q2=yT,vT=new Ru("auth","Firebase",yT());const qd=new Ny("@firebase/auth");function G2(n,...e){qd.logLevel<=yt.WARN&&qd.warn(`Auth (${So}): ${n}`,...e)}function Dd(n,...e){qd.logLevel<=yt.ERROR&&qd.error(`Auth (${So}): ${n}`,...e)}function Br(n,...e){throw Oy(n,...e)}function lr(n,...e){return Oy(n,...e)}function My(n,e,t){const s={...q2(),[e]:t};return new Ru("auth","Firebase",s).create(e,{appName:n.name})}function ao(n){return My(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function $2(n,e,t){const s=t;if(!(e instanceof s))throw s.name!==e.constructor.name&&Br(n,"argument-error"),My(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Oy(n,...e){if(typeof n!="string"){const t=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=n.name),n._errorFactory.create(t,...s)}return vT.create(n,...e)}function Ke(n,e,...t){if(!n)throw Oy(e,...t)}function ms(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Dd(e),new Error(e)}function bs(n,e){n||ms(e)}function kp(){return typeof self<"u"&&self.location?.href||""}function Q2(){return kS()==="http:"||kS()==="https:"}function kS(){return typeof self<"u"&&self.location?.protocol||null}function Y2(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Q2()||EN()||"connection"in navigator)?navigator.onLine:!0}function K2(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Nu{constructor(e,t){this.shortDelay=e,this.longDelay=t,bs(t>e,"Short delay should be less than long delay!"),this.isMobile=bN()||TN()}get(){return Y2()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function jy(n,e){bs(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class _T{static initialize(e,t,s){this.fetchImpl=e,t&&(this.headersImpl=t),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ms("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ms("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ms("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const W2={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const X2=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Z2=new Nu(3e4,6e4);function ky(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Ul(n,e,t,s,a={}){return bT(n,a,async()=>{let l={},u={};s&&(e==="GET"?u=s:l={body:JSON.stringify(s)});const g=Iu({key:n.config.apiKey,...u}).slice(1),d=await n._getAdditionalHeaders();d["Content-Type"]="application/json",n.languageCode&&(d["X-Firebase-Locale"]=n.languageCode);const p={method:e,headers:d,...l};return wN()||(p.referrerPolicy="no-referrer"),n.emulatorConfig&&xa(n.emulatorConfig.host)&&(p.credentials="include"),_T.fetch()(await ST(n,n.config.apiHost,t,g),p)})}async function bT(n,e,t){n._canInitEmulator=!1;const s={...W2,...e};try{const a=new eD(n),l=await Promise.race([t(),a.promise]);a.clearNetworkTimeout();const u=await l.json();if("needConfirmation"in u)throw hd(n,"account-exists-with-different-credential",u);if(l.ok&&!("errorMessage"in u))return u;{const g=l.ok?u.errorMessage:u.error.message,[d,p]=g.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw hd(n,"credential-already-in-use",u);if(d==="EMAIL_EXISTS")throw hd(n,"email-already-in-use",u);if(d==="USER_DISABLED")throw hd(n,"user-disabled",u);const v=s[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw My(n,v,p);Br(n,v)}}catch(a){if(a instanceof qr)throw a;Br(n,"network-request-failed",{message:String(a)})}}async function J2(n,e,t,s,a={}){const l=await Ul(n,e,t,s,a);return"mfaPendingCredential"in l&&Br(n,"multi-factor-auth-required",{_serverResponse:l}),l}async function ST(n,e,t,s){const a=`${e}${t}?${s}`,l=n,u=l.config.emulator?jy(n.config,a):`${n.config.apiScheme}://${a}`;return X2.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(u).toString():u}class eD{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,s)=>{this.timer=setTimeout(()=>s(lr(this.auth,"network-request-failed")),Z2.get())})}}function hd(n,e,t){const s={appName:n.name};t.email&&(s.email=t.email),t.phoneNumber&&(s.phoneNumber=t.phoneNumber);const a=lr(n,e,s);return a.customData._tokenResponse=t,a}async function tD(n,e){return Ul(n,"POST","/v1/accounts:delete",e)}async function Gd(n,e){return Ul(n,"POST","/v1/accounts:lookup",e)}function iu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function nD(n,e=!1){const t=jn(n),s=await t.getIdToken(e),a=Py(s);Ke(a&&a.exp&&a.auth_time&&a.iat,t.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,u=l?.sign_in_provider;return{claims:a,token:s,authTime:iu(tp(a.auth_time)),issuedAtTime:iu(tp(a.iat)),expirationTime:iu(tp(a.exp)),signInProvider:u||null,signInSecondFactor:l?.sign_in_second_factor||null}}function tp(n){return Number(n)*1e3}function Py(n){const[e,t,s]=n.split(".");if(e===void 0||t===void 0||s===void 0)return Dd("JWT malformed, contained fewer than 3 sections"),null;try{const a=aT(t);return a?JSON.parse(a):(Dd("Failed to decode base64 JWT payload"),null)}catch(a){return Dd("Caught error parsing JWT payload as JSON",a?.toString()),null}}function PS(n){const e=Py(n);return Ke(e,"internal-error"),Ke(typeof e.exp<"u","internal-error"),Ke(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function mu(n,e,t=!1){if(t)return e;try{return await e}catch(s){throw s instanceof qr&&iD(s)&&n.auth.currentUser===n&&await n.auth.signOut(),s}}function iD({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class rD{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const s=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Pp{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=iu(this.lastLoginAt),this.creationTime=iu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function $d(n){const e=n.auth,t=await n.getIdToken(),s=await mu(n,Gd(e,{idToken:t}));Ke(s?.users.length,e,"internal-error");const a=s.users[0];n._notifyReloadListener(a);const l=a.providerUserInfo?.length?wT(a.providerUserInfo):[],u=aD(n.providerData,l),g=n.isAnonymous,d=!(n.email&&a.passwordHash)&&!u?.length,p=g?d:!1,v={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:u,metadata:new Pp(a.createdAt,a.lastLoginAt),isAnonymous:p};Object.assign(n,v)}async function sD(n){const e=jn(n);await $d(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function aD(n,e){return[...n.filter(s=>!e.some(a=>a.providerId===s.providerId)),...e]}function wT(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function oD(n,e){const t=await bT(n,{},async()=>{const s=Iu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=n.config,u=await ST(n,a,"/v1/token",`key=${l}`),g=await n._getAdditionalHeaders();g["Content-Type"]="application/x-www-form-urlencoded";const d={method:"POST",headers:g,body:s};return n.emulatorConfig&&xa(n.emulatorConfig.host)&&(d.credentials="include"),_T.fetch()(u,d)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function lD(n,e){return Ul(n,"POST","/v2/accounts:revokeToken",ky(n,e))}class Sl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ke(e.idToken,"internal-error"),Ke(typeof e.idToken<"u","internal-error"),Ke(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):PS(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ke(e.length!==0,"internal-error");const t=PS(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ke(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:s,refreshToken:a,expiresIn:l}=await oD(e,t);this.updateTokensAndExpiration(s,a,Number(l))}updateTokensAndExpiration(e,t,s){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,t){const{refreshToken:s,accessToken:a,expirationTime:l}=t,u=new Sl;return s&&(Ke(typeof s=="string","internal-error",{appName:e}),u.refreshToken=s),a&&(Ke(typeof a=="string","internal-error",{appName:e}),u.accessToken=a),l&&(Ke(typeof l=="number","internal-error",{appName:e}),u.expirationTime=l),u}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Sl,this.toJSON())}_performRefresh(){return ms("not implemented")}}function ta(n,e){Ke(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class or{constructor({uid:e,auth:t,stsTokenManager:s,...a}){this.providerId="firebase",this.proactiveRefresh=new rD(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new Pp(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const t=await mu(this,this.stsTokenManager.getToken(this.auth,e));return Ke(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return nD(this,e)}reload(){return sD(this)}_assign(e){this!==e&&(Ke(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new or({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Ke(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),t&&await $d(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ki(this.auth.app))return Promise.reject(ao(this.auth));const e=await this.getIdToken();return await mu(this,tD(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const s=t.displayName??void 0,a=t.email??void 0,l=t.phoneNumber??void 0,u=t.photoURL??void 0,g=t.tenantId??void 0,d=t._redirectEventId??void 0,p=t.createdAt??void 0,v=t.lastLoginAt??void 0,{uid:_,emailVerified:S,isAnonymous:C,providerData:O,stsTokenManager:L}=t;Ke(_&&L,e,"internal-error");const U=Sl.fromJSON(this.name,L);Ke(typeof _=="string",e,"internal-error"),ta(s,e.name),ta(a,e.name),Ke(typeof S=="boolean",e,"internal-error"),Ke(typeof C=="boolean",e,"internal-error"),ta(l,e.name),ta(u,e.name),ta(g,e.name),ta(d,e.name),ta(p,e.name),ta(v,e.name);const z=new or({uid:_,auth:e,email:a,emailVerified:S,displayName:s,isAnonymous:C,photoURL:u,phoneNumber:l,tenantId:g,stsTokenManager:U,createdAt:p,lastLoginAt:v});return O&&Array.isArray(O)&&(z.providerData=O.map(X=>({...X}))),d&&(z._redirectEventId=d),z}static async _fromIdTokenResponse(e,t,s=!1){const a=new Sl;a.updateFromServerResponse(t);const l=new or({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:s});return await $d(l),l}static async _fromGetAccountInfoResponse(e,t,s){const a=t.users[0];Ke(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?wT(a.providerUserInfo):[],u=!(a.email&&a.passwordHash)&&!l?.length,g=new Sl;g.updateFromIdToken(s);const d=new or({uid:a.localId,auth:e,stsTokenManager:g,isAnonymous:u}),p={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new Pp(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!l?.length};return Object.assign(d,p),d}}const VS=new Map;function gs(n){bs(n instanceof Function,"Expected a class definition");let e=VS.get(n);return e?(bs(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,VS.set(n,e),e)}class ET{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}ET.type="NONE";const LS=ET;function Md(n,e,t){return`firebase:${n}:${e}:${t}`}class wl{constructor(e,t,s){this.persistence=e,this.auth=t,this.userKey=s;const{config:a,name:l}=this.auth;this.fullUserKey=Md(this.userKey,a.apiKey,l),this.fullPersistenceKey=Md("persistence",a.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Gd(this.auth,{idToken:e}).catch(()=>{});return t?or._fromGetAccountInfoResponse(this.auth,t,e):null}return or._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,s="authUser"){if(!t.length)return new wl(gs(LS),e,s);const a=(await Promise.all(t.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let l=a[0]||gs(LS);const u=Md(s,e.config.apiKey,e.name);let g=null;for(const p of t)try{const v=await p._get(u);if(v){let _;if(typeof v=="string"){const S=await Gd(e,{idToken:v}).catch(()=>{});if(!S)break;_=await or._fromGetAccountInfoResponse(e,S,v)}else _=or._fromJSON(e,v);p!==l&&(g=_),l=p;break}}catch{}const d=a.filter(p=>p._shouldAllowMigration);return!l._shouldAllowMigration||!d.length?new wl(l,e,s):(l=d[0],g&&await l._set(u,g.toJSON()),await Promise.all(t.map(async p=>{if(p!==l)try{await p._remove(u)}catch{}})),new wl(l,e,s))}}function US(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(xT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(TT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(IT(e))return"Blackberry";if(NT(e))return"Webos";if(AT(e))return"Safari";if((e.includes("chrome/")||CT(e))&&!e.includes("edge/"))return"Chrome";if(RT(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=n.match(t);if(s?.length===2)return s[1]}return"Other"}function TT(n=si()){return/firefox\//i.test(n)}function AT(n=si()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function CT(n=si()){return/crios\//i.test(n)}function xT(n=si()){return/iemobile/i.test(n)}function RT(n=si()){return/android/i.test(n)}function IT(n=si()){return/blackberry/i.test(n)}function NT(n=si()){return/webos/i.test(n)}function Vy(n=si()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function cD(n=si()){return Vy(n)&&!!window.navigator?.standalone}function uD(){return AN()&&document.documentMode===10}function DT(n=si()){return Vy(n)||RT(n)||NT(n)||IT(n)||/windows phone/i.test(n)||xT(n)}function MT(n,e=[]){let t;switch(n){case"Browser":t=US(si());break;case"Worker":t=`${US(si())}-${n}`;break;default:t=n}const s=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${So}/${s}`}class hD{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const s=l=>new Promise((u,g)=>{try{const d=e(l);u(d)}catch(d){g(d)}});s.onAbort=t,this.queue.push(s);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const s of this.queue)await s(e),s.onAbort&&t.push(s.onAbort)}catch(s){t.reverse();for(const a of t)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s?.message})}}}async function dD(n,e={}){return Ul(n,"GET","/v2/passwordPolicy",ky(n,e))}const fD=6;class mD{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??fD,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const s=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;s&&(t.meetsMinPasswordLength=e.length>=s),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let s;for(let a=0;a<e.length;a++)s=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,t,s,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}class gD{constructor(e,t,s,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=s,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new zS(this),this.idTokenSubscription=new zS(this),this.beforeStateQueue=new hD(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=vT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=gs(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await wl.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Gd(this,{idToken:e}),s=await or._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(s)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Ki(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(u,u))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let s=t,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=this.redirectUser?._redirectEventId,u=s?._redirectEventId,g=await this.tryRedirectSignIn(e);(!l||l===u)&&g?.user&&(s=g.user,a=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(s)}catch(l){s=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Ke(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await $d(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=K2()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ki(this.app))return Promise.reject(ao(this));const t=e?jn(e):null;return t&&Ke(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ke(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ki(this.app)?Promise.reject(ao(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ki(this.app)?Promise.reject(ao(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(gs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await dD(this),t=new mD(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ru("auth","Firebase",e())}onAuthStateChanged(e,t,s){return this.registerStateListener(this.authStateSubscription,e,t,s)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,s){return this.registerStateListener(this.idTokenSubscription,e,t,s)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(s.tenantId=this.tenantId),await lD(this,s)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const s=await this.getOrInitRedirectPersistenceManager(t);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&gs(e)||this._popupRedirectResolver;Ke(t,this,"argument-error"),this.redirectPersistenceManager=await wl.create(this,[gs(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,s,a){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let u=!1;const g=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ke(g,this,"internal-error"),g.then(()=>{u||l(this.currentUser)}),typeof t=="function"){const d=e.addObserver(t,s,a);return()=>{u=!0,d()}}else{const d=e.addObserver(t);return()=>{u=!0,d()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ke(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=MT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const s=await this._getAppCheckToken();return s&&(e["X-Firebase-AppCheck"]=s),e}async _getAppCheckToken(){if(Ki(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&G2(`Error while retrieving App Check token: ${e.error}`),e?.token}}function _f(n){return jn(n)}class zS{constructor(e){this.auth=e,this.observer=null,this.addObserver=ON(t=>this.observer=t)}get next(){return Ke(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Ly={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function pD(n){Ly=n}function yD(n){return Ly.loadJS(n)}function vD(){return Ly.gapiScript}function _D(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function bD(n,e){const t=yf(n,"auth");if(t.isInitialized()){const a=t.getImmediate(),l=t.getOptions();if(uo(l,e??{}))return a;Br(a,"already-initialized")}return t.initialize({options:e})}function SD(n,e){const t=e?.persistence||[],s=(Array.isArray(t)?t:[t]).map(gs);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(s,e?.popupRedirectResolver)}function wD(n,e,t){const s=_f(n);Ke(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const a=!1,l=OT(e),{host:u,port:g}=ED(e),d=g===null?"":`:${g}`,p={url:`${l}//${u}${d}/`},v=Object.freeze({host:u,port:g,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!s._canInitEmulator){Ke(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),Ke(uo(p,s.config.emulator)&&uo(v,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=p,s.emulatorConfig=v,s.settings.appVerificationDisabledForTesting=!0,xa(u)?(Ry(`${l}//${u}${d}`),Iy("Auth",!0)):TD()}function OT(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function ED(n){const e=OT(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const s=t[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(s);if(a){const l=a[1];return{host:l,port:BS(s.substr(l.length+1))}}else{const[l,u]=s.split(":");return{host:l,port:BS(u)}}}function BS(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function TD(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class jT{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ms("not implemented")}_getIdTokenResponse(e){return ms("not implemented")}_linkToIdToken(e,t){return ms("not implemented")}_getReauthenticationResolver(e){return ms("not implemented")}}async function El(n,e){return J2(n,"POST","/v1/accounts:signInWithIdp",ky(n,e))}const AD="http://localhost";class fo extends jT{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new fo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Br("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:a,...l}=t;if(!s||!a)return null;const u=new fo(s,a);return u.idToken=l.idToken||void 0,u.accessToken=l.accessToken||void 0,u.secret=l.secret,u.nonce=l.nonce,u.pendingToken=l.pendingToken||null,u}_getIdTokenResponse(e){const t=this.buildRequest();return El(e,t)}_linkToIdToken(e,t){const s=this.buildRequest();return s.idToken=t,El(e,s)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,El(e,t)}buildRequest(){const e={requestUri:AD,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Iu(t)}return e}}class Uy{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Du extends Uy{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class sa extends Du{constructor(){super("facebook.com")}static credential(e){return fo._fromParams({providerId:sa.PROVIDER_ID,signInMethod:sa.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return sa.credentialFromTaggedObject(e)}static credentialFromError(e){return sa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return sa.credential(e.oauthAccessToken)}catch{return null}}}sa.FACEBOOK_SIGN_IN_METHOD="facebook.com";sa.PROVIDER_ID="facebook.com";class ds extends Du{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return fo._fromParams({providerId:ds.PROVIDER_ID,signInMethod:ds.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ds.credentialFromTaggedObject(e)}static credentialFromError(e){return ds.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s}=e;if(!t&&!s)return null;try{return ds.credential(t,s)}catch{return null}}}ds.GOOGLE_SIGN_IN_METHOD="google.com";ds.PROVIDER_ID="google.com";class aa extends Du{constructor(){super("github.com")}static credential(e){return fo._fromParams({providerId:aa.PROVIDER_ID,signInMethod:aa.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return aa.credentialFromTaggedObject(e)}static credentialFromError(e){return aa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return aa.credential(e.oauthAccessToken)}catch{return null}}}aa.GITHUB_SIGN_IN_METHOD="github.com";aa.PROVIDER_ID="github.com";class oa extends Du{constructor(){super("twitter.com")}static credential(e,t){return fo._fromParams({providerId:oa.PROVIDER_ID,signInMethod:oa.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return oa.credentialFromTaggedObject(e)}static credentialFromError(e){return oa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:s}=e;if(!t||!s)return null;try{return oa.credential(t,s)}catch{return null}}}oa.TWITTER_SIGN_IN_METHOD="twitter.com";oa.PROVIDER_ID="twitter.com";class Rl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,s,a=!1){const l=await or._fromIdTokenResponse(e,s,a),u=FS(s);return new Rl({user:l,providerId:u,_tokenResponse:s,operationType:t})}static async _forOperation(e,t,s){await e._updateTokensIfNecessary(s,!0);const a=FS(s);return new Rl({user:e,providerId:a,_tokenResponse:s,operationType:t})}}function FS(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Qd extends qr{constructor(e,t,s,a){super(t.code,t.message),this.operationType=s,this.user=a,Object.setPrototypeOf(this,Qd.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,t,s,a){return new Qd(e,t,s,a)}}function kT(n,e,t,s){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?Qd._fromErrorAndOperation(n,l,e,s):l})}async function CD(n,e,t=!1){const s=await mu(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Rl._forOperation(n,"link",s)}async function xD(n,e,t=!1){const{auth:s}=n;if(Ki(s.app))return Promise.reject(ao(s));const a="reauthenticate";try{const l=await mu(n,kT(s,a,e,n),t);Ke(l.idToken,s,"internal-error");const u=Py(l.idToken);Ke(u,s,"internal-error");const{sub:g}=u;return Ke(n.uid===g,s,"user-mismatch"),Rl._forOperation(n,a,l)}catch(l){throw l?.code==="auth/user-not-found"&&Br(s,"user-mismatch"),l}}async function RD(n,e,t=!1){if(Ki(n.app))return Promise.reject(ao(n));const s="signIn",a=await kT(n,s,e),l=await Rl._fromIdTokenResponse(n,s,a);return t||await n._updateCurrentUser(l.user),l}function ID(n,e,t,s){return jn(n).onIdTokenChanged(e,t,s)}function ND(n,e,t){return jn(n).beforeAuthStateChanged(e,t)}const Yd="__sak";class PT{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Yd,"1"),this.storage.removeItem(Yd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const DD=1e3,MD=10;class VT extends PT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=DT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const s=this.storage.getItem(t),a=this.localCache[t];s!==a&&e(t,a,s)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((u,g,d)=>{this.notifyListeners(u,d)});return}const s=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const u=this.storage.getItem(s);!t&&this.localCache[s]===u||this.notifyListeners(s,u)},l=this.storage.getItem(s);uD()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,MD):a()}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const a of Array.from(s))a(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:s}),!0)})},DD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}VT.type="LOCAL";const OD=VT;class LT extends PT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}LT.type="SESSION";const UT=LT;function jD(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class bf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(a=>a.isListeningto(e));if(t)return t;const s=new bf(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:s,eventType:a,data:l}=t.data,u=this.handlersMap[a];if(!u?.size)return;t.ports[0].postMessage({status:"ack",eventId:s,eventType:a});const g=Array.from(u).map(async p=>p(t.origin,l)),d=await jD(g);t.ports[0].postMessage({status:"done",eventId:s,eventType:a,response:d})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}bf.receivers=[];function zy(n="",e=10){let t="";for(let s=0;s<e;s++)t+=Math.floor(Math.random()*10);return n+t}class kD{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,s=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,u;return new Promise((g,d)=>{const p=zy("",20);a.port1.start();const v=setTimeout(()=>{d(new Error("unsupported_event"))},s);u={messageChannel:a,onMessage(_){const S=_;if(S.data.eventId===p)switch(S.data.status){case"ack":clearTimeout(v),l=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),g(S.data.response);break;default:clearTimeout(v),clearTimeout(l),d(new Error("invalid_response"));break}}},this.handlers.add(u),a.port1.addEventListener("message",u.onMessage),this.target.postMessage({eventType:e,eventId:p,data:t},[a.port2])}).finally(()=>{u&&this.removeMessageHandler(u)})}}function Pr(){return window}function PD(n){Pr().location.href=n}function zT(){return typeof Pr().WorkerGlobalScope<"u"&&typeof Pr().importScripts=="function"}async function VD(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function LD(){return navigator?.serviceWorker?.controller||null}function UD(){return zT()?self:null}const BT="firebaseLocalStorageDb",zD=1,Kd="firebaseLocalStorage",FT="fbase_key";class Mu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Sf(n,e){return n.transaction([Kd],e?"readwrite":"readonly").objectStore(Kd)}function BD(){const n=indexedDB.deleteDatabase(BT);return new Mu(n).toPromise()}function Vp(){const n=indexedDB.open(BT,zD);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const s=n.result;try{s.createObjectStore(Kd,{keyPath:FT})}catch(a){t(a)}}),n.addEventListener("success",async()=>{const s=n.result;s.objectStoreNames.contains(Kd)?e(s):(s.close(),await BD(),e(await Vp()))})})}async function HS(n,e,t){const s=Sf(n,!0).put({[FT]:e,value:t});return new Mu(s).toPromise()}async function FD(n,e){const t=Sf(n,!1).get(e),s=await new Mu(t).toPromise();return s===void 0?null:s.value}function qS(n,e){const t=Sf(n,!0).delete(e);return new Mu(t).toPromise()}const HD=800,qD=3;class HT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Vp(),this.db)}async _withRetries(e){let t=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(t++>qD)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return zT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=bf._getInstance(UD()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await VD(),!this.activeServiceWorker)return;this.sender=new kD(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||LD()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Vp();return await HS(e,Yd,"1"),await qS(e,Yd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(s=>HS(s,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(s=>FD(s,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>qS(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=Sf(a,!1).getAll();return new Mu(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],s=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)s.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!s.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const a of Array.from(s))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),HD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}HT.type="LOCAL";const GD=HT;new Nu(3e4,6e4);function qT(n,e){return e?gs(e):(Ke(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class By extends jT{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return El(e,this._buildIdpRequest())}_linkToIdToken(e,t){return El(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return El(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function $D(n){return RD(n.auth,new By(n),n.bypassAuthState)}function QD(n){const{auth:e,user:t}=n;return Ke(t,e,"internal-error"),xD(t,new By(n),n.bypassAuthState)}async function YD(n){const{auth:e,user:t}=n;return Ke(t,e,"internal-error"),CD(t,new By(n),n.bypassAuthState)}class GT{constructor(e,t,s,a,l=!1){this.auth=e,this.resolver=s,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:s,postBody:a,tenantId:l,error:u,type:g}=e;if(u){this.reject(u);return}const d={auth:this.auth,requestUri:t,sessionId:s,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(g)(d))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return $D;case"linkViaPopup":case"linkViaRedirect":return YD;case"reauthViaPopup":case"reauthViaRedirect":return QD;default:Br(this.auth,"internal-error")}}resolve(e){bs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){bs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const KD=new Nu(2e3,1e4);async function WD(n,e,t){if(Ki(n.app))return Promise.reject(lr(n,"operation-not-supported-in-this-environment"));const s=_f(n);$2(n,e,Uy);const a=qT(s,t);return new ro(s,"signInViaPopup",e,a).executeNotNull()}class ro extends GT{constructor(e,t,s,a,l){super(e,t,a,l),this.provider=s,this.authWindow=null,this.pollId=null,ro.currentPopupAction&&ro.currentPopupAction.cancel(),ro.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ke(e,this.auth,"internal-error"),e}async onExecution(){bs(this.filter.length===1,"Popup operations only handle one event");const e=zy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(lr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(lr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ro.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(lr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,KD.get())};e()}}ro.currentPopupAction=null;const XD="pendingRedirect",Od=new Map;class ZD extends GT{constructor(e,t,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,s),this.eventId=null}async execute(){let e=Od.get(this.auth._key());if(!e){try{const s=await JD(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(t){e=()=>Promise.reject(t)}Od.set(this.auth._key(),e)}return this.bypassAuthState||Od.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function JD(n,e){const t=nM(e),s=tM(n);if(!await s._isAvailable())return!1;const a=await s._get(t)==="true";return await s._remove(t),a}function eM(n,e){Od.set(n._key(),e)}function tM(n){return gs(n._redirectPersistence)}function nM(n){return Md(XD,n.config.apiKey,n.name)}async function iM(n,e,t=!1){if(Ki(n.app))return Promise.reject(ao(n));const s=_f(n),a=qT(s,e),u=await new ZD(s,a,t).execute();return u&&!t&&(delete u.user._redirectEventId,await s._persistUserIfCurrent(u.user),await s._setRedirectUser(null,e)),u}const rM=600*1e3;class sM{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(t=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!aM(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!$T(e)){const s=e.error.code?.split("auth/")[1]||"internal-error";t.onError(lr(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const s=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=rM&&this.cachedEventUids.clear(),this.cachedEventUids.has(GS(e))}saveEventToCache(e){this.cachedEventUids.add(GS(e)),this.lastProcessedEventTime=Date.now()}}function GS(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function $T({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function aM(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return $T(n);default:return!1}}async function oM(n,e={}){return Ul(n,"GET","/v1/projects",e)}const lM=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,cM=/^https?/;async function uM(n){if(n.config.emulator)return;const{authorizedDomains:e}=await oM(n);for(const t of e)try{if(hM(t))return}catch{}Br(n,"unauthorized-domain")}function hM(n){const e=kp(),{protocol:t,hostname:s}=new URL(e);if(n.startsWith("chrome-extension://")){const u=new URL(n);return u.hostname===""&&s===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&u.hostname===s}if(!cM.test(t))return!1;if(lM.test(n))return s===n;const a=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(s)}const dM=new Nu(3e4,6e4);function $S(){const n=Pr().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function fM(n){return new Promise((e,t)=>{function s(){$S(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{$S(),t(lr(n,"network-request-failed"))},timeout:dM.get()})}if(Pr().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Pr().gapi?.load)s();else{const a=_D("iframefcb");return Pr()[a]=()=>{gapi.load?s():t(lr(n,"network-request-failed"))},yD(`${vD()}?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw jd=null,e})}let jd=null;function mM(n){return jd=jd||fM(n),jd}const gM=new Nu(5e3,15e3),pM="__/auth/iframe",yM="emulator/auth/iframe",vM={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},_M=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function bM(n){const e=n.config;Ke(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?jy(e,yM):`https://${n.config.authDomain}/${pM}`,s={apiKey:e.apiKey,appName:n.name,v:So},a=_M.get(n.config.apiHost);a&&(s.eid=a);const l=n._getFrameworks();return l.length&&(s.fw=l.join(",")),`${t}?${Iu(s).slice(1)}`}async function SM(n){const e=await mM(n),t=Pr().gapi;return Ke(t,n,"internal-error"),e.open({where:document.body,url:bM(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:vM,dontclear:!0},s=>new Promise(async(a,l)=>{await s.restyle({setHideOnLeave:!1});const u=lr(n,"network-request-failed"),g=Pr().setTimeout(()=>{l(u)},gM.get());function d(){Pr().clearTimeout(g),a(s)}s.ping(d).then(d,()=>{l(u)})}))}const wM={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},EM=500,TM=600,AM="_blank",CM="http://localhost";class QS{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function xM(n,e,t,s=EM,a=TM){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),u=Math.max((window.screen.availWidth-s)/2,0).toString();let g="";const d={...wM,width:s.toString(),height:a.toString(),top:l,left:u},p=si().toLowerCase();t&&(g=CT(p)?AM:t),TT(p)&&(e=e||CM,d.scrollbars="yes");const v=Object.entries(d).reduce((S,[C,O])=>`${S}${C}=${O},`,"");if(cD(p)&&g!=="_self")return RM(e||"",g),new QS(null);const _=window.open(e||"",g,v);Ke(_,n,"popup-blocked");try{_.focus()}catch{}return new QS(_)}function RM(n,e){const t=document.createElement("a");t.href=n,t.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(s)}const IM="__/auth/handler",NM="emulator/auth/handler",DM=encodeURIComponent("fac");async function YS(n,e,t,s,a,l){Ke(n.config.authDomain,n,"auth-domain-config-required"),Ke(n.config.apiKey,n,"invalid-api-key");const u={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:s,v:So,eventId:a};if(e instanceof Uy){e.setDefaultLanguage(n.languageCode),u.providerId=e.providerId||"",MN(e.getCustomParameters())||(u.customParameters=JSON.stringify(e.getCustomParameters()));for(const[v,_]of Object.entries({}))u[v]=_}if(e instanceof Du){const v=e.getScopes().filter(_=>_!=="");v.length>0&&(u.scopes=v.join(","))}n.tenantId&&(u.tid=n.tenantId);const g=u;for(const v of Object.keys(g))g[v]===void 0&&delete g[v];const d=await n._getAppCheckToken(),p=d?`#${DM}=${encodeURIComponent(d)}`:"";return`${MM(n)}?${Iu(g).slice(1)}${p}`}function MM({config:n}){return n.emulator?jy(n,NM):`https://${n.authDomain}/${IM}`}const np="webStorageSupport";class OM{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=UT,this._completeRedirectFn=iM,this._overrideRedirectResult=eM}async _openPopup(e,t,s,a){bs(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const l=await YS(e,t,s,kp(),a);return xM(e,l,zy())}async _openRedirect(e,t,s,a){await this._originValidation(e);const l=await YS(e,t,s,kp(),a);return PD(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:a,promise:l}=this.eventManagers[t];return a?Promise.resolve(a):(bs(l,"If manager is not set, promise should be"),l)}const s=this.initAndGetManager(e);return this.eventManagers[t]={promise:s},s.catch(()=>{delete this.eventManagers[t]}),s}async initAndGetManager(e){const t=await SM(e),s=new sM(e);return t.register("authEvent",a=>(Ke(a?.authEvent,e,"invalid-auth-event"),{status:s.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=t,s}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(np,{type:np},a=>{const l=a?.[0]?.[np];l!==void 0&&t(!!l),Br(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=uM(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return DT()||AT()||Vy()}}const jM=OM;var KS="@firebase/auth",WS="1.11.1";class kM{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(s=>{e(s?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ke(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function PM(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function VM(n){ho(new va("auth",(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:u,authDomain:g}=s.options;Ke(u&&!u.includes(":"),"invalid-api-key",{appName:s.name});const d={apiKey:u,authDomain:g,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:MT(n)},p=new gD(s,a,l,d);return SD(p,t),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,s)=>{e.getProvider("auth-internal").initialize()})),ho(new va("auth-internal",e=>{const t=_f(e.getProvider("auth").getImmediate());return(s=>new kM(s))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),kr(KS,WS,PM(n)),kr(KS,WS,"esm2020")}const LM=300,UM=uT("authIdTokenMaxAge")||LM;let XS=null;const zM=n=>async e=>{const t=e&&await e.getIdTokenResult(),s=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(s&&s>UM)return;const a=t?.token;XS!==a&&(XS=a,await fetch(n,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function BM(n=vf()){const e=yf(n,"auth");if(e.isInitialized())return e.getImmediate();const t=bD(n,{popupRedirectResolver:jM,persistence:[GD,OD,UT]}),s=uT("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(s,location.origin);if(location.origin===l.origin){const u=zM(l.toString());ND(t,u,()=>u(t.currentUser)),ID(t,g=>u(g))}}const a=oT("auth");return a&&wD(t,`http://${a}`),t}function FM(){return document.getElementsByTagName("head")?.[0]??document}pD({loadJS(n){return new Promise((e,t)=>{const s=document.createElement("script");s.setAttribute("src",n),s.onload=e,s.onerror=a=>{const l=lr("internal-error");l.customData=a,t(l)},s.type="text/javascript",s.charset="UTF-8",FM().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});VM("Browser");var HM="firebase",qM="12.6.0";kr(HM,qM,"app");var ZS=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ga,QT;(function(){var n;function e(k,M){function P(){}P.prototype=M.prototype,k.F=M.prototype,k.prototype=new P,k.prototype.constructor=k,k.D=function(x,A,V){for(var N=Array(arguments.length-2),fe=2;fe<arguments.length;fe++)N[fe-2]=arguments[fe];return M.prototype[A].apply(x,N)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(s,t),s.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(k,M,P){P||(P=0);const x=Array(16);if(typeof M=="string")for(var A=0;A<16;++A)x[A]=M.charCodeAt(P++)|M.charCodeAt(P++)<<8|M.charCodeAt(P++)<<16|M.charCodeAt(P++)<<24;else for(A=0;A<16;++A)x[A]=M[P++]|M[P++]<<8|M[P++]<<16|M[P++]<<24;M=k.g[0],P=k.g[1],A=k.g[2];let V=k.g[3],N;N=M+(V^P&(A^V))+x[0]+3614090360&4294967295,M=P+(N<<7&4294967295|N>>>25),N=V+(A^M&(P^A))+x[1]+3905402710&4294967295,V=M+(N<<12&4294967295|N>>>20),N=A+(P^V&(M^P))+x[2]+606105819&4294967295,A=V+(N<<17&4294967295|N>>>15),N=P+(M^A&(V^M))+x[3]+3250441966&4294967295,P=A+(N<<22&4294967295|N>>>10),N=M+(V^P&(A^V))+x[4]+4118548399&4294967295,M=P+(N<<7&4294967295|N>>>25),N=V+(A^M&(P^A))+x[5]+1200080426&4294967295,V=M+(N<<12&4294967295|N>>>20),N=A+(P^V&(M^P))+x[6]+2821735955&4294967295,A=V+(N<<17&4294967295|N>>>15),N=P+(M^A&(V^M))+x[7]+4249261313&4294967295,P=A+(N<<22&4294967295|N>>>10),N=M+(V^P&(A^V))+x[8]+1770035416&4294967295,M=P+(N<<7&4294967295|N>>>25),N=V+(A^M&(P^A))+x[9]+2336552879&4294967295,V=M+(N<<12&4294967295|N>>>20),N=A+(P^V&(M^P))+x[10]+4294925233&4294967295,A=V+(N<<17&4294967295|N>>>15),N=P+(M^A&(V^M))+x[11]+2304563134&4294967295,P=A+(N<<22&4294967295|N>>>10),N=M+(V^P&(A^V))+x[12]+1804603682&4294967295,M=P+(N<<7&4294967295|N>>>25),N=V+(A^M&(P^A))+x[13]+4254626195&4294967295,V=M+(N<<12&4294967295|N>>>20),N=A+(P^V&(M^P))+x[14]+2792965006&4294967295,A=V+(N<<17&4294967295|N>>>15),N=P+(M^A&(V^M))+x[15]+1236535329&4294967295,P=A+(N<<22&4294967295|N>>>10),N=M+(A^V&(P^A))+x[1]+4129170786&4294967295,M=P+(N<<5&4294967295|N>>>27),N=V+(P^A&(M^P))+x[6]+3225465664&4294967295,V=M+(N<<9&4294967295|N>>>23),N=A+(M^P&(V^M))+x[11]+643717713&4294967295,A=V+(N<<14&4294967295|N>>>18),N=P+(V^M&(A^V))+x[0]+3921069994&4294967295,P=A+(N<<20&4294967295|N>>>12),N=M+(A^V&(P^A))+x[5]+3593408605&4294967295,M=P+(N<<5&4294967295|N>>>27),N=V+(P^A&(M^P))+x[10]+38016083&4294967295,V=M+(N<<9&4294967295|N>>>23),N=A+(M^P&(V^M))+x[15]+3634488961&4294967295,A=V+(N<<14&4294967295|N>>>18),N=P+(V^M&(A^V))+x[4]+3889429448&4294967295,P=A+(N<<20&4294967295|N>>>12),N=M+(A^V&(P^A))+x[9]+568446438&4294967295,M=P+(N<<5&4294967295|N>>>27),N=V+(P^A&(M^P))+x[14]+3275163606&4294967295,V=M+(N<<9&4294967295|N>>>23),N=A+(M^P&(V^M))+x[3]+4107603335&4294967295,A=V+(N<<14&4294967295|N>>>18),N=P+(V^M&(A^V))+x[8]+1163531501&4294967295,P=A+(N<<20&4294967295|N>>>12),N=M+(A^V&(P^A))+x[13]+2850285829&4294967295,M=P+(N<<5&4294967295|N>>>27),N=V+(P^A&(M^P))+x[2]+4243563512&4294967295,V=M+(N<<9&4294967295|N>>>23),N=A+(M^P&(V^M))+x[7]+1735328473&4294967295,A=V+(N<<14&4294967295|N>>>18),N=P+(V^M&(A^V))+x[12]+2368359562&4294967295,P=A+(N<<20&4294967295|N>>>12),N=M+(P^A^V)+x[5]+4294588738&4294967295,M=P+(N<<4&4294967295|N>>>28),N=V+(M^P^A)+x[8]+2272392833&4294967295,V=M+(N<<11&4294967295|N>>>21),N=A+(V^M^P)+x[11]+1839030562&4294967295,A=V+(N<<16&4294967295|N>>>16),N=P+(A^V^M)+x[14]+4259657740&4294967295,P=A+(N<<23&4294967295|N>>>9),N=M+(P^A^V)+x[1]+2763975236&4294967295,M=P+(N<<4&4294967295|N>>>28),N=V+(M^P^A)+x[4]+1272893353&4294967295,V=M+(N<<11&4294967295|N>>>21),N=A+(V^M^P)+x[7]+4139469664&4294967295,A=V+(N<<16&4294967295|N>>>16),N=P+(A^V^M)+x[10]+3200236656&4294967295,P=A+(N<<23&4294967295|N>>>9),N=M+(P^A^V)+x[13]+681279174&4294967295,M=P+(N<<4&4294967295|N>>>28),N=V+(M^P^A)+x[0]+3936430074&4294967295,V=M+(N<<11&4294967295|N>>>21),N=A+(V^M^P)+x[3]+3572445317&4294967295,A=V+(N<<16&4294967295|N>>>16),N=P+(A^V^M)+x[6]+76029189&4294967295,P=A+(N<<23&4294967295|N>>>9),N=M+(P^A^V)+x[9]+3654602809&4294967295,M=P+(N<<4&4294967295|N>>>28),N=V+(M^P^A)+x[12]+3873151461&4294967295,V=M+(N<<11&4294967295|N>>>21),N=A+(V^M^P)+x[15]+530742520&4294967295,A=V+(N<<16&4294967295|N>>>16),N=P+(A^V^M)+x[2]+3299628645&4294967295,P=A+(N<<23&4294967295|N>>>9),N=M+(A^(P|~V))+x[0]+4096336452&4294967295,M=P+(N<<6&4294967295|N>>>26),N=V+(P^(M|~A))+x[7]+1126891415&4294967295,V=M+(N<<10&4294967295|N>>>22),N=A+(M^(V|~P))+x[14]+2878612391&4294967295,A=V+(N<<15&4294967295|N>>>17),N=P+(V^(A|~M))+x[5]+4237533241&4294967295,P=A+(N<<21&4294967295|N>>>11),N=M+(A^(P|~V))+x[12]+1700485571&4294967295,M=P+(N<<6&4294967295|N>>>26),N=V+(P^(M|~A))+x[3]+2399980690&4294967295,V=M+(N<<10&4294967295|N>>>22),N=A+(M^(V|~P))+x[10]+4293915773&4294967295,A=V+(N<<15&4294967295|N>>>17),N=P+(V^(A|~M))+x[1]+2240044497&4294967295,P=A+(N<<21&4294967295|N>>>11),N=M+(A^(P|~V))+x[8]+1873313359&4294967295,M=P+(N<<6&4294967295|N>>>26),N=V+(P^(M|~A))+x[15]+4264355552&4294967295,V=M+(N<<10&4294967295|N>>>22),N=A+(M^(V|~P))+x[6]+2734768916&4294967295,A=V+(N<<15&4294967295|N>>>17),N=P+(V^(A|~M))+x[13]+1309151649&4294967295,P=A+(N<<21&4294967295|N>>>11),N=M+(A^(P|~V))+x[4]+4149444226&4294967295,M=P+(N<<6&4294967295|N>>>26),N=V+(P^(M|~A))+x[11]+3174756917&4294967295,V=M+(N<<10&4294967295|N>>>22),N=A+(M^(V|~P))+x[2]+718787259&4294967295,A=V+(N<<15&4294967295|N>>>17),N=P+(V^(A|~M))+x[9]+3951481745&4294967295,k.g[0]=k.g[0]+M&4294967295,k.g[1]=k.g[1]+(A+(N<<21&4294967295|N>>>11))&4294967295,k.g[2]=k.g[2]+A&4294967295,k.g[3]=k.g[3]+V&4294967295}s.prototype.v=function(k,M){M===void 0&&(M=k.length);const P=M-this.blockSize,x=this.C;let A=this.h,V=0;for(;V<M;){if(A==0)for(;V<=P;)a(this,k,V),V+=this.blockSize;if(typeof k=="string"){for(;V<M;)if(x[A++]=k.charCodeAt(V++),A==this.blockSize){a(this,x),A=0;break}}else for(;V<M;)if(x[A++]=k[V++],A==this.blockSize){a(this,x),A=0;break}}this.h=A,this.o+=M},s.prototype.A=function(){var k=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);k[0]=128;for(var M=1;M<k.length-8;++M)k[M]=0;M=this.o*8;for(var P=k.length-8;P<k.length;++P)k[P]=M&255,M/=256;for(this.v(k),k=Array(16),M=0,P=0;P<4;++P)for(let x=0;x<32;x+=8)k[M++]=this.g[P]>>>x&255;return k};function l(k,M){var P=g;return Object.prototype.hasOwnProperty.call(P,k)?P[k]:P[k]=M(k)}function u(k,M){this.h=M;const P=[];let x=!0;for(let A=k.length-1;A>=0;A--){const V=k[A]|0;x&&V==M||(P[A]=V,x=!1)}this.g=P}var g={};function d(k){return-128<=k&&k<128?l(k,function(M){return new u([M|0],M<0?-1:0)}):new u([k|0],k<0?-1:0)}function p(k){if(isNaN(k)||!isFinite(k))return _;if(k<0)return U(p(-k));const M=[];let P=1;for(let x=0;k>=P;x++)M[x]=k/P|0,P*=4294967296;return new u(M,0)}function v(k,M){if(k.length==0)throw Error("number format error: empty string");if(M=M||10,M<2||36<M)throw Error("radix out of range: "+M);if(k.charAt(0)=="-")return U(v(k.substring(1),M));if(k.indexOf("-")>=0)throw Error('number format error: interior "-" character');const P=p(Math.pow(M,8));let x=_;for(let V=0;V<k.length;V+=8){var A=Math.min(8,k.length-V);const N=parseInt(k.substring(V,V+A),M);A<8?(A=p(Math.pow(M,A)),x=x.j(A).add(p(N))):(x=x.j(P),x=x.add(p(N)))}return x}var _=d(0),S=d(1),C=d(16777216);n=u.prototype,n.m=function(){if(L(this))return-U(this).m();let k=0,M=1;for(let P=0;P<this.g.length;P++){const x=this.i(P);k+=(x>=0?x:4294967296+x)*M,M*=4294967296}return k},n.toString=function(k){if(k=k||10,k<2||36<k)throw Error("radix out of range: "+k);if(O(this))return"0";if(L(this))return"-"+U(this).toString(k);const M=p(Math.pow(k,6));var P=this;let x="";for(;;){const A=ne(P,M).g;P=z(P,A.j(M));let V=((P.g.length>0?P.g[0]:P.h)>>>0).toString(k);if(P=A,O(P))return V+x;for(;V.length<6;)V="0"+V;x=V+x}},n.i=function(k){return k<0?0:k<this.g.length?this.g[k]:this.h};function O(k){if(k.h!=0)return!1;for(let M=0;M<k.g.length;M++)if(k.g[M]!=0)return!1;return!0}function L(k){return k.h==-1}n.l=function(k){return k=z(this,k),L(k)?-1:O(k)?0:1};function U(k){const M=k.g.length,P=[];for(let x=0;x<M;x++)P[x]=~k.g[x];return new u(P,~k.h).add(S)}n.abs=function(){return L(this)?U(this):this},n.add=function(k){const M=Math.max(this.g.length,k.g.length),P=[];let x=0;for(let A=0;A<=M;A++){let V=x+(this.i(A)&65535)+(k.i(A)&65535),N=(V>>>16)+(this.i(A)>>>16)+(k.i(A)>>>16);x=N>>>16,V&=65535,N&=65535,P[A]=N<<16|V}return new u(P,P[P.length-1]&-2147483648?-1:0)};function z(k,M){return k.add(U(M))}n.j=function(k){if(O(this)||O(k))return _;if(L(this))return L(k)?U(this).j(U(k)):U(U(this).j(k));if(L(k))return U(this.j(U(k)));if(this.l(C)<0&&k.l(C)<0)return p(this.m()*k.m());const M=this.g.length+k.g.length,P=[];for(var x=0;x<2*M;x++)P[x]=0;for(x=0;x<this.g.length;x++)for(let A=0;A<k.g.length;A++){const V=this.i(x)>>>16,N=this.i(x)&65535,fe=k.i(A)>>>16,F=k.i(A)&65535;P[2*x+2*A]+=N*F,X(P,2*x+2*A),P[2*x+2*A+1]+=V*F,X(P,2*x+2*A+1),P[2*x+2*A+1]+=N*fe,X(P,2*x+2*A+1),P[2*x+2*A+2]+=V*fe,X(P,2*x+2*A+2)}for(k=0;k<M;k++)P[k]=P[2*k+1]<<16|P[2*k];for(k=M;k<2*M;k++)P[k]=0;return new u(P,0)};function X(k,M){for(;(k[M]&65535)!=k[M];)k[M+1]+=k[M]>>>16,k[M]&=65535,M++}function q(k,M){this.g=k,this.h=M}function ne(k,M){if(O(M))throw Error("division by zero");if(O(k))return new q(_,_);if(L(k))return M=ne(U(k),M),new q(U(M.g),U(M.h));if(L(M))return M=ne(k,U(M)),new q(U(M.g),M.h);if(k.g.length>30){if(L(k)||L(M))throw Error("slowDivide_ only works with positive integers.");for(var P=S,x=M;x.l(k)<=0;)P=ee(P),x=ee(x);var A=de(P,1),V=de(x,1);for(x=de(x,2),P=de(P,2);!O(x);){var N=V.add(x);N.l(k)<=0&&(A=A.add(P),V=N),x=de(x,1),P=de(P,1)}return M=z(k,A.j(M)),new q(A,M)}for(A=_;k.l(M)>=0;){for(P=Math.max(1,Math.floor(k.m()/M.m())),x=Math.ceil(Math.log(P)/Math.LN2),x=x<=48?1:Math.pow(2,x-48),V=p(P),N=V.j(M);L(N)||N.l(k)>0;)P-=x,V=p(P),N=V.j(M);O(V)&&(V=S),A=A.add(V),k=z(k,N)}return new q(A,k)}n.B=function(k){return ne(this,k).h},n.and=function(k){const M=Math.max(this.g.length,k.g.length),P=[];for(let x=0;x<M;x++)P[x]=this.i(x)&k.i(x);return new u(P,this.h&k.h)},n.or=function(k){const M=Math.max(this.g.length,k.g.length),P=[];for(let x=0;x<M;x++)P[x]=this.i(x)|k.i(x);return new u(P,this.h|k.h)},n.xor=function(k){const M=Math.max(this.g.length,k.g.length),P=[];for(let x=0;x<M;x++)P[x]=this.i(x)^k.i(x);return new u(P,this.h^k.h)};function ee(k){const M=k.g.length+1,P=[];for(let x=0;x<M;x++)P[x]=k.i(x)<<1|k.i(x-1)>>>31;return new u(P,k.h)}function de(k,M){const P=M>>5;M%=32;const x=k.g.length-P,A=[];for(let V=0;V<x;V++)A[V]=M>0?k.i(V+P)>>>M|k.i(V+P+1)<<32-M:k.i(V+P);return new u(A,k.h)}s.prototype.digest=s.prototype.A,s.prototype.reset=s.prototype.u,s.prototype.update=s.prototype.v,QT=s,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.B,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=p,u.fromString=v,ga=u}).apply(typeof ZS<"u"?ZS:typeof self<"u"?self:typeof window<"u"?window:{});var dd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var YT,Xc,KT,kd,Lp,WT,XT,ZT;(function(){var n,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof dd=="object"&&dd];for(var b=0;b<h.length;++b){var E=h[b];if(E&&E.Math==Math)return E}throw Error("Cannot find global object")}var s=t(this);function a(h,b){if(b)e:{var E=s;h=h.split(".");for(var j=0;j<h.length-1;j++){var te=h[j];if(!(te in E))break e;E=E[te]}h=h[h.length-1],j=E[h],b=b(j),b!=j&&b!=null&&e(E,h,{configurable:!0,writable:!0,value:b})}}a("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(h){return h||function(b){var E=[],j;for(j in b)Object.prototype.hasOwnProperty.call(b,j)&&E.push([j,b[j]]);return E}});var l=l||{},u=this||self;function g(h){var b=typeof h;return b=="object"&&h!=null||b=="function"}function d(h,b,E){return h.call.apply(h.bind,arguments)}function p(h,b,E){return p=d,p.apply(null,arguments)}function v(h,b){var E=Array.prototype.slice.call(arguments,1);return function(){var j=E.slice();return j.push.apply(j,arguments),h.apply(this,j)}}function _(h,b){function E(){}E.prototype=b.prototype,h.Z=b.prototype,h.prototype=new E,h.prototype.constructor=h,h.Ob=function(j,te,ce){for(var Re=Array(arguments.length-2),it=2;it<arguments.length;it++)Re[it-2]=arguments[it];return b.prototype[te].apply(j,Re)}}var S=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function C(h){const b=h.length;if(b>0){const E=Array(b);for(let j=0;j<b;j++)E[j]=h[j];return E}return[]}function O(h,b){for(let j=1;j<arguments.length;j++){const te=arguments[j];var E=typeof te;if(E=E!="object"?E:te?Array.isArray(te)?"array":E:"null",E=="array"||E=="object"&&typeof te.length=="number"){E=h.length||0;const ce=te.length||0;h.length=E+ce;for(let Re=0;Re<ce;Re++)h[E+Re]=te[Re]}else h.push(te)}}class L{constructor(b,E){this.i=b,this.j=E,this.h=0,this.g=null}get(){let b;return this.h>0?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function U(h){u.setTimeout(()=>{throw h},0)}function z(){var h=k;let b=null;return h.g&&(b=h.g,h.g=h.g.next,h.g||(h.h=null),b.next=null),b}class X{constructor(){this.h=this.g=null}add(b,E){const j=q.get();j.set(b,E),this.h?this.h.next=j:this.g=j,this.h=j}}var q=new L(()=>new ne,h=>h.reset());class ne{constructor(){this.next=this.g=this.h=null}set(b,E){this.h=b,this.g=E,this.next=null}reset(){this.next=this.g=this.h=null}}let ee,de=!1,k=new X,M=()=>{const h=Promise.resolve(void 0);ee=()=>{h.then(P)}};function P(){for(var h;h=z();){try{h.h.call(h.g)}catch(E){U(E)}var b=q;b.j(h),b.h<100&&(b.h++,h.next=b.g,b.g=h)}de=!1}function x(){this.u=this.u,this.C=this.C}x.prototype.u=!1,x.prototype.dispose=function(){this.u||(this.u=!0,this.N())},x.prototype[Symbol.dispose]=function(){this.dispose()},x.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function A(h,b){this.type=h,this.g=this.target=b,this.defaultPrevented=!1}A.prototype.h=function(){this.defaultPrevented=!0};var V=(function(){if(!u.addEventListener||!Object.defineProperty)return!1;var h=!1,b=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const E=()=>{};u.addEventListener("test",E,b),u.removeEventListener("test",E,b)}catch{}return h})();function N(h){return/^[\s\xa0]*$/.test(h)}function fe(h,b){A.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,b)}_(fe,A),fe.prototype.init=function(h,b){const E=this.type=h.type,j=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=b,b=h.relatedTarget,b||(E=="mouseover"?b=h.fromElement:E=="mouseout"&&(b=h.toElement)),this.relatedTarget=b,j?(this.clientX=j.clientX!==void 0?j.clientX:j.pageX,this.clientY=j.clientY!==void 0?j.clientY:j.pageY,this.screenX=j.screenX||0,this.screenY=j.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&fe.Z.h.call(this)},fe.prototype.h=function(){fe.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var F="closure_listenable_"+(Math.random()*1e6|0),D=0;function $(h,b,E,j,te){this.listener=h,this.proxy=null,this.src=b,this.type=E,this.capture=!!j,this.ha=te,this.key=++D,this.da=this.fa=!1}function Q(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function J(h,b,E){for(const j in h)b.call(E,h[j],j,h)}function Y(h,b){for(const E in h)b.call(void 0,h[E],E,h)}function I(h){const b={};for(const E in h)b[E]=h[E];return b}const B="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function K(h,b){let E,j;for(let te=1;te<arguments.length;te++){j=arguments[te];for(E in j)h[E]=j[E];for(let ce=0;ce<B.length;ce++)E=B[ce],Object.prototype.hasOwnProperty.call(j,E)&&(h[E]=j[E])}}function le(h){this.src=h,this.g={},this.h=0}le.prototype.add=function(h,b,E,j,te){const ce=h.toString();h=this.g[ce],h||(h=this.g[ce]=[],this.h++);const Re=Ee(h,b,j,te);return Re>-1?(b=h[Re],E||(b.fa=!1)):(b=new $(b,this.src,ce,!!j,te),b.fa=E,h.push(b)),b};function we(h,b){const E=b.type;if(E in h.g){var j=h.g[E],te=Array.prototype.indexOf.call(j,b,void 0),ce;(ce=te>=0)&&Array.prototype.splice.call(j,te,1),ce&&(Q(b),h.g[E].length==0&&(delete h.g[E],h.h--))}}function Ee(h,b,E,j){for(let te=0;te<h.length;++te){const ce=h[te];if(!ce.da&&ce.listener==b&&ce.capture==!!E&&ce.ha==j)return te}return-1}var Se="closure_lm_"+(Math.random()*1e6|0),Me={};function ke(h,b,E,j,te){if(Array.isArray(b)){for(let ce=0;ce<b.length;ce++)ke(h,b[ce],E,j,te);return null}return E=Ce(E),h&&h[F]?h.J(b,E,g(j)?!!j.capture:!1,te):Ae(h,b,E,!1,j,te)}function Ae(h,b,E,j,te,ce){if(!b)throw Error("Invalid event type");const Re=g(te)?!!te.capture:!!te;let it=Te(h);if(it||(h[Se]=it=new le(h)),E=it.add(b,E,j,Re,ce),E.proxy)return E;if(j=De(),E.proxy=j,j.src=h,j.listener=E,h.addEventListener)V||(te=Re),te===void 0&&(te=!1),h.addEventListener(b.toString(),j,te);else if(h.attachEvent)h.attachEvent(he(b.toString()),j);else if(h.addListener&&h.removeListener)h.addListener(j);else throw Error("addEventListener and attachEvent are unavailable.");return E}function De(){function h(E){return b.call(h.src,h.listener,E)}const b=oe;return h}function ze(h,b,E,j,te){if(Array.isArray(b))for(var ce=0;ce<b.length;ce++)ze(h,b[ce],E,j,te);else j=g(j)?!!j.capture:!!j,E=Ce(E),h&&h[F]?(h=h.i,ce=String(b).toString(),ce in h.g&&(b=h.g[ce],E=Ee(b,E,j,te),E>-1&&(Q(b[E]),Array.prototype.splice.call(b,E,1),b.length==0&&(delete h.g[ce],h.h--)))):h&&(h=Te(h))&&(b=h.g[b.toString()],h=-1,b&&(h=Ee(b,E,j,te)),(E=h>-1?b[h]:null)&&G(E))}function G(h){if(typeof h!="number"&&h&&!h.da){var b=h.src;if(b&&b[F])we(b.i,h);else{var E=h.type,j=h.proxy;b.removeEventListener?b.removeEventListener(E,j,h.capture):b.detachEvent?b.detachEvent(he(E),j):b.addListener&&b.removeListener&&b.removeListener(j),(E=Te(b))?(we(E,h),E.h==0&&(E.src=null,b[Se]=null)):Q(h)}}}function he(h){return h in Me?Me[h]:Me[h]="on"+h}function oe(h,b){if(h.da)h=!0;else{b=new fe(b,this);const E=h.listener,j=h.ha||h.src;h.fa&&G(h),h=E.call(j,b)}return h}function Te(h){return h=h[Se],h instanceof le?h:null}var be="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ce(h){return typeof h=="function"?h:(h[be]||(h[be]=function(b){return h.handleEvent(b)}),h[be])}function ae(){x.call(this),this.i=new le(this),this.M=this,this.G=null}_(ae,x),ae.prototype[F]=!0,ae.prototype.removeEventListener=function(h,b,E,j){ze(this,h,b,E,j)};function Ne(h,b){var E,j=h.G;if(j)for(E=[];j;j=j.G)E.push(j);if(h=h.M,j=b.type||b,typeof b=="string")b=new A(b,h);else if(b instanceof A)b.target=b.target||h;else{var te=b;b=new A(j,h),K(b,te)}te=!0;let ce,Re;if(E)for(Re=E.length-1;Re>=0;Re--)ce=b.g=E[Re],te=We(ce,j,!0,b)&&te;if(ce=b.g=h,te=We(ce,j,!0,b)&&te,te=We(ce,j,!1,b)&&te,E)for(Re=0;Re<E.length;Re++)ce=b.g=E[Re],te=We(ce,j,!1,b)&&te}ae.prototype.N=function(){if(ae.Z.N.call(this),this.i){var h=this.i;for(const b in h.g){const E=h.g[b];for(let j=0;j<E.length;j++)Q(E[j]);delete h.g[b],h.h--}}this.G=null},ae.prototype.J=function(h,b,E,j){return this.i.add(String(h),b,!1,E,j)},ae.prototype.K=function(h,b,E,j){return this.i.add(String(h),b,!0,E,j)};function We(h,b,E,j){if(b=h.i.g[String(b)],!b)return!0;b=b.concat();let te=!0;for(let ce=0;ce<b.length;++ce){const Re=b[ce];if(Re&&!Re.da&&Re.capture==E){const it=Re.listener,yn=Re.ha||Re.src;Re.fa&&we(h.i,Re),te=it.call(yn,j)!==!1&&te}}return te&&!j.defaultPrevented}function St(h,b){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=p(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(b)>2147483647?-1:u.setTimeout(h,b||0)}function tn(h){h.g=St(()=>{h.g=null,h.i&&(h.i=!1,tn(h))},h.l);const b=h.h;h.h=null,h.m.apply(null,b)}class xt extends x{constructor(b,E){super(),this.m=b,this.l=E,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:tn(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Tt(h){x.call(this),this.h=h,this.g={}}_(Tt,x);var wt=[];function Bt(h){J(h.g,function(b,E){this.g.hasOwnProperty(E)&&G(b)},h),h.g={}}Tt.prototype.N=function(){Tt.Z.N.call(this),Bt(this)},Tt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Wt=u.JSON.stringify,un=u.JSON.parse,ci=class{stringify(h){return u.JSON.stringify(h,void 0)}parse(h){return u.JSON.parse(h,void 0)}};function Pe(){}function Ze(){}var at={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Xe(){A.call(this,"d")}_(Xe,A);function Xt(){A.call(this,"c")}_(Xt,A);var lt={},kn=null;function Qt(){return kn=kn||new ae}lt.Ia="serverreachability";function xe(h){A.call(this,lt.Ia,h)}_(xe,A);function Be(h){const b=Qt();Ne(b,new xe(b))}lt.STAT_EVENT="statevent";function ct(h,b){A.call(this,lt.STAT_EVENT,h),this.stat=b}_(ct,A);function $e(h){const b=Qt();Ne(b,new ct(b,h))}lt.Ja="timingevent";function ve(h,b){A.call(this,lt.Ja,h),this.size=b}_(ve,A);function Oe(h,b){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){h()},b)}function Le(){this.g=!0}Le.prototype.ua=function(){this.g=!1};function ut(h,b,E,j,te,ce){h.info(function(){if(h.g)if(ce){var Re="",it=ce.split("&");for(let Dt=0;Dt<it.length;Dt++){var yn=it[Dt].split("=");if(yn.length>1){const nn=yn[0];yn=yn[1];const Ui=nn.split("_");Re=Ui.length>=2&&Ui[1]=="type"?Re+(nn+"="+yn+"&"):Re+(nn+"=redacted&")}}}else Re=null;else Re=ce;return"XMLHTTP REQ ("+j+") [attempt "+te+"]: "+b+`
`+E+`
`+Re})}function pn(h,b,E,j,te,ce,Re){h.info(function(){return"XMLHTTP RESP ("+j+") [ attempt "+te+"]: "+b+`
`+E+`
`+ce+" "+Re})}function He(h,b,E,j){h.info(function(){return"XMLHTTP TEXT ("+b+"): "+Ot(h,E)+(j?" "+j:"")})}function mt(h,b){h.info(function(){return"TIMEOUT: "+b})}Le.prototype.info=function(){};function Ot(h,b){if(!h.g)return b;if(!b)return null;try{const ce=JSON.parse(b);if(ce){for(h=0;h<ce.length;h++)if(Array.isArray(ce[h])){var E=ce[h];if(!(E.length<2)){var j=E[1];if(Array.isArray(j)&&!(j.length<1)){var te=j[0];if(te!="noop"&&te!="stop"&&te!="close")for(let Re=1;Re<j.length;Re++)j[Re]=""}}}}return Wt(ce)}catch{return b}}var Ft={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Si={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Xi;function Zi(){}_(Zi,Pe),Zi.prototype.g=function(){return new XMLHttpRequest},Xi=new Zi;function ui(h){return encodeURIComponent(String(h))}function fr(h){var b=1;h=h.split(":");const E=[];for(;b>0&&h.length;)E.push(h.shift()),b--;return h.length&&E.push(h.join(":")),E}function wi(h,b,E,j){this.j=h,this.i=b,this.l=E,this.S=j||1,this.V=new Tt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Pn}function Pn(){this.i=null,this.g="",this.h=!1}var En={},zn={};function mr(h,b,E){h.M=1,h.A=Da(An(b)),h.u=E,h.R=!0,Ao(h,null)}function Ao(h,b){h.F=Date.now(),gr(h),h.B=An(h.A);var E=h.B,j=h.S;Array.isArray(j)||(j=[String(j)]),Io(E.i,"t",j),h.C=0,E=h.j.L,h.h=new Pn,h.g=ih(h.j,E?b:null,!h.u),h.P>0&&(h.O=new xt(p(h.Y,h,h.g),h.P)),b=h.V,E=h.g,j=h.ba;var te="readystatechange";Array.isArray(te)||(te&&(wt[0]=te.toString()),te=wt);for(let ce=0;ce<te.length;ce++){const Re=ke(E,te[ce],j||b.handleEvent,!1,b.h||b);if(!Re)break;b.g[Re.key]=Re}b=h.J?I(h.J):{},h.u?(h.v||(h.v="POST"),b["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,b)):(h.v="GET",h.g.ea(h.B,h.v,null,b)),Be(),ut(h.i,h.v,h.B,h.l,h.S,h.u)}wi.prototype.ba=function(h){h=h.target;const b=this.O;b&&tr(h)==3?b.j():this.Y(h)},wi.prototype.Y=function(h){try{if(h==this.g)e:{const it=tr(this.g),yn=this.g.ya(),Dt=this.g.ca();if(!(it<3)&&(it!=3||this.g&&(this.h.h||this.g.la()||$n(this.g)))){this.K||it!=4||yn==7||(yn==8||Dt<=0?Be(3):Be(2)),pr(this);var b=this.g.ca();this.X=b;var E=Yf(this);if(this.o=b==200,pn(this.i,this.v,this.B,this.l,this.S,it,b),this.o){if(this.U&&!this.L){t:{if(this.g){var j,te=this.g;if((j=te.g?te.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!N(j)){var ce=j;break t}}ce=null}if(h=ce)He(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,yr(this,h);else{this.o=!1,this.m=3,$e(12),Ei(this),Pi(this);break e}}if(this.R){h=!0;let nn;for(;!this.K&&this.C<E.length;)if(nn=qu(this,E),nn==zn){it==4&&(this.m=4,$e(14),h=!1),He(this.i,this.l,null,"[Incomplete Response]");break}else if(nn==En){this.m=4,$e(15),He(this.i,this.l,E,"[Invalid Chunk]"),h=!1;break}else He(this.i,this.l,nn,null),yr(this,nn);if(Hu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),it!=4||E.length!=0||this.h.h||(this.m=1,$e(16),h=!1),this.o=this.o&&h,!h)He(this.i,this.l,E,"[Invalid Chunked Response]"),Ei(this),Pi(this);else if(E.length>0&&!this.W){this.W=!0;var Re=this.j;Re.g==this&&Re.aa&&!Re.P&&(Re.j.info("Great, no buffering proxy detected. Bytes received: "+E.length),sc(Re),Re.P=!0,$e(11))}}else He(this.i,this.l,E,null),yr(this,E);it==4&&Ei(this),this.o&&!this.K&&(it==4?Ju(this.j,this):(this.o=!1,gr(this)))}else Qr(this.g),b==400&&E.indexOf("Unknown SID")>0?(this.m=3,$e(12)):(this.m=0,$e(13)),Ei(this),Pi(this)}}}catch{}finally{}};function Yf(h){if(!Hu(h))return h.g.la();const b=$n(h.g);if(b==="")return"";let E="";const j=b.length,te=tr(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return Ei(h),Pi(h),"";h.h.i=new u.TextDecoder}for(let ce=0;ce<j;ce++)h.h.h=!0,E+=h.h.i.decode(b[ce],{stream:!(te&&ce==j-1)});return b.length=0,h.h.g+=E,h.C=0,h.h.g}function Hu(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function qu(h,b){var E=h.C,j=b.indexOf(`
`,E);return j==-1?zn:(E=Number(b.substring(E,j)),isNaN(E)?En:(j+=1,j+E>b.length?zn:(b=b.slice(j,j+E),h.C=j+E,b)))}wi.prototype.cancel=function(){this.K=!0,Ei(this)};function gr(h){h.T=Date.now()+h.H,Co(h,h.H)}function Co(h,b){if(h.D!=null)throw Error("WatchDog timer not null");h.D=Oe(p(h.aa,h),b)}function pr(h){h.D&&(u.clearTimeout(h.D),h.D=null)}wi.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(mt(this.i,this.B),this.M!=2&&(Be(),$e(17)),Ei(this),this.m=2,Pi(this)):Co(this,this.T-h)};function Pi(h){h.j.I==0||h.K||Ju(h.j,h)}function Ei(h){pr(h);var b=h.O;b&&typeof b.dispose=="function"&&b.dispose(),h.O=null,Bt(h.V),h.g&&(b=h.g,h.g=null,b.abort(),b.dispose())}function yr(h,b){try{var E=h.j;if(E.I!=0&&(E.g==h||_r(E.h,h))){if(!h.L&&_r(E.h,h)&&E.I==3){try{var j=E.Ba.g.parse(b)}catch{j=null}if(Array.isArray(j)&&j.length==3){var te=j;if(te[0]==0){e:if(!E.v){if(E.g)if(E.g.F+3e3<h.F)jo(E),Ds(E);else break e;La(E),$e(18)}}else E.xa=te[1],0<E.xa-E.K&&te[2]<37500&&E.F&&E.A==0&&!E.C&&(E.C=Oe(p(E.Va,E),6e3));vr(E.h)<=1&&E.ta&&(E.ta=void 0)}else Ar(E,11)}else if((h.L||E.g==h)&&jo(E),!N(b))for(te=E.Ba.g.parse(b),b=0;b<te.length;b++){let Dt=te[b];const nn=Dt[0];if(!(nn<=E.K))if(E.K=nn,Dt=Dt[1],E.I==2)if(Dt[0]=="c"){E.M=Dt[1],E.ba=Dt[2];const Ui=Dt[3];Ui!=null&&(E.ka=Ui,E.j.info("VER="+E.ka));const Cr=Dt[4];Cr!=null&&(E.za=Cr,E.j.info("SVER="+E.za));const nr=Dt[5];nr!=null&&typeof nr=="number"&&nr>0&&(j=1.5*nr,E.O=j,E.j.info("backChannelRequestTimeoutMs_="+j)),j=E;const ir=h.g;if(ir){const Ua=ir.g?ir.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ua){var ce=j.h;ce.g||Ua.indexOf("spdy")==-1&&Ua.indexOf("quic")==-1&&Ua.indexOf("h2")==-1||(ce.j=ce.l,ce.g=new Set,ce.h&&(Ql(ce,ce.h),ce.h=null))}if(j.G){const ko=ir.g?ir.g.getResponseHeader("X-HTTP-Session-Id"):null;ko&&(j.wa=ko,Vt(j.J,j.G,ko))}}E.I=3,E.l&&E.l.ra(),E.aa&&(E.T=Date.now()-h.F,E.j.info("Handshake RTT: "+E.T+"ms")),j=E;var Re=h;if(j.na=nh(j,j.L?j.ba:null,j.W),Re.L){Yl(j.h,Re);var it=Re,yn=j.O;yn&&(it.H=yn),it.D&&(pr(it),gr(it)),j.g=Re}else Xu(j);E.i.length>0&&Tr(E)}else Dt[0]!="stop"&&Dt[0]!="close"||Ar(E,7);else E.I==3&&(Dt[0]=="stop"||Dt[0]=="close"?Dt[0]=="stop"?Ar(E,7):ic(E):Dt[0]!="noop"&&E.l&&E.l.qa(Dt),E.A=0)}}Be(4)}catch{}}var Tn=class{constructor(h,b){this.g=h,this.map=b}};function Gl(h){this.l=h||10,u.PerformanceNavigationTiming?(h=u.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function $l(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function vr(h){return h.h?1:h.g?h.g.size:0}function _r(h,b){return h.h?h.h==b:h.g?h.g.has(b):!1}function Ql(h,b){h.g?h.g.add(b):h.h=b}function Yl(h,b){h.h&&h.h==b?h.h=null:h.g&&h.g.has(b)&&h.g.delete(b)}Gl.prototype.cancel=function(){if(this.i=Kl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Kl(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let b=h.i;for(const E of h.g.values())b=b.concat(E.G);return b}return C(h.i)}var Gu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function xo(h,b){if(h){h=h.split("&");for(let E=0;E<h.length;E++){const j=h[E].indexOf("=");let te,ce=null;j>=0?(te=h[E].substring(0,j),ce=h[E].substring(j+1)):te=h[E],b(te,ce?decodeURIComponent(ce.replace(/\+/g," ")):"")}}}function Ti(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let b;h instanceof Ti?(this.l=h.l,Bn(this,h.j),this.o=h.o,this.g=h.g,Ts(this,h.u),this.h=h.h,Wl(this,Ku(h.i)),this.m=h.m):h&&(b=String(h).match(Gu))?(this.l=!1,Bn(this,b[1]||"",!0),this.o=br(b[2]||""),this.g=br(b[3]||"",!0),Ts(this,b[4]),this.h=br(b[5]||"",!0),Wl(this,b[6]||"",!0),this.m=br(b[7]||"")):(this.l=!1,this.i=new Cs(null,this.l))}Ti.prototype.toString=function(){const h=[];var b=this.j;b&&h.push(Ma(b,Ro,!0),":");var E=this.g;return(E||b=="file")&&(h.push("//"),(b=this.o)&&h.push(Ma(b,Ro,!0),"@"),h.push(ui(E).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E=this.u,E!=null&&h.push(":",String(E))),(E=this.h)&&(this.g&&E.charAt(0)!="/"&&h.push("/"),h.push(Ma(E,E.charAt(0)=="/"?Xl:$u,!0))),(E=this.i.toString())&&h.push("?",E),(E=this.m)&&h.push("#",Ma(E,Qu)),h.join("")},Ti.prototype.resolve=function(h){const b=An(this);let E=!!h.j;E?Bn(b,h.j):E=!!h.o,E?b.o=h.o:E=!!h.g,E?b.g=h.g:E=h.u!=null;var j=h.h;if(E)Ts(b,h.u);else if(E=!!h.h){if(j.charAt(0)!="/")if(this.g&&!this.h)j="/"+j;else{var te=b.h.lastIndexOf("/");te!=-1&&(j=b.h.slice(0,te+1)+j)}if(te=j,te==".."||te==".")j="";else if(te.indexOf("./")!=-1||te.indexOf("/.")!=-1){j=te.lastIndexOf("/",0)==0,te=te.split("/");const ce=[];for(let Re=0;Re<te.length;){const it=te[Re++];it=="."?j&&Re==te.length&&ce.push(""):it==".."?((ce.length>1||ce.length==1&&ce[0]!="")&&ce.pop(),j&&Re==te.length&&ce.push("")):(ce.push(it),j=!0)}j=ce.join("/")}else j=te}return E?b.h=j:E=h.i.toString()!=="",E?Wl(b,Ku(h.i)):E=!!h.m,E&&(b.m=h.m),b};function An(h){return new Ti(h)}function Bn(h,b,E){h.j=E?br(b,!0):b,h.j&&(h.j=h.j.replace(/:$/,""))}function Ts(h,b){if(b){if(b=Number(b),isNaN(b)||b<0)throw Error("Bad port number "+b);h.u=b}else h.u=null}function Wl(h,b,E){b instanceof Cs?(h.i=b,No(h.i,h.l)):(E||(b=Ma(b,As)),h.i=new Cs(b,h.l))}function Vt(h,b,E){h.i.set(b,E)}function Da(h){return Vt(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function br(h,b){return h?b?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Ma(h,b,E){return typeof h=="string"?(h=encodeURI(h).replace(b,hi),E&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function hi(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Ro=/[#\/\?@]/g,$u=/[#\?:]/g,Xl=/[#\?]/g,As=/[#\?@]/g,Qu=/#/g;function Cs(h,b){this.h=this.g=null,this.i=h||null,this.j=!!b}function di(h){h.g||(h.g=new Map,h.h=0,h.i&&xo(h.i,function(b,E){h.add(decodeURIComponent(b.replace(/\+/g," ")),E)}))}n=Cs.prototype,n.add=function(h,b){di(this),this.i=null,h=xs(this,h);let E=this.g.get(h);return E||this.g.set(h,E=[]),E.push(b),this.h+=1,this};function Yu(h,b){di(h),b=xs(h,b),h.g.has(b)&&(h.i=null,h.h-=h.g.get(b).length,h.g.delete(b))}function Zl(h,b){return di(h),b=xs(h,b),h.g.has(b)}n.forEach=function(h,b){di(this),this.g.forEach(function(E,j){E.forEach(function(te){h.call(b,te,j,this)},this)},this)};function Jl(h,b){di(h);let E=[];if(typeof b=="string")Zl(h,b)&&(E=E.concat(h.g.get(xs(h,b))));else for(h=Array.from(h.g.values()),b=0;b<h.length;b++)E=E.concat(h[b]);return E}n.set=function(h,b){return di(this),this.i=null,h=xs(this,h),Zl(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[b]),this.h+=1,this},n.get=function(h,b){return h?(h=Jl(this,h),h.length>0?String(h[0]):b):b};function Io(h,b,E){Yu(h,b),E.length>0&&(h.i=null,h.g.set(xs(h,b),C(E)),h.h+=E.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],b=Array.from(this.g.keys());for(let j=0;j<b.length;j++){var E=b[j];const te=ui(E);E=Jl(this,E);for(let ce=0;ce<E.length;ce++){let Re=te;E[ce]!==""&&(Re+="="+ui(E[ce])),h.push(Re)}}return this.i=h.join("&")};function Ku(h){const b=new Cs;return b.i=h.i,h.g&&(b.g=new Map(h.g),b.h=h.h),b}function xs(h,b){return b=String(b),h.j&&(b=b.toLowerCase()),b}function No(h,b){b&&!h.j&&(di(h),h.i=null,h.g.forEach(function(E,j){const te=j.toLowerCase();j!=te&&(Yu(this,j),Io(this,te,E))},h)),h.j=b}function Ji(h,b){const E=new Le;if(u.Image){const j=new Image;j.onload=v(Vi,E,"TestLoadImage: loaded",!0,b,j),j.onerror=v(Vi,E,"TestLoadImage: error",!1,b,j),j.onabort=v(Vi,E,"TestLoadImage: abort",!1,b,j),j.ontimeout=v(Vi,E,"TestLoadImage: timeout",!1,b,j),u.setTimeout(function(){j.ontimeout&&j.ontimeout()},1e4),j.src=h}else b(!1)}function ec(h,b){const E=new Le,j=new AbortController,te=setTimeout(()=>{j.abort(),Vi(E,"TestPingServer: timeout",!1,b)},1e4);fetch(h,{signal:j.signal}).then(ce=>{clearTimeout(te),ce.ok?Vi(E,"TestPingServer: ok",!0,b):Vi(E,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(te),Vi(E,"TestPingServer: error",!1,b)})}function Vi(h,b,E,j,te){try{te&&(te.onload=null,te.onerror=null,te.onabort=null,te.ontimeout=null),j(E)}catch{}}function Rs(){this.g=new ci}function Sr(h){this.i=h.Sb||null,this.h=h.ab||!1}_(Sr,Pe),Sr.prototype.g=function(){return new Oa(this.i,this.h)};function Oa(h,b){ae.call(this),this.H=h,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}_(Oa,ae),n=Oa.prototype,n.open=function(h,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=b,this.readyState=1,er(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const b={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(b.body=h),(this.H||u).fetch(new Request(this.D,b)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Is(this)),this.readyState=0},n.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,er(this)),this.g&&(this.readyState=3,er(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Do(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function Do(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}n.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var b=h.value?h.value:new Uint8Array(0);(b=this.B.decode(b,{stream:!h.done}))&&(this.response=this.responseText+=b)}h.done?Is(this):er(this),this.readyState==3&&Do(this)}},n.Oa=function(h){this.g&&(this.response=this.responseText=h,Is(this))},n.Na=function(h){this.g&&(this.response=h,Is(this))},n.ga=function(){this.g&&Is(this)};function Is(h){h.readyState=4,h.l=null,h.j=null,h.B=null,er(h)}n.setRequestHeader=function(h,b){this.A.append(h,b)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],b=this.h.entries();for(var E=b.next();!E.done;)E=E.value,h.push(E[0]+": "+E[1]),E=b.next();return h.join(`\r
`)};function er(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Oa.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Li(h){let b="";return J(h,function(E,j){b+=j,b+=":",b+=E,b+=`\r
`}),b}function ja(h,b,E){e:{for(j in E){var j=!1;break e}j=!0}j||(E=Li(E),typeof h=="string"?E!=null&&ui(E):Vt(h,b,E))}function Ht(h){ae.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}_(Ht,ae);var wr=/^https?$/i,tc=["POST","PUT"];n=Ht.prototype,n.Fa=function(h){this.H=h},n.ea=function(h,b,E,j){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);b=b?b.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Xi.g(),this.g.onreadystatechange=S(p(this.Ca,this));try{this.B=!0,this.g.open(b,String(h),!0),this.B=!1}catch(ce){ka(this,ce);return}if(h=E||"",E=new Map(this.headers),j)if(Object.getPrototypeOf(j)===Object.prototype)for(var te in j)E.set(te,j[te]);else if(typeof j.keys=="function"&&typeof j.get=="function")for(const ce of j.keys())E.set(ce,j.get(ce));else throw Error("Unknown input type for opt_headers: "+String(j));j=Array.from(E.keys()).find(ce=>ce.toLowerCase()=="content-type"),te=u.FormData&&h instanceof u.FormData,!(Array.prototype.indexOf.call(tc,b,void 0)>=0)||j||te||E.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ce,Re]of E)this.g.setRequestHeader(ce,Re);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(ce){ka(this,ce)}};function ka(h,b){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=b,h.o=5,nc(h),$r(h)}function nc(h){h.A||(h.A=!0,Ne(h,"complete"),Ne(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,Ne(this,"complete"),Ne(this,"abort"),$r(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),$r(this,!0)),Ht.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Pa(this):this.Xa())},n.Xa=function(){Pa(this)};function Pa(h){if(h.h&&typeof l<"u"){if(h.v&&tr(h)==4)setTimeout(h.Ca.bind(h),0);else if(Ne(h,"readystatechange"),tr(h)==4){h.h=!1;try{const ce=h.ca();e:switch(ce){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var E;if(!(E=b)){var j;if(j=ce===0){let Re=String(h.D).match(Gu)[1]||null;!Re&&u.self&&u.self.location&&(Re=u.self.location.protocol.slice(0,-1)),j=!wr.test(Re?Re.toLowerCase():"")}E=j}if(E)Ne(h,"complete"),Ne(h,"success");else{h.o=6;try{var te=tr(h)>2?h.g.statusText:""}catch{te=""}h.l=te+" ["+h.ca()+"]",nc(h)}}finally{$r(h)}}}}function $r(h,b){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const E=h.g;h.g=null,b||Ne(h,"ready");try{E.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function tr(h){return h.g?h.g.readyState:0}n.ca=function(){try{return tr(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(h){if(this.g){var b=this.g.responseText;return h&&b.indexOf(h)==0&&(b=b.substring(h.length)),un(b)}};function $n(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function Qr(h){const b={};h=(h.g&&tr(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let j=0;j<h.length;j++){if(N(h[j]))continue;var E=fr(h[j]);const te=E[0];if(E=E[1],typeof E!="string")continue;E=E.trim();const ce=b[te]||[];b[te]=ce,ce.push(E)}Y(b,function(j){return j.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Er(h,b,E){return E&&E.internalChannelParams&&E.internalChannelParams[h]||b}function Ns(h){this.za=0,this.i=[],this.j=new Le,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Er("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Er("baseRetryDelayMs",5e3,h),this.Za=Er("retryDelaySeedMs",1e4,h),this.Ta=Er("forwardChannelMaxRetries",2,h),this.va=Er("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new Gl(h&&h.concurrentRequestLimit),this.Ba=new Rs,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Ns.prototype,n.ka=8,n.I=1,n.connect=function(h,b,E,j){$e(0),this.W=h,this.H=b||{},E&&j!==void 0&&(this.H.OSID=E,this.H.OAID=j),this.F=this.X,this.J=nh(this,null,this.W),Tr(this)};function ic(h){if(Mo(h),h.I==3){var b=h.V++,E=An(h.J);if(Vt(E,"SID",h.M),Vt(E,"RID",b),Vt(E,"TYPE","terminate"),Va(h,E),b=new wi(h,h.j,b),b.M=2,b.A=Da(An(E)),E=!1,u.navigator&&u.navigator.sendBeacon)try{E=u.navigator.sendBeacon(b.A.toString(),"")}catch{}!E&&u.Image&&(new Image().src=b.A,E=!0),E||(b.g=ih(b.j,null),b.g.ea(b.A)),b.F=Date.now(),gr(b)}th(h)}function Ds(h){h.g&&(sc(h),h.g.cancel(),h.g=null)}function Mo(h){Ds(h),h.v&&(u.clearTimeout(h.v),h.v=null),jo(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&u.clearTimeout(h.m),h.m=null)}function Tr(h){if(!$l(h.h)&&!h.m){h.m=!0;var b=h.Ea;ee||M(),de||(ee(),de=!0),k.add(b,h),h.D=0}}function Oo(h,b){return vr(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=b.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=Oe(p(h.Ea,h,b),eh(h,h.D)),h.D++,!0)}n.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const te=new wi(this,this.j,h);let ce=this.o;if(this.U&&(ce?(ce=I(ce),K(ce,this.U)):ce=this.U),this.u!==null||this.R||(te.J=ce,ce=null),this.S)e:{for(var b=0,E=0;E<this.i.length;E++){t:{var j=this.i[E];if("__data__"in j.map&&(j=j.map.__data__,typeof j=="string")){j=j.length;break t}j=void 0}if(j===void 0)break;if(b+=j,b>4096){b=E;break e}if(b===4096||E===this.i.length-1){b=E+1;break e}}b=1e3}else b=1e3;b=Wu(this,te,b),E=An(this.J),Vt(E,"RID",h),Vt(E,"CVER",22),this.G&&Vt(E,"X-HTTP-Session-Id",this.G),Va(this,E),ce&&(this.R?b="headers="+ui(Li(ce))+"&"+b:this.u&&ja(E,this.u,ce)),Ql(this.h,te),this.Ra&&Vt(E,"TYPE","init"),this.S?(Vt(E,"$req",b),Vt(E,"SID","null"),te.U=!0,mr(te,E,null)):mr(te,E,b),this.I=2}}else this.I==3&&(h?rc(this,h):this.i.length==0||$l(this.h)||rc(this))};function rc(h,b){var E;b?E=b.l:E=h.V++;const j=An(h.J);Vt(j,"SID",h.M),Vt(j,"RID",E),Vt(j,"AID",h.K),Va(h,j),h.u&&h.o&&ja(j,h.u,h.o),E=new wi(h,h.j,E,h.D+1),h.u===null&&(E.J=h.o),b&&(h.i=b.G.concat(h.i)),b=Wu(h,E,1e3),E.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),Ql(h.h,E),mr(E,j,b)}function Va(h,b){h.H&&J(h.H,function(E,j){Vt(b,j,E)}),h.l&&J({},function(E,j){Vt(b,j,E)})}function Wu(h,b,E){E=Math.min(h.i.length,E);const j=h.l?p(h.l.Ka,h.l,h):null;e:{var te=h.i;let it=-1;for(;;){const yn=["count="+E];it==-1?E>0?(it=te[0].g,yn.push("ofs="+it)):it=0:yn.push("ofs="+it);let Dt=!0;for(let nn=0;nn<E;nn++){var ce=te[nn].g;const Ui=te[nn].map;if(ce-=it,ce<0)it=Math.max(0,te[nn].g-100),Dt=!1;else try{ce="req"+ce+"_"||"";try{var Re=Ui instanceof Map?Ui:Object.entries(Ui);for(const[Cr,nr]of Re){let ir=nr;g(nr)&&(ir=Wt(nr)),yn.push(ce+Cr+"="+encodeURIComponent(ir))}}catch(Cr){throw yn.push(ce+"type="+encodeURIComponent("_badmap")),Cr}}catch{j&&j(Ui)}}if(Dt){Re=yn.join("&");break e}}Re=void 0}return h=h.i.splice(0,E),b.G=h,Re}function Xu(h){if(!h.g&&!h.v){h.Y=1;var b=h.Da;ee||M(),de||(ee(),de=!0),k.add(b,h),h.A=0}}function La(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=Oe(p(h.Da,h),eh(h,h.A)),h.A++,!0)}n.Da=function(){if(this.v=null,Zu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=Oe(p(this.Wa,this),h)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,$e(10),Ds(this),Zu(this))};function sc(h){h.B!=null&&(u.clearTimeout(h.B),h.B=null)}function Zu(h){h.g=new wi(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var b=An(h.na);Vt(b,"RID","rpc"),Vt(b,"SID",h.M),Vt(b,"AID",h.K),Vt(b,"CI",h.F?"0":"1"),!h.F&&h.ia&&Vt(b,"TO",h.ia),Vt(b,"TYPE","xmlhttp"),Va(h,b),h.u&&h.o&&ja(b,h.u,h.o),h.O&&(h.g.H=h.O);var E=h.g;h=h.ba,E.M=1,E.A=Da(An(b)),E.u=null,E.R=!0,Ao(E,h)}n.Va=function(){this.C!=null&&(this.C=null,Ds(this),La(this),$e(19))};function jo(h){h.C!=null&&(u.clearTimeout(h.C),h.C=null)}function Ju(h,b){var E=null;if(h.g==b){jo(h),sc(h),h.g=null;var j=2}else if(_r(h.h,b))E=b.G,Yl(h.h,b),j=1;else return;if(h.I!=0){if(b.o)if(j==1){E=b.u?b.u.length:0,b=Date.now()-b.F;var te=h.D;j=Qt(),Ne(j,new ve(j,E)),Tr(h)}else Xu(h);else if(te=b.m,te==3||te==0&&b.X>0||!(j==1&&Oo(h,b)||j==2&&La(h)))switch(E&&E.length>0&&(b=h.h,b.i=b.i.concat(E)),te){case 1:Ar(h,5);break;case 4:Ar(h,10);break;case 3:Ar(h,6);break;default:Ar(h,2)}}}function eh(h,b){let E=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(E*=2),E*b}function Ar(h,b){if(h.j.info("Error code "+b),b==2){var E=p(h.bb,h),j=h.Ua;const te=!j;j=new Ti(j||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Bn(j,"https"),Da(j),te?Ji(j.toString(),E):ec(j.toString(),E)}else $e(2);h.I=0,h.l&&h.l.pa(b),th(h),Mo(h)}n.bb=function(h){h?(this.j.info("Successfully pinged google.com"),$e(2)):(this.j.info("Failed to ping google.com"),$e(1))};function th(h){if(h.I=0,h.ja=[],h.l){const b=Kl(h.h);(b.length!=0||h.i.length!=0)&&(O(h.ja,b),O(h.ja,h.i),h.h.i.length=0,C(h.i),h.i.length=0),h.l.oa()}}function nh(h,b,E){var j=E instanceof Ti?An(E):new Ti(E);if(j.g!="")b&&(j.g=b+"."+j.g),Ts(j,j.u);else{var te=u.location;j=te.protocol,b=b?b+"."+te.hostname:te.hostname,te=+te.port;const ce=new Ti(null);j&&Bn(ce,j),b&&(ce.g=b),te&&Ts(ce,te),E&&(ce.h=E),j=ce}return E=h.G,b=h.wa,E&&b&&Vt(j,E,b),Vt(j,"VER",h.ka),Va(h,j),j}function ih(h,b,E){if(b&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return b=h.Aa&&!h.ma?new Ht(new Sr({ab:E})):new Ht(h.ma),b.Fa(h.L),b}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function rh(){}n=rh.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Ms(){}Ms.prototype.g=function(h,b){return new ai(h,b)};function ai(h,b){ae.call(this),this.g=new Ns(b),this.l=h,this.h=b&&b.messageUrlParams||null,h=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(h?h["X-WebChannel-Content-Type"]=b.messageContentType:h={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.sa&&(h?h["X-WebChannel-Client-Profile"]=b.sa:h={"X-WebChannel-Client-Profile":b.sa}),this.g.U=h,(h=b&&b.Qb)&&!N(h)&&(this.g.u=h),this.A=b&&b.supportsCrossDomainXhr||!1,this.v=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!N(b)&&(this.g.G=b,h=this.h,h!==null&&b in h&&(h=this.h,b in h&&delete h[b])),this.j=new Yr(this)}_(ai,ae),ai.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},ai.prototype.close=function(){ic(this.g)},ai.prototype.o=function(h){var b=this.g;if(typeof h=="string"){var E={};E.__data__=h,h=E}else this.v&&(E={},E.__data__=Wt(h),h=E);b.i.push(new Tn(b.Ya++,h)),b.I==3&&Tr(b)},ai.prototype.N=function(){this.g.l=null,delete this.j,ic(this.g),delete this.g,ai.Z.N.call(this)};function sh(h){Xe.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var b=h.__sm__;if(b){e:{for(const E in b){h=E;break e}h=void 0}(this.i=h)&&(h=this.i,b=b!==null&&h in b?b[h]:void 0),this.data=b}else this.data=h}_(sh,Xe);function ah(){Xt.call(this),this.status=1}_(ah,Xt);function Yr(h){this.g=h}_(Yr,rh),Yr.prototype.ra=function(){Ne(this.g,"a")},Yr.prototype.qa=function(h){Ne(this.g,new sh(h))},Yr.prototype.pa=function(h){Ne(this.g,new ah)},Yr.prototype.oa=function(){Ne(this.g,"b")},Ms.prototype.createWebChannel=Ms.prototype.g,ai.prototype.send=ai.prototype.o,ai.prototype.open=ai.prototype.m,ai.prototype.close=ai.prototype.close,ZT=function(){return new Ms},XT=function(){return Qt()},WT=lt,Lp={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Ft.NO_ERROR=0,Ft.TIMEOUT=8,Ft.HTTP_ERROR=6,kd=Ft,Si.COMPLETE="complete",KT=Si,Ze.EventType=at,at.OPEN="a",at.CLOSE="b",at.ERROR="c",at.MESSAGE="d",ae.prototype.listen=ae.prototype.J,Xc=Ze,Ht.prototype.listenOnce=Ht.prototype.K,Ht.prototype.getLastError=Ht.prototype.Ha,Ht.prototype.getLastErrorCode=Ht.prototype.ya,Ht.prototype.getStatus=Ht.prototype.ca,Ht.prototype.getResponseJson=Ht.prototype.La,Ht.prototype.getResponseText=Ht.prototype.la,Ht.prototype.send=Ht.prototype.ea,Ht.prototype.setWithCredentials=Ht.prototype.Fa,YT=Ht}).apply(typeof dd<"u"?dd:typeof self<"u"?self:typeof window<"u"?window:{});const JS="@firebase/firestore",ew="4.9.2";class ni{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ni.UNAUTHENTICATED=new ni(null),ni.GOOGLE_CREDENTIALS=new ni("google-credentials-uid"),ni.FIRST_PARTY=new ni("first-party-uid"),ni.MOCK_USER=new ni("mock-user");let zl="12.3.0";const mo=new Ny("@firebase/firestore");function gl(){return mo.logLevel}function je(n,...e){if(mo.logLevel<=yt.DEBUG){const t=e.map(Fy);mo.debug(`Firestore (${zl}): ${n}`,...t)}}function Ss(n,...e){if(mo.logLevel<=yt.ERROR){const t=e.map(Fy);mo.error(`Firestore (${zl}): ${n}`,...t)}}function Il(n,...e){if(mo.logLevel<=yt.WARN){const t=e.map(Fy);mo.warn(`Firestore (${zl}): ${n}`,...t)}}function Fy(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Ye(n,e,t){let s="Unexpected state";typeof e=="string"?s=e:t=e,JT(n,s,t)}function JT(n,e,t){let s=`FIRESTORE (${zl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{s+=" CONTEXT: "+JSON.stringify(t)}catch{s+=" CONTEXT: "+t}throw Ss(s),new Error(s)}function Pt(n,e,t,s){let a="Unexpected state";typeof t=="string"?a=t:s=t,n||JT(e,a,s)}function nt(n,e){return n}const ge={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ie extends qr{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ys{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class e1{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class GM{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(ni.UNAUTHENTICATED)))}shutdown(){}}class $M{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class QM{constructor(e){this.t=e,this.currentUser=ni.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Pt(this.o===void 0,42304);let s=this.i;const a=d=>this.i!==s?(s=this.i,t(d)):Promise.resolve();let l=new ys;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new ys,e.enqueueRetryable((()=>a(this.currentUser)))};const u=()=>{const d=l;e.enqueueRetryable((async()=>{await d.promise,await a(this.currentUser)}))},g=d=>{je("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit((d=>g(d))),setTimeout((()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?g(d):(je("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new ys)}}),0),u()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((s=>this.i!==e?(je("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(Pt(typeof s.accessToken=="string",31837,{l:s}),new e1(s.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Pt(e===null||typeof e=="string",2055,{h:e}),new ni(e)}}class YM{constructor(e,t,s){this.P=e,this.T=t,this.I=s,this.type="FirstParty",this.user=ni.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class KM{constructor(e,t,s){this.P=e,this.T=t,this.I=s}getToken(){return Promise.resolve(new YM(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(ni.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class tw{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class WM{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ki(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Pt(this.o===void 0,3512);const s=l=>{l.error!=null&&je("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const u=l.token!==this.m;return this.m=l.token,je("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>s(l)))};const a=l=>{je("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):je("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new tw(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Pt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new tw(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function XM(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}class Hy{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const a=XM(40);for(let l=0;l<a.length;++l)s.length<20&&a[l]<t&&(s+=e.charAt(a[l]%62))}return s}}function vt(n,e){return n<e?-1:n>e?1:0}function Up(n,e){const t=Math.min(n.length,e.length);for(let s=0;s<t;s++){const a=n.charAt(s),l=e.charAt(s);if(a!==l)return ip(a)===ip(l)?vt(a,l):ip(a)?1:-1}return vt(n.length,e.length)}const ZM=55296,JM=57343;function ip(n){const e=n.charCodeAt(0);return e>=ZM&&e<=JM}function Nl(n,e,t){return n.length===e.length&&n.every(((s,a)=>t(s,e[a])))}const nw="__name__";class Mr{constructor(e,t,s){t===void 0?t=0:t>e.length&&Ye(637,{offset:t,range:e.length}),s===void 0?s=e.length-t:s>e.length-t&&Ye(1746,{length:s,range:e.length-t}),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return Mr.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Mr?e.forEach((s=>{t.push(s)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let a=0;a<s;a++){const l=Mr.compareSegments(e.get(a),t.get(a));if(l!==0)return l}return vt(e.length,t.length)}static compareSegments(e,t){const s=Mr.isNumericId(e),a=Mr.isNumericId(t);return s&&!a?-1:!s&&a?1:s&&a?Mr.extractNumericId(e).compare(Mr.extractNumericId(t)):Up(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ga.fromString(e.substring(4,e.length-2))}}class Kt extends Mr{construct(e,t,s){return new Kt(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new Ie(ge.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter((a=>a.length>0)))}return new Kt(t)}static emptyPath(){return new Kt([])}}const eO=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Zn extends Mr{construct(e,t,s){return new Zn(e,t,s)}static isValidIdentifier(e){return eO.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Zn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===nw}static keyField(){return new Zn([nw])}static fromServerFormat(e){const t=[];let s="",a=0;const l=()=>{if(s.length===0)throw new Ie(ge.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let u=!1;for(;a<e.length;){const g=e[a];if(g==="\\"){if(a+1===e.length)throw new Ie(ge.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[a+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new Ie(ge.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=d,a+=2}else g==="`"?(u=!u,a++):g!=="."||u?(s+=g,a++):(l(),a++)}if(l(),u)throw new Ie(ge.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Zn(t)}static emptyPath(){return new Zn([])}}class qe{constructor(e){this.path=e}static fromPath(e){return new qe(Kt.fromString(e))}static fromName(e){return new qe(Kt.fromString(e).popFirst(5))}static empty(){return new qe(Kt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Kt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Kt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new qe(new Kt(e.slice()))}}function t1(n,e,t){if(!t)throw new Ie(ge.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function tO(n,e,t,s){if(e===!0&&s===!0)throw new Ie(ge.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function iw(n){if(!qe.isDocumentKey(n))throw new Ie(ge.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function rw(n){if(qe.isDocumentKey(n))throw new Ie(ge.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function n1(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function wf(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(s){return s.constructor?s.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ye(12329,{type:typeof n})}function Fr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ie(ge.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=wf(n);throw new Ie(ge.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function nO(n,e){if(e<=0)throw new Ie(ge.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function On(n,e){const t={typeString:n};return e&&(t.value=e),t}function Ou(n,e){if(!n1(n))throw new Ie(ge.INVALID_ARGUMENT,"JSON must be an object");let t;for(const s in e)if(e[s]){const a=e[s].typeString,l="value"in e[s]?{value:e[s].value}:void 0;if(!(s in n)){t=`JSON missing required field: '${s}'`;break}const u=n[s];if(a&&typeof u!==a){t=`JSON field '${s}' must be a ${a}.`;break}if(l!==void 0&&u!==l.value){t=`Expected '${s}' field to equal '${l.value}'`;break}}if(t)throw new Ie(ge.INVALID_ARGUMENT,t);return!0}const sw=-62135596800,aw=1e6;class en{static now(){return en.fromMillis(Date.now())}static fromDate(e){return en.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor((e-1e3*t)*aw);return new en(t,s)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ie(ge.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ie(ge.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<sw)throw new Ie(ge.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ie(ge.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/aw}_compareTo(e){return this.seconds===e.seconds?vt(this.nanoseconds,e.nanoseconds):vt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:en._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ou(e,en._jsonSchema))return new en(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-sw;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}en._jsonSchemaVersion="firestore/timestamp/1.0",en._jsonSchema={type:On("string",en._jsonSchemaVersion),seconds:On("number"),nanoseconds:On("number")};class Je{static fromTimestamp(e){return new Je(e)}static min(){return new Je(new en(0,0))}static max(){return new Je(new en(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const gu=-1;function iO(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,a=Je.fromTimestamp(s===1e9?new en(t+1,0):new en(t,s));return new _a(a,qe.empty(),e)}function rO(n){return new _a(n.readTime,n.key,gu)}class _a{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new _a(Je.min(),qe.empty(),gu)}static max(){return new _a(Je.max(),qe.empty(),gu)}}function sO(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=qe.comparator(n.documentKey,e.documentKey),t!==0?t:vt(n.largestBatchId,e.largestBatchId))}const aO="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class oO{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Bl(n){if(n.code!==ge.FAILED_PRECONDITION||n.message!==aO)throw n;je("LocalStore","Unexpectedly lost primary lease")}class _e{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ye(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new _e(((s,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(s,a)},this.catchCallback=l=>{this.wrapFailure(t,l).next(s,a)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof _e?t:_e.resolve(t)}catch(t){return _e.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):_e.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):_e.reject(t)}static resolve(e){return new _e(((t,s)=>{t(e)}))}static reject(e){return new _e(((t,s)=>{s(e)}))}static waitFor(e){return new _e(((t,s)=>{let a=0,l=0,u=!1;e.forEach((g=>{++a,g.next((()=>{++l,u&&l===a&&t()}),(d=>s(d)))})),u=!0,l===a&&t()}))}static or(e){let t=_e.resolve(!1);for(const s of e)t=t.next((a=>a?_e.resolve(a):s()));return t}static forEach(e,t){const s=[];return e.forEach(((a,l)=>{s.push(t.call(this,a,l))})),this.waitFor(s)}static mapArray(e,t){return new _e(((s,a)=>{const l=e.length,u=new Array(l);let g=0;for(let d=0;d<l;d++){const p=d;t(e[p]).next((v=>{u[p]=v,++g,g===l&&s(u)}),(v=>a(v)))}}))}static doWhile(e,t){return new _e(((s,a)=>{const l=()=>{e()===!0?t().next((()=>{l()}),a):s()};l()}))}}function lO(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Fl(n){return n.name==="IndexedDbTransactionError"}class Ef{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this.ae(s),this.ue=s=>t.writeSequenceNumber(s))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Ef.ce=-1;const qy=-1;function Tf(n){return n==null}function Wd(n){return n===0&&1/n==-1/0}function cO(n){return typeof n=="number"&&Number.isInteger(n)&&!Wd(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const i1="";function uO(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=ow(e)),e=hO(n.get(t),e);return ow(e)}function hO(n,e){let t=e;const s=n.length;for(let a=0;a<s;a++){const l=n.charAt(a);switch(l){case"\0":t+="";break;case i1:t+="";break;default:t+=l}}return t}function ow(n){return n+i1+""}function lw(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ra(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function r1(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class cn{constructor(e,t){this.comparator=e,this.root=t||Xn.EMPTY}insert(e,t){return new cn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Xn.BLACK,null,null))}remove(e){return new cn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Xn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const a=this.comparator(e,s.key);if(a===0)return t+s.left.size;a<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,s)=>(e(t,s),!1)))}toString(){const e=[];return this.inorderTraversal(((t,s)=>(e.push(`${t}:${s}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new fd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new fd(this.root,e,this.comparator,!1)}getReverseIterator(){return new fd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new fd(this.root,e,this.comparator,!0)}}class fd{constructor(e,t,s,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?s(e.key,t):1,t&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Xn{constructor(e,t,s,a,l){this.key=e,this.value=t,this.color=s??Xn.RED,this.left=a??Xn.EMPTY,this.right=l??Xn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,a,l){return new Xn(e??this.key,t??this.value,s??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let a=this;const l=s(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,t,s),null):l===0?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,s)),a.fixUp()}removeMin(){if(this.left.isEmpty())return Xn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),t(e,a.key)===0){if(a.right.isEmpty())return Xn.EMPTY;s=a.right.min(),a=a.copy(s.key,s.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Xn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Xn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ye(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ye(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ye(27949);return e+(this.isRed()?0:1)}}Xn.EMPTY=null,Xn.RED=!0,Xn.BLACK=!1;Xn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ye(57766)}get value(){throw Ye(16141)}get color(){throw Ye(16727)}get left(){throw Ye(29726)}get right(){throw Ye(36894)}copy(e,t,s,a,l){return this}insert(e,t,s){return new Xn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Un{constructor(e){this.comparator=e,this.data=new cn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,s)=>(e(t),!1)))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const a=s.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new cw(this.data.getIterator())}getIteratorFrom(e){return new cw(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((s=>{t=t.add(s)})),t}isEqual(e){if(!(e instanceof Un)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=s.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Un(this.comparator);return t.data=e,t}}class cw{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Oi{constructor(e){this.fields=e,e.sort(Zn.comparator)}static empty(){return new Oi([])}unionWith(e){let t=new Un(Zn.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new Oi(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Nl(this.fields,e.fields,((t,s)=>t.isEqual(s)))}}class s1 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Jn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new s1("Invalid base64 string: "+l):l}})(e);return new Jn(t)}static fromUint8Array(e){const t=(function(a){let l="";for(let u=0;u<a.length;++u)l+=String.fromCharCode(a[u]);return l})(e);return new Jn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const s=new Uint8Array(t.length);for(let a=0;a<t.length;a++)s[a]=t.charCodeAt(a);return s})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return vt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Jn.EMPTY_BYTE_STRING=new Jn("");const dO=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ba(n){if(Pt(!!n,39018),typeof n=="string"){let e=0;const t=dO.exec(n);if(Pt(!!t,46558,{timestamp:n}),t[1]){let a=t[1];a=(a+"000000000").substr(0,9),e=Number(a)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:Sn(n.seconds),nanos:Sn(n.nanos)}}function Sn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Sa(n){return typeof n=="string"?Jn.fromBase64String(n):Jn.fromUint8Array(n)}const a1="server_timestamp",o1="__type__",l1="__previous_value__",c1="__local_write_time__";function Af(n){return(n?.mapValue?.fields||{})[o1]?.stringValue===a1}function Cf(n){const e=n.mapValue.fields[l1];return Af(e)?Cf(e):e}function pu(n){const e=ba(n.mapValue.fields[c1].timestampValue);return new en(e.seconds,e.nanos)}class fO{constructor(e,t,s,a,l,u,g,d,p,v){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=a,this.ssl=l,this.forceLongPolling=u,this.autoDetectLongPolling=g,this.longPollingOptions=d,this.useFetchStreams=p,this.isUsingEmulator=v}}const Xd="(default)";class yu{constructor(e,t){this.projectId=e,this.database=t||Xd}static empty(){return new yu("","")}get isDefaultDatabase(){return this.database===Xd}isEqual(e){return e instanceof yu&&e.projectId===this.projectId&&e.database===this.database}}const u1="__type__",mO="__max__",md={mapValue:{}},h1="__vector__",Zd="value";function wa(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Af(n)?4:pO(n)?9007199254740991:gO(n)?10:11:Ye(28295,{value:n})}function Hr(n,e){if(n===e)return!0;const t=wa(n);if(t!==wa(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return pu(n).isEqual(pu(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const u=ba(a.timestampValue),g=ba(l.timestampValue);return u.seconds===g.seconds&&u.nanos===g.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(a,l){return Sa(a.bytesValue).isEqual(Sa(l.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(a,l){return Sn(a.geoPointValue.latitude)===Sn(l.geoPointValue.latitude)&&Sn(a.geoPointValue.longitude)===Sn(l.geoPointValue.longitude)})(n,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return Sn(a.integerValue)===Sn(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const u=Sn(a.doubleValue),g=Sn(l.doubleValue);return u===g?Wd(u)===Wd(g):isNaN(u)&&isNaN(g)}return!1})(n,e);case 9:return Nl(n.arrayValue.values||[],e.arrayValue.values||[],Hr);case 10:case 11:return(function(a,l){const u=a.mapValue.fields||{},g=l.mapValue.fields||{};if(lw(u)!==lw(g))return!1;for(const d in u)if(u.hasOwnProperty(d)&&(g[d]===void 0||!Hr(u[d],g[d])))return!1;return!0})(n,e);default:return Ye(52216,{left:n})}}function vu(n,e){return(n.values||[]).find((t=>Hr(t,e)))!==void 0}function Dl(n,e){if(n===e)return 0;const t=wa(n),s=wa(e);if(t!==s)return vt(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return vt(n.booleanValue,e.booleanValue);case 2:return(function(l,u){const g=Sn(l.integerValue||l.doubleValue),d=Sn(u.integerValue||u.doubleValue);return g<d?-1:g>d?1:g===d?0:isNaN(g)?isNaN(d)?0:-1:1})(n,e);case 3:return uw(n.timestampValue,e.timestampValue);case 4:return uw(pu(n),pu(e));case 5:return Up(n.stringValue,e.stringValue);case 6:return(function(l,u){const g=Sa(l),d=Sa(u);return g.compareTo(d)})(n.bytesValue,e.bytesValue);case 7:return(function(l,u){const g=l.split("/"),d=u.split("/");for(let p=0;p<g.length&&p<d.length;p++){const v=vt(g[p],d[p]);if(v!==0)return v}return vt(g.length,d.length)})(n.referenceValue,e.referenceValue);case 8:return(function(l,u){const g=vt(Sn(l.latitude),Sn(u.latitude));return g!==0?g:vt(Sn(l.longitude),Sn(u.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return hw(n.arrayValue,e.arrayValue);case 10:return(function(l,u){const g=l.fields||{},d=u.fields||{},p=g[Zd]?.arrayValue,v=d[Zd]?.arrayValue,_=vt(p?.values?.length||0,v?.values?.length||0);return _!==0?_:hw(p,v)})(n.mapValue,e.mapValue);case 11:return(function(l,u){if(l===md.mapValue&&u===md.mapValue)return 0;if(l===md.mapValue)return 1;if(u===md.mapValue)return-1;const g=l.fields||{},d=Object.keys(g),p=u.fields||{},v=Object.keys(p);d.sort(),v.sort();for(let _=0;_<d.length&&_<v.length;++_){const S=Up(d[_],v[_]);if(S!==0)return S;const C=Dl(g[d[_]],p[v[_]]);if(C!==0)return C}return vt(d.length,v.length)})(n.mapValue,e.mapValue);default:throw Ye(23264,{he:t})}}function uw(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return vt(n,e);const t=ba(n),s=ba(e),a=vt(t.seconds,s.seconds);return a!==0?a:vt(t.nanos,s.nanos)}function hw(n,e){const t=n.values||[],s=e.values||[];for(let a=0;a<t.length&&a<s.length;++a){const l=Dl(t[a],s[a]);if(l)return l}return vt(t.length,s.length)}function Ml(n){return zp(n)}function zp(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const s=ba(t);return`time(${s.seconds},${s.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Sa(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return qe.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let s="[",a=!0;for(const l of t.values||[])a?a=!1:s+=",",s+=zp(l);return s+"]"})(n.arrayValue):"mapValue"in n?(function(t){const s=Object.keys(t.fields||{}).sort();let a="{",l=!0;for(const u of s)l?l=!1:a+=",",a+=`${u}:${zp(t.fields[u])}`;return a+"}"})(n.mapValue):Ye(61005,{value:n})}function Pd(n){switch(wa(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Cf(n);return e?16+Pd(e):16;case 5:return 2*n.stringValue.length;case 6:return Sa(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(s){return(s.values||[]).reduce(((a,l)=>a+Pd(l)),0)})(n.arrayValue);case 10:case 11:return(function(s){let a=0;return Ra(s.fields,((l,u)=>{a+=l.length+Pd(u)})),a})(n.mapValue);default:throw Ye(13486,{value:n})}}function Jd(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Bp(n){return!!n&&"integerValue"in n}function Gy(n){return!!n&&"arrayValue"in n}function dw(n){return!!n&&"nullValue"in n}function fw(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Vd(n){return!!n&&"mapValue"in n}function gO(n){return(n?.mapValue?.fields||{})[u1]?.stringValue===h1}function ru(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Ra(n.mapValue.fields,((t,s)=>e.mapValue.fields[t]=ru(s))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ru(n.arrayValue.values[t]);return e}return{...n}}function pO(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===mO}class bi{constructor(e){this.value=e}static empty(){return new bi({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!Vd(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ru(t)}setAll(e){let t=Zn.emptyPath(),s={},a=[];e.forEach(((u,g)=>{if(!t.isImmediateParentOf(g)){const d=this.getFieldsMap(t);this.applyChanges(d,s,a),s={},a=[],t=g.popLast()}u?s[g.lastSegment()]=ru(u):a.push(g.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,s,a)}delete(e){const t=this.field(e.popLast());Vd(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Hr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let a=t.mapValue.fields[e.get(s)];Vd(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,s){Ra(t,((a,l)=>e[a]=l));for(const a of s)delete e[a]}clone(){return new bi(ru(this.value))}}function d1(n){const e=[];return Ra(n.fields,((t,s)=>{const a=new Zn([t]);if(Vd(s)){const l=d1(s.mapValue).fields;if(l.length===0)e.push(a);else for(const u of l)e.push(a.child(u))}else e.push(a)})),new Oi(e)}class ii{constructor(e,t,s,a,l,u,g){this.key=e,this.documentType=t,this.version=s,this.readTime=a,this.createTime=l,this.data=u,this.documentState=g}static newInvalidDocument(e){return new ii(e,0,Je.min(),Je.min(),Je.min(),bi.empty(),0)}static newFoundDocument(e,t,s,a){return new ii(e,1,t,Je.min(),s,a,0)}static newNoDocument(e,t){return new ii(e,2,t,Je.min(),Je.min(),bi.empty(),0)}static newUnknownDocument(e,t){return new ii(e,3,t,Je.min(),Je.min(),bi.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Je.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=bi.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=bi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Je.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ii&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ii(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Ol{constructor(e,t){this.position=e,this.inclusive=t}}function mw(n,e,t){let s=0;for(let a=0;a<n.position.length;a++){const l=e[a],u=n.position[a];if(l.field.isKeyField()?s=qe.comparator(qe.fromName(u.referenceValue),t.key):s=Dl(u,t.data.field(l.field)),l.dir==="desc"&&(s*=-1),s!==0)break}return s}function gw(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Hr(n.position[t],e.position[t]))return!1;return!0}class _u{constructor(e,t="asc"){this.field=e,this.dir=t}}function yO(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class f1{}class Mn extends f1{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new _O(e,t,s):t==="array-contains"?new wO(e,s):t==="in"?new EO(e,s):t==="not-in"?new TO(e,s):t==="array-contains-any"?new AO(e,s):new Mn(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new bO(e,s):new SO(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Dl(t,this.value)):t!==null&&wa(this.value)===wa(t)&&this.matchesComparison(Dl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ye(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ur extends f1{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new ur(e,t)}matches(e){return m1(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function m1(n){return n.op==="and"}function g1(n){return vO(n)&&m1(n)}function vO(n){for(const e of n.filters)if(e instanceof ur)return!1;return!0}function Fp(n){if(n instanceof Mn)return n.field.canonicalString()+n.op.toString()+Ml(n.value);if(g1(n))return n.filters.map((e=>Fp(e))).join(",");{const e=n.filters.map((t=>Fp(t))).join(",");return`${n.op}(${e})`}}function p1(n,e){return n instanceof Mn?(function(s,a){return a instanceof Mn&&s.op===a.op&&s.field.isEqual(a.field)&&Hr(s.value,a.value)})(n,e):n instanceof ur?(function(s,a){return a instanceof ur&&s.op===a.op&&s.filters.length===a.filters.length?s.filters.reduce(((l,u,g)=>l&&p1(u,a.filters[g])),!0):!1})(n,e):void Ye(19439)}function y1(n){return n instanceof Mn?(function(t){return`${t.field.canonicalString()} ${t.op} ${Ml(t.value)}`})(n):n instanceof ur?(function(t){return t.op.toString()+" {"+t.getFilters().map(y1).join(" ,")+"}"})(n):"Filter"}class _O extends Mn{constructor(e,t,s){super(e,t,s),this.key=qe.fromName(s.referenceValue)}matches(e){const t=qe.comparator(e.key,this.key);return this.matchesComparison(t)}}class bO extends Mn{constructor(e,t){super(e,"in",t),this.keys=v1("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class SO extends Mn{constructor(e,t){super(e,"not-in",t),this.keys=v1("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function v1(n,e){return(e.arrayValue?.values||[]).map((t=>qe.fromName(t.referenceValue)))}class wO extends Mn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Gy(t)&&vu(t.arrayValue,this.value)}}class EO extends Mn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&vu(this.value.arrayValue,t)}}class TO extends Mn{constructor(e,t){super(e,"not-in",t)}matches(e){if(vu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!vu(this.value.arrayValue,t)}}class AO extends Mn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Gy(t)||!t.arrayValue.values)&&t.arrayValue.values.some((s=>vu(this.value.arrayValue,s)))}}class CO{constructor(e,t=null,s=[],a=[],l=null,u=null,g=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=a,this.limit=l,this.startAt=u,this.endAt=g,this.Te=null}}function pw(n,e=null,t=[],s=[],a=null,l=null,u=null){return new CO(n,e,t,s,a,l,u)}function $y(n){const e=nt(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((s=>Fp(s))).join(","),t+="|ob:",t+=e.orderBy.map((s=>(function(l){return l.field.canonicalString()+l.dir})(s))).join(","),Tf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((s=>Ml(s))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((s=>Ml(s))).join(",")),e.Te=t}return e.Te}function Qy(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!yO(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!p1(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!gw(n.startAt,e.startAt)&&gw(n.endAt,e.endAt)}function Hp(n){return qe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class Ia{constructor(e,t=null,s=[],a=[],l=null,u="F",g=null,d=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=a,this.limit=l,this.limitType=u,this.startAt=g,this.endAt=d,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function xO(n,e,t,s,a,l,u,g){return new Ia(n,e,t,s,a,l,u,g)}function Yy(n){return new Ia(n)}function yw(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Ky(n){return n.collectionGroup!==null}function Tl(n){const e=nt(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),t.add(l.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let g=new Un(Zn.comparator);return u.filters.forEach((d=>{d.getFlattenedFilters().forEach((p=>{p.isInequality()&&(g=g.add(p.field))}))})),g})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new _u(l,s))})),t.has(Zn.keyField().canonicalString())||e.Ie.push(new _u(Zn.keyField(),s))}return e.Ie}function Vr(n){const e=nt(n);return e.Ee||(e.Ee=RO(e,Tl(n))),e.Ee}function RO(n,e){if(n.limitType==="F")return pw(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new _u(a.field,l)}));const t=n.endAt?new Ol(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new Ol(n.startAt.position,n.startAt.inclusive):null;return pw(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function qp(n,e){const t=n.filters.concat([e]);return new Ia(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function ef(n,e,t){return new Ia(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function xf(n,e){return Qy(Vr(n),Vr(e))&&n.limitType===e.limitType}function _1(n){return`${$y(Vr(n))}|lt:${n.limitType}`}function pl(n){return`Query(target=${(function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map((a=>y1(a))).join(", ")}]`),Tf(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map((a=>(function(u){return`${u.field.canonicalString()} (${u.dir})`})(a))).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map((a=>Ml(a))).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map((a=>Ml(a))).join(",")),`Target(${s})`})(Vr(n))}; limitType=${n.limitType})`}function Rf(n,e){return e.isFoundDocument()&&(function(s,a){const l=a.key.path;return s.collectionGroup!==null?a.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(l):qe.isDocumentKey(s.path)?s.path.isEqual(l):s.path.isImmediateParentOf(l)})(n,e)&&(function(s,a){for(const l of Tl(s))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(n,e)&&(function(s,a){for(const l of s.filters)if(!l.matches(a))return!1;return!0})(n,e)&&(function(s,a){return!(s.startAt&&!(function(u,g,d){const p=mw(u,g,d);return u.inclusive?p<=0:p<0})(s.startAt,Tl(s),a)||s.endAt&&!(function(u,g,d){const p=mw(u,g,d);return u.inclusive?p>=0:p>0})(s.endAt,Tl(s),a))})(n,e)}function IO(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function b1(n){return(e,t)=>{let s=!1;for(const a of Tl(n)){const l=NO(a,e,t);if(l!==0)return l;s=s||a.field.isKeyField()}return 0}}function NO(n,e,t){const s=n.field.isKeyField()?qe.comparator(e.key,t.key):(function(l,u,g){const d=u.data.field(l),p=g.data.field(l);return d!==null&&p!==null?Dl(d,p):Ye(42886)})(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return Ye(19790,{direction:n.dir})}}class wo{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[a,l]of s)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),a=this.inner[s];if(a===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return s.length===1?delete this.inner[t]:s.splice(a,1),this.innerSize--,!0;return!1}forEach(e){Ra(this.inner,((t,s)=>{for(const[a,l]of s)e(a,l)}))}isEmpty(){return r1(this.inner)}size(){return this.innerSize}}const DO=new cn(qe.comparator);function ws(){return DO}const S1=new cn(qe.comparator);function Zc(...n){let e=S1;for(const t of n)e=e.insert(t.key,t);return e}function w1(n){let e=S1;return n.forEach(((t,s)=>e=e.insert(t,s.overlayedDocument))),e}function so(){return su()}function E1(){return su()}function su(){return new wo((n=>n.toString()),((n,e)=>n.isEqual(e)))}const MO=new cn(qe.comparator),OO=new Un(qe.comparator);function _t(...n){let e=OO;for(const t of n)e=e.add(t);return e}const jO=new Un(vt);function kO(){return jO}function Wy(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Wd(e)?"-0":e}}function T1(n){return{integerValue:""+n}}function PO(n,e){return cO(e)?T1(e):Wy(n,e)}class If{constructor(){this._=void 0}}function VO(n,e,t){return n instanceof tf?(function(a,l){const u={fields:{[o1]:{stringValue:a1},[c1]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&Af(l)&&(l=Cf(l)),l&&(u.fields[l1]=l),{mapValue:u}})(t,e):n instanceof bu?C1(n,e):n instanceof Su?x1(n,e):(function(a,l){const u=A1(a,l),g=vw(u)+vw(a.Ae);return Bp(u)&&Bp(a.Ae)?T1(g):Wy(a.serializer,g)})(n,e)}function LO(n,e,t){return n instanceof bu?C1(n,e):n instanceof Su?x1(n,e):t}function A1(n,e){return n instanceof nf?(function(s){return Bp(s)||(function(l){return!!l&&"doubleValue"in l})(s)})(e)?e:{integerValue:0}:null}class tf extends If{}class bu extends If{constructor(e){super(),this.elements=e}}function C1(n,e){const t=R1(e);for(const s of n.elements)t.some((a=>Hr(a,s)))||t.push(s);return{arrayValue:{values:t}}}class Su extends If{constructor(e){super(),this.elements=e}}function x1(n,e){let t=R1(e);for(const s of n.elements)t=t.filter((a=>!Hr(a,s)));return{arrayValue:{values:t}}}class nf extends If{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function vw(n){return Sn(n.integerValue||n.doubleValue)}function R1(n){return Gy(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function UO(n,e){return n.field.isEqual(e.field)&&(function(s,a){return s instanceof bu&&a instanceof bu||s instanceof Su&&a instanceof Su?Nl(s.elements,a.elements,Hr):s instanceof nf&&a instanceof nf?Hr(s.Ae,a.Ae):s instanceof tf&&a instanceof tf})(n.transform,e.transform)}class zO{constructor(e,t){this.version=e,this.transformResults=t}}class cr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new cr}static exists(e){return new cr(void 0,e)}static updateTime(e){return new cr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ld(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Nf{}function I1(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new D1(n.key,cr.none()):new ju(n.key,n.data,cr.none());{const t=n.data,s=bi.empty();let a=new Un(Zn.comparator);for(let l of e.fields)if(!a.has(l)){let u=t.field(l);u===null&&l.length>1&&(l=l.popLast(),u=t.field(l)),u===null?s.delete(l):s.set(l,u),a=a.add(l)}return new Na(n.key,s,new Oi(a.toArray()),cr.none())}}function BO(n,e,t){n instanceof ju?(function(a,l,u){const g=a.value.clone(),d=bw(a.fieldTransforms,l,u.transformResults);g.setAll(d),l.convertToFoundDocument(u.version,g).setHasCommittedMutations()})(n,e,t):n instanceof Na?(function(a,l,u){if(!Ld(a.precondition,l))return void l.convertToUnknownDocument(u.version);const g=bw(a.fieldTransforms,l,u.transformResults),d=l.data;d.setAll(N1(a)),d.setAll(g),l.convertToFoundDocument(u.version,d).setHasCommittedMutations()})(n,e,t):(function(a,l,u){l.convertToNoDocument(u.version).setHasCommittedMutations()})(0,e,t)}function au(n,e,t,s){return n instanceof ju?(function(l,u,g,d){if(!Ld(l.precondition,u))return g;const p=l.value.clone(),v=Sw(l.fieldTransforms,d,u);return p.setAll(v),u.convertToFoundDocument(u.version,p).setHasLocalMutations(),null})(n,e,t,s):n instanceof Na?(function(l,u,g,d){if(!Ld(l.precondition,u))return g;const p=Sw(l.fieldTransforms,d,u),v=u.data;return v.setAll(N1(l)),v.setAll(p),u.convertToFoundDocument(u.version,v).setHasLocalMutations(),g===null?null:g.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((_=>_.field)))})(n,e,t,s):(function(l,u,g){return Ld(l.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):g})(n,e,t)}function FO(n,e){let t=null;for(const s of n.fieldTransforms){const a=e.data.field(s.field),l=A1(s.transform,a||null);l!=null&&(t===null&&(t=bi.empty()),t.set(s.field,l))}return t||null}function _w(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(s,a){return s===void 0&&a===void 0||!(!s||!a)&&Nl(s,a,((l,u)=>UO(l,u)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class ju extends Nf{constructor(e,t,s,a=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class Na extends Nf{constructor(e,t,s,a,l=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function N1(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}})),e}function bw(n,e,t){const s=new Map;Pt(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let a=0;a<t.length;a++){const l=n[a],u=l.transform,g=e.data.field(l.field);s.set(l.field,LO(u,g,t[a]))}return s}function Sw(n,e,t){const s=new Map;for(const a of n){const l=a.transform,u=t.data.field(a.field);s.set(a.field,VO(l,u,e))}return s}class D1 extends Nf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class HO extends Nf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class qO{constructor(e,t,s,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=a}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&BO(l,e,s[a])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=au(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=au(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=E1();return this.mutations.forEach((a=>{const l=e.get(a.key),u=l.overlayedDocument;let g=this.applyToLocalView(u,l.mutatedFields);g=t.has(a.key)?null:g;const d=I1(u,g);d!==null&&s.set(a.key,d),u.isValidDocument()||u.convertToNoDocument(Je.min())})),s}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),_t())}isEqual(e){return this.batchId===e.batchId&&Nl(this.mutations,e.mutations,((t,s)=>_w(t,s)))&&Nl(this.baseMutations,e.baseMutations,((t,s)=>_w(t,s)))}}class Xy{constructor(e,t,s,a){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=a}static from(e,t,s){Pt(e.mutations.length===s.length,58842,{me:e.mutations.length,fe:s.length});let a=(function(){return MO})();const l=e.mutations;for(let u=0;u<l.length;u++)a=a.insert(l[u].key,s[u].version);return new Xy(e,t,s,a)}}class GO{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class $O{constructor(e,t){this.count=e,this.unchangedNames=t}}var Nn,Et;function QO(n){switch(n){case ge.OK:return Ye(64938);case ge.CANCELLED:case ge.UNKNOWN:case ge.DEADLINE_EXCEEDED:case ge.RESOURCE_EXHAUSTED:case ge.INTERNAL:case ge.UNAVAILABLE:case ge.UNAUTHENTICATED:return!1;case ge.INVALID_ARGUMENT:case ge.NOT_FOUND:case ge.ALREADY_EXISTS:case ge.PERMISSION_DENIED:case ge.FAILED_PRECONDITION:case ge.ABORTED:case ge.OUT_OF_RANGE:case ge.UNIMPLEMENTED:case ge.DATA_LOSS:return!0;default:return Ye(15467,{code:n})}}function M1(n){if(n===void 0)return Ss("GRPC error has no .code"),ge.UNKNOWN;switch(n){case Nn.OK:return ge.OK;case Nn.CANCELLED:return ge.CANCELLED;case Nn.UNKNOWN:return ge.UNKNOWN;case Nn.DEADLINE_EXCEEDED:return ge.DEADLINE_EXCEEDED;case Nn.RESOURCE_EXHAUSTED:return ge.RESOURCE_EXHAUSTED;case Nn.INTERNAL:return ge.INTERNAL;case Nn.UNAVAILABLE:return ge.UNAVAILABLE;case Nn.UNAUTHENTICATED:return ge.UNAUTHENTICATED;case Nn.INVALID_ARGUMENT:return ge.INVALID_ARGUMENT;case Nn.NOT_FOUND:return ge.NOT_FOUND;case Nn.ALREADY_EXISTS:return ge.ALREADY_EXISTS;case Nn.PERMISSION_DENIED:return ge.PERMISSION_DENIED;case Nn.FAILED_PRECONDITION:return ge.FAILED_PRECONDITION;case Nn.ABORTED:return ge.ABORTED;case Nn.OUT_OF_RANGE:return ge.OUT_OF_RANGE;case Nn.UNIMPLEMENTED:return ge.UNIMPLEMENTED;case Nn.DATA_LOSS:return ge.DATA_LOSS;default:return Ye(39323,{code:n})}}(Et=Nn||(Nn={}))[Et.OK=0]="OK",Et[Et.CANCELLED=1]="CANCELLED",Et[Et.UNKNOWN=2]="UNKNOWN",Et[Et.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Et[Et.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Et[Et.NOT_FOUND=5]="NOT_FOUND",Et[Et.ALREADY_EXISTS=6]="ALREADY_EXISTS",Et[Et.PERMISSION_DENIED=7]="PERMISSION_DENIED",Et[Et.UNAUTHENTICATED=16]="UNAUTHENTICATED",Et[Et.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Et[Et.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Et[Et.ABORTED=10]="ABORTED",Et[Et.OUT_OF_RANGE=11]="OUT_OF_RANGE",Et[Et.UNIMPLEMENTED=12]="UNIMPLEMENTED",Et[Et.INTERNAL=13]="INTERNAL",Et[Et.UNAVAILABLE=14]="UNAVAILABLE",Et[Et.DATA_LOSS=15]="DATA_LOSS";function YO(){return new TextEncoder}const KO=new ga([4294967295,4294967295],0);function ww(n){const e=YO().encode(n),t=new QT;return t.update(e),new Uint8Array(t.digest())}function Ew(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new ga([t,s],0),new ga([a,l],0)]}class Zy{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new Jc(`Invalid padding: ${t}`);if(s<0)throw new Jc(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new Jc(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new Jc(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=ga.fromNumber(this.ge)}ye(e,t,s){let a=e.add(t.multiply(ga.fromNumber(s)));return a.compare(KO)===1&&(a=new ga([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=ww(e),[s,a]=Ew(t);for(let l=0;l<this.hashCount;l++){const u=this.ye(s,a,l);if(!this.we(u))return!1}return!0}static create(e,t,s){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),u=new Zy(l,a,t);return s.forEach((g=>u.insert(g))),u}insert(e){if(this.ge===0)return;const t=ww(e),[s,a]=Ew(t);for(let l=0;l<this.hashCount;l++){const u=this.ye(s,a,l);this.Se(u)}}Se(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class Jc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Df{constructor(e,t,s,a,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const a=new Map;return a.set(e,ku.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new Df(Je.min(),a,new cn(vt),ws(),_t())}}class ku{constructor(e,t,s,a,l){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new ku(s,t,_t(),_t(),_t())}}class Ud{constructor(e,t,s,a){this.be=e,this.removedTargetIds=t,this.key=s,this.De=a}}class O1{constructor(e,t){this.targetId=e,this.Ce=t}}class j1{constructor(e,t,s=Jn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=a}}class Tw{constructor(){this.ve=0,this.Fe=Aw(),this.Me=Jn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=_t(),t=_t(),s=_t();return this.Fe.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:s=s.add(a);break;default:Ye(38017,{changeType:l})}})),new ku(this.Me,this.xe,e,t,s)}qe(){this.Oe=!1,this.Fe=Aw()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Pt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class WO{constructor(e){this.Ge=e,this.ze=new Map,this.je=ws(),this.Je=gd(),this.He=gd(),this.Ye=new cn(vt)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const s=this.nt(t);switch(e.state){case 0:this.rt(t)&&s.Le(e.resumeToken);break;case 1:s.Ke(),s.Ne||s.qe(),s.Le(e.resumeToken);break;case 2:s.Ke(),s.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(s.We(),s.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),s.Le(e.resumeToken));break;default:Ye(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((s,a)=>{this.rt(a)&&t(a)}))}st(e){const t=e.targetId,s=e.Ce.count,a=this.ot(t);if(a){const l=a.target;if(Hp(l))if(s===0){const u=new qe(l.path);this.et(t,u,ii.newNoDocument(u,Je.min()))}else Pt(s===1,20013,{expectedCount:s});else{const u=this._t(t);if(u!==s){const g=this.ut(e),d=g?this.ct(g,e,u):1;if(d!==0){this.it(t);const p=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,p)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:a=0},hashCount:l=0}=t;let u,g;try{u=Sa(s).toUint8Array()}catch(d){if(d instanceof s1)return Il("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{g=new Zy(u,a,l)}catch(d){return Il(d instanceof Jc?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return g.ge===0?null:g}ct(e,t,s){return t.Ce.count===s-this.Pt(e,t.targetId)?0:2}Pt(e,t){const s=this.Ge.getRemoteKeysForTarget(t);let a=0;return s.forEach((l=>{const u=this.Ge.ht(),g=`projects/${u.projectId}/databases/${u.database}/documents/${l.path.canonicalString()}`;e.mightContain(g)||(this.et(t,l,null),a++)})),a}Tt(e){const t=new Map;this.ze.forEach(((l,u)=>{const g=this.ot(u);if(g){if(l.current&&Hp(g.target)){const d=new qe(g.target.path);this.It(d).has(u)||this.Et(u,d)||this.et(u,d,ii.newNoDocument(d,e))}l.Be&&(t.set(u,l.ke()),l.qe())}}));let s=_t();this.He.forEach(((l,u)=>{let g=!0;u.forEachWhile((d=>{const p=this.ot(d);return!p||p.purpose==="TargetPurposeLimboResolution"||(g=!1,!1)})),g&&(s=s.add(l))})),this.je.forEach(((l,u)=>u.setReadTime(e)));const a=new Df(e,t,this.Ye,this.je,s);return this.je=ws(),this.Je=gd(),this.He=gd(),this.Ye=new cn(vt),a}Xe(e,t){if(!this.rt(e))return;const s=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,s),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,s){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,t)?a.Qe(t,1):a.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),s&&(this.je=this.je.insert(t,s))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new Tw,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Un(vt),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Un(vt),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||je("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Tw),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function gd(){return new cn(qe.comparator)}function Aw(){return new cn(qe.comparator)}const XO={asc:"ASCENDING",desc:"DESCENDING"},ZO={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},JO={and:"AND",or:"OR"};class ej{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Gp(n,e){return n.useProto3Json||Tf(e)?e:{value:e}}function rf(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function k1(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function tj(n,e){return rf(n,e.toTimestamp())}function Lr(n){return Pt(!!n,49232),Je.fromTimestamp((function(t){const s=ba(t);return new en(s.seconds,s.nanos)})(n))}function Jy(n,e){return $p(n,e).canonicalString()}function $p(n,e){const t=(function(a){return new Kt(["projects",a.projectId,"databases",a.database])})(n).child("documents");return e===void 0?t:t.child(e)}function P1(n){const e=Kt.fromString(n);return Pt(B1(e),10190,{key:e.toString()}),e}function Qp(n,e){return Jy(n.databaseId,e.path)}function rp(n,e){const t=P1(e);if(t.get(1)!==n.databaseId.projectId)throw new Ie(ge.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ie(ge.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new qe(L1(t))}function V1(n,e){return Jy(n.databaseId,e)}function nj(n){const e=P1(n);return e.length===4?Kt.emptyPath():L1(e)}function Yp(n){return new Kt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function L1(n){return Pt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Cw(n,e,t){return{name:Qp(n,e),fields:t.value.mapValue.fields}}function ij(n,e){let t;if("targetChange"in e){e.targetChange;const s=(function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:Ye(39313,{state:p})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(p,v){return p.useProto3Json?(Pt(v===void 0||typeof v=="string",58123),Jn.fromBase64String(v||"")):(Pt(v===void 0||v instanceof Buffer||v instanceof Uint8Array,16193),Jn.fromUint8Array(v||new Uint8Array))})(n,e.targetChange.resumeToken),u=e.targetChange.cause,g=u&&(function(p){const v=p.code===void 0?ge.UNKNOWN:M1(p.code);return new Ie(v,p.message||"")})(u);t=new j1(s,a,l,g||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const a=rp(n,s.document.name),l=Lr(s.document.updateTime),u=s.document.createTime?Lr(s.document.createTime):Je.min(),g=new bi({mapValue:{fields:s.document.fields}}),d=ii.newFoundDocument(a,l,u,g),p=s.targetIds||[],v=s.removedTargetIds||[];t=new Ud(p,v,d.key,d)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const a=rp(n,s.document),l=s.readTime?Lr(s.readTime):Je.min(),u=ii.newNoDocument(a,l),g=s.removedTargetIds||[];t=new Ud([],g,u.key,u)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const a=rp(n,s.document),l=s.removedTargetIds||[];t=new Ud([],l,a,null)}else{if(!("filter"in e))return Ye(11601,{Rt:e});{e.filter;const s=e.filter;s.targetId;const{count:a=0,unchangedNames:l}=s,u=new $O(a,l),g=s.targetId;t=new O1(g,u)}}return t}function rj(n,e){let t;if(e instanceof ju)t={update:Cw(n,e.key,e.value)};else if(e instanceof D1)t={delete:Qp(n,e.key)};else if(e instanceof Na)t={update:Cw(n,e.key,e.data),updateMask:fj(e.fieldMask)};else{if(!(e instanceof HO))return Ye(16599,{Vt:e.type});t={verify:Qp(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((s=>(function(l,u){const g=u.transform;if(g instanceof tf)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(g instanceof bu)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:g.elements}};if(g instanceof Su)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:g.elements}};if(g instanceof nf)return{fieldPath:u.field.canonicalString(),increment:g.Ae};throw Ye(20930,{transform:u.transform})})(0,s)))),e.precondition.isNone||(t.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:tj(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:Ye(27497)})(n,e.precondition)),t}function sj(n,e){return n&&n.length>0?(Pt(e!==void 0,14353),n.map((t=>(function(a,l){let u=a.updateTime?Lr(a.updateTime):Lr(l);return u.isEqual(Je.min())&&(u=Lr(l)),new zO(u,a.transformResults||[])})(t,e)))):[]}function aj(n,e){return{documents:[V1(n,e.path)]}}function oj(n,e){const t={structuredQuery:{}},s=e.path;let a;e.collectionGroup!==null?(a=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=V1(n,a);const l=(function(p){if(p.length!==0)return z1(ur.create(p,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const u=(function(p){if(p.length!==0)return p.map((v=>(function(S){return{field:yl(S.field),direction:uj(S.dir)}})(v)))})(e.orderBy);u&&(t.structuredQuery.orderBy=u);const g=Gp(n,e.limit);return g!==null&&(t.structuredQuery.limit=g),e.startAt&&(t.structuredQuery.startAt=(function(p){return{before:p.inclusive,values:p.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(p){return{before:!p.inclusive,values:p.position}})(e.endAt)),{ft:t,parent:a}}function lj(n){let e=nj(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let a=null;if(s>0){Pt(s===1,65062);const v=t.from[0];v.allDescendants?a=v.collectionId:e=e.child(v.collectionId)}let l=[];t.where&&(l=(function(_){const S=U1(_);return S instanceof ur&&g1(S)?S.getFilters():[S]})(t.where));let u=[];t.orderBy&&(u=(function(_){return _.map((S=>(function(O){return new _u(vl(O.field),(function(U){switch(U){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(O.direction))})(S)))})(t.orderBy));let g=null;t.limit&&(g=(function(_){let S;return S=typeof _=="object"?_.value:_,Tf(S)?null:S})(t.limit));let d=null;t.startAt&&(d=(function(_){const S=!!_.before,C=_.values||[];return new Ol(C,S)})(t.startAt));let p=null;return t.endAt&&(p=(function(_){const S=!_.before,C=_.values||[];return new Ol(C,S)})(t.endAt)),xO(e,a,u,l,g,"F",d,p)}function cj(n,e){const t=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ye(28987,{purpose:a})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function U1(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=vl(t.unaryFilter.field);return Mn.create(s,"==",{doubleValue:NaN});case"IS_NULL":const a=vl(t.unaryFilter.field);return Mn.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=vl(t.unaryFilter.field);return Mn.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=vl(t.unaryFilter.field);return Mn.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ye(61313);default:return Ye(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Mn.create(vl(t.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ye(58110);default:return Ye(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return ur.create(t.compositeFilter.filters.map((s=>U1(s))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return Ye(1026)}})(t.compositeFilter.op))})(n):Ye(30097,{filter:n})}function uj(n){return XO[n]}function hj(n){return ZO[n]}function dj(n){return JO[n]}function yl(n){return{fieldPath:n.canonicalString()}}function vl(n){return Zn.fromServerFormat(n.fieldPath)}function z1(n){return n instanceof Mn?(function(t){if(t.op==="=="){if(fw(t.value))return{unaryFilter:{field:yl(t.field),op:"IS_NAN"}};if(dw(t.value))return{unaryFilter:{field:yl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(fw(t.value))return{unaryFilter:{field:yl(t.field),op:"IS_NOT_NAN"}};if(dw(t.value))return{unaryFilter:{field:yl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:yl(t.field),op:hj(t.op),value:t.value}}})(n):n instanceof ur?(function(t){const s=t.getFilters().map((a=>z1(a)));return s.length===1?s[0]:{compositeFilter:{op:dj(t.op),filters:s}}})(n):Ye(54877,{filter:n})}function fj(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function B1(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class ha{constructor(e,t,s,a,l=Je.min(),u=Je.min(),g=Jn.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=g,this.expectedCount=d}withSequenceNumber(e){return new ha(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ha(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ha(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ha(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class mj{constructor(e){this.yt=e}}function gj(n){const e=lj({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?ef(e,e.limit,"L"):e}class pj{constructor(){this.Cn=new yj}addToCollectionParentIndex(e,t){return this.Cn.add(t),_e.resolve()}getCollectionParents(e,t){return _e.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return _e.resolve()}deleteFieldIndex(e,t){return _e.resolve()}deleteAllFieldIndexes(e){return _e.resolve()}createTargetIndexes(e,t){return _e.resolve()}getDocumentsMatchingTarget(e,t){return _e.resolve(null)}getIndexType(e,t){return _e.resolve(0)}getFieldIndexes(e,t){return _e.resolve([])}getNextCollectionGroupToUpdate(e){return _e.resolve(null)}getMinOffset(e,t){return _e.resolve(_a.min())}getMinOffsetFromCollectionGroup(e,t){return _e.resolve(_a.min())}updateCollectionGroup(e,t,s){return _e.resolve()}updateIndexEntries(e,t){return _e.resolve()}}class yj{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),a=this.index[t]||new Un(Kt.comparator),l=!a.has(s);return this.index[t]=a.add(s),l}has(e){const t=e.lastSegment(),s=e.popLast(),a=this.index[t];return a&&a.has(s)}getEntries(e){return(this.index[e]||new Un(Kt.comparator)).toArray()}}const xw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},F1=41943040;class _i{static withCacheSize(e){return new _i(e,_i.DEFAULT_COLLECTION_PERCENTILE,_i.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}}_i.DEFAULT_COLLECTION_PERCENTILE=10,_i.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,_i.DEFAULT=new _i(F1,_i.DEFAULT_COLLECTION_PERCENTILE,_i.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),_i.DISABLED=new _i(-1,0,0);class jl{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new jl(0)}static cr(){return new jl(-1)}}const Rw="LruGarbageCollector",vj=1048576;function Iw([n,e],[t,s]){const a=vt(n,t);return a===0?vt(e,s):a}class _j{constructor(e){this.Ir=e,this.buffer=new Un(Iw),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();Iw(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class bj{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){je(Rw,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Fl(t)?je(Rw,"Ignoring IndexedDB error during garbage collection: ",t):await Bl(t)}await this.Vr(3e5)}))}}class Sj{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((s=>Math.floor(t/100*s)))}nthSequenceNumber(e,t){if(t===0)return _e.resolve(Ef.ce);const s=new _j(t);return this.mr.forEachTarget(e,(a=>s.Ar(a.sequenceNumber))).next((()=>this.mr.pr(e,(a=>s.Ar(a))))).next((()=>s.maxValue))}removeTargets(e,t,s){return this.mr.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(je("LruGarbageCollector","Garbage collection skipped; disabled"),_e.resolve(xw)):this.getCacheSize(e).next((s=>s<this.params.cacheSizeCollectionThreshold?(je("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),xw):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let s,a,l,u,g,d,p;const v=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((_=>(_>this.params.maximumSequenceNumbersToCollect?(je("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${_}`),a=this.params.maximumSequenceNumbersToCollect):a=_,u=Date.now(),this.nthSequenceNumber(e,a)))).next((_=>(s=_,g=Date.now(),this.removeTargets(e,s,t)))).next((_=>(l=_,d=Date.now(),this.removeOrphanedDocuments(e,s)))).next((_=>(p=Date.now(),gl()<=yt.DEBUG&&je("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-v}ms
	Determined least recently used ${a} in `+(g-u)+`ms
	Removed ${l} targets in `+(d-g)+`ms
	Removed ${_} documents in `+(p-d)+`ms
Total Duration: ${p-v}ms`),_e.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:_}))))}}function wj(n,e){return new Sj(n,e)}class Ej{constructor(){this.changes=new wo((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ii.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?_e.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Tj{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Aj{constructor(e,t,s,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=a}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next((a=>(s=a,this.remoteDocumentCache.getEntry(e,t)))).next((a=>(s!==null&&au(s.mutation,a,Oi.empty(),en.now()),a)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.getLocalViewOfDocuments(e,s,_t()).next((()=>s))))}getLocalViewOfDocuments(e,t,s=_t()){const a=so();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,s).next((l=>{let u=Zc();return l.forEach(((g,d)=>{u=u.insert(g,d.overlayedDocument)})),u}))))}getOverlayedDocuments(e,t){const s=so();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,_t())))}populateOverlays(e,t,s){const a=[];return s.forEach((l=>{t.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((u,g)=>{t.set(u,g)}))}))}computeViews(e,t,s,a){let l=ws();const u=su(),g=(function(){return su()})();return t.forEach(((d,p)=>{const v=s.get(p.key);a.has(p.key)&&(v===void 0||v.mutation instanceof Na)?l=l.insert(p.key,p):v!==void 0?(u.set(p.key,v.mutation.getFieldMask()),au(v.mutation,p,v.mutation.getFieldMask(),en.now())):u.set(p.key,Oi.empty())})),this.recalculateAndSaveOverlays(e,l).next((d=>(d.forEach(((p,v)=>u.set(p,v))),t.forEach(((p,v)=>g.set(p,new Tj(v,u.get(p)??null)))),g)))}recalculateAndSaveOverlays(e,t){const s=su();let a=new cn(((u,g)=>u-g)),l=_t();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((u=>{for(const g of u)g.keys().forEach((d=>{const p=t.get(d);if(p===null)return;let v=s.get(d)||Oi.empty();v=g.applyToLocalView(p,v),s.set(d,v);const _=(a.get(g.batchId)||_t()).add(d);a=a.insert(g.batchId,_)}))})).next((()=>{const u=[],g=a.getReverseIterator();for(;g.hasNext();){const d=g.getNext(),p=d.key,v=d.value,_=E1();v.forEach((S=>{if(!l.has(S)){const C=I1(t.get(S),s.get(S));C!==null&&_.set(S,C),l=l.add(S)}})),u.push(this.documentOverlayCache.saveOverlays(e,p,_))}return _e.waitFor(u)})).next((()=>s))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.recalculateAndSaveOverlays(e,s)))}getDocumentsMatchingQuery(e,t,s,a){return(function(u){return qe.isDocumentKey(u.path)&&u.collectionGroup===null&&u.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Ky(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,a):this.getDocumentsMatchingCollectionQuery(e,t,s,a)}getNextDocuments(e,t,s,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,a).next((l=>{const u=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,a-l.size):_e.resolve(so());let g=gu,d=l;return u.next((p=>_e.forEach(p,((v,_)=>(g<_.largestBatchId&&(g=_.largestBatchId),l.get(v)?_e.resolve():this.remoteDocumentCache.getEntry(e,v).next((S=>{d=d.insert(v,S)}))))).next((()=>this.populateOverlays(e,p,l))).next((()=>this.computeViews(e,d,p,_t()))).next((v=>({batchId:g,changes:w1(v)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new qe(t)).next((s=>{let a=Zc();return s.isFoundDocument()&&(a=a.insert(s.key,s)),a}))}getDocumentsMatchingCollectionGroupQuery(e,t,s,a){const l=t.collectionGroup;let u=Zc();return this.indexManager.getCollectionParents(e,l).next((g=>_e.forEach(g,(d=>{const p=(function(_,S){return new Ia(S,null,_.explicitOrderBy.slice(),_.filters.slice(),_.limit,_.limitType,_.startAt,_.endAt)})(t,d.child(l));return this.getDocumentsMatchingCollectionQuery(e,p,s,a).next((v=>{v.forEach(((_,S)=>{u=u.insert(_,S)}))}))})).next((()=>u))))}getDocumentsMatchingCollectionQuery(e,t,s,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next((u=>(l=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,l,a)))).next((u=>{l.forEach(((d,p)=>{const v=p.getKey();u.get(v)===null&&(u=u.insert(v,ii.newInvalidDocument(v)))}));let g=Zc();return u.forEach(((d,p)=>{const v=l.get(d);v!==void 0&&au(v.mutation,p,Oi.empty(),en.now()),Rf(t,p)&&(g=g.insert(d,p))})),g}))}}class Cj{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return _e.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(a){return{id:a.id,version:a.version,createTime:Lr(a.createTime)}})(t)),_e.resolve()}getNamedQuery(e,t){return _e.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(a){return{name:a.name,query:gj(a.bundledQuery),readTime:Lr(a.readTime)}})(t)),_e.resolve()}}class xj{constructor(){this.overlays=new cn(qe.comparator),this.qr=new Map}getOverlay(e,t){return _e.resolve(this.overlays.get(t))}getOverlays(e,t){const s=so();return _e.forEach(t,(a=>this.getOverlay(e,a).next((l=>{l!==null&&s.set(a,l)})))).next((()=>s))}saveOverlays(e,t,s){return s.forEach(((a,l)=>{this.St(e,t,l)})),_e.resolve()}removeOverlaysForBatchId(e,t,s){const a=this.qr.get(s);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.qr.delete(s)),_e.resolve()}getOverlaysForCollection(e,t,s){const a=so(),l=t.length+1,u=new qe(t.child("")),g=this.overlays.getIteratorFrom(u);for(;g.hasNext();){const d=g.getNext().value,p=d.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===l&&d.largestBatchId>s&&a.set(d.getKey(),d)}return _e.resolve(a)}getOverlaysForCollectionGroup(e,t,s,a){let l=new cn(((p,v)=>p-v));const u=this.overlays.getIterator();for(;u.hasNext();){const p=u.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>s){let v=l.get(p.largestBatchId);v===null&&(v=so(),l=l.insert(p.largestBatchId,v)),v.set(p.getKey(),p)}}const g=so(),d=l.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach(((p,v)=>g.set(p,v))),!(g.size()>=a)););return _e.resolve(g)}St(e,t,s){const a=this.overlays.get(s.key);if(a!==null){const u=this.qr.get(a.largestBatchId).delete(s.key);this.qr.set(a.largestBatchId,u)}this.overlays=this.overlays.insert(s.key,new GO(t,s));let l=this.qr.get(t);l===void 0&&(l=_t(),this.qr.set(t,l)),this.qr.set(t,l.add(s.key))}}class Rj{constructor(){this.sessionToken=Jn.EMPTY_BYTE_STRING}getSessionToken(e){return _e.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,_e.resolve()}}class ev{constructor(){this.Qr=new Un(qn.$r),this.Ur=new Un(qn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const s=new qn(e,t);this.Qr=this.Qr.add(s),this.Ur=this.Ur.add(s)}Wr(e,t){e.forEach((s=>this.addReference(s,t)))}removeReference(e,t){this.Gr(new qn(e,t))}zr(e,t){e.forEach((s=>this.removeReference(s,t)))}jr(e){const t=new qe(new Kt([])),s=new qn(t,e),a=new qn(t,e+1),l=[];return this.Ur.forEachInRange([s,a],(u=>{this.Gr(u),l.push(u.key)})),l}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new qe(new Kt([])),s=new qn(t,e),a=new qn(t,e+1);let l=_t();return this.Ur.forEachInRange([s,a],(u=>{l=l.add(u.key)})),l}containsKey(e){const t=new qn(e,0),s=this.Qr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class qn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return qe.comparator(e.key,t.key)||vt(e.Yr,t.Yr)}static Kr(e,t){return vt(e.Yr,t.Yr)||qe.comparator(e.key,t.key)}}class Ij{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Un(qn.$r)}checkEmpty(e){return _e.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,a){const l=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new qO(l,t,s,a);this.mutationQueue.push(u);for(const g of a)this.Zr=this.Zr.add(new qn(g.key,l)),this.indexManager.addToCollectionParentIndex(e,g.key.path.popLast());return _e.resolve(u)}lookupMutationBatch(e,t){return _e.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,a=this.ei(s),l=a<0?0:a;return _e.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return _e.resolve(this.mutationQueue.length===0?qy:this.tr-1)}getAllMutationBatches(e){return _e.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new qn(t,0),a=new qn(t,Number.POSITIVE_INFINITY),l=[];return this.Zr.forEachInRange([s,a],(u=>{const g=this.Xr(u.Yr);l.push(g)})),_e.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new Un(vt);return t.forEach((a=>{const l=new qn(a,0),u=new qn(a,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([l,u],(g=>{s=s.add(g.Yr)}))})),_e.resolve(this.ti(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,a=s.length+1;let l=s;qe.isDocumentKey(l)||(l=l.child(""));const u=new qn(new qe(l),0);let g=new Un(vt);return this.Zr.forEachWhile((d=>{const p=d.key.path;return!!s.isPrefixOf(p)&&(p.length===a&&(g=g.add(d.Yr)),!0)}),u),_e.resolve(this.ti(g))}ti(e){const t=[];return e.forEach((s=>{const a=this.Xr(s);a!==null&&t.push(a)})),t}removeMutationBatch(e,t){Pt(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Zr;return _e.forEach(t.mutations,(a=>{const l=new qn(a.key,t.batchId);return s=s.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Zr=s}))}ir(e){}containsKey(e,t){const s=new qn(t,0),a=this.Zr.firstAfterOrEqual(s);return _e.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,_e.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Nj{constructor(e){this.ri=e,this.docs=(function(){return new cn(qe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,a=this.docs.get(s),l=a?a.size:0,u=this.ri(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:u}),this.size+=u-l,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return _e.resolve(s?s.document.mutableCopy():ii.newInvalidDocument(t))}getEntries(e,t){let s=ws();return t.forEach((a=>{const l=this.docs.get(a);s=s.insert(a,l?l.document.mutableCopy():ii.newInvalidDocument(a))})),_e.resolve(s)}getDocumentsMatchingQuery(e,t,s,a){let l=ws();const u=t.path,g=new qe(u.child("__id-9223372036854775808__")),d=this.docs.getIteratorFrom(g);for(;d.hasNext();){const{key:p,value:{document:v}}=d.getNext();if(!u.isPrefixOf(p.path))break;p.path.length>u.length+1||sO(rO(v),s)<=0||(a.has(v.key)||Rf(t,v))&&(l=l.insert(v.key,v.mutableCopy()))}return _e.resolve(l)}getAllFromCollectionGroup(e,t,s,a){Ye(9500)}ii(e,t){return _e.forEach(this.docs,(s=>t(s)))}newChangeBuffer(e){return new Dj(this)}getSize(e){return _e.resolve(this.size)}}class Dj extends Ej{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((s,a)=>{a.isValidDocument()?t.push(this.Nr.addEntry(e,a)):this.Nr.removeEntry(s)})),_e.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class Mj{constructor(e){this.persistence=e,this.si=new wo((t=>$y(t)),Qy),this.lastRemoteSnapshotVersion=Je.min(),this.highestTargetId=0,this.oi=0,this._i=new ev,this.targetCount=0,this.ai=jl.ur()}forEachTarget(e,t){return this.si.forEach(((s,a)=>t(a))),_e.resolve()}getLastRemoteSnapshotVersion(e){return _e.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return _e.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),_e.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.oi&&(this.oi=t),_e.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new jl(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,_e.resolve()}updateTargetData(e,t){return this.Pr(t),_e.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,_e.resolve()}removeTargets(e,t,s){let a=0;const l=[];return this.si.forEach(((u,g)=>{g.sequenceNumber<=t&&s.get(g.targetId)===null&&(this.si.delete(u),l.push(this.removeMatchingKeysForTargetId(e,g.targetId)),a++)})),_e.waitFor(l).next((()=>a))}getTargetCount(e){return _e.resolve(this.targetCount)}getTargetData(e,t){const s=this.si.get(t)||null;return _e.resolve(s)}addMatchingKeys(e,t,s){return this._i.Wr(t,s),_e.resolve()}removeMatchingKeys(e,t,s){this._i.zr(t,s);const a=this.persistence.referenceDelegate,l=[];return a&&t.forEach((u=>{l.push(a.markPotentiallyOrphaned(e,u))})),_e.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),_e.resolve()}getMatchingKeysForTargetId(e,t){const s=this._i.Hr(t);return _e.resolve(s)}containsKey(e,t){return _e.resolve(this._i.containsKey(t))}}class H1{constructor(e,t){this.ui={},this.overlays={},this.ci=new Ef(0),this.li=!1,this.li=!0,this.hi=new Rj,this.referenceDelegate=e(this),this.Pi=new Mj(this),this.indexManager=new pj,this.remoteDocumentCache=(function(a){return new Nj(a)})((s=>this.referenceDelegate.Ti(s))),this.serializer=new mj(t),this.Ii=new Cj(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new xj,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.ui[e.toKey()];return s||(s=new Ij(t,this.referenceDelegate),this.ui[e.toKey()]=s),s}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,s){je("MemoryPersistence","Starting transaction:",e);const a=new Oj(this.ci.next());return this.referenceDelegate.Ei(),s(a).next((l=>this.referenceDelegate.di(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ai(e,t){return _e.or(Object.values(this.ui).map((s=>()=>s.containsKey(e,t))))}}class Oj extends oO{constructor(e){super(),this.currentSequenceNumber=e}}class tv{constructor(e){this.persistence=e,this.Ri=new ev,this.Vi=null}static mi(e){return new tv(e)}get fi(){if(this.Vi)return this.Vi;throw Ye(60996)}addReference(e,t,s){return this.Ri.addReference(s,t),this.fi.delete(s.toString()),_e.resolve()}removeReference(e,t,s){return this.Ri.removeReference(s,t),this.fi.add(s.toString()),_e.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),_e.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((a=>this.fi.add(a.toString())));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next((a=>{a.forEach((l=>this.fi.add(l.toString())))})).next((()=>s.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return _e.forEach(this.fi,(s=>{const a=qe.fromPath(s);return this.gi(e,a).next((l=>{l||t.removeEntry(a,Je.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((s=>{s?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return _e.or([()=>_e.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class sf{constructor(e,t){this.persistence=e,this.pi=new wo((s=>uO(s.path)),((s,a)=>s.isEqual(a))),this.garbageCollector=wj(this,t)}static mi(e,t){return new sf(e,t)}Ei(){}di(e){return _e.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((s=>t.next((a=>s+a))))}wr(e){let t=0;return this.pr(e,(s=>{t++})).next((()=>t))}pr(e,t){return _e.forEach(this.pi,((s,a)=>this.br(e,s,a).next((l=>l?_e.resolve():t(a)))))}removeTargets(e,t,s){return this.persistence.getTargetCache().removeTargets(e,t,s)}removeOrphanedDocuments(e,t){let s=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ii(e,(u=>this.br(e,u,t).next((g=>{g||(s++,l.removeEntry(u,Je.min()))})))).next((()=>l.apply(e))).next((()=>s))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),_e.resolve()}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),_e.resolve()}removeReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),_e.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),_e.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Pd(e.data.value)),t}br(e,t,s){return _e.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const a=this.pi.get(t);return _e.resolve(a!==void 0&&a>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class nv{constructor(e,t,s,a){this.targetId=e,this.fromCache=t,this.Es=s,this.ds=a}static As(e,t){let s=_t(),a=_t();for(const l of t.docChanges)switch(l.type){case 0:s=s.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new nv(e,t.fromCache,s,a)}}class jj{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class kj{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return CN()?8:lO(si())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,s,a){const l={result:null};return this.ys(e,t).next((u=>{l.result=u})).next((()=>{if(!l.result)return this.ws(e,t,a,s).next((u=>{l.result=u}))})).next((()=>{if(l.result)return;const u=new jj;return this.Ss(e,t,u).next((g=>{if(l.result=g,this.Vs)return this.bs(e,t,u,g.size)}))})).next((()=>l.result))}bs(e,t,s,a){return s.documentReadCount<this.fs?(gl()<=yt.DEBUG&&je("QueryEngine","SDK will not create cache indexes for query:",pl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),_e.resolve()):(gl()<=yt.DEBUG&&je("QueryEngine","Query:",pl(t),"scans",s.documentReadCount,"local documents and returns",a,"documents as results."),s.documentReadCount>this.gs*a?(gl()<=yt.DEBUG&&je("QueryEngine","The SDK decides to create cache indexes for query:",pl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Vr(t))):_e.resolve())}ys(e,t){if(yw(t))return _e.resolve(null);let s=Vr(t);return this.indexManager.getIndexType(e,s).next((a=>a===0?null:(t.limit!==null&&a===1&&(t=ef(t,null,"F"),s=Vr(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next((l=>{const u=_t(...l);return this.ps.getDocuments(e,u).next((g=>this.indexManager.getMinOffset(e,s).next((d=>{const p=this.Ds(t,g);return this.Cs(t,p,u,d.readTime)?this.ys(e,ef(t,null,"F")):this.vs(e,p,t,d)}))))})))))}ws(e,t,s,a){return yw(t)||a.isEqual(Je.min())?_e.resolve(null):this.ps.getDocuments(e,s).next((l=>{const u=this.Ds(t,l);return this.Cs(t,u,s,a)?_e.resolve(null):(gl()<=yt.DEBUG&&je("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),pl(t)),this.vs(e,u,t,iO(a,gu)).next((g=>g)))}))}Ds(e,t){let s=new Un(b1(e));return t.forEach(((a,l)=>{Rf(e,l)&&(s=s.add(l))})),s}Cs(e,t,s,a){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}Ss(e,t,s){return gl()<=yt.DEBUG&&je("QueryEngine","Using full collection scan to execute query:",pl(t)),this.ps.getDocumentsMatchingQuery(e,t,_a.min(),s)}vs(e,t,s,a){return this.ps.getDocumentsMatchingQuery(e,s,a).next((l=>(t.forEach((u=>{l=l.insert(u.key,u)})),l)))}}const iv="LocalStore",Pj=3e8;class Vj{constructor(e,t,s,a){this.persistence=e,this.Fs=t,this.serializer=a,this.Ms=new cn(vt),this.xs=new wo((l=>$y(l)),Qy),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(s)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Aj(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function Lj(n,e,t,s){return new Vj(n,e,t,s)}async function q1(n,e){const t=nt(n);return await t.persistence.runTransaction("Handle user change","readonly",(s=>{let a;return t.mutationQueue.getAllMutationBatches(s).next((l=>(a=l,t.Bs(e),t.mutationQueue.getAllMutationBatches(s)))).next((l=>{const u=[],g=[];let d=_t();for(const p of a){u.push(p.batchId);for(const v of p.mutations)d=d.add(v.key)}for(const p of l){g.push(p.batchId);for(const v of p.mutations)d=d.add(v.key)}return t.localDocuments.getDocuments(s,d).next((p=>({Ls:p,removedBatchIds:u,addedBatchIds:g})))}))}))}function Uj(n,e){const t=nt(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(s=>{const a=e.batch.keys(),l=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(g,d,p,v){const _=p.batch,S=_.keys();let C=_e.resolve();return S.forEach((O=>{C=C.next((()=>v.getEntry(d,O))).next((L=>{const U=p.docVersions.get(O);Pt(U!==null,48541),L.version.compareTo(U)<0&&(_.applyToRemoteDocument(L,p),L.isValidDocument()&&(L.setReadTime(p.commitVersion),v.addEntry(L)))}))})),C.next((()=>g.mutationQueue.removeMutationBatch(d,_)))})(t,s,e,l).next((()=>l.apply(s))).next((()=>t.mutationQueue.performConsistencyCheck(s))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(s,a,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,(function(g){let d=_t();for(let p=0;p<g.mutationResults.length;++p)g.mutationResults[p].transformResults.length>0&&(d=d.add(g.batch.mutations[p].key));return d})(e)))).next((()=>t.localDocuments.getDocuments(s,a)))}))}function G1(n){const e=nt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function zj(n,e){const t=nt(n),s=e.snapshotVersion;let a=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const u=t.Ns.newChangeBuffer({trackRemovals:!0});a=t.Ms;const g=[];e.targetChanges.forEach(((v,_)=>{const S=a.get(_);if(!S)return;g.push(t.Pi.removeMatchingKeys(l,v.removedDocuments,_).next((()=>t.Pi.addMatchingKeys(l,v.addedDocuments,_))));let C=S.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(_)!==null?C=C.withResumeToken(Jn.EMPTY_BYTE_STRING,Je.min()).withLastLimboFreeSnapshotVersion(Je.min()):v.resumeToken.approximateByteSize()>0&&(C=C.withResumeToken(v.resumeToken,s)),a=a.insert(_,C),(function(L,U,z){return L.resumeToken.approximateByteSize()===0||U.snapshotVersion.toMicroseconds()-L.snapshotVersion.toMicroseconds()>=Pj?!0:z.addedDocuments.size+z.modifiedDocuments.size+z.removedDocuments.size>0})(S,C,v)&&g.push(t.Pi.updateTargetData(l,C))}));let d=ws(),p=_t();if(e.documentUpdates.forEach((v=>{e.resolvedLimboDocuments.has(v)&&g.push(t.persistence.referenceDelegate.updateLimboDocument(l,v))})),g.push(Bj(l,u,e.documentUpdates).next((v=>{d=v.ks,p=v.qs}))),!s.isEqual(Je.min())){const v=t.Pi.getLastRemoteSnapshotVersion(l).next((_=>t.Pi.setTargetsMetadata(l,l.currentSequenceNumber,s)));g.push(v)}return _e.waitFor(g).next((()=>u.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,d,p))).next((()=>d))})).then((l=>(t.Ms=a,l)))}function Bj(n,e,t){let s=_t(),a=_t();return t.forEach((l=>s=s.add(l))),e.getEntries(n,s).next((l=>{let u=ws();return t.forEach(((g,d)=>{const p=l.get(g);d.isFoundDocument()!==p.isFoundDocument()&&(a=a.add(g)),d.isNoDocument()&&d.version.isEqual(Je.min())?(e.removeEntry(g,d.readTime),u=u.insert(g,d)):!p.isValidDocument()||d.version.compareTo(p.version)>0||d.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(d),u=u.insert(g,d)):je(iv,"Ignoring outdated watch update for ",g,". Current version:",p.version," Watch version:",d.version)})),{ks:u,qs:a}}))}function Fj(n,e){const t=nt(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(s=>(e===void 0&&(e=qy),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e))))}function Hj(n,e){const t=nt(n);return t.persistence.runTransaction("Allocate target","readwrite",(s=>{let a;return t.Pi.getTargetData(s,e).next((l=>l?(a=l,_e.resolve(a)):t.Pi.allocateTargetId(s).next((u=>(a=new ha(e,u,"TargetPurposeListen",s.currentSequenceNumber),t.Pi.addTargetData(s,a).next((()=>a)))))))})).then((s=>{const a=t.Ms.get(s.targetId);return(a===null||s.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(s.targetId,s),t.xs.set(e,s.targetId)),s}))}async function Kp(n,e,t){const s=nt(n),a=s.Ms.get(e),l=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",l,(u=>s.persistence.referenceDelegate.removeTarget(u,a)))}catch(u){if(!Fl(u))throw u;je(iv,`Failed to update sequence numbers for target ${e}: ${u}`)}s.Ms=s.Ms.remove(e),s.xs.delete(a.target)}function Nw(n,e,t){const s=nt(n);let a=Je.min(),l=_t();return s.persistence.runTransaction("Execute query","readwrite",(u=>(function(d,p,v){const _=nt(d),S=_.xs.get(v);return S!==void 0?_e.resolve(_.Ms.get(S)):_.Pi.getTargetData(p,v)})(s,u,Vr(e)).next((g=>{if(g)return a=g.lastLimboFreeSnapshotVersion,s.Pi.getMatchingKeysForTargetId(u,g.targetId).next((d=>{l=d}))})).next((()=>s.Fs.getDocumentsMatchingQuery(u,e,t?a:Je.min(),t?l:_t()))).next((g=>(qj(s,IO(e),g),{documents:g,Qs:l})))))}function qj(n,e,t){let s=n.Os.get(e)||Je.min();t.forEach(((a,l)=>{l.readTime.compareTo(s)>0&&(s=l.readTime)})),n.Os.set(e,s)}class Dw{constructor(){this.activeTargetIds=kO()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Gj{constructor(){this.Mo=new Dw,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,s){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Dw,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class $j{Oo(e){}shutdown(){}}const Mw="ConnectivityMonitor";class Ow{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){je(Mw,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){je(Mw,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let pd=null;function Wp(){return pd===null?pd=(function(){return 268435456+Math.round(2147483648*Math.random())})():pd++,"0x"+pd.toString(16)}const sp="RestConnection",Qj={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Yj{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${s}/databases/${a}`,this.Wo=this.databaseId.database===Xd?`project_id=${s}`:`project_id=${s}&database_id=${a}`}Go(e,t,s,a,l){const u=Wp(),g=this.zo(e,t.toUriEncodedString());je(sp,`Sending RPC '${e}' ${u}:`,g,s);const d={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(d,a,l);const{host:p}=new URL(g),v=xa(p);return this.Jo(e,g,d,s,v).then((_=>(je(sp,`Received RPC '${e}' ${u}: `,_),_)),(_=>{throw Il(sp,`RPC '${e}' ${u} failed with error: `,_,"url: ",g,"request:",s),_}))}Ho(e,t,s,a,l,u){return this.Go(e,t,s,a,l)}jo(e,t,s){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+zl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((a,l)=>e[l]=a)),s&&s.headers.forEach(((a,l)=>e[l]=a))}zo(e,t){const s=Qj[e];return`${this.Uo}/v1/${t}:${s}`}terminate(){}}class Kj{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const ti="WebChannelConnection";class Wj extends Yj{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,s,a,l){const u=Wp();return new Promise(((g,d)=>{const p=new YT;p.setWithCredentials(!0),p.listenOnce(KT.COMPLETE,(()=>{try{switch(p.getLastErrorCode()){case kd.NO_ERROR:const _=p.getResponseJson();je(ti,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(_)),g(_);break;case kd.TIMEOUT:je(ti,`RPC '${e}' ${u} timed out`),d(new Ie(ge.DEADLINE_EXCEEDED,"Request time out"));break;case kd.HTTP_ERROR:const S=p.getStatus();if(je(ti,`RPC '${e}' ${u} failed with status:`,S,"response text:",p.getResponseText()),S>0){let C=p.getResponseJson();Array.isArray(C)&&(C=C[0]);const O=C?.error;if(O&&O.status&&O.message){const L=(function(z){const X=z.toLowerCase().replace(/_/g,"-");return Object.values(ge).indexOf(X)>=0?X:ge.UNKNOWN})(O.status);d(new Ie(L,O.message))}else d(new Ie(ge.UNKNOWN,"Server responded with status "+p.getStatus()))}else d(new Ie(ge.UNAVAILABLE,"Connection failed."));break;default:Ye(9055,{l_:e,streamId:u,h_:p.getLastErrorCode(),P_:p.getLastError()})}}finally{je(ti,`RPC '${e}' ${u} completed.`)}}));const v=JSON.stringify(a);je(ti,`RPC '${e}' ${u} sending request:`,a),p.send(t,"POST",v,s,15)}))}T_(e,t,s){const a=Wp(),l=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=ZT(),g=XT(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(d.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(d.useFetchStreams=!0),this.jo(d.initMessageHeaders,t,s),d.encodeInitMessageHeaders=!0;const v=l.join("");je(ti,`Creating RPC '${e}' stream ${a}: ${v}`,d);const _=u.createWebChannel(v,d);this.I_(_);let S=!1,C=!1;const O=new Kj({Yo:U=>{C?je(ti,`Not sending because RPC '${e}' stream ${a} is closed:`,U):(S||(je(ti,`Opening RPC '${e}' stream ${a} transport.`),_.open(),S=!0),je(ti,`RPC '${e}' stream ${a} sending:`,U),_.send(U))},Zo:()=>_.close()}),L=(U,z,X)=>{U.listen(z,(q=>{try{X(q)}catch(ne){setTimeout((()=>{throw ne}),0)}}))};return L(_,Xc.EventType.OPEN,(()=>{C||(je(ti,`RPC '${e}' stream ${a} transport opened.`),O.o_())})),L(_,Xc.EventType.CLOSE,(()=>{C||(C=!0,je(ti,`RPC '${e}' stream ${a} transport closed`),O.a_(),this.E_(_))})),L(_,Xc.EventType.ERROR,(U=>{C||(C=!0,Il(ti,`RPC '${e}' stream ${a} transport errored. Name:`,U.name,"Message:",U.message),O.a_(new Ie(ge.UNAVAILABLE,"The operation could not be completed")))})),L(_,Xc.EventType.MESSAGE,(U=>{if(!C){const z=U.data[0];Pt(!!z,16349);const X=z,q=X?.error||X[0]?.error;if(q){je(ti,`RPC '${e}' stream ${a} received error:`,q);const ne=q.status;let ee=(function(M){const P=Nn[M];if(P!==void 0)return M1(P)})(ne),de=q.message;ee===void 0&&(ee=ge.INTERNAL,de="Unknown error status: "+ne+" with message "+q.message),C=!0,O.a_(new Ie(ee,de)),_.close()}else je(ti,`RPC '${e}' stream ${a} received:`,z),O.u_(z)}})),L(g,WT.STAT_EVENT,(U=>{U.stat===Lp.PROXY?je(ti,`RPC '${e}' stream ${a} detected buffering proxy`):U.stat===Lp.NOPROXY&&je(ti,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{O.__()}),0),O}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function ap(){return typeof document<"u"?document:null}function Mf(n){return new ej(n,!0)}class $1{constructor(e,t,s=1e3,a=1.5,l=6e4){this.Mi=e,this.timerId=t,this.d_=s,this.A_=a,this.R_=l,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),s=Math.max(0,Date.now()-this.f_),a=Math.max(0,t-s);a>0&&je("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const jw="PersistentStream";class Q1{constructor(e,t,s,a,l,u,g,d){this.Mi=e,this.S_=s,this.b_=a,this.connection=l,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=g,this.listener=d,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new $1(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ge.RESOURCE_EXHAUSTED?(Ss(t.toString()),Ss("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ge.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([s,a])=>{this.D_===t&&this.G_(s,a)}),(s=>{e((()=>{const a=new Ie(ge.UNKNOWN,"Fetching auth token failed: "+s.message);return this.z_(a)}))}))}G_(e,t){const s=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{s((()=>this.listener.Xo()))})),this.stream.t_((()=>{s((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((a=>{s((()=>this.z_(a)))})),this.stream.onMessage((a=>{s((()=>++this.F_==1?this.J_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return je(jw,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(je(jw,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Xj extends Q1{constructor(e,t,s,a,l,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,a,u),this.serializer=l}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=ij(this.serializer,e),s=(function(l){if(!("targetChange"in l))return Je.min();const u=l.targetChange;return u.targetIds&&u.targetIds.length?Je.min():u.readTime?Lr(u.readTime):Je.min()})(e);return this.listener.H_(t,s)}Y_(e){const t={};t.database=Yp(this.serializer),t.addTarget=(function(l,u){let g;const d=u.target;if(g=Hp(d)?{documents:aj(l,d)}:{query:oj(l,d).ft},g.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){g.resumeToken=k1(l,u.resumeToken);const p=Gp(l,u.expectedCount);p!==null&&(g.expectedCount=p)}else if(u.snapshotVersion.compareTo(Je.min())>0){g.readTime=rf(l,u.snapshotVersion.toTimestamp());const p=Gp(l,u.expectedCount);p!==null&&(g.expectedCount=p)}return g})(this.serializer,e);const s=cj(this.serializer,e);s&&(t.labels=s),this.q_(t)}Z_(e){const t={};t.database=Yp(this.serializer),t.removeTarget=e,this.q_(t)}}class Zj extends Q1{constructor(e,t,s,a,l,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,a,u),this.serializer=l}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Pt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Pt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Pt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=sj(e.writeResults,e.commitTime),s=Lr(e.commitTime);return this.listener.na(s,t)}ra(){const e={};e.database=Yp(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((s=>rj(this.serializer,s)))};this.q_(t)}}class Jj{}class ek extends Jj{constructor(e,t,s,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new Ie(ge.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,s,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,u])=>this.connection.Go(e,$p(t,s),a,l,u))).catch((l=>{throw l.name==="FirebaseError"?(l.code===ge.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Ie(ge.UNKNOWN,l.toString())}))}Ho(e,t,s,a,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,g])=>this.connection.Ho(e,$p(t,s),a,u,g,l))).catch((u=>{throw u.name==="FirebaseError"?(u.code===ge.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new Ie(ge.UNKNOWN,u.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class tk{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ss(t),this.aa=!1):je("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const go="RemoteStore";class nk{constructor(e,t,s,a,l){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=l,this.Aa.Oo((u=>{s.enqueueAndForget((async()=>{Eo(this)&&(je(go,"Restarting streams for network reachability change."),await(async function(d){const p=nt(d);p.Ea.add(4),await Pu(p),p.Ra.set("Unknown"),p.Ea.delete(4),await Of(p)})(this))}))})),this.Ra=new tk(s,a)}}async function Of(n){if(Eo(n))for(const e of n.da)await e(!0)}async function Pu(n){for(const e of n.da)await e(!1)}function Y1(n,e){const t=nt(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),ov(t)?av(t):Hl(t).O_()&&sv(t,e))}function rv(n,e){const t=nt(n),s=Hl(t);t.Ia.delete(e),s.O_()&&K1(t,e),t.Ia.size===0&&(s.O_()?s.L_():Eo(t)&&t.Ra.set("Unknown"))}function sv(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Je.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Hl(n).Y_(e)}function K1(n,e){n.Va.Ue(e),Hl(n).Z_(e)}function av(n){n.Va=new WO({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Hl(n).start(),n.Ra.ua()}function ov(n){return Eo(n)&&!Hl(n).x_()&&n.Ia.size>0}function Eo(n){return nt(n).Ea.size===0}function W1(n){n.Va=void 0}async function ik(n){n.Ra.set("Online")}async function rk(n){n.Ia.forEach(((e,t)=>{sv(n,e)}))}async function sk(n,e){W1(n),ov(n)?(n.Ra.ha(e),av(n)):n.Ra.set("Unknown")}async function ak(n,e,t){if(n.Ra.set("Online"),e instanceof j1&&e.state===2&&e.cause)try{await(async function(a,l){const u=l.cause;for(const g of l.targetIds)a.Ia.has(g)&&(await a.remoteSyncer.rejectListen(g,u),a.Ia.delete(g),a.Va.removeTarget(g))})(n,e)}catch(s){je(go,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await af(n,s)}else if(e instanceof Ud?n.Va.Ze(e):e instanceof O1?n.Va.st(e):n.Va.tt(e),!t.isEqual(Je.min()))try{const s=await G1(n.localStore);t.compareTo(s)>=0&&await(function(l,u){const g=l.Va.Tt(u);return g.targetChanges.forEach(((d,p)=>{if(d.resumeToken.approximateByteSize()>0){const v=l.Ia.get(p);v&&l.Ia.set(p,v.withResumeToken(d.resumeToken,u))}})),g.targetMismatches.forEach(((d,p)=>{const v=l.Ia.get(d);if(!v)return;l.Ia.set(d,v.withResumeToken(Jn.EMPTY_BYTE_STRING,v.snapshotVersion)),K1(l,d);const _=new ha(v.target,d,p,v.sequenceNumber);sv(l,_)})),l.remoteSyncer.applyRemoteEvent(g)})(n,t)}catch(s){je(go,"Failed to raise snapshot:",s),await af(n,s)}}async function af(n,e,t){if(!Fl(e))throw e;n.Ea.add(1),await Pu(n),n.Ra.set("Offline"),t||(t=()=>G1(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{je(go,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Of(n)}))}function X1(n,e){return e().catch((t=>af(n,t,e)))}async function jf(n){const e=nt(n),t=Ea(e);let s=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:qy;for(;ok(e);)try{const a=await Fj(e.localStore,s);if(a===null){e.Ta.length===0&&t.L_();break}s=a.batchId,lk(e,a)}catch(a){await af(e,a)}Z1(e)&&J1(e)}function ok(n){return Eo(n)&&n.Ta.length<10}function lk(n,e){n.Ta.push(e);const t=Ea(n);t.O_()&&t.X_&&t.ea(e.mutations)}function Z1(n){return Eo(n)&&!Ea(n).x_()&&n.Ta.length>0}function J1(n){Ea(n).start()}async function ck(n){Ea(n).ra()}async function uk(n){const e=Ea(n);for(const t of n.Ta)e.ea(t.mutations)}async function hk(n,e,t){const s=n.Ta.shift(),a=Xy.from(s,e,t);await X1(n,(()=>n.remoteSyncer.applySuccessfulWrite(a))),await jf(n)}async function dk(n,e){e&&Ea(n).X_&&await(async function(s,a){if((function(u){return QO(u)&&u!==ge.ABORTED})(a.code)){const l=s.Ta.shift();Ea(s).B_(),await X1(s,(()=>s.remoteSyncer.rejectFailedWrite(l.batchId,a))),await jf(s)}})(n,e),Z1(n)&&J1(n)}async function kw(n,e){const t=nt(n);t.asyncQueue.verifyOperationInProgress(),je(go,"RemoteStore received new credentials");const s=Eo(t);t.Ea.add(3),await Pu(t),s&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Of(t)}async function fk(n,e){const t=nt(n);e?(t.Ea.delete(2),await Of(t)):e||(t.Ea.add(2),await Pu(t),t.Ra.set("Unknown"))}function Hl(n){return n.ma||(n.ma=(function(t,s,a){const l=nt(t);return l.sa(),new Xj(s,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Xo:ik.bind(null,n),t_:rk.bind(null,n),r_:sk.bind(null,n),H_:ak.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),ov(n)?av(n):n.Ra.set("Unknown")):(await n.ma.stop(),W1(n))}))),n.ma}function Ea(n){return n.fa||(n.fa=(function(t,s,a){const l=nt(t);return l.sa(),new Zj(s,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:ck.bind(null,n),r_:dk.bind(null,n),ta:uk.bind(null,n),na:hk.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await jf(n)):(await n.fa.stop(),n.Ta.length>0&&(je(go,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class lv{constructor(e,t,s,a,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=a,this.removalCallback=l,this.deferred=new ys,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((u=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,a,l){const u=Date.now()+s,g=new lv(e,t,u,a,l);return g.start(s),g}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ie(ge.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function cv(n,e){if(Ss("AsyncQueue",`${e}: ${n}`),Fl(n))return new Ie(ge.UNAVAILABLE,`${e}: ${n}`);throw n}class Al{static emptySet(e){return new Al(e.comparator)}constructor(e){this.comparator=e?(t,s)=>e(t,s)||qe.comparator(t.key,s.key):(t,s)=>qe.comparator(t.key,s.key),this.keyedMap=Zc(),this.sortedSet=new cn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,s)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Al)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=s.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new Al;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}class Pw{constructor(){this.ga=new cn(qe.comparator)}track(e){const t=e.doc.key,s=this.ga.get(t);s?e.type!==0&&s.type===3?this.ga=this.ga.insert(t,e):e.type===3&&s.type!==1?this.ga=this.ga.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.ga=this.ga.remove(t):e.type===1&&s.type===2?this.ga=this.ga.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Ye(63341,{Rt:e,pa:s}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,s)=>{e.push(s)})),e}}class kl{constructor(e,t,s,a,l,u,g,d,p){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=a,this.mutatedKeys=l,this.fromCache=u,this.syncStateChanged=g,this.excludesMetadataChanges=d,this.hasCachedResults=p}static fromInitialDocuments(e,t,s,a,l){const u=[];return t.forEach((g=>{u.push({type:0,doc:g})})),new kl(e,t,Al.emptySet(t),u,s,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&xf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==s[a].type||!t[a].doc.isEqual(s[a].doc))return!1;return!0}}class mk{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class gk{constructor(){this.queries=Vw(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,s){const a=nt(t),l=a.queries;a.queries=Vw(),l.forEach(((u,g)=>{for(const d of g.Sa)d.onError(s)}))})(this,new Ie(ge.ABORTED,"Firestore shutting down"))}}function Vw(){return new wo((n=>_1(n)),xf)}async function eA(n,e){const t=nt(n);let s=3;const a=e.query;let l=t.queries.get(a);l?!l.ba()&&e.Da()&&(s=2):(l=new mk,s=e.Da()?0:1);try{switch(s){case 0:l.wa=await t.onListen(a,!0);break;case 1:l.wa=await t.onListen(a,!1);break;case 2:await t.onFirstRemoteStoreListen(a)}}catch(u){const g=cv(u,`Initialization of query '${pl(e.query)}' failed`);return void e.onError(g)}t.queries.set(a,l),l.Sa.push(e),e.va(t.onlineState),l.wa&&e.Fa(l.wa)&&uv(t)}async function tA(n,e){const t=nt(n),s=e.query;let a=3;const l=t.queries.get(s);if(l){const u=l.Sa.indexOf(e);u>=0&&(l.Sa.splice(u,1),l.Sa.length===0?a=e.Da()?0:1:!l.ba()&&e.Da()&&(a=2))}switch(a){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function pk(n,e){const t=nt(n);let s=!1;for(const a of e){const l=a.query,u=t.queries.get(l);if(u){for(const g of u.Sa)g.Fa(a)&&(s=!0);u.wa=a}}s&&uv(t)}function yk(n,e,t){const s=nt(n),a=s.queries.get(e);if(a)for(const l of a.Sa)l.onError(t);s.queries.delete(e)}function uv(n){n.Ca.forEach((e=>{e.next()}))}var Xp,Lw;(Lw=Xp||(Xp={})).Ma="default",Lw.Cache="cache";class nA{constructor(e,t,s){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=s||{}}Fa(e){if(!this.options.includeMetadataChanges){const s=[];for(const a of e.docChanges)a.type!==3&&s.push(a);e=new kl(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const s=t!=="Offline";return(!this.options.qa||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=kl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Xp.Cache}}class iA{constructor(e){this.key=e}}class rA{constructor(e){this.key=e}}class vk{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=_t(),this.mutatedKeys=_t(),this.eu=b1(e),this.tu=new Al(this.eu)}get nu(){return this.Ya}ru(e,t){const s=t?t.iu:new Pw,a=t?t.tu:this.tu;let l=t?t.mutatedKeys:this.mutatedKeys,u=a,g=!1;const d=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,p=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((v,_)=>{const S=a.get(v),C=Rf(this.query,_)?_:null,O=!!S&&this.mutatedKeys.has(S.key),L=!!C&&(C.hasLocalMutations||this.mutatedKeys.has(C.key)&&C.hasCommittedMutations);let U=!1;S&&C?S.data.isEqual(C.data)?O!==L&&(s.track({type:3,doc:C}),U=!0):this.su(S,C)||(s.track({type:2,doc:C}),U=!0,(d&&this.eu(C,d)>0||p&&this.eu(C,p)<0)&&(g=!0)):!S&&C?(s.track({type:0,doc:C}),U=!0):S&&!C&&(s.track({type:1,doc:S}),U=!0,(d||p)&&(g=!0)),U&&(C?(u=u.add(C),l=L?l.add(v):l.delete(v)):(u=u.delete(v),l=l.delete(v)))})),this.query.limit!==null)for(;u.size>this.query.limit;){const v=this.query.limitType==="F"?u.last():u.first();u=u.delete(v.key),l=l.delete(v.key),s.track({type:1,doc:v})}return{tu:u,iu:s,Cs:g,mutatedKeys:l}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,a){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const u=e.iu.ya();u.sort(((v,_)=>(function(C,O){const L=U=>{switch(U){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ye(20277,{Rt:U})}};return L(C)-L(O)})(v.type,_.type)||this.eu(v.doc,_.doc))),this.ou(s),a=a??!1;const g=t&&!a?this._u():[],d=this.Xa.size===0&&this.current&&!a?1:0,p=d!==this.Za;return this.Za=d,u.length!==0||p?{snapshot:new kl(this.query,e.tu,l,u,e.mutatedKeys,d===0,p,!1,!!s&&s.resumeToken.approximateByteSize()>0),au:g}:{au:g}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Pw,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=_t(),this.tu.forEach((s=>{this.uu(s.key)&&(this.Xa=this.Xa.add(s.key))}));const t=[];return e.forEach((s=>{this.Xa.has(s)||t.push(new rA(s))})),this.Xa.forEach((s=>{e.has(s)||t.push(new iA(s))})),t}cu(e){this.Ya=e.Qs,this.Xa=_t();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return kl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const hv="SyncEngine";class _k{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class bk{constructor(e){this.key=e,this.hu=!1}}class Sk{constructor(e,t,s,a,l,u){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=u,this.Pu={},this.Tu=new wo((g=>_1(g)),xf),this.Iu=new Map,this.Eu=new Set,this.du=new cn(qe.comparator),this.Au=new Map,this.Ru=new ev,this.Vu={},this.mu=new Map,this.fu=jl.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function wk(n,e,t=!0){const s=uA(n);let a;const l=s.Tu.get(e);return l?(s.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.lu()):a=await sA(s,e,t,!0),a}async function Ek(n,e){const t=uA(n);await sA(t,e,!0,!1)}async function sA(n,e,t,s){const a=await Hj(n.localStore,Vr(e)),l=a.targetId,u=n.sharedClientState.addLocalQueryTarget(l,t);let g;return s&&(g=await Tk(n,e,l,u==="current",a.resumeToken)),n.isPrimaryClient&&t&&Y1(n.remoteStore,a),g}async function Tk(n,e,t,s,a){n.pu=(_,S,C)=>(async function(L,U,z,X){let q=U.view.ru(z);q.Cs&&(q=await Nw(L.localStore,U.query,!1).then((({documents:k})=>U.view.ru(k,q))));const ne=X&&X.targetChanges.get(U.targetId),ee=X&&X.targetMismatches.get(U.targetId)!=null,de=U.view.applyChanges(q,L.isPrimaryClient,ne,ee);return zw(L,U.targetId,de.au),de.snapshot})(n,_,S,C);const l=await Nw(n.localStore,e,!0),u=new vk(e,l.Qs),g=u.ru(l.documents),d=ku.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",a),p=u.applyChanges(g,n.isPrimaryClient,d);zw(n,t,p.au);const v=new _k(e,t,u);return n.Tu.set(e,v),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),p.snapshot}async function Ak(n,e,t){const s=nt(n),a=s.Tu.get(e),l=s.Iu.get(a.targetId);if(l.length>1)return s.Iu.set(a.targetId,l.filter((u=>!xf(u,e)))),void s.Tu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(a.targetId),s.sharedClientState.isActiveQueryTarget(a.targetId)||await Kp(s.localStore,a.targetId,!1).then((()=>{s.sharedClientState.clearQueryState(a.targetId),t&&rv(s.remoteStore,a.targetId),Zp(s,a.targetId)})).catch(Bl)):(Zp(s,a.targetId),await Kp(s.localStore,a.targetId,!0))}async function Ck(n,e){const t=nt(n),s=t.Tu.get(e),a=t.Iu.get(s.targetId);t.isPrimaryClient&&a.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),rv(t.remoteStore,s.targetId))}async function xk(n,e,t){const s=jk(n);try{const a=await(function(u,g){const d=nt(u),p=en.now(),v=g.reduce(((C,O)=>C.add(O.key)),_t());let _,S;return d.persistence.runTransaction("Locally write mutations","readwrite",(C=>{let O=ws(),L=_t();return d.Ns.getEntries(C,v).next((U=>{O=U,O.forEach(((z,X)=>{X.isValidDocument()||(L=L.add(z))}))})).next((()=>d.localDocuments.getOverlayedDocuments(C,O))).next((U=>{_=U;const z=[];for(const X of g){const q=FO(X,_.get(X.key).overlayedDocument);q!=null&&z.push(new Na(X.key,q,d1(q.value.mapValue),cr.exists(!0)))}return d.mutationQueue.addMutationBatch(C,p,z,g)})).next((U=>{S=U;const z=U.applyToLocalDocumentSet(_,L);return d.documentOverlayCache.saveOverlays(C,U.batchId,z)}))})).then((()=>({batchId:S.batchId,changes:w1(_)})))})(s.localStore,e);s.sharedClientState.addPendingMutation(a.batchId),(function(u,g,d){let p=u.Vu[u.currentUser.toKey()];p||(p=new cn(vt)),p=p.insert(g,d),u.Vu[u.currentUser.toKey()]=p})(s,a.batchId,t),await Vu(s,a.changes),await jf(s.remoteStore)}catch(a){const l=cv(a,"Failed to persist write");t.reject(l)}}async function aA(n,e){const t=nt(n);try{const s=await zj(t.localStore,e);e.targetChanges.forEach(((a,l)=>{const u=t.Au.get(l);u&&(Pt(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?u.hu=!0:a.modifiedDocuments.size>0?Pt(u.hu,14607):a.removedDocuments.size>0&&(Pt(u.hu,42227),u.hu=!1))})),await Vu(t,s,e)}catch(s){await Bl(s)}}function Uw(n,e,t){const s=nt(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const a=[];s.Tu.forEach(((l,u)=>{const g=u.view.va(e);g.snapshot&&a.push(g.snapshot)})),(function(u,g){const d=nt(u);d.onlineState=g;let p=!1;d.queries.forEach(((v,_)=>{for(const S of _.Sa)S.va(g)&&(p=!0)})),p&&uv(d)})(s.eventManager,e),a.length&&s.Pu.H_(a),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function Rk(n,e,t){const s=nt(n);s.sharedClientState.updateQueryState(e,"rejected",t);const a=s.Au.get(e),l=a&&a.key;if(l){let u=new cn(qe.comparator);u=u.insert(l,ii.newNoDocument(l,Je.min()));const g=_t().add(l),d=new Df(Je.min(),new Map,new cn(vt),u,g);await aA(s,d),s.du=s.du.remove(l),s.Au.delete(e),dv(s)}else await Kp(s.localStore,e,!1).then((()=>Zp(s,e,t))).catch(Bl)}async function Ik(n,e){const t=nt(n),s=e.batch.batchId;try{const a=await Uj(t.localStore,e);lA(t,s,null),oA(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await Vu(t,a)}catch(a){await Bl(a)}}async function Nk(n,e,t){const s=nt(n);try{const a=await(function(u,g){const d=nt(u);return d.persistence.runTransaction("Reject batch","readwrite-primary",(p=>{let v;return d.mutationQueue.lookupMutationBatch(p,g).next((_=>(Pt(_!==null,37113),v=_.keys(),d.mutationQueue.removeMutationBatch(p,_)))).next((()=>d.mutationQueue.performConsistencyCheck(p))).next((()=>d.documentOverlayCache.removeOverlaysForBatchId(p,v,g))).next((()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,v))).next((()=>d.localDocuments.getDocuments(p,v)))}))})(s.localStore,e);lA(s,e,t),oA(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await Vu(s,a)}catch(a){await Bl(a)}}function oA(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function lA(n,e,t){const s=nt(n);let a=s.Vu[s.currentUser.toKey()];if(a){const l=a.get(e);l&&(t?l.reject(t):l.resolve(),a=a.remove(e)),s.Vu[s.currentUser.toKey()]=a}}function Zp(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.Iu.get(e))n.Tu.delete(s),t&&n.Pu.yu(s,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((s=>{n.Ru.containsKey(s)||cA(n,s)}))}function cA(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(rv(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),dv(n))}function zw(n,e,t){for(const s of t)s instanceof iA?(n.Ru.addReference(s.key,e),Dk(n,s)):s instanceof rA?(je(hv,"Document no longer in limbo: "+s.key),n.Ru.removeReference(s.key,e),n.Ru.containsKey(s.key)||cA(n,s.key)):Ye(19791,{wu:s})}function Dk(n,e){const t=e.key,s=t.path.canonicalString();n.du.get(t)||n.Eu.has(s)||(je(hv,"New document in limbo: "+t),n.Eu.add(s),dv(n))}function dv(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new qe(Kt.fromString(e)),s=n.fu.next();n.Au.set(s,new bk(t)),n.du=n.du.insert(t,s),Y1(n.remoteStore,new ha(Vr(Yy(t.path)),s,"TargetPurposeLimboResolution",Ef.ce))}}async function Vu(n,e,t){const s=nt(n),a=[],l=[],u=[];s.Tu.isEmpty()||(s.Tu.forEach(((g,d)=>{u.push(s.pu(d,e,t).then((p=>{if((p||t)&&s.isPrimaryClient){const v=p?!p.fromCache:t?.targetChanges.get(d.targetId)?.current;s.sharedClientState.updateQueryState(d.targetId,v?"current":"not-current")}if(p){a.push(p);const v=nv.As(d.targetId,p);l.push(v)}})))})),await Promise.all(u),s.Pu.H_(a),await(async function(d,p){const v=nt(d);try{await v.persistence.runTransaction("notifyLocalViewChanges","readwrite",(_=>_e.forEach(p,(S=>_e.forEach(S.Es,(C=>v.persistence.referenceDelegate.addReference(_,S.targetId,C))).next((()=>_e.forEach(S.ds,(C=>v.persistence.referenceDelegate.removeReference(_,S.targetId,C)))))))))}catch(_){if(!Fl(_))throw _;je(iv,"Failed to update sequence numbers: "+_)}for(const _ of p){const S=_.targetId;if(!_.fromCache){const C=v.Ms.get(S),O=C.snapshotVersion,L=C.withLastLimboFreeSnapshotVersion(O);v.Ms=v.Ms.insert(S,L)}}})(s.localStore,l))}async function Mk(n,e){const t=nt(n);if(!t.currentUser.isEqual(e)){je(hv,"User change. New user:",e.toKey());const s=await q1(t.localStore,e);t.currentUser=e,(function(l,u){l.mu.forEach((g=>{g.forEach((d=>{d.reject(new Ie(ge.CANCELLED,u))}))})),l.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await Vu(t,s.Ls)}}function Ok(n,e){const t=nt(n),s=t.Au.get(e);if(s&&s.hu)return _t().add(s.key);{let a=_t();const l=t.Iu.get(e);if(!l)return a;for(const u of l){const g=t.Tu.get(u);a=a.unionWith(g.view.nu)}return a}}function uA(n){const e=nt(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=aA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Ok.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Rk.bind(null,e),e.Pu.H_=pk.bind(null,e.eventManager),e.Pu.yu=yk.bind(null,e.eventManager),e}function jk(n){const e=nt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Ik.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Nk.bind(null,e),e}class of{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Mf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return Lj(this.persistence,new kj,e.initialUser,this.serializer)}Cu(e){return new H1(tv.mi,this.serializer)}Du(e){return new Gj}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}of.provider={build:()=>new of};class kk extends of{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Pt(this.persistence.referenceDelegate instanceof sf,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new bj(s,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?_i.withCacheSize(this.cacheSizeBytes):_i.DEFAULT;return new H1((s=>sf.mi(s,t)),this.serializer)}}class Jp{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>Uw(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=Mk.bind(null,this.syncEngine),await fk(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new gk})()}createDatastore(e){const t=Mf(e.databaseInfo.databaseId),s=(function(l){return new Wj(l)})(e.databaseInfo);return(function(l,u,g,d){return new ek(l,u,g,d)})(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return(function(s,a,l,u,g){return new nk(s,a,l,u,g)})(this.localStore,this.datastore,e.asyncQueue,(t=>Uw(this.syncEngine,t,0)),(function(){return Ow.v()?new Ow:new $j})())}createSyncEngine(e,t){return(function(a,l,u,g,d,p,v){const _=new Sk(a,l,u,g,d,p);return v&&(_.gu=!0),_})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const s=nt(t);je(go,"RemoteStore shutting down."),s.Ea.add(5),await Pu(s),s.Aa.shutdown(),s.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Jp.provider={build:()=>new Jp};class hA{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ss("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const Ta="FirestoreClient";class Pk{constructor(e,t,s,a,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=a,this.user=ni.UNAUTHENTICATED,this.clientId=Hy.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(s,(async u=>{je(Ta,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u})),this.appCheckCredentials.start(s,(u=>(je(Ta,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ys;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=cv(t,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}async function op(n,e){n.asyncQueue.verifyOperationInProgress(),je(Ta,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener((async a=>{s.isEqual(a)||(await q1(e.localStore,a),s=a)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function Bw(n,e){n.asyncQueue.verifyOperationInProgress();const t=await Vk(n);je(Ta,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((s=>kw(e.remoteStore,s))),n.setAppCheckTokenChangeListener(((s,a)=>kw(e.remoteStore,a))),n._onlineComponents=e}async function Vk(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){je(Ta,"Using user provided OfflineComponentProvider");try{await op(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(a){return a.name==="FirebaseError"?a.code===ge.FAILED_PRECONDITION||a.code===ge.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(t))throw t;Il("Error using user provided cache. Falling back to memory cache: "+t),await op(n,new of)}}else je(Ta,"Using default OfflineComponentProvider"),await op(n,new kk(void 0));return n._offlineComponents}async function dA(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(je(Ta,"Using user provided OnlineComponentProvider"),await Bw(n,n._uninitializedComponentsProvider._online)):(je(Ta,"Using default OnlineComponentProvider"),await Bw(n,new Jp))),n._onlineComponents}function Lk(n){return dA(n).then((e=>e.syncEngine))}async function fA(n){const e=await dA(n),t=e.eventManager;return t.onListen=wk.bind(null,e.syncEngine),t.onUnlisten=Ak.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Ek.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Ck.bind(null,e.syncEngine),t}function Uk(n,e,t={}){const s=new ys;return n.asyncQueue.enqueueAndForget((async()=>(function(l,u,g,d,p){const v=new hA({next:S=>{v.Nu(),u.enqueueAndForget((()=>tA(l,_)));const C=S.docs.has(g);!C&&S.fromCache?p.reject(new Ie(ge.UNAVAILABLE,"Failed to get document because the client is offline.")):C&&S.fromCache&&d&&d.source==="server"?p.reject(new Ie(ge.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(S)},error:S=>p.reject(S)}),_=new nA(Yy(g.path),v,{includeMetadataChanges:!0,qa:!0});return eA(l,_)})(await fA(n),n.asyncQueue,e,t,s))),s.promise}function zk(n,e,t={}){const s=new ys;return n.asyncQueue.enqueueAndForget((async()=>(function(l,u,g,d,p){const v=new hA({next:S=>{v.Nu(),u.enqueueAndForget((()=>tA(l,_))),S.fromCache&&d.source==="server"?p.reject(new Ie(ge.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(S)},error:S=>p.reject(S)}),_=new nA(g,v,{includeMetadataChanges:!0,qa:!0});return eA(l,_)})(await fA(n),n.asyncQueue,e,t,s))),s.promise}function mA(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const Fw=new Map;const gA="firestore.googleapis.com",Hw=!0;class qw{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ie(ge.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=gA,this.ssl=Hw}else this.host=e.host,this.ssl=e.ssl??Hw;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=F1;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<vj)throw new Ie(ge.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}tO("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=mA(e.experimentalLongPollingOptions??{}),(function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Ie(ge.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Ie(ge.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Ie(ge.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(s,a){return s.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class kf{constructor(e,t,s,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new qw({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ie(ge.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ie(ge.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new qw(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(s){if(!s)return new GM;switch(s.type){case"firstParty":return new KM(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new Ie(ge.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const s=Fw.get(t);s&&(je("ComponentProvider","Removing Datastore"),Fw.delete(t),s.terminate())})(this),Promise.resolve()}}function Bk(n,e,t,s={}){n=Fr(n,kf);const a=xa(e),l=n._getSettings(),u={...l,emulatorOptions:n._getEmulatorOptions()},g=`${e}:${t}`;a&&(Ry(`https://${g}`),Iy("Firestore",!0)),l.host!==gA&&l.host!==g&&Il("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d={...l,host:g,ssl:a,emulatorOptions:s};if(!uo(d,u)&&(n._setSettings(d),s.mockUserToken)){let p,v;if(typeof s.mockUserToken=="string")p=s.mockUserToken,v=ni.MOCK_USER;else{p=hT(s.mockUserToken,n._app?.options.projectId);const _=s.mockUserToken.sub||s.mockUserToken.user_id;if(!_)throw new Ie(ge.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");v=new ni(_)}n._authCredentials=new $M(new e1(p,v))}}class Gr{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new Gr(this.firestore,e,this._query)}}class wn{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new pa(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new wn(this.firestore,e,this._key)}toJSON(){return{type:wn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,s){if(Ou(t,wn._jsonSchema))return new wn(e,s||null,new qe(Kt.fromString(t.referencePath)))}}wn._jsonSchemaVersion="firestore/documentReference/1.0",wn._jsonSchema={type:On("string",wn._jsonSchemaVersion),referencePath:On("string")};class pa extends Gr{constructor(e,t,s){super(e,t,Yy(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new wn(this.firestore,null,new qe(e))}withConverter(e){return new pa(this.firestore,e,this._path)}}function Fk(n,e,...t){if(n=jn(n),t1("collection","path",e),n instanceof kf){const s=Kt.fromString(e,...t);return rw(s),new pa(n,null,s)}{if(!(n instanceof wn||n instanceof pa))throw new Ie(ge.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Kt.fromString(e,...t));return rw(s),new pa(n.firestore,null,s)}}function pA(n,e,...t){if(n=jn(n),arguments.length===1&&(e=Hy.newId()),t1("doc","path",e),n instanceof kf){const s=Kt.fromString(e,...t);return iw(s),new wn(n,null,new qe(s))}{if(!(n instanceof wn||n instanceof pa))throw new Ie(ge.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Kt.fromString(e,...t));return iw(s),new wn(n.firestore,n instanceof pa?n.converter:null,new qe(s))}}const Gw="AsyncQueue";class $w{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new $1(this,"async_queue_retry"),this._c=()=>{const s=ap();s&&je(Gw,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=e;const t=ap();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=ap();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new ys;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Fl(e))throw e;je(Gw,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((s=>{throw this.nc=s,this.rc=!1,Ss("INTERNAL UNHANDLED ERROR: ",Qw(s)),s})).then((s=>(this.rc=!1,s))))));return this.ac=t,t}enqueueAfterDelay(e,t,s){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const a=lv.createAndSchedule(this,e,t,s,(l=>this.hc(l)));return this.tc.push(a),a}uc(){this.nc&&Ye(47125,{Pc:Qw(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,s)=>t.targetTimeMs-s.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Qw(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class ql extends kf{constructor(e,t,s,a){super(e,t,s,a),this.type="firestore",this._queue=new $w,this._persistenceKey=a?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new $w(e),this._firestoreClient=void 0,await e}}}function Hk(n,e){const t=typeof n=="object"?n:vf(),s=typeof n=="string"?n:Xd,a=yf(t,"firestore").getImmediate({identifier:s});if(!a._initialized){const l=lT("firestore");l&&Bk(a,...l)}return a}function fv(n){if(n._terminated)throw new Ie(ge.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||qk(n),n._firestoreClient}function qk(n){const e=n._freezeSettings(),t=(function(a,l,u,g){return new fO(a,l,u,g.host,g.ssl,g.experimentalForceLongPolling,g.experimentalAutoDetectLongPolling,mA(g.experimentalLongPollingOptions),g.useFetchStreams,g.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new Pk(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(a){const l=a?._online.build();return{_offline:a?._offline.build(l),_online:l}})(n._componentsProvider))}class Wi{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Wi(Jn.fromBase64String(e))}catch(t){throw new Ie(ge.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Wi(Jn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Wi._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ou(e,Wi._jsonSchema))return Wi.fromBase64String(e.bytes)}}Wi._jsonSchemaVersion="firestore/bytes/1.0",Wi._jsonSchema={type:On("string",Wi._jsonSchemaVersion),bytes:On("string")};class Pf{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ie(ge.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Zn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class mv{constructor(e){this._methodName=e}}class Ur{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ie(ge.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ie(ge.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return vt(this._lat,e._lat)||vt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ur._jsonSchemaVersion}}static fromJSON(e){if(Ou(e,Ur._jsonSchema))return new Ur(e.latitude,e.longitude)}}Ur._jsonSchemaVersion="firestore/geoPoint/1.0",Ur._jsonSchema={type:On("string",Ur._jsonSchemaVersion),latitude:On("number"),longitude:On("number")};class zr{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(s,a){if(s.length!==a.length)return!1;for(let l=0;l<s.length;++l)if(s[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:zr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ou(e,zr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new zr(e.vectorValues);throw new Ie(ge.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}zr._jsonSchemaVersion="firestore/vectorValue/1.0",zr._jsonSchema={type:On("string",zr._jsonSchemaVersion),vectorValues:On("object")};const Gk=/^__.*__$/;class $k{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new Na(e,this.data,this.fieldMask,t,this.fieldTransforms):new ju(e,this.data,t,this.fieldTransforms)}}class yA{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return new Na(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function vA(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ye(40011,{Ac:n})}}class gv{constructor(e,t,s,a,l,u){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=a,l===void 0&&this.Rc(),this.fieldTransforms=l||[],this.fieldMask=u||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new gv({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),s=this.Vc({path:t,fc:!1});return s.gc(e),s}yc(e){const t=this.path?.child(e),s=this.Vc({path:t,fc:!1});return s.Rc(),s}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return lf(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(vA(this.Ac)&&Gk.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Qk{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||Mf(e)}Cc(e,t,s,a=!1){return new gv({Ac:e,methodName:t,Dc:s,path:Zn.emptyPath(),fc:!1,bc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Lu(n){const e=n._freezeSettings(),t=Mf(n._databaseId);return new Qk(n._databaseId,!!e.ignoreUndefinedProperties,t)}function _A(n,e,t,s,a,l={}){const u=n.Cc(l.merge||l.mergeFields?2:0,e,t,a);pv("Data must be an object, but it was:",u,s);const g=SA(s,u);let d,p;if(l.merge)d=new Oi(u.fieldMask),p=u.fieldTransforms;else if(l.mergeFields){const v=[];for(const _ of l.mergeFields){const S=ey(e,_,t);if(!u.contains(S))throw new Ie(ge.INVALID_ARGUMENT,`Field '${S}' is specified in your field mask but missing from your input data.`);EA(v,S)||v.push(S)}d=new Oi(v),p=u.fieldTransforms.filter((_=>d.covers(_.field)))}else d=null,p=u.fieldTransforms;return new $k(new bi(g),d,p)}class Vf extends mv{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Vf}}function Yk(n,e,t,s){const a=n.Cc(1,e,t);pv("Data must be an object, but it was:",a,s);const l=[],u=bi.empty();Ra(s,((d,p)=>{const v=yv(e,d,t);p=jn(p);const _=a.yc(v);if(p instanceof Vf)l.push(v);else{const S=Uu(p,_);S!=null&&(l.push(v),u.set(v,S))}}));const g=new Oi(l);return new yA(u,g,a.fieldTransforms)}function Kk(n,e,t,s,a,l){const u=n.Cc(1,e,t),g=[ey(e,s,t)],d=[a];if(l.length%2!=0)throw new Ie(ge.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let S=0;S<l.length;S+=2)g.push(ey(e,l[S])),d.push(l[S+1]);const p=[],v=bi.empty();for(let S=g.length-1;S>=0;--S)if(!EA(p,g[S])){const C=g[S];let O=d[S];O=jn(O);const L=u.yc(C);if(O instanceof Vf)p.push(C);else{const U=Uu(O,L);U!=null&&(p.push(C),v.set(C,U))}}const _=new Oi(p);return new yA(v,_,u.fieldTransforms)}function bA(n,e,t,s=!1){return Uu(t,n.Cc(s?4:3,e))}function Uu(n,e){if(wA(n=jn(n)))return pv("Unsupported field value:",e,n),SA(n,e);if(n instanceof mv)return(function(s,a){if(!vA(a.Ac))throw a.Sc(`${s._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Sc(`${s._methodName}() is not currently supported inside arrays`);const l=s._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(s,a){const l=[];let u=0;for(const g of s){let d=Uu(g,a.wc(u));d==null&&(d={nullValue:"NULL_VALUE"}),l.push(d),u++}return{arrayValue:{values:l}}})(n,e)}return(function(s,a){if((s=jn(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return PO(a.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const l=en.fromDate(s);return{timestampValue:rf(a.serializer,l)}}if(s instanceof en){const l=new en(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:rf(a.serializer,l)}}if(s instanceof Ur)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof Wi)return{bytesValue:k1(a.serializer,s._byteString)};if(s instanceof wn){const l=a.databaseId,u=s.firestore._databaseId;if(!u.isEqual(l))throw a.Sc(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:Jy(s.firestore._databaseId||a.databaseId,s._key.path)}}if(s instanceof zr)return(function(u,g){return{mapValue:{fields:{[u1]:{stringValue:h1},[Zd]:{arrayValue:{values:u.toArray().map((p=>{if(typeof p!="number")throw g.Sc("VectorValues must only contain numeric values.");return Wy(g.serializer,p)}))}}}}}})(s,a);throw a.Sc(`Unsupported field value: ${wf(s)}`)})(n,e)}function SA(n,e){const t={};return r1(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ra(n,((s,a)=>{const l=Uu(a,e.mc(s));l!=null&&(t[s]=l)})),{mapValue:{fields:t}}}function wA(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof en||n instanceof Ur||n instanceof Wi||n instanceof wn||n instanceof mv||n instanceof zr)}function pv(n,e,t){if(!wA(t)||!n1(t)){const s=wf(t);throw s==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+s)}}function ey(n,e,t){if((e=jn(e))instanceof Pf)return e._internalPath;if(typeof e=="string")return yv(n,e);throw lf("Field path arguments must be of type string or ",n,!1,void 0,t)}const Wk=new RegExp("[~\\*/\\[\\]]");function yv(n,e,t){if(e.search(Wk)>=0)throw lf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Pf(...e.split("."))._internalPath}catch{throw lf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function lf(n,e,t,s,a){const l=s&&!s.isEmpty(),u=a!==void 0;let g=`Function ${e}() called with invalid data`;t&&(g+=" (via `toFirestore()`)"),g+=". ";let d="";return(l||u)&&(d+=" (found",l&&(d+=` in field ${s}`),u&&(d+=` in document ${a}`),d+=")"),new Ie(ge.INVALID_ARGUMENT,g+n+d)}function EA(n,e){return n.some((t=>t.isEqual(e)))}class vv{constructor(e,t,s,a,l){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new wn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Xk(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Lf("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class Xk extends vv{data(){return super.data()}}function Lf(n,e){return typeof e=="string"?yv(n,e):e instanceof Pf?e._internalPath:e._delegate._internalPath}function Zk(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Ie(ge.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class _v{}class zu extends _v{}function cf(n,e,...t){let s=[];e instanceof _v&&s.push(e),s=s.concat(t),(function(l){const u=l.filter((d=>d instanceof bv)).length,g=l.filter((d=>d instanceof Uf)).length;if(u>1||u>0&&g>0)throw new Ie(ge.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(s);for(const a of s)n=a._apply(n);return n}class Uf extends zu{constructor(e,t,s){super(),this._field=e,this._op=t,this._value=s,this.type="where"}static _create(e,t,s){return new Uf(e,t,s)}_apply(e){const t=this._parse(e);return CA(e._query,t),new Gr(e.firestore,e.converter,qp(e._query,t))}_parse(e){const t=Lu(e.firestore);return(function(l,u,g,d,p,v,_){let S;if(p.isKeyField()){if(v==="array-contains"||v==="array-contains-any")throw new Ie(ge.INVALID_ARGUMENT,`Invalid Query. You can't perform '${v}' queries on documentId().`);if(v==="in"||v==="not-in"){Kw(_,v);const O=[];for(const L of _)O.push(Yw(d,l,L));S={arrayValue:{values:O}}}else S=Yw(d,l,_)}else v!=="in"&&v!=="not-in"&&v!=="array-contains-any"||Kw(_,v),S=bA(g,u,_,v==="in"||v==="not-in");return Mn.create(p,v,S)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function ty(n,e,t){const s=e,a=Lf("where",n);return Uf._create(a,s,t)}class bv extends _v{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new bv(e,t)}_parse(e){const t=this._queryConstraints.map((s=>s._parse(e))).filter((s=>s.getFilters().length>0));return t.length===1?t[0]:ur.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(a,l){let u=a;const g=l.getFlattenedFilters();for(const d of g)CA(u,d),u=qp(u,d)})(e._query,t),new Gr(e.firestore,e.converter,qp(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Sv extends zu{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Sv(e,t)}_apply(e){const t=(function(a,l,u){if(a.startAt!==null)throw new Ie(ge.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(a.endAt!==null)throw new Ie(ge.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new _u(l,u)})(e._query,this._field,this._direction);return new Gr(e.firestore,e.converter,(function(a,l){const u=a.explicitOrderBy.concat([l]);return new Ia(a.path,a.collectionGroup,u,a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)})(e._query,t))}}function TA(n,e="asc"){const t=e,s=Lf("orderBy",n);return Sv._create(s,t)}class wv extends zu{constructor(e,t,s){super(),this.type=e,this._limit=t,this._limitType=s}static _create(e,t,s){return new wv(e,t,s)}_apply(e){return new Gr(e.firestore,e.converter,ef(e._query,this._limit,this._limitType))}}function Jk(n){return nO("limit",n),wv._create("limit",n,"F")}class Ev extends zu{constructor(e,t,s){super(),this.type=e,this._docOrFields=t,this._inclusive=s}static _create(e,t,s){return new Ev(e,t,s)}_apply(e){const t=AA(e,this.type,this._docOrFields,this._inclusive);return new Gr(e.firestore,e.converter,(function(a,l){return new Ia(a.path,a.collectionGroup,a.explicitOrderBy.slice(),a.filters.slice(),a.limit,a.limitType,l,a.endAt)})(e._query,t))}}function eP(...n){return Ev._create("startAt",n,!0)}class Tv extends zu{constructor(e,t,s){super(),this.type=e,this._docOrFields=t,this._inclusive=s}static _create(e,t,s){return new Tv(e,t,s)}_apply(e){const t=AA(e,this.type,this._docOrFields,this._inclusive);return new Gr(e.firestore,e.converter,(function(a,l){return new Ia(a.path,a.collectionGroup,a.explicitOrderBy.slice(),a.filters.slice(),a.limit,a.limitType,a.startAt,l)})(e._query,t))}}function tP(...n){return Tv._create("endAt",n,!0)}function AA(n,e,t,s){if(t[0]=jn(t[0]),t[0]instanceof vv)return(function(l,u,g,d,p){if(!d)throw new Ie(ge.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${g}().`);const v=[];for(const _ of Tl(l))if(_.field.isKeyField())v.push(Jd(u,d.key));else{const S=d.data.field(_.field);if(Af(S))throw new Ie(ge.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+_.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(S===null){const C=_.field.canonicalString();throw new Ie(ge.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${C}' (used as the orderBy) does not exist.`)}v.push(S)}return new Ol(v,p)})(n._query,n.firestore._databaseId,e,t[0]._document,s);{const a=Lu(n.firestore);return(function(u,g,d,p,v,_){const S=u.explicitOrderBy;if(v.length>S.length)throw new Ie(ge.INVALID_ARGUMENT,`Too many arguments provided to ${p}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const C=[];for(let O=0;O<v.length;O++){const L=v[O];if(S[O].field.isKeyField()){if(typeof L!="string")throw new Ie(ge.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${p}(), but got a ${typeof L}`);if(!Ky(u)&&L.indexOf("/")!==-1)throw new Ie(ge.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${p}() must be a plain document ID, but '${L}' contains a slash.`);const U=u.path.child(Kt.fromString(L));if(!qe.isDocumentKey(U))throw new Ie(ge.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${p}() must result in a valid document path, but '${U}' is not because it contains an odd number of segments.`);const z=new qe(U);C.push(Jd(g,z))}else{const U=bA(d,p,L);C.push(U)}}return new Ol(C,_)})(n._query,n.firestore._databaseId,a,e,t,s)}}function Yw(n,e,t){if(typeof(t=jn(t))=="string"){if(t==="")throw new Ie(ge.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ky(e)&&t.indexOf("/")!==-1)throw new Ie(ge.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const s=e.path.child(Kt.fromString(t));if(!qe.isDocumentKey(s))throw new Ie(ge.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return Jd(n,new qe(s))}if(t instanceof wn)return Jd(n,t._key);throw new Ie(ge.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${wf(t)}.`)}function Kw(n,e){if(!Array.isArray(n)||n.length===0)throw new Ie(ge.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function CA(n,e){const t=(function(a,l){for(const u of a)for(const g of u.getFlattenedFilters())if(l.indexOf(g.op)>=0)return g.op;return null})(n.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Ie(ge.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ie(ge.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class nP{convertValue(e,t="none"){switch(wa(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Sn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Sa(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ye(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return Ra(e,((a,l)=>{s[a]=this.convertValue(l,t)})),s}convertVectorValue(e){const t=e.fields?.[Zd].arrayValue?.values?.map((s=>Sn(s.doubleValue)));return new zr(t)}convertGeoPoint(e){return new Ur(Sn(e.latitude),Sn(e.longitude))}convertArray(e,t){return(e.values||[]).map((s=>this.convertValue(s,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const s=Cf(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(pu(e));default:return null}}convertTimestamp(e){const t=ba(e);return new en(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=Kt.fromString(e);Pt(B1(s),9688,{name:e});const a=new yu(s.get(1),s.get(3)),l=new qe(s.popFirst(5));return a.isEqual(t)||Ss(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}function xA(n,e,t){let s;return s=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,s}class eu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class oo extends vv{constructor(e,t,s,a,l,u){super(e,t,s,a,u),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new zd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(Lf("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ie(ge.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=oo._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}oo._jsonSchemaVersion="firestore/documentSnapshot/1.0",oo._jsonSchema={type:On("string",oo._jsonSchemaVersion),bundleSource:On("string","DocumentSnapshot"),bundleName:On("string"),bundle:On("string")};class zd extends oo{data(e={}){return super.data(e)}}class Cl{constructor(e,t,s,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new eu(a.hasPendingWrites,a.fromCache),this.query=s}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((s=>{e.call(t,new zd(this._firestore,this._userDataWriter,s.key,s,new eu(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ie(ge.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let u=0;return a._snapshot.docChanges.map((g=>{const d=new zd(a._firestore,a._userDataWriter,g.doc.key,g.doc,new eu(a._snapshot.mutatedKeys.has(g.doc.key),a._snapshot.fromCache),a.query.converter);return g.doc,{type:"added",doc:d,oldIndex:-1,newIndex:u++}}))}{let u=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((g=>l||g.type!==3)).map((g=>{const d=new zd(a._firestore,a._userDataWriter,g.doc.key,g.doc,new eu(a._snapshot.mutatedKeys.has(g.doc.key),a._snapshot.fromCache),a.query.converter);let p=-1,v=-1;return g.type!==0&&(p=u.indexOf(g.doc.key),u=u.delete(g.doc.key)),g.type!==1&&(u=u.add(g.doc),v=u.indexOf(g.doc.key)),{type:iP(g.type),doc:d,oldIndex:p,newIndex:v}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ie(ge.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Cl._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Hy.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],s=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),s.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function iP(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ye(61501,{type:n})}}function RA(n){n=Fr(n,wn);const e=Fr(n.firestore,ql);return Uk(fv(e),n._key).then((t=>oP(e,n,t)))}Cl._jsonSchemaVersion="firestore/querySnapshot/1.0",Cl._jsonSchema={type:On("string",Cl._jsonSchemaVersion),bundleSource:On("string","QuerySnapshot"),bundleName:On("string"),bundle:On("string")};class IA extends nP{constructor(e){super(),this.firestore=e}convertBytes(e){return new Wi(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new wn(this.firestore,null,t)}}function Bd(n){n=Fr(n,Gr);const e=Fr(n.firestore,ql),t=fv(e),s=new IA(e);return Zk(n._query),zk(t,n._query).then((a=>new Cl(e,s,n,a)))}function rP(n,e,t){n=Fr(n,wn);const s=Fr(n.firestore,ql),a=xA(n.converter,e,t);return Av(s,[_A(Lu(s),"setDoc",n._key,a,n.converter!==null,t).toMutation(n._key,cr.none())])}function sP(n,e,t,...s){n=Fr(n,wn);const a=Fr(n.firestore,ql),l=Lu(a);let u;return u=typeof(e=jn(e))=="string"||e instanceof Pf?Kk(l,"updateDoc",n._key,e,t,s):Yk(l,"updateDoc",n._key,e),Av(a,[u.toMutation(n._key,cr.exists(!0))])}function aP(n,e){const t=Fr(n.firestore,ql),s=pA(n),a=xA(n.converter,e);return Av(t,[_A(Lu(n.firestore),"addDoc",s._key,a,n.converter!==null,{}).toMutation(s._key,cr.exists(!1))]).then((()=>s))}function Av(n,e){return(function(s,a){const l=new ys;return s.asyncQueue.enqueueAndForget((async()=>xk(await Lk(s),a,l))),l.promise})(fv(n),e)}function oP(n,e,t){const s=t.docs.get(e._key),a=new IA(n);return new oo(n,a,e._key,s,new eu(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(a){zl=a})(So),ho(new va("firestore",((s,{instanceIdentifier:a,options:l})=>{const u=s.getProvider("app").getImmediate(),g=new ql(new QM(s.getProvider("auth-internal")),new WM(u,s.getProvider("app-check-internal")),(function(p,v){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new Ie(ge.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new yu(p.options.projectId,v)})(u,a),u);return l={useFetchStreams:t,...l},g._setSettings(l),g}),"PUBLIC").setMultipleInstances(!0)),kr(JS,ew,e),kr(JS,ew,"esm2020")})();const NA="firebasestorage.googleapis.com",DA="storageBucket",lP=120*1e3,cP=600*1e3;class gn extends qr{constructor(e,t,s=0){super(lp(e),`Firebase Storage: ${t} (${lp(e)})`),this.status_=s,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,gn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return lp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var mn;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(mn||(mn={}));function lp(n){return"storage/"+n}function Cv(){const n="An unknown error occurred, please check the error payload for server response.";return new gn(mn.UNKNOWN,n)}function uP(n){return new gn(mn.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function hP(n){return new gn(mn.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function dP(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new gn(mn.UNAUTHENTICATED,n)}function fP(){return new gn(mn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function mP(n){return new gn(mn.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function gP(){return new gn(mn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function pP(){return new gn(mn.CANCELED,"User canceled the upload/download.")}function yP(n){return new gn(mn.INVALID_URL,"Invalid URL '"+n+"'.")}function vP(n){return new gn(mn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function _P(){return new gn(mn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+DA+"' property when initializing the app?")}function bP(){return new gn(mn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function SP(){return new gn(mn.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function wP(n){return new gn(mn.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function ny(n){return new gn(mn.INVALID_ARGUMENT,n)}function MA(){return new gn(mn.APP_DELETED,"The Firebase app was deleted.")}function EP(n){return new gn(mn.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function ou(n,e){return new gn(mn.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Gc(n){throw new gn(mn.INTERNAL_ERROR,"Internal error: "+n)}class ji{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let s;try{s=ji.makeFromUrl(e,t)}catch{return new ji(e,"")}if(s.path==="")return s;throw vP(e)}static makeFromUrl(e,t){let s=null;const a="([A-Za-z0-9.\\-_]+)";function l(ne){ne.path.charAt(ne.path.length-1)==="/"&&(ne.path_=ne.path_.slice(0,-1))}const u="(/(.*))?$",g=new RegExp("^gs://"+a+u,"i"),d={bucket:1,path:3};function p(ne){ne.path_=decodeURIComponent(ne.path)}const v="v[A-Za-z0-9_]+",_=t.replace(/[.]/g,"\\."),S="(/([^?#]*).*)?$",C=new RegExp(`^https?://${_}/${v}/b/${a}/o${S}`,"i"),O={bucket:1,path:3},L=t===NA?"(?:storage.googleapis.com|storage.cloud.google.com)":t,U="([^?#]*)",z=new RegExp(`^https?://${L}/${a}/${U}`,"i"),q=[{regex:g,indices:d,postModify:l},{regex:C,indices:O,postModify:p},{regex:z,indices:{bucket:1,path:2},postModify:p}];for(let ne=0;ne<q.length;ne++){const ee=q[ne],de=ee.regex.exec(e);if(de){const k=de[ee.indices.bucket];let M=de[ee.indices.path];M||(M=""),s=new ji(k,M),ee.postModify(s);break}}if(s==null)throw yP(e);return s}}class TP{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function AP(n,e,t){let s=1,a=null,l=null,u=!1,g=0;function d(){return g===2}let p=!1;function v(...U){p||(p=!0,e.apply(null,U))}function _(U){a=setTimeout(()=>{a=null,n(C,d())},U)}function S(){l&&clearTimeout(l)}function C(U,...z){if(p){S();return}if(U){S(),v.call(null,U,...z);return}if(d()||u){S(),v.call(null,U,...z);return}s<64&&(s*=2);let q;g===1?(g=2,q=0):q=(s+Math.random())*1e3,_(q)}let O=!1;function L(U){O||(O=!0,S(),!p&&(a!==null?(U||(g=2),clearTimeout(a),_(0)):U||(g=1)))}return _(0),l=setTimeout(()=>{u=!0,L(!0)},t),L}function CP(n){n(!1)}function xP(n){return n!==void 0}function RP(n){return typeof n=="object"&&!Array.isArray(n)}function xv(n){return typeof n=="string"||n instanceof String}function Ww(n){return Rv()&&n instanceof Blob}function Rv(){return typeof Blob<"u"}function Xw(n,e,t,s){if(s<e)throw ny(`Invalid value for '${n}'. Expected ${e} or greater.`);if(s>t)throw ny(`Invalid value for '${n}'. Expected ${t} or less.`)}function Iv(n,e,t){let s=e;return t==null&&(s=`https://${e}`),`${t}://${s}/v0${n}`}function OA(n){const e=encodeURIComponent;let t="?";for(const s in n)if(n.hasOwnProperty(s)){const a=e(s)+"="+e(n[s]);t=t+a+"&"}return t=t.slice(0,-1),t}var lo;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(lo||(lo={}));function IP(n,e){const t=n>=500&&n<600,a=[408,429].indexOf(n)!==-1,l=e.indexOf(n)!==-1;return t||a||l}class NP{constructor(e,t,s,a,l,u,g,d,p,v,_,S=!0,C=!1){this.url_=e,this.method_=t,this.headers_=s,this.body_=a,this.successCodes_=l,this.additionalRetryCodes_=u,this.callback_=g,this.errorCallback_=d,this.timeout_=p,this.progressCallback_=v,this.connectionFactory_=_,this.retry=S,this.isUsingEmulator=C,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((O,L)=>{this.resolve_=O,this.reject_=L,this.start_()})}start_(){const e=(s,a)=>{if(a){s(!1,new yd(!1,null,!0));return}const l=this.connectionFactory_();this.pendingConnection_=l;const u=g=>{const d=g.loaded,p=g.lengthComputable?g.total:-1;this.progressCallback_!==null&&this.progressCallback_(d,p)};this.progressCallback_!==null&&l.addUploadProgressListener(u),l.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&l.removeUploadProgressListener(u),this.pendingConnection_=null;const g=l.getErrorCode()===lo.NO_ERROR,d=l.getStatus();if(!g||IP(d,this.additionalRetryCodes_)&&this.retry){const v=l.getErrorCode()===lo.ABORT;s(!1,new yd(!1,null,v));return}const p=this.successCodes_.indexOf(d)!==-1;s(!0,new yd(p,l))})},t=(s,a)=>{const l=this.resolve_,u=this.reject_,g=a.connection;if(a.wasSuccessCode)try{const d=this.callback_(g,g.getResponse());xP(d)?l(d):l()}catch(d){u(d)}else if(g!==null){const d=Cv();d.serverResponse=g.getErrorText(),this.errorCallback_?u(this.errorCallback_(g,d)):u(d)}else if(a.canceled){const d=this.appDelete_?MA():pP();u(d)}else{const d=gP();u(d)}};this.canceled_?t(!1,new yd(!1,null,!0)):this.backoffId_=AP(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&CP(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class yd{constructor(e,t,s){this.wasSuccessCode=e,this.connection=t,this.canceled=!!s}}function DP(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function MP(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function OP(n,e){e&&(n["X-Firebase-GMPID"]=e)}function jP(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function kP(n,e,t,s,a,l,u=!0,g=!1){const d=OA(n.urlParams),p=n.url+d,v=Object.assign({},n.headers);return OP(v,e),DP(v,t),MP(v,l),jP(v,s),new NP(p,n.method,v,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,a,u,g)}function PP(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function VP(...n){const e=PP();if(e!==void 0){const t=new e;for(let s=0;s<n.length;s++)t.append(n[s]);return t.getBlob()}else{if(Rv())return new Blob(n);throw new gn(mn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function LP(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function UP(n){if(typeof atob>"u")throw wP("base-64");return atob(n)}const jr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class cp{constructor(e,t){this.data=e,this.contentType=t||null}}function zP(n,e){switch(n){case jr.RAW:return new cp(jA(e));case jr.BASE64:case jr.BASE64URL:return new cp(kA(n,e));case jr.DATA_URL:return new cp(FP(e),HP(e))}throw Cv()}function jA(n){const e=[];for(let t=0;t<n.length;t++){let s=n.charCodeAt(t);if(s<=127)e.push(s);else if(s<=2047)e.push(192|s>>6,128|s&63);else if((s&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const l=s,u=n.charCodeAt(++t);s=65536|(l&1023)<<10|u&1023,e.push(240|s>>18,128|s>>12&63,128|s>>6&63,128|s&63)}else(s&64512)===56320?e.push(239,191,189):e.push(224|s>>12,128|s>>6&63,128|s&63)}return new Uint8Array(e)}function BP(n){let e;try{e=decodeURIComponent(n)}catch{throw ou(jr.DATA_URL,"Malformed data URL.")}return jA(e)}function kA(n,e){switch(n){case jr.BASE64:{const a=e.indexOf("-")!==-1,l=e.indexOf("_")!==-1;if(a||l)throw ou(n,"Invalid character '"+(a?"-":"_")+"' found: is it base64url encoded?");break}case jr.BASE64URL:{const a=e.indexOf("+")!==-1,l=e.indexOf("/")!==-1;if(a||l)throw ou(n,"Invalid character '"+(a?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=UP(e)}catch(a){throw a.message.includes("polyfill")?a:ou(n,"Invalid character found")}const s=new Uint8Array(t.length);for(let a=0;a<t.length;a++)s[a]=t.charCodeAt(a);return s}class PA{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw ou(jr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const s=t[1]||null;s!=null&&(this.base64=qP(s,";base64"),this.contentType=this.base64?s.substring(0,s.length-7):s),this.rest=e.substring(e.indexOf(",")+1)}}function FP(n){const e=new PA(n);return e.base64?kA(jr.BASE64,e.rest):BP(e.rest)}function HP(n){return new PA(n).contentType}function qP(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}class la{constructor(e,t){let s=0,a="";Ww(e)?(this.data_=e,s=e.size,a=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),s=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),s=e.length),this.size_=s,this.type_=a}size(){return this.size_}type(){return this.type_}slice(e,t){if(Ww(this.data_)){const s=this.data_,a=LP(s,e,t);return a===null?null:new la(a)}else{const s=new Uint8Array(this.data_.buffer,e,t-e);return new la(s,!0)}}static getBlob(...e){if(Rv()){const t=e.map(s=>s instanceof la?s.data_:s);return new la(VP.apply(null,t))}else{const t=e.map(u=>xv(u)?zP(jr.RAW,u).data:u.data_);let s=0;t.forEach(u=>{s+=u.byteLength});const a=new Uint8Array(s);let l=0;return t.forEach(u=>{for(let g=0;g<u.length;g++)a[l++]=u[g]}),new la(a,!0)}}uploadData(){return this.data_}}function VA(n){let e;try{e=JSON.parse(n)}catch{return null}return RP(e)?e:null}function GP(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function $P(n,e){const t=e.split("/").filter(s=>s.length>0).join("/");return n.length===0?t:n+"/"+t}function LA(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function QP(n,e){return e}class li{constructor(e,t,s,a){this.server=e,this.local=t||e,this.writable=!!s,this.xform=a||QP}}let vd=null;function YP(n){return!xv(n)||n.length<2?n:LA(n)}function UA(){if(vd)return vd;const n=[];n.push(new li("bucket")),n.push(new li("generation")),n.push(new li("metageneration")),n.push(new li("name","fullPath",!0));function e(l,u){return YP(u)}const t=new li("name");t.xform=e,n.push(t);function s(l,u){return u!==void 0?Number(u):u}const a=new li("size");return a.xform=s,n.push(a),n.push(new li("timeCreated")),n.push(new li("updated")),n.push(new li("md5Hash",null,!0)),n.push(new li("cacheControl",null,!0)),n.push(new li("contentDisposition",null,!0)),n.push(new li("contentEncoding",null,!0)),n.push(new li("contentLanguage",null,!0)),n.push(new li("contentType",null,!0)),n.push(new li("metadata","customMetadata",!0)),vd=n,vd}function KP(n,e){function t(){const s=n.bucket,a=n.fullPath,l=new ji(s,a);return e._makeStorageReference(l)}Object.defineProperty(n,"ref",{get:t})}function WP(n,e,t){const s={};s.type="file";const a=t.length;for(let l=0;l<a;l++){const u=t[l];s[u.local]=u.xform(s,e[u.server])}return KP(s,n),s}function zA(n,e,t){const s=VA(e);return s===null?null:WP(n,s,t)}function XP(n,e,t,s){const a=VA(e);if(a===null||!xv(a.downloadTokens))return null;const l=a.downloadTokens;if(l.length===0)return null;const u=encodeURIComponent;return l.split(",").map(p=>{const v=n.bucket,_=n.fullPath,S="/b/"+u(v)+"/o/"+u(_),C=Iv(S,t,s),O=OA({alt:"media",token:p});return C+O})[0]}function ZP(n,e){const t={},s=e.length;for(let a=0;a<s;a++){const l=e[a];l.writable&&(t[l.server]=n[l.local])}return JSON.stringify(t)}class BA{constructor(e,t,s,a){this.url=e,this.method=t,this.handler=s,this.timeout=a,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function FA(n){if(!n)throw Cv()}function JP(n,e){function t(s,a){const l=zA(n,a,e);return FA(l!==null),l}return t}function eV(n,e){function t(s,a){const l=zA(n,a,e);return FA(l!==null),XP(l,a,n.host,n._protocol)}return t}function HA(n){function e(t,s){let a;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?a=fP():a=dP():t.getStatus()===402?a=hP(n.bucket):t.getStatus()===403?a=mP(n.path):a=s,a.status=t.getStatus(),a.serverResponse=s.serverResponse,a}return e}function tV(n){const e=HA(n);function t(s,a){let l=e(s,a);return s.getStatus()===404&&(l=uP(n.path)),l.serverResponse=a.serverResponse,l}return t}function nV(n,e,t){const s=e.fullServerUrl(),a=Iv(s,n.host,n._protocol),l="GET",u=n.maxOperationRetryTime,g=new BA(a,l,eV(n,t),u);return g.errorHandler=tV(e),g}function iV(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function rV(n,e,t){const s=Object.assign({},t);return s.fullPath=n.path,s.size=e.size(),s.contentType||(s.contentType=iV(null,e)),s}function sV(n,e,t,s,a){const l=e.bucketOnlyServerUrl(),u={"X-Goog-Upload-Protocol":"multipart"};function g(){let q="";for(let ne=0;ne<2;ne++)q=q+Math.random().toString().slice(2);return q}const d=g();u["Content-Type"]="multipart/related; boundary="+d;const p=rV(e,s,a),v=ZP(p,t),_="--"+d+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+v+`\r
--`+d+`\r
Content-Type: `+p.contentType+`\r
\r
`,S=`\r
--`+d+"--",C=la.getBlob(_,s,S);if(C===null)throw bP();const O={name:p.fullPath},L=Iv(l,n.host,n._protocol),U="POST",z=n.maxUploadRetryTime,X=new BA(L,U,JP(n,t),z);return X.urlParams=O,X.headers=u,X.body=C.uploadData(),X.errorHandler=HA(e),X}class aV{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=lo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=lo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=lo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,s,a,l){if(this.sent_)throw Gc("cannot .send() more than once");if(xa(e)&&s&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),l!==void 0)for(const u in l)l.hasOwnProperty(u)&&this.xhr_.setRequestHeader(u,l[u].toString());return a!==void 0?this.xhr_.send(a):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Gc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Gc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Gc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Gc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class oV extends aV{initXhr(){this.xhr_.responseType="text"}}function qA(){return new oV}class po{constructor(e,t){this._service=e,t instanceof ji?this._location=t:this._location=ji.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new po(e,t)}get root(){const e=new ji(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return LA(this._location.path)}get storage(){return this._service}get parent(){const e=GP(this._location.path);if(e===null)return null;const t=new ji(this._location.bucket,e);return new po(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw EP(e)}}function lV(n,e,t){n._throwIfRoot("uploadBytes");const s=sV(n.storage,n._location,UA(),new la(e,!0),t);return n.storage.makeRequestWithTokens(s,qA).then(a=>({metadata:a,ref:n}))}function cV(n){n._throwIfRoot("getDownloadURL");const e=nV(n.storage,n._location,UA());return n.storage.makeRequestWithTokens(e,qA).then(t=>{if(t===null)throw SP();return t})}function uV(n,e){const t=$P(n._location.path,e),s=new ji(n._location.bucket,t);return new po(n.storage,s)}function hV(n){return/^[A-Za-z]+:\/\//.test(n)}function dV(n,e){return new po(n,e)}function GA(n,e){if(n instanceof Nv){const t=n;if(t._bucket==null)throw _P();const s=new po(t,t._bucket);return e!=null?GA(s,e):s}else return e!==void 0?uV(n,e):n}function fV(n,e){if(e&&hV(e)){if(n instanceof Nv)return dV(n,e);throw ny("To use ref(service, url), the first argument must be a Storage instance.")}else return GA(n,e)}function Zw(n,e){const t=e?.[DA];return t==null?null:ji.makeFromBucketSpec(t,n)}function mV(n,e,t,s={}){n.host=`${e}:${t}`;const a=xa(e);a&&(Ry(`https://${n.host}/b`),Iy("Storage",!0)),n._isUsingEmulator=!0,n._protocol=a?"https":"http";const{mockUserToken:l}=s;l&&(n._overrideAuthToken=typeof l=="string"?l:hT(l,n.app.options.projectId))}class Nv{constructor(e,t,s,a,l,u=!1){this.app=e,this._authProvider=t,this._appCheckProvider=s,this._url=a,this._firebaseVersion=l,this._isUsingEmulator=u,this._bucket=null,this._host=NA,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=lP,this._maxUploadRetryTime=cP,this._requests=new Set,a!=null?this._bucket=ji.makeFromBucketSpec(a,this._host):this._bucket=Zw(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=ji.makeFromBucketSpec(this._url,e):this._bucket=Zw(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Xw("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Xw("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Ki(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new po(this,e)}_makeRequest(e,t,s,a,l=!0){if(this._deleted)return new TP(MA());{const u=kP(e,this._appId,s,a,t,this._firebaseVersion,l,this._isUsingEmulator);return this._requests.add(u),u.getPromise().then(()=>this._requests.delete(u),()=>this._requests.delete(u)),u}}async makeRequestWithTokens(e,t){const[s,a]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,s,a).getPromise()}}const Jw="@firebase/storage",eE="0.14.0";const $A="storage";function tE(n,e,t){return n=jn(n),lV(n,e,t)}function gV(n){return n=jn(n),cV(n)}function pV(n,e){return n=jn(n),fV(n,e)}function yV(n=vf(),e){n=jn(n);const s=yf(n,$A).getImmediate({identifier:e}),a=lT("storage");return a&&vV(s,...a),s}function vV(n,e,t,s={}){mV(n,e,t,s)}function _V(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),s=n.getProvider("auth-internal"),a=n.getProvider("app-check-internal");return new Nv(t,s,a,e,So)}function bV(){ho(new va($A,_V,"PUBLIC").setMultipleInstances(!0)),kr(Jw,eE,""),kr(Jw,eE,"esm2020")}bV();const $c={apiKey:"AIzaSyBEFE5oeajyI6VXHG5T17xLue8eRQNRzzk",authDomain:"kusgan-6ca2f.firebaseapp.com",projectId:"kusgan-6ca2f",storageBucket:"kusgan-6ca2f.firebasestorage.app",appId:"1:653741419351:web:39de9b909a028bb89a6c12"};let to,nE,iy;function zf(){if(!to){if(DS&&DS().length)try{to=vf()}catch{}if(!to){try{const n=!!$c.projectId,e=String($c.apiKey||""),t=e?e.slice(0,4)+"..."+e.slice(-4):"(none)";console.info("[firebase] ensureFirebase: projectId=",n?$c.projectId:"(missing)"," apiKey=",t)}catch{}if(!$c.projectId)throw new Error("Missing Firebase config in VITE_FIREBASE_PROJECT_ID");to=mT($c)}nE=Hk(to);try{iy=yV(to)}catch{iy=null}}return{app:to,db:nE}}function Dv(){return zf().db}function Bf(n){return Fk(Dv(),n)}function Ff(n,e){return pA(Dv(),n,String(e))}async function SV(n,e={}){const t=Bf(n);if(e.where){const a=cf(t,ty(e.where.field,e.where.op||"==",e.where.value));return(await Bd(a)).docs.map(u=>({id:u.id,...u.data()}))}if(e.orderBy){const a=cf(t,TA(e.orderBy.field,e.orderBy.dir||"asc"));return(await Bd(a)).docs.map(u=>({id:u.id,...u.data()}))}return(await Bd(t)).docs.map(a=>({id:a.id,...a.data()}))}async function wV(n,e={}){const t=Bf(n),s=[];if(Array.isArray(e.wheres))for(const u of e.wheres)s.push(ty(u.field,u.op||"==",u.value));else e.where&&s.push(ty(e.where.field,e.where.op||"==",e.where.value));e.orderBy&&s.push(TA(e.orderBy.field,e.orderBy.dir||"asc")),e.startAt!==void 0&&s.push(eP(e.startAt)),e.endAt!==void 0&&s.push(tP(e.endAt)),e.limit&&s.push(Jk(Number(e.limit)));const a=s.length?cf(t,...s):cf(t);return(await Bd(a)).docs.map(u=>({id:u.id,...u.data()}))}function QA(){return zf(),iy}async function EV(n,e){const t=QA();if(!t)throw new Error("Firebase Storage not initialized or not configured");const s=pV(t,n);if(typeof e=="string"){const a=e.replace(/^data:.*;base64,/,""),l=atob(a),u=new Uint8Array(l.length);for(let g=0;g<l.length;g++)u[g]=l.charCodeAt(g);await tE(s,u)}else await tE(s,e);return await gV(s)}async function TV(n,e){const t=Ff(n,e),s=await RA(t);return s.exists()?{id:s.id,...s.data()}:null}async function AV(n,e){const t=Bf(n);return{id:(await aP(t,e)).id,...e}}async function CV(n,e,t){const s=Ff(n,e);return await rP(s,t,{merge:!0}),{id:e,...t}}async function xV(n,e,t){const s=Ff(n,e);await sP(s,t);const a=await RA(s);return{id:a.id,...a.data()}}const st={ensureFirebase:zf,getDB:Dv,colRef:Bf,docRef:Ff,getCollection:SV,queryCollection:wV,getDocById:TV,addDocument:AV,setDocument:CV,updateDocument:xV,getStorageInstance:QA,uploadFile:EV},uf="authToken";function RV(n){if(!n){try{localStorage.removeItem(uf)}catch{}return}try{localStorage.setItem(uf,n)}catch{}}function lu(){try{return localStorage.getItem(uf)}catch{return null}}function IV(){try{localStorage.removeItem(uf)}catch{}}async function NV(n,e={}){const t=lu(),s=Object.assign({},e.headers||{});return t&&(s.Authorization=`Bearer ${t}`),await fetch(n,Object.assign({},e,{headers:s}))}const ln={setToken:RV,getToken:lu,clearToken:IV,fetchWithAuth:NV};function DV({setToken:n}){T.useEffect(()=>{},[]);const[e,t]=T.useState(""),[s,a]=T.useState(""),[l,u]=T.useState(""),[g,d]=T.useState(!1),p=Ll(),v=async S=>{if(S&&S.preventDefault(),u(""),!e||!s){u("Please enter username and password");return}d(!0);try{const C=await fetch("/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:s})});if(!C.ok){const L=await C.json().catch(()=>({}));u(L.error||"Invalid username or password"),d(!1);return}const O=await C.json();if(O&&O.ok&&O.token){try{ln.setToken(O.token)}catch{}n(O.token);try{p("/")}catch{}}else u("Login failed")}catch{u("Server error  please try again")}finally{d(!1)}},_=async()=>{try{zf();const S=BM(),C=new ds,L=await(await WD(S,C)).user.getIdToken();try{ln.setToken(L)}catch{}n(L);try{p("/")}catch{}}catch{u("Google sign-in failed")}};return f.jsx("div",{style:{minHeight:"100vh",width:"100%",margin:0,display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, rgba(255,182,213,0.94), rgba(180,196,255,0.92))",backgroundRepeat:"no-repeat",backgroundSize:"cover"},children:f.jsxs("div",{style:{width:420,minHeight:520,padding:"56px 48px",borderRadius:28,background:"#11121d",boxShadow:"0 36px 70px rgba(0,0,0,0.40)",display:"flex",flexDirection:"column",alignItems:"center",color:"#fff",textAlign:"center"},children:[f.jsx("img",{src:"/kusgan-logo.png",alt:"Kusgan Logo",style:{width:160,height:160,objectFit:"cover",borderRadius:"22px",boxShadow:"0 10px 28px rgba(215,38,96,0.35)",marginBottom:24,background:"#000"}}),f.jsx("h1",{style:{fontSize:"1.6rem",fontWeight:700,margin:"0 0 8px"},children:"Kusgan Fitness Gym"}),f.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:"column",gap:8},children:[f.jsx("div",{style:{fontSize:13,color:"#c9c9da",fontWeight:600,marginBottom:4,textAlign:"left"}}),f.jsxs("form",{onSubmit:v,style:{width:"100%",display:"flex",flexDirection:"column",gap:8},children:[f.jsx("label",{style:{fontSize:12,color:"#c9c9da",textAlign:"left"},children:"Username"}),f.jsx("input",{type:"text",value:e,onChange:S=>t(S.target.value),placeholder:"Enter staff username",style:{padding:10,fontSize:16,borderRadius:6,border:"1px solid #2a2a36",background:"#0f1114",color:"#fff"}}),f.jsx("label",{style:{fontSize:12,color:"#c9c9da",textAlign:"left"},children:"Password"}),f.jsx("input",{type:"password",value:s,onChange:S=>a(S.target.value),placeholder:"Enter staff password",style:{padding:10,fontSize:16,borderRadius:6,border:"1px solid #2a2a36",background:"#0f1114",color:"#fff"}}),l&&f.jsx("div",{style:{color:"#f44336",fontSize:13},children:l}),f.jsx("button",{type:"submit",disabled:g,style:{marginTop:6,padding:12,borderRadius:6,background:"#1976d2",color:"#fff",border:"none",cursor:g?"default":"pointer",opacity:g?.8:1},children:g?"Signing in":"Sign in"})]}),f.jsxs("div",{style:{marginTop:18,width:"100%",textAlign:"center"},children:[f.jsx("div",{style:{fontSize:13,color:"#c9c9da",fontWeight:600,marginBottom:8},children:"Sign in as Member"}),f.jsx("div",{style:{display:"flex",justifyContent:"center"},children:f.jsx("button",{onClick:_,style:{borderRadius:8,padding:"8px 12px",background:"#fff",color:"#222",cursor:"pointer"},children:"Sign in with Google"})}),f.jsx("div",{style:{marginTop:8,color:"#8b8b9b",fontSize:13},children:"Member login via Google is not yet enabled."})]})]})]})})}function iE(){const n=new Intl.DateTimeFormat("en-US",{timeZone:"Asia/Manila",weekday:"long",month:"short",day:"2-digit",year:"numeric"}).formatToParts(new Date),e=(n.find(l=>l.type==="weekday")?.value||"").toUpperCase(),t=n.find(l=>l.type==="month")?.value||"Jan",s=parseInt(n.find(l=>l.type==="day")?.value||"01",10),a=n.find(l=>l.type==="year")?.value||"0000";return{weekday:e,text:`${t}-${s}, ${a}`}}function MV({onLogout:n=()=>{}}){const[e,t]=T.useState(iE()),[s,a]=T.useState(!1),[l,u]=T.useState(!1);return T.useEffect(()=>{const g=()=>t(iE()),d=setInterval(g,6e4);return g(),()=>clearInterval(d)},[]),T.useEffect(()=>{let g=!0;return(async()=>{try{const d=await ln.fetchWithAuth("/auth/me");if(!g)return;if(!d.ok)return a(!1);const p=await d.json().catch(()=>({}));a(p?.user?.role==="admin")}catch{a(!1)}})(),()=>{g=!1}},[]),f.jsxs(f.Fragment,{children:[f.jsxs("aside",{className:`sidebar ${l?"collapsed":""}`,children:[f.jsxs("div",{className:"brand",children:[f.jsx("img",{src:"/kusgan-logo.png",onError:g=>{try{g.currentTarget.onerror=null,g.currentTarget.src="/kusgan-logo.png"}catch{}},alt:"Kusgan logo",className:"brand-logo"}),f.jsx("div",{className:"brand-title",children:"Kusgan"})]}),f.jsxs("nav",{className:"nav",children:[f.jsxs(ml,{to:"/",end:!0,"data-label":"Dashboard",className:({isActive:g})=>g?"nav-link active":"nav-link",children:[f.jsx("span",{className:"nav-icon",children:""}),f.jsx("span",{className:"nav-label",children:"Dashboard"})]}),f.jsxs(ml,{to:"/attendance","data-label":"Staff Attendance",className:({isActive:g})=>g?"nav-link active":"nav-link",children:[f.jsx("span",{className:"nav-icon",children:""}),f.jsx("span",{className:"nav-label",children:"Staff Attendance"})]}),f.jsxs(ml,{to:"/members","data-label":"All Members",className:({isActive:g})=>g?"nav-link active":"nav-link",children:[f.jsx("span",{className:"nav-icon",children:""}),f.jsx("span",{className:"nav-label",children:"All Members"})]}),f.jsx("hr",{className:"nav-sep"}),f.jsxs(ml,{to:"/checkin","data-label":"Member Check-In",className:({isActive:g})=>g?"nav-link active":"nav-link",children:[f.jsx("span",{className:"nav-icon",children:""}),f.jsx("span",{className:"nav-label",children:"Member Check-In"})]}),s&&f.jsxs(ml,{to:"/admin","data-label":"Admin",className:({isActive:g})=>g?"nav-link active":"nav-link",children:[f.jsx("span",{className:"nav-icon",children:""}),f.jsx("span",{className:"nav-label",children:"Admin"})]})]}),f.jsx("div",{className:"sidebar-footer",children:f.jsxs("button",{className:"button logout-btn",onClick:n,title:"Logout",children:[f.jsxs("svg",{className:"logout-icon",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[f.jsx("path",{d:"M16 17l5-5-5-5",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),f.jsx("path",{d:"M21 12H9",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),f.jsx("path",{d:"M9 19H5a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h4",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"})]}),f.jsx("span",{className:"logout-label",children:"Logout"})]})})]}),f.jsx("header",{className:"topbar",children:f.jsxs("div",{className:"topbar-inner",children:[f.jsxs("div",{className:"topbar-left",children:[f.jsx("button",{className:"topbar-hamburger",onClick:()=>u(g=>!g),"aria-label":"Toggle sidebar",title:"Toggle sidebar",children:""}),f.jsx("img",{className:"topbar-logo",src:"/favicon.ico",alt:"Kusgan",onError:g=>{try{g.currentTarget.onerror=null,g.currentTarget.src="/favicon.ico"}catch{}}}),f.jsx("div",{className:"topbar-title",children:"Kusgan Fitness Gym"})]}),f.jsxs("div",{className:"topbar-right",children:[e.weekday,"  ",e.text]})]})})]})}const tt={members:"members",gymEntries:"gymEntries",payments:"payments",progress:"progress",attendance:"attendance",pricing:"pricing"};function YA(n){if(!n)return null;const e=String(n).trim().toLowerCase();return e==="members"?tt.members:e==="gymentries"||e==="gymentries"||e==="gymentries"?tt.gymEntries:e==="payments"?tt.payments:e==="progresstracker"||e==="progress"?tt.progress:e==="attendance"?tt.attendance:e==="pricing"?tt.pricing:e}function KA(n){if(!n)return null;const e={...n};return e.memberid=String(n.memberId||n.MemberID||n.id||n.memberid||"").trim(),e.firstname=n.firstName||n.firstname||n.FirstName||"",e.lastname=n.lastName||n.lastname||n.LastName||"",e._raw=n,e}async function Hf(){return{rows:(await st.getCollection(tt.members)).map(e=>({...e}))}}async function WA(){return Hf()}async function Mv(n){try{if(typeof fetch=="function"){const t=await fetch("/api/members/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(t&&t.status===201)try{return await t.json()}catch{}if(t&&t.status===409)try{return await t.json()}catch{return{ok:!1,error:"Nickname already taken"}}}}catch{}try{const t=String(n.NickName||n.nickName||n.nickname||"").trim();if(t){const s=[];try{const a=await st.queryCollection(tt.members,{wheres:[{field:"NickName",op:"==",value:t}]});s.push(...a||[])}catch{}try{const a=await st.queryCollection(tt.members,{wheres:[{field:"nickname",op:"==",value:t}]});s.push(...a||[])}catch{}if(s.length>0&&s.some(l=>String(l.NickName||l.nickname||l.nick_name||l.nickName||"").trim().toLowerCase()===t.toLowerCase()))return{ok:!1,error:"Nickname already taken"}}}catch{}const e=await st.addDocument(tt.members,n);return{ok:!0,id:e.id,row:e}}async function XA(n){return Mv(n)}async function ZA(n){const e=String(n.MemberID||n.memberId||n.id||n.memberid||"").trim();if(!e)throw new Error("MemberID required for update");try{return await st.setDocument(tt.members,e,n),{ok:!0}}catch(t){try{const s=await fetch(`/api/members/${encodeURIComponent(e)}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(s&&s.ok)try{return await s.json()}catch{return{ok:!0}}throw t}catch(s){throw s||t}}}async function Ov(n){if(!n)return null;const e=await st.getDocById(tt.members,String(n));return e?KA(e):null}async function JA(n){return Ov(n)}async function eC(n){if(!n)throw new Error("memberId required");const[e,t,s,a]=await Promise.all([Hf(),st.getCollection(tt.payments),st.getCollection(tt.gymEntries),st.getCollection(tt.progress)]),l=String(n).trim(),u=(e.rows||[]).find(v=>String(v.MemberID||v.memberId||v.id||v.memberid||"").trim()===l)||null;KA(u);const g=(t||[]).filter(v=>String(v.MemberID||v.memberId||v.id||v.memberid||"").trim()===l),d=(s||[]).filter(v=>String(v.MemberID||v.memberId||v.id||v.memberid||"").trim()===l),p=(a||[]).filter(v=>String(v.MemberID||v.memberId||v.id||v.memberid||"").trim()===l);return{member:u,payments:g,gymEntries:d,progress:p}}async function jv(){return{rows:await st.getCollection(tt.gymEntries)}}async function tC(){return jv()}async function yo(n){return{ok:!0,id:(await st.addDocument(tt.gymEntries,n)).id}}async function nC(n,e={}){if(!n)throw new Error("memberId required");const t=new Date().toISOString(),s=t.slice(0,10),a=!!e.wantsOut,l={...e};if(!a)return!l.TimeIn&&!l.timeIn&&(l.TimeIn=t),!l.Date&&!l.date&&(l.Date=s),l.MemberID=n,await yo(l);const u=await st.getCollection(tt.gymEntries),g=_=>{try{if(String(_.MemberID||_.memberId||_.memberid||"").trim()!==String(n).trim())return!1;if(l.TimeIn&&l.Date){const C=String(_.TimeIn||_.timeIn||""),O=String(_.Date||_.date||"");if(C&&O&&String(l.TimeIn)===String(C)&&String(l.Date)===String(O))return!0}return!1}catch{return!1}};let d=null;if(l.TimeIn&&l.Date&&(d=u.find(g)||null),!d){const _=new Date;_.setHours(0,0,0,0);const S=u.filter(C=>{try{if(String(C.MemberID||C.memberId||C.memberid||"").trim()!==String(n).trim())return!1;const L=new Date(C.Date||C.date||C.DateTime||C.timestamp||C.TimeIn||"");if(isNaN(L))return!1;L.setHours(0,0,0,0);const U=L.getTime()===_.getTime(),z=C.TimeOut||C.timeOut||C.Timeout||C.TimeOUT;return U&&(!z||String(z).trim()==="")}catch{return!1}}).sort((C,O)=>{const L=C.TimeIn||C.timeIn||"",U=O.TimeIn||O.timeIn||"";return String(U).localeCompare(String(L))});d=S.length?S[0]:null}const p=new Date().toISOString();if(!d){const _={MemberID:n,TimeOut:p,Date:l.Date||s};return l.Workouts&&(_.Workouts=l.Workouts),l.Comments&&(_.Comments=l.Comments),l.Coach&&(_.Coach=l.Coach),l.Focus&&(_.Focus=l.Focus),await yo(_)}const v={TimeOut:p};l.Workouts&&(v.Workouts=l.Workouts),l.Comments&&(v.Comments=l.Comments),l.Coach&&(v.Coach=l.Coach),l.Focus&&(v.Focus=l.Focus);try{const _=d.TimeIn||d.timeIn||"";if(_){const S=new Date(_),C=new Date(p);if(!isNaN(S)&&!isNaN(C)&&C>S){const O=(C-S)/36e5;v.TotalHours=Math.round(O*100)/100}}}catch{}return await st.updateDocument(tt.gymEntries,d.id,v),{ok:!0,id:d.id}}async function OV(n,e={}){if(!n)throw new Error("memberId is required");const t=await st.getCollection(tt.gymEntries),s=new Date;s.setHours(0,0,0,0);const a=t.find(d=>{try{const p=String(d.MemberID||d.memberId||d.memberid||d.id||"");if(!p||p.trim()!==String(n).trim())return!1;const v=new Date(d.Date||d.date||d.DateTime||d.timestamp||"");if(isNaN(v))return!1;v.setHours(0,0,0,0);const _=v.getTime()===s.getTime(),S=d.TimeOut||d.timeOut||d.Timeout||d.TimeOUT;return _&&(!S||String(S).trim()==="")}catch{return!1}});if(a)return{ok:!0,id:a.id,existed:!0};const l=new Date().toISOString(),u=l.slice(0,10);return await yo({MemberID:n,TimeIn:l,Date:u,...e})}async function jV(n,e={}){if(!n)throw new Error("memberId is required");const s=(await st.getCollection(tt.gymEntries)).filter(g=>String(g.MemberID||g.memberId||g.memberid||"").trim()===String(n).trim()&&!(g.TimeOut||g.timeOut||"").toString().trim()).sort((g,d)=>{const p=g.TimeIn||g.timeIn||"",v=d.TimeIn||d.timeIn||"";return String(p).localeCompare(String(v))});if(!s.length){const g=new Date().toISOString(),d=g.slice(0,10);return yo({MemberID:n,TimeOut:g,Date:d,...e})}const a=s[s.length-1],l=new Date().toISOString(),u={TimeOut:l};e&&Object.assign(u,e);try{const g=a.TimeIn||a.timeIn||"";if(g){const d=new Date(g),p=new Date(l);if(!isNaN(d)&&!isNaN(p)&&p>d){const v=(p-d)/36e5;u.TotalHours=Math.round(v*100)/100}}}catch{}return await st.updateDocument(tt.gymEntries,a.id,u),{ok:!0,id:a.id}}async function kV(n){if(!n)throw new Error("payload required");const e=n.MemberID||n.memberId||n.memberid||"";if(n.id)return await st.updateDocument(tt.gymEntries,String(n.id),n),{ok:!0};const s=(await st.getCollection(tt.gymEntries)).find(l=>{try{const u=String(l.MemberID||l.memberId||l.memberid||"").trim();if(!u||String(u)!==String(e).trim())return!1;const g=String(l.TimeIn||l.timeIn||""),d=String(n.TimeIn||n.timeIn||""),p=String(l.Date||l.date||""),v=String(n.Date||n.date||"");return!!(d&&g&&d===g&&v&&p&&v===p||n.rowNumber&&String(l.rowNumber||"")===String(n.rowNumber))}catch{return!1}});if(s){try{const l=n.TimeIn||n.timeIn||"",u=n.TimeOut||n.timeOut||"";if(l&&u&&(n.TotalHours===void 0||n.TotalHours===null||n.TotalHours==="")){const g=new Date(l),d=new Date(u);if(!isNaN(g)&&!isNaN(d)&&d>g){const p=(d-g)/36e5;n.TotalHours=Math.round(p*100)/100}}}catch{}return await st.updateDocument(tt.gymEntries,s.id,n),{ok:!0,id:s.id}}return await yo(n)}async function iC(){return{rows:await st.getCollection(tt.progress)}}async function rC(n){if(!n)throw new Error("row required");try{return{ok:!0,id:(await st.addDocument(tt.progress,n)).id}}catch(e){try{if(typeof fetch=="function"){const t=await fetch("/api/progress",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(t&&t.ok)try{return await t.json()}catch{return{ok:!0}}}}catch{}throw e}}async function sC({limit:n=200,days:e=90}={}){const t=new Date(Date.now()-e*24*60*60*1e3);let s=[],a=[],l=[];try{[s,a,l]=await Promise.all([st.getCollection(tt.members),st.getCollection(tt.payments),st.getCollection(tt.gymEntries)])}catch{s=a=l=[]}const u=(s||[]).map(v=>({...v})),g=new Set,d=v=>{if(!v)return null;const _=v instanceof Date?v:new Date(v);return isNaN(_)?null:_};for(const v of u){const _=d(v.memberDate||v.member_date||v.member_since||v.membersince||v.MemberSince||v.MemberSince||v.MemberDate||v.memberSince||v.createdAt||v.created_at||v.joined||v.start_date);_&&_>=t&&g.add(String(v.memberId||v.MemberID||v.memberId||v.id||v.memberid||v.member||"").trim())}for(const v of a||[]){const _=d(v.date||v.Date||v.createdAt||v.created_at||v.timestamp);if(_&&_>=t){const S=String(v.MemberID||v.memberId||v.memberid||v.id||"").trim();S&&g.add(S)}}for(const v of l||[]){const _=d(v.Date||v.date||v.DateTime||v.timestamp||v.timeIn||v.TimeIn);if(_&&_>=t){const S=String(v.MemberID||v.memberId||v.memberid||v.id||"").trim();S&&g.add(S)}}let p=[];return g.size>0?p=u.filter(v=>g.has(String(v.memberId||v.MemberID||v.id||v.memberid||"").trim())):p=[...u].sort((v,_)=>{const S=d(v.memberDate||v.createdAt||v.joined),C=d(_.memberDate||_.createdAt||_.joined);return!S&&!C?0:S?C?C-S:-1:1}),{rows:p.slice(0,Math.max(0,Number(n)||200))}}const up=new Map,PV=1e3*30;async function aC(n,{limit:e=200}={}){if(!n||!String(n).trim())return{rows:[]};const s=String(n).trim().toLowerCase(),a=`search:${s}`,l=up.get(a);if(l&&Date.now()-l.ts<PV)return{rows:l.rows.slice(0,e)};const u=s+"",g=["firstName","firstname","lastName","lastname","nickname","nick_name","nickName"],d=new Map;try{for(const v of g)try{const _=await st.queryCollection(tt.members,{orderBy:{field:v},startAt:s,endAt:u,limit:e});for(const S of _)d.set(S.id||String(S.MemberID||S.memberId||S.id||""),S)}catch{continue}if(d.size===0){const v=await st.getCollection(tt.members);for(const _ of v)JSON.stringify(_).toLowerCase().indexOf(s)!==-1&&d.set(_.id||String(_.MemberID||_.memberId||_.id||""),_)}const p=Array.from(d.values()).slice(0,e).map(v=>({...v}));return up.set(a,{rows:p,ts:Date.now()}),{rows:p}}catch{try{const _=(await st.getCollection(tt.members)||[]).filter(S=>JSON.stringify(S).toLowerCase().indexOf(s)!==-1).slice(0,e);return up.set(a,{rows:_,ts:Date.now()}),{rows:_}}catch{return{rows:[]}}}}async function VV(n){const e=YA(n);return e?{rows:await st.getCollection(e)}:{rows:[]}}async function LV(n,e){const t=YA(n);if(!t)throw new Error("Unknown sheet: "+n);return{ok:!0,id:(await st.addDocument(t,e)).id}}async function oC(){return{rows:await st.getCollection(tt.payments)}}async function lC(n="",e=""){const t=await st.getCollection(tt.payments);if(!n&&!e)return{rows:t};const s=g=>{if(!g)return null;try{return g&&typeof g=="object"&&g.toDate?g.toDate():new Date(String(g))}catch{return null}},a=n?new Date(n):null,l=e?new Date(e):null;return{rows:(t||[]).filter(g=>{const d=s(g.Date||g.date||g.createdAt||g.timestamp);return!(!d||a&&d<a||l&&d>l)})}}async function cC(n){return{ok:!0,id:(await st.addDocument(tt.payments,n)).id}}async function uC(n,e){const t=s=>new Promise((a,l)=>{try{const u=new FileReader;u.onload=()=>a(u.result),u.onerror=g=>l(g),u.readAsDataURL(s)}catch(u){l(u)}});try{if(n instanceof Blob||typeof File<"u"&&n instanceof File){const p=n,v=p&&p.name||`photo-${Date.now()}.jpg`,_=`members/${String(e||"unknown")}/${v}`;return await st.uploadFile(_,p)}const s=n||{},a=s.memberId||s.MemberID||e||"unknown",l=s.filename||`photo-${Date.now()}.jpg`,u=s.data||s.base64||"",g=`members/${String(a)}/${l}`;return await st.uploadFile(g,u)}catch(s){try{let a="",l=`photo-${Date.now()}.jpg`;if(n instanceof Blob||typeof File<"u"&&n instanceof File){const d=n;a=await t(d),l=d&&d.name||l}else{const d=n||{};a=d.data||d.base64||"",l=d.filename||l}if(!a)throw new Error("no data for fallback upload");const u=await fetch("/api/upload-photo",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filename:l,data:a})});if(!u.ok)throw new Error("proxy upload failed");const g=await u.json();if(g&&g.url)return g.url.indexOf("http")===0?g.url:`${location.origin}${g.url}`;throw new Error("invalid proxy response")}catch(a){throw new Error("uploadMemberPhoto failed: "+String(a?.message||s))}}}async function hC(n){return uC(n)}async function dC(){return{rows:await st.getCollection(tt.pricing)}}async function fC(n){const e=await st.addDocument(tt.pricing,n);return{ok:!0,id:e.id,row:e}}async function mC(n,e){const t=await st.updateDocument(tt.pricing,String(n),e);return{ok:!0,id:t.id,row:t}}async function gC(n){const e=await st.getCollection(tt.attendance);return n?{rows:e.filter(t=>String(t.Date||"").startsWith(String(n)))}:{rows:e}}async function pC(n){if(!n)throw new Error("staff required");const e=new Date().toISOString();return{ok:!0,id:(await st.addDocument(tt.attendance,{Staff:n,TimeIn:e,Date:e.slice(0,10)})).id}}async function yC(n){const t=(await st.getCollection(tt.attendance)).filter(a=>String(a.Staff)===String(n)&&(!a.TimeOut||a.TimeOut==="")).sort((a,l)=>(a.TimeIn||"").localeCompare(l.TimeIn||""));if(!t.length)return{ok:!1,error:"no open entry"};const s=t[t.length-1];return await st.updateDocument(tt.attendance,s.id,{TimeOut:new Date().toISOString()}),{ok:!0}}async function UV(n,e={}){if(!n)throw new Error("staff required");const t=new Date().toISOString(),s=t.slice(0,10);return{ok:!0,id:(await st.addDocument(tt.attendance,{Staff:n,TimeIn:t,Date:s,...e})).id}}async function vC(){return{rows:[]}}const zV={fetchMembers:Hf,fetchMembersFresh:WA,addMember:Mv,saveMember:XA,updateMember:ZA,fetchMemberById:Ov,fetchMemberByIdFresh:JA,fetchMemberBundle:eC,fetchAttendance:gC,clockIn:pC,clockOut:yC,fetchGymEntries:jv,fetchGymEntriesFresh:tC,addGymEntry:yo,gymQuickAppend:nC,fetchProgressTracker:iC,addProgressRow:rC,fetchPricing:dC,fetchPayments:oC,addPayment:cC,fetchDashboard:vC,fetchMembersRecent:sC,searchMembersByName:aC,addPricing:fC,updatePricing:mC,uploadPhoto:hC},_C=Object.freeze(Object.defineProperty({__proto__:null,addGymEntry:yo,addMember:Mv,addPayment:cC,addPricing:fC,addProgressRow:rC,attendanceQuickAppend:UV,clockIn:pC,clockOut:yC,default:zV,fetchAttendance:gC,fetchDashboard:vC,fetchGymEntries:jv,fetchGymEntriesFresh:tC,fetchMemberBundle:eC,fetchMemberById:Ov,fetchMemberByIdFresh:JA,fetchMembers:Hf,fetchMembersFresh:WA,fetchMembersRecent:sC,fetchPayments:oC,fetchPaymentsReport:lC,fetchPricing:dC,fetchProgressTracker:iC,fetchSheet:VV,gymClockIn:OV,gymClockOut:jV,gymQuickAppend:nC,insertRow:LV,saveMember:XA,searchMembersByName:aC,updateMember:ZA,updatePricing:mC,uploadMemberPhoto:uC,uploadPhoto:hC,upsertGymEntry:kV},Symbol.toStringTag,{value:"Module"})),BV={..._C},kt={..._C};kt.fetchPaymentsReport=kt.fetchPaymentsReport||lC||BV.fetchPaymentsReport||(async()=>({rows:[]}));const rE=T.createContext(!1);function To({open:n,onClose:e,title:t,children:s,width:a=760,maxHeight:l="90vh",noWrapper:u=!1,noInternalScroll:g=!1}){if(!n)return null;const d=T.useContext(rE),v={width:"min(1000px, 96vw)",background:"#fff",borderRadius:14,padding:16,border:"1px solid var(--light-border)",boxShadow:"0 20px 60px rgba(0,0,0,.2)",maxHeight:l,overflowY:"auto",overflowX:"hidden",boxSizing:"border-box"};return d&&!u?f.jsx("div",{style:v,children:s}):f.jsx(rE.Provider,{value:!0,children:f.jsx("div",{onClick:_=>{_.target===_.currentTarget&&e&&e()},style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:u?(()=>{const _={width:`min(${a}px, 96vw)`,background:"#fff",borderRadius:14,padding:16,border:"1px solid var(--light-border)",boxShadow:"0 20px 60px rgba(0,0,0,.2)",maxHeight:"98vh",overflow:"visible",boxSizing:"border-box"};return f.jsxs("div",{style:_,onClick:S=>S.stopPropagation(),children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[t?f.jsx("div",{style:{fontWeight:800,fontSize:18},children:t}):f.jsx("div",{}),f.jsx("button",{type:"button",className:"button",onClick:e,style:{background:"#eee",color:"#333"},children:""})]}),s]})})():g?(()=>{const _={...v,maxHeight:"98vh",overflowY:"visible"};return f.jsxs("div",{style:_,onClick:S=>S.stopPropagation(),children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10},children:[t?f.jsx("div",{style:{fontWeight:800,fontSize:18},children:t}):f.jsx("div",{}),f.jsx("button",{type:"button",className:"button",onClick:e,style:{background:"#eee",color:"#333"},children:""})]}),s]})})():f.jsxs("div",{style:v,onClick:_=>_.stopPropagation(),children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10},children:[t?f.jsx("div",{style:{fontWeight:800,fontSize:18},children:t}):f.jsx("div",{}),f.jsx("button",{type:"button",className:"button",onClick:e,style:{background:"#eee",color:"#333"},children:""})]}),s]})})})}const xl=new Map;function FV(n,e){return xl.has(n)||xl.set(n,new Set),xl.get(n).add(e),()=>bC(n,e)}function bC(n,e){const t=xl.get(n);t&&(t.delete(e),t.size||xl.delete(n))}function HV(n,e){const t=xl.get(n);if(t)for(const s of Array.from(t))try{s(e)}catch(a){console.error("event handler error",a)}}const Gn={on:FV,off:bC,emit:HV},{addPayment:qV,fetchPricing:GV,fetchPayments:$V}=kt,Bu="Asia/Manila",_d=()=>new Intl.DateTimeFormat("en-CA",{timeZone:Bu,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date),hl=n=>{if(!n)return"";const e=n instanceof Date?n:new Date(n);return isNaN(e)?"":new Intl.DateTimeFormat("en-CA",{timeZone:Bu,year:"numeric",month:"2-digit",day:"2-digit"}).format(e)},QV=()=>new Intl.DateTimeFormat("en-PH",{timeZone:Bu,hour:"2-digit",minute:"2-digit",hour12:!1}).format(new Date).replace(/^(\d{2}):(\d{2}).*$/,"$1:$2"),bd=n=>{if(!n)return"-";let e;if(typeof n=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(n)){const[u,g,d]=n.split("-").map(Number);e=new Date(Date.UTC(u,g-1,d))}else e=n instanceof Date?n:new Date(n);if(isNaN(e))return"-";const t=new Intl.DateTimeFormat("en-US",{timeZone:Bu,month:"short",day:"numeric",year:"numeric"}).formatToParts(e),s=t.find(u=>u.type==="month")?.value||"",a=t.find(u=>u.type==="day")?.value||"",l=t.find(u=>u.type==="year")?.value||"";return`${s}-${a}, ${l}`},Qc=(n,e)=>{if(!n||!e)return"";const[t,s,a]=n.split("-").map(Number),l=new Date(Date.UTC(t,s-1,a));return l.setUTCDate(l.getUTCDate()+Math.max(0,Number(e)-1)),new Intl.DateTimeFormat("en-CA",{timeZone:"UTC",year:"numeric",month:"2-digit",day:"2-digit"}).format(l)},sE=n=>{const e=String(n??"").trim().toLowerCase();return e==="yes"||e==="y"||e==="true"||e==="1"},Yc=n=>{if(!n)return{gym:!1,coach:!1};const e=Object.entries(n||{}),t=l=>{for(const[u,g]of e){const d=u.toLowerCase().replace(/\s+/g,"");if(l.some(p=>d===p.toLowerCase().replace(/\s+/g,"")))return g}},s=sE(t(["Gym membership","Gym Membership","GymMembership","Membership"])),a=sE(t(["Coach subscription","Coach Subscription","CoachSubscription","Coach"]));return{gym:s,coach:a}},dl=(n,e=0)=>{if(!n)return"";const[t,s,a]=String(n).split("-").map(Number);if([t,s,a].some(u=>Number.isNaN(u)))return"";const l=new Date(Date.UTC(t,s-1,a));return l.setUTCDate(l.getUTCDate()+Number(e||0)),new Intl.DateTimeFormat("en-CA",{timeZone:"UTC",year:"numeric",month:"2-digit",day:"2-digit"}).format(l)};function YV({open:n,onClose:e,memberId:t,onSaved:s,membershipEnd:a,coachEnd:l,isStudent:u,birthDate:g}){const[d,p]=T.useState([]),[v,_]=T.useState(!1),[S,C]=T.useState([]),[O,L]=T.useState({Particulars:"",Mode:"",Cost:"",StartDate:"",EndDate:""}),[U,z]=T.useState("");T.useEffect(()=>{let x=!0;if(!n){p([]),L({Particulars:"",Mode:"",Cost:"",StartDate:"",EndDate:""}),z("");return}return(async()=>{try{z("");let A=[];try{const V=await GV();V&&Array.isArray(V.rows)?A=V.rows:V&&Array.isArray(V)&&(A=V)}catch{}if((!A||A.length===0)&&typeof fetch=="function"){const V=["/api/products","http://localhost:4000/products"];for(const N of V)try{const fe=await fetch(N);if(fe&&fe.ok){const F=await fe.json().catch(()=>null);if(F&&Array.isArray(F)){A=(F||[]).map(D=>({Particulars:D.name||D.sku||`Product ${D.id}`,Cost:typeof D.price<"u"?Number(D.price).toFixed(2):"",Validity:D.validity_days||D.validity||0,"Gym membership":D.is_gym_membership?"Yes":"No","Coach subscription":D.is_coach_subscription?"Yes":"No",Notes:D.notes||""}));break}}}catch{}}x&&p(A||[])}catch(A){x&&z(A?.message||"Failed to load pricing")}})(),()=>{x=!1}},[n]),T.useEffect(()=>{if(!n||!t){C([]);return}let x=!0;return(async()=>{try{const A=await $V(),V=A&&Array.isArray(A.rows)?A.rows:Array.isArray(A)?A:[];if(!x)return;const N=String(t).trim(),fe=(V||[]).filter(F=>String(F.MemberID||F.memberId||F.MemberID||F.memberid||"").trim()===N);C(fe||[])}catch{C([])}})(),()=>{x=!1}},[n,t]);const X=T.useMemo(()=>{if(!g)return!1;const x=g instanceof Date?g:new Date(g);if(isNaN(x))return!1;const A=new Date;let V=A.getFullYear()-x.getFullYear();const N=A.getMonth()-x.getMonth();return(N<0||N===0&&A.getDate()<x.getDate())&&V--,V>=60},[g]),{manilaHour:q,isOffPeakWindow:ne,isDailyWindow:ee}=T.useMemo(()=>{const x=new Intl.DateTimeFormat("en-US",{timeZone:Bu,hour12:!1,hour:"2-digit"}).formatToParts(new Date),A=Number(x.find(fe=>fe.type==="hour")?.value||"0"),V=A>=6&&A<15,N=A>=15&&A<22;return{manilaHour:A,isOffPeakWindow:V,isDailyWindow:N}},[]),de=T.useMemo(()=>{const x=!!(u||X);return(d||[]).filter(A=>{const V=String(A.Particulars||"").trim();V.toLowerCase();const N=/(student|senior|discount|disc)/i.test(V),fe=/off\s*-?\s*peak|offpeak/i.test(V),F=/\bdaily\b|daily\s*pass|1[- ]?day/i.test(V),D=Yc(A);if(N&&!x)return!1;const $=(()=>{try{if(!a)return!1;const B=new Date(a);B.setHours(0,0,0,0);const K=new Date;return K.setHours(0,0,0,0),B>=K}catch{return!1}})(),Q=(()=>{try{if(!l)return!1;const B=new Date(l);B.setHours(0,0,0,0);const K=new Date;return K.setHours(0,0,0,0),B>=K}catch{return!1}})(),J=F&&D.gym&&!D.coach,Y=F&&D.coach&&!D.gym,I=F&&D.gym&&D.coach;return!(J&&$||Y&&Q||I&&($||Q)||fe&&!ne||F&&!fe&&!ee)})},[d,u,X,ne,ee,a,l]);T.useEffect(()=>{if(!O.Particulars)return;de.some(A=>String(A.Particulars)===String(O.Particulars))||L(A=>({...A,Particulars:"",Cost:"",EndDate:""}))},[de]);const k=T.useMemo(()=>{const x={gymOnly:[],coachOnly:[],bundle:[],merch:[]};return(de||[]).forEach(A=>{const V=Yc(A);V.gym&&!V.coach?x.gymOnly.push(A):!V.gym&&V.coach?x.coachOnly.push(A):V.gym&&V.coach?x.bundle.push(A):x.merch.push(A)}),x},[de]),M=x=>{const A=(de||[]).find(K=>String(K.Particulars)===String(x)),V=A?(parseFloat(A.Cost)||0).toFixed(2):"",N=A?Number(A.Validity||0):0,fe=Yc(A),F=/\bdaily\b|daily\s*pass|1[- ]?day/i.test(String(x||""));let D=!1;if(F&&S&&S.length){const le=Date.now()-720*60*60*1e3,we=String(x||"").trim();(S||[]).filter(Se=>{try{if(String(Se.Particulars||Se.Particular||"").trim()!==we)return!1;const ke=Se.Date||Se.DatePaid||Se.DateTime||Se.timestamp||Se.Timestamp||Se.Time||null;if(!ke)return!1;let Ae=new Date(ke);if(isNaN(Ae))if(/^\d{4}-\d{2}-\d{2}$/.test(String(ke)))Ae=new Date(String(ke)+"T00:00:00");else return!1;return Ae.getTime()>=le}catch{return!1}}).length>=12&&(D=!0)}const $=_d(),Q=a?hl(a):"",J=l?hl(l):"",Y=fe.gym?Q&&Q>=$?dl(Q,1):$:null,I=fe.coach?J&&J>=$?dl(J,1):$:null;let B=$;fe.gym&&fe.coach?B=$:fe.gym&&Y?B=Y:fe.coach&&I?B=I:B=$,L(K=>{const le=B||K.StartDate||$;return{...K,Particulars:x,Cost:D?"0.00":V,StartDate:le,EndDate:N?Qc(le,N):"",PromoApplied:D}})},P=async x=>{if(x.preventDefault(),!t)return z("Missing MemberID");if(!O.Particulars)return z("Select Particulars.");if(!O.Mode)return z("Select a payment mode.");if(!O.Cost)return z("Cost is missing for this item.");_(!0),z("");try{const A=(de||[]).find(Ee=>String(Ee.Particulars)===String(O.Particulars)),V=A?Number(A.Validity||0):0,N=Yc(A),fe=String(A?.Particulars||"").toLowerCase(),F=/\bdaily\b|daily\s*pass|1[- ]?day/i.test(fe),D=/off\s*-?\s*peak|offpeak/i.test(fe),$=(()=>{try{if(!a)return!1;const Ee=new Date(a);Ee.setHours(0,0,0,0);const Se=new Date;return Se.setHours(0,0,0,0),Ee>=Se}catch{return!1}})();if(F&&$){z("Daily pass not allowed: member has active membership"),_(!1);return}if(F&&!D&&!ee){z("Daily pass only available 3pm-10pm (Manila time)"),_(!1);return}if(D&&!ne){z("Off-peak pass only available 6am-3pm (Manila time)"),_(!1);return}const Q=(()=>{try{if(!l)return!1;const Ee=new Date(l);Ee.setHours(0,0,0,0);const Se=new Date;return Se.setHours(0,0,0,0),Ee>=Se}catch{return!1}})();if(N.coach&&Q){z("Coach session not allowed: member has active coach subscription"),_(!1);return}const J=_d(),Y=a?hl(a):"",I=l?hl(l):"",B=N.gym?Y&&Y>=J?dl(Y,1):O.StartDate||J:null,K=N.coach?I&&I>=J?dl(I,1):O.StartDate||J:null,le=B&&V?Qc(B,V):"",we=K&&V?Qc(K,V):"";await qV({MemberID:t,Particulars:O.Particulars,StartDate:O.StartDate||"",EndDate:O.EndDate||"",GymValidUntil:le,CoachValidUntil:we,Mode:O.Mode,Cost:String(O.Cost).trim(),Date:_d(),Time:QV()}),s&&s(),e&&e()}catch(A){const V=A?.message||"Failed to add payment";z(V);try{Gn.emit("modal:error",{message:V,source:"PaymentModal",error:String(A)})}catch{}}finally{_(!1)}};return n?f.jsx(To,{open:n,onClose:e,title:"Add Payment",width:560,noInternalScroll:!0,children:f.jsxs("form",{onSubmit:P,style:{width:"100%"},children:[U&&f.jsx("div",{className:"small-error",style:{marginBottom:8},children:U}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10,marginBottom:10},children:[f.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[f.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:4},children:"Gym Membership - Valid until"}),f.jsx("div",{style:{fontWeight:700},children:a?bd(a):"-"})]}),f.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[f.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:4},children:"Coach Subscription - Valid until"}),f.jsx("div",{style:{fontWeight:700},children:l?bd(l):"-"})]})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[f.jsxs("label",{className:"field",style:{gridColumn:"1 / span 2"},children:[f.jsx("span",{className:"label",children:"Particulars"}),f.jsxs("select",{value:O.Particulars,onChange:x=>M(x.target.value),required:!0,children:[f.jsx("option",{value:"",children:"Choose product/service"}),k.gymOnly.length>0&&f.jsx("optgroup",{label:"Gym membership only",children:k.gymOnly.map((x,A)=>f.jsx("option",{value:x.Particulars,children:x.Particulars},`gym-${x.Particulars}-${A}`))}),k.coachOnly.length>0&&f.jsx("optgroup",{label:"Coach subscription only",children:k.coachOnly.map((x,A)=>f.jsx("option",{value:x.Particulars,children:x.Particulars},`coach-${x.Particulars}-${A}`))}),k.bundle.length>0&&f.jsx("optgroup",{label:"Gym & Coach bundle",children:k.bundle.map((x,A)=>f.jsx("option",{value:x.Particulars,children:x.Particulars},`bundle-${x.Particulars}-${A}`))}),k.merch.length>0&&f.jsx("optgroup",{label:"Merchandise",children:k.merch.map((x,A)=>f.jsx("option",{value:x.Particulars,children:x.Particulars},`merch-${x.Particulars}-${A}`))})]}),O.Particulars&&(()=>{const x=(de||[]).find(Y=>String(Y.Particulars)===String(O.Particulars)),A=Yc(x),V=x?Number(x.Validity||0):0;if(!V)return null;const N=_d(),fe=a?hl(a):"",F=l?hl(l):"",D=A.gym?fe&&fe>=N?dl(fe,1):O.StartDate||N:null,$=A.coach?F&&F>=N?dl(F,1):O.StartDate||N:null,Q=D?Qc(D,V):null,J=$?Qc($,V):null;return!Q&&!J?null:f.jsxs("div",{style:{background:"#fde8ef",border:"1px solid #ffd7e3",color:"#8b1a3b",marginTop:8,padding:8,borderRadius:8,fontSize:13,lineHeight:1.35},children:[Q&&f.jsxs("div",{children:["New Gym valid until: ",f.jsx("b",{children:bd(Q)})]}),J&&f.jsxs("div",{children:["New Coach valid until: ",f.jsx("b",{children:bd(J)})]})]})})()]}),f.jsxs("label",{className:"field",children:[f.jsx("span",{className:"label",children:"Mode of Payment"}),f.jsxs("select",{value:O.Mode,onChange:x=>L(A=>({...A,Mode:x.target.value})),required:!0,children:[f.jsx("option",{value:"",children:"Select mode"}),f.jsx("option",{value:"Cash",children:"Cash"}),f.jsx("option",{value:"GCash",children:"GCash"})]})]}),f.jsxs("label",{className:"field",children:[f.jsx("span",{className:"label",children:"Cost"}),f.jsx("input",{type:"number",step:"0.01",min:"0",value:O.Cost,readOnly:!0,disabled:!0}),O.PromoApplied&&f.jsx("div",{style:{marginTop:6,fontSize:12,color:"#065f46"},children:"Promo applied  this item will be free (12 uses in last 30 days)"})]})]}),f.jsx("div",{style:{marginTop:8,color:"var(--muted)",fontSize:12},children:"Validity is applied inclusive of the Start Date."}),f.jsxs("div",{style:{marginTop:12,display:"flex",gap:10,justifyContent:"flex-end"},children:[f.jsx("button",{type:"button",className:"back-btn",onClick:e,style:{background:"#e5e7eb",color:"#111",fontWeight:700},children:"Cancel"}),f.jsx("button",{type:"submit",className:"primary-btn",disabled:v,children:"+ Add Payment"})]})]})}):null}function KV({open:n,onClose:e,onCapture:t,waitForAck:s=!1}){const a=T.useRef(null),l=T.useRef(null),u=T.useRef(!1),[g,d]=T.useState([]),[p,v]=T.useState(""),[_,S]=T.useState(""),[C,O]=T.useState(!1),L=()=>{l.current&&(l.current.getTracks().forEach(x=>x.stop()),l.current=null)},U=async(x="")=>{if(!u.current){u.current=!0,O(!0),S(""),L();try{const A=x?{video:{deviceId:{exact:x},width:{ideal:1280},height:{ideal:720}},audio:!1}:{video:{facingMode:{ideal:"environment"},width:{ideal:1280},height:{ideal:720}},audio:!1};let V;try{V=await navigator.mediaDevices.getUserMedia(A)}catch(N){try{const fe=x?{video:{deviceId:{ideal:x}},audio:!1}:{video:!0,audio:!1};V=await navigator.mediaDevices.getUserMedia(fe)}catch(fe){const F=fe||N,D=F&&F.name?String(F.name):"";S(D==="NotAllowedError"?"Camera permission denied. Please allow camera access in the browser site settings and macOS Privacy > Camera.":D==="NotReadableError"?"Camera is busy or not readable. Close other apps using the camera (e.g., Zoom/Meet/FaceTime) and try again.":D==="OverconstrainedError"||D==="ConstraintNotSatisfiedError"?"Selected camera doesn't meet constraints. Try choosing a different camera.":D==="NotFoundError"?"No camera found. Plug in a camera or check system permissions.":"Cannot access camera. Check site permissions and OS privacy settings.");return}}if(l.current=V,a.current){a.current.srcObject=V;try{await a.current.play()}catch{}}try{await z()}catch{}}catch{S("Cannot access camera. Check site permissions and OS privacy settings.")}finally{u.current=!1,O(!1)}}},z=async()=>{try{const A=(await navigator.mediaDevices.enumerateDevices()).filter(V=>V.kind==="videoinput");d(A),!p&&A[0]&&v(A[0].deviceId)}catch{}};T.useEffect(()=>{if(!n){L();return}return(async()=>(S(""),await U(p||"")))(),navigator.mediaDevices?.addEventListener?.("devicechange",z),()=>{navigator.mediaDevices?.removeEventListener?.("devicechange",z),L()}},[n]),T.useEffect(()=>{if(!(!n||!p)){try{const x=l.current?.getVideoTracks?.()[0]?.getSettings?.().deviceId||"";if(x&&x===p)return}catch{}U(p)}},[p]);const X=async()=>{if(!a.current)return;const x=a.current,A=document.createElement("canvas"),V=x.videoWidth||1280,N=x.videoHeight||720,fe=800,F=V>fe?fe/V:1,D=Math.max(320,Math.round(V*F)),$=Math.max(240,Math.round(N*F));A.width=D,A.height=$,A.getContext("2d").drawImage(x,0,0,D,$);const J=A.toDataURL("image/jpeg",.65);try{const Y=t?.(J);if(s&&Y&&typeof Y.then=="function"){de(!0);try{await Promise.resolve(Y)}catch(I){S(I&&I.message?I.message:String(I||"Failed to process photo"))}}else try{Y&&typeof Y.then=="function"&&Y.catch(I=>{try{S(String(I?.message||I))}catch{}})}catch{}}catch(Y){S(Y&&Y.message?Y.message:String(Y||"Failed to process photo"))}finally{try{de(!1)}catch{}L(),e?.()}},[q,ne]=T.useState(null),[ee,de]=T.useState(!1),k=async()=>{if(!q)return;S("");const x=t?.(q);if(s&&x&&typeof x.then=="function"){de(!0);try{await Promise.resolve(x)}catch(A){const V=A&&A.message?A.message:String(A||"Failed to process photo");S(V)}finally{de(!1),ne(null),e?.()}return}try{x&&typeof x.then=="function"&&x.catch(A=>{try{S(String(A?.message||A))}catch{}})}catch{}ne(null),e?.()},M=()=>{ne(null),U(p||"")};if(!n)return null;const P=f.jsxs(To,{open:n,onClose:e,width:720,noWrapper:!0,children:[f.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[f.jsx("label",{style:{fontWeight:600,fontSize:14},children:"Camera:"}),f.jsxs("select",{value:p,onChange:x=>v(x.target.value),style:{flex:1,padding:"8px 10px",borderRadius:8,border:"1px solid #e7e8ef"},children:[g.length===0&&f.jsx("option",{value:"",children:"(No camera found)"}),g.map(x=>f.jsx("option",{value:x.deviceId,children:x.label||"Camera"},x.deviceId))]})]}),!_&&!l.current&&f.jsx("div",{style:{color:"#666",marginBottom:8},children:"Initializing camera please allow the browser prompt."}),_?f.jsx("div",{style:{color:"#d33",marginBottom:12},children:_}):f.jsx("div",{style:{width:"100%"},children:q?f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[f.jsx("img",{src:q,alt:"preview",style:{width:"100%",borderRadius:10}}),f.jsx("div",{style:{color:"#666",fontSize:13},children:"Preview  accept to use this photo or retake."})]}):f.jsx("video",{ref:a,playsInline:!0,muted:!0,style:{width:"100%",borderRadius:10,background:"#000"}})}),f.jsx("div",{style:{display:"flex",gap:10,marginTop:12,justifyContent:"flex-end"},children:q?f.jsxs(f.Fragment,{children:[f.jsx("button",{type:"button",className:"button",onClick:M,disabled:ee,children:"Retake"}),f.jsx("button",{type:"button",className:"button btn-lg",onClick:k,disabled:ee,children:ee?"Processing":"Use Photo"})]}):f.jsx(f.Fragment,{children:f.jsx("button",{type:"button",className:"button btn-lg",onClick:X,disabled:!!_||!l.current,children:"Capture"})})})]});return sN.createPortal(P,document.body)}const WV=["Isabel","Merida","Palompon","Ormoc","Matag-ob"],XV={Isabel:["Anislag","Antipolo","Apale","Bantigue","Binog","Bilwang","Can-andan","Cangag","Consolacion","Honan","Libertad","Mahayag","Marvel (Poblacion)","Matlang","Monte Alegre","Puting Bato","San Francisco","San Roque","Santa Cruz Relocation","Santo Nio (Poblacion)","Santo Rosario","Tabunok","Tolingon","Tubod"],Merida:["Benabaye","Cabaliwan","Calunangan","Calunasan","Cambalong","Can-unzo","Canbantug","Casilda","Lamanoc","Libas","Libjo","Lundag","Macario","Mahalit","Mahayag","Masumbang","Mat-e","Poblacion","Puerto Bello","San Isidro","San Jose","Tubod"],Palompon:["Baguinbin","Belen","Buenavista","Caduhaan","Cambakbak","Cambinoy","Cangcosme","Cangmuya","Canipaan","Cantandoy","Cantuhaon","Catigahan","Central 1 (Poblacion)","Central 2 (Poblacion)","Cruz","Duljugan","Guiwan 1 (Poblacion)","Guiwan 2 (Poblacion)","Himarco","Hinablayan (Poblacion)","Hinagbuan","Lat-osan","Liberty","Lomonon","Mabini","Magsaysay","Masaba","Mazawalo (Poblacion)","Parilla","Pinagdait (Poblacion Ypil I)","Pinaghi-usa (Poblacion Ypil II)","Plaridel","Rizal","Sabang","San Guillermo","San Isidro","San Joaquin","San Juan","San Miguel","San Pablo","San Pedro","San Roque","Santiago","Taberna","Tabunok","Tambis","Tinabilan","Tinago","Tinubdan","Bitaog (Poblacion Ypil III)"],Ormoc:["Airport","Alegria","Alta Vista","Bagongbong","Bagong Buhay","Bantigue","Batuan","Bayog","Biliboy","Borok","Cabaon-an","Cabintan","Cabulihan","Cagbuhangin","Camp Downes","Can-adieng","Can-untog","Catmon","Cogon Combado","Concepcion","Curva","Danhug","Dayhagan","Dolores","Domonar","Don Felipe Larrazabal","Don Potenciano Larrazabal","Doa Feliza Z. Mejia","Donghol","Esperanza","Gaas","Green Valley","Guintigui-an","Hibunawon","Hugpa","Ipil","Juaton","Kadaohan","Labrador (Balion)","Lao","Leondoni","Libertad","Liberty","Licuma","Liloan","Linao","Luna","Mabato","Mabini","Macabug","Magaswi","Mahayag","Mahayahay","Manlilinao","Margen","Mas-in","Matica-a","Milagro","Monterico","Nasunogan","Naungan","Nueva Sociedad","Nueva Vista","Patag","Punta","Quezon Jr.","Rufina M. Tan (Rawis)","Sabang Bao","Salvacion","San Antonio","San Isidro","San Jose","San Juan","San Pablo (Simangan)","San Vicente","Santo Nio","Sumangga","Tambulilid","Tongonan","Valencia","East (Poblacion)","West (Poblacion)","North (Poblacion)","South (Poblacion)"],"Matag-ob":["Balagtas","Bonoy","Bulak","Cambadbad","Candelaria","Cansoso","Imelda","Malazarte","Mansaha-on","Mansalip","Masaba","Naulayan","Riverside (Poblacion)","San Dionesio","San Guillermo (Poblacion)","San Marcelino","San Sebastian","San Vicente","Santa Rosa","Santo Rosario","Talisay (Poblacion)"]};function ZV(n){return XV[n]||[]}const{updateMember:JV,uploadMemberPhoto:aE,fetchMemberById:eL,fetchMemberByIdFresh:tL}=kt,nL=n=>{const e={};return Object.entries(n||{}).forEach(([t,s])=>e[String(t).toLowerCase()]=s),e},zt=(n,...e)=>{if(!n)return"";for(const t of e){if(n[t]!==void 0&&n[t]!==null&&n[t]!=="")return n[t];const s=String(t).toLowerCase(),a=nL(n);if(a[s]!==void 0&&a[s]!=="")return a[s];const l=s.replace(/\s+/g,"");if(a[l]!==void 0&&a[l]!=="")return a[l];const u=s.replace(/\s+/g,"_");if(a[u]!==void 0&&a[u]!=="")return a[u]}return""};function iL(n,e=`photo-${Date.now()}.jpg`){const t=n.split(","),s=t[0].match(/:(.*?);/)[1]||"image/jpeg",a=atob(t[1]);let l=a.length;const u=new Uint8Array(l);for(;l--;)u[l]=a.charCodeAt(l);return new File([u],e,{type:s})}function rL({open:n,onClose:e,member:t,onSaved:s}){const[a,l]=T.useState({lastName:"",firstName:"",middleName:"",nickName:"",gender:"",birthday:"",street:"",brgy:"",municipality:"",email:"",mobile:"",validId:"",student:!1}),[u,g]=T.useState(""),[d,p]=T.useState(""),[v,_]=T.useState(""),[S,C]=T.useState(null),O=T.useRef(null),[L,U]=T.useState(!1),[z,X]=T.useState(""),[q,ne]=T.useState(!1),[ee,de]=T.useState(""),k=T.useRef(!1),M=ZV(a.municipality),P=F=>{const $=String(F||"").match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return $&&$[1]?$[1]:""},x=F=>{const D=String(F||"");if(!D)return"";const $=D.match(/https?:\/\/[^\s}]+/);if($){const J=$[0];if(/googleusercontent\.com\//.test(J))return J;const Y=J.match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return Y&&Y[1]?`https://drive.google.com/uc?export=view&id=${Y[1]}`:J}if(/googleusercontent\.com\//.test(D))return D;const Q=P(D);return Q?`https://drive.google.com/uc?export=view&id=${Q}`:D},A=F=>{const D=String(F||"");if(/googleusercontent\.com\//.test(D))return D;const $=P(D);return $?`https://drive.google.com/thumbnail?id=${$}&sz=w1000`:D};T.useEffect(()=>{let F=!1;if(!n){k.current=!1;return}if(k.current)return;const D=t||{},$=String(zt(D,"MemberID","memberId","member_id","id")||"").trim();return g($),(async()=>{try{if($){const Q=await eL(String($).trim());if(!F&&Q){const J=zt(Q,"LastName","lastName","last_name","Last"),Y=zt(Q,"FirstName","firstName","first_name","First"),I=zt(Q,"MiddleName","middleName","middle_name"),B=zt(Q,"NickName","nickname","nick_name","Nick Name"),K=zt(Q,"Gender","gender"),le=zt(Q,"Birthday","birth_date","dob","Birth Date"),we=zt(Q,"Street","street"),Ee=zt(Q,"Brgy","Barangay","brgy","barangay"),Se=zt(Q,"Municipality","City","municipality","city"),Me=zt(Q,"Email","email"),ke=zt(Q,"Mobile","Phone","mobile","phone"),Ae=zt(Q,"ValidID","Valid Id","Valid ID","validId","valid_id"),De=String(zt(Q,"Student","student")||"").toLowerCase().startsWith("y"),ze=zt(Q,"PhotoURL","photoUrl","photo_url","photo"),G=ze?A(x(ze)):"";p(ze||""),_(G),C(null),X("");const he=String(Ee||"");l({lastName:String(J||""),firstName:String(Y||""),middleName:String(I||""),nickName:String(B||""),gender:String(K||""),birthday:le?new Date(le).toISOString().slice(0,10):"",street:String(we||""),brgy:he,municipality:String(Se||""),email:String(Me||""),mobile:String(ke||""),validId:String(Ae||""),student:De}),k.current=!0;return}}}catch{}if(!F){const Q=zt(D,"LastName","lastName","last_name","Last"),J=zt(D,"FirstName","firstName","first_name","First"),Y=zt(D,"MiddleName","middleName","middle_name"),I=zt(D,"NickName","nickname","nick_name","Nick Name"),B=zt(D,"Gender","gender"),K=zt(D,"Birthday","birth_date","dob","Birth Date"),le=zt(D,"Street","street"),we=zt(D,"Brgy","Barangay","brgy","barangay"),Ee=zt(D,"Municipality","City","municipality","city"),Se=zt(D,"Email","email"),Me=zt(D,"Mobile","Phone","mobile","phone"),ke=zt(D,"ValidID","Valid Id","Valid ID","validId","valid_id"),Ae=String(zt(D,"Student","student")||"").toLowerCase().startsWith("y"),De=zt(D,"PhotoURL","photoUrl","photo_url","photo"),ze=De?A(x(De)):"";p(De||""),_(ze),C(null),X("");const G=String(we||"");l({lastName:String(Q||""),firstName:String(J||""),middleName:String(Y||""),nickName:String(I||""),gender:String(B||""),birthday:K?new Date(K).toISOString().slice(0,10):"",street:String(le||""),brgy:G,municipality:String(Ee||""),email:String(Se||""),mobile:String(Me||""),validId:String(ke||""),student:Ae}),k.current=!0}})(),()=>{F=!0}},[n,t]);const V=F=>{const{name:D,value:$,type:Q,checked:J}=F.target;if(D==="student-select"){l(Y=>({...Y,student:String($)==="Yes"}));return}if(D==="municipality"){l(Y=>({...Y,municipality:$,brgy:""}));return}l(Y=>({...Y,[D]:Q==="checkbox"?J:$}))},N=F=>{try{const D=iL(F);O.current&&(URL.revokeObjectURL(O.current),O.current=null);const $=URL.createObjectURL(D);if(O.current=$,C(D),_($),u){const Q=String(u).trim().toLowerCase(),J=(async()=>{try{const Y=await aE(D,Q),I=typeof Y=="string"?Y:Y?.url||"";p(I||d);const B=I?A(x(I)):$;return _(B),C(null),I}catch(Y){try{X(String(Y||"Photo upload failed"))}catch{}return null}})();return Promise.resolve(J).catch(()=>null)}}catch(D){try{X(String(D||"Failed to handle capture"))}catch{}return Promise.resolve(null)}return Promise.resolve(null)};T.useEffect(()=>()=>{O.current&&(URL.revokeObjectURL(O.current),O.current=null)},[]);const fe=async F=>{try{F?.preventDefault?.()}catch{}if(!u){X("Missing MemberID");return}try{console.debug("[EditMemberModal] save() starting for",u)}catch{}const D={MemberID:u,LastName:a.lastName.trim(),FirstName:a.firstName.trim(),MiddleName:a.middleName.trim(),NickName:String(a.nickName||"").trim().toUpperCase(),Gender:a.gender,Birthday:a.birthday||"",Street:a.street.trim(),Brgy:a.brgy.trim(),Municipality:a.municipality.trim(),Email:a.email.trim(),Mobile:a.mobile.trim(),ValidID:a.validId.trim(),Student:a.student?"Yes":"No",PhotoURL:v||d||""};try{console.debug("[EditMemberModal] optimisticPayload",D)}catch{}U(!0),X("");try{let $=d||"";if(S)try{const Y=aE(S,String(u).toLowerCase()),B=await Promise.race([Y,new Promise((K,le)=>setTimeout(()=>le(new Error("photo upload timeout")),15e3))]);try{console.debug("[EditMemberModal] uploadMemberPhoto result",B)}catch{}$=typeof B=="string"?B:B?.url||$,C(null)}catch(Y){try{console.debug("[EditMemberModal] uploadMemberPhoto failed",String(Y))}catch{}X(String(Y)||"Photo upload failed  saving without photo change")}const Q={...D,PhotoURL:$};let J=null;try{try{console.debug("[EditMemberModal] sending update payload",Q)}catch{}const Y=JV(Q),I=await Promise.race([Y,new Promise((B,K)=>setTimeout(()=>K(new Error("update timeout")),2e4))]);try{console.debug("[EditMemberModal] updateMember response",I)}catch{}I&&typeof I=="object"&&(I.row&&typeof I.row=="object"?J=I.row:I.updated&&typeof I.updated=="object"?J=I.updated:I.data&&typeof I.data=="object"?J=I.data:["MemberID","memberid","LastName","FirstName"].some(K=>Object.prototype.hasOwnProperty.call(I,K))&&(J=I));try{console.debug("[EditMemberModal] authoritative after response",J)}catch{}}catch(Y){try{console.debug("[EditMemberModal] updateMember error",String(Y))}catch{}X(String(Y)||"Failed to update member"),Gn.emit("modal:error",{message:"Failed to update member",source:"EditMemberModal",error:String(Y)})}if(!J)try{try{console.debug("[EditMemberModal] fetching fresh member by id",String(u).trim())}catch{}const Y=tL(String(u).trim()),I=await Promise.race([Y,new Promise((B,K)=>setTimeout(()=>K(new Error("fetch member timeout")),15e3))]);try{console.debug("[EditMemberModal] fetchMemberByIdFresh result",I)}catch{}I&&(J=I)}catch(Y){try{console.debug("[EditMemberModal] fetchMemberByIdFresh failed",String(Y))}catch{}}J||(J=Q);try{console.debug("[EditMemberModal] final authoritative row passed to parent",J)}catch{}try{s?.(J)}catch{}try{e?.()}catch{}}catch($){Gn.emit("modal:error",{message:"Background member update failed",source:"EditMemberModal",error:String($)}),X(String($)||"Background member update failed")}finally{U(!1)}};return n?f.jsx(To,{open:n,onClose:e,title:a.nickName||"Edit Member",width:1e3,noInternalScroll:!0,children:f.jsxs("form",{onSubmit:fe,style:{width:"100%",padding:0,background:"transparent",border:"none",boxShadow:"none",overflow:"visible"},children:[ee&&f.jsx("div",{style:{position:"fixed",top:20,right:20,background:"#16a34a",color:"#fff",padding:"8px 12px",borderRadius:10,boxShadow:"0 6px 16px rgba(0,0,0,.15)",zIndex:1e4},children:ee}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"240px 1fr",gap:16},children:[f.jsxs("div",{children:[f.jsx("div",{style:{width:240,height:240,border:"1px solid var(--light-border)",borderRadius:12,background:"#fafbff",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center"},children:v?f.jsx("img",{src:v,alt:"preview",style:{width:"100%",height:"100%",objectFit:"cover"}}):f.jsx("div",{style:{color:"var(--muted)"},children:"No photo"})}),f.jsx("div",{style:{display:"flex",gap:8,marginTop:10},children:f.jsx("button",{type:"button",className:"button",onClick:()=>ne(!0),disabled:!0,title:"Camera disabled in this build",style:{flex:"1 1 auto",cursor:"not-allowed",opacity:.6},children:" Change Photo"})})]}),f.jsxs("div",{style:{display:"grid",gap:12},children:[f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 160px",gap:12,alignItems:"end"},children:[f.jsxs("label",{className:"field",style:{margin:0},children:[f.jsx("span",{className:"label",children:"Valid ID *"}),f.jsx("input",{name:"validId",value:a.validId,onChange:V,required:!0})]}),f.jsxs("label",{className:"field",style:{margin:0},children:[f.jsx("span",{className:"label",children:"Student"}),f.jsxs("select",{name:"student-select",value:a.student?"Yes":"No",onChange:V,children:[f.jsx("option",{children:"Yes"}),f.jsx("option",{children:"No"})]})]})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12},children:[f.jsxs("label",{className:"field",children:[f.jsx("span",{className:"label",children:"Last Name *"}),f.jsx("input",{name:"lastName",value:a.lastName,onChange:V,required:!0})]}),f.jsxs("label",{className:"field",children:[f.jsx("span",{className:"label",children:"First Name *"}),f.jsx("input",{name:"firstName",value:a.firstName,onChange:V,required:!0})]}),f.jsxs("label",{className:"field",children:[f.jsx("span",{className:"label",children:"Middle Name"}),f.jsx("input",{name:"middleName",value:a.middleName,onChange:V})]})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[f.jsxs("label",{className:"field",children:[f.jsx("span",{className:"label",children:"Birthday *"}),f.jsx("input",{type:"date",name:"birthday",value:a.birthday,onChange:V,required:!0})]}),f.jsxs("label",{className:"field",children:[f.jsx("span",{className:"label",children:"Gender *"}),f.jsxs("select",{name:"gender",value:a.gender,onChange:V,required:!0,children:[f.jsx("option",{value:"",children:" Select "}),f.jsx("option",{children:"Male"}),f.jsx("option",{children:"Female"})]})]})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[f.jsxs("label",{className:"field",children:[f.jsx("span",{className:"label",children:"Mobile No. *"}),f.jsx("input",{name:"mobile",value:a.mobile,onChange:V,placeholder:"09XXXXXXXXX",required:!0})]}),f.jsxs("label",{className:"field",children:[f.jsx("span",{className:"label",children:"Email Address"}),f.jsx("input",{name:"email",value:a.email,onChange:V,placeholder:"name@example.com"})]})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 2fr",gap:12},children:[f.jsxs("label",{className:"field",children:[f.jsx("span",{className:"label",children:"Municipality / City"}),f.jsxs("select",{name:"municipality",value:a.municipality,onChange:V,children:[f.jsx("option",{value:""}),WV.map(F=>f.jsx("option",{value:F,children:F},F))]})]}),f.jsxs("label",{className:"field",children:[f.jsx("span",{className:"label",children:"Brgy."}),f.jsxs("select",{name:"brgy",value:a.brgy,onChange:V,disabled:!a.municipality,children:[f.jsx("option",{value:""}),M.map(F=>f.jsx("option",{value:F,children:F},F))]})]}),f.jsxs("label",{className:"field",children:[f.jsx("span",{className:"label",children:"House No. / Street Name / Sitio"}),f.jsx("input",{name:"street",value:a.street,onChange:V})]})]}),z&&f.jsx("div",{style:{color:"#d33",fontSize:15,marginTop:8,fontWeight:600},children:z})]})]}),f.jsxs("div",{style:{marginTop:12,display:"flex",gap:10,justifyContent:"flex-end"},children:[f.jsx("button",{type:"button",className:"back-btn",onClick:e,style:{background:"#e5e7eb",color:"#111",fontWeight:700},children:"Cancel"}),f.jsx("button",{type:"button",className:"primary-btn",disabled:L,onClick:fe,children:" Save Changes"})]}),f.jsx(KV,{open:q,onClose:()=>ne(!1),onCapture:N})]})}):null}var sL=Object.defineProperty,hf=Object.getOwnPropertySymbols,SC=Object.prototype.hasOwnProperty,wC=Object.prototype.propertyIsEnumerable,oE=(n,e,t)=>e in n?sL(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ry=(n,e)=>{for(var t in e||(e={}))SC.call(e,t)&&oE(n,t,e[t]);if(hf)for(var t of hf(e))wC.call(e,t)&&oE(n,t,e[t]);return n},sy=(n,e)=>{var t={};for(var s in n)SC.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&hf)for(var s of hf(n))e.indexOf(s)<0&&wC.call(n,s)&&(t[s]=n[s]);return t};var vo;(n=>{const e=class ft{constructor(d,p,v,_){if(this.version=d,this.errorCorrectionLevel=p,this.modules=[],this.isFunction=[],d<ft.MIN_VERSION||d>ft.MAX_VERSION)throw new RangeError("Version value out of range");if(_<-1||_>7)throw new RangeError("Mask value out of range");this.size=d*4+17;let S=[];for(let O=0;O<this.size;O++)S.push(!1);for(let O=0;O<this.size;O++)this.modules.push(S.slice()),this.isFunction.push(S.slice());this.drawFunctionPatterns();const C=this.addEccAndInterleave(v);if(this.drawCodewords(C),_==-1){let O=1e9;for(let L=0;L<8;L++){this.applyMask(L),this.drawFormatBits(L);const U=this.getPenaltyScore();U<O&&(_=L,O=U),this.applyMask(L)}}a(0<=_&&_<=7),this.mask=_,this.applyMask(_),this.drawFormatBits(_),this.isFunction=[]}static encodeText(d,p){const v=n.QrSegment.makeSegments(d);return ft.encodeSegments(v,p)}static encodeBinary(d,p){const v=n.QrSegment.makeBytes(d);return ft.encodeSegments([v],p)}static encodeSegments(d,p,v=1,_=40,S=-1,C=!0){if(!(ft.MIN_VERSION<=v&&v<=_&&_<=ft.MAX_VERSION)||S<-1||S>7)throw new RangeError("Invalid value");let O,L;for(O=v;;O++){const q=ft.getNumDataCodewords(O,p)*8,ne=u.getTotalBits(d,O);if(ne<=q){L=ne;break}if(O>=_)throw new RangeError("Data too long")}for(const q of[ft.Ecc.MEDIUM,ft.Ecc.QUARTILE,ft.Ecc.HIGH])C&&L<=ft.getNumDataCodewords(O,q)*8&&(p=q);let U=[];for(const q of d){t(q.mode.modeBits,4,U),t(q.numChars,q.mode.numCharCountBits(O),U);for(const ne of q.getData())U.push(ne)}a(U.length==L);const z=ft.getNumDataCodewords(O,p)*8;a(U.length<=z),t(0,Math.min(4,z-U.length),U),t(0,(8-U.length%8)%8,U),a(U.length%8==0);for(let q=236;U.length<z;q^=253)t(q,8,U);let X=[];for(;X.length*8<U.length;)X.push(0);return U.forEach((q,ne)=>X[ne>>>3]|=q<<7-(ne&7)),new ft(O,p,X,S)}getModule(d,p){return 0<=d&&d<this.size&&0<=p&&p<this.size&&this.modules[p][d]}getModules(){return this.modules}drawFunctionPatterns(){for(let v=0;v<this.size;v++)this.setFunctionModule(6,v,v%2==0),this.setFunctionModule(v,6,v%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const d=this.getAlignmentPatternPositions(),p=d.length;for(let v=0;v<p;v++)for(let _=0;_<p;_++)v==0&&_==0||v==0&&_==p-1||v==p-1&&_==0||this.drawAlignmentPattern(d[v],d[_]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(d){const p=this.errorCorrectionLevel.formatBits<<3|d;let v=p;for(let S=0;S<10;S++)v=v<<1^(v>>>9)*1335;const _=(p<<10|v)^21522;a(_>>>15==0);for(let S=0;S<=5;S++)this.setFunctionModule(8,S,s(_,S));this.setFunctionModule(8,7,s(_,6)),this.setFunctionModule(8,8,s(_,7)),this.setFunctionModule(7,8,s(_,8));for(let S=9;S<15;S++)this.setFunctionModule(14-S,8,s(_,S));for(let S=0;S<8;S++)this.setFunctionModule(this.size-1-S,8,s(_,S));for(let S=8;S<15;S++)this.setFunctionModule(8,this.size-15+S,s(_,S));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let d=this.version;for(let v=0;v<12;v++)d=d<<1^(d>>>11)*7973;const p=this.version<<12|d;a(p>>>18==0);for(let v=0;v<18;v++){const _=s(p,v),S=this.size-11+v%3,C=Math.floor(v/3);this.setFunctionModule(S,C,_),this.setFunctionModule(C,S,_)}}drawFinderPattern(d,p){for(let v=-4;v<=4;v++)for(let _=-4;_<=4;_++){const S=Math.max(Math.abs(_),Math.abs(v)),C=d+_,O=p+v;0<=C&&C<this.size&&0<=O&&O<this.size&&this.setFunctionModule(C,O,S!=2&&S!=4)}}drawAlignmentPattern(d,p){for(let v=-2;v<=2;v++)for(let _=-2;_<=2;_++)this.setFunctionModule(d+_,p+v,Math.max(Math.abs(_),Math.abs(v))!=1)}setFunctionModule(d,p,v){this.modules[p][d]=v,this.isFunction[p][d]=!0}addEccAndInterleave(d){const p=this.version,v=this.errorCorrectionLevel;if(d.length!=ft.getNumDataCodewords(p,v))throw new RangeError("Invalid argument");const _=ft.NUM_ERROR_CORRECTION_BLOCKS[v.ordinal][p],S=ft.ECC_CODEWORDS_PER_BLOCK[v.ordinal][p],C=Math.floor(ft.getNumRawDataModules(p)/8),O=_-C%_,L=Math.floor(C/_);let U=[];const z=ft.reedSolomonComputeDivisor(S);for(let q=0,ne=0;q<_;q++){let ee=d.slice(ne,ne+L-S+(q<O?0:1));ne+=ee.length;const de=ft.reedSolomonComputeRemainder(ee,z);q<O&&ee.push(0),U.push(ee.concat(de))}let X=[];for(let q=0;q<U[0].length;q++)U.forEach((ne,ee)=>{(q!=L-S||ee>=O)&&X.push(ne[q])});return a(X.length==C),X}drawCodewords(d){if(d.length!=Math.floor(ft.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let p=0;for(let v=this.size-1;v>=1;v-=2){v==6&&(v=5);for(let _=0;_<this.size;_++)for(let S=0;S<2;S++){const C=v-S,L=(v+1&2)==0?this.size-1-_:_;!this.isFunction[L][C]&&p<d.length*8&&(this.modules[L][C]=s(d[p>>>3],7-(p&7)),p++)}}a(p==d.length*8)}applyMask(d){if(d<0||d>7)throw new RangeError("Mask value out of range");for(let p=0;p<this.size;p++)for(let v=0;v<this.size;v++){let _;switch(d){case 0:_=(v+p)%2==0;break;case 1:_=p%2==0;break;case 2:_=v%3==0;break;case 3:_=(v+p)%3==0;break;case 4:_=(Math.floor(v/3)+Math.floor(p/2))%2==0;break;case 5:_=v*p%2+v*p%3==0;break;case 6:_=(v*p%2+v*p%3)%2==0;break;case 7:_=((v+p)%2+v*p%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[p][v]&&_&&(this.modules[p][v]=!this.modules[p][v])}}getPenaltyScore(){let d=0;for(let S=0;S<this.size;S++){let C=!1,O=0,L=[0,0,0,0,0,0,0];for(let U=0;U<this.size;U++)this.modules[S][U]==C?(O++,O==5?d+=ft.PENALTY_N1:O>5&&d++):(this.finderPenaltyAddHistory(O,L),C||(d+=this.finderPenaltyCountPatterns(L)*ft.PENALTY_N3),C=this.modules[S][U],O=1);d+=this.finderPenaltyTerminateAndCount(C,O,L)*ft.PENALTY_N3}for(let S=0;S<this.size;S++){let C=!1,O=0,L=[0,0,0,0,0,0,0];for(let U=0;U<this.size;U++)this.modules[U][S]==C?(O++,O==5?d+=ft.PENALTY_N1:O>5&&d++):(this.finderPenaltyAddHistory(O,L),C||(d+=this.finderPenaltyCountPatterns(L)*ft.PENALTY_N3),C=this.modules[U][S],O=1);d+=this.finderPenaltyTerminateAndCount(C,O,L)*ft.PENALTY_N3}for(let S=0;S<this.size-1;S++)for(let C=0;C<this.size-1;C++){const O=this.modules[S][C];O==this.modules[S][C+1]&&O==this.modules[S+1][C]&&O==this.modules[S+1][C+1]&&(d+=ft.PENALTY_N2)}let p=0;for(const S of this.modules)p=S.reduce((C,O)=>C+(O?1:0),p);const v=this.size*this.size,_=Math.ceil(Math.abs(p*20-v*10)/v)-1;return a(0<=_&&_<=9),d+=_*ft.PENALTY_N4,a(0<=d&&d<=2568888),d}getAlignmentPatternPositions(){if(this.version==1)return[];{const d=Math.floor(this.version/7)+2,p=this.version==32?26:Math.ceil((this.version*4+4)/(d*2-2))*2;let v=[6];for(let _=this.size-7;v.length<d;_-=p)v.splice(1,0,_);return v}}static getNumRawDataModules(d){if(d<ft.MIN_VERSION||d>ft.MAX_VERSION)throw new RangeError("Version number out of range");let p=(16*d+128)*d+64;if(d>=2){const v=Math.floor(d/7)+2;p-=(25*v-10)*v-55,d>=7&&(p-=36)}return a(208<=p&&p<=29648),p}static getNumDataCodewords(d,p){return Math.floor(ft.getNumRawDataModules(d)/8)-ft.ECC_CODEWORDS_PER_BLOCK[p.ordinal][d]*ft.NUM_ERROR_CORRECTION_BLOCKS[p.ordinal][d]}static reedSolomonComputeDivisor(d){if(d<1||d>255)throw new RangeError("Degree out of range");let p=[];for(let _=0;_<d-1;_++)p.push(0);p.push(1);let v=1;for(let _=0;_<d;_++){for(let S=0;S<p.length;S++)p[S]=ft.reedSolomonMultiply(p[S],v),S+1<p.length&&(p[S]^=p[S+1]);v=ft.reedSolomonMultiply(v,2)}return p}static reedSolomonComputeRemainder(d,p){let v=p.map(_=>0);for(const _ of d){const S=_^v.shift();v.push(0),p.forEach((C,O)=>v[O]^=ft.reedSolomonMultiply(C,S))}return v}static reedSolomonMultiply(d,p){if(d>>>8||p>>>8)throw new RangeError("Byte out of range");let v=0;for(let _=7;_>=0;_--)v=v<<1^(v>>>7)*285,v^=(p>>>_&1)*d;return a(v>>>8==0),v}finderPenaltyCountPatterns(d){const p=d[1];a(p<=this.size*3);const v=p>0&&d[2]==p&&d[3]==p*3&&d[4]==p&&d[5]==p;return(v&&d[0]>=p*4&&d[6]>=p?1:0)+(v&&d[6]>=p*4&&d[0]>=p?1:0)}finderPenaltyTerminateAndCount(d,p,v){return d&&(this.finderPenaltyAddHistory(p,v),p=0),p+=this.size,this.finderPenaltyAddHistory(p,v),this.finderPenaltyCountPatterns(v)}finderPenaltyAddHistory(d,p){p[0]==0&&(d+=this.size),p.pop(),p.unshift(d)}};e.MIN_VERSION=1,e.MAX_VERSION=40,e.PENALTY_N1=3,e.PENALTY_N2=3,e.PENALTY_N3=40,e.PENALTY_N4=10,e.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],e.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],n.QrCode=e;function t(g,d,p){if(d<0||d>31||g>>>d)throw new RangeError("Value out of range");for(let v=d-1;v>=0;v--)p.push(g>>>v&1)}function s(g,d){return(g>>>d&1)!=0}function a(g){if(!g)throw new Error("Assertion error")}const l=class fn{constructor(d,p,v){if(this.mode=d,this.numChars=p,this.bitData=v,p<0)throw new RangeError("Invalid argument");this.bitData=v.slice()}static makeBytes(d){let p=[];for(const v of d)t(v,8,p);return new fn(fn.Mode.BYTE,d.length,p)}static makeNumeric(d){if(!fn.isNumeric(d))throw new RangeError("String contains non-numeric characters");let p=[];for(let v=0;v<d.length;){const _=Math.min(d.length-v,3);t(parseInt(d.substring(v,v+_),10),_*3+1,p),v+=_}return new fn(fn.Mode.NUMERIC,d.length,p)}static makeAlphanumeric(d){if(!fn.isAlphanumeric(d))throw new RangeError("String contains unencodable characters in alphanumeric mode");let p=[],v;for(v=0;v+2<=d.length;v+=2){let _=fn.ALPHANUMERIC_CHARSET.indexOf(d.charAt(v))*45;_+=fn.ALPHANUMERIC_CHARSET.indexOf(d.charAt(v+1)),t(_,11,p)}return v<d.length&&t(fn.ALPHANUMERIC_CHARSET.indexOf(d.charAt(v)),6,p),new fn(fn.Mode.ALPHANUMERIC,d.length,p)}static makeSegments(d){return d==""?[]:fn.isNumeric(d)?[fn.makeNumeric(d)]:fn.isAlphanumeric(d)?[fn.makeAlphanumeric(d)]:[fn.makeBytes(fn.toUtf8ByteArray(d))]}static makeEci(d){let p=[];if(d<0)throw new RangeError("ECI assignment value out of range");if(d<128)t(d,8,p);else if(d<16384)t(2,2,p),t(d,14,p);else if(d<1e6)t(6,3,p),t(d,21,p);else throw new RangeError("ECI assignment value out of range");return new fn(fn.Mode.ECI,0,p)}static isNumeric(d){return fn.NUMERIC_REGEX.test(d)}static isAlphanumeric(d){return fn.ALPHANUMERIC_REGEX.test(d)}getData(){return this.bitData.slice()}static getTotalBits(d,p){let v=0;for(const _ of d){const S=_.mode.numCharCountBits(p);if(_.numChars>=1<<S)return 1/0;v+=4+S+_.bitData.length}return v}static toUtf8ByteArray(d){d=encodeURI(d);let p=[];for(let v=0;v<d.length;v++)d.charAt(v)!="%"?p.push(d.charCodeAt(v)):(p.push(parseInt(d.substring(v+1,v+3),16)),v+=2);return p}};l.NUMERIC_REGEX=/^[0-9]*$/,l.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,l.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let u=l;n.QrSegment=l})(vo||(vo={}));(n=>{(e=>{const t=class{constructor(a,l){this.ordinal=a,this.formatBits=l}};t.LOW=new t(0,1),t.MEDIUM=new t(1,0),t.QUARTILE=new t(2,3),t.HIGH=new t(3,2),e.Ecc=t})(n.QrCode||(n.QrCode={}))})(vo||(vo={}));(n=>{(e=>{const t=class{constructor(a,l){this.modeBits=a,this.numBitsCharCount=l}numCharCountBits(a){return this.numBitsCharCount[Math.floor((a+7)/17)]}};t.NUMERIC=new t(1,[10,12,14]),t.ALPHANUMERIC=new t(2,[9,11,13]),t.BYTE=new t(4,[8,16,16]),t.KANJI=new t(8,[8,10,12]),t.ECI=new t(7,[0,0,0]),e.Mode=t})(n.QrSegment||(n.QrSegment={}))})(vo||(vo={}));var bl=vo;var aL={L:bl.QrCode.Ecc.LOW,M:bl.QrCode.Ecc.MEDIUM,Q:bl.QrCode.Ecc.QUARTILE,H:bl.QrCode.Ecc.HIGH},EC=128,TC="L",AC="#FFFFFF",CC="#000000",xC=!1,RC=1,oL=4,lL=0,cL=.1;function IC(n,e=0){const t=[];return n.forEach(function(s,a){let l=null;s.forEach(function(u,g){if(!u&&l!==null){t.push(`M${l+e} ${a+e}h${g-l}v1H${l+e}z`),l=null;return}if(g===s.length-1){if(!u)return;l===null?t.push(`M${g+e},${a+e} h1v1H${g+e}z`):t.push(`M${l+e},${a+e} h${g+1-l}v1H${l+e}z`);return}u&&l===null&&(l=g)})}),t.join("")}function NC(n,e){return n.slice().map((t,s)=>s<e.y||s>=e.y+e.h?t:t.map((a,l)=>l<e.x||l>=e.x+e.w?a:!1))}function uL(n,e,t,s){if(s==null)return null;const a=n.length+t*2,l=Math.floor(e*cL),u=a/e,g=(s.width||l)*u,d=(s.height||l)*u,p=s.x==null?n.length/2-g/2:s.x*u,v=s.y==null?n.length/2-d/2:s.y*u,_=s.opacity==null?1:s.opacity;let S=null;if(s.excavate){let O=Math.floor(p),L=Math.floor(v),U=Math.ceil(g+p-O),z=Math.ceil(d+v-L);S={x:O,y:L,w:U,h:z}}const C=s.crossOrigin;return{x:p,y:v,h:d,w:g,excavation:S,opacity:_,crossOrigin:C}}function hL(n,e){return e!=null?Math.max(Math.floor(e),0):n?oL:lL}function DC({value:n,level:e,minVersion:t,includeMargin:s,marginSize:a,imageSettings:l,size:u,boostLevel:g}){let d=Ct.useMemo(()=>{const O=(Array.isArray(n)?n:[n]).reduce((L,U)=>(L.push(...bl.QrSegment.makeSegments(U)),L),[]);return bl.QrCode.encodeSegments(O,aL[e],t,void 0,void 0,g)},[n,e,t,g]);const{cells:p,margin:v,numCells:_,calculatedImageSettings:S}=Ct.useMemo(()=>{let C=d.getModules();const O=hL(s,a),L=C.length+O*2,U=uL(C,u,O,l);return{cells:C,margin:O,numCells:L,calculatedImageSettings:U}},[d,u,l,s,a]);return{qrcode:d,margin:v,cells:p,numCells:_,calculatedImageSettings:S}}var dL=(function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})(),fL=Ct.forwardRef(function(e,t){const s=e,{value:a,size:l=EC,level:u=TC,bgColor:g=AC,fgColor:d=CC,includeMargin:p=xC,minVersion:v=RC,boostLevel:_,marginSize:S,imageSettings:C}=s,L=sy(s,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:U}=L,z=sy(L,["style"]),X=C?.src,q=Ct.useRef(null),ne=Ct.useRef(null),ee=Ct.useCallback(fe=>{q.current=fe,typeof t=="function"?t(fe):t&&(t.current=fe)},[t]),[de,k]=Ct.useState(!1),{margin:M,cells:P,numCells:x,calculatedImageSettings:A}=DC({value:a,level:u,minVersion:v,boostLevel:_,includeMargin:p,marginSize:S,imageSettings:C,size:l});Ct.useEffect(()=>{if(q.current!=null){const fe=q.current,F=fe.getContext("2d");if(!F)return;let D=P;const $=ne.current,Q=A!=null&&$!==null&&$.complete&&$.naturalHeight!==0&&$.naturalWidth!==0;Q&&A.excavation!=null&&(D=NC(P,A.excavation));const J=window.devicePixelRatio||1;fe.height=fe.width=l*J;const Y=l/x*J;F.scale(Y,Y),F.fillStyle=g,F.fillRect(0,0,x,x),F.fillStyle=d,dL?F.fill(new Path2D(IC(D,M))):P.forEach(function(I,B){I.forEach(function(K,le){K&&F.fillRect(le+M,B+M,1,1)})}),A&&(F.globalAlpha=A.opacity),Q&&F.drawImage($,A.x+M,A.y+M,A.w,A.h)}}),Ct.useEffect(()=>{k(!1)},[X]);const V=ry({height:l,width:l},U);let N=null;return X!=null&&(N=Ct.createElement("img",{src:X,key:X,style:{display:"none"},onLoad:()=>{k(!0)},ref:ne,crossOrigin:A?.crossOrigin})),Ct.createElement(Ct.Fragment,null,Ct.createElement("canvas",ry({style:V,height:l,width:l,ref:ee,role:"img"},z)),N)});fL.displayName="QRCodeCanvas";var MC=Ct.forwardRef(function(e,t){const s=e,{value:a,size:l=EC,level:u=TC,bgColor:g=AC,fgColor:d=CC,includeMargin:p=xC,minVersion:v=RC,boostLevel:_,title:S,marginSize:C,imageSettings:O}=s,L=sy(s,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:U,cells:z,numCells:X,calculatedImageSettings:q}=DC({value:a,level:u,minVersion:v,boostLevel:_,includeMargin:p,marginSize:C,imageSettings:O,size:l});let ne=z,ee=null;O!=null&&q!=null&&(q.excavation!=null&&(ne=NC(z,q.excavation)),ee=Ct.createElement("image",{href:O.src,height:q.h,width:q.w,x:q.x+U,y:q.y+U,preserveAspectRatio:"none",opacity:q.opacity,crossOrigin:q.crossOrigin}));const de=IC(ne,U);return Ct.createElement("svg",ry({height:l,width:l,viewBox:`0 0 ${X} ${X}`,ref:t,role:"img"},L),!!S&&Ct.createElement("title",null,S),Ct.createElement("path",{fill:g,d:`M0,0 h${X}v${X}H0z`,shapeRendering:"crispEdges"}),Ct.createElement("path",{fill:d,d:de,shapeRendering:"crispEdges"}),ee)});MC.displayName="QRCodeSVG";function mL({open:n,onClose:e,memberId:t="",nickname:s="",firstName:a="",lastName:l=""}){if(T.useEffect(()=>{if(!n)return;function d(p){p.key==="Escape"&&e&&e()}return window.addEventListener("keydown",d),()=>window.removeEventListener("keydown",d)},[n,e]),!n)return null;const u=s||a||l||"Member",g=String(t||u);return f.jsx("div",{onClick:d=>{d.target===d.currentTarget&&e&&e()},style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:f.jsxs("div",{style:{width:"min(98vw, 820px)",boxSizing:"border-box",padding:20,background:"#fff",borderRadius:14,border:"1px solid var(--light-border)",boxShadow:"0 20px 60px rgba(0,0,0,.2)",overflow:"visible"},onClick:d=>d.stopPropagation(),children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12},children:[f.jsx("div",{style:{fontWeight:800,fontSize:18}}),f.jsx("button",{type:"button",className:"button",onClick:e,style:{background:"#eee",color:"#333"},children:""})]}),f.jsx("div",{style:{display:"flex",justifyContent:"center"},children:f.jsx("div",{style:{width:520,maxWidth:"78vw",aspectRatio:"1 / 1",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:f.jsxs("div",{style:{width:"100%",height:"100%",borderRadius:10,border:"6px solid var(--kusgan-magenta, #c51c8a)",boxSizing:"border-box",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative",background:"#fff"},children:[f.jsx("div",{style:{position:"absolute",top:10,left:"50%",transform:"translateX(-50%)",fontSize:16,color:"var(--kusgan-magenta, #c51c8a)",fontWeight:700},children:"kusgan"}),f.jsx("div",{style:{width:"72%",height:"72%",display:"flex",alignItems:"center",justifyContent:"center"},children:f.jsx(MC,{value:g,size:Math.min(700,Math.floor(window.innerWidth*.7))})}),f.jsx("div",{style:{position:"absolute",bottom:10,left:"50%",transform:"translateX(-50%)",fontSize:16,color:"#333",fontWeight:600},children:u})]})})})]})})}const{addProgressRow:gL,uploadMemberPhoto:pL}=kt,OC="Asia/Manila",yL=()=>new Intl.DateTimeFormat("en-CA",{timeZone:OC,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date),vL=n=>{if(!n)return"-";let e;if(typeof n=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(n)){const[u,g,d]=n.split("-").map(Number);e=new Date(Date.UTC(u,g-1,d))}else e=n instanceof Date?n:new Date(n);if(isNaN(e))return"-";const t=new Intl.DateTimeFormat("en-US",{timeZone:OC,month:"short",day:"numeric",year:"numeric"}).formatToParts(e),s=t.find(u=>u.type==="month")?.value||"",a=t.find(u=>u.type==="day")?.value||"",l=t.find(u=>u.type==="year")?.value||"";return`${s}-${a}, ${l}`};function _L(n,e){if(!n||!e)return 1;const[t,s,a]=n.split("-").map(Number),[l,u,g]=e.split("-").map(Number),d=Date.UTC(t,s-1,a),p=Date.UTC(l,u-1,g),v=Math.floor((p-d)/864e5);return Math.max(1,v+1)}function bL({open:n,onClose:e,memberId:t,memberSinceYMD:s,onSaved:a,memberNick:l}){const u=yL(),g=T.useMemo(()=>_L(s,u),[s,u]),[d,p]=T.useState(""),[v,_]=T.useState(""),[S,C]=T.useState(""),[O,L]=T.useState(""),[U,z]=T.useState(""),[X,q]=T.useState(""),[ne,ee]=T.useState(""),[de,k]=T.useState(""),[M,P]=T.useState(""),[x,A]=T.useState(""),[V,N]=T.useState(""),[fe,F]=T.useState(""),[D,$]=T.useState(""),[Q,J]=T.useState(""),[Y,I]=T.useState(""),[B,K]=T.useState(""),[le,we]=T.useState([]),Ee=Ct.useRef(null),[Se,Me]=T.useState(-1),[ke,Ae]=T.useState(""),[De,ze]=T.useState(!1),G=T.useMemo(()=>{const be=Number(d)||0,Ce=(Number(v)||0)/100;return!be||!Ce?0:Math.round(be/(Ce*Ce)*10)/10},[d,v]);T.useMemo(()=>Math.round((Number(d)||0)*2.20462262185*10)/10,[d]),T.useMemo(()=>Math.round((Number(v)||0)/2.54*10)/10,[v]),T.useEffect(()=>{n&&(p(""),_(""),C(""),L(""),z(""),q(""),ee(""),k(""),P(""),A(""),N(""),F(""),$(""),J(""),I(""),K(""),we([]),Me(-1),ze(!1))},[n]);const he=async be=>{if(be)try{const Ce=String(t||"").toLowerCase(),ae=await pL(be,Ce),Ne=typeof ae=="string"?ae:ae?.url||"";we(We=>{const St=Array.isArray(We)?[...We]:[];for(;St.length<3;)St.push("");const tn=Se>=0&&Se<3?Se:St.findIndex(xt=>!xt);return tn===-1||(St[tn]=Ne),St})}catch(Ce){const ae=Ce?.message||"Failed to upload photo";Ae(ae);try{Gn.emit("modal:error",{message:ae,source:"ProgressModal",error:String(Ce)})}catch{}}finally{Me(-1)}},oe=be=>{we(Ce=>{const ae=Array.isArray(Ce)?[...Ce]:[];if(be<0||be>=3)return ae;if(ae.length<3)for(;ae.length<3;)ae.push("");return ae[be]="",ae})},Te=async be=>{if(be?.preventDefault?.(),!t||De)return;ze(!0),Ae("");const Ce={MemberID:t,Date:u,No:`Day ${g}`,"Weight (kg)":d?String(d):"","Weight(kg)":d?String(d):"",WeightKg:d?String(d):"",Weight:d?String(d):"",BMI:G?String(G):"",MuscleMass:S?String(S):"",BodyFat:O?String(O):"",VisceralFat:U?String(U):"",Photo1URL:le[0]||"",Photo2URL:le[1]||"",Photo3URL:le[2]||"","Height (cm)":v?String(v):"","Height(cm)":v?String(v):"",HeightCm:v?String(v):"",Height:v?String(v):"",Chest:X?String(X):"",Waist:ne?String(ne):"",Hips:de?String(de):"",Shoulders:M?String(M):"",Arms:x?String(x):"",Forearms:V?String(V):"",Thighs:fe?String(fe):"",Calves:D?String(D):"",BloodPressure:Q,"RestingHeart Rate":Y,Comments:B};try{await gL(Ce),a?.(),e?.()}catch(ae){const Ne=ae?.message||"Failed to save progress entry";Ae(Ne);try{Gn.emit("modal:error",{message:Ne,source:"ProgressModal",error:String(ae)})}catch{}}finally{ze(!1)}};return n?f.jsxs(To,{open:n,onClose:e,title:"Progress Entry",width:1e3,children:[ke&&f.jsx("div",{className:"small-error",style:{marginBottom:8},children:ke}),f.jsxs("form",{onSubmit:Te,style:{width:"100%",padding:0,background:"transparent",border:"none",boxShadow:"none",overflow:"visible"},children:[f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12,marginBottom:12},children:[f.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[f.jsx("div",{style:{fontSize:14,fontStyle:"italic",color:"var(--muted)",display:"block",marginBottom:4},children:"Nickname"}),f.jsx("div",{style:{fontWeight:700,fontSize:18},children:l||t})]}),f.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[f.jsx("div",{style:{fontSize:14,fontStyle:"italic",color:"var(--muted)",display:"block",marginBottom:4},children:"Date"}),f.jsx("div",{style:{fontWeight:700,fontSize:18},children:vL(u)})]}),f.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[f.jsx("div",{style:{fontSize:14,fontStyle:"italic",color:"var(--muted)",display:"block",marginBottom:4},children:"No."}),f.jsx("div",{style:{fontWeight:700,fontSize:18},children:`Day ${g}`})]})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:12},children:[f.jsxs("label",{className:"field",children:[f.jsx("span",{className:"label",children:"Weight (kg)"}),f.jsx("input",{type:"number",step:"0.1",min:"0",value:d,onChange:be=>p(be.target.value)})]}),f.jsxs("label",{className:"field",children:[f.jsx("span",{className:"label",children:"Height (cm)"}),f.jsx("input",{type:"number",step:"0.1",min:"0",value:v,onChange:be=>_(be.target.value)})]}),f.jsxs("div",{className:"field",children:[f.jsx("span",{className:"label",children:"BMI"}),f.jsx("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10,fontWeight:700},children:G||"-"})]}),f.jsxs("label",{className:"field",children:[f.jsx("span",{className:"label",children:"Muscle Mass"}),f.jsx("input",{type:"number",step:"0.1",min:"0",value:S,onChange:be=>C(be.target.value)})]}),f.jsxs("label",{className:"field",children:[f.jsx("span",{className:"label",children:"Body Fat (%)"}),f.jsx("input",{type:"number",step:"0.1",min:"0",value:O,onChange:be=>L(be.target.value)})]}),f.jsxs("label",{className:"field",children:[f.jsx("span",{className:"label",children:"Visceral Fat"}),f.jsx("input",{type:"number",step:"0.1",min:"0",value:U,onChange:be=>z(be.target.value)})]}),f.jsxs("label",{className:"field",children:[f.jsx("span",{className:"label",children:"Chest (cm)"}),f.jsx("input",{type:"number",step:"0.1",min:"0",value:X,onChange:be=>q(be.target.value)})]}),f.jsxs("label",{className:"field",children:[f.jsx("span",{className:"label",children:"Waist (cm)"}),f.jsx("input",{type:"number",step:"0.1",min:"0",value:ne,onChange:be=>ee(be.target.value)})]}),f.jsxs("label",{className:"field",children:[f.jsx("span",{className:"label",children:"Hips (cm)"}),f.jsx("input",{type:"number",step:"0.1",min:"0",value:de,onChange:be=>k(be.target.value)})]}),f.jsxs("label",{className:"field",children:[f.jsx("span",{className:"label",children:"Shoulders (cm)"}),f.jsx("input",{type:"number",step:"0.1",min:"0",value:M,onChange:be=>P(be.target.value)})]}),f.jsxs("label",{className:"field",children:[f.jsx("span",{className:"label",children:"Arms (cm)"}),f.jsx("input",{type:"number",step:"0.1",min:"0",value:x,onChange:be=>A(be.target.value)})]}),f.jsxs("label",{className:"field",children:[f.jsx("span",{className:"label",children:"Forearms (cm)"}),f.jsx("input",{type:"number",step:"0.1",min:"0",value:V,onChange:be=>N(be.target.value)})]}),f.jsxs("label",{className:"field",children:[f.jsx("span",{className:"label",children:"Thighs (cm)"}),f.jsx("input",{type:"number",step:"0.1",min:"0",value:fe,onChange:be=>F(be.target.value)})]}),f.jsxs("label",{className:"field",children:[f.jsx("span",{className:"label",children:"Calves (cm)"}),f.jsx("input",{type:"number",step:"0.1",min:"0",value:D,onChange:be=>$(be.target.value)})]}),f.jsxs("label",{className:"field",children:[f.jsx("span",{className:"label",children:"Blood Pressure"}),f.jsx("input",{placeholder:"120/80",value:Q,onChange:be=>J(be.target.value)})]}),f.jsxs("label",{className:"field",children:[f.jsx("span",{className:"label",children:"Resting Heart Rate"}),f.jsx("input",{type:"number",step:"1",min:"0",value:Y,onChange:be=>I(be.target.value)})]}),f.jsx("div",{})]}),f.jsxs("div",{style:{marginTop:12},children:[f.jsx("div",{className:"label",style:{marginBottom:6},children:"Photos (max 3)"}),f.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:12},children:[0,1,2].map(be=>{const Ce=le[be]||"";return f.jsxs("div",{style:{position:"relative"},children:[f.jsx("div",{onClick:()=>{},style:{position:"relative",width:"100%",height:0,paddingTop:"133.333%",borderRadius:8,border:Ce?"1px solid #e5e7eb":"1px dashed #e5e7eb",cursor:"default",overflow:"hidden",background:Ce?"#fff":"#fafafa",opacity:.65},children:Ce?f.jsx("img",{src:Ce,alt:`Photo ${be+1}`,style:{position:"absolute",inset:0,width:"100%",height:"100%",objectFit:"cover"}}):f.jsx("div",{style:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",color:"#999"},children:"Photo disabled"})}),Ce&&f.jsx("button",{type:"button","aria-label":"Remove",onClick:()=>oe(be),style:{position:"absolute",top:6,right:6,background:"rgba(0,0,0,.55)",color:"#fff",borderRadius:6,padding:"4px 6px",border:0},children:""})]},be)})})]}),f.jsx("input",{ref:Ee,type:"file",accept:"image/*",style:{display:"none"},onChange:be=>{const Ce=be.target.files?.[0];Ce&&he(Ce)}}),f.jsxs("div",{className:"field",style:{marginTop:12},children:[f.jsx("span",{className:"label",children:"Comments"}),f.jsx("textarea",{rows:4,value:B,onChange:be=>K(be.target.value),style:{width:"100%",borderRadius:8,border:"1px solid #e5e7eb",padding:12,fontFamily:"inherit",resize:"vertical",fontSize:16}})]}),f.jsxs("div",{style:{marginTop:12,display:"flex",gap:10,justifyContent:"flex-end"},children:[f.jsx("button",{type:"button",className:"back-btn",onClick:e,style:{background:"#e5e7eb",color:"#111",fontWeight:700},children:"Cancel"}),f.jsx("button",{type:"submit",className:"primary-btn",disabled:De,children:De?"Saving...":" Save Progress"})]})]})]}):null}const SL=(n="")=>{const e=String(n||"").match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^\/&#?]+)/);return e&&e[1]?e[1]:""},wL=(n="")=>{const e=String(n||"");if(/googleusercontent\.com\//.test(e))return e;const t=SL(e);return t?`https://drive.google.com/thumbnail?id=${t}&sz=w1000`:e},on=(n,e=[])=>{if(!n)return"";for(const t of e){if(Object.prototype.hasOwnProperty.call(n,t))return n[t];const s=Object.keys(n).find(a=>a.toLowerCase().replace(/\s+/g,"")===t.toLowerCase().replace(/\s+/g,""));if(s)return n[s]}return""};function EL({open:n,onClose:e,row:t,memberNick:s}){if(!n)return null;const a=t||{},l=on(a,["MemberID","memberid","member_id","id"]),u=on(a,["Date","date","recorded","log_date","timestamp"]),g=on(a,["No","no","entry_no","seq","number"]),d=on(a,["Weight (kg)","Weight(kg)","WeightKg","Weight (lbs)","Weight(lbs)","Weight","Weight_lbs","weight","weight_lbs","weight_(lbs)"]),p=on(a,["BMI","bmi"]),v=on(a,["Height (cm)","Height(cm)","HeightCm","Height (inches)","Height(inches)","Height_in","height_in","height_inches"]),_=on(a,["MuscleMass","muscle_mass","muscle","Muscle"]),S=on(a,["BodyFat","body_fat","bf"]),C=on(a,["VisceralFat","visceral_fat"]),O=on(a,["Chest"]),L=on(a,["Waist"]),U=on(a,["Hips"]),z=on(a,["Shoulders"]),X=on(a,["Arms"]),q=on(a,["Forearms"]),ne=on(a,["Thighs"]),ee=on(a,["Calves"]),de=on(a,["BloodPressure","blood_pressure"]),k=on(a,["RestingHeart Rate","RestingHeartRate","resting_heart_rate"]),M=on(a,["Comments","comments","notes"]),P=on(a,["Photo1URL","Photo1","photo1","photo_url","photo"]),x=on(a,["Photo2URL","Photo2","photo2"]),A=on(a,["Photo3URL","Photo3","photo3"]);return f.jsxs(To,{open:n,onClose:e,title:"Progress Details",width:1e3,children:[f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12,marginBottom:12},children:[f.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[f.jsx("span",{style:{fontSize:14,fontStyle:"italic",color:"var(--muted)",display:"block",marginBottom:4},children:"Nickname"}),f.jsx("div",{style:{fontWeight:700,fontSize:18},children:s||l||"-"})]}),f.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[f.jsx("span",{style:{fontSize:14,fontStyle:"italic",color:"var(--muted)",display:"block",marginBottom:4},children:"Date"}),f.jsx("div",{style:{fontWeight:700,fontSize:18},children:AL(u)||"-"})]}),f.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[f.jsx("span",{style:{fontSize:14,fontStyle:"italic",color:"var(--muted)",display:"block",marginBottom:4},children:"No."}),f.jsx("div",{style:{fontWeight:700,fontSize:18},children:g||"-"})]})]}),f.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:12},children:[["Weight (kg)",d],["Height (cm)",v],["BMI",p],["Muscle Mass (%)",_],["Body Fat (%)",S],["Visceral Fat (%)",C],["Chest (cm)",O],["Waist (cm)",L],["Hips (cm)",U],["Shoulders (cm)",z],["Arms (cm)",X],["Forearms (cm)",q],["Thighs (cm)",ne],["Calves (cm)",ee],["Blood Pressure (mmHg)",de],["Resting Heart Rate (bpm)",k]].map(([V,N])=>f.jsxs("div",{className:"field",children:[f.jsx("span",{className:"label",style:{display:"block",marginBottom:6},children:V}),f.jsx("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10,fontWeight:700,fontSize:18},children:!N||String(N).trim()==="0"?"-":String(N)})]},V))}),f.jsxs("div",{className:"field",style:{marginTop:12},children:[f.jsx("span",{className:"label",children:"Comments"}),f.jsx("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:12,fontSize:16,minHeight:72},children:M?String(M):"-"})]}),f.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:12,marginTop:12},children:[P,x,A].map((V,N)=>f.jsx("div",{style:{position:"relative"},children:f.jsx("div",{style:{position:"relative",width:"100%",height:0,paddingTop:"133.333%",borderRadius:8,border:V?"1px solid #e5e7eb":"1px dashed #e5e7eb",overflow:"hidden"},children:V?f.jsx("img",{src:wL(V),alt:`Photo ${N+1}`,style:{position:"absolute",inset:0,width:"100%",height:"100%",objectFit:"cover"}}):f.jsx("div",{style:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",color:"#999"},children:"No photo"})})},N))})]})}const TL="Asia/Manila";function AL(n){if(!n)return"";let e;if(typeof n=="string")if(/^\d{4}-\d{2}-\d{2}$/.test(n)){const[u,g,d]=n.split("-").map(Number);e=new Date(Date.UTC(u,g-1,d))}else{const u=new Date(n);isNaN(u)||(e=u)}else n instanceof Date&&(e=n);if(!e||isNaN(e))return String(n);const t=new Intl.DateTimeFormat("en-US",{timeZone:TL,month:"short",day:"numeric",year:"numeric"}).formatToParts(e),s=t.find(u=>u.type==="month")?.value||"",a=t.find(u=>u.type==="day")?.value||"",l=t.find(u=>u.type==="year")?.value||"";return`${s}-${a}, ${l}`}function jC({width:n="100%",height:e=200}){return f.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-start"},children:[f.jsx("div",{style:{width:150,height:200,borderRadius:12,background:"#f3f4f6",boxShadow:"inset 0 0 0 1px rgba(0,0,0,0.02)"}}),f.jsxs("div",{style:{flex:1},children:[f.jsx("div",{style:{height:22,width:"60%",background:"#f3f4f6",borderRadius:6,marginBottom:8}}),f.jsx("div",{style:{height:18,width:"40%",background:"#f3f4f6",borderRadius:6,marginBottom:14}}),f.jsx("div",{style:{height:12,width:"80%",background:"#f3f4f6",borderRadius:6,marginBottom:6}}),f.jsx("div",{style:{height:12,width:"70%",background:"#f3f4f6",borderRadius:6,marginBottom:6}}),f.jsx("div",{style:{height:12,width:"50%",background:"#f3f4f6",borderRadius:6,marginTop:10}})]})]})}function qf({text:n="Refreshing",show:e=!0}){return e?f.jsxs("span",{className:"refresh-badge",role:"status","aria-live":"polite",children:[f.jsx("span",{className:"refresh-spinner","aria-hidden":!0}),f.jsx("span",{style:{marginLeft:8},children:n})]}):null}const vi=(n,e)=>e.map(t=>n[t]).find(t=>t!==void 0&&t!==""),lE=n=>{if(!n&&n!==0)return null;try{if(n&&typeof n.toDate=="function")return n.toDate()}catch{}if(n&&typeof n.seconds=="number")return new Date(n.seconds*1e3);if(n instanceof Date)return n;const e=new Date(n);return isNaN(e)?null:e},CL="Asia/Manila",Sd=n=>{if(!n)return"-";const e=n instanceof Date?n:new Date(n);if(isNaN(e))return"-";const t=new Intl.DateTimeFormat("en-US",{timeZone:CL,month:"short",day:"numeric",year:"numeric"}).formatToParts(e),s=t.find(u=>u.type==="month")?.value||"",a=t.find(u=>u.type==="day")?.value||"",l=t.find(u=>u.type==="year")?.value||"";return`${s}-${a}, ${l}`},Dr=n=>n==null||String(n).trim()===""?"-":String(n),tu=n=>{const t=String(n||"").match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return t&&t[1]?t[1]:""},xL=n=>{const e=String(n||"");if(!e)return"";const t=e.match(/https?:\/\/[^\s}]+/);if(t){const l=t[0];if(/googleusercontent\.com\//.test(l))return l;const u=l.match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^\/&?#]+)/);return u&&u[1]?`https://drive.google.com/uc?export=view&id=${u[1]}`:l}if(/googleusercontent\.com\//.test(e))return e;const s=e.match(/\/file\/d\/([^/]+)/)||e.match(/[?&]id=([^&]+)/)||e.match(/\/uc\?[^#]*id=([^&]+)/),a=s?s[1]:"";return a?`https://drive.google.com/uc?export=view&id=${a}`:e},cE=n=>{const e=String(n||"");if(/googleusercontent\.com\//.test(e))return e;const t=tu(e);return t?`https://drive.google.com/thumbnail?id=${t}&sz=w1000`:e};function RL({member:n,status:e={},isRefreshing:t=!1,onEdit:s=()=>{},onAddPayment:a=()=>{},onShowQr:l=()=>{},onShowProgress:u=()=>{},onCheckIn:g=()=>{}}){const[d,p]=T.useState(!1),v=vi(n||{},["lastname","last_name"]),_=vi(n||{},["firstname","first_name"]),S=vi(n||{},["middlename","middle_name"]),C=vi(n||{},["gender"]),O=vi(n||{},["birthday","birth_date","dob"]),L=lE(O);vi(n||{},["nick_name","nickname"]);const U=vi(n||{},["street"]),z=vi(n||{},["brgy","barangay"]),X=vi(n||{},["municipality","city"]),q=vi(n||{},["email"]),ne=vi(n||{},["mobile","phone"]),ee=lE(vi(n||{},["member_since","membersince","join_date"]));String(vi(n||{},["memberid","member_id","id"])||"").trim();const de=vi(n||{},["photourl","photo_url","photo"]),k=xL(de);cE(k),T.useEffect(()=>{p(!1)},[k]);const M=L?new Date().getFullYear()-L.getFullYear()-(new Date().getMonth()<L.getMonth()||new Date().getMonth()===L.getMonth()&&new Date().getDate()<L.getDate()?1:0):"-";return f.jsxs("div",{className:"member-card",style:{marginTop:12},children:[f.jsx("div",{className:"member-photo",children:f.jsx("div",{className:"photo-box",children:k&&!d?f.jsx("img",{src:cE(k),alt:"photo",onError:P=>{const x=P.currentTarget;if(!x.dataset.retry&&de){x.dataset.retry="1";const A=tu(de)||tu(k);A?x.src=`https://drive.google.com/uc?export=view&id=${A}`:x.style.display="none"}else if(x.dataset.retry==="1"){x.dataset.retry="2";const A=tu(de)||tu(k);A?x.src=`https://drive.google.com/uc?export=download&id=${A}`:p(!0)}else p(!0)}}):f.jsx("div",{style:{color:"var(--muted)",padding:16},children:"No photo"})})}),f.jsxs("div",{className:"member-info",children:[f.jsxs("div",{className:"member-grid",children:[f.jsxs("div",{className:"cell lastname",children:[f.jsx("div",{className:"label",children:"Last Name"}),f.jsx("div",{className:"value",children:Dr(v)})]}),f.jsxs("div",{className:"cell firstname",children:[f.jsx("div",{className:"label",children:"First Name"}),f.jsx("div",{className:"value",children:Dr(_)})]}),f.jsxs("div",{className:"cell middlename",children:[f.jsx("div",{className:"label",children:"Middle Name"}),f.jsx("div",{className:"value",children:Dr(S)})]}),f.jsxs("div",{className:"cell gender",children:[f.jsx("div",{className:"label",children:"Gender"}),f.jsx("div",{className:"value",children:Dr(C)})]}),f.jsxs("div",{className:"cell birthday",children:[f.jsx("div",{className:"label",children:"Birthday"}),f.jsx("div",{className:"value",children:Sd(L)})]}),f.jsxs("div",{className:"cell age",children:[f.jsx("div",{className:"label",children:"Age"}),f.jsx("div",{className:"value",children:Dr(M)})]}),f.jsxs("div",{className:"cell street",children:[f.jsx("div",{className:"label",children:"House No. / Street Name / Sitio"}),f.jsx("div",{className:"value",children:Dr(U)})]}),f.jsxs("div",{className:"cell brgy",children:[f.jsx("div",{className:"label",children:"Brgy."}),f.jsx("div",{className:"value",children:Dr(z)})]}),f.jsxs("div",{className:"cell municipality",children:[f.jsx("div",{className:"label",children:"Municipality / City"}),f.jsx("div",{className:"value",children:Dr(X)})]}),f.jsxs("div",{className:"cell nickname",children:[f.jsx("div",{className:"label",children:"Member Since"}),f.jsx("div",{className:"value",children:Sd(ee)})]}),f.jsxs("div",{className:"cell mobile",children:[f.jsx("div",{className:"label",children:"Mobile"}),f.jsx("div",{className:"value",children:Dr(ne)})]}),f.jsxs("div",{className:"cell email",children:[f.jsx("div",{className:"label",children:"Email"}),f.jsx("div",{className:"value",children:Dr(q)})]})]}),f.jsxs("div",{className:"status-tiles",children:[f.jsxs("div",{className:`status-tile ${e.membershipState==null?"none":e.membershipState}`,children:[f.jsx("div",{className:"title",children:"Gym Membership"}),f.jsxs("div",{style:{marginBottom:10},children:[e.membershipState==="active"&&f.jsx("span",{className:"pill ok",children:"Active"}),e.membershipState==="expired"&&f.jsx("span",{className:"pill bad",children:"Expired"}),(!e.membershipState||e.membershipState==="none")&&f.jsx("span",{className:"pill",style:{background:"#fff",color:"#555",borderColor:"#ddd"},children:"None"})]}),f.jsx("div",{className:"label",children:"Valid until"}),f.jsx("div",{className:"value",children:Sd(e.membershipEnd)})]}),f.jsxs("div",{className:`status-tile ${e.coachEnd?e.coachActive?"active":"expired":"none"}`,children:[f.jsx("div",{className:"title",children:"Coach Subscription"}),f.jsxs("div",{style:{marginBottom:10},children:[e.coachActive&&f.jsx("span",{className:"pill ok",children:"Active"}),e.coachEnd&&!e.coachActive&&f.jsx("span",{className:"pill bad",children:"Expired"}),!e.coachEnd&&f.jsx("span",{className:"pill",style:{background:"#fff",color:"#555",borderColor:"#ddd"},children:"None"})]}),f.jsx("div",{className:"label",children:"Valid until"}),f.jsx("div",{className:"value",children:Sd(e.coachEnd)})]})]}),f.jsxs("div",{className:"member-actions",children:[f.jsx("button",{className:"primary-btn",onClick:()=>s(),title:"Edit member details",children:" Edit"}),f.jsx("button",{className:"primary-btn",onClick:()=>a(),title:"Manage payments",children:" Add Payment"}),f.jsx("button",{className:"primary-btn",onClick:()=>l(),title:"Show QR code for this member",children:" QR Code"}),f.jsx("button",{className:"primary-btn",onClick:()=>u(),title:"Track or view progress",children:" Progress"})]})]})]})}const IL=n=>String(n||"").trim().toLowerCase().replace(/\s+/g,"_"),na=(n,e)=>e.map(t=>(n||{})[t]).find(t=>t!==void 0&&t!==""),Kc=n=>{if(!n&&n!==0)return null;try{if(n&&typeof n.toDate=="function")return n.toDate()}catch{}if(n&&typeof n.seconds=="number")return new Date(n.seconds*1e3);if(n instanceof Date)return n;if(typeof n=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(n))try{return new Date(`${n}T00:00:00+08:00`)}catch{}const e=new Date(n);return isNaN(e)?null:e},hp=n=>{const e={};return Object.entries(n||{}).forEach(([t,s])=>{e[IL(t)]=s}),e};function Aa(n,e,t=[]){const s=z=>{if(!z)return null;const X=z instanceof Date?z:Kc(z);return X?new Intl.DateTimeFormat("en-CA",{timeZone:"Asia/Manila",year:"numeric",month:"2-digit",day:"2-digit"}).format(X):null},a=s(new Date);let l=null,u=null,g=null,d=null;const p=new Map,v=Array.isArray(t)?t:[],_=z=>{const X=String(z??"").trim().toLowerCase();return X==="yes"||X==="y"||X==="true"||X==="1"},S=(z,X)=>{for(const q of X){if(z&&Object.prototype.hasOwnProperty.call(z,q))return z[q];const ne=Object.keys(z||{}).find(ee=>ee.toLowerCase().replace(/\s+/g,"")===q.toLowerCase().replace(/\s+/g,""));if(ne)return z[ne]}};v.forEach(z=>{const X=String(S(z,["Particulars"])||"").trim();if(!X)return;const q=_(S(z,["Gym membership","Gym Membership","GymMembership","Membership"])),ne=_(S(z,["Coach subscription","Coach Subscription","CoachSubscription","Coach"]));p.set(String(X).toLowerCase(),{gym:q,coach:ne})});let C=null;if(typeof e=="string")C=String(e||"").trim().toLowerCase();else if(e&&typeof e=="object"){const z=hp(e);C=String(na(z,["memberid","member_id","id","member_id_"])||"").trim().toLowerCase()}const O=Array.isArray(n)?n:[];for(const z of O){const X=hp(z);if(C){const D=String(na(X,["memberid","member_id","id","member_id_"])||"").trim().toLowerCase();if(!D||D!==C)continue}const q=String(na(X,["particulars","type","item","category","product","paymentfor","plan","description"])||"").trim(),ne=na(X,["gymvaliduntil","gym_valid_until","gym_until","enddate","end_date","valid_until","expiry","expires","until","end"]),ee=na(X,["coachvaliduntil","coach_valid_until","coach_until","coach_end","coachend"]),de=na(X,["enddate","end_date","valid_until","expiry","expires","until","end"]),k=Kc(ne),M=Kc(ee),P=Kc(de),x=s(k),A=s(M),V=s(P),N=p.get(String(q).toLowerCase())||{gym:null,coach:null},fe=N.coach===!0||N.coach===null&&/coach|trainer|pt/i.test(q),F=N.gym===!0||N.gym===null&&/member|gym/i.test(q);x?(!g||x>g)&&(g=x,l=k):F&&V&&(!g||V>g)&&(g=V,l=P),A?(!d||A>d)&&(d=A,u=M):fe&&V&&(!d||V>d)&&(d=V,u=P)}if((!l||l==null)&&e&&typeof e=="object"){const z=hp(e);if(String(na(z,["membershipstate","membership_state","membership","status"])||"").trim().toLowerCase()==="active")return{membershipEnd:l,membershipState:"active",coachEnd:u,coachActive:!!(d&&d>=a)};const q=na(z,["membershipend","membership_end","membershipEnd","membership_end","gymvaliduntil","gym_valid_until","gym_until","enddate","end_date","valid_until","expiry","expires","until","end","gym_valid","gym_validity","gymvalid"]);if(q){const ne=Kc(q),ee=s(ne);ne&&!isNaN(ne)&&(!g||ee>g)&&(g=ee,l=ne)}}let L=null;g&&(L=g>=a?"active":"expired");let U=!1;return d&&(U=d>=a),{membershipEnd:l,membershipState:L,coachEnd:u,coachActive:U}}const{fetchMemberBundle:NL,fetchPricing:DL,gymQuickAppend:uE,gymClockOut:ML,upsertGymEntry:OL,gymClockIn:jL,fetchMemberByIdFresh:kL}=kt,_l="Asia/Manila",dp=n=>{if(!n)return"-";const e=n instanceof Date?n:new Date(n);if(isNaN(e))return"-";const t=new Intl.DateTimeFormat("en-US",{timeZone:_l,month:"short",day:"numeric",year:"numeric"}).formatToParts(e),s=t.find(u=>u.type==="month")?.value||"",a=t.find(u=>u.type==="day")?.value||"",l=t.find(u=>u.type==="year")?.value||"";return`${s}-${a}, ${l}`},kC=n=>{const t=String(n||"").match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return t&&t[1]?t[1]:""},PL=n=>{const e=String(n||"");if(!e)return"";const t=e.match(/https?:\/\/[^\s}]+/);if(t){const a=t[0];if(/googleusercontent\.com\//.test(a))return a;const l=a.match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return l&&l[1]?`https://drive.google.com/uc?export=view&id=${l[1]}`:a}if(/googleusercontent\.com\//.test(e))return e;const s=kC(e);return s?`https://drive.google.com/uc?export=view&id=${s}`:e},VL=n=>{const e=String(n||"");if(/googleusercontent\.com\//.test(e))return e;const t=kC(e);return t?`https://drive.google.com/thumbnail?id=${t}&sz=w1000`:e};function Gf({open:n,onClose:e,memberId:t,initialEntry:s=null,onSuccess:a,status:l=null,mode:u=null}){const[g,d]=T.useState(null),[p,v]=T.useState([]),[_,S]=T.useState(null),[C,O]=T.useState(!1),[L,U]=T.useState(""),[z,X]=T.useState(""),[q,ne]=T.useState(""),[ee,de]=T.useState(""),[k,M]=T.useState(!1),[P,x]=T.useState(!1),A=["Coach Elmer","Coach Jojo","None"],V=["Full body","Upper body","Lower body","Chest","Other"];T.useEffect(()=>{let D=!0;if(!(!n||!t))return(async()=>{O(!0);try{console.debug("[CheckInConfirmModal] loading bundle for",t);const[$,Q]=await Promise.all([NL(t),DL()]);if(!D)return;if($&&!$.member)try{console.debug("[CheckInConfirmModal] bundle missing member, trying fetchMemberByIdFresh",t);const Se=await kL(t);Se&&($.member=Se)}catch(Se){console.debug("[CheckInConfirmModal] fetchMemberByIdFresh fallback failed",Se)}d($);const J=Q?.rows||Q?.data||[];v(J);const Y=l||Aa($?.payments||[],t,J);S(Y);const I=new Intl.DateTimeFormat("en-CA",{timeZone:_l,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date),K=($?.gymEntries||[]).filter(Se=>{const Me=Se?.Date||Se?.date;if(!Me)return!1;const ke=new Date(Me);return new Intl.DateTimeFormat("en-CA",{timeZone:_l,year:"numeric",month:"2-digit",day:"2-digit"}).format(ke)===I}).find(Se=>!String(Se?.TimeOut||Se?.timeout||"").trim());let le=!1;if(s){const Se=s.Date||s.date||"";if(Se){const Me=new Date(Se);new Intl.DateTimeFormat("en-CA",{timeZone:_l,year:"numeric",month:"2-digit",day:"2-digit"}).format(Me)===I&&!String(s.TimeOut||"").trim()&&(le=!0)}}let we=!!K||le;u==="in"&&(we=!1),u==="out"&&(we=!0),M(we);const Ee=le?s:K||null;if(we&&Ee){const Se=Ee||{};U(String(Se.Workouts??Se.workouts??Se.Done??"").trim()),X(String(Se.Comments??Se.comments??Se.Notes??"").trim()),ne(String(Se.Coach??Se.coach??"")||""),de(String(Se.Focus??Se.focus??"")||"")}else U(""),X(""),ne(""),de("")}catch($){try{console.debug("[CheckInConfirmModal] load error",$),Gn.emit("modal:error",{message:"Failed to load check-in data",source:"CheckInConfirmModal",error:String($)})}catch{}}finally{D&&O(!1)}})(),()=>{D=!1}},[n,t,s?.rowNumber,s?.Date,s?.TimeIn,l]);const N=g?.member||null,fe=async()=>{if(t){x(!0);try{if(s){const D=s.Date||s.date||"",$=new Intl.DateTimeFormat("en-CA",{timeZone:_l,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date),Q=D?new Date(D):null,J=Q?new Intl.DateTimeFormat("en-CA",{timeZone:_l,year:"numeric",month:"2-digit",day:"2-digit"}).format(Q):"",Y=String(s.TimeOut||s.timeout||"").trim();if(J===$&&!Y){const I=new Date().toISOString();try{const B=s.TimeIn||s.Timein||s.timeIn||s.timein||null,K=s.Date||s.date||null,le={memberId:t,timeOut:I,Workouts:L,Comments:z};try{console.debug("[CheckInConfirmModal] upsert payload",le)}catch{}_?.coachActive&&(q&&q!=="None"&&(le.Coach=q),ee&&(le.Focus=ee)),B&&(le.TimeIn=B),K&&(le.Date=K),s.rowNumber&&(le.rowNumber=s.rowNumber);const we=await OL(le);try{console.debug("[CheckInConfirmModal] upsertGymEntry res",we)}catch{}try{Gn.emit("gymEntry:added",{MemberID:t,...we||{},Workouts:L,Comments:z})}catch{}x(!1),a&&a(),e&&e();return}catch(B){try{Gn.emit("modal:error",{message:"Failed to upsert gym entry",source:"CheckInConfirmModal",error:String(B)})}catch{}}}}try{const D={wantsOut:!0,Workouts:L,Comments:z};if(_?.coachActive&&(q&&q!=="None"&&(D.Coach=q),ee&&(D.Focus=ee)),s){const $=s.TimeIn||s.Timein||s.timeIn||s.timein||null,Q=s.Date||s.date||null;$&&(D.TimeIn=$),Q&&(D.Date=Q),s.rowNumber&&(D.rowNumber=s.rowNumber)}try{console.debug("[CheckInConfirmModal] gymQuickAppend extra",D)}catch{}await uE(t,D)}catch(D){const $={Workouts:L,Comments:z};s&&(s.TimeIn&&($.TimeIn=s.TimeIn),s.Date&&($.Date=s.Date),s.rowNumber&&($.rowNumber=s.rowNumber)),_?.coachActive&&(q&&q!=="None"&&($.Coach=q),ee&&($.Focus=ee));try{console.debug("[CheckInConfirmModal] gymQuickAppend failed, falling back to gymClockOut",$,D)}catch{}await ML(t,$)}try{Gn.emit("gymEntry:added",{MemberID:t,Workouts:L,Comments:z})}catch{}x(!1),a&&a(),e&&e()}catch(D){try{Gn.emit("modal:error",{message:"Checkout failed",source:"CheckInConfirmModal",error:String(D)})}catch{}x(!1)}}},F=async()=>{if(t){x(!0);try{const D={Workouts:L,Comments:z};_?.coachActive&&(q&&q!=="None"&&(D.Coach=q),ee&&(D.Focus=ee));try{await uE(t,D)}catch{await jL(t,D)}x(!1),a&&a(),e&&e()}catch(D){try{Gn.emit("modal:error",{message:"Checkin failed",source:"CheckInConfirmModal",error:String(D)})}catch{}x(!1)}}};return n?f.jsx(To,{open:n,onClose:e,width:720,noInternalScroll:!0,children:C?f.jsx("div",{style:{padding:24},children:"Loading"}):N?f.jsxs(f.Fragment,{children:[f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"auto 1fr",gap:16,alignItems:"center"},children:[f.jsx("div",{style:{width:150,height:200,borderRadius:12,overflow:"hidden",border:"1px solid #e7e8ef",background:"#fafbff"},children:N.PhotoURL||N.Photo?f.jsx("img",{src:VL(PL(N.PhotoURL||N.Photo)),alt:"Member",style:{width:"100%",height:"100%",objectFit:"cover"}}):f.jsx("div",{style:{display:"flex",width:"100%",height:"100%",alignItems:"center",justifyContent:"center",color:"#999"},children:"No Photo"})}),f.jsxs("div",{children:[f.jsx("div",{style:{fontWeight:900,fontSize:28,lineHeight:1.1},children:N.NickName||N.Nickname||"-"}),f.jsx("div",{style:{fontWeight:700,fontSize:18,color:"#444",marginTop:4},children:[N.FirstName,N.LastName].filter(Boolean).join(" ")||"-"}),f.jsx("div",{style:{fontStyle:"italic",color:"#666",marginTop:8},children:"Member Since"}),f.jsx("div",{style:{fontWeight:800,fontSize:16},children:dp(N.MemberSince||N["Member Since"]||N.Joined||N["Join Date"])})]})]}),f.jsxs("div",{className:"status-tiles",style:{marginTop:14},children:[f.jsxs("div",{className:`status-tile ${_?.membershipState==null?"none":_.membershipState}`,children:[f.jsx("div",{className:"title",children:"Gym Membership"}),f.jsx("div",{style:{marginBottom:10},children:_?.membershipState==="active"?f.jsx("span",{className:"pill ok",children:"Active"}):_?.membershipState==="expired"?f.jsx("span",{className:"pill bad",children:"Expired"}):f.jsx("span",{className:"pill",children:"None"})}),f.jsx("div",{className:"label",children:"Valid until"}),f.jsx("div",{className:"value",children:dp(_?.membershipEnd)})]}),f.jsxs("div",{className:`status-tile ${_?.coachActive?"active":_?.coachEnd?"expired":"none"}`,children:[f.jsx("div",{className:"title",children:"Coach Subscription"}),f.jsx("div",{style:{marginBottom:10},children:_?.coachActive?f.jsx("span",{className:"pill ok",children:"Active"}):_?.coachEnd?f.jsx("span",{className:"pill bad",children:"Expired"}):f.jsx("span",{className:"pill",children:"None"})}),f.jsx("div",{className:"label",children:"Valid until"}),f.jsx("div",{className:"value",children:dp(_?.coachEnd)})]})]}),k&&f.jsx("div",{children:_?.coachActive?f.jsxs(f.Fragment,{children:[f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:14},children:[f.jsxs("div",{className:"field",children:[f.jsx("label",{className:"label",children:"Coach"}),f.jsxs("select",{value:q,onChange:D=>ne(D.target.value),children:[f.jsx("option",{value:"",children:"(Select)"}),A.map(D=>f.jsx("option",{value:D,children:D},D))]})]}),f.jsxs("div",{className:"field",children:[f.jsx("label",{className:"label",children:"Workout Focus"}),f.jsxs("select",{value:ee,onChange:D=>de(D.target.value),children:[f.jsx("option",{value:"",children:"(none)"}),V.map(D=>f.jsx("option",{value:D,children:D},D))]})]})]}),f.jsxs("div",{className:"field",style:{marginTop:16},children:[f.jsx("label",{className:"label",children:"Workouts Done"}),f.jsx("textarea",{value:L,onChange:D=>U(D.target.value),placeholder:"Describe workouts done (optional)",style:{width:"100%",minHeight:48,borderRadius:8,border:"1px solid #e7e8ef",padding:"8px 12px",fontSize:15,resize:"vertical"}})]})]}):f.jsxs("div",{className:"field",style:{marginTop:16},children:[f.jsx("label",{className:"label",children:"Workouts Done"}),f.jsx("textarea",{value:L,onChange:D=>U(D.target.value),placeholder:"Describe workouts done (optional)",style:{width:"100%",minHeight:48,borderRadius:8,border:"1px solid #e7e8ef",padding:"8px 12px",fontSize:15,resize:"vertical"}})]})}),!k&&f.jsx("div",{children:_?.coachActive&&f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:14},children:[f.jsxs("div",{className:"field",children:[f.jsx("label",{className:"label",children:"Coach"}),f.jsxs("select",{value:q,onChange:D=>ne(D.target.value),children:[f.jsx("option",{value:"",children:"(Select)"}),A.map(D=>f.jsx("option",{value:D,children:D},D))]})]}),f.jsxs("div",{className:"field",children:[f.jsx("label",{className:"label",children:"Workout Focus"}),f.jsxs("select",{value:ee,onChange:D=>de(D.target.value),children:[f.jsx("option",{value:"",children:"(none)"}),V.map(D=>f.jsx("option",{value:D,children:D},D))]})]})]})}),f.jsxs("div",{className:"field",style:{marginTop:16},children:[f.jsx("label",{className:"label",children:"Comments"}),f.jsx("textarea",{value:z,onChange:D=>X(D.target.value),placeholder:"Add comments (optional)",style:{width:"100%",minHeight:48,borderRadius:8,border:"1px solid #e7e8ef",padding:"8px 12px",fontSize:15,resize:"vertical"}})]}),f.jsx("div",{style:{marginTop:12,color:"#b91c1c",fontSize:13},children:!k&&_?.membershipState!=="active"&&f.jsx("div",{style:{marginBottom:8},children:"Cannot check in: gym membership is not active."})}),f.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:16},children:k?f.jsx("button",{className:"primary-btn",onClick:fe,disabled:P||_?.coachActive&&(!q||!ee),children:P?"Checking out":"Confirm Check-Out"}):f.jsx("button",{className:"primary-btn",onClick:F,disabled:P||_?.membershipState!=="active"||_?.coachActive&&(!q||!ee),children:P?"Checking in":"Confirm Check-In"})})]}):f.jsx("div",{style:{padding:24},children:"Member not found."})}):null}const{fetchMemberById:LL,fetchMemberByIdFresh:UL}=kt,Nt=(n,e=[])=>{if(!n)return"";for(const t of e){if(Object.prototype.hasOwnProperty.call(n,t))return n[t];const s=Object.keys(n).find(a=>a.toLowerCase().replace(/\s+/g,"")===t.toLowerCase().replace(/\s+/g,""));if(s)return n[s]}return""};function kv({open:n,onClose:e,row:t,onCheckout:s}){Ll();const[a,l]=Ct.useState(!1),[u,g]=Ct.useState(null),d=t&&t.raw?t.raw:t||{},p=Nt(d,["MemberID","memberid","member_id","id"]);Ct.useEffect(()=>{let ee=!0;return(async()=>{try{if(!p)return;let de=await LL(p);if(!ee)return;if(!de)try{const P=await UL?.(p);P&&(de=P)}catch{}if(!de){try{const P=Nt(d,["NickName","nickname","Nick","nick","Nick_Name","Nick Name"])||Nt(t,["NickName","nickname","Nick","nick","Nick_Name","Nick Name"]);if(P){g(String(P).trim());return}const x=Nt(d,["FirstName","firstname","first_name","first"])||Nt(t,["FirstName","firstname","first_name","first"]),A=Nt(d,["LastName","lastname","last_name","last"])||Nt(t,["LastName","lastname","last_name","last"]),V=(x||"").trim()||(A||"").trim()?`${(x||"").trim()} ${(A||"").trim()}`.trim():null;if(V){g(V);return}}catch{}return}const k=de._raw||de,M=Nt(k,["NickName","nickname","Nick","nick","Nick_Name","Nick Name"]);if(M)g(String(M).trim());else{const P=(de.firstname||de.firstName||de.FirstName||"").trim(),x=(de.lastname||de.lastName||de.LastName||"").trim(),A=P||x?`${P} ${x}`.trim():null;if(A&&g(A),!A)try{const V=Nt(d,["NickName","nickname","Nick","nick","Nick_Name","Nick Name"])||Nt(t,["NickName","nickname","Nick","nick","Nick_Name","Nick Name"]);if(V){g(String(V).trim());return}const N=Nt(d,["FirstName","firstname","first_name","first"])||Nt(t,["FirstName","firstname","first_name","first"]),fe=Nt(d,["LastName","lastname","last_name","last"])||Nt(t,["LastName","lastname","last_name","last"]),F=(N||"").trim()||(fe||"").trim()?`${(N||"").trim()} ${(fe||"").trim()}`.trim():null;if(F){g(F);return}}catch{}}}catch{}})(),()=>{ee=!1}},[p]);const v=Nt(d,["Date","date","visit_date","timestamp"])||Nt(t,["Date","date","visit_date","timestamp"]),_=Nt(d,["TimeIn","timein","time_in"])||Nt(t,["TimeIn","timein","time_in"]),S=Nt(d,["TimeOut","timeout","time_out"])||Nt(t,["TimeOut","timeout","time_out"]),C=Nt(d,["TotalHours","totalhours","NoOfHours","noofhours","hours"])||Nt(t,["TotalHours","totalhours","NoOfHours","noofhours","hours"]),O=Nt(d,["Coach","coach"])||Nt(t,["Coach","coach"]),L=Nt(d,["Focus","focus"])||Nt(t,["Focus","focus"]),U=Nt(d,["Workouts","workouts","done","workouts_done"])||Nt(t,["Workouts","workouts","done","workouts_done"]),z=Nt(d,["Comments","comments","notes"])||Nt(t,["Comments","comments","notes"]);Nt(d,["Photo","photo","photo_url","PhotoURL"])||Nt(t,["Photo","photo","photo_url","PhotoURL"]);const[X,q]=Ct.useState(!1);if(!n)return null;const ne=()=>{if(typeof s=="function")try{s(t,{checkedOut:!0})}catch(ee){console.error(ee)}};return f.jsxs(f.Fragment,{children:[f.jsxs(To,{open:n,onClose:e,title:"Visit Details",noInternalScroll:!0,children:[f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:12},children:[f.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[f.jsx("span",{style:{fontSize:14,fontStyle:"italic",color:"var(--muted)",display:"block",marginBottom:4},children:"Nickname"}),f.jsx("div",{style:{fontWeight:700,fontSize:18},children:u||p||"-"})]}),f.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[f.jsx("span",{style:{fontSize:14,fontStyle:"italic",color:"var(--muted)",display:"block",marginBottom:4},children:"Date"}),f.jsx("div",{style:{fontWeight:700,fontSize:18},children:ca(v)||"-"})]})]}),f.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:12},children:[["Time In",_],["Time Out",S],["Total Hours",C]].map(([ee,de])=>f.jsxs("div",{className:"field",children:[f.jsx("span",{className:"label",style:{display:"block",marginBottom:6},children:ee}),f.jsx("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10,fontWeight:700,fontSize:18},children:ee==="Time In"||ee==="Time Out"?de?wu(de):"-":de?String(de):"-"})]},ee))}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:12},children:[f.jsxs("div",{className:"field",children:[f.jsx("span",{className:"label",children:"Coach"}),f.jsx("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:12,fontSize:16,minHeight:44},children:O||"-"})]}),f.jsxs("div",{className:"field",children:[f.jsx("span",{className:"label",children:"Focus"}),f.jsx("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:12,fontSize:16,minHeight:44},children:L||"-"})]})]}),f.jsxs("div",{className:"field",style:{marginTop:12},children:[f.jsx("span",{className:"label",children:"Workouts Done"}),f.jsx("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:12,fontSize:16,minHeight:72},children:U||"-"})]}),f.jsxs("div",{className:"field",style:{marginTop:12},children:[f.jsx("span",{className:"label",children:"Comments"}),f.jsx("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:12,fontSize:16,minHeight:72},children:z||"-"})]}),f.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:[S?null:f.jsx("button",{className:"primary-btn",onClick:()=>{try{if(typeof s=="function"){try{s(d)}catch(ee){console.error(ee)}e&&e();return}q(!0)}catch(ee){console.error(ee)}},children:"Check Out"}),f.jsx("button",{className:"primary-btn",onClick:e,children:"Close"})]})]}),X&&f.jsx(Gf,{open:X,onClose:()=>{q(!1)},memberId:p,initialEntry:d,onSuccess:()=>{q(!1),e&&e(),ne()}})]})}function Wc(n,e=[]){if(n)for(const t of e){if(Object.prototype.hasOwnProperty.call(n,t))return n[t];const s=Object.keys(n).find(a=>a.toLowerCase().replace(/\s+/g,"")===t.toLowerCase().replace(/\s+/g,""));if(s)return n[s]}}function df(n){if(!n)return"";if(typeof n=="string")return n;const e=Wc(n,["NickName","nickname","Nick","nick","Nick_Name","Nick Name","name","Name"]);if(e&&String(e).trim())return String(e).trim();const t=Wc(n,["FirstName","firstname","first_name","first"])||"",s=Wc(n,["LastName","lastname","last_name","last"])||"",a=`${String(t).trim()} ${String(s).trim()}`.trim();if(a)return a;const l=Wc(n,["DisplayName","displayname","display"]);if(l&&String(l).trim())return String(l).trim();const u=Wc(n,["MemberID","memberid","member_id","id"])||"";return u&&String(u).trim()?String(u).trim():""}const{fetchMembers:zL,fetchPayments:BL,fetchGymEntries:FL,fetchProgressTracker:HL,fetchMemberBundle:hE,fetchPricing:dE,fetchMemberById:B6,fetchMemberByIdFresh:qL,addPayment:F6}=kt,GL=n=>String(n||"").trim().toLowerCase().replace(/\s+/g,"_"),sn=n=>Object.fromEntries(Object.entries(n||{}).map(([e,t])=>[GL(e),t])),Ue=(n,e)=>e.map(t=>n[t]).find(t=>t!==void 0&&t!==""),Hn=n=>{if(!n&&n!==0)return null;try{if(n&&typeof n.toDate=="function")return n.toDate()}catch{}if(n&&typeof n.seconds=="number")return new Date(n.seconds*1e3);if(n instanceof Date)return n;const e=new Date(n);return isNaN(e)?null:e},io="Asia/Manila",wu=n=>{if(!n)return"-";if(/^\d{1,2}:\d{2}\s?(AM|PM)$/i.test(n))return n;const e=new Date(n);if(!isNaN(e))return new Intl.DateTimeFormat("en-US",{timeZone:io,hour:"2-digit",minute:"2-digit",hour12:!0}).format(e);const t=String(n).match(/(\d{2}):(\d{2})/);if(t){let s=parseInt(t[1],10),a=t[2],l=s>=12?"PM":"AM";return s=s%12||12,`${s}:${a} ${l}`}return"-"},ca=n=>{if(!n)return"-";const e=n instanceof Date?n:new Date(n);if(isNaN(e))return"-";const t=new Intl.DateTimeFormat("en-US",{timeZone:io,month:"short",day:"numeric",year:"numeric"}).formatToParts(e),s=t.find(u=>u.type==="month")?.value||"",a=t.find(u=>u.type==="day")?.value||"",l=t.find(u=>u.type==="year")?.value||"";return`${s}-${a}, ${l}`},Dn=n=>n==null||String(n).trim()===""?"-":String(n),$L=n=>{const e=String(n||"");if(!e)return"";const t=e.match(/https?:\/\/[^\s}]+/);if(t){const l=t[0];if(/googleusercontent\.com\//.test(l))return l;const u=l.match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return u&&u[1]?`https://drive.google.com/uc?export=view&id=${u[1]}`:l}if(/googleusercontent\.com\//.test(e))return e;const s=e.match(/\/file\/d\/([^/]+)/)||e.match(/[?&]id=([^&]+)/)||e.match(/\/uc\?[^#]*id=([^&]+)/),a=s?s[1]:"";return a?`https://drive.google.com/uc?export=view&id=${a}`:e},QL=n=>{const t=String(n||"").match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return t&&t[1]?t[1]:""},YL=n=>{const e=String(n||"");if(/googleusercontent\.com\//.test(e))return e;const t=QL(e);return t?`https://drive.google.com/thumbnail?id=${t}&sz=w1000`:e};function KL(){const[n,e]=T.useState(null),{id:t,memberId:s}=hI(),a=Ll(),l=Es(),u=Ct.useMemo(()=>l.state?.row?sn(l.state.row):null,[l.state?.row]),[g,d]=T.useState(u||null),[p,v]=T.useState(!u),[_,S]=T.useState(!1),[C,O]=T.useState(""),[L,U]=T.useState({membershipState:null,coachActive:!1,membershipEnd:null,coachEnd:null}),[z,X]=T.useState([]),[q,ne]=T.useState([]),[ee,de]=T.useState([]),[k,M]=T.useState([]),{membershipState:P,coachActive:x}=L,A=Ue(g,["student"]),V=typeof A=="string"?A.trim().toLowerCase().startsWith("y"):!!A,N=Ue(g,["lastname","last_name"]),fe=Ue(g,["firstname","first_name"]);Ue(g,["middlename","middle_name"]),Ue(g,["gender"]);const F=Ue(g,["birthday","birth_date","dob"]),D=Hn(F),$=Ue(g,["nick_name","nickname"]);Ue(g,["street"]),Ue(g,["brgy","barangay"]),Ue(g,["municipality","city"]),Ue(g,["email"]),Ue(g,["mobile","phone"]);const Q=Hn(Ue(g,["member_since","membersince","join_date"])),J=String(Ue(g,["memberid","member_id","member_id_","id"])||"").trim(),Y=Ue(g,["photourl","photo_url","photo"]),I=$L(Y),B=YL(I),[K,le]=T.useState(!1),[we,Ee]=T.useState(!1),[Se,Me]=T.useState(!1),[ke,Ae]=T.useState(!1),[De,ze]=T.useState(!1),[G,he]=T.useState(null),[oe,Te]=T.useState(!1),[be,Ce]=T.useState(!1),[ae,Ne]=T.useState(null),[We,St]=T.useState(-1),[tn,xt]=T.useState(!1),[Tt,wt]=T.useState(10),[Bt,Wt]=T.useState(10),[un,ci]=T.useState(10);T.useEffect(()=>{xt(!1)},[I]);const Pe=xe=>{try{const Be=sn(xe||{}),ct=[Be.timeout,Be.time_out,Be.timeOut,Be.timeout,Be.time_out_];for(const ve of ct)if(ve&&String(ve).trim()!==""&&(Hn(ve)||/\d/.test(String(ve))))return!1;const $e=String(xe?.TimeOut||xe?.Time_Out||xe?.TimeOUT||xe?.Timeout||"").trim();if($e){try{if(Hn($e))return!1}catch{}if(/\d/.test($e))return!1}return!0}catch{return!0}},Ze=Ct.useRef(null),at=()=>{Ze.current&&clearTimeout(Ze.current),Ze.current=setTimeout(()=>{Xe(),Ze.current=null},200)};if(T.useEffect(()=>{let xe=!0;(async()=>{const ve=decodeURIComponent(s||t||"").trim(),Oe=String(Ue(u||{},["memberid","member_id","id"])||"").trim(),Le=ve||Oe;if(!Le){v(!1);return}if(u){d(u),v(!1);try{at(),typeof window<"u"&&setTimeout(()=>{try{at()}catch{}},600)}catch{}return}async function ut(){const[He,mt]=await Promise.all([hE(Le,{ttlMs:0}),dE()]),Ot=He.member?sn(He.member):null,Ft=(He.payments||[]).map(sn),Si=(He.gymEntries||[]).map(fr=>fr),Xi=Si.map(sn),Zi=(He.progress||[]).map(sn);ne(Si);const ui=(mt?.rows||mt?.data||[]).map(fr=>fr);return{m:Ot,pays:Ft,gyms:Xi,progs:Zi,pricingRows:ui}}async function pn(){const[He,mt,Ot,Ft]=await Promise.all([zL(),BL(),FL(),HL()]),Xi=(He?.rows??He?.data??[]).map(sn).find(Pn=>String(Ue(Pn,["memberid","member_id","member_id_","id"])||"").trim().toLowerCase()===Le.toLowerCase())||null,Zi=(mt?.rows??mt?.data??[]).filter(Pn=>String(Ue(sn(Pn),["memberid","member_id","member_id_","id"])||"").trim().toLowerCase()===Le.toLowerCase()),ui=(Ot?.rows??Ot?.data??[]).filter(Pn=>String(Ue(sn(Pn),["memberid","member_id","member_id_","id"])||"").trim().toLowerCase()===Le.toLowerCase()),fr=ui.map(sn);ne(ui);const wi=(Ft?.rows??Ft?.data??[]).filter(Pn=>String(Ue(sn(Pn),["memberid","member_id","member_id_","id"])||"").trim().toLowerCase()===Le.toLowerCase());return{m:Xi,pays:Zi,gyms:fr,progs:wi}}try{let He;try{He=await ut()}catch{He=await pn()}if(!xe)return;if(He.m){d(He.m);const mt=String(Ue(He.m,["memberid","member_id","id"])||"").trim();de((He.pays||[]).map(sn).sort((Ot,Ft)=>{const Si=Hn(Ue(Ot,["date","paid_on","created","timestamp"]))||new Date(0);return(Hn(Ue(Ft,["date","paid_on","created","timestamp"]))||new Date(0))-Si})),X(He.gyms.map(Ot=>{const Ft=sn(Ot);return{date:Hn(Ue(Ft,["date"])),timeIn:Ue(Ft,["timein","time_in"]),timeOut:Ue(Ft,["timeout","time_out"]),totalHours:Ue(Ft,["totalhours","total_hours","hours"]),coach:Ue(Ft,["coach"]),focus:Ue(Ft,["focus"]),raw:Ot,memberId:String(Ue(Ft,["memberid","member_id","MemberID","id"])||"").trim()}}).filter(Ot=>!!Ot.date).sort((Ot,Ft)=>Ft.date-Ot.date)),M(He.progs.map(sn).sort((Ot,Ft)=>{const Si=Hn(Ue(Ot,["date","recorded","log_date","timestamp"]))||new Date(0);return(Hn(Ue(Ft,["date","recorded","log_date","timestamp"]))||new Date(0))-Si})),U(Aa((He.pays||[]).map(sn),He.m,He.pricingRows||[]))}else u||(d(null),O("Member not found"))}catch(He){xe&&!u&&O(He.message||"Failed to load member")}finally{xe&&v(!1)}})();const Be=Gn.on("member:updated",ve=>{try{const Oe=ve&&ve.request?ve.request:ve,Le=String(Ue(Oe||{},["MemberID","memberid","member_id","id"])||"").trim(),ut=decodeURIComponent(s||t||"").trim(),pn=String(Ue(u||{},["memberid","member_id","id"])||"").trim(),He=ut||pn;Le&&He&&Le.toLowerCase()===He.toLowerCase()&&setTimeout(()=>at(),120)}catch{}}),ct=Gn.on("gymEntry:added",ve=>{try{const Oe=String(Ue(g||{},["memberid","member_id","id"])||"").trim();if(!Oe)return;const Le=String(ve?.MemberID||ve?.memberid||ve?.Member||"").trim();Le&&Le===Oe&&at()}catch{}}),$e=Gn.on("payment:added",ve=>{try{const Oe=String(Ue(g||{},["memberid","member_id","id"])||"").trim();if(!Oe)return;const Le=ve&&ve.request?ve.request:ve,ut=ve&&ve.response?ve.response:null,pn=String(Le?.MemberID||Le?.memberid||ut?.MemberID||ut?.memberid||Le?.Member||ut?.Member||"").trim();pn&&pn===Oe&&setTimeout(()=>at(),120)}catch(Oe){console.debug("payment event handler error",Oe)}});return()=>{xe=!1;try{Be()}catch{}try{ct()}catch{}try{$e()}catch{}try{Ze.current&&(clearTimeout(Ze.current),Ze.current=null)}catch{}}},[s,t,u]),p)return f.jsx("div",{className:"content",children:f.jsx(jC,{})});if(!g)return f.jsxs("div",{className:"content",children:[f.jsx("button",{className:"back-btn",onClick:()=>a(-1),children:" Back"}),f.jsx("div",{children:C||"Member not found"})]});async function Xe(){S(!0);try{const xe=String(J||"").trim();if(!xe)return;console.debug("refreshBundle: fetching bundle for",xe);const[Be,ct]=await Promise.all([hE(xe,{ttlMs:0}),dE()]);console.debug("refreshBundle: fetched bundle",Be,ct);const $e=Be.member?sn(Be.member):null,ve=(Be.payments||[]).map(sn),Oe=(Be.gymEntries||[]).map(He=>He),Le=Oe.map(sn),ut=(Be.progress||[]).map(sn);$e&&d($e),ne(Oe),de(ve.sort((He,mt)=>{const Ot=Hn(Ue(He,["date","paid_on","created","timestamp"]))||new Date(0);return(Hn(Ue(mt,["date","paid_on","created","timestamp"]))||new Date(0))-Ot})),X(Le.map(He=>{const mt=sn(He);return{date:Hn(Ue(mt,["date"])),timeIn:Ue(mt,["timein","time_in"]),timeOut:Ue(mt,["timeout","time_out"]),totalHours:Ue(mt,["totalhours","total_hours","hours"]),coach:Ue(mt,["coach"]),focus:Ue(mt,["focus"]),raw:He,memberId:String(Ue(mt,["memberid","member_id","MemberID","id"])||"").trim()}}).filter(He=>!!He.date).sort((He,mt)=>mt.date-He.date)),M(ut.sort((He,mt)=>{const Ot=Hn(Ue(He,["date","recorded","log_date","timestamp"]))||new Date(0);return(Hn(Ue(mt,["date","recorded","log_date","timestamp"]))||new Date(0))-Ot}));const pn=(ct?.rows||ct?.data||[]).map(He=>He);U(Aa(ve,xe,pn))}catch(xe){console.error("refreshBundle failed",xe);try{O(String(xe?.message||xe||"Failed to refresh member data"))}catch{}}finally{S(!1)}}const Xt=new Intl.DateTimeFormat("en-CA",{timeZone:io,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date),lt=(z||[]).find(xe=>{try{const Be=xe?.date;if(!Be)return!1;const ct=new Date(Be);return new Intl.DateTimeFormat("en-CA",{timeZone:io,year:"numeric",month:"2-digit",day:"2-digit"}).format(ct)!==Xt?!1:Pe(xe)}catch{return!1}}),kn=(q||[]).find(xe=>{try{const Be=sn(xe||{}),ct=Ue(Be,["date","Date","log_date","date_time"]);if(!ct)return!1;const $e=new Date(ct);return new Intl.DateTimeFormat("en-CA",{timeZone:io,year:"numeric",month:"2-digit",day:"2-digit"}).format($e)!==Xt?!1:Pe(xe)}catch{return!1}})||null,Qt=!!lt||!!kn;return f.jsxs("div",{className:"content",children:[f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[f.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[f.jsx("button",{className:"back-btn",onClick:()=>a(-1),children:" Back"}),f.jsxs("div",{style:{display:"flex",gap:8},children:[f.jsx("button",{className:"back-btn",onClick:()=>{Ne("in"),Ce(!0)},disabled:!(!Qt&&P==="active"),title:Qt?"Member already has an open visit for today":P==="active"?"Check in":"Gym membership is not active",style:{opacity:!Qt&&P==="active"?1:.5,cursor:!Qt&&P==="active"?"pointer":"not-allowed"},children:"Check In"}),f.jsx("button",{className:"back-btn",onClick:()=>{Ne("out"),Ce(!0)},disabled:!Qt,title:Qt?"Member has an open visit today  checkout":"No open visit to check out",style:{opacity:Qt?1:.5,cursor:Qt?"pointer":"not-allowed"},children:"Check Out"})]})]})}),f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginTop:8,marginBottom:8},children:[f.jsx("h2",{style:{margin:0},children:Dn(df(g)||$||fe||"Member")}),f.jsx("div",{children:f.jsx(qf,{show:_&&!p})})]})]}),f.jsx(RL,{member:g,status:L,isRefreshing:_,onEdit:()=>Ee(!0),onAddPayment:()=>le(!0),onShowQr:()=>Me(!0),onShowProgress:()=>Ae(!0),onCheckIn:()=>{Ne("in"),Ce(!0)}}),f.jsx(YV,{open:K,onClose:()=>le(!1),memberId:J,onSaved:()=>{le(!1),Xe()},membershipEnd:L.membershipEnd,coachEnd:L.coachEnd,isStudent:V,birthDate:D}),f.jsx(rL,{open:we,onClose:()=>Ee(!1),member:g,onSaved:xe=>{Ee(!1);try{if(xe){const Be=sn(xe)||{},ct=Object.fromEntries(Object.entries(Be).filter(([$e,ve])=>ve!=null&&String(ve).trim()!==""));Object.keys(ct).length&&d($e=>({...$e||{},...ct}))}}catch(Be){console.debug("onSaved merge error",Be)}(async()=>{try{const Be=String(Ue(xe||g||{},["memberid","member_id","id","MemberID"])||"").trim();if(Be)try{const ct=await qL(Be);if(ct)try{const $e=sn(ct)||{},ve=Object.fromEntries(Object.entries($e).filter(([Oe,Le])=>Le!=null&&String(Le).trim()!==""));if(Object.keys(ve).length)d(Oe=>({...Oe||{},...ve}));else try{Xe()}catch{}}catch{try{Xe()}catch{}}}catch{try{Xe()}catch{}}else try{Xe()}catch{}}catch{try{Xe()}catch{}}})()}}),f.jsx(mL,{open:Se,onClose:()=>Me(!1),memberId:J,nickname:$||fe||"",firstName:fe||"",lastName:N||"",memberSince:Q||null,photo:B}),f.jsx(bL,{open:ke,onClose:()=>Ae(!1),memberId:J,memberNick:$||fe||"",memberSinceYMD:Q?`${Q.getFullYear()}-${String(Q.getMonth()+1).padStart(2,"0")}-${String(Q.getDate()).padStart(2,"0")}`:"",onSaved:()=>{Ae(!1),Xe()}}),f.jsx(EL,{open:De,onClose:()=>{ze(!1),St(-1)},row:We>=0?k[We]:null,memberNick:$||fe||""}),f.jsxs("div",{className:"panel",children:[f.jsx("div",{className:"panel-header",children:"Gym Visits"}),f.jsxs("table",{className:"aligned",children:[f.jsx("thead",{children:f.jsxs("tr",{children:[f.jsx("th",{children:"Date"}),f.jsx("th",{children:"Time In"}),f.jsx("th",{children:"Time Out"}),f.jsx("th",{children:"Total Hours"}),f.jsx("th",{children:"Coach"}),f.jsx("th",{children:"Focus"})]})}),f.jsx("tbody",{children:z.length===0?f.jsx("tr",{children:f.jsx("td",{colSpan:6,children:"-"})}):z.slice(0,Tt).map((xe,Be)=>f.jsxs("tr",{style:{cursor:"pointer"},onClick:()=>e(xe),children:[f.jsx("td",{children:ca(xe.date)}),f.jsx("td",{children:wu(xe.timeIn)}),f.jsx("td",{children:wu(xe.timeOut)}),f.jsx("td",{children:Dn(xe.totalHours)}),f.jsx("td",{children:Dn(xe.coach)}),f.jsx("td",{children:Dn(xe.focus)})]},Be))})]}),z.length>Tt&&f.jsx("div",{style:{textAlign:"center",marginTop:8},children:f.jsx("button",{className:"button",onClick:()=>wt(xe=>xe<z.length?Math.min(xe+10,z.length):10),children:Tt<z.length?`Load ${Math.min(10,z.length-Tt)} more`:"Show less"})})]}),n&&f.jsx(kv,{open:!!n,onClose:()=>e(null),row:n,onCheckout:xe=>{try{const Be=(q||[]).find(ct=>{try{const $e=sn(ct||{}),ve=Ue($e,["date","Date","log_date","date_time"]),Oe=Ue($e,["timein","TimeIn","time_in"]);if(!ve)return!1;const Le=new Date(ve),ut=new Date(xe?.date||xe?.Date||xe?.date_time||""),pn=new Intl.DateTimeFormat("en-CA",{timeZone:io,year:"numeric",month:"2-digit",day:"2-digit"}).format(Le),He=new Intl.DateTimeFormat("en-CA",{timeZone:io,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date(ut));if(pn!==He)return!1;if(Oe&&(xe?.timeIn||xe?.TimeIn)){const mt=String(Oe).trim(),Ot=String(xe.timeIn||xe.TimeIn||xe.timein||"").trim();if(mt&&Ot&&mt.indexOf(Ot)===-1&&Ot.indexOf(mt)===-1)return!1}return!0}catch{return!1}})||null;he(Be)}catch{he(null)}Ne("out"),Ce(!0)}}),f.jsx(Gf,{open:!!be,memberId:J,initialEntry:ae==="out"?G||kn:null,mode:ae,onClose:()=>{Ce(!1),Ne(null),he(null)},status:L,onSuccess:async()=>{Ce(!1),Ne(null),he(null);try{await at()}catch{}}}),z.length>200&&f.jsx("div",{style:{textAlign:"center",marginTop:8},children:f.jsx("button",{className:"button",onClick:()=>Te(xe=>!xe),children:oe?"Show less":`Show all (${z.length})`})}),f.jsxs("div",{className:"panel",children:[f.jsx("div",{className:"panel-header",children:"Progress"}),f.jsxs("table",{className:"aligned",children:[f.jsx("thead",{children:f.jsxs("tr",{children:[f.jsx("th",{children:"Date"}),f.jsx("th",{children:"No"}),f.jsx("th",{children:"Weight"}),f.jsx("th",{children:"BMI"}),f.jsx("th",{children:"Muscle Mass"}),f.jsx("th",{children:"Body Fat"})]})}),f.jsx("tbody",{children:k.length===0?f.jsx("tr",{children:f.jsx("td",{colSpan:6,children:"-"})}):k.slice(0,Bt).map((xe,Be)=>{const ct=Hn(Ue(xe,["date","recorded","log_date","timestamp"])),$e=Ue(xe,["no","entry_no","seq","number"]),ve=Ue(xe,["weight","weight_kg","weight_lbs","weight_(lbs)","weight_(kg)","weight(lbs)","weightkg","weightlbs"]),Oe=Ue(xe,["bmi"]),Le=Ue(xe,["musclemass","muscle_mass","muscle"]),ut=Ue(xe,["bodyfat","body_fat","bf"]);return f.jsxs("tr",{style:{cursor:"pointer"},onClick:()=>{St(Be),ze(!0)},children:[f.jsx("td",{children:ca(ct)}),f.jsx("td",{children:Dn($e)}),f.jsx("td",{children:Dn(ve)}),f.jsx("td",{children:Dn(Oe)}),f.jsx("td",{children:Dn(Le)}),f.jsx("td",{children:Dn(ut)})]},Be)})})]}),k.length>Bt&&f.jsx("div",{style:{textAlign:"center",marginTop:8},children:f.jsx("button",{className:"button",onClick:()=>Wt(xe=>xe<k.length?Math.min(xe+10,k.length):10),children:Bt<k.length?`Load ${Math.min(10,k.length-Bt)} more`:"Show less"})})]}),f.jsxs("div",{className:"panel",children:[f.jsx("div",{className:"panel-header",children:"Payments"}),f.jsxs("table",{className:"aligned payments-table",children:[f.jsx("thead",{children:f.jsxs("tr",{children:[f.jsx("th",{children:"Date"}),f.jsx("th",{children:"Particulars"}),f.jsxs("th",{children:["Gym Membership",f.jsx("br",{}),f.jsx("span",{className:"th-sub",children:"Valid Until"})]}),f.jsxs("th",{children:["Coach Subscription",f.jsx("br",{}),f.jsx("span",{className:"th-sub",children:"Valid Until"})]}),f.jsx("th",{children:"Mode"}),f.jsx("th",{children:"Cost"})]})}),f.jsx("tbody",{children:ee.length===0?f.jsx("tr",{children:f.jsx("td",{colSpan:6,children:"-"})}):ee.slice(0,un).map((xe,Be)=>{const ct=Hn(Ue(xe,["date","paid_on","created","timestamp"])),$e=Ue(xe,["particulars","type","item","category","product","paymentfor","plan","description"]),ve=Hn(Ue(xe,["gymvaliduntil","gym_valid_until","gym_until"])),Oe=Hn(Ue(xe,["coachvaliduntil","coach_valid_until","coach_until"])),Le=Ue(xe,["mode","payment_mode","method","via"]),ut=Ue(xe,["cost","amount","price","total","paid"]);return f.jsxs("tr",{children:[f.jsx("td",{children:ca(ct)}),f.jsx("td",{children:Dn($e)}),f.jsx("td",{children:ca(ve)}),f.jsx("td",{children:ca(Oe)}),f.jsx("td",{children:Dn(Le)}),f.jsx("td",{children:Dn(ut)})]},Be)})})]}),ee.length>un&&f.jsx("div",{style:{textAlign:"center",marginTop:8},children:f.jsx("button",{className:"button",onClick:()=>ci(xe=>xe<ee.length?Math.min(xe+10,ee.length):10),children:un<ee.length?`Load ${Math.min(10,ee.length-un)} more`:"Show less"})})]})]})}const WL=n=>String(n||"").trim().toLowerCase().replace(/\s+/g,"_"),XL=n=>Object.fromEntries(Object.entries(n||{}).map(([e,t])=>[WL(e),t])),ZL=(n,e)=>{try{const t=n||{};for(const s of e){if(Object.prototype.hasOwnProperty.call(t,s))return t[s];const a=Object.keys(t).find(l=>l.toLowerCase().replace(/\s+/g,"")===s.toLowerCase().replace(/\s+/g,""));if(a)return t[a]}}catch{}},fE=n=>{if(!n&&n!==0)return null;try{if(n&&typeof n.toDate=="function")return n.toDate()}catch{}if(n&&typeof n.seconds=="number")return new Date(n.seconds*1e3);if(n instanceof Date)return n;const e=new Date(n);return isNaN(e)?null:e},mE=n=>{try{const e=XL(n||{}),t=[e.timeout,e.time_out,e.timeOut,e.time_out_];for(const a of t)if(a&&String(a).trim()!==""&&(fE(a)||/\d/.test(String(a))))return!1;const s=String(n?.TimeOut||n?.Time_Out||n?.TimeOUT||n?.Timeout||"").trim();if(s){try{if(fE(s))return!1}catch{}if(/\d/.test(s))return!1}return!0}catch{return!0}},{fetchMembers:fp,fetchPayments:wd,fetchGymEntries:gE,fetchGymEntriesFresh:mp,fetchPricing:pE,fetchDashboard:JL,gymQuickAppend:H6}=kt;function Ed(){return new Date().toLocaleDateString("en-CA",{year:"numeric",month:"2-digit",day:"2-digit"})}const Mi=(n,e)=>ZL(n,e);function e4(){const[n,e]=T.useState({totalMembers:0,activeGym:0,activeCoach:0,visitedToday:0,coachToday:0,checkedIn:0,cashToday:0,gcashToday:0}),[t,s]=T.useState(!0),[a,l]=T.useState(!1),[u,g]=T.useState(!1),[d,p]=T.useState([]),[v,_]=T.useState([]),[S,C]=T.useState(0),[O,L]=T.useState([]),[U,z]=T.useState([]),[X,q]=T.useState(""),[ne,ee]=T.useState(!1),[de,k]=T.useState(!1),[M,P]=T.useState(!1),[x,A]=T.useState("Any"),V=()=>{const Ae=new Date;return Ae.setDate(Ae.getDate()-1),Ae.toLocaleDateString("en-CA",{year:"numeric",month:"2-digit",day:"2-digit"})},[N,fe]=T.useState(V()),[F,D]=T.useState(Ed()),[$,Q]=T.useState(null),[J,Y]=T.useState(!1),[I,B]=T.useState(null),[K,le]=T.useState(null),we=T.useMemo(()=>{const Ae=(O||[]).filter(De=>{const ze=De.Date||De.date;return(ze?new Date(ze).toLocaleDateString("en-CA",{year:"numeric",month:"2-digit",day:"2-digit"}):"")===Ed()});return Ae.sort((De,ze)=>{const G=String(Mi(De,["TimeOut","timeout","time_out"])||"").trim(),he=String(Mi(ze,["TimeOut","timeout","time_out"])||"").trim(),oe=G===""||G==="-"||G==="",Te=he===""||he==="-"||he==="";if(oe&&!Te)return-1;if(!oe&&Te)return 1;const be=String(Mi(De,["TimeIn","timein","time_in"])||"").trim(),Ce=String(Mi(ze,["TimeIn","timein","time_in"])||"").trim();return String(Ce).localeCompare(String(be))}),Ae.map((De,ze)=>{const G=String(Mi(De,["MemberID","memberid","member_id","member","id"])||"").trim(),he=(d||[]).find(ae=>String(Mi(ae,["MemberID","memberid","member_id","id"])||"").trim()===G),oe=Mi(De,["TimeIn","timein","time_in"])||"",Te=Mi(De,["TimeOut","timeout","time_out"])||"",be=String(Te).trim()===""||String(Te).trim()==="-"||String(Te).trim()==="",Ce=Mi(De,["TotalHours","totalhours","NoOfHours","noofhours","hours"])||"";return f.jsxs("tr",{style:{cursor:"pointer"},onClick:()=>Q(De),children:[f.jsx("td",{className:"td-fullname",style:{textAlign:"left"},children:f.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:8},children:[f.jsx("span",{children:df(he)}),be&&f.jsx("span",{className:"status-badge on",children:"On"})]})}),f.jsx("td",{children:wu(oe)}),f.jsx("td",{children:wu(Te)}),f.jsx("td",{children:Dn(Ce)}),f.jsx("td",{children:Dn(De.Coach||De.coach)}),f.jsx("td",{children:Dn(De.Focus||De.focus)})]},ze)})},[O,d]),Ee=(Ae,De,ze,G)=>{const he=new Map,oe=Pe=>{const Ze=String(Pe??"").trim().toLowerCase();return Ze==="yes"||Ze==="y"||Ze==="true"||Ze==="1"},Te=(Pe,Ze)=>{for(const at of Ze){if(Pe&&Object.prototype.hasOwnProperty.call(Pe,at))return Pe[at];const Xe=Object.keys(Pe||{}).find(Xt=>Xt.toLowerCase().replace(/\s+/g,"")===at.toLowerCase().replace(/\s+/g,""));if(Xe)return Pe[Xe]}};(G||[]).forEach(Pe=>{const Ze=String(Te(Pe,["Particulars"])||"").trim();if(!Ze)return;const at=oe(Te(Pe,["Gym membership","Gym Membership","GymMembership","Membership"])),Xe=oe(Te(Pe,["Coach subscription","Coach Subscription","CoachSubscription","Coach"]));he.set(Ze.toLowerCase(),{gym:at,coach:Xe})});const be=new Map;(De||[]).forEach(Pe=>{const Ze=String(Pe.MemberID||Pe.member_id||Pe.id||Pe.member||"").trim();Ze&&(be.has(Ze)||be.set(Ze,[]),be.get(Ze).push(Pe))});let Ce=0,ae=0;for(const Pe of Ae||[]){const Ze=String(Pe.MemberID||Pe.member_id||Pe.id||"").trim(),at=be.get(Ze)||[],Xe=Aa(at,Pe,G);if(Xe.membershipState!=="active")if((Pe.membershipState||Pe.membership_state||Pe.status||"").toLowerCase()==="active")Xe.membershipState="active";else{const lt=Te(Pe,["membershipEnd","membership_end","gymvaliduntil","gym_valid_until","gym_until","enddate","end_date","valid_until","expiry","expires","until","end","gym_valid","gym_validity","gymvalid"]);if(lt){const kn=new Date(lt);if(!isNaN(kn)){kn.setHours(0,0,0,0);const Qt=new Date;Qt.setHours(0,0,0,0),kn>=Qt&&(Xe.membershipState="active")}}}Xe.membershipState==="active"&&Ce++,Xe.coachActive&&ae++}const Ne=Ed(),We=(ze||[]).filter(Pe=>{const Ze=Pe.Date||Pe.date;return Ze?new Date(Ze).toLocaleDateString("en-CA",{year:"numeric",month:"2-digit",day:"2-digit"})===Ne:!1}),tn=new Set(We.map(Pe=>String(Pe.MemberID||Pe.member_id||Pe.id||"").trim()).filter(Boolean)).size,xt=new Set;for(const Pe of We){const Ze=String(Pe.Coach||Pe.coach||"").trim(),at=String(Pe.MemberID||Pe.member_id||Pe.id||"").trim();Ze&&at&&xt.add(`${at}::${Ze.toLowerCase()}`)}const Tt=xt.size,wt=new Set;for(const Pe of We){const Ze=String(Mi(Pe,["TimeIn","timein","time_in"])||"").trim(),at=String(Mi(Pe,["MemberID","memberid","member_id","id"])||"").trim(),Xe=!mE(Pe);Ze&&!Xe&&at&&wt.add(at)}const Bt=wt.size;let Wt=0,un=0,ci=0;for(const Pe of De||[]){const Ze=Pe.Date||Pe.date||Pe.pay_date;if(!Ze||new Date(Ze).toLocaleDateString("en-CA",{year:"numeric",month:"2-digit",day:"2-digit"})!==Ne)continue;const Xe=parseFloat(Pe.Cost||Pe.amount||0)||0;ci+=Xe;const Xt=String(Pe.Mode||Pe.mode||Pe.method||"").toLowerCase();Xt==="cash"&&(Wt+=Xe),Xt==="gcash"&&(un+=Xe)}return{totalMembers:(Ae||[]).length,activeGym:Ce,activeCoach:ae,visitedToday:tn,coachToday:Tt,checkedIn:Bt,cashToday:Wt,gcashToday:un,totalPaymentsToday:ci}},[Se,Me]=T.useMemo(()=>{const Ae=ae=>{if(ae===null||typeof ae>"u")return 0;if(typeof ae=="number")return ae;try{if(ae&&typeof ae.seconds=="number")return ae.seconds*1e3}catch{}try{const Ne=String(ae).trim(),We=Ne.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);if(We){const tn=String(We[1]).padStart(2,"0"),xt=String(We[2]).padStart(2,"0"),wt=`${We[3]}-${tn}-${xt}T00:00:00`,Bt=Date.parse(wt);if(!isNaN(Bt))return Bt}const St=Date.parse(Ne);return isNaN(St)?0:St}catch{return 0}},ze=(ae=>ae?ae==="Date"?["Date","date","pay_date"]:ae==="Created"?["created","timestamp","Timestamp"]:ae==="Any"?["Date","date","pay_date","created","timestamp","Timestamp"]:[ae]:["Date","date","pay_date","created","timestamp","Timestamp"])(x),G=ae=>{for(const Ne of ze)if(Object.prototype.hasOwnProperty.call(ae,Ne)&&ae[Ne]!==void 0&&ae[Ne]!==null)return ae[Ne];return ae.Date||ae.date||ae.pay_date||ae.created||ae.timestamp||null},he=N?new Date(N+"T00:00:00"):null,oe=F?new Date(F+"T23:59:59"):null,Te=(v||[]).filter(ae=>{const Ne=G(ae);if(!Ne&&Ne!==0)return!1;const We=Ae(Ne);if(!We)return!1;const St=new Date(We);return!(he&&St<he||oe&&St>oe)}).sort((ae,Ne)=>Ae(G(Ne))-Ae(G(ae)));let be=0;return[Te.map((ae,Ne)=>{const We=(d||[]).find(Bt=>{const Wt=String(ae.MemberID||ae.member_id||ae.id||ae.member||"").trim();return Wt?String(Bt.MemberID||Bt.member_id||Bt.id||"").trim()===Wt:!1}),St=ae.gymvaliduntil||ae.GymValidUntil||ae.gym_valid_until||ae.gym_until||ae.EndDate||ae.Enddate||ae.enddate||ae.end_date||ae.end||ae.valid_until||ae.expiry||ae.expires||ae.until||"",tn=ae.coachvaliduntil||ae.CoachValidUntil||ae.coach_valid_until||ae.coach_until||"",xt=ca(St),Tt=ca(tn),wt=parseFloat(ae.Cost||ae.amount||0)||0;return be+=wt,f.jsxs("tr",{children:[f.jsx("td",{children:df(We)}),f.jsx("td",{children:Dn(ae.Particulars||ae.particulars||ae.type||ae.item||ae.category||ae.product||ae.paymentfor||ae.plan||ae.description)}),f.jsx("td",{children:Dn(xt)}),f.jsx("td",{children:Dn(Tt)}),f.jsx("td",{children:Dn(ae.Mode||ae.mode||ae.method)}),f.jsx("td",{children:Dn((wt||0).toLocaleString())})]},Ne)}),be]},[v,d,x,N,F]);T.useEffect(()=>{C(Me||0)},[Me]),T.useEffect(()=>{async function Ae(){s(!0);try{const wt=await JL();if(wt&&wt.ok){const{totalMembers:Bt=0,activeGym:Wt=0,activeCoach:un=0,visitedToday:ci=0,coachToday:Pe=0,checkedIn:Ze=0,cashToday:at=0,gcashToday:Xe=0,totalPaymentsToday:Xt=0}=wt;e({totalMembers:Bt,activeGym:Wt,activeCoach:un,visitedToday:ci,coachToday:Pe,checkedIn:Ze,cashToday:at,gcashToday:Xe,totalPaymentsToday:Xt}),s(!1),(async()=>{l(!0);try{const lt=await Promise.allSettled([fp(),wd(),gE(),pE()]),kn=lt[0].status==="fulfilled"?lt[0].value:null,Qt=lt[1].status==="fulfilled"?lt[1].value:null,xe=lt[2].status==="fulfilled"?lt[2].value:null,Be=lt[3].status==="fulfilled"?lt[3].value:null;let ct=kn?.rows||kn||kn?.data||[],$e=Qt?.rows||Qt||Qt?.data||[];if(!$e||$e.length===0){const Le=lt[1];if(Le&&Le.status==="rejected")try{const ut=String(Le.reason||"");ut&&ut.toLowerCase().includes("missing firebase config")&&(console.warn("Firebase client not configured for this environment. Falling back to server reports."),q("Firebase client not configured for this environment. Falling back to server reports."))}catch{}}let ve=xe?.rows||xe||xe?.data||[],Oe=Be?.rows||Be||Be?.data||[];p(ct),ne||_($e),L(ve),z(Oe);try{const Le=Ee(kn?.rows||kn?.data||[],Qt?.rows||Qt?.data||[],xe?.rows||xe?.data||[],Be?.rows||Be?.data||[]);e(Le)}catch(Le){console.warn("Failed to recompute stats after background fetch",Le)}}catch{}finally{l(!1)}})();return}}catch{}l(!0);const[he,oe,Te,be]=await Promise.all([fp(),wd(),gE(),pE()]),Ce=he?.rows||he||he?.data||[],ae=oe?.rows||oe||oe?.data||[],Ne=Te?.rows||Te||Te?.data||[],We=be?.rows||be||be?.data||[];p(Ce),_(ae),L(Ne),z(We),l(!1);const St=Ce,tn=ae,xt=Ne,Tt=We;e(wt=>({...wt,totalMembers:St.length})),setTimeout(()=>{const wt=new Map,Bt=ve=>{const Oe=String(ve??"").trim().toLowerCase();return Oe==="yes"||Oe==="y"||Oe==="true"||Oe==="1"},Wt=(ve,Oe)=>{for(const Le of Oe){if(ve&&Object.prototype.hasOwnProperty.call(ve,Le))return ve[Le];const ut=Object.keys(ve||{}).find(pn=>pn.toLowerCase().replace(/\s+/g,"")===Le.toLowerCase().replace(/\s+/g,""));if(ut)return ve[ut]}};Tt.forEach(ve=>{const Oe=String(Wt(ve,["Particulars"])||"").trim();if(!Oe)return;const Le=Bt(Wt(ve,["Gym membership","Gym Membership","GymMembership","Membership"])),ut=Bt(Wt(ve,["Coach subscription","Coach Subscription","CoachSubscription","Coach"]));wt.set(Oe.toLowerCase(),{gym:Le,coach:ut})});const un=new Map;tn.forEach(ve=>{const Oe=String(ve.MemberID||ve.member_id||ve.id||ve.member||"").trim();Oe&&(un.has(Oe)||un.set(Oe,[]),un.get(Oe).push(ve))});let ci=0,Pe=0;for(const ve of St){const Oe=String(ve.MemberID||ve.member_id||ve.id||"").trim(),Le=un.get(Oe)||[],ut=Aa(Le,ve,Tt);if(ut.membershipState!=="active")if((ve.membershipState||ve.membership_state||ve.status||"").toLowerCase()==="active")ut.membershipState="active";else{const He=Wt(ve,["membershipEnd","membership_end","gymvaliduntil","gym_valid_until","gym_until","enddate","end_date","valid_until","expiry","expires","until","end","gym_valid","gym_validity","gymvalid"]);if(He){const mt=new Date(He);if(!isNaN(mt)){mt.setHours(0,0,0,0);const Ot=new Date;Ot.setHours(0,0,0,0),mt>=Ot&&(ut.membershipState="active")}}}ut.membershipState==="active"&&ci++,ut.coachActive&&Pe++}const Ze=Ed(),at=[];for(const ve of xt){const Oe=ve.Date||ve.date;if(!Oe)continue;new Date(Oe).toLocaleDateString("en-CA",{year:"numeric",month:"2-digit",day:"2-digit"})===Ze&&at.push(ve)}const Xt=new Set(at.map(ve=>String(ve.MemberID||ve.member_id||ve.id||"").trim()).filter(Boolean)).size,lt=new Set;for(const ve of at){const Oe=String(ve.Coach||ve.coach||"").trim(),Le=String(ve.MemberID||ve.member_id||ve.id||"").trim();Oe&&Le&&lt.add(`${Le}::${Oe.toLowerCase()}`)}const kn=lt.size,Qt=new Set;for(const ve of at){const Oe=String(Mi(ve,["TimeIn","timein","time_in"])||"").trim(),Le=String(Mi(ve,["MemberID","memberid","member_id","id"])||"").trim(),ut=!mE(ve);Oe&&!ut&&Le&&Qt.add(Le)}const xe=Qt.size;let Be=0,ct=0,$e=0;for(const ve of tn){const Oe=ve.Date||ve.date||ve.pay_date;if(!Oe||new Date(Oe).toLocaleDateString("en-CA",{year:"numeric",month:"2-digit",day:"2-digit"})!==Ze)continue;const ut=parseFloat(ve.Cost||ve.amount||0)||0;$e+=ut;const pn=String(ve.Mode||ve.mode||ve.method||"").toLowerCase();pn==="cash"&&(Be+=ut),pn==="gcash"&&(ct+=ut)}e({totalMembers:St.length,activeGym:ci,activeCoach:Pe,visitedToday:Xt,coachToday:kn,checkedIn:xe,cashToday:Be,gcashToday:ct,totalPaymentsToday:$e}),s(!1),g(!1)},20)}Ae();const De=Gn.on("gymEntry:added",async he=>{try{l(!0);const oe=await mp();L(oe?.rows||oe?.data||[]),l(!1)}catch{}}),ze=Gn.on("member:updated",async()=>{try{const he=await fp();p(he?.rows||he?.data||[])}catch{}}),G=setInterval(async()=>{try{const he=await mp();L(he?.rows||he?.data||[])}catch{}},15e3);return()=>{De(),ze(),clearInterval(G)}},[]),T.useEffect(()=>{let Ae=!0;return(async()=>{try{const De=await fetchPaymentsReport(N,F);if(!Ae)return;const ze=De?.rows||De||[];_(ze||[]),C(Number(De?.total||De?.total_amount||(ze||[]).reduce((G,he)=>G+(parseFloat(he.amount||he.Cost||0)||0),0))||0),ee(!0),q("")}catch{try{const ze=await wd();if(!Ae)return;const G=ze?.rows||ze||[];_(G||[]),C((G||[]).reduce((he,oe)=>he+(parseFloat(oe.amount||oe.Cost||0)||0),0)),ee(!1),q("")}catch(ze){q("Failed to load payments from server or Firebase: "+String(ze?.message||ze))}}})(),()=>{Ae=!1}},[N,F]),T.useEffect(()=>{let Ae=!0;return(async()=>{try{const De=await wd();if(!Ae)return;const ze=De?.rows||De||[];_(ze||[]),q("")}catch(De){q("Failed to load payments from Firebase: "+String(De?.message||De))}})(),()=>{Ae=!1}},[N,F]),T.useEffect(()=>{try{const Ae=Ee(d||[],v||[],O||[],U||[]);e(Ae)}catch(Ae){console.warn("Failed to recompute stats on data change",Ae)}},[d,v,O,U]);const ke=Ae=>{if(!Ae)return;const De=String(Ae.MemberID||Ae.member_id||Ae.id||Ae.member||"").trim();De&&(B(De),le(Ae||null),Y(!0),Q(null))};return f.jsxs("div",{className:"dashboard-content",children:[f.jsxs("h2",{className:"dashboard-title",children:["Daily Dashboard ",f.jsx(qf,{show:a&&!t})]}),X?f.jsx("div",{style:{padding:8,background:"#fff3cd",color:"#856404",border:"1px solid #ffeeba",borderRadius:6,marginBottom:12},children:X}):null,f.jsxs("div",{className:"dashboard-grid-3x3",children:[f.jsxs("div",{className:"dashboard-card",children:[f.jsx("div",{className:"dashboard-label",children:"Total Members"}),f.jsx("div",{className:"dashboard-value magenta",children:n.totalMembers})]}),f.jsxs("div",{className:"dashboard-card",children:[f.jsx("div",{className:"dashboard-label",children:"Active Gym Memberships"}),f.jsx("div",{className:"dashboard-value magenta",children:n.activeGym})]}),f.jsxs("div",{className:"dashboard-card",children:[f.jsx("div",{className:"dashboard-label",children:"Active Coach Subscriptions"}),f.jsx("div",{className:"dashboard-value magenta",children:n.activeCoach})]}),f.jsxs("div",{className:"dashboard-card",children:[f.jsx("div",{className:"dashboard-label",children:"Member Visits"}),f.jsx("div",{className:"dashboard-value magenta",children:n.visitedToday})]}),f.jsxs("div",{className:"dashboard-card",children:[f.jsx("div",{className:"dashboard-label",children:"Coaching Sessions"}),f.jsx("div",{className:"dashboard-value magenta",children:n.coachToday})]}),f.jsxs("div",{className:"dashboard-card",children:[f.jsx("div",{className:"dashboard-label",children:"Currently Checked-In"}),f.jsx("div",{className:"dashboard-value magenta",children:n.checkedIn})]}),f.jsxs("div",{className:"dashboard-card",children:[f.jsx("div",{className:"dashboard-label",children:"Cash Revenue"}),f.jsxs("div",{className:"dashboard-value magenta",children:[" ",n.cashToday.toLocaleString()]})]}),f.jsxs("div",{className:"dashboard-card",children:[f.jsx("div",{className:"dashboard-label",children:"GCash Revenue"}),f.jsxs("div",{className:"dashboard-value magenta",children:[" ",n.gcashToday.toLocaleString()]})]}),f.jsxs("div",{className:"dashboard-card",children:[f.jsx("div",{className:"dashboard-label",children:"Total Revenue"}),f.jsxs("div",{className:"dashboard-value magenta",children:[" ",(n.totalPaymentsToday||0).toLocaleString()]})]})]}),f.jsxs("div",{style:{marginTop:24},className:"panel",children:[f.jsx("div",{className:"panel-header",children:"Gym Entries Today"}),f.jsxs("table",{className:"aligned",children:[f.jsx("thead",{children:f.jsxs("tr",{children:[f.jsx("th",{children:"Nickname"}),f.jsx("th",{children:"Time In"}),f.jsx("th",{children:"Time Out"}),f.jsx("th",{children:"Total Hours"}),f.jsx("th",{children:"Coach"}),f.jsx("th",{children:"Focus"})]})}),f.jsx("tbody",{children:!we||Array.isArray(we)&&we.length===0?f.jsx("tr",{children:f.jsx("td",{colSpan:6,children:"-"})}):we})]})]}),f.jsx(kv,{open:!!$,onClose:()=>Q(null),row:$,onCheckout:Ae=>ke(Ae)}),f.jsx(Gf,{open:J,memberId:I,initialEntry:K,onClose:()=>{Y(!1),B(null),le(null)},onSuccess:async()=>{try{const Ae=await mp();L(Ae?.rows||Ae?.data||[])}catch(Ae){console.error(Ae)}Y(!1),B(null),le(null)}}),f.jsxs("div",{style:{marginTop:24},className:"panel",children:[f.jsxs("div",{className:"panel-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsx("div",{children:"Payments"}),f.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[f.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center"},children:[f.jsx("label",{style:{fontSize:12},children:"From"}),f.jsx("input",{className:"att-inline-select",style:{paddingRight:12},type:"date",value:N,onChange:Ae=>fe(Ae.target.value)})]}),f.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center"},children:[f.jsx("label",{style:{fontSize:12},children:"To"}),f.jsx("input",{className:"att-inline-select",style:{paddingRight:12},type:"date",value:F,onChange:Ae=>D(Ae.target.value)})]})]})]}),f.jsxs("div",{style:{padding:"8px 12px",fontWeight:600},children:["SUM:  ",(S||0).toLocaleString()]}),f.jsxs("table",{className:"aligned payments-table",children:[f.jsx("thead",{children:f.jsxs("tr",{children:[f.jsx("th",{children:"Nickname"}),f.jsx("th",{children:"Particulars"}),f.jsxs("th",{children:["Gym Membership",f.jsx("br",{}),"Valid Until"]}),f.jsxs("th",{children:["Coach Subscription",f.jsx("br",{}),"Valid Until"]}),f.jsx("th",{children:"Mode"}),f.jsx("th",{children:"Cost"})]})}),f.jsx("tbody",{children:!Se||Array.isArray(Se)&&Se.length===0?f.jsx("tr",{children:f.jsx("td",{colSpan:6,children:"-"})}):Se})]})]})]})}const t4="modulepreload",n4=function(n){return"/"+n},yE={},i4=function(e,t,s){let a=Promise.resolve();if(t&&t.length>0){let d=function(p){return Promise.all(p.map(v=>Promise.resolve(v).then(_=>({status:"fulfilled",value:_}),_=>({status:"rejected",reason:_}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),g=u?.nonce||u?.getAttribute("nonce");a=d(t.map(p=>{if(p=n4(p),p in yE)return;yE[p]=!0;const v=p.endsWith(".css"),_=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${_}`))return;const S=document.createElement("link");if(S.rel=v?"stylesheet":t4,v||(S.as="script"),S.crossOrigin="",S.href=p,g&&S.setAttribute("nonce",g),document.head.appendChild(S),v)return new Promise((C,O)=>{S.addEventListener("load",C),S.addEventListener("error",()=>O(new Error(`Unable to preload CSS for ${p}`)))})}))}function l(u){const g=new Event("vite:preloadError",{cancelable:!0});if(g.payload=u,window.dispatchEvent(g),!g.defaultPrevented)throw u}return a.then(u=>{for(const g of u||[])g.status==="rejected"&&l(g.reason);return e().catch(l)})};var gp={exports:{}},pp={};var vE;function r4(){if(vE)return pp;vE=1;var n=ff();function e(_,S){return _===S&&(_!==0||1/_===1/S)||_!==_&&S!==S}var t=typeof Object.is=="function"?Object.is:e,s=n.useState,a=n.useEffect,l=n.useLayoutEffect,u=n.useDebugValue;function g(_,S){var C=S(),O=s({inst:{value:C,getSnapshot:S}}),L=O[0].inst,U=O[1];return l(function(){L.value=C,L.getSnapshot=S,d(L)&&U({inst:L})},[_,C,S]),a(function(){return d(L)&&U({inst:L}),_(function(){d(L)&&U({inst:L})})},[_]),u(C),C}function d(_){var S=_.getSnapshot;_=_.value;try{var C=S();return!t(_,C)}catch{return!0}}function p(_,S){return S()}var v=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?p:g;return pp.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:v,pp}var _E;function s4(){return _E||(_E=1,gp.exports=r4()),gp.exports}var a4=s4();const PC=0,VC=1,LC=2,bE=3;var SE=Object.prototype.hasOwnProperty;function ay(n,e){var t,s;if(n===e)return!0;if(n&&e&&(t=n.constructor)===e.constructor){if(t===Date)return n.getTime()===e.getTime();if(t===RegExp)return n.toString()===e.toString();if(t===Array){if((s=n.length)===e.length)for(;s--&&ay(n[s],e[s]););return s===-1}if(!t||typeof n=="object"){s=0;for(t in n)if(SE.call(n,t)&&++s&&!SE.call(e,t)||!(t in e)||!ay(n[t],e[t]))return!1;return Object.keys(e).length===s}}return n!==n&&e!==e}const fs=new WeakMap,da=()=>{},ri=da(),oy=Object,At=n=>n===ri,Or=n=>typeof n=="function",Ca=(n,e)=>({...n,...e}),UC=n=>Or(n.then),yp={},Td={},Pv="undefined",Fu=typeof window!=Pv,ly=typeof document!=Pv,o4=Fu&&"Deno"in window,l4=()=>Fu&&typeof window.requestAnimationFrame!=Pv,zC=(n,e)=>{const t=fs.get(n);return[()=>!At(e)&&n.get(e)||yp,s=>{if(!At(e)){const a=n.get(e);e in Td||(Td[e]=a),t[5](e,Ca(a,s),a||yp)}},t[6],()=>!At(e)&&e in Td?Td[e]:!At(e)&&n.get(e)||yp]};let cy=!0;const c4=()=>cy,[uy,hy]=Fu&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[da,da],u4=()=>{const n=ly&&document.visibilityState;return At(n)||n!=="hidden"},h4=n=>(ly&&document.addEventListener("visibilitychange",n),uy("focus",n),()=>{ly&&document.removeEventListener("visibilitychange",n),hy("focus",n)}),d4=n=>{const e=()=>{cy=!0,n()},t=()=>{cy=!1};return uy("online",e),uy("offline",t),()=>{hy("online",e),hy("offline",t)}},f4={isOnline:c4,isVisible:u4},m4={initFocus:h4,initReconnect:d4},wE=!Ct.useId,Eu=!Fu||o4,g4=n=>l4()?window.requestAnimationFrame(n):setTimeout(n,1),vp=Eu?T.useEffect:T.useLayoutEffect,_p=typeof navigator<"u"&&navigator.connection,EE=!Eu&&_p&&(["slow-2g","2g"].includes(_p.effectiveType)||_p.saveData),Ad=new WeakMap,p4=n=>oy.prototype.toString.call(n),bp=(n,e)=>n===`[object ${e}]`;let y4=0;const dy=n=>{const e=typeof n,t=p4(n),s=bp(t,"Date"),a=bp(t,"RegExp"),l=bp(t,"Object");let u,g;if(oy(n)===n&&!s&&!a){if(u=Ad.get(n),u)return u;if(u=++y4+"~",Ad.set(n,u),Array.isArray(n)){for(u="@",g=0;g<n.length;g++)u+=dy(n[g])+",";Ad.set(n,u)}if(l){u="#";const d=oy.keys(n).sort();for(;!At(g=d.pop());)At(n[g])||(u+=g+":"+dy(n[g])+",");Ad.set(n,u)}}else u=s?n.toJSON():e=="symbol"?n.toString():e=="string"?JSON.stringify(n):""+n;return u},Vv=n=>{if(Or(n))try{n=n()}catch{n=""}const e=n;return n=typeof n=="string"?n:(Array.isArray(n)?n.length:n)?dy(n):"",[n,e]};let v4=0;const fy=()=>++v4;async function BC(...n){const[e,t,s,a]=n,l=Ca({populateCache:!0,throwOnError:!0},typeof a=="boolean"?{revalidate:a}:a||{});let u=l.populateCache;const g=l.rollbackOnError;let d=l.optimisticData;const p=S=>typeof g=="function"?g(S):g!==!1,v=l.throwOnError;if(Or(t)){const S=t,C=[],O=e.keys();for(const L of O)!/^\$(inf|sub)\$/.test(L)&&S(e.get(L)._k)&&C.push(L);return Promise.all(C.map(_))}return _(t);async function _(S){const[C]=Vv(S);if(!C)return;const[O,L]=zC(e,C),[U,z,X,q]=fs.get(e),ne=()=>{const fe=U[C];return(Or(l.revalidate)?l.revalidate(O().data,S):l.revalidate!==!1)&&(delete X[C],delete q[C],fe&&fe[0])?fe[0](LC).then(()=>O().data):O().data};if(n.length<3)return ne();let ee=s,de,k=!1;const M=fy();z[C]=[M,0];const P=!At(d),x=O(),A=x.data,V=x._c,N=At(V)?A:V;if(P&&(d=Or(d)?d(N,A):d,L({data:d,_c:N})),Or(ee))try{ee=ee(N)}catch(fe){de=fe,k=!0}if(ee&&UC(ee))if(ee=await ee.catch(fe=>{de=fe,k=!0}),M!==z[C][0]){if(k)throw de;return ee}else k&&P&&p(de)&&(u=!0,L({data:N,_c:ri}));if(u&&!k)if(Or(u)){const fe=u(ee,N);L({data:fe,error:ri,_c:ri})}else L({data:ee,error:ri,_c:ri});if(z[C][1]=fy(),Promise.resolve(ne()).then(()=>{L({_c:ri})}),k){if(v)throw de;return}return ee}}const TE=(n,e)=>{for(const t in n)n[t][0]&&n[t][0](e)},_4=(n,e)=>{if(!fs.has(n)){const t=Ca(m4,e),s=Object.create(null),a=BC.bind(ri,n);let l=da;const u=Object.create(null),g=(v,_)=>{const S=u[v]||[];return u[v]=S,S.push(_),()=>S.splice(S.indexOf(_),1)},d=(v,_,S)=>{n.set(v,_);const C=u[v];if(C)for(const O of C)O(_,S)},p=()=>{if(!fs.has(n)&&(fs.set(n,[s,Object.create(null),Object.create(null),Object.create(null),a,d,g]),!Eu)){const v=t.initFocus(setTimeout.bind(ri,TE.bind(ri,s,PC))),_=t.initReconnect(setTimeout.bind(ri,TE.bind(ri,s,VC)));l=()=>{v&&v(),_&&_(),fs.delete(n)}}};return p(),[n,a,p,l]}return[n,fs.get(n)[4]]},b4=(n,e,t,s,a)=>{const l=t.errorRetryCount,u=a.retryCount,g=~~((Math.random()+.5)*(1<<(u<8?u:8)))*t.errorRetryInterval;!At(l)&&u>l||setTimeout(s,g,a)},S4=ay,[FC,w4]=_4(new Map),E4=Ca({onLoadingSlow:da,onSuccess:da,onError:da,onErrorRetry:b4,onDiscarded:da,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:EE?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:EE?5e3:3e3,compare:S4,isPaused:()=>!1,cache:FC,mutate:w4,fallback:{}},f4),T4=(n,e)=>{const t=Ca(n,e);if(e){const{use:s,fallback:a}=n,{use:l,fallback:u}=e;s&&l&&(t.use=s.concat(l)),a&&u&&(t.fallback=Ca(a,u))}return t},A4=T.createContext({}),C4="$inf$",HC=Fu&&window.__SWR_DEVTOOLS_USE__,x4=HC?window.__SWR_DEVTOOLS_USE__:[],R4=()=>{HC&&(window.__SWR_DEVTOOLS_REACT__=Ct)},I4=n=>Or(n[1])?[n[0],n[1],n[2]||{}]:[n[0],null,(n[1]===null?n[2]:n[1])||{}],N4=()=>{const n=T.useContext(A4);return T.useMemo(()=>Ca(E4,n),[n])},D4=n=>(e,t,s)=>n(e,t&&((...l)=>{const[u]=Vv(e),[,,,g]=fs.get(FC);if(u.startsWith(C4))return t(...l);const d=g[u];return At(d)?t(...l):(delete g[u],d)}),s),M4=x4.concat(D4),O4=n=>function(...t){const s=N4(),[a,l,u]=I4(t),g=T4(s,u);let d=n;const{use:p}=g,v=(p||[]).concat(M4);for(let _=v.length;_--;)d=v[_](d);return d(a,l||g.fetcher||null,g)},j4=(n,e,t)=>{const s=e[n]||(e[n]=[]);return s.push(t),()=>{const a=s.indexOf(t);a>=0&&(s[a]=s[s.length-1],s.pop())}};R4();const Sp=Ct.use||(n=>{switch(n.status){case"pending":throw n;case"fulfilled":return n.value;case"rejected":throw n.reason;default:throw n.status="pending",n.then(e=>{n.status="fulfilled",n.value=e},e=>{n.status="rejected",n.reason=e}),n}}),wp={dedupe:!0},AE=Promise.resolve(ri),k4=(n,e,t)=>{const{cache:s,compare:a,suspense:l,fallbackData:u,revalidateOnMount:g,revalidateIfStale:d,refreshInterval:p,refreshWhenHidden:v,refreshWhenOffline:_,keepPreviousData:S}=t,[C,O,L,U]=fs.get(s),[z,X]=Vv(n),q=T.useRef(!1),ne=T.useRef(!1),ee=T.useRef(z),de=T.useRef(e),k=T.useRef(t),M=()=>k.current,P=()=>M().isVisible()&&M().isOnline(),[x,A,V,N]=zC(s,z),fe=T.useRef({}).current,F=At(u)?At(t.fallback)?ri:t.fallback[z]:u,D=(G,he)=>{for(const oe in fe){const Te=oe;if(Te==="data"){if(!a(G[Te],he[Te])&&(!At(G[Te])||!a(we,he[Te])))return!1}else if(he[Te]!==G[Te])return!1}return!0},$=T.useMemo(()=>{const G=!z||!e?!1:At(g)?M().isPaused()||l?!1:d!==!1:g,he=Ne=>{const We=Ca(Ne);return delete We._k,G?{isValidating:!0,isLoading:!0,...We}:We},oe=x(),Te=N(),be=he(oe),Ce=oe===Te?be:he(Te);let ae=be;return[()=>{const Ne=he(x());return D(Ne,ae)?(ae.data=Ne.data,ae.isLoading=Ne.isLoading,ae.isValidating=Ne.isValidating,ae.error=Ne.error,ae):(ae=Ne,Ne)},()=>Ce]},[s,z]),Q=a4.useSyncExternalStore(T.useCallback(G=>V(z,(he,oe)=>{D(oe,he)||G()}),[s,z]),$[0],$[1]),J=!q.current,Y=C[z]&&C[z].length>0,I=Q.data,B=At(I)?F&&UC(F)?Sp(F):F:I,K=Q.error,le=T.useRef(B),we=S?At(I)?At(le.current)?B:le.current:I:B,Ee=Y&&!At(K)?!1:J&&!At(g)?g:M().isPaused()?!1:l?At(B)?!1:d:At(B)||d,Se=!!(z&&e&&J&&Ee),Me=At(Q.isValidating)?Se:Q.isValidating,ke=At(Q.isLoading)?Se:Q.isLoading,Ae=T.useCallback(async G=>{const he=de.current;if(!z||!he||ne.current||M().isPaused())return!1;let oe,Te,be=!0;const Ce=G||{},ae=!L[z]||!Ce.dedupe,Ne=()=>wE?!ne.current&&z===ee.current&&q.current:z===ee.current,We={isValidating:!1,isLoading:!1},St=()=>{A(We)},tn=()=>{const Tt=L[z];Tt&&Tt[1]===Te&&delete L[z]},xt={isValidating:!0};At(x().data)&&(xt.isLoading=!0);try{if(ae&&(A(xt),t.loadingTimeout&&At(x().data)&&setTimeout(()=>{be&&Ne()&&M().onLoadingSlow(z,t)},t.loadingTimeout),L[z]=[he(X),fy()]),[oe,Te]=L[z],oe=await oe,ae&&setTimeout(tn,t.dedupingInterval),!L[z]||L[z][1]!==Te)return ae&&Ne()&&M().onDiscarded(z),!1;We.error=ri;const Tt=O[z];if(!At(Tt)&&(Te<=Tt[0]||Te<=Tt[1]||Tt[1]===0))return St(),ae&&Ne()&&M().onDiscarded(z),!1;const wt=x().data;We.data=a(wt,oe)?wt:oe,ae&&Ne()&&M().onSuccess(oe,z,t)}catch(Tt){tn();const wt=M(),{shouldRetryOnError:Bt}=wt;wt.isPaused()||(We.error=Tt,ae&&Ne()&&(wt.onError(Tt,z,wt),(Bt===!0||Or(Bt)&&Bt(Tt))&&(!M().revalidateOnFocus||!M().revalidateOnReconnect||P())&&wt.onErrorRetry(Tt,z,wt,Wt=>{const un=C[z];un&&un[0]&&un[0](bE,Wt)},{retryCount:(Ce.retryCount||0)+1,dedupe:!0})))}return be=!1,St(),!0},[z,s]),De=T.useCallback((...G)=>BC(s,ee.current,...G),[]);if(vp(()=>{de.current=e,k.current=t,At(I)||(le.current=I)}),vp(()=>{if(!z)return;const G=Ae.bind(ri,wp);let he=0;M().revalidateOnFocus&&(he=Date.now()+M().focusThrottleInterval);const Te=j4(z,C,(be,Ce={})=>{if(be==PC){const ae=Date.now();M().revalidateOnFocus&&ae>he&&P()&&(he=ae+M().focusThrottleInterval,G())}else if(be==VC)M().revalidateOnReconnect&&P()&&G();else{if(be==LC)return Ae();if(be==bE)return Ae(Ce)}});return ne.current=!1,ee.current=z,q.current=!0,A({_k:X}),Ee&&(L[z]||(At(B)||Eu?G():g4(G))),()=>{ne.current=!0,Te()}},[z]),vp(()=>{let G;function he(){const Te=Or(p)?p(x().data):p;Te&&G!==-1&&(G=setTimeout(oe,Te))}function oe(){!x().error&&(v||M().isVisible())&&(_||M().isOnline())?Ae(wp).then(he):he()}return he(),()=>{G&&(clearTimeout(G),G=-1)}},[p,v,_,z]),T.useDebugValue(we),l){const G=z&&At(B);if(!wE&&Eu&&G)throw new Error("Fallback data is required when using Suspense in SSR.");G&&(de.current=e,k.current=t,ne.current=!1);const he=U[z],oe=!At(he)&&G?De(he):AE;if(Sp(oe),!At(K)&&G)throw K;const Te=G?Ae(wp):AE;!At(we)&&G&&(Te.status="fulfilled",Te.value=!0),Sp(Te)}return{mutate:De,get data(){return fe.data=!0,we},get error(){return fe.error=!0,K},get isValidating(){return fe.isValidating=!0,Me},get isLoading(){return fe.isLoading=!0,ke}}},P4=O4(k4),Tu=typeof window<"u"?T.useLayoutEffect:T.useEffect;function CE(n){if(n!==void 0)switch(typeof n){case"number":return n;case"string":{if(n.endsWith("px"))return parseFloat(n);break}}}function V4({box:n,defaultHeight:e,defaultWidth:t,disabled:s,element:a,mode:l,style:u}){const{styleHeight:g,styleWidth:d}=T.useMemo(()=>({styleHeight:CE(u?.height),styleWidth:CE(u?.width)}),[u?.height,u?.width]),[p,v]=T.useState({height:e,width:t}),_=s||g!==void 0||l==="only-width"||g!==void 0&&d!==void 0;return Tu(()=>{if(a===null||_)return;const S=new ResizeObserver(C=>{for(const O of C){const{contentRect:L,target:U}=O;a===U&&v(z=>z.height===L.height&&z.width===L.width?z:{height:L.height,width:L.width})}});return S.observe(a,{box:n}),()=>{S?.unobserve(a)}},[n,_,a,g,d]),T.useMemo(()=>({height:g??p.height,width:d??p.width}),[p,g,d])}function L4(n){const e=T.useRef(()=>{throw new Error("Cannot call during render.")});return Tu(()=>{e.current=n},[n]),T.useCallback(t=>e.current?.(t),[e])}function Ep({containerElement:n,direction:e,isRtl:t,scrollOffset:s}){return s}function ya(n,e="Assertion error"){if(!n)throw console.error(e),Error(e)}function cu(n,e){if(n===e)return!0;if(!!n!=!!e||(ya(n!==void 0),ya(e!==void 0),Object.keys(n).length!==Object.keys(e).length))return!1;for(const t in n)if(!Object.is(e[t],n[t]))return!1;return!0}function qC({cachedBounds:n,itemCount:e,itemSize:t}){if(e===0)return 0;if(typeof t=="number")return e*t;{const s=n.get(n.size===0?0:n.size-1);ya(s!==void 0,"Unexpected bounds cache miss");const a=(s.scrollOffset+s.size)/n.size;return e*a}}function U4({align:n,cachedBounds:e,index:t,itemCount:s,itemSize:a,containerScrollOffset:l,containerSize:u}){if(t<0||t>=s)throw RangeError(`Invalid index specified: ${t}`,{cause:`Index ${t} is not within the range of 0 - ${s-1}`});const g=qC({cachedBounds:e,itemCount:s,itemSize:a}),d=e.get(t),p=Math.max(0,Math.min(g-u,d.scrollOffset)),v=Math.max(0,d.scrollOffset-u+d.size);switch(n==="smart"&&(l>=v&&l<=p?n="auto":n="center"),n){case"start":return p;case"end":return v;case"center":return d.scrollOffset<=u/2?0:d.scrollOffset+d.size/2>=g-u/2?g-u:d.scrollOffset+d.size/2-u/2;case"auto":default:return l>=v&&l<=p?l:l<v?v:p}}function xE({cachedBounds:n,containerScrollOffset:e,containerSize:t,itemCount:s,overscanCount:a}){const l=s-1;let u=0,g=-1,d=0,p=-1,v=0;for(;v<l;){const _=n.get(v);if(_.scrollOffset+_.size>e)break;v++}for(u=v,d=Math.max(0,u-a);v<l;){const _=n.get(v);if(_.scrollOffset+_.size>=e+t)break;v++}return g=Math.min(l,v),p=Math.min(s-1,g+a),u<0&&(u=0,g=-1,d=0,p=-1),{startIndexVisible:u,stopIndexVisible:g,startIndexOverscan:d,stopIndexOverscan:p}}function z4({itemCount:n,itemProps:e,itemSize:t}){const s=new Map;return{get(a){for(ya(a<n,`Invalid index ${a}`);s.size-1<a;){const u=s.size;let g;switch(typeof t){case"function":{g=t(u,e);break}case"number":{g=t;break}}if(u===0)s.set(u,{size:g,scrollOffset:0});else{const d=s.get(u-1);ya(d!==void 0,`Unexpected bounds cache miss for index ${a}`),s.set(u,{scrollOffset:d.scrollOffset+d.size,size:g})}}const l=s.get(a);return ya(l!==void 0,`Unexpected bounds cache miss for index ${a}`),l},set(a,l){s.set(a,l)},get size(){return s.size}}}function B4({itemCount:n,itemProps:e,itemSize:t}){return T.useMemo(()=>z4({itemCount:n,itemProps:e,itemSize:t}),[n,e,t])}function F4({containerSize:n,itemSize:e}){let t;switch(typeof e){case"string":{ya(e.endsWith("%"),`Invalid item size: "${e}"; string values must be percentages (e.g. "100%")`),ya(n!==void 0,"Container size must be defined if a percentage item size is specified"),t=n*parseInt(e)/100;break}default:{t=e;break}}return t}function H4({containerElement:n,containerStyle:e,defaultContainerSize:t=0,direction:s,isRtl:a=!1,itemCount:l,itemProps:u,itemSize:g,onResize:d,overscanCount:p}){const[v,_]=T.useState({startIndexVisible:0,startIndexOverscan:0,stopIndexVisible:-1,stopIndexOverscan:-1}),{startIndexVisible:S,startIndexOverscan:C,stopIndexVisible:O,stopIndexOverscan:L}={startIndexVisible:Math.min(l-1,v.startIndexVisible),startIndexOverscan:Math.min(l-1,v.startIndexOverscan),stopIndexVisible:Math.min(l-1,v.stopIndexVisible),stopIndexOverscan:Math.min(l-1,v.stopIndexOverscan)},{height:U=t,width:z=t}=V4({defaultHeight:t,defaultWidth:void 0,element:n,mode:"only-height",style:e}),X=T.useRef({height:0,width:0}),q=U,ne=F4({containerSize:q,itemSize:g});T.useLayoutEffect(()=>{if(typeof d=="function"){const x=X.current;(x.height!==U||x.width!==z)&&(d({height:U,width:z},{...x}),x.height=U,x.width=z)}},[U,d,z]);const ee=B4({itemCount:l,itemProps:u,itemSize:ne}),de=T.useCallback(x=>ee.get(x),[ee]),k=T.useCallback(()=>qC({cachedBounds:ee,itemCount:l,itemSize:ne}),[ee,l,ne]),M=T.useCallback(x=>{const A=Ep({containerElement:n,direction:s,isRtl:a,scrollOffset:x});return xE({cachedBounds:ee,containerScrollOffset:A,containerSize:q,itemCount:l,overscanCount:p})},[ee,n,q,s,a,l,p]);Tu(()=>{const x=n?.scrollTop??0;_(M(x))},[n,s,M]),Tu(()=>{if(!n)return;const x=()=>{_(A=>{const{scrollLeft:V,scrollTop:N}=n,fe=Ep({containerElement:n,direction:s,isRtl:a,scrollOffset:N}),F=xE({cachedBounds:ee,containerScrollOffset:fe,containerSize:q,itemCount:l,overscanCount:p});return cu(F,A)?A:F})};return n.addEventListener("scroll",x),()=>{n.removeEventListener("scroll",x)}},[ee,n,q,s,l,p]);const P=L4(({align:x="auto",containerScrollOffset:A,index:V})=>{let N=U4({align:x,cachedBounds:ee,containerScrollOffset:A,containerSize:q,index:V,itemCount:l,itemSize:ne});if(n){if(N=Ep({containerElement:n,direction:s,isRtl:a,scrollOffset:N}),typeof n.scrollTo!="function"){const fe=M(N);cu(v,fe)||_(fe)}return N}});return{getCellBounds:de,getEstimatedSize:k,scrollToIndex:P,startIndexOverscan:C,startIndexVisible:S,stopIndexOverscan:L,stopIndexVisible:O}}function q4(n){return T.useMemo(()=>n,Object.values(n))}function G4(n,e){const{ariaAttributes:t,style:s,...a}=n,{ariaAttributes:l,style:u,...g}=e;return cu(t,l)&&cu(s,u)&&cu(a,g)}function $4(n){return n!=null&&typeof n=="object"&&"getAverageRowHeight"in n&&typeof n.getAverageRowHeight=="function"}const Q4="data-react-window-index";function Y4({children:n,className:e,defaultHeight:t=0,listRef:s,onResize:a,onRowsRendered:l,overscanCount:u=3,rowComponent:g,rowCount:d,rowHeight:p,rowProps:v,tagName:_="div",style:S,...C}){const O=q4(v),L=T.useMemo(()=>T.memo(g,G4),[g]),[U,z]=T.useState(null),X=$4(p),q=T.useMemo(()=>X?N=>p.getRowHeight(N)??p.getAverageRowHeight():p,[X,p]),{getCellBounds:ne,getEstimatedSize:ee,scrollToIndex:de,startIndexOverscan:k,startIndexVisible:M,stopIndexOverscan:P,stopIndexVisible:x}=H4({containerElement:U,containerStyle:S,defaultContainerSize:t,direction:"vertical",itemCount:d,itemProps:O,itemSize:q,onResize:a,overscanCount:u});T.useImperativeHandle(s,()=>({get element(){return U},scrollToRow({align:N="auto",behavior:fe="auto",index:F}){const D=de({align:N,containerScrollOffset:U?.scrollTop??0,index:F});typeof U?.scrollTo=="function"&&U.scrollTo({behavior:fe,top:D})}}),[U,de]),Tu(()=>{if(!U)return;const N=Array.from(U.children).filter((fe,F)=>{if(fe.hasAttribute("aria-hidden"))return!1;const D=`${k+F}`;return fe.setAttribute(Q4,D),!0});if(X)return p.observeRowElements(N)},[U,X,p,k,P]),T.useEffect(()=>{k>=0&&P>=0&&l&&l({startIndex:M,stopIndex:x},{startIndex:k,stopIndex:P})},[l,k,M,P,x]);const A=T.useMemo(()=>{const N=[];if(d>0)for(let fe=k;fe<=P;fe++){const F=ne(fe);N.push(T.createElement(L,{...O,ariaAttributes:{"aria-posinset":fe+1,"aria-setsize":d,role:"listitem"},key:fe,index:fe,style:{position:"absolute",left:0,transform:`translateY(${F.scrollOffset}px)`,height:X?void 0:F.size,width:"100%"}}))}return N},[L,ne,X,d,O,k,P]),V=f.jsx("div",{"aria-hidden":!0,style:{height:ee(),width:"100%",zIndex:-1}});return T.createElement(_,{role:"list",...C,className:e,ref:z,style:{position:"relative",maxHeight:"100%",flexGrow:1,overflowY:"auto",...S}},A,n,V)}const my=(n,e)=>e.some(t=>n instanceof t);let RE,IE;function K4(){return RE||(RE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function W4(){return IE||(IE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const gy=new WeakMap,Tp=new WeakMap,$f=new WeakMap;function X4(n){const e=new Promise((t,s)=>{const a=()=>{n.removeEventListener("success",l),n.removeEventListener("error",u)},l=()=>{t(co(n.result)),a()},u=()=>{s(n.error),a()};n.addEventListener("success",l),n.addEventListener("error",u)});return $f.set(e,n),e}function Z4(n){if(gy.has(n))return;const e=new Promise((t,s)=>{const a=()=>{n.removeEventListener("complete",l),n.removeEventListener("error",u),n.removeEventListener("abort",u)},l=()=>{t(),a()},u=()=>{s(n.error||new DOMException("AbortError","AbortError")),a()};n.addEventListener("complete",l),n.addEventListener("error",u),n.addEventListener("abort",u)});gy.set(n,e)}let py={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return gy.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return co(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function GC(n){py=n(py)}function J4(n){return W4().includes(n)?function(...e){return n.apply(yy(this),e),co(this.request)}:function(...e){return co(n.apply(yy(this),e))}}function e6(n){return typeof n=="function"?J4(n):(n instanceof IDBTransaction&&Z4(n),my(n,K4())?new Proxy(n,py):n)}function co(n){if(n instanceof IDBRequest)return X4(n);if(Tp.has(n))return Tp.get(n);const e=e6(n);return e!==n&&(Tp.set(n,e),$f.set(e,n)),e}const yy=n=>$f.get(n);function t6(n,e,{blocked:t,upgrade:s,blocking:a,terminated:l}={}){const u=indexedDB.open(n,e),g=co(u);return s&&u.addEventListener("upgradeneeded",d=>{s(co(u.result),d.oldVersion,d.newVersion,co(u.transaction),d)}),t&&u.addEventListener("blocked",d=>t(d.oldVersion,d.newVersion,d)),g.then(d=>{l&&d.addEventListener("close",()=>l()),a&&d.addEventListener("versionchange",p=>a(p.oldVersion,p.newVersion,p))}).catch(()=>{}),g}const n6=["get","getKey","getAll","getAllKeys","count"],i6=["put","add","delete","clear"],Ap=new Map;function NE(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Ap.get(e))return Ap.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,a=i6.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(a||n6.includes(t)))return;const l=async function(u,...g){const d=this.transaction(u,a?"readwrite":"readonly");let p=d.store;return s&&(p=p.index(g.shift())),(await Promise.all([p[t](...g),a&&d.done]))[0]};return Ap.set(e,l),l}GC(n=>({...n,get:(e,t,s)=>NE(e,t)||n.get(e,t,s),has:(e,t)=>!!NE(e,t)||n.has(e,t)}));const r6=["continue","continuePrimaryKey","advance"],DE={},vy=new WeakMap,$C=new WeakMap,s6={get(n,e){if(!r6.includes(e))return n[e];let t=DE[e];return t||(t=DE[e]=function(...s){vy.set(this,$C.get(this)[e](...s))}),t}};async function*a6(...n){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...n)),!e)return;e=e;const t=new Proxy(e,s6);for($C.set(t,e),$f.set(t,yy(e));e;)yield t,e=await(vy.get(t)||e.continue()),vy.delete(t)}function ME(n,e){return e===Symbol.asyncIterator&&my(n,[IDBIndex,IDBObjectStore,IDBCursor])||e==="iterate"&&my(n,[IDBIndex,IDBObjectStore])}GC(n=>({...n,get(e,t,s){return ME(e,t)?a6:n.get(e,t,s)},has(e,t){return ME(e,t)||n.has(e,t)}}));const o6="kusgan-local-cache",l6=1,Au="kv",Lv="state",Cp="__kusgan_sync_lock__";let jt={members:[],attendance:[],payments:[],gymEntries:[],progress:[],queue:[]},xp=null;function Uv(){return xp||(xp=t6(o6,l6,{upgrade(n){n.objectStoreNames.contains(Au)||n.createObjectStore(Au)}})),xp}async function c6(){try{const e=await(await Uv()).get(Au,Lv);e&&typeof e=="object"&&(jt=Object.assign(jt,e),jt.members||(jt.members=[]),jt.attendance||(jt.attendance=[]),jt.queue||(jt.queue=[]),jt.payments||(jt.payments=[]),jt.gymEntries||(jt.gymEntries=[]),jt.progress||(jt.progress=[]))}catch(n){console.warn("localCache: failed to load from idb",n&&n.message)}}async function Qf(n){try{await(await Uv()).put(Au,n,Lv)}catch(e){console.warn("localCache: failed to write to idb",e&&e.message)}}function _o(){return jt||(jt={members:[],attendance:[],payments:[],gymEntries:[],progress:[],queue:[]}),jt.members||(jt.members=[]),jt.attendance||(jt.attendance=[]),jt.queue||(jt.queue=[]),jt.payments||(jt.payments=[]),jt.gymEntries||(jt.gymEntries=[]),jt.progress||(jt.progress=[]),jt}c6();function u6(n){return _o()[n]||[]}function h6(n,e){const t=_o();t[n]=Array.isArray(e)?e:[],Qf(t).catch(()=>{})}function d6(n){const e=_o();e.queue.unshift(n),Qf(e).catch(()=>{})}function QC(n){d6({id:"q-"+Date.now()+"-"+Math.floor(Math.random()*1e3),...n}),zv()}function f6(n){const t=new Date().toISOString(),s=t.slice(0,10),a=t.slice(11,16),l="local-"+Date.now(),u={id:l,Staff:n,staff_name:n,Date:s,TimeIn:a,time_in:t,status:"On Duty",_localPending:!0},g=_o();return g.attendance=[u,...g.attendance||[]],Qf(g).catch(()=>{}),QC({method:"POST",path:"/attendance/kiosk",body:{staff_name:n},tempId:l,collection:"attendance"}),u}async function m6(n){try{const e=lu&&typeof lu=="function"?lu():null,t={"Content-Type":"application/json"};e&&(t.Authorization=`Bearer ${e}`);const s=await fetch(n.path,{method:n.method||"POST",headers:t,body:JSON.stringify(n.body||{})}),a=await s.json().catch(()=>({}));if(!s.ok)throw new Error(a&&a.error?a.error:"Request failed");return{ok:!0,json:a}}catch(e){return{ok:!1,error:String(e&&e.message||e)}}}async function zv(){if(!window[Cp]){window[Cp]=!0;try{let n=_o();for(;(n.queue||[]).length;){const e=n.queue[n.queue.length-1];if(!e)break;const t=await m6(e);if(t.ok){if(n=_o(),n.queue=(n.queue||[]).filter(s=>s.id!==e.id),e.collection==="attendance"&&e.tempId)try{const s=t.json&&(t.json.row||t.json);s&&(n.attendance=(n.attendance||[]).map(a=>a.id===e.tempId?s:a))}catch{}if(e.collection==="members"&&e.tempId)try{const s=t.json&&(t.json.row||t.json);s&&(n.members=(n.members||[]).map(a=>a.id===e.tempId?s:a))}catch{}Qf(n).catch(()=>{})}else break}}finally{window[Cp]=!1}}}window.addEventListener&&window.addEventListener("online",()=>{zv()});async function g6(){try{jt={members:[],attendance:[],payments:[],gymEntries:[],progress:[],queue:[]},await(await Uv()).delete(Au,Lv)}catch(n){console.warn("localCache.clearCache failed",n&&n.message)}}_o();const hs={getCached:u6,setCached:h6,addOptimisticAttendance:f6,enqueueWrite:QC,processQueue:zv,clearCache:g6},p6=Ct.lazy(()=>i4(()=>import("./AddMemberModal-BOcf0rWP.js"),[])),bn={members:null,payments:null,gymEntries:null,ts:{members:0,payments:0,gymEntries:0}},_y="kusgan.members.cache.v1",y6=1e3*60*60;function v6(){try{if(typeof window>"u"||!window.localStorage)return;const n=window.localStorage.getItem(_y);if(!n)return;const e=JSON.parse(n);if(!e||!e.ts||Date.now()-(e.ts.members||0)>y6)return;bn.members=e.members||null,bn.payments=e.payments||null,bn.gymEntries=e.gymEntries||null,bn.ts=e.ts||bn.ts}catch(n){console.debug("Members: failed to load cache from localStorage",n)}}function _6(){try{if(typeof window>"u"||!window.localStorage)return;const n={members:bn.members,payments:bn.payments,gymEntries:bn.gymEntries,ts:bn.ts};typeof window.requestIdleCallback=="function"?window.requestIdleCallback(()=>{try{window.localStorage.setItem(_y,JSON.stringify(n))}catch(e){console.debug("Members: failed to save cache to localStorage",e)}},{timeout:2e3}):setTimeout(()=>{try{window.localStorage.setItem(_y,JSON.stringify(n))}catch(e){console.debug("Members: failed to save cache to localStorage",e)}},0)}catch(n){console.debug("Members: failed to save cache to localStorage",n)}}try{v6()}catch{}const b6=n=>String(n||"").trim().toLowerCase().replace(/\s+/g,"_"),OE=n=>["yes","y","true","1"].includes(String(n||"").trim().toLowerCase()),Ln=(n,e)=>e.map(t=>n[t]).find(t=>t!==void 0&&t!==""),ua=n=>{if(n instanceof Date)return n;const e=new Date(n);return isNaN(e)?null:e},S6=(n,e)=>n&&e&&n.getFullYear()===e.getFullYear()&&n.getMonth()===e.getMonth()&&n.getDate()===e.getDate(),uu=n=>{const e={};return Object.entries(n||{}).forEach(([t,s])=>{e[b6(t)]=s}),e},jE=n=>{if(!n)return null;let t=ua(Ln(n,["member_since","membersince","member_date","memberdate","createdat","created_at","created","join_date","joined","start_date","memberdateexcel","membersinceexcel"]));if(t)return t;try{const s=n._raw||n;if(t=Ln(s,["MemberSince","Member Since","MemberDate","Member Date","createdAt","created_at","Created","Joined","Join Date","start_date"]),t)return ua(t)}catch{}return null},kE=n=>String(n||"").toLowerCase().replace(/(?:^|[\s\-])([a-z])/g,(t,s)=>t.replace(s,s.toUpperCase())),ia=n=>n?`${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][n.getMonth()]}-${n.getDate()}, ${n.getFullYear()}`:"",Cd=n=>{if(!n)return!1;const e=n instanceof Date?new Date(n):new Date(n);if(isNaN(e))return!1;const t=new Date;return t.setHours(0,0,0,0),e.setHours(0,0,0,0),e>=t};function PE(n){const e=new Map;for(const s of n){const a=uu(s),l=Ln(a,["memberid","member_id","id","member_id_"]);l&&(e.has(l)||e.set(l,[]),e.get(l).push(s))}const t=new Map;for(const[s,a]of e){const l=Aa(a);t.set(s,{membershipEnd:l.membershipEnd||null,coachEnd:l.coachEnd||null,membershipState:l.membershipState||null,coachActive:!!l.coachActive})}return t}function VE(n){const e=new Map;for(const t of n){const s=uu(t),a=Ln(s,["memberid","member_id","id","member_id_"]);if(!a)continue;const l=ua(Ln(s,["date","visit_date","entry_date","log_date","timestamp","checkin"]));if(!l)continue;const u=e.get(a);(!u||l>u)&&e.set(a,l)}return e}function w6(){const n=Ll(),[e]=T.useState(Number.POSITIVE_INFINITY),[t,s]=T.useState([]),[a,l]=T.useState(new Map),[u,g]=T.useState(new Map),[d,p]=T.useState(!0),[v,_]=T.useState(!1),[S,C]=T.useState(""),[O,L]=T.useState(""),[U,z]=T.useState(""),[X,q]=T.useState(!1),ne=T.useRef(null),[ee,de]=T.useState(!1),k=T.useRef(null),[M,P]=T.useState(600);T.useEffect(()=>{function Q(){try{const J=window.innerHeight||800,I=Math.max(300,J-220);P(I)}catch{P(600)}}return Q(),window.addEventListener("resize",Q),()=>window.removeEventListener("resize",Q)},[]);const x=async()=>{const[J,Y,I]=await Promise.all([kt.fetchMembersRecent({days:5}),kt.fetchPayments(),kt.fetchGymEntries()]);return{members:(J?.rows??J?.data??[]).map(uu),payments:Y?.rows??Y?.data??[],gymEntries:I?.rows??I?.data??[]}},{data:A,error:V,isLoading:N,isValidating:fe,mutate:F}=P4("members:recent",x,{revalidateOnFocus:!0,dedupingInterval:2e3,fallbackData:bn.members?{members:bn.members,payments:bn.payments,gymEntries:bn.gymEntries}:void 0});T.useEffect(()=>{if(A)try{s(A.members||[]),l(PE(A.payments||[])),g(VE(A.gymEntries||[])),bn.members=A.members||[],bn.payments=A.payments||[],bn.gymEntries=A.gymEntries||[],bn.ts=bn.ts||{},bn.ts.members=Date.now(),bn.ts.payments=Date.now(),bn.ts.gymEntries=Date.now(),_6()}catch(Q){console.error("Members: failed to hydrate from SWR data",Q)}},[A]),T.useEffect(()=>{try{const Q=hs.getCached("members")||[];Q&&Q.length&&s(J=>J&&J.length?J:Q.map(uu))}catch{}},[]),T.useEffect(()=>{let Q=!1;async function J(){if(U){p(!0);try{const[Y,I,B]=await Promise.all([kt.searchMembersByName(U),kt.fetchPayments(),kt.fetchGymEntries()]);if(Q)return;const K=(Y?.rows??[]).map(uu);s(K),l(PE(I?.rows||[])),g(VE(B?.rows||[]))}catch(Y){Q||C(Y?.message||String(Y))}finally{Q||p(!1)}}}return U&&J(),()=>{Q=!0}},[U]),T.useEffect(()=>{p(!!N),_(!!N),V&&C(V.message||String(V))},[N,V]),T.useEffect(()=>(ne.current&&clearTimeout(ne.current),ne.current=setTimeout(()=>z(O.trim()),250),()=>{ne.current&&clearTimeout(ne.current)}),[O]);const D=T.useMemo(()=>{const Q=U.trim().toLowerCase();let J=t;Q&&(J=t.filter(B=>["first_name","firstname","last_name","lastname","nick_name","nickname","mobile","email"].some(K=>String(B[K]??"").toLowerCase().includes(Q))));const Y=new Date,I=J.map(B=>{const K=Ln(B,["memberid","member_id","id","member_id_"]),le=K?u.get(K):null,we=le?S6(le,Y):!1,Ee=ua(Ln(B,["member_since","membersince","member_date","memberdate","member_date","createdat","created_at","join_date","joined","start_date"])),Se=Ee?Ee.getTime():0,Me=le?le.getTime():-1;return{r:B,lastVisit:le,isToday:we,joinTs:Se,visitTs:Me,memberId:K}});return I.sort((B,K)=>K.joinTs-B.joinTs||K.visitTs-B.visitTs),I},[t,U,u]);return T.useCallback((Q,J)=>{Q&&n(`/members/${encodeURIComponent(Q)}`,{state:{row:J}})},[n]),f.jsxs("div",{className:"content",ref:k,style:{minHeight:"calc(100vh - 120px)",display:"flex",flexDirection:"column"},children:[f.jsxs("h2",{className:"dashboard-title",children:["All Members ",f.jsx(qf,{show:fe&&!N})]}),f.jsxs("div",{className:"toolbar",style:{display:"flex",justifyContent:"center",alignItems:"center",gap:12,marginBottom:12},children:[f.jsx("input",{className:"search-wide",style:{width:"60%",maxWidth:960,minWidth:320},placeholder:"Search members by name",value:O,onChange:Q=>L(Q.target.value)}),f.jsx("button",{className:"button",onClick:()=>de(!0),children:"+ Add Member"})]}),d&&f.jsx("div",{style:{color:"var(--muted)",textAlign:"center",padding:16},children:"Loading"}),S&&f.jsxs("div",{children:["Error: ",S]}),!d&&!S&&f.jsxs("div",{className:"panel",style:{flex:1,display:"flex",flexDirection:"column"},children:[t.length===0&&f.jsxs("div",{style:{padding:24,textAlign:"center",color:"#b91c1c",fontWeight:600},children:["No member data loaded.",f.jsx("br",{}),"Please check your API connection or try again later."]}),f.jsx("div",{style:{width:"100%"},children:D.length===0?f.jsx("div",{style:{padding:12},children:"No members found."}):D.length<=120?f.jsx("div",{className:"members-list-wrapper",style:{display:"flex",justifyContent:"center"},children:f.jsxs("table",{className:"attendance-table aligned",style:{width:"100%"},children:[f.jsxs("colgroup",{children:[f.jsx("col",{style:{width:"15%"}}),f.jsx("col",{style:{width:"25%"}}),f.jsx("col",{style:{width:"15%"}}),f.jsx("col",{style:{width:"15%"}}),f.jsx("col",{style:{width:"15%"}}),f.jsx("col",{style:{width:"15%"}})]}),f.jsx("thead",{children:f.jsxs("tr",{children:[f.jsx("th",{style:{textAlign:"center"},children:"Nick Name"}),f.jsx("th",{style:{textAlign:"center"},children:"Full Name"}),f.jsx("th",{style:{textAlign:"center"},children:"Member Since"}),f.jsx("th",{style:{textAlign:"center"},children:"Last Gym Visit"}),f.jsx("th",{style:{textAlign:"center"},children:"Gym Valid Until"}),f.jsx("th",{style:{textAlign:"center"},children:"Coach Valid Until"})]})}),f.jsx("tbody",{children:D.map(({r:Q,lastVisit:J,isToday:Y,memberId:I},B)=>{const K=I?a.get(I):void 0,le=OE(Ln(Q,["student","is_student","student?"]));let we=Number(Ln(Q,["age","years_old"]));if(isNaN(we)){const he=Ln(Q,["birthday","birth_date","dob"]),oe=ua(he);if(oe){const Te=new Date;we=Te.getFullYear()-oe.getFullYear()-(Te.getMonth()<oe.getMonth()||Te.getMonth()===oe.getMonth()&&Te.getDate()<oe.getDate()?1:0)}}const Ee=!isNaN(we)&&we>=60,Se=String(Ln(Q,["first_name","firstname","first","given_name"])??""),Me=String(Ln(Q,["last_name","lastname","last","surname"])??""),ke=[Se,Me].filter(Boolean).map(kE).join(" "),Ae=String(Q.nick_name??Q.nickname??"").toUpperCase(),De=jE(Q)||ua(Ln(Q,["member_since","membersince","member_date","memberdate","member_date","createdat","created_at","join_date","joined","start_date"])),ze=K?.membershipEnd||null,G=K?.coachEnd||null;return f.jsxs("tr",{className:"row-link",onClick:()=>n(`/members/${encodeURIComponent(I)}`,{state:{row:Q}}),style:{cursor:"pointer"},children:[f.jsx("td",{style:{textAlign:"center"},children:f.jsx("strong",{children:Ae})}),f.jsxs("td",{style:{textAlign:"left"},children:[ke," ",f.jsxs("span",{style:{display:"inline-flex",gap:6,marginLeft:8},children:[le&&f.jsx("span",{className:"pill student",children:"Student"}),Ee&&f.jsx("span",{className:"pill senior",children:"Senior"})]})]}),f.jsx("td",{style:{textAlign:"center"},children:ia(De)}),f.jsx("td",{style:{textAlign:"center"},children:Y?f.jsx("span",{className:"pill ok",children:"Visited today"}):J?ia(new Date(J)):""}),f.jsx("td",{style:{textAlign:"center",color:ze?Cd(ze)?"green":"red":"inherit"},children:ze?ia(new Date(ze)):""}),f.jsx("td",{style:{textAlign:"center",color:G?Cd(G)?"green":"red":"inherit"},children:G?ia(new Date(G)):""})]},B)})})]})}):f.jsxs("div",{className:"members-list-wrapper",style:{width:"100%",display:"flex",flexDirection:"column",flex:1},children:[f.jsxs("div",{style:{display:"flex",padding:"8px 12px",fontWeight:700,borderBottom:"1px solid var(--light-border)",background:"var(--panel-header-bg)"},children:[f.jsx("div",{style:{width:"15%",textAlign:"center"},children:"Nick Name"}),f.jsx("div",{style:{width:"25%",textAlign:"left"},children:"Full Name"}),f.jsx("div",{style:{width:"15%",textAlign:"center"},children:"Member Since"}),f.jsx("div",{style:{width:"15%",textAlign:"center"},children:"Last Gym Visit"}),f.jsx("div",{style:{width:"15%",textAlign:"center"},children:"Gym Valid Until"}),f.jsx("div",{style:{width:"15%",textAlign:"center"},children:"Coach Valid Until"})]}),f.jsx(Y4,{height:Math.min(M,Math.max(200,D.length*56)),itemCount:D.length,itemSize:56,width:"100%",children:({index:Q,style:J})=>{const{r:Y,lastVisit:I,isToday:B,memberId:K}=D[Q],le=K?a.get(K):void 0,we=OE(Ln(Y,["student","is_student","student?"]));let Ee=Number(Ln(Y,["age","years_old"]));if(isNaN(Ee)){const oe=Ln(Y,["birthday","birth_date","dob"]),Te=ua(oe);if(Te){const be=new Date;Ee=be.getFullYear()-Te.getFullYear()-(be.getMonth()<Te.getMonth()||be.getMonth()===Te.getMonth()&&be.getDate()<Te.getDate()?1:0)}}const Se=!isNaN(Ee)&&Ee>=60,Me=String(Ln(Y,["first_name","firstname","first","given_name"])??""),ke=String(Ln(Y,["last_name","lastname","last","surname"])??""),Ae=[Me,ke].filter(Boolean).map(kE).join(" "),De=String(Y.nick_name??Y.nickname??"").toUpperCase(),ze=jE(Y)||ua(Ln(Y,["member_since","membersince","member_date","memberdate","member_date","createdat","created_at","join_date","joined","start_date"])),G=le?.membershipEnd||null,he=le?.coachEnd||null;return f.jsxs("div",{style:{...J,display:"flex",alignItems:"center",padding:"8px 12px",borderBottom:"1px solid rgba(0,0,0,0.04)",cursor:"pointer"},className:"row-link",onClick:()=>n(`/members/${encodeURIComponent(K)}`,{state:{row:Y}}),children:[f.jsx("div",{style:{width:"15%",textAlign:"center"},children:f.jsx("strong",{children:De})}),f.jsxs("div",{style:{width:"25%"},children:[Ae,f.jsxs("span",{style:{display:"inline-flex",gap:6,marginLeft:8,verticalAlign:"middle"},children:[we&&f.jsx("span",{className:"pill student",children:"Student"}),Se&&f.jsx("span",{className:"pill senior",children:"Senior"})]})]}),f.jsx("div",{style:{width:"15%",textAlign:"center"},children:ia(ze)}),f.jsx("div",{style:{width:"15%",textAlign:"center"},children:B?f.jsx("span",{className:"pill ok",children:"Visited today"}):I?ia(new Date(I)):""}),f.jsx("div",{style:{width:"15%",textAlign:"center",color:G?Cd(G)?"green":"red":"inherit"},children:G?ia(new Date(G)):""}),f.jsx("div",{style:{width:"15%",textAlign:"center",color:he?Cd(he)?"green":"red":"inherit"},children:he?ia(new Date(he)):""})]},Q)}})]})})]}),f.jsx(T.Suspense,{fallback:f.jsx(jC,{}),children:f.jsx(p6,{open:ee,onClose:()=>de(!1),onSaved:async()=>{try{await F()}catch{}}})})]})}function E6({open:n,onClose:e,onDetected:t}){const s=T.useRef(null),a=T.useRef(null),[l,u]=T.useState(""),g=T.useRef(0),d=T.useRef(null),p=()=>{g.current&&cancelAnimationFrame(g.current),g.current=0,a.current&&(a.current.getTracks().forEach(S=>S.stop()),a.current=null)};async function v(){try{if("BarcodeDetector"in window){const S=await window.BarcodeDetector.getSupportedFormats?.()||[];if(S.includes("qr_code")||S.includes("qr"))return d.current=new window.BarcodeDetector({formats:["qr_code"]}),!0}}catch{}return d.current=null,!1}async function _(){u("");const S=await v();try{const C=await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"}},audio:!1});a.current=C;const O=s.current;if(O&&(O.srcObject=C,await O.play().catch(()=>{})),S){const L=async()=>{if(!s.current||s.current.readyState<2){g.current=requestAnimationFrame(L);return}try{const U=await d.current.detect(s.current);if(U&&U.length){const z=String(U[0].rawValue||U[0].raw||"").trim();if(z){t?.(z),e?.();return}}}catch{}g.current=requestAnimationFrame(L)};g.current=requestAnimationFrame(L)}else u("QR scanning isn't supported by this browser. Type the ID instead.")}catch(C){const O=C?.name||"";u(O==="NotAllowedError"?"Camera permission denied. Allow access in browser/site settings.":O==="NotFoundError"?"No camera found.":"Cannot access camera.")}}return T.useEffect(()=>{if(!n){p();return}return _(),p},[n]),n?f.jsx("div",{style:LE.overlay,children:f.jsxs("div",{style:LE.modal,children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[f.jsx("div",{style:{fontWeight:800},children:"Scan QR Code"}),f.jsx("button",{className:"button btn-lg",style:{background:"#555"},onClick:e,children:"Close"})]}),l&&f.jsx("div",{style:{color:"#d33",marginBottom:8},children:l}),f.jsx("video",{ref:s,playsInline:!0,muted:!0,style:{width:"100%",borderRadius:10,background:"#000"}}),f.jsx("div",{style:{color:"#666",fontSize:12,marginTop:8},children:"Point the camera at the QR code."})]})}):null}const LE={overlay:{position:"fixed",inset:0,background:"rgba(0,0,0,.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},modal:{width:"min(720px, 92vw)",background:"#fff",borderRadius:12,padding:16,border:"1px solid #e7e8ef",boxShadow:"0 6px 24px rgba(0,0,0,.2)"}},{fetchMemberBundle:T6,fetchPricing:UE,fetchMembers:A6,fetchPayments:C6,fetchGymEntries:x6,gymClockIn:q6,gymClockOut:G6,gymQuickAppend:$6}=kt,xd="Asia/Manila",R6=n=>{if(!n)return!1;const e=n instanceof Date?new Date(n):new Date(n);if(isNaN(e))return!1;const t=new Date;return t.setHours(0,0,0,0),e.setHours(0,0,0,0),e>=t},YC=n=>{const t=String(n||"").match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return t&&t[1]?t[1]:""},I6=n=>{const e=String(n||"");if(!e)return"";const t=e.match(/https?:\/\/[^\s}]+/);if(t){const a=t[0];if(/googleusercontent\.com\//.test(a))return a;const l=a.match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return l&&l[1]?`https://drive.google.com/uc?export=view&id=${l[1]}`:a}if(/googleusercontent\.com\//.test(e))return e;const s=YC(e);return s?`https://drive.google.com/uc?export=view&id=${s}`:e},N6=n=>{const e=String(n||"");if(/googleusercontent\.com\//.test(e))return e;const t=YC(e);return t?`https://drive.google.com/thumbnail?id=${t}&sz=w1000`:e};function D6(){const[n,e]=T.useState(!1),[t,s]=T.useState(""),[a,l]=T.useState([]),[u,g]=T.useState(null),[d,p]=T.useState([]),[v,_]=T.useState(null),[S,C]=T.useState(!1),[O,L]=T.useState(null),[U,z]=T.useState(""),[X,q]=T.useState(""),[ne,ee]=T.useState(""),[de,k]=T.useState(!1),[M,P]=T.useState(""),[x,A]=T.useState(""),[V,N]=T.useState(!1),[fe,F]=T.useState(!1),D=T.useRef(null),$=T.useRef(null);T.useEffect(()=>{let Y=!0;return(async()=>{try{const[I,B,K]=await Promise.all([A6(),C6(),UE()]);if(!Y)return;const le=(I?.rows||I?.data||[]).slice(),we=B?.rows||B?.data||[],Ee=K?.rows||K?.data||[],Se=await x6(),Me=Se?.rows||Se?.data||[],ke=new Intl.DateTimeFormat("en-CA",{timeZone:xd,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date),Ae=le.filter(De=>{const ze=(De.MemberID||De.member_id||De.id||"").toString().trim(),G=we.filter(Ce=>String(Ce.MemberID||Ce.member_id||Ce.id||"").trim()===String(ze).trim()),he=Aa(G,ze,Ee);return he.membershipState==="active"||R6(he?.membershipEnd)?!Me.filter(Ce=>{try{const ae=String(Ce.MemberID||Ce.memberId||Ce.memberid||Ce.id||"").trim();if(!ae||String(ae)!==String(ze))return!1;const Ne=Ce.Date||Ce.date||Ce.DateTime||Ce.timestamp||Ce.checkin;return Ne?new Intl.DateTimeFormat("en-CA",{timeZone:xd,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date(Ne))===ke:!1}catch{return!1}}).some(Ce=>{try{const ae=String(Ce.TimeOut||Ce.timeOut||Ce.time_out||Ce.Timeout||"").trim();return ae?/\d/.test(ae)?!1:["-","","",""].includes(ae):!0}catch{return!0}}):!1});Ae.sort((De,ze)=>{const G=String(De.Nickname||De.NickName||De["Nick Name"]||"").toLowerCase(),he=String(ze.Nickname||ze.NickName||ze["Nick Name"]||"").toLowerCase();return G.localeCompare(he)}),l(Ae)}catch(I){console.error(I)}})(),()=>{Y=!1}},[]),T.useEffect(()=>{F(!1)},[u?.member]);const Q=async Y=>{const[I,B]=await Promise.all([T6(Y),UE()]),K=B?.rows||B?.data||[];g(I),p(K);const le=Aa(I.payments||[],Y,K);return _(le),{b:I,rows:K,status:le}},J=async Y=>{const I=String(Y||"").trim();if(!I)return;s(I),C(!0),ee(""),g(null),_(null);const B=await Q(I),K=B?.b?.member||null,le=B?.status;if(K&&(K.NickName||K.Nickname||K["Nick Name"]||K.nick_name||K.nickname),!K||le?.membershipState!=="active"){ee(null),setTimeout(()=>{ee("NO ACTIVE GYM MEMBERSHIP")},100);return}const we=new Intl.DateTimeFormat("en-CA",{timeZone:xd,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date),Se=(B?.b?.gymEntries||[]).filter(Me=>{const ke=Me?.Date||Me?.date;if(!ke)return!1;const Ae=new Date(ke);return new Intl.DateTimeFormat("en-CA",{timeZone:xd,year:"numeric",month:"2-digit",day:"2-digit"}).format(Ae)===we}).find(Me=>!String(Me?.TimeOut||"").trim());Se?(N(!0),ee(""),L(Se||null)):(N(!1),ee(""),L(null))};return T.useEffect(()=>{const Y=async B=>{try{const K=String(B&&(B.MemberID||B.memberid||B.Member)||"").trim();if(!K||!t||String(K)!==String(t))return;await Q(t),L(null)}catch(K){console.debug("CheckIn: gymEntry event handler failed",K)}},I=Gn.on("gymEntry:added",Y);return()=>{try{I()}catch{}}},[t]),T.useMemo(()=>{const Y=u?.member||null;if(!Y)return null;const I=Me=>Me.map(ke=>Y[ke]).find(ke=>ke!==void 0&&ke!==""),B=I(["FirstName","First","first"]),K=I(["LastName","Last","last"]),le=I(["NickName","Nickname","Nick Name","nick_name","nickname"]),we=I(["PhotoURL","Photo","photo","photo_url"]),Ee=N6(I6(we)),Se=Y.MemberSince||Y["Member Since"]||Y.Joined||Y["Join Date"]||Y.join_date;return{first:B,last:K,nick:le,photo:Ee,memberSince:Se}},[u]),f.jsxs("div",{className:"content",children:[f.jsx("h2",{className:"dashboard-title",children:"Member Check-In"}),f.jsx("div",{className:"card",style:{marginTop:8,marginBottom:12,maxWidth:480,minHeight:600,marginLeft:"auto",marginRight:"auto",padding:16,border:"2px solid #d7d9e5",background:"#fff",boxShadow:"0 10px 24px rgba(0,0,0,.12)",display:"flex",alignItems:"center",justifyContent:"center"},children:f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12,alignItems:"center",width:"100%"},children:[f.jsx("img",{src:"/favicon.png",onError:Y=>{try{Y.currentTarget.onerror=null,Y.currentTarget.src="/kusgan-logo.png"}catch{}},alt:"Kusgan logo",style:{width:250,height:250,objectFit:"contain",opacity:1,marginBottom:8}}),f.jsx("div",{style:{maxWidth:420,width:"100%",margin:"0 auto"},children:f.jsx("button",{className:"primary-btn",style:{fontSize:"1.1rem",height:54,width:"100%"},onClick:()=>e(!0),children:" Scan QR Code"})}),f.jsx("div",{style:{color:"#666",textAlign:"center",marginTop:24},children:"or select a member below"}),f.jsx("div",{style:{maxWidth:420,width:"100%",margin:"0 auto"},children:f.jsxs("select",{value:t,onChange:Y=>s(Y.target.value),style:{width:"100%",height:44,padding:"8px 12px",border:"1px solid #e7e8ef",borderRadius:10},children:[f.jsx("option",{value:"",children:"Select member"}),a.map(Y=>f.jsxs("option",{value:Y.MemberID,children:[Y.Nickname||Y.NickName||Y["Nick Name"]||"Member","  ",Y.FirstName||Y.First||""," ",Y.LastName||Y.Last||""]},Y.MemberID))]})}),f.jsx("div",{style:{maxWidth:420,width:"100%",margin:"0 auto"},children:f.jsx("button",{className:"primary-btn",style:{fontSize:"1.1rem",height:54,width:"100%"},onClick:()=>{t&&J(t)},children:"Proceed"})})]})}),f.jsx(E6,{open:n,onClose:()=>e(!1),onDetected:J}),f.jsx(Gf,{open:S,memberId:t,initialEntry:O,onClose:()=>{C(!1),ee("")},onSuccess:()=>{C(!1),ee(""),g(null),_(null),L(null)}}),de&&f.jsx("div",{style:{position:"fixed",top:24,right:24,zIndex:2e3,pointerEvents:D.current?"auto":"none"},children:f.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",background:"#333",color:"#fff",fontWeight:600,fontSize:16,borderRadius:8,boxShadow:"0 2px 12px rgba(0,0,0,.12)",padding:"10px 14px",minWidth:220,textAlign:"left",letterSpacing:.1},children:[f.jsx("div",{style:{flex:1},children:ne}),D.current?f.jsx("button",{style:{background:"transparent",color:"#fff",border:"1px solid rgba(255,255,255,0.18)",padding:"6px 10px",borderRadius:6,cursor:"pointer"},onClick:()=>{const Y=D.current;if(Y){try{Y.timer&&clearTimeout(Y.timer)}catch{}D.current=null,Y.type==="checkin"?(N(!1),g(I=>{if(!I)return I;const B=(I.gymEntries||[]).filter(K=>!(String(K.MemberID||"")===String(Y.memberId)&&String(K.TimeIn||"")===String(Y.nowIso)));return{...I,gymEntries:B}})):Y.type==="checkout"&&(N(!0),g(I=>{if(!I)return I;const B=(I.gymEntries||[]).map(K=>String(K.MemberID||"")===String(Y.memberId)&&String(K.TimeOut||"").length>0?{...K,TimeOut:""}:K);return{...I,gymEntries:B}})),ee("Action cancelled"),k(!0),$.current&&clearTimeout($.current),$.current=setTimeout(()=>{k(!1),ee("")},1800)}},children:"Undo"}):null]})})]})}const M6=["Coach Jojo","Coach Elmer","Bezza","Jeanette","Johanna","Patpat","Sheena","Xyza"],Yi="Asia/Manila",by=n=>{if(!n)return"";try{const e=new Date(n);return new Intl.DateTimeFormat("en-PH",{hour:"numeric",minute:"2-digit",hour12:!0,timeZone:Yi}).format(e)}catch{return String(n)}},zE=n=>{if(!n)return"";try{const e=String(n||"");let t=null;if(/^\d{4}-\d{2}-\d{2}$/.test(e)?t=new Date(e+"T00:00:00"):t=new Date(e),isNaN(t))return e.slice(0,10);const s=new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",timeZone:Yi}).formatToParts(t),a=s.find(g=>g.type==="month")?.value||"",l=s.find(g=>g.type==="day")?.value||"",u=s.find(g=>g.type==="year")?.value||"";return`${a}-${l}, ${u}`}catch{return String(n)}},Rd=n=>{try{const e=n?.time_in||n?.timeIn||n?.TimeIn||n?.TimeInISO||null,t=n?.TimeIn||n?.time_in_short||null;if(e)return by(e);const s=String(n?.TimeIn||n?.time_in||n?.TimeIn||"");if(/^\d{1,2}:\d{2}$/.test(s)){const[a,l]=s.split(":").map(g=>Number(g)),u=new Date;return u.setHours(a,l,0,0),new Intl.DateTimeFormat("en-PH",{hour:"numeric",minute:"2-digit",hour12:!0,timeZone:Yi}).format(u)}return s||""}catch{return""}},us=n=>{try{const e=n?.Date||n?.date||n?.time_in||n?.timeIn||n?.Timestamp||n?.timestamp||n?.TimestampISO||n?.timestampISO||"";if(e&&typeof e=="object"&&(e.seconds||e._seconds)){const a=e.seconds||e._seconds,l=new Date(a*1e3);return new Intl.DateTimeFormat("en-CA",{timeZone:Yi}).format(l)}const t=String(e||"").trim();if(!t)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(t))return t.slice(0,10);const s=new Date(t);return isNaN(s)?t.slice(0,10):new Intl.DateTimeFormat("en-CA",{timeZone:Yi}).format(s)}catch{return""}};function O6(){const[n,e]=T.useState(""),[t,s]=T.useState([]),[a,l]=T.useState([]),[u,g]=T.useState([]),[d,p]=T.useState(null),[v,_]=T.useState(!1),[S,C]=T.useState(!1),[O,L]=T.useState(""),U=F=>{if(!F)return!1;const D=String(F).trim().toLowerCase(),$=new Intl.DateTimeFormat("en-CA",{timeZone:Yi}).format(new Date);for(const Q of t||[])try{const J=String(Q?.Staff||Q?.staff||Q?.staff_name||"").trim().toLowerCase(),Y=us(Q)||"",I=String(Q?.TimeIn||Q?.time_in||Q?.timein||"").trim(),B=String(Q?.TimeOut||Q?.time_out||Q?.timeout||"").trim();if(J===D&&Y===$&&I&&(B===""||B==="-"||B===""||B===null||typeof B>"u"))return!0}catch{}return!1},z=async()=>{_(!0),L("");try{const F=hs.getCached("attendance")||[];F&&F.length&&s(F);const $=await(await fetch("/attendance")).json(),Q=Array.isArray($)?$:[];s(Q),hs.setCached("attendance",Q);try{const J=await kt.fetchMembers(),Y=J&&(J.rows||J.data)?J.rows||J.data:Array.isArray(J)?J:[];g(Array.isArray(Y)?Y:[])}catch{}try{const J=await kt.fetchGymEntries(),Y=J&&(J.rows||J.data)?J.rows||J.data:Array.isArray(J)?J:[];l(Array.isArray(Y)?Y:[])}catch{}hs.processQueue()}catch(F){console.error("load attendance",F),L("Failed to load attendance")}finally{_(!1)}};T.useEffect(()=>{z()},[]);const X=new Intl.DateTimeFormat("en-CA",{timeZone:Yi}).format(new Date),q=["Coach Jojo","Coach Elmer"],[ne,ee]=T.useState(q[0]),[de,k]=T.useState([]),[M,P]=T.useState(0),x=T.useMemo(()=>{try{const F=new Set;(a||[]).forEach($=>{const Q=String($?.Coach||$?.coach||"").trim();Q&&F.add(Q)});const D=Array.from(F);return D.length?D:q}catch{return q}},[a]);T.useEffect(()=>{try{!ne&&x&&x.length&&ee(x[0]),ne&&x&&x.length&&!x.includes(ne)&&ee(x[0])}catch{}},[x]);const A=(F,D)=>{try{if(!F||!D)return[];const $=new Date(F.getFullYear(),F.getMonth(),1),Q=new Date(D.getFullYear(),D.getMonth(),D.getDate()),J=[];let Y=new Date($);for(;Y<=Q;){const B=Y.getFullYear(),K=Y.getMonth(),le=new Date(B,K,1),we=new Date(B,K,15),Ee=new Date(B,K+1,0);J.push({label:`${le.toLocaleString("en-US",{month:"short"})} 1-15, ${B}`,start:new Intl.DateTimeFormat("en-CA",{timeZone:Yi}).format(le),end:new Intl.DateTimeFormat("en-CA",{timeZone:Yi}).format(we)}),J.push({label:`${le.toLocaleString("en-US",{month:"short"})} 16-${Ee.getDate()}, ${B}`,start:new Intl.DateTimeFormat("en-CA",{timeZone:Yi}).format(new Date(B,K,16)),end:new Intl.DateTimeFormat("en-CA",{timeZone:Yi}).format(Ee)}),Y=new Date(B,K+1,1)}const I=[];for(const B of J)I.find(K=>K.label===B.label)||I.push(B);return I}catch{return[]}};T.useEffect(()=>{try{if(!a||a.length===0){const I=new Date,B=A(new Date(I.getFullYear(),I.getMonth()-3,1),I);k(B);const K=X,le=B.findIndex(we=>we.start<=K&&we.end>=K);le>=0&&P(le);return}let F=null;for(const I of a){const B=us(I)||"";if(!B)continue;const K=new Date(B+"T00:00:00");isNaN(K)||(!F||K<F)&&(F=K)}const D=new Date,$=F||new Date(D.getFullYear(),D.getMonth(),1),Q=A($,D);k(Q);const J=X,Y=Q.findIndex(I=>I.start<=J&&I.end>=J);Y>=0&&P(Y)}catch{}},[a]);const V=T.useMemo(()=>{try{const F=(()=>{const D=new Date;return D.setDate(D.getDate()-19),new Intl.DateTimeFormat("en-CA",{timeZone:Yi}).format(D)})();return(t||[]).filter(D=>{const $=us(D)||"";return $&&$>=F&&(D.Staff||D.staff||D.staff_name)}).sort((D,$)=>{const Q=(us(D)||"0000-00-00")+"T"+String(D?.TimeIn||D?.time_in||"00:00");return((us($)||"0000-00-00")+"T"+String($?.TimeIn||$?.time_in||"00:00")).localeCompare(Q)})}catch{return[]}},[t]),N=T.useMemo(()=>{try{if(!de||de.length===0)return[];const F=de[M]||de[0],D=F?.start||"",$=F?.end||"";return(a||[]).filter(J=>{try{const Y=String(J?.Coach||J?.coach||"").trim();if(!Y)return!1;if(ne){const B=Y.toLowerCase().replace(/\s+/g,""),K=String(ne).toLowerCase().replace(/\s+/g,"");if(!(B.includes(K)||K.includes(B)))return!1}const I=us(J)||"";return I?I>=D&&I<=$:!1}catch{return!1}}).sort((J,Y)=>String(Y?.TimeIn||Y?.time_in||"").localeCompare(String(J?.TimeIn||J?.time_in||"")))}catch{return[]}},[a,de,ne,M]),fe=async()=>{if(n){C(!0),L("");try{const F=hs.addOptimisticAttendance(n);s(D=>{const $=(D||[]).filter(Q=>String(Q.id)!==String(F.id));return[F,...$]});try{kt&&typeof kt.attendanceQuickAppend=="function"?await kt.attendanceQuickAppend(n,{}):kt&&typeof kt.clockIn=="function"?await kt.clockIn(n):(hs.enqueueWrite({method:"POST",path:"/attendance/kiosk",body:{staff_name:n},tempId:F.id,collection:"attendance"}),await hs.processQueue())}catch(D){console.warn("attendance client write failed, falling back to queue",D&&D.message),hs.enqueueWrite({method:"POST",path:"/attendance/kiosk",body:{staff_name:n},tempId:F.id,collection:"attendance"}),await hs.processQueue()}await z()}catch(F){console.error("kiosk error",F),L(F?.message||"Action failed")}finally{C(!1)}}};return f.jsxs("div",{className:"dashboard-content",children:[f.jsxs("h2",{className:"dashboard-title",children:["Staff Attendance ",f.jsx(qf,{show:v&&!S})]}),f.jsxs("div",{className:"panel",children:[f.jsx("div",{className:"panel-header",children:"Select Staff Member"}),f.jsx("div",{style:{display:"flex",justifyContent:"center"},children:f.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",padding:12},children:[f.jsxs("select",{value:n,onChange:F=>e(F.target.value),style:{width:300,height:44,padding:"8px 12px",border:"1px solid #e7e8ef",borderRadius:10,fontSize:18},children:[f.jsx("option",{value:"",children:"(choose)"}),M6.map(F=>f.jsx("option",{value:F,children:F},F))]}),f.jsx("button",{className:"primary-btn",onClick:fe,disabled:!n||S,children:S?"Processing":n&&U(n)?"Sign Out":"Sign In"})]})})]}),f.jsxs("div",{className:"panel",children:[f.jsx("div",{className:"panel-header",children:"Attendance Records"}),O&&f.jsx("div",{className:"small-error",children:O}),f.jsx("div",{style:{overflowX:"auto",padding:8},children:f.jsxs("table",{className:"attendance-table aligned",style:{width:"100%"},children:[f.jsx("thead",{children:f.jsxs("tr",{children:[f.jsx("th",{children:"Date"}),f.jsx("th",{children:"Staff"}),f.jsx("th",{children:"Time In"}),f.jsx("th",{children:"Time Out"}),f.jsx("th",{style:{textAlign:"center"},children:"Total Hours"})]})}),f.jsx("tbody",{children:V.length===0?f.jsx("tr",{children:f.jsx("td",{colSpan:5,style:{textAlign:"center",color:"var(--muted)"},children:"No records."})}):V.map((F,D)=>{const $=us(F)||"",Q=Rd(F),J=F?.time_out||F?.TimeOut||F?.timeOut||"",Y=J?J.length===5?Rd({TimeIn:J}):by(J):"",I=typeof F?.TotalHours<"u"&&F?.TotalHours!==null?String(F?.TotalHours):typeof F?.NoOfHours<"u"&&F?.NoOfHours!==null?String(F?.NoOfHours):typeof F?.hours<"u"&&F?.hours!==null?String(F?.hours):"",B=String(F?.TimeOut||F?.time_out||F?.timeout||"").trim(),K=B===""||B==="-"||B===""||B==="null"||typeof B>"u",le=String(F?.Staff||F?.staff||F?.staff_name||""),we=(us(F)||"")===X;return f.jsxs("tr",{children:[f.jsx("td",{children:zE($)}),f.jsxs("td",{style:{fontWeight:700},children:[le,K&&we&&f.jsx("span",{style:{marginLeft:8},className:"status-badge on",children:"On"})]}),f.jsx("td",{children:Q}),f.jsx("td",{children:Y}),f.jsx("td",{style:{textAlign:"center"},children:I})]},($||"")+"|"+String(F?.Staff||F?.staff||D))})})]})})]}),f.jsxs("div",{className:"panel",style:{marginTop:18},children:[f.jsx("div",{className:"panel-header",children:"Coaching Sessions"}),f.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",justifyContent:"center",flexWrap:"wrap",padding:"8px 0 6px 0"},children:[f.jsxs("div",{children:[f.jsx("div",{style:{fontSize:12,color:"var(--muted)",marginBottom:6},children:"Coach"}),f.jsx("select",{value:ne,onChange:F=>ee(F.target.value),style:{width:260,height:44,padding:"8px 12px",border:"1px solid #e7e8ef",borderRadius:10,fontSize:16},children:x.map(F=>f.jsx("option",{value:F,children:F},F))})]}),f.jsxs("div",{children:[f.jsx("div",{style:{fontSize:12,color:"var(--muted)",marginBottom:6},children:"Period"}),f.jsx("select",{value:M,onChange:F=>P(Number(F.target.value)),style:{width:260,height:44,padding:"8px 12px",border:"1px solid #e7e8ef",borderRadius:10,fontSize:16},children:de.map((F,D)=>f.jsx("option",{value:D,children:F.label},F.label))})]})]}),f.jsxs("div",{style:{paddingTop:6,paddingBottom:12,fontWeight:700,paddingLeft:8},children:["Sessions: ",N?.length||0]}),f.jsx("div",{style:{overflowX:"auto",padding:8},children:f.jsxs("table",{className:"attendance-table aligned",style:{width:"100%"},children:[f.jsx("thead",{children:f.jsxs("tr",{children:[f.jsx("th",{children:"Date"}),f.jsx("th",{children:"Nickname"}),f.jsx("th",{children:"Time In"}),f.jsx("th",{children:"Time Out"}),f.jsx("th",{style:{textAlign:"center"},children:"Total Hours"}),f.jsx("th",{children:"Focus"})]})}),f.jsx("tbody",{children:!de||de.length===0?f.jsx("tr",{children:f.jsx("td",{colSpan:6,children:"No periods"})}):N.length===0?f.jsx("tr",{children:f.jsx("td",{colSpan:6,children:"No sessions for selected coach / period."})}):N.map((F,D)=>{const $=us(F)||"",Q=Rd(F),J=F?.time_out||F?.TimeOut||F?.timeOut||"",Y=J?J.length===5?Rd({TimeIn:J}):by(J):"",I=typeof F?.TotalHours<"u"&&F?.TotalHours!==null?String(F?.TotalHours):typeof F?.NoOfHours<"u"&&F?.NoOfHours!==null?String(F?.NoOfHours):typeof F?.TotalHours<"u"&&F?.TotalHours!==null?String(F?.TotalHours):typeof F?.hours<"u"&&F?.hours!==null?String(F?.hours):"",B=String(F?.MemberID||F?.memberid||F?.member||F?.Member||F?.id||"").trim(),K=(u||[]).find(we=>String(we?.MemberID||we?.memberid||we?.id||"").trim()===B)||null,le=K?df(K):String(F?.NickName||F?.nickname||F?.Member||F?.member||"")||"";return f.jsxs("tr",{style:{cursor:"pointer"},onClick:()=>p(F),children:[f.jsx("td",{children:zE($)}),f.jsx("td",{style:{fontWeight:700},children:le}),f.jsx("td",{children:Q}),f.jsx("td",{children:Y}),f.jsx("td",{style:{textAlign:"center"},children:I}),f.jsx("td",{children:String(F?.Focus||F?.focus||"")})]},($||"")+"|"+le+"|"+D)})})]})}),f.jsx(kv,{open:!!d,onClose:()=>p(null),row:d,onCheckout:async F=>{try{await z()}catch{}p(null)}})]})]})}const{fetchPricing:fl}=kt;function j6(){const[n,e]=T.useState(""),[t,s]=T.useState("Staff"),[a,l]=T.useState(""),[u,g]=T.useState(!1),[d,p]=T.useState(""),[v,_]=T.useState(null),[S,C]=T.useState(""),[O,L]=T.useState([]),[U,z]=T.useState(null),[X,q]=T.useState(""),ne={padding:"8px 12px",fontSize:14,lineHeight:"1",minHeight:36},[ee,de]=T.useState([]),[k,M]=T.useState(""),[P,x]=T.useState(""),[A,V]=T.useState([]),[N,fe]=T.useState("No"),[F,D]=T.useState("No"),[$,Q]=T.useState(""),[J,Y]=T.useState(""),[I,B]=T.useState(!1),[K,le]=T.useState(""),[we,Ee]=T.useState("");T.useEffect(()=>{let G=!0;return(async()=>{try{const he=await ln.fetchWithAuth("/products");if(!G)return;if(!he.ok){de([]);return}const oe=await he.json().catch(()=>[]);de(oe||[])}catch{de([])}})(),()=>{G=!1}},[]),T.useEffect(()=>{let G=!0;return(async()=>{try{const he=await fl();if(!G)return;V(he?.rows||he?.data||[])}catch{V([])}})(),()=>{G=!1}},[]);const Se=(()=>{const G={};(A||[]).forEach(oe=>{const Te=String(oe.Particulars||oe.particulars||oe.name||"").trim();Te&&(G[Te.toLowerCase()]=oe)});const he=[];return(A||[]).forEach(oe=>{const Te=String(oe.Particulars||oe.particulars||oe.name||"").trim();Te&&he.push({id:oe.id||oe.ID||oe._id||null,particulars:Te,gym:(oe["Gym membership"]??oe["Gym Membership"]??oe.gym_membership??oe.is_gym_membership??"")||"",coach:(oe["Coach subscription"]??oe["Coach Subscription"]??oe.coach_subscription??oe.is_coach_subscription??"")||"",cost:oe.Cost||oe.cost||oe.Price||oe.price||"",validity:oe.Validity||oe.validity||oe.validity_days||oe.ValidityDays||0,source:"pricing",raw:oe})}),(ee||[]).forEach(oe=>{const Te=String(oe.name||oe.Particulars||oe.particulars||"").trim();Te&&(G[Te.toLowerCase()]||he.push({id:oe.id||null,particulars:Te,gym:(oe.is_gym_membership||oe.is_gym||oe.gym,oe.is_gym_membership||oe.gym?"Yes":"No"),coach:(oe.is_coach_subscription||oe.is_coach||oe.coach,oe.is_coach_subscription||oe.coach?"Yes":"No"),cost:oe.price||oe.Cost||oe.cost||"",validity:oe.validity_days||oe.Validity||oe.validity||0,source:"products",raw:oe}))}),he})(),Me=(()=>{const G=[],he=[],oe=[],Te=[];return Se.forEach(be=>{const Ce=String(be.gym||"").toLowerCase().startsWith("y"),ae=String(be.coach||"").toLowerCase().startsWith("y");Ce&&!ae?G.push(be):!Ce&&ae?he.push(be):Ce&&ae?oe.push(be):Te.push(be)}),{gymOnly:G,coachOnly:he,bundle:oe,merch:Te}})();T.useEffect(()=>{let G=!0;return(async()=>{try{const he=await ln.fetchWithAuth("/users");if(!G)return;if(he&&he.ok){const oe=await he.json().catch(()=>[]);L(oe||[]);return}try{const oe=await ln.fetchWithAuth("/auth/me");if(oe&&oe.ok){const be=(await oe.json().catch(()=>({})))?.user?.username||"";L(be?[{id:null,username:be}]:[]);return}}catch{}L([])}catch{}})(),()=>{G=!1}},[]);const ke=async()=>{try{let G;try{G=await ln.fetchWithAuth("/users")}catch{G=null}if(!G||!G.ok)try{const oe=`${window.location.protocol}//${window.location.hostname}:4000`,Te=ln.getToken&&ln.getToken(),be={};Te&&(be.Authorization=`Bearer ${Te}`);const Ce=await fetch(`${oe}/users`,{headers:be});if(!Ce.ok){L([]);return}const ae=await Ce.json().catch(()=>[]);L(ae||[]);return}catch{L([]);return}const he=await G.json().catch(()=>[]);L(he||[])}catch{L([])}},Ae=async()=>{try{const G=await ln.fetchWithAuth("/products");if(!G.ok)return;const he=await G.json().catch(()=>[]);de(he||[])}catch{}},De=async G=>{if(G&&G.preventDefault(),l(""),!n)return l("Please enter username");g(!0);try{const he=await ln.fetchWithAuth("/staff",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({full_name:n,role:t})});if(!he.ok){const Te=await he.json().catch(()=>({}));return l(Te.error||"Failed to add staff")}const oe=await he.json().catch(()=>({}));try{const Te=Math.random().toString(36).slice(-10),be=d||Te;let Ce;try{Ce=await ln.fetchWithAuth("/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,password:be,role:t==="Admin"?"admin":"staff"})})}catch{Ce=null}if(!Ce||!Ce.ok)try{const ae=`${window.location.protocol}//${window.location.hostname}:4000`,Ne=ln.getToken&&ln.getToken(),We={"Content-Type":"application/json"};Ne&&(We.Authorization=`Bearer ${Ne}`);const St=await fetch(`${ae}/users`,{method:"POST",headers:We,body:JSON.stringify({username:n,password:be,role:t==="Admin"?"admin":"staff"})});if(!St.ok){let tn="";try{tn=await St.text()}catch{tn=""}l(`Staff added. User creation failed: ${St.status} ${tn||St.statusText||"error"}`),e(""),p(""),g(!1);return}await ke(),l(`Staff added. User created (password: ${be})`),e(""),p(""),g(!1);return}catch{l("Staff added. User creation failed (network)"),e(""),p(""),g(!1);return}try{await Ce.json().catch(()=>({}))}catch{}await ke(),l(`Staff added. User created (password: ${be})`),e(""),p(""),g(!1)}catch{l("Staff added. User creation failed"),e(""),p(""),g(!1);return}}catch{l("Server error"),g(!1)}},ze=G=>{if(!G.id){l("Cannot change status for current user from here");return}(async()=>{try{const he=!G.active;if(!(await ln.fetchWithAuth(`/users/${G.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...G,active:he})})).ok)return l("Update failed");await ke(),l(he?"User activated":"User deactivated")}catch{l("Server error")}})()};return f.jsx("div",{className:"content",children:f.jsxs("div",{className:"panel",children:[f.jsx("div",{className:"panel-header",children:"Admin Console"}),f.jsx("div",{style:{color:"var(--muted)",marginBottom:8},children:"Add staff accounts and manage products/services."}),f.jsxs("div",{className:"panel",style:{marginTop:12},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsx("div",{className:"panel-header",children:"Users"}),f.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[f.jsx("div",{style:{color:"var(--muted)",fontSize:13}}),f.jsx("button",{className:"button",style:ne,onClick:()=>{ke(),l("Refreshed users")},children:"Refresh"})]})]}),f.jsxs("div",{style:{marginTop:6},children:[f.jsxs("form",{onSubmit:De,style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap",marginBottom:12},children:[f.jsx("input",{className:"input-compact",value:n,onChange:G=>e(G.target.value),placeholder:"username (e.g. jsmith)",style:{width:240}}),f.jsxs("select",{className:"select-compact",value:t,onChange:G=>s(G.target.value),style:{width:140},children:[f.jsx("option",{children:"Staff"}),f.jsx("option",{children:"Admin"})]}),f.jsx("input",{type:"password",className:"input-compact",placeholder:"password (optional)",value:d,onChange:G=>p(G.target.value),style:{width:180}}),f.jsx("button",{type:"submit",className:"button btn-compact",disabled:u,style:ne,children:"Add"}),u&&f.jsx("div",{style:{color:"var(--muted)",marginLeft:8},children:"Adding..."})]}),f.jsx("div",{style:{marginTop:0,color:"var(--muted)",fontSize:13,marginBottom:12},children:"Creates a staff record; a login user will be created automatically (you may provide a password)."}),f.jsxs("ul",{style:{listStyle:"none",paddingLeft:0},children:[O.map(G=>f.jsxs("li",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 0",borderBottom:"1px solid var(--light-border)"},children:[f.jsxs("div",{children:[f.jsx("div",{style:{fontWeight:700},children:G.username}),f.jsx("div",{style:{color:"var(--muted)",fontSize:13},children:G.role||(G.id?"":"You")})]}),f.jsx("div",{style:{display:"flex",gap:8,alignItems:"center"},children:U===(G.id??"self")?f.jsxs(f.Fragment,{children:[f.jsx("input",{className:"input-compact",value:X,onChange:he=>q(he.target.value),placeholder:"new password",style:{width:140}}),f.jsx("button",{className:"button btn-compact",style:ne,onClick:async()=>{if(!X)return l("Enter new password");try{let he;if(G.id?he=await ln.fetchWithAuth(`/users/${G.id}/password`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:X})}):he=await ln.fetchWithAuth("/users/self/password",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:X})}),!he.ok){const oe=await he.json().catch(()=>({}));l(oe.error||"Reset failed");return}l("Password reset"),z(null),q(""),await ke()}catch{l("Server error")}},children:"Save"}),f.jsx("button",{className:"button",style:ne,onClick:()=>{z(null),q("")},children:"Cancel"})]}):f.jsxs(f.Fragment,{children:[f.jsx("button",{className:"button btn-compact",style:ne,onClick:()=>{z(G.id??"self"),q("")},children:"Reset"}),G.id?f.jsx("button",{className:"button",style:ne,onClick:()=>ze(G),children:G.active??!0?"Deactivate":"Activate"}):null]})})]},G.id??G.username)),O.length===0&&f.jsx("li",{style:{color:"#888",padding:12},children:"No users found."})]})]}),f.jsx("div",{className:"panel-header",style:{marginTop:18},children:"Pricing Rules"}),f.jsxs("div",{style:{marginTop:8},children:[f.jsx("div",{style:{color:"var(--muted)",marginBottom:8},children:"This table lists the product rules used by the app to decide whether a Particulars value grants gym access and/or coach subscription."}),f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[f.jsx("div",{style:{color:"var(--muted)"},children:"This table lists the product rules used by the app to decide whether a Particulars value grants gym access and/or coach subscription."}),f.jsx("div",{children:I?f.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[f.jsx("input",{placeholder:"Merchandise name",value:K,onChange:G=>le(G.target.value),style:{width:240}}),f.jsx("input",{placeholder:"Price",value:we,onChange:G=>Ee(G.target.value),style:{width:120}}),f.jsx("button",{className:"button",onClick:async()=>{if(!K)return l("Enter merchandise name");try{const G={Particulars:K,Cost:Number(we)||0,Validity:0,"Gym membership":"No","Coach subscription":"No"};await kt.addPricing(G);const he=await fl();V(he?.rows||[]),le(""),Ee(""),B(!1),l("Merchandise added")}catch{l("Add failed")}},children:"Add"}),f.jsx("button",{className:"button",onClick:()=>{B(!1),le(""),Ee("")},children:"Cancel"})]}):f.jsx("button",{className:"button",onClick:()=>B(!0),children:"Add Merchandise"})})]}),f.jsxs("table",{className:"aligned",style:{width:"100%",borderCollapse:"collapse"},children:[f.jsxs("colgroup",{children:[f.jsx("col",{style:{width:"36%"}}),f.jsx("col",{style:{width:"14%"}}),f.jsx("col",{style:{width:"14%"}}),f.jsx("col",{style:{width:"14%"}}),f.jsx("col",{style:{width:"12%"}}),f.jsx("col",{style:{width:"10%"}})]}),f.jsx("thead",{children:f.jsxs("tr",{children:[f.jsx("th",{children:"Particulars"}),f.jsx("th",{children:"Gym Membership"}),f.jsx("th",{children:"Coach Subscription"}),f.jsx("th",{children:"Cost"}),f.jsx("th",{children:"Validity (days)"}),f.jsx("th",{children:"Actions"})]})}),f.jsx("tbody",{children:Me.gymOnly.length+Me.coachOnly.length+Me.bundle.length+Me.merch.length===0?f.jsx("tr",{children:f.jsx("td",{colSpan:6,style:{color:"#888",padding:12},children:"No pricing rules configured."})}):f.jsxs(f.Fragment,{children:[Me.gymOnly.length>0&&f.jsxs(f.Fragment,{children:[f.jsx("tr",{style:{background:"var(--muted-background)",fontWeight:700},children:f.jsx("td",{colSpan:6,style:{padding:8},children:"Gym Membership Only"})}),Me.gymOnly.map(G=>{const he=v===(G.id||G.particulars);return f.jsxs("tr",{style:{borderTop:"1px solid var(--light-border)"},children:[f.jsx("td",{style:{padding:"6px 8px"},children:G.particulars}),f.jsx("td",{style:{textAlign:"center"},children:G.gym}),f.jsx("td",{style:{textAlign:"center"},children:G.coach}),f.jsx("td",{style:{textAlign:"center"},children:he?f.jsx("input",{value:S,onChange:oe=>C(oe.target.value),style:{width:96}}):G.cost||""}),f.jsx("td",{style:{textAlign:"center"},children:G.validity||""}),f.jsx("td",{style:{textAlign:"right"},children:he?f.jsxs(f.Fragment,{children:[f.jsx("button",{className:"button",onClick:async()=>{try{if(G.source==="pricing"){await kt.updatePricing(G.id,{Cost:Number(S)||0});const oe=await fl();V(oe?.rows||[])}else G.source==="products"&&G.id&&(await ln.fetchWithAuth(`/products/${G.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...G.raw,price:Number(S)||0})}),await Ae());_(null),C(""),l("Pricing updated")}catch{l("Update failed")}},children:"Save"}),f.jsx("button",{className:"button",onClick:()=>{_(null),C("")},children:"Cancel"})]}):f.jsx("button",{className:"button",onClick:()=>{_(G.id||G.particulars),C(G.cost||"")},children:"Edit"})})]},G.id||G.particulars)})]}),Me.coachOnly.length>0&&f.jsxs(f.Fragment,{children:[f.jsx("tr",{style:{background:"var(--muted-background)",fontWeight:700},children:f.jsx("td",{colSpan:6,style:{padding:8},children:"Coach Subscription Only"})}),Me.coachOnly.map(G=>{const he=v===(G.id||G.particulars);return f.jsxs("tr",{style:{borderTop:"1px solid var(--light-border)"},children:[f.jsx("td",{style:{padding:"6px 8px"},children:G.particulars}),f.jsx("td",{style:{textAlign:"center"},children:G.gym}),f.jsx("td",{style:{textAlign:"center"},children:G.coach}),f.jsx("td",{style:{textAlign:"center"},children:he?f.jsx("input",{value:S,onChange:oe=>C(oe.target.value),style:{width:96}}):G.cost||""}),f.jsx("td",{style:{textAlign:"center"},children:G.validity||""}),f.jsx("td",{style:{textAlign:"right"},children:he?f.jsxs(f.Fragment,{children:[f.jsx("button",{className:"button",onClick:async()=>{try{if(G.source==="pricing"){await kt.updatePricing(G.id,{Cost:Number(S)||0});const oe=await fl();V(oe?.rows||[])}else G.source==="products"&&G.id&&(await ln.fetchWithAuth(`/products/${G.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...G.raw,price:Number(S)||0})}),await Ae());_(null),C(""),l("Pricing updated")}catch{l("Update failed")}},children:"Save"}),f.jsx("button",{className:"button",onClick:()=>{_(null),C("")},children:"Cancel"})]}):f.jsx("button",{className:"button",onClick:()=>{_(G.id||G.particulars),C(G.cost||"")},children:"Edit"})})]},G.id||G.particulars)})]}),Me.bundle.length>0&&f.jsxs(f.Fragment,{children:[f.jsx("tr",{style:{background:"var(--muted-background)",fontWeight:700},children:f.jsx("td",{colSpan:6,style:{padding:8},children:"Gym & Coach Bundle"})}),Me.bundle.map(G=>{const he=v===(G.id||G.particulars);return f.jsxs("tr",{style:{borderTop:"1px solid var(--light-border)"},children:[f.jsx("td",{style:{padding:"6px 8px"},children:G.particulars}),f.jsx("td",{style:{textAlign:"center"},children:G.gym}),f.jsx("td",{style:{textAlign:"center"},children:G.coach}),f.jsx("td",{style:{textAlign:"center"},children:he?f.jsx("input",{value:S,onChange:oe=>C(oe.target.value),style:{width:96}}):G.cost||""}),f.jsx("td",{style:{textAlign:"center"},children:G.validity||""}),f.jsx("td",{style:{textAlign:"right"},children:he?f.jsxs(f.Fragment,{children:[f.jsx("button",{className:"button",onClick:async()=>{try{if(G.source==="pricing"){await kt.updatePricing(G.id,{Cost:Number(S)||0});const oe=await fl();V(oe?.rows||[])}else G.source==="products"&&G.id&&(await ln.fetchWithAuth(`/products/${G.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...G.raw,price:Number(S)||0})}),await Ae());_(null),C(""),l("Pricing updated")}catch{l("Update failed")}},children:"Save"}),f.jsx("button",{className:"button",onClick:()=>{_(null),C("")},children:"Cancel"})]}):f.jsx("button",{className:"button",onClick:()=>{_(G.id||G.particulars),C(G.cost||"")},children:"Edit"})})]},G.id||G.particulars)})]}),Me.merch.length>0&&f.jsxs(f.Fragment,{children:[f.jsx("tr",{style:{background:"var(--muted-background)",fontWeight:700},children:f.jsx("td",{colSpan:6,style:{padding:8},children:"Merchandise"})}),Me.merch.map(G=>{const he=v===(G.id||G.particulars);return f.jsxs("tr",{style:{borderTop:"1px solid var(--light-border)"},children:[f.jsx("td",{style:{padding:"6px 8px"},children:G.particulars}),f.jsx("td",{style:{textAlign:"center"},children:G.gym}),f.jsx("td",{style:{textAlign:"center"},children:G.coach}),f.jsx("td",{style:{textAlign:"center"},children:he?f.jsx("input",{value:S,onChange:oe=>C(oe.target.value),style:{width:96}}):G.cost||""}),f.jsx("td",{style:{textAlign:"center"},children:G.validity||""}),f.jsx("td",{style:{textAlign:"right"},children:he?f.jsxs(f.Fragment,{children:[f.jsx("button",{className:"button",onClick:async()=>{try{if(G.source==="pricing"){await kt.updatePricing(G.id,{Cost:Number(S)||0});const oe=await fl();V(oe?.rows||[])}else G.source==="products"&&G.id&&(await ln.fetchWithAuth(`/products/${G.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...G.raw,price:Number(S)||0})}),await Ae());_(null),C(""),l("Pricing updated")}catch{l("Update failed")}},children:"Save"}),f.jsx("button",{className:"button",onClick:()=>{_(null),C("")},children:"Cancel"})]}):f.jsx("button",{className:"button",onClick:()=>{_(G.id||G.particulars),C(G.cost||"")},children:"Edit"})})]},G.id||G.particulars)})]})]})})]})]})]}),a&&f.jsx("div",{style:{marginTop:12,color:"#2b7",fontWeight:600},children:a})]})})}function k6(){const[n,e]=T.useState([]);return T.useEffect(()=>{const t=Gn.on("modal:error",s=>{const a=Date.now()+Math.random(),l={id:a,message:s?.message||"An error occurred",source:s?.source||""};e(u=>[...u,l]),setTimeout(()=>e(u=>u.filter(g=>g.id!==a)),6e3)});return()=>t()},[]),n.length?f.jsx("div",{style:{position:"fixed",top:20,right:20,zIndex:99999,display:"flex",flexDirection:"column",gap:8},children:n.map(t=>f.jsxs("div",{style:{background:"#111",color:"#fff",padding:"10px 14px",borderRadius:10,minWidth:240,boxShadow:"0 8px 24px rgba(0,0,0,.2)"},children:[f.jsx("div",{style:{fontWeight:700,marginBottom:4},children:t.source||"Error"}),f.jsx("div",{style:{fontSize:13},children:t.message})]},t.id))}):null}function P6(){const[n,e]=T.useState("");T.useEffect(()=>{const a=ln.getToken();a&&e(a)},[]);const t=a=>{e(a);try{ln.setToken(a)}catch{}},s=()=>{e(""),localStorage.removeItem("authToken")};return n?f.jsxs("div",{className:"app",children:[f.jsx(k6,{}),f.jsx(MV,{onLogout:s}),f.jsx("div",{className:"main-content",children:f.jsxs(xI,{children:[f.jsx(ra,{path:"/",element:f.jsx(e4,{})}),f.jsx(ra,{path:"/attendance",element:f.jsx(O6,{})}),f.jsx(ra,{path:"/members",element:f.jsx(w6,{})}),f.jsx(ra,{path:"/members/:memberId",element:f.jsx(KL,{})}),f.jsx(ra,{path:"/checkin",element:f.jsx(D6,{})}),f.jsx(ra,{path:"/admin",element:f.jsx(j6,{})}),f.jsx(ra,{path:"*",element:f.jsx(AI,{to:"/",replace:!0})})]})})]}):f.jsx(DV,{setToken:t})}class V6 extends Ct.Component{constructor(e){super(e),this.state={error:null,info:null}}componentDidCatch(e,t){this.setState({error:e,info:t})}render(){const{error:e,info:t}=this.state;return e?f.jsxs("div",{style:{padding:24,fontFamily:"sans-serif"},children:[f.jsx("h2",{style:{color:"#c92a2a"},children:"Application error"}),f.jsx("div",{style:{marginBottom:12,color:"#444"},children:"An uncaught error occurred while rendering the app."}),f.jsxs("details",{style:{whiteSpace:"pre-wrap",background:"#fff8f8",padding:12,borderRadius:6,border:"1px solid #ffd6d6"},children:[f.jsx("summary",{style:{cursor:"pointer",fontWeight:700},children:"Error details"}),f.jsx("div",{style:{marginTop:8},children:String(e&&e.toString())}),f.jsx("div",{style:{marginTop:8},children:t&&t.componentStack})]})]}):this.props.children}}try{console.log("[app] starting main.jsx",{base:"/",hasClientId:!1});const n=document.getElementById("root");n&&(n.innerHTML='<div style="padding:20px;font-family:sans-serif;color:#333">Mounting Kusgan app...</div>')}catch{}try{jR.createRoot(document.getElementById("root")).render(f.jsx(Ct.StrictMode,{children:f.jsx(lN,{clientId:"",children:f.jsx(WI,{children:f.jsx(V6,{children:f.jsx(P6,{})})})})}))}catch(n){console.error("[app] render failure",n);const e=document.getElementById("root");e&&(e.innerHTML=`<div style="padding:20px;font-family:sans-serif;color:#900"><h2>Render error</h2><pre>${String(n)}</pre></div>`)}export{KV as C,To as M,WV as a,kt as b,Gn as e,ZV as g,f as j,hs as l,T as r,Ll as u};
