function lb(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function cb(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Kw={exports:{}},Ju={},Yw={exports:{}},Le={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kl=Symbol.for("react.element"),ub=Symbol.for("react.portal"),db=Symbol.for("react.fragment"),hb=Symbol.for("react.strict_mode"),fb=Symbol.for("react.profiler"),mb=Symbol.for("react.provider"),pb=Symbol.for("react.context"),gb=Symbol.for("react.forward_ref"),yb=Symbol.for("react.suspense"),vb=Symbol.for("react.memo"),_b=Symbol.for("react.lazy"),Iy=Symbol.iterator;function wb(t){return t===null||typeof t!="object"?null:(t=Iy&&t[Iy]||t["@@iterator"],typeof t=="function"?t:null)}var Xw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Jw=Object.assign,Zw={};function qo(t,e,n){this.props=t,this.context=e,this.refs=Zw,this.updater=n||Xw}qo.prototype.isReactComponent={};qo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};qo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function e0(){}e0.prototype=qo.prototype;function Wm(t,e,n){this.props=t,this.context=e,this.refs=Zw,this.updater=n||Xw}var qm=Wm.prototype=new e0;qm.constructor=Wm;Jw(qm,qo.prototype);qm.isPureReactComponent=!0;var by=Array.isArray,t0=Object.prototype.hasOwnProperty,Gm={current:null},n0={key:!0,ref:!0,__self:!0,__source:!0};function r0(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)t0.call(e,r)&&!n0.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var a=Array(l),d=0;d<l;d++)a[d]=arguments[d+2];i.children=a}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:kl,type:t,key:s,ref:o,props:i,_owner:Gm.current}}function Sb(t,e){return{$$typeof:kl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Qm(t){return typeof t=="object"&&t!==null&&t.$$typeof===kl}function Eb(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var xy=/\/+/g;function th(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Eb(""+t.key):e.toString(36)}function Lc(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case kl:case ub:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+th(o,0):r,by(i)?(n="",t!=null&&(n=t.replace(xy,"$&/")+"/"),Lc(i,e,n,"",function(d){return d})):i!=null&&(Qm(i)&&(i=Sb(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(xy,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",by(t))for(var l=0;l<t.length;l++){s=t[l];var a=r+th(s,l);o+=Lc(s,e,n,a,i)}else if(a=wb(t),typeof a=="function")for(t=a.call(t),l=0;!(s=t.next()).done;)s=s.value,a=r+th(s,l++),o+=Lc(s,e,n,a,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function rc(t,e,n){if(t==null)return t;var r=[],i=0;return Lc(t,r,"","",function(s){return e.call(n,s,i++)}),r}function Tb(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var xn={current:null},Vc={transition:null},Ib={ReactCurrentDispatcher:xn,ReactCurrentBatchConfig:Vc,ReactCurrentOwner:Gm};function i0(){throw Error("act(...) is not supported in production builds of React.")}Le.Children={map:rc,forEach:function(t,e,n){rc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return rc(t,function(){e++}),e},toArray:function(t){return rc(t,function(e){return e})||[]},only:function(t){if(!Qm(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Le.Component=qo;Le.Fragment=db;Le.Profiler=fb;Le.PureComponent=Wm;Le.StrictMode=hb;Le.Suspense=yb;Le.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ib;Le.act=i0;Le.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Jw({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Gm.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(a in e)t0.call(e,a)&&!n0.hasOwnProperty(a)&&(r[a]=e[a]===void 0&&l!==void 0?l[a]:e[a])}var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){l=Array(a);for(var d=0;d<a;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:kl,type:t.type,key:i,ref:s,props:r,_owner:o}};Le.createContext=function(t){return t={$$typeof:pb,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:mb,_context:t},t.Consumer=t};Le.createElement=r0;Le.createFactory=function(t){var e=r0.bind(null,t);return e.type=t,e};Le.createRef=function(){return{current:null}};Le.forwardRef=function(t){return{$$typeof:gb,render:t}};Le.isValidElement=Qm;Le.lazy=function(t){return{$$typeof:_b,_payload:{_status:-1,_result:t},_init:Tb}};Le.memo=function(t,e){return{$$typeof:vb,type:t,compare:e===void 0?null:e}};Le.startTransition=function(t){var e=Vc.transition;Vc.transition={};try{t()}finally{Vc.transition=e}};Le.unstable_act=i0;Le.useCallback=function(t,e){return xn.current.useCallback(t,e)};Le.useContext=function(t){return xn.current.useContext(t)};Le.useDebugValue=function(){};Le.useDeferredValue=function(t){return xn.current.useDeferredValue(t)};Le.useEffect=function(t,e){return xn.current.useEffect(t,e)};Le.useId=function(){return xn.current.useId()};Le.useImperativeHandle=function(t,e,n){return xn.current.useImperativeHandle(t,e,n)};Le.useInsertionEffect=function(t,e){return xn.current.useInsertionEffect(t,e)};Le.useLayoutEffect=function(t,e){return xn.current.useLayoutEffect(t,e)};Le.useMemo=function(t,e){return xn.current.useMemo(t,e)};Le.useReducer=function(t,e,n){return xn.current.useReducer(t,e,n)};Le.useRef=function(t){return xn.current.useRef(t)};Le.useState=function(t){return xn.current.useState(t)};Le.useSyncExternalStore=function(t,e,n){return xn.current.useSyncExternalStore(t,e,n)};Le.useTransition=function(){return xn.current.useTransition()};Le.version="18.3.1";Yw.exports=Le;var C=Yw.exports;const We=cb(C),bb=lb({__proto__:null,default:We},[C]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xb=C,Cb=Symbol.for("react.element"),Ab=Symbol.for("react.fragment"),Nb=Object.prototype.hasOwnProperty,kb=xb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Pb={key:!0,ref:!0,__self:!0,__source:!0};function s0(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)Nb.call(e,r)&&!Pb.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:Cb,type:t,key:s,ref:o,props:i,_owner:kb.current}}Ju.Fragment=Ab;Ju.jsx=s0;Ju.jsxs=s0;Kw.exports=Ju;var u=Kw.exports,of={},o0={exports:{}},qn={},a0={exports:{}},l0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(V,K){var B=V.length;V.push(K);e:for(;0<B;){var X=B-1>>>1,$=V[X];if(0<i($,K))V[X]=K,V[B]=$,B=X;else break e}}function n(V){return V.length===0?null:V[0]}function r(V){if(V.length===0)return null;var K=V[0],B=V.pop();if(B!==K){V[0]=B;e:for(var X=0,$=V.length,Z=$>>>1;X<Z;){var q=2*(X+1)-1,ae=V[q],D=q+1,G=V[D];if(0>i(ae,B))D<$&&0>i(G,ae)?(V[X]=G,V[D]=B,X=D):(V[X]=ae,V[q]=B,X=q);else if(D<$&&0>i(G,B))V[X]=G,V[D]=B,X=D;else break e}}return K}function i(V,K){var B=V.sortIndex-K.sortIndex;return B!==0?B:V.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var a=[],d=[],h=1,f=null,m=3,g=!1,S=!1,_=!1,A=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(V){for(var K=n(d);K!==null;){if(K.callback===null)r(d);else if(K.startTime<=V)r(d),K.sortIndex=K.expirationTime,e(a,K);else break;K=n(d)}}function j(V){if(_=!1,b(V),!S)if(n(a)!==null)S=!0,ne(M);else{var K=n(d);K!==null&&ce(j,K.startTime-V)}}function M(V,K){S=!1,_&&(_=!1,v(I),I=-1),g=!0;var B=m;try{for(b(K),f=n(a);f!==null&&(!(f.expirationTime>K)||V&&!T());){var X=f.callback;if(typeof X=="function"){f.callback=null,m=f.priorityLevel;var $=X(f.expirationTime<=K);K=t.unstable_now(),typeof $=="function"?f.callback=$:f===n(a)&&r(a),b(K)}else r(a);f=n(a)}if(f!==null)var Z=!0;else{var q=n(d);q!==null&&ce(j,q.startTime-K),Z=!1}return Z}finally{f=null,m=B,g=!1}}var U=!1,x=null,I=-1,R=5,E=-1;function T(){return!(t.unstable_now()-E<R)}function k(){if(x!==null){var V=t.unstable_now();E=V;var K=!0;try{K=x(!0,V)}finally{K?N():(U=!1,x=null)}}else U=!1}var N;if(typeof w=="function")N=function(){w(k)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,J=te.port2;te.port1.onmessage=k,N=function(){J.postMessage(null)}}else N=function(){A(k,0)};function ne(V){x=V,U||(U=!0,N())}function ce(V,K){I=A(function(){V(t.unstable_now())},K)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(V){V.callback=null},t.unstable_continueExecution=function(){S||g||(S=!0,ne(M))},t.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<V?Math.floor(1e3/V):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(a)},t.unstable_next=function(V){switch(m){case 1:case 2:case 3:var K=3;break;default:K=m}var B=m;m=K;try{return V()}finally{m=B}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(V,K){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var B=m;m=V;try{return K()}finally{m=B}},t.unstable_scheduleCallback=function(V,K,B){var X=t.unstable_now();switch(typeof B=="object"&&B!==null?(B=B.delay,B=typeof B=="number"&&0<B?X+B:X):B=X,V){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=B+$,V={id:h++,callback:K,priorityLevel:V,startTime:B,expirationTime:$,sortIndex:-1},B>X?(V.sortIndex=B,e(d,V),n(a)===null&&V===n(d)&&(_?(v(I),I=-1):_=!0,ce(j,B-X))):(V.sortIndex=$,e(a,V),S||g||(S=!0,ne(M))),V},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(V){var K=m;return function(){var B=m;m=K;try{return V.apply(this,arguments)}finally{m=B}}}})(l0);a0.exports=l0;var Rb=a0.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Db=C,Wn=Rb;function he(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var c0=new Set,Za={};function Ls(t,e){ko(t,e),ko(t+"Capture",e)}function ko(t,e){for(Za[t]=e,t=0;t<e.length;t++)c0.add(e[t])}var qr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),af=Object.prototype.hasOwnProperty,jb=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Cy={},Ay={};function Mb(t){return af.call(Ay,t)?!0:af.call(Cy,t)?!1:jb.test(t)?Ay[t]=!0:(Cy[t]=!0,!1)}function Ob(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Lb(t,e,n,r){if(e===null||typeof e>"u"||Ob(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Cn(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var hn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){hn[t]=new Cn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];hn[e]=new Cn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){hn[t]=new Cn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){hn[t]=new Cn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){hn[t]=new Cn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){hn[t]=new Cn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){hn[t]=new Cn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){hn[t]=new Cn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){hn[t]=new Cn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Km=/[\-:]([a-z])/g;function Ym(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Km,Ym);hn[e]=new Cn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Km,Ym);hn[e]=new Cn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Km,Ym);hn[e]=new Cn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){hn[t]=new Cn(t,1,!1,t.toLowerCase(),null,!1,!1)});hn.xlinkHref=new Cn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){hn[t]=new Cn(t,1,!1,t.toLowerCase(),null,!0,!0)});function Xm(t,e,n,r){var i=hn.hasOwnProperty(e)?hn[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Lb(e,n,i,r)&&(n=null),r||i===null?Mb(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ei=Db.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ic=Symbol.for("react.element"),io=Symbol.for("react.portal"),so=Symbol.for("react.fragment"),Jm=Symbol.for("react.strict_mode"),lf=Symbol.for("react.profiler"),u0=Symbol.for("react.provider"),d0=Symbol.for("react.context"),Zm=Symbol.for("react.forward_ref"),cf=Symbol.for("react.suspense"),uf=Symbol.for("react.suspense_list"),ep=Symbol.for("react.memo"),mi=Symbol.for("react.lazy"),h0=Symbol.for("react.offscreen"),Ny=Symbol.iterator;function ha(t){return t===null||typeof t!="object"?null:(t=Ny&&t[Ny]||t["@@iterator"],typeof t=="function"?t:null)}var kt=Object.assign,nh;function xa(t){if(nh===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);nh=e&&e[1]||""}return`
`+nh+t}var rh=!1;function ih(t,e){if(!t||rh)return"";rh=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==s[l]){var a=`
`+i[o].replace(" at new "," at ");return t.displayName&&a.includes("<anonymous>")&&(a=a.replace("<anonymous>",t.displayName)),a}while(1<=o&&0<=l);break}}}finally{rh=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?xa(t):""}function Vb(t){switch(t.tag){case 5:return xa(t.type);case 16:return xa("Lazy");case 13:return xa("Suspense");case 19:return xa("SuspenseList");case 0:case 2:case 15:return t=ih(t.type,!1),t;case 11:return t=ih(t.type.render,!1),t;case 1:return t=ih(t.type,!0),t;default:return""}}function df(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case so:return"Fragment";case io:return"Portal";case lf:return"Profiler";case Jm:return"StrictMode";case cf:return"Suspense";case uf:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case d0:return(t.displayName||"Context")+".Consumer";case u0:return(t._context.displayName||"Context")+".Provider";case Zm:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case ep:return e=t.displayName||null,e!==null?e:df(t.type)||"Memo";case mi:e=t._payload,t=t._init;try{return df(t(e))}catch{}}return null}function Fb(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return df(e);case 8:return e===Jm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ui(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function f0(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Ub(t){var e=f0(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function sc(t){t._valueTracker||(t._valueTracker=Ub(t))}function m0(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=f0(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function iu(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function hf(t,e){var n=e.checked;return kt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function ky(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ui(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function p0(t,e){e=e.checked,e!=null&&Xm(t,"checked",e,!1)}function ff(t,e){p0(t,e);var n=Ui(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?mf(t,e.type,n):e.hasOwnProperty("defaultValue")&&mf(t,e.type,Ui(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Py(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function mf(t,e,n){(e!=="number"||iu(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Ca=Array.isArray;function vo(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ui(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function pf(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(he(91));return kt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Ry(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(he(92));if(Ca(n)){if(1<n.length)throw Error(he(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ui(n)}}function g0(t,e){var n=Ui(e.value),r=Ui(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Dy(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function y0(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function gf(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?y0(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var oc,v0=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(oc=oc||document.createElement("div"),oc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=oc.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function el(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ma={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Bb=["Webkit","ms","Moz","O"];Object.keys(Ma).forEach(function(t){Bb.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ma[e]=Ma[t]})});function _0(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ma.hasOwnProperty(t)&&Ma[t]?(""+e).trim():e+"px"}function w0(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=_0(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var $b=kt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function yf(t,e){if(e){if($b[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(he(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(he(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(he(61))}if(e.style!=null&&typeof e.style!="object")throw Error(he(62))}}function vf(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _f=null;function tp(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var wf=null,_o=null,wo=null;function jy(t){if(t=Dl(t)){if(typeof wf!="function")throw Error(he(280));var e=t.stateNode;e&&(e=rd(e),wf(t.stateNode,t.type,e))}}function S0(t){_o?wo?wo.push(t):wo=[t]:_o=t}function E0(){if(_o){var t=_o,e=wo;if(wo=_o=null,jy(t),e)for(t=0;t<e.length;t++)jy(e[t])}}function T0(t,e){return t(e)}function I0(){}var sh=!1;function b0(t,e,n){if(sh)return t(e,n);sh=!0;try{return T0(t,e,n)}finally{sh=!1,(_o!==null||wo!==null)&&(I0(),E0())}}function tl(t,e){var n=t.stateNode;if(n===null)return null;var r=rd(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(he(231,e,typeof n));return n}var Sf=!1;if(qr)try{var fa={};Object.defineProperty(fa,"passive",{get:function(){Sf=!0}}),window.addEventListener("test",fa,fa),window.removeEventListener("test",fa,fa)}catch{Sf=!1}function zb(t,e,n,r,i,s,o,l,a){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var Oa=!1,su=null,ou=!1,Ef=null,Hb={onError:function(t){Oa=!0,su=t}};function Wb(t,e,n,r,i,s,o,l,a){Oa=!1,su=null,zb.apply(Hb,arguments)}function qb(t,e,n,r,i,s,o,l,a){if(Wb.apply(this,arguments),Oa){if(Oa){var d=su;Oa=!1,su=null}else throw Error(he(198));ou||(ou=!0,Ef=d)}}function Vs(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function x0(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function My(t){if(Vs(t)!==t)throw Error(he(188))}function Gb(t){var e=t.alternate;if(!e){if(e=Vs(t),e===null)throw Error(he(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return My(i),t;if(s===r)return My(i),e;s=s.sibling}throw Error(he(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o)throw Error(he(189))}}if(n.alternate!==r)throw Error(he(190))}if(n.tag!==3)throw Error(he(188));return n.stateNode.current===n?t:e}function C0(t){return t=Gb(t),t!==null?A0(t):null}function A0(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=A0(t);if(e!==null)return e;t=t.sibling}return null}var N0=Wn.unstable_scheduleCallback,Oy=Wn.unstable_cancelCallback,Qb=Wn.unstable_shouldYield,Kb=Wn.unstable_requestPaint,Ft=Wn.unstable_now,Yb=Wn.unstable_getCurrentPriorityLevel,np=Wn.unstable_ImmediatePriority,k0=Wn.unstable_UserBlockingPriority,au=Wn.unstable_NormalPriority,Xb=Wn.unstable_LowPriority,P0=Wn.unstable_IdlePriority,Zu=null,Cr=null;function Jb(t){if(Cr&&typeof Cr.onCommitFiberRoot=="function")try{Cr.onCommitFiberRoot(Zu,t,void 0,(t.current.flags&128)===128)}catch{}}var ar=Math.clz32?Math.clz32:tx,Zb=Math.log,ex=Math.LN2;function tx(t){return t>>>=0,t===0?32:31-(Zb(t)/ex|0)|0}var ac=64,lc=4194304;function Aa(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function lu(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~i;l!==0?r=Aa(l):(s&=o,s!==0&&(r=Aa(s)))}else o=n&~i,o!==0?r=Aa(o):s!==0&&(r=Aa(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-ar(e),i=1<<n,r|=t[n],e&=~i;return r}function nx(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function rx(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-ar(s),l=1<<o,a=i[o];a===-1?(!(l&n)||l&r)&&(i[o]=nx(l,e)):a<=e&&(t.expiredLanes|=l),s&=~l}}function Tf(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function R0(){var t=ac;return ac<<=1,!(ac&4194240)&&(ac=64),t}function oh(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Pl(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ar(e),t[e]=n}function ix(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-ar(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function rp(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-ar(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var st=0;function D0(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var j0,ip,M0,O0,L0,If=!1,cc=[],Ci=null,Ai=null,Ni=null,nl=new Map,rl=new Map,gi=[],sx="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ly(t,e){switch(t){case"focusin":case"focusout":Ci=null;break;case"dragenter":case"dragleave":Ai=null;break;case"mouseover":case"mouseout":Ni=null;break;case"pointerover":case"pointerout":nl.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":rl.delete(e.pointerId)}}function ma(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Dl(e),e!==null&&ip(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function ox(t,e,n,r,i){switch(e){case"focusin":return Ci=ma(Ci,t,e,n,r,i),!0;case"dragenter":return Ai=ma(Ai,t,e,n,r,i),!0;case"mouseover":return Ni=ma(Ni,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return nl.set(s,ma(nl.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,rl.set(s,ma(rl.get(s)||null,t,e,n,r,i)),!0}return!1}function V0(t){var e=gs(t.target);if(e!==null){var n=Vs(e);if(n!==null){if(e=n.tag,e===13){if(e=x0(n),e!==null){t.blockedOn=e,L0(t.priority,function(){M0(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Fc(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=bf(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);_f=r,n.target.dispatchEvent(r),_f=null}else return e=Dl(n),e!==null&&ip(e),t.blockedOn=n,!1;e.shift()}return!0}function Vy(t,e,n){Fc(t)&&n.delete(e)}function ax(){If=!1,Ci!==null&&Fc(Ci)&&(Ci=null),Ai!==null&&Fc(Ai)&&(Ai=null),Ni!==null&&Fc(Ni)&&(Ni=null),nl.forEach(Vy),rl.forEach(Vy)}function pa(t,e){t.blockedOn===e&&(t.blockedOn=null,If||(If=!0,Wn.unstable_scheduleCallback(Wn.unstable_NormalPriority,ax)))}function il(t){function e(i){return pa(i,t)}if(0<cc.length){pa(cc[0],t);for(var n=1;n<cc.length;n++){var r=cc[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ci!==null&&pa(Ci,t),Ai!==null&&pa(Ai,t),Ni!==null&&pa(Ni,t),nl.forEach(e),rl.forEach(e),n=0;n<gi.length;n++)r=gi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<gi.length&&(n=gi[0],n.blockedOn===null);)V0(n),n.blockedOn===null&&gi.shift()}var So=ei.ReactCurrentBatchConfig,cu=!0;function lx(t,e,n,r){var i=st,s=So.transition;So.transition=null;try{st=1,sp(t,e,n,r)}finally{st=i,So.transition=s}}function cx(t,e,n,r){var i=st,s=So.transition;So.transition=null;try{st=4,sp(t,e,n,r)}finally{st=i,So.transition=s}}function sp(t,e,n,r){if(cu){var i=bf(t,e,n,r);if(i===null)gh(t,e,r,uu,n),Ly(t,r);else if(ox(i,t,e,n,r))r.stopPropagation();else if(Ly(t,r),e&4&&-1<sx.indexOf(t)){for(;i!==null;){var s=Dl(i);if(s!==null&&j0(s),s=bf(t,e,n,r),s===null&&gh(t,e,r,uu,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else gh(t,e,r,null,n)}}var uu=null;function bf(t,e,n,r){if(uu=null,t=tp(r),t=gs(t),t!==null)if(e=Vs(t),e===null)t=null;else if(n=e.tag,n===13){if(t=x0(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return uu=t,null}function F0(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Yb()){case np:return 1;case k0:return 4;case au:case Xb:return 16;case P0:return 536870912;default:return 16}default:return 16}}var Ei=null,op=null,Uc=null;function U0(){if(Uc)return Uc;var t,e=op,n=e.length,r,i="value"in Ei?Ei.value:Ei.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return Uc=i.slice(t,1<r?1-r:void 0)}function Bc(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function uc(){return!0}function Fy(){return!1}function Gn(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?uc:Fy,this.isPropagationStopped=Fy,this}return kt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=uc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=uc)},persist:function(){},isPersistent:uc}),e}var Go={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ap=Gn(Go),Rl=kt({},Go,{view:0,detail:0}),ux=Gn(Rl),ah,lh,ga,ed=kt({},Rl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lp,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ga&&(ga&&t.type==="mousemove"?(ah=t.screenX-ga.screenX,lh=t.screenY-ga.screenY):lh=ah=0,ga=t),ah)},movementY:function(t){return"movementY"in t?t.movementY:lh}}),Uy=Gn(ed),dx=kt({},ed,{dataTransfer:0}),hx=Gn(dx),fx=kt({},Rl,{relatedTarget:0}),ch=Gn(fx),mx=kt({},Go,{animationName:0,elapsedTime:0,pseudoElement:0}),px=Gn(mx),gx=kt({},Go,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),yx=Gn(gx),vx=kt({},Go,{data:0}),By=Gn(vx),_x={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wx={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ex(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Sx[t])?!!e[t]:!1}function lp(){return Ex}var Tx=kt({},Rl,{key:function(t){if(t.key){var e=_x[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Bc(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?wx[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lp,charCode:function(t){return t.type==="keypress"?Bc(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Bc(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Ix=Gn(Tx),bx=kt({},ed,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$y=Gn(bx),xx=kt({},Rl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lp}),Cx=Gn(xx),Ax=kt({},Go,{propertyName:0,elapsedTime:0,pseudoElement:0}),Nx=Gn(Ax),kx=kt({},ed,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Px=Gn(kx),Rx=[9,13,27,32],cp=qr&&"CompositionEvent"in window,La=null;qr&&"documentMode"in document&&(La=document.documentMode);var Dx=qr&&"TextEvent"in window&&!La,B0=qr&&(!cp||La&&8<La&&11>=La),zy=" ",Hy=!1;function $0(t,e){switch(t){case"keyup":return Rx.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function z0(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var oo=!1;function jx(t,e){switch(t){case"compositionend":return z0(e);case"keypress":return e.which!==32?null:(Hy=!0,zy);case"textInput":return t=e.data,t===zy&&Hy?null:t;default:return null}}function Mx(t,e){if(oo)return t==="compositionend"||!cp&&$0(t,e)?(t=U0(),Uc=op=Ei=null,oo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return B0&&e.locale!=="ko"?null:e.data;default:return null}}var Ox={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Ox[t.type]:e==="textarea"}function H0(t,e,n,r){S0(r),e=du(e,"onChange"),0<e.length&&(n=new ap("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Va=null,sl=null;function Lx(t){tS(t,0)}function td(t){var e=co(t);if(m0(e))return t}function Vx(t,e){if(t==="change")return e}var W0=!1;if(qr){var uh;if(qr){var dh="oninput"in document;if(!dh){var qy=document.createElement("div");qy.setAttribute("oninput","return;"),dh=typeof qy.oninput=="function"}uh=dh}else uh=!1;W0=uh&&(!document.documentMode||9<document.documentMode)}function Gy(){Va&&(Va.detachEvent("onpropertychange",q0),sl=Va=null)}function q0(t){if(t.propertyName==="value"&&td(sl)){var e=[];H0(e,sl,t,tp(t)),b0(Lx,e)}}function Fx(t,e,n){t==="focusin"?(Gy(),Va=e,sl=n,Va.attachEvent("onpropertychange",q0)):t==="focusout"&&Gy()}function Ux(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return td(sl)}function Bx(t,e){if(t==="click")return td(e)}function $x(t,e){if(t==="input"||t==="change")return td(e)}function zx(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ur=typeof Object.is=="function"?Object.is:zx;function ol(t,e){if(ur(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!af.call(e,i)||!ur(t[i],e[i]))return!1}return!0}function Qy(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Ky(t,e){var n=Qy(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Qy(n)}}function G0(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?G0(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Q0(){for(var t=window,e=iu();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=iu(t.document)}return e}function up(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Hx(t){var e=Q0(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&G0(n.ownerDocument.documentElement,n)){if(r!==null&&up(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=Ky(n,s);var o=Ky(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Wx=qr&&"documentMode"in document&&11>=document.documentMode,ao=null,xf=null,Fa=null,Cf=!1;function Yy(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Cf||ao==null||ao!==iu(r)||(r=ao,"selectionStart"in r&&up(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Fa&&ol(Fa,r)||(Fa=r,r=du(xf,"onSelect"),0<r.length&&(e=new ap("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=ao)))}function dc(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var lo={animationend:dc("Animation","AnimationEnd"),animationiteration:dc("Animation","AnimationIteration"),animationstart:dc("Animation","AnimationStart"),transitionend:dc("Transition","TransitionEnd")},hh={},K0={};qr&&(K0=document.createElement("div").style,"AnimationEvent"in window||(delete lo.animationend.animation,delete lo.animationiteration.animation,delete lo.animationstart.animation),"TransitionEvent"in window||delete lo.transitionend.transition);function nd(t){if(hh[t])return hh[t];if(!lo[t])return t;var e=lo[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in K0)return hh[t]=e[n];return t}var Y0=nd("animationend"),X0=nd("animationiteration"),J0=nd("animationstart"),Z0=nd("transitionend"),eS=new Map,Xy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Yi(t,e){eS.set(t,e),Ls(e,[t])}for(var fh=0;fh<Xy.length;fh++){var mh=Xy[fh],qx=mh.toLowerCase(),Gx=mh[0].toUpperCase()+mh.slice(1);Yi(qx,"on"+Gx)}Yi(Y0,"onAnimationEnd");Yi(X0,"onAnimationIteration");Yi(J0,"onAnimationStart");Yi("dblclick","onDoubleClick");Yi("focusin","onFocus");Yi("focusout","onBlur");Yi(Z0,"onTransitionEnd");ko("onMouseEnter",["mouseout","mouseover"]);ko("onMouseLeave",["mouseout","mouseover"]);ko("onPointerEnter",["pointerout","pointerover"]);ko("onPointerLeave",["pointerout","pointerover"]);Ls("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ls("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ls("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ls("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ls("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ls("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Na="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Qx=new Set("cancel close invalid load scroll toggle".split(" ").concat(Na));function Jy(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,qb(r,e,void 0,t),t.currentTarget=null}function tS(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],a=l.instance,d=l.currentTarget;if(l=l.listener,a!==s&&i.isPropagationStopped())break e;Jy(i,l,d),s=a}else for(o=0;o<r.length;o++){if(l=r[o],a=l.instance,d=l.currentTarget,l=l.listener,a!==s&&i.isPropagationStopped())break e;Jy(i,l,d),s=a}}}if(ou)throw t=Ef,ou=!1,Ef=null,t}function pt(t,e){var n=e[Rf];n===void 0&&(n=e[Rf]=new Set);var r=t+"__bubble";n.has(r)||(nS(e,t,2,!1),n.add(r))}function ph(t,e,n){var r=0;e&&(r|=4),nS(n,t,r,e)}var hc="_reactListening"+Math.random().toString(36).slice(2);function al(t){if(!t[hc]){t[hc]=!0,c0.forEach(function(n){n!=="selectionchange"&&(Qx.has(n)||ph(n,!1,t),ph(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[hc]||(e[hc]=!0,ph("selectionchange",!1,e))}}function nS(t,e,n,r){switch(F0(e)){case 1:var i=lx;break;case 4:i=cx;break;default:i=sp}n=i.bind(null,e,n,t),i=void 0,!Sf||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function gh(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var a=o.tag;if((a===3||a===4)&&(a=o.stateNode.containerInfo,a===i||a.nodeType===8&&a.parentNode===i))return;o=o.return}for(;l!==null;){if(o=gs(l),o===null)return;if(a=o.tag,a===5||a===6){r=s=o;continue e}l=l.parentNode}}r=r.return}b0(function(){var d=s,h=tp(n),f=[];e:{var m=eS.get(t);if(m!==void 0){var g=ap,S=t;switch(t){case"keypress":if(Bc(n)===0)break e;case"keydown":case"keyup":g=Ix;break;case"focusin":S="focus",g=ch;break;case"focusout":S="blur",g=ch;break;case"beforeblur":case"afterblur":g=ch;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=Uy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=hx;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=Cx;break;case Y0:case X0:case J0:g=px;break;case Z0:g=Nx;break;case"scroll":g=ux;break;case"wheel":g=Px;break;case"copy":case"cut":case"paste":g=yx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=$y}var _=(e&4)!==0,A=!_&&t==="scroll",v=_?m!==null?m+"Capture":null:m;_=[];for(var w=d,b;w!==null;){b=w;var j=b.stateNode;if(b.tag===5&&j!==null&&(b=j,v!==null&&(j=tl(w,v),j!=null&&_.push(ll(w,j,b)))),A)break;w=w.return}0<_.length&&(m=new g(m,S,null,n,h),f.push({event:m,listeners:_}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",m&&n!==_f&&(S=n.relatedTarget||n.fromElement)&&(gs(S)||S[Gr]))break e;if((g||m)&&(m=h.window===h?h:(m=h.ownerDocument)?m.defaultView||m.parentWindow:window,g?(S=n.relatedTarget||n.toElement,g=d,S=S?gs(S):null,S!==null&&(A=Vs(S),S!==A||S.tag!==5&&S.tag!==6)&&(S=null)):(g=null,S=d),g!==S)){if(_=Uy,j="onMouseLeave",v="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(_=$y,j="onPointerLeave",v="onPointerEnter",w="pointer"),A=g==null?m:co(g),b=S==null?m:co(S),m=new _(j,w+"leave",g,n,h),m.target=A,m.relatedTarget=b,j=null,gs(h)===d&&(_=new _(v,w+"enter",S,n,h),_.target=b,_.relatedTarget=A,j=_),A=j,g&&S)t:{for(_=g,v=S,w=0,b=_;b;b=Qs(b))w++;for(b=0,j=v;j;j=Qs(j))b++;for(;0<w-b;)_=Qs(_),w--;for(;0<b-w;)v=Qs(v),b--;for(;w--;){if(_===v||v!==null&&_===v.alternate)break t;_=Qs(_),v=Qs(v)}_=null}else _=null;g!==null&&Zy(f,m,g,_,!1),S!==null&&A!==null&&Zy(f,A,S,_,!0)}}e:{if(m=d?co(d):window,g=m.nodeName&&m.nodeName.toLowerCase(),g==="select"||g==="input"&&m.type==="file")var M=Vx;else if(Wy(m))if(W0)M=$x;else{M=Ux;var U=Fx}else(g=m.nodeName)&&g.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(M=Bx);if(M&&(M=M(t,d))){H0(f,M,n,h);break e}U&&U(t,m,d),t==="focusout"&&(U=m._wrapperState)&&U.controlled&&m.type==="number"&&mf(m,"number",m.value)}switch(U=d?co(d):window,t){case"focusin":(Wy(U)||U.contentEditable==="true")&&(ao=U,xf=d,Fa=null);break;case"focusout":Fa=xf=ao=null;break;case"mousedown":Cf=!0;break;case"contextmenu":case"mouseup":case"dragend":Cf=!1,Yy(f,n,h);break;case"selectionchange":if(Wx)break;case"keydown":case"keyup":Yy(f,n,h)}var x;if(cp)e:{switch(t){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else oo?$0(t,n)&&(I="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(I="onCompositionStart");I&&(B0&&n.locale!=="ko"&&(oo||I!=="onCompositionStart"?I==="onCompositionEnd"&&oo&&(x=U0()):(Ei=h,op="value"in Ei?Ei.value:Ei.textContent,oo=!0)),U=du(d,I),0<U.length&&(I=new By(I,t,null,n,h),f.push({event:I,listeners:U}),x?I.data=x:(x=z0(n),x!==null&&(I.data=x)))),(x=Dx?jx(t,n):Mx(t,n))&&(d=du(d,"onBeforeInput"),0<d.length&&(h=new By("onBeforeInput","beforeinput",null,n,h),f.push({event:h,listeners:d}),h.data=x))}tS(f,e)})}function ll(t,e,n){return{instance:t,listener:e,currentTarget:n}}function du(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=tl(t,n),s!=null&&r.unshift(ll(t,s,i)),s=tl(t,e),s!=null&&r.push(ll(t,s,i))),t=t.return}return r}function Qs(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Zy(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var l=n,a=l.alternate,d=l.stateNode;if(a!==null&&a===r)break;l.tag===5&&d!==null&&(l=d,i?(a=tl(n,s),a!=null&&o.unshift(ll(n,a,l))):i||(a=tl(n,s),a!=null&&o.push(ll(n,a,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var Kx=/\r\n?/g,Yx=/\u0000|\uFFFD/g;function ev(t){return(typeof t=="string"?t:""+t).replace(Kx,`
`).replace(Yx,"")}function fc(t,e,n){if(e=ev(e),ev(t)!==e&&n)throw Error(he(425))}function hu(){}var Af=null,Nf=null;function kf(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Pf=typeof setTimeout=="function"?setTimeout:void 0,Xx=typeof clearTimeout=="function"?clearTimeout:void 0,tv=typeof Promise=="function"?Promise:void 0,Jx=typeof queueMicrotask=="function"?queueMicrotask:typeof tv<"u"?function(t){return tv.resolve(null).then(t).catch(Zx)}:Pf;function Zx(t){setTimeout(function(){throw t})}function yh(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),il(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);il(e)}function ki(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function nv(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Qo=Math.random().toString(36).slice(2),Tr="__reactFiber$"+Qo,cl="__reactProps$"+Qo,Gr="__reactContainer$"+Qo,Rf="__reactEvents$"+Qo,eC="__reactListeners$"+Qo,tC="__reactHandles$"+Qo;function gs(t){var e=t[Tr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Gr]||n[Tr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=nv(t);t!==null;){if(n=t[Tr])return n;t=nv(t)}return e}t=n,n=t.parentNode}return null}function Dl(t){return t=t[Tr]||t[Gr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function co(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(he(33))}function rd(t){return t[cl]||null}var Df=[],uo=-1;function Xi(t){return{current:t}}function yt(t){0>uo||(t.current=Df[uo],Df[uo]=null,uo--)}function ht(t,e){uo++,Df[uo]=t.current,t.current=e}var Bi={},En=Xi(Bi),Dn=Xi(!1),bs=Bi;function Po(t,e){var n=t.type.contextTypes;if(!n)return Bi;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function jn(t){return t=t.childContextTypes,t!=null}function fu(){yt(Dn),yt(En)}function rv(t,e,n){if(En.current!==Bi)throw Error(he(168));ht(En,e),ht(Dn,n)}function rS(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(he(108,Fb(t)||"Unknown",i));return kt({},n,r)}function mu(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Bi,bs=En.current,ht(En,t),ht(Dn,Dn.current),!0}function iv(t,e,n){var r=t.stateNode;if(!r)throw Error(he(169));n?(t=rS(t,e,bs),r.__reactInternalMemoizedMergedChildContext=t,yt(Dn),yt(En),ht(En,t)):yt(Dn),ht(Dn,n)}var Ur=null,id=!1,vh=!1;function iS(t){Ur===null?Ur=[t]:Ur.push(t)}function nC(t){id=!0,iS(t)}function Ji(){if(!vh&&Ur!==null){vh=!0;var t=0,e=st;try{var n=Ur;for(st=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Ur=null,id=!1}catch(i){throw Ur!==null&&(Ur=Ur.slice(t+1)),N0(np,Ji),i}finally{st=e,vh=!1}}return null}var ho=[],fo=0,pu=null,gu=0,Kn=[],Yn=0,xs=null,$r=1,zr="";function hs(t,e){ho[fo++]=gu,ho[fo++]=pu,pu=t,gu=e}function sS(t,e,n){Kn[Yn++]=$r,Kn[Yn++]=zr,Kn[Yn++]=xs,xs=t;var r=$r;t=zr;var i=32-ar(r)-1;r&=~(1<<i),n+=1;var s=32-ar(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,$r=1<<32-ar(e)+i|n<<i|r,zr=s+t}else $r=1<<s|n<<i|r,zr=t}function dp(t){t.return!==null&&(hs(t,1),sS(t,1,0))}function hp(t){for(;t===pu;)pu=ho[--fo],ho[fo]=null,gu=ho[--fo],ho[fo]=null;for(;t===xs;)xs=Kn[--Yn],Kn[Yn]=null,zr=Kn[--Yn],Kn[Yn]=null,$r=Kn[--Yn],Kn[Yn]=null}var Hn=null,Bn=null,Et=!1,or=null;function oS(t,e){var n=Jn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function sv(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Hn=t,Bn=ki(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Hn=t,Bn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=xs!==null?{id:$r,overflow:zr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Jn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Hn=t,Bn=null,!0):!1;default:return!1}}function jf(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Mf(t){if(Et){var e=Bn;if(e){var n=e;if(!sv(t,e)){if(jf(t))throw Error(he(418));e=ki(n.nextSibling);var r=Hn;e&&sv(t,e)?oS(r,n):(t.flags=t.flags&-4097|2,Et=!1,Hn=t)}}else{if(jf(t))throw Error(he(418));t.flags=t.flags&-4097|2,Et=!1,Hn=t}}}function ov(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Hn=t}function mc(t){if(t!==Hn)return!1;if(!Et)return ov(t),Et=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!kf(t.type,t.memoizedProps)),e&&(e=Bn)){if(jf(t))throw aS(),Error(he(418));for(;e;)oS(t,e),e=ki(e.nextSibling)}if(ov(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(he(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Bn=ki(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Bn=null}}else Bn=Hn?ki(t.stateNode.nextSibling):null;return!0}function aS(){for(var t=Bn;t;)t=ki(t.nextSibling)}function Ro(){Bn=Hn=null,Et=!1}function fp(t){or===null?or=[t]:or.push(t)}var rC=ei.ReactCurrentBatchConfig;function ya(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(he(309));var r=n.stateNode}if(!r)throw Error(he(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var l=i.refs;o===null?delete l[s]:l[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(he(284));if(!n._owner)throw Error(he(290,t))}return t}function pc(t,e){throw t=Object.prototype.toString.call(e),Error(he(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function av(t){var e=t._init;return e(t._payload)}function lS(t){function e(v,w){if(t){var b=v.deletions;b===null?(v.deletions=[w],v.flags|=16):b.push(w)}}function n(v,w){if(!t)return null;for(;w!==null;)e(v,w),w=w.sibling;return null}function r(v,w){for(v=new Map;w!==null;)w.key!==null?v.set(w.key,w):v.set(w.index,w),w=w.sibling;return v}function i(v,w){return v=ji(v,w),v.index=0,v.sibling=null,v}function s(v,w,b){return v.index=b,t?(b=v.alternate,b!==null?(b=b.index,b<w?(v.flags|=2,w):b):(v.flags|=2,w)):(v.flags|=1048576,w)}function o(v){return t&&v.alternate===null&&(v.flags|=2),v}function l(v,w,b,j){return w===null||w.tag!==6?(w=bh(b,v.mode,j),w.return=v,w):(w=i(w,b),w.return=v,w)}function a(v,w,b,j){var M=b.type;return M===so?h(v,w,b.props.children,j,b.key):w!==null&&(w.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===mi&&av(M)===w.type)?(j=i(w,b.props),j.ref=ya(v,w,b),j.return=v,j):(j=Qc(b.type,b.key,b.props,null,v.mode,j),j.ref=ya(v,w,b),j.return=v,j)}function d(v,w,b,j){return w===null||w.tag!==4||w.stateNode.containerInfo!==b.containerInfo||w.stateNode.implementation!==b.implementation?(w=xh(b,v.mode,j),w.return=v,w):(w=i(w,b.children||[]),w.return=v,w)}function h(v,w,b,j,M){return w===null||w.tag!==7?(w=Es(b,v.mode,j,M),w.return=v,w):(w=i(w,b),w.return=v,w)}function f(v,w,b){if(typeof w=="string"&&w!==""||typeof w=="number")return w=bh(""+w,v.mode,b),w.return=v,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case ic:return b=Qc(w.type,w.key,w.props,null,v.mode,b),b.ref=ya(v,null,w),b.return=v,b;case io:return w=xh(w,v.mode,b),w.return=v,w;case mi:var j=w._init;return f(v,j(w._payload),b)}if(Ca(w)||ha(w))return w=Es(w,v.mode,b,null),w.return=v,w;pc(v,w)}return null}function m(v,w,b,j){var M=w!==null?w.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return M!==null?null:l(v,w,""+b,j);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case ic:return b.key===M?a(v,w,b,j):null;case io:return b.key===M?d(v,w,b,j):null;case mi:return M=b._init,m(v,w,M(b._payload),j)}if(Ca(b)||ha(b))return M!==null?null:h(v,w,b,j,null);pc(v,b)}return null}function g(v,w,b,j,M){if(typeof j=="string"&&j!==""||typeof j=="number")return v=v.get(b)||null,l(w,v,""+j,M);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case ic:return v=v.get(j.key===null?b:j.key)||null,a(w,v,j,M);case io:return v=v.get(j.key===null?b:j.key)||null,d(w,v,j,M);case mi:var U=j._init;return g(v,w,b,U(j._payload),M)}if(Ca(j)||ha(j))return v=v.get(b)||null,h(w,v,j,M,null);pc(w,j)}return null}function S(v,w,b,j){for(var M=null,U=null,x=w,I=w=0,R=null;x!==null&&I<b.length;I++){x.index>I?(R=x,x=null):R=x.sibling;var E=m(v,x,b[I],j);if(E===null){x===null&&(x=R);break}t&&x&&E.alternate===null&&e(v,x),w=s(E,w,I),U===null?M=E:U.sibling=E,U=E,x=R}if(I===b.length)return n(v,x),Et&&hs(v,I),M;if(x===null){for(;I<b.length;I++)x=f(v,b[I],j),x!==null&&(w=s(x,w,I),U===null?M=x:U.sibling=x,U=x);return Et&&hs(v,I),M}for(x=r(v,x);I<b.length;I++)R=g(x,v,I,b[I],j),R!==null&&(t&&R.alternate!==null&&x.delete(R.key===null?I:R.key),w=s(R,w,I),U===null?M=R:U.sibling=R,U=R);return t&&x.forEach(function(T){return e(v,T)}),Et&&hs(v,I),M}function _(v,w,b,j){var M=ha(b);if(typeof M!="function")throw Error(he(150));if(b=M.call(b),b==null)throw Error(he(151));for(var U=M=null,x=w,I=w=0,R=null,E=b.next();x!==null&&!E.done;I++,E=b.next()){x.index>I?(R=x,x=null):R=x.sibling;var T=m(v,x,E.value,j);if(T===null){x===null&&(x=R);break}t&&x&&T.alternate===null&&e(v,x),w=s(T,w,I),U===null?M=T:U.sibling=T,U=T,x=R}if(E.done)return n(v,x),Et&&hs(v,I),M;if(x===null){for(;!E.done;I++,E=b.next())E=f(v,E.value,j),E!==null&&(w=s(E,w,I),U===null?M=E:U.sibling=E,U=E);return Et&&hs(v,I),M}for(x=r(v,x);!E.done;I++,E=b.next())E=g(x,v,I,E.value,j),E!==null&&(t&&E.alternate!==null&&x.delete(E.key===null?I:E.key),w=s(E,w,I),U===null?M=E:U.sibling=E,U=E);return t&&x.forEach(function(k){return e(v,k)}),Et&&hs(v,I),M}function A(v,w,b,j){if(typeof b=="object"&&b!==null&&b.type===so&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case ic:e:{for(var M=b.key,U=w;U!==null;){if(U.key===M){if(M=b.type,M===so){if(U.tag===7){n(v,U.sibling),w=i(U,b.props.children),w.return=v,v=w;break e}}else if(U.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===mi&&av(M)===U.type){n(v,U.sibling),w=i(U,b.props),w.ref=ya(v,U,b),w.return=v,v=w;break e}n(v,U);break}else e(v,U);U=U.sibling}b.type===so?(w=Es(b.props.children,v.mode,j,b.key),w.return=v,v=w):(j=Qc(b.type,b.key,b.props,null,v.mode,j),j.ref=ya(v,w,b),j.return=v,v=j)}return o(v);case io:e:{for(U=b.key;w!==null;){if(w.key===U)if(w.tag===4&&w.stateNode.containerInfo===b.containerInfo&&w.stateNode.implementation===b.implementation){n(v,w.sibling),w=i(w,b.children||[]),w.return=v,v=w;break e}else{n(v,w);break}else e(v,w);w=w.sibling}w=xh(b,v.mode,j),w.return=v,v=w}return o(v);case mi:return U=b._init,A(v,w,U(b._payload),j)}if(Ca(b))return S(v,w,b,j);if(ha(b))return _(v,w,b,j);pc(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,w!==null&&w.tag===6?(n(v,w.sibling),w=i(w,b),w.return=v,v=w):(n(v,w),w=bh(b,v.mode,j),w.return=v,v=w),o(v)):n(v,w)}return A}var Do=lS(!0),cS=lS(!1),yu=Xi(null),vu=null,mo=null,mp=null;function pp(){mp=mo=vu=null}function gp(t){var e=yu.current;yt(yu),t._currentValue=e}function Of(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Eo(t,e){vu=t,mp=mo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Rn=!0),t.firstContext=null)}function er(t){var e=t._currentValue;if(mp!==t)if(t={context:t,memoizedValue:e,next:null},mo===null){if(vu===null)throw Error(he(308));mo=t,vu.dependencies={lanes:0,firstContext:t}}else mo=mo.next=t;return e}var ys=null;function yp(t){ys===null?ys=[t]:ys.push(t)}function uS(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,yp(e)):(n.next=i.next,i.next=n),e.interleaved=n,Qr(t,r)}function Qr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var pi=!1;function vp(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function dS(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Hr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Pi(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ge&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Qr(t,n)}return i=r.interleaved,i===null?(e.next=e,yp(r)):(e.next=i.next,i.next=e),r.interleaved=e,Qr(t,n)}function $c(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,rp(t,n)}}function lv(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function _u(t,e,n,r){var i=t.updateQueue;pi=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var a=l,d=a.next;a.next=null,o===null?s=d:o.next=d,o=a;var h=t.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==o&&(l===null?h.firstBaseUpdate=d:l.next=d,h.lastBaseUpdate=a))}if(s!==null){var f=i.baseState;o=0,h=d=a=null,l=s;do{var m=l.lane,g=l.eventTime;if((r&m)===m){h!==null&&(h=h.next={eventTime:g,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var S=t,_=l;switch(m=e,g=n,_.tag){case 1:if(S=_.payload,typeof S=="function"){f=S.call(g,f,m);break e}f=S;break e;case 3:S.flags=S.flags&-65537|128;case 0:if(S=_.payload,m=typeof S=="function"?S.call(g,f,m):S,m==null)break e;f=kt({},f,m);break e;case 2:pi=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,m=i.effects,m===null?i.effects=[l]:m.push(l))}else g={eventTime:g,lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(d=h=g,a=f):h=h.next=g,o|=m;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;m=l,l=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(!0);if(h===null&&(a=f),i.baseState=a,i.firstBaseUpdate=d,i.lastBaseUpdate=h,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);As|=o,t.lanes=o,t.memoizedState=f}}function cv(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(he(191,i));i.call(r)}}}var jl={},Ar=Xi(jl),ul=Xi(jl),dl=Xi(jl);function vs(t){if(t===jl)throw Error(he(174));return t}function _p(t,e){switch(ht(dl,e),ht(ul,t),ht(Ar,jl),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:gf(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=gf(e,t)}yt(Ar),ht(Ar,e)}function jo(){yt(Ar),yt(ul),yt(dl)}function hS(t){vs(dl.current);var e=vs(Ar.current),n=gf(e,t.type);e!==n&&(ht(ul,t),ht(Ar,n))}function wp(t){ul.current===t&&(yt(Ar),yt(ul))}var Ct=Xi(0);function wu(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var _h=[];function Sp(){for(var t=0;t<_h.length;t++)_h[t]._workInProgressVersionPrimary=null;_h.length=0}var zc=ei.ReactCurrentDispatcher,wh=ei.ReactCurrentBatchConfig,Cs=0,At=null,Yt=null,rn=null,Su=!1,Ua=!1,hl=0,iC=0;function pn(){throw Error(he(321))}function Ep(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ur(t[n],e[n]))return!1;return!0}function Tp(t,e,n,r,i,s){if(Cs=s,At=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,zc.current=t===null||t.memoizedState===null?lC:cC,t=n(r,i),Ua){s=0;do{if(Ua=!1,hl=0,25<=s)throw Error(he(301));s+=1,rn=Yt=null,e.updateQueue=null,zc.current=uC,t=n(r,i)}while(Ua)}if(zc.current=Eu,e=Yt!==null&&Yt.next!==null,Cs=0,rn=Yt=At=null,Su=!1,e)throw Error(he(300));return t}function Ip(){var t=hl!==0;return hl=0,t}function Sr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rn===null?At.memoizedState=rn=t:rn=rn.next=t,rn}function tr(){if(Yt===null){var t=At.alternate;t=t!==null?t.memoizedState:null}else t=Yt.next;var e=rn===null?At.memoizedState:rn.next;if(e!==null)rn=e,Yt=t;else{if(t===null)throw Error(he(310));Yt=t,t={memoizedState:Yt.memoizedState,baseState:Yt.baseState,baseQueue:Yt.baseQueue,queue:Yt.queue,next:null},rn===null?At.memoizedState=rn=t:rn=rn.next=t}return rn}function fl(t,e){return typeof e=="function"?e(t):e}function Sh(t){var e=tr(),n=e.queue;if(n===null)throw Error(he(311));n.lastRenderedReducer=t;var r=Yt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var l=o=null,a=null,d=s;do{var h=d.lane;if((Cs&h)===h)a!==null&&(a=a.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var f={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};a===null?(l=a=f,o=r):a=a.next=f,At.lanes|=h,As|=h}d=d.next}while(d!==null&&d!==s);a===null?o=r:a.next=l,ur(r,e.memoizedState)||(Rn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=a,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,At.lanes|=s,As|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Eh(t){var e=tr(),n=e.queue;if(n===null)throw Error(he(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);ur(s,e.memoizedState)||(Rn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function fS(){}function mS(t,e){var n=At,r=tr(),i=e(),s=!ur(r.memoizedState,i);if(s&&(r.memoizedState=i,Rn=!0),r=r.queue,bp(yS.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||rn!==null&&rn.memoizedState.tag&1){if(n.flags|=2048,ml(9,gS.bind(null,n,r,i,e),void 0,null),on===null)throw Error(he(349));Cs&30||pS(n,e,i)}return i}function pS(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=At.updateQueue,e===null?(e={lastEffect:null,stores:null},At.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function gS(t,e,n,r){e.value=n,e.getSnapshot=r,vS(e)&&_S(t)}function yS(t,e,n){return n(function(){vS(e)&&_S(t)})}function vS(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ur(t,n)}catch{return!0}}function _S(t){var e=Qr(t,1);e!==null&&lr(e,t,1,-1)}function uv(t){var e=Sr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:fl,lastRenderedState:t},e.queue=t,t=t.dispatch=aC.bind(null,At,t),[e.memoizedState,t]}function ml(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=At.updateQueue,e===null?(e={lastEffect:null,stores:null},At.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function wS(){return tr().memoizedState}function Hc(t,e,n,r){var i=Sr();At.flags|=t,i.memoizedState=ml(1|e,n,void 0,r===void 0?null:r)}function sd(t,e,n,r){var i=tr();r=r===void 0?null:r;var s=void 0;if(Yt!==null){var o=Yt.memoizedState;if(s=o.destroy,r!==null&&Ep(r,o.deps)){i.memoizedState=ml(e,n,s,r);return}}At.flags|=t,i.memoizedState=ml(1|e,n,s,r)}function dv(t,e){return Hc(8390656,8,t,e)}function bp(t,e){return sd(2048,8,t,e)}function SS(t,e){return sd(4,2,t,e)}function ES(t,e){return sd(4,4,t,e)}function TS(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function IS(t,e,n){return n=n!=null?n.concat([t]):null,sd(4,4,TS.bind(null,e,t),n)}function xp(){}function bS(t,e){var n=tr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ep(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function xS(t,e){var n=tr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ep(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function CS(t,e,n){return Cs&21?(ur(n,e)||(n=R0(),At.lanes|=n,As|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Rn=!0),t.memoizedState=n)}function sC(t,e){var n=st;st=n!==0&&4>n?n:4,t(!0);var r=wh.transition;wh.transition={};try{t(!1),e()}finally{st=n,wh.transition=r}}function AS(){return tr().memoizedState}function oC(t,e,n){var r=Di(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},NS(t))kS(e,n);else if(n=uS(t,e,n,r),n!==null){var i=bn();lr(n,t,r,i),PS(n,e,r)}}function aC(t,e,n){var r=Di(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(NS(t))kS(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,l=s(o,n);if(i.hasEagerState=!0,i.eagerState=l,ur(l,o)){var a=e.interleaved;a===null?(i.next=i,yp(e)):(i.next=a.next,a.next=i),e.interleaved=i;return}}catch{}finally{}n=uS(t,e,i,r),n!==null&&(i=bn(),lr(n,t,r,i),PS(n,e,r))}}function NS(t){var e=t.alternate;return t===At||e!==null&&e===At}function kS(t,e){Ua=Su=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function PS(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,rp(t,n)}}var Eu={readContext:er,useCallback:pn,useContext:pn,useEffect:pn,useImperativeHandle:pn,useInsertionEffect:pn,useLayoutEffect:pn,useMemo:pn,useReducer:pn,useRef:pn,useState:pn,useDebugValue:pn,useDeferredValue:pn,useTransition:pn,useMutableSource:pn,useSyncExternalStore:pn,useId:pn,unstable_isNewReconciler:!1},lC={readContext:er,useCallback:function(t,e){return Sr().memoizedState=[t,e===void 0?null:e],t},useContext:er,useEffect:dv,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Hc(4194308,4,TS.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Hc(4194308,4,t,e)},useInsertionEffect:function(t,e){return Hc(4,2,t,e)},useMemo:function(t,e){var n=Sr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Sr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=oC.bind(null,At,t),[r.memoizedState,t]},useRef:function(t){var e=Sr();return t={current:t},e.memoizedState=t},useState:uv,useDebugValue:xp,useDeferredValue:function(t){return Sr().memoizedState=t},useTransition:function(){var t=uv(!1),e=t[0];return t=sC.bind(null,t[1]),Sr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=At,i=Sr();if(Et){if(n===void 0)throw Error(he(407));n=n()}else{if(n=e(),on===null)throw Error(he(349));Cs&30||pS(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,dv(yS.bind(null,r,s,t),[t]),r.flags|=2048,ml(9,gS.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Sr(),e=on.identifierPrefix;if(Et){var n=zr,r=$r;n=(r&~(1<<32-ar(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=hl++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=iC++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},cC={readContext:er,useCallback:bS,useContext:er,useEffect:bp,useImperativeHandle:IS,useInsertionEffect:SS,useLayoutEffect:ES,useMemo:xS,useReducer:Sh,useRef:wS,useState:function(){return Sh(fl)},useDebugValue:xp,useDeferredValue:function(t){var e=tr();return CS(e,Yt.memoizedState,t)},useTransition:function(){var t=Sh(fl)[0],e=tr().memoizedState;return[t,e]},useMutableSource:fS,useSyncExternalStore:mS,useId:AS,unstable_isNewReconciler:!1},uC={readContext:er,useCallback:bS,useContext:er,useEffect:bp,useImperativeHandle:IS,useInsertionEffect:SS,useLayoutEffect:ES,useMemo:xS,useReducer:Eh,useRef:wS,useState:function(){return Eh(fl)},useDebugValue:xp,useDeferredValue:function(t){var e=tr();return Yt===null?e.memoizedState=t:CS(e,Yt.memoizedState,t)},useTransition:function(){var t=Eh(fl)[0],e=tr().memoizedState;return[t,e]},useMutableSource:fS,useSyncExternalStore:mS,useId:AS,unstable_isNewReconciler:!1};function ir(t,e){if(t&&t.defaultProps){e=kt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Lf(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:kt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var od={isMounted:function(t){return(t=t._reactInternals)?Vs(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=bn(),i=Di(t),s=Hr(r,i);s.payload=e,n!=null&&(s.callback=n),e=Pi(t,s,i),e!==null&&(lr(e,t,i,r),$c(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=bn(),i=Di(t),s=Hr(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Pi(t,s,i),e!==null&&(lr(e,t,i,r),$c(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=bn(),r=Di(t),i=Hr(n,r);i.tag=2,e!=null&&(i.callback=e),e=Pi(t,i,r),e!==null&&(lr(e,t,r,n),$c(e,t,r))}};function hv(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!ol(n,r)||!ol(i,s):!0}function RS(t,e,n){var r=!1,i=Bi,s=e.contextType;return typeof s=="object"&&s!==null?s=er(s):(i=jn(e)?bs:En.current,r=e.contextTypes,s=(r=r!=null)?Po(t,i):Bi),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=od,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function fv(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&od.enqueueReplaceState(e,e.state,null)}function Vf(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},vp(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=er(s):(s=jn(e)?bs:En.current,i.context=Po(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Lf(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&od.enqueueReplaceState(i,i.state,null),_u(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Mo(t,e){try{var n="",r=e;do n+=Vb(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Th(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Ff(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var dC=typeof WeakMap=="function"?WeakMap:Map;function DS(t,e,n){n=Hr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Iu||(Iu=!0,Kf=r),Ff(t,e)},n}function jS(t,e,n){n=Hr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Ff(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Ff(t,e),typeof r!="function"&&(Ri===null?Ri=new Set([this]):Ri.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function mv(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new dC;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=bC.bind(null,t,e,n),e.then(t,t))}function pv(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function gv(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Hr(-1,1),e.tag=2,Pi(n,e,1))),n.lanes|=1),t)}var hC=ei.ReactCurrentOwner,Rn=!1;function In(t,e,n,r){e.child=t===null?cS(e,null,n,r):Do(e,t.child,n,r)}function yv(t,e,n,r,i){n=n.render;var s=e.ref;return Eo(e,i),r=Tp(t,e,n,r,s,i),n=Ip(),t!==null&&!Rn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Kr(t,e,i)):(Et&&n&&dp(e),e.flags|=1,In(t,e,r,i),e.child)}function vv(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!jp(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,MS(t,e,s,r,i)):(t=Qc(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:ol,n(o,r)&&t.ref===e.ref)return Kr(t,e,i)}return e.flags|=1,t=ji(s,r),t.ref=e.ref,t.return=e,e.child=t}function MS(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(ol(s,r)&&t.ref===e.ref)if(Rn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Rn=!0);else return e.lanes=t.lanes,Kr(t,e,i)}return Uf(t,e,n,r,i)}function OS(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ht(go,Un),Un|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ht(go,Un),Un|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,ht(go,Un),Un|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,ht(go,Un),Un|=r;return In(t,e,i,n),e.child}function LS(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Uf(t,e,n,r,i){var s=jn(n)?bs:En.current;return s=Po(e,s),Eo(e,i),n=Tp(t,e,n,r,s,i),r=Ip(),t!==null&&!Rn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Kr(t,e,i)):(Et&&r&&dp(e),e.flags|=1,In(t,e,n,i),e.child)}function _v(t,e,n,r,i){if(jn(n)){var s=!0;mu(e)}else s=!1;if(Eo(e,i),e.stateNode===null)Wc(t,e),RS(e,n,r),Vf(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var a=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=er(d):(d=jn(n)?bs:En.current,d=Po(e,d));var h=n.getDerivedStateFromProps,f=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||a!==d)&&fv(e,o,r,d),pi=!1;var m=e.memoizedState;o.state=m,_u(e,r,o,i),a=e.memoizedState,l!==r||m!==a||Dn.current||pi?(typeof h=="function"&&(Lf(e,n,h,r),a=e.memoizedState),(l=pi||hv(e,n,l,r,m,a,d))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=a),o.props=r,o.state=a,o.context=d,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,dS(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:ir(e.type,l),o.props=d,f=e.pendingProps,m=o.context,a=n.contextType,typeof a=="object"&&a!==null?a=er(a):(a=jn(n)?bs:En.current,a=Po(e,a));var g=n.getDerivedStateFromProps;(h=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||m!==a)&&fv(e,o,r,a),pi=!1,m=e.memoizedState,o.state=m,_u(e,r,o,i);var S=e.memoizedState;l!==f||m!==S||Dn.current||pi?(typeof g=="function"&&(Lf(e,n,g,r),S=e.memoizedState),(d=pi||hv(e,n,d,r,m,S,a)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,S,a),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,S,a)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=S),o.props=r,o.state=S,o.context=a,r=d):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return Bf(t,e,n,r,s,i)}function Bf(t,e,n,r,i,s){LS(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&iv(e,n,!1),Kr(t,e,s);r=e.stateNode,hC.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Do(e,t.child,null,s),e.child=Do(e,null,l,s)):In(t,e,l,s),e.memoizedState=r.state,i&&iv(e,n,!0),e.child}function VS(t){var e=t.stateNode;e.pendingContext?rv(t,e.pendingContext,e.pendingContext!==e.context):e.context&&rv(t,e.context,!1),_p(t,e.containerInfo)}function wv(t,e,n,r,i){return Ro(),fp(i),e.flags|=256,In(t,e,n,r),e.child}var $f={dehydrated:null,treeContext:null,retryLane:0};function zf(t){return{baseLanes:t,cachePool:null,transitions:null}}function FS(t,e,n){var r=e.pendingProps,i=Ct.current,s=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(i&2)!==0),l?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),ht(Ct,i&1),t===null)return Mf(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=cd(o,r,0,null),t=Es(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=zf(n),e.memoizedState=$f,t):Cp(e,o));if(i=t.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return fC(t,e,o,r,l,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,l=i.sibling;var a={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=a,e.deletions=null):(r=ji(i,a),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=ji(l,s):(s=Es(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?zf(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=$f,r}return s=t.child,t=s.sibling,r=ji(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Cp(t,e){return e=cd({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function gc(t,e,n,r){return r!==null&&fp(r),Do(e,t.child,null,n),t=Cp(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function fC(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=Th(Error(he(422))),gc(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=cd({mode:"visible",children:r.children},i,0,null),s=Es(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Do(e,t.child,null,o),e.child.memoizedState=zf(o),e.memoizedState=$f,s);if(!(e.mode&1))return gc(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,s=Error(he(419)),r=Th(s,r,void 0),gc(t,e,o,r)}if(l=(o&t.childLanes)!==0,Rn||l){if(r=on,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Qr(t,i),lr(r,t,i,-1))}return Dp(),r=Th(Error(he(421))),gc(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=xC.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Bn=ki(i.nextSibling),Hn=e,Et=!0,or=null,t!==null&&(Kn[Yn++]=$r,Kn[Yn++]=zr,Kn[Yn++]=xs,$r=t.id,zr=t.overflow,xs=e),e=Cp(e,r.children),e.flags|=4096,e)}function Sv(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Of(t.return,e,n)}function Ih(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function US(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(In(t,e,r.children,n),r=Ct.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Sv(t,n,e);else if(t.tag===19)Sv(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ht(Ct,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&wu(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Ih(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&wu(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Ih(e,!0,n,null,s);break;case"together":Ih(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Wc(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Kr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),As|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(he(153));if(e.child!==null){for(t=e.child,n=ji(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ji(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function mC(t,e,n){switch(e.tag){case 3:VS(e),Ro();break;case 5:hS(e);break;case 1:jn(e.type)&&mu(e);break;case 4:_p(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;ht(yu,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ht(Ct,Ct.current&1),e.flags|=128,null):n&e.child.childLanes?FS(t,e,n):(ht(Ct,Ct.current&1),t=Kr(t,e,n),t!==null?t.sibling:null);ht(Ct,Ct.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return US(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ht(Ct,Ct.current),r)break;return null;case 22:case 23:return e.lanes=0,OS(t,e,n)}return Kr(t,e,n)}var BS,Hf,$S,zS;BS=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Hf=function(){};$S=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,vs(Ar.current);var s=null;switch(n){case"input":i=hf(t,i),r=hf(t,r),s=[];break;case"select":i=kt({},i,{value:void 0}),r=kt({},r,{value:void 0}),s=[];break;case"textarea":i=pf(t,i),r=pf(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=hu)}yf(n,r);var o;n=null;for(d in i)if(!r.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var l=i[d];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Za.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in r){var a=r[d];if(l=i!=null?i[d]:void 0,r.hasOwnProperty(d)&&a!==l&&(a!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||a&&a.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in a)a.hasOwnProperty(o)&&l[o]!==a[o]&&(n||(n={}),n[o]=a[o])}else n||(s||(s=[]),s.push(d,n)),n=a;else d==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,l=l?l.__html:void 0,a!=null&&l!==a&&(s=s||[]).push(d,a)):d==="children"?typeof a!="string"&&typeof a!="number"||(s=s||[]).push(d,""+a):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Za.hasOwnProperty(d)?(a!=null&&d==="onScroll"&&pt("scroll",t),s||l===a||(s=[])):(s=s||[]).push(d,a))}n&&(s=s||[]).push("style",n);var d=s;(e.updateQueue=d)&&(e.flags|=4)}};zS=function(t,e,n,r){n!==r&&(e.flags|=4)};function va(t,e){if(!Et)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function gn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function pC(t,e,n){var r=e.pendingProps;switch(hp(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return gn(e),null;case 1:return jn(e.type)&&fu(),gn(e),null;case 3:return r=e.stateNode,jo(),yt(Dn),yt(En),Sp(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(mc(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,or!==null&&(Jf(or),or=null))),Hf(t,e),gn(e),null;case 5:wp(e);var i=vs(dl.current);if(n=e.type,t!==null&&e.stateNode!=null)$S(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(he(166));return gn(e),null}if(t=vs(Ar.current),mc(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Tr]=e,r[cl]=s,t=(e.mode&1)!==0,n){case"dialog":pt("cancel",r),pt("close",r);break;case"iframe":case"object":case"embed":pt("load",r);break;case"video":case"audio":for(i=0;i<Na.length;i++)pt(Na[i],r);break;case"source":pt("error",r);break;case"img":case"image":case"link":pt("error",r),pt("load",r);break;case"details":pt("toggle",r);break;case"input":ky(r,s),pt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},pt("invalid",r);break;case"textarea":Ry(r,s),pt("invalid",r)}yf(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?r.textContent!==l&&(s.suppressHydrationWarning!==!0&&fc(r.textContent,l,t),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&fc(r.textContent,l,t),i=["children",""+l]):Za.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&pt("scroll",r)}switch(n){case"input":sc(r),Py(r,s,!0);break;case"textarea":sc(r),Dy(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=hu)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=y0(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Tr]=e,t[cl]=r,BS(t,e,!1,!1),e.stateNode=t;e:{switch(o=vf(n,r),n){case"dialog":pt("cancel",t),pt("close",t),i=r;break;case"iframe":case"object":case"embed":pt("load",t),i=r;break;case"video":case"audio":for(i=0;i<Na.length;i++)pt(Na[i],t);i=r;break;case"source":pt("error",t),i=r;break;case"img":case"image":case"link":pt("error",t),pt("load",t),i=r;break;case"details":pt("toggle",t),i=r;break;case"input":ky(t,r),i=hf(t,r),pt("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=kt({},r,{value:void 0}),pt("invalid",t);break;case"textarea":Ry(t,r),i=pf(t,r),pt("invalid",t);break;default:i=r}yf(n,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var a=l[s];s==="style"?w0(t,a):s==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,a!=null&&v0(t,a)):s==="children"?typeof a=="string"?(n!=="textarea"||a!=="")&&el(t,a):typeof a=="number"&&el(t,""+a):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Za.hasOwnProperty(s)?a!=null&&s==="onScroll"&&pt("scroll",t):a!=null&&Xm(t,s,a,o))}switch(n){case"input":sc(t),Py(t,r,!1);break;case"textarea":sc(t),Dy(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ui(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?vo(t,!!r.multiple,s,!1):r.defaultValue!=null&&vo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=hu)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return gn(e),null;case 6:if(t&&e.stateNode!=null)zS(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(he(166));if(n=vs(dl.current),vs(Ar.current),mc(e)){if(r=e.stateNode,n=e.memoizedProps,r[Tr]=e,(s=r.nodeValue!==n)&&(t=Hn,t!==null))switch(t.tag){case 3:fc(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&fc(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Tr]=e,e.stateNode=r}return gn(e),null;case 13:if(yt(Ct),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Et&&Bn!==null&&e.mode&1&&!(e.flags&128))aS(),Ro(),e.flags|=98560,s=!1;else if(s=mc(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(he(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(he(317));s[Tr]=e}else Ro(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;gn(e),s=!1}else or!==null&&(Jf(or),or=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ct.current&1?Xt===0&&(Xt=3):Dp())),e.updateQueue!==null&&(e.flags|=4),gn(e),null);case 4:return jo(),Hf(t,e),t===null&&al(e.stateNode.containerInfo),gn(e),null;case 10:return gp(e.type._context),gn(e),null;case 17:return jn(e.type)&&fu(),gn(e),null;case 19:if(yt(Ct),s=e.memoizedState,s===null)return gn(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)va(s,!1);else{if(Xt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=wu(t),o!==null){for(e.flags|=128,va(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ht(Ct,Ct.current&1|2),e.child}t=t.sibling}s.tail!==null&&Ft()>Oo&&(e.flags|=128,r=!0,va(s,!1),e.lanes=4194304)}else{if(!r)if(t=wu(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),va(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Et)return gn(e),null}else 2*Ft()-s.renderingStartTime>Oo&&n!==1073741824&&(e.flags|=128,r=!0,va(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Ft(),e.sibling=null,n=Ct.current,ht(Ct,r?n&1|2:n&1),e):(gn(e),null);case 22:case 23:return Rp(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Un&1073741824&&(gn(e),e.subtreeFlags&6&&(e.flags|=8192)):gn(e),null;case 24:return null;case 25:return null}throw Error(he(156,e.tag))}function gC(t,e){switch(hp(e),e.tag){case 1:return jn(e.type)&&fu(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return jo(),yt(Dn),yt(En),Sp(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return wp(e),null;case 13:if(yt(Ct),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(he(340));Ro()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return yt(Ct),null;case 4:return jo(),null;case 10:return gp(e.type._context),null;case 22:case 23:return Rp(),null;case 24:return null;default:return null}}var yc=!1,_n=!1,yC=typeof WeakSet=="function"?WeakSet:Set,ve=null;function po(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){jt(t,e,r)}else n.current=null}function Wf(t,e,n){try{n()}catch(r){jt(t,e,r)}}var Ev=!1;function vC(t,e){if(Af=cu,t=Q0(),up(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,l=-1,a=-1,d=0,h=0,f=t,m=null;t:for(;;){for(var g;f!==n||i!==0&&f.nodeType!==3||(l=o+i),f!==s||r!==0&&f.nodeType!==3||(a=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(g=f.firstChild)!==null;)m=f,f=g;for(;;){if(f===t)break t;if(m===n&&++d===i&&(l=o),m===s&&++h===r&&(a=o),(g=f.nextSibling)!==null)break;f=m,m=f.parentNode}f=g}n=l===-1||a===-1?null:{start:l,end:a}}else n=null}n=n||{start:0,end:0}}else n=null;for(Nf={focusedElem:t,selectionRange:n},cu=!1,ve=e;ve!==null;)if(e=ve,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ve=t;else for(;ve!==null;){e=ve;try{var S=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(S!==null){var _=S.memoizedProps,A=S.memoizedState,v=e.stateNode,w=v.getSnapshotBeforeUpdate(e.elementType===e.type?_:ir(e.type,_),A);v.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(he(163))}}catch(j){jt(e,e.return,j)}if(t=e.sibling,t!==null){t.return=e.return,ve=t;break}ve=e.return}return S=Ev,Ev=!1,S}function Ba(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Wf(e,n,s)}i=i.next}while(i!==r)}}function ad(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function qf(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function HS(t){var e=t.alternate;e!==null&&(t.alternate=null,HS(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Tr],delete e[cl],delete e[Rf],delete e[eC],delete e[tC])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function WS(t){return t.tag===5||t.tag===3||t.tag===4}function Tv(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||WS(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Gf(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=hu));else if(r!==4&&(t=t.child,t!==null))for(Gf(t,e,n),t=t.sibling;t!==null;)Gf(t,e,n),t=t.sibling}function Qf(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Qf(t,e,n),t=t.sibling;t!==null;)Qf(t,e,n),t=t.sibling}var ln=null,sr=!1;function ci(t,e,n){for(n=n.child;n!==null;)qS(t,e,n),n=n.sibling}function qS(t,e,n){if(Cr&&typeof Cr.onCommitFiberUnmount=="function")try{Cr.onCommitFiberUnmount(Zu,n)}catch{}switch(n.tag){case 5:_n||po(n,e);case 6:var r=ln,i=sr;ln=null,ci(t,e,n),ln=r,sr=i,ln!==null&&(sr?(t=ln,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):ln.removeChild(n.stateNode));break;case 18:ln!==null&&(sr?(t=ln,n=n.stateNode,t.nodeType===8?yh(t.parentNode,n):t.nodeType===1&&yh(t,n),il(t)):yh(ln,n.stateNode));break;case 4:r=ln,i=sr,ln=n.stateNode.containerInfo,sr=!0,ci(t,e,n),ln=r,sr=i;break;case 0:case 11:case 14:case 15:if(!_n&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Wf(n,e,o),i=i.next}while(i!==r)}ci(t,e,n);break;case 1:if(!_n&&(po(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){jt(n,e,l)}ci(t,e,n);break;case 21:ci(t,e,n);break;case 22:n.mode&1?(_n=(r=_n)||n.memoizedState!==null,ci(t,e,n),_n=r):ci(t,e,n);break;default:ci(t,e,n)}}function Iv(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new yC),e.forEach(function(r){var i=CC.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function rr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:ln=l.stateNode,sr=!1;break e;case 3:ln=l.stateNode.containerInfo,sr=!0;break e;case 4:ln=l.stateNode.containerInfo,sr=!0;break e}l=l.return}if(ln===null)throw Error(he(160));qS(s,o,i),ln=null,sr=!1;var a=i.alternate;a!==null&&(a.return=null),i.return=null}catch(d){jt(i,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)GS(e,t),e=e.sibling}function GS(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(rr(e,t),vr(t),r&4){try{Ba(3,t,t.return),ad(3,t)}catch(_){jt(t,t.return,_)}try{Ba(5,t,t.return)}catch(_){jt(t,t.return,_)}}break;case 1:rr(e,t),vr(t),r&512&&n!==null&&po(n,n.return);break;case 5:if(rr(e,t),vr(t),r&512&&n!==null&&po(n,n.return),t.flags&32){var i=t.stateNode;try{el(i,"")}catch(_){jt(t,t.return,_)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,l=t.type,a=t.updateQueue;if(t.updateQueue=null,a!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&p0(i,s),vf(l,o);var d=vf(l,s);for(o=0;o<a.length;o+=2){var h=a[o],f=a[o+1];h==="style"?w0(i,f):h==="dangerouslySetInnerHTML"?v0(i,f):h==="children"?el(i,f):Xm(i,h,f,d)}switch(l){case"input":ff(i,s);break;case"textarea":g0(i,s);break;case"select":var m=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var g=s.value;g!=null?vo(i,!!s.multiple,g,!1):m!==!!s.multiple&&(s.defaultValue!=null?vo(i,!!s.multiple,s.defaultValue,!0):vo(i,!!s.multiple,s.multiple?[]:"",!1))}i[cl]=s}catch(_){jt(t,t.return,_)}}break;case 6:if(rr(e,t),vr(t),r&4){if(t.stateNode===null)throw Error(he(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(_){jt(t,t.return,_)}}break;case 3:if(rr(e,t),vr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{il(e.containerInfo)}catch(_){jt(t,t.return,_)}break;case 4:rr(e,t),vr(t);break;case 13:rr(e,t),vr(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(kp=Ft())),r&4&&Iv(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(_n=(d=_n)||h,rr(e,t),_n=d):rr(e,t),vr(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(ve=t,h=t.child;h!==null;){for(f=ve=h;ve!==null;){switch(m=ve,g=m.child,m.tag){case 0:case 11:case 14:case 15:Ba(4,m,m.return);break;case 1:po(m,m.return);var S=m.stateNode;if(typeof S.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,S.props=e.memoizedProps,S.state=e.memoizedState,S.componentWillUnmount()}catch(_){jt(r,n,_)}}break;case 5:po(m,m.return);break;case 22:if(m.memoizedState!==null){xv(f);continue}}g!==null?(g.return=m,ve=g):xv(f)}h=h.sibling}e:for(h=null,f=t;;){if(f.tag===5){if(h===null){h=f;try{i=f.stateNode,d?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=f.stateNode,a=f.memoizedProps.style,o=a!=null&&a.hasOwnProperty("display")?a.display:null,l.style.display=_0("display",o))}catch(_){jt(t,t.return,_)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(_){jt(t,t.return,_)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:rr(e,t),vr(t),r&4&&Iv(t);break;case 21:break;default:rr(e,t),vr(t)}}function vr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(WS(n)){var r=n;break e}n=n.return}throw Error(he(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(el(i,""),r.flags&=-33);var s=Tv(t);Qf(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,l=Tv(t);Gf(t,l,o);break;default:throw Error(he(161))}}catch(a){jt(t,t.return,a)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function _C(t,e,n){ve=t,QS(t)}function QS(t,e,n){for(var r=(t.mode&1)!==0;ve!==null;){var i=ve,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||yc;if(!o){var l=i.alternate,a=l!==null&&l.memoizedState!==null||_n;l=yc;var d=_n;if(yc=o,(_n=a)&&!d)for(ve=i;ve!==null;)o=ve,a=o.child,o.tag===22&&o.memoizedState!==null?Cv(i):a!==null?(a.return=o,ve=a):Cv(i);for(;s!==null;)ve=s,QS(s),s=s.sibling;ve=i,yc=l,_n=d}bv(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ve=s):bv(t)}}function bv(t){for(;ve!==null;){var e=ve;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:_n||ad(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!_n)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:ir(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&cv(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}cv(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var a=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":a.autoFocus&&n.focus();break;case"img":a.src&&(n.src=a.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&il(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(he(163))}_n||e.flags&512&&qf(e)}catch(m){jt(e,e.return,m)}}if(e===t){ve=null;break}if(n=e.sibling,n!==null){n.return=e.return,ve=n;break}ve=e.return}}function xv(t){for(;ve!==null;){var e=ve;if(e===t){ve=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ve=n;break}ve=e.return}}function Cv(t){for(;ve!==null;){var e=ve;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{ad(4,e)}catch(a){jt(e,n,a)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(a){jt(e,i,a)}}var s=e.return;try{qf(e)}catch(a){jt(e,s,a)}break;case 5:var o=e.return;try{qf(e)}catch(a){jt(e,o,a)}}}catch(a){jt(e,e.return,a)}if(e===t){ve=null;break}var l=e.sibling;if(l!==null){l.return=e.return,ve=l;break}ve=e.return}}var wC=Math.ceil,Tu=ei.ReactCurrentDispatcher,Ap=ei.ReactCurrentOwner,Zn=ei.ReactCurrentBatchConfig,Ge=0,on=null,zt=null,dn=0,Un=0,go=Xi(0),Xt=0,pl=null,As=0,ld=0,Np=0,$a=null,kn=null,kp=0,Oo=1/0,Fr=null,Iu=!1,Kf=null,Ri=null,vc=!1,Ti=null,bu=0,za=0,Yf=null,qc=-1,Gc=0;function bn(){return Ge&6?Ft():qc!==-1?qc:qc=Ft()}function Di(t){return t.mode&1?Ge&2&&dn!==0?dn&-dn:rC.transition!==null?(Gc===0&&(Gc=R0()),Gc):(t=st,t!==0||(t=window.event,t=t===void 0?16:F0(t.type)),t):1}function lr(t,e,n,r){if(50<za)throw za=0,Yf=null,Error(he(185));Pl(t,n,r),(!(Ge&2)||t!==on)&&(t===on&&(!(Ge&2)&&(ld|=n),Xt===4&&yi(t,dn)),Mn(t,r),n===1&&Ge===0&&!(e.mode&1)&&(Oo=Ft()+500,id&&Ji()))}function Mn(t,e){var n=t.callbackNode;rx(t,e);var r=lu(t,t===on?dn:0);if(r===0)n!==null&&Oy(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Oy(n),e===1)t.tag===0?nC(Av.bind(null,t)):iS(Av.bind(null,t)),Jx(function(){!(Ge&6)&&Ji()}),n=null;else{switch(D0(r)){case 1:n=np;break;case 4:n=k0;break;case 16:n=au;break;case 536870912:n=P0;break;default:n=au}n=nE(n,KS.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function KS(t,e){if(qc=-1,Gc=0,Ge&6)throw Error(he(327));var n=t.callbackNode;if(To()&&t.callbackNode!==n)return null;var r=lu(t,t===on?dn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=xu(t,r);else{e=r;var i=Ge;Ge|=2;var s=XS();(on!==t||dn!==e)&&(Fr=null,Oo=Ft()+500,Ss(t,e));do try{TC();break}catch(l){YS(t,l)}while(!0);pp(),Tu.current=s,Ge=i,zt!==null?e=0:(on=null,dn=0,e=Xt)}if(e!==0){if(e===2&&(i=Tf(t),i!==0&&(r=i,e=Xf(t,i))),e===1)throw n=pl,Ss(t,0),yi(t,r),Mn(t,Ft()),n;if(e===6)yi(t,r);else{if(i=t.current.alternate,!(r&30)&&!SC(i)&&(e=xu(t,r),e===2&&(s=Tf(t),s!==0&&(r=s,e=Xf(t,s))),e===1))throw n=pl,Ss(t,0),yi(t,r),Mn(t,Ft()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(he(345));case 2:fs(t,kn,Fr);break;case 3:if(yi(t,r),(r&130023424)===r&&(e=kp+500-Ft(),10<e)){if(lu(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){bn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Pf(fs.bind(null,t,kn,Fr),e);break}fs(t,kn,Fr);break;case 4:if(yi(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-ar(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=Ft()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*wC(r/1960))-r,10<r){t.timeoutHandle=Pf(fs.bind(null,t,kn,Fr),r);break}fs(t,kn,Fr);break;case 5:fs(t,kn,Fr);break;default:throw Error(he(329))}}}return Mn(t,Ft()),t.callbackNode===n?KS.bind(null,t):null}function Xf(t,e){var n=$a;return t.current.memoizedState.isDehydrated&&(Ss(t,e).flags|=256),t=xu(t,e),t!==2&&(e=kn,kn=n,e!==null&&Jf(e)),t}function Jf(t){kn===null?kn=t:kn.push.apply(kn,t)}function SC(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!ur(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function yi(t,e){for(e&=~Np,e&=~ld,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-ar(e),r=1<<n;t[n]=-1,e&=~r}}function Av(t){if(Ge&6)throw Error(he(327));To();var e=lu(t,0);if(!(e&1))return Mn(t,Ft()),null;var n=xu(t,e);if(t.tag!==0&&n===2){var r=Tf(t);r!==0&&(e=r,n=Xf(t,r))}if(n===1)throw n=pl,Ss(t,0),yi(t,e),Mn(t,Ft()),n;if(n===6)throw Error(he(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,fs(t,kn,Fr),Mn(t,Ft()),null}function Pp(t,e){var n=Ge;Ge|=1;try{return t(e)}finally{Ge=n,Ge===0&&(Oo=Ft()+500,id&&Ji())}}function Ns(t){Ti!==null&&Ti.tag===0&&!(Ge&6)&&To();var e=Ge;Ge|=1;var n=Zn.transition,r=st;try{if(Zn.transition=null,st=1,t)return t()}finally{st=r,Zn.transition=n,Ge=e,!(Ge&6)&&Ji()}}function Rp(){Un=go.current,yt(go)}function Ss(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Xx(n)),zt!==null)for(n=zt.return;n!==null;){var r=n;switch(hp(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&fu();break;case 3:jo(),yt(Dn),yt(En),Sp();break;case 5:wp(r);break;case 4:jo();break;case 13:yt(Ct);break;case 19:yt(Ct);break;case 10:gp(r.type._context);break;case 22:case 23:Rp()}n=n.return}if(on=t,zt=t=ji(t.current,null),dn=Un=e,Xt=0,pl=null,Np=ld=As=0,kn=$a=null,ys!==null){for(e=0;e<ys.length;e++)if(n=ys[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}ys=null}return t}function YS(t,e){do{var n=zt;try{if(pp(),zc.current=Eu,Su){for(var r=At.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Su=!1}if(Cs=0,rn=Yt=At=null,Ua=!1,hl=0,Ap.current=null,n===null||n.return===null){Xt=1,pl=e,zt=null;break}e:{var s=t,o=n.return,l=n,a=e;if(e=dn,l.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){var d=a,h=l,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var m=h.alternate;m?(h.updateQueue=m.updateQueue,h.memoizedState=m.memoizedState,h.lanes=m.lanes):(h.updateQueue=null,h.memoizedState=null)}var g=pv(o);if(g!==null){g.flags&=-257,gv(g,o,l,s,e),g.mode&1&&mv(s,d,e),e=g,a=d;var S=e.updateQueue;if(S===null){var _=new Set;_.add(a),e.updateQueue=_}else S.add(a);break e}else{if(!(e&1)){mv(s,d,e),Dp();break e}a=Error(he(426))}}else if(Et&&l.mode&1){var A=pv(o);if(A!==null){!(A.flags&65536)&&(A.flags|=256),gv(A,o,l,s,e),fp(Mo(a,l));break e}}s=a=Mo(a,l),Xt!==4&&(Xt=2),$a===null?$a=[s]:$a.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=DS(s,a,e);lv(s,v);break e;case 1:l=a;var w=s.type,b=s.stateNode;if(!(s.flags&128)&&(typeof w.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Ri===null||!Ri.has(b)))){s.flags|=65536,e&=-e,s.lanes|=e;var j=jS(s,l,e);lv(s,j);break e}}s=s.return}while(s!==null)}ZS(n)}catch(M){e=M,zt===n&&n!==null&&(zt=n=n.return);continue}break}while(!0)}function XS(){var t=Tu.current;return Tu.current=Eu,t===null?Eu:t}function Dp(){(Xt===0||Xt===3||Xt===2)&&(Xt=4),on===null||!(As&268435455)&&!(ld&268435455)||yi(on,dn)}function xu(t,e){var n=Ge;Ge|=2;var r=XS();(on!==t||dn!==e)&&(Fr=null,Ss(t,e));do try{EC();break}catch(i){YS(t,i)}while(!0);if(pp(),Ge=n,Tu.current=r,zt!==null)throw Error(he(261));return on=null,dn=0,Xt}function EC(){for(;zt!==null;)JS(zt)}function TC(){for(;zt!==null&&!Qb();)JS(zt)}function JS(t){var e=tE(t.alternate,t,Un);t.memoizedProps=t.pendingProps,e===null?ZS(t):zt=e,Ap.current=null}function ZS(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=gC(n,e),n!==null){n.flags&=32767,zt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Xt=6,zt=null;return}}else if(n=pC(n,e,Un),n!==null){zt=n;return}if(e=e.sibling,e!==null){zt=e;return}zt=e=t}while(e!==null);Xt===0&&(Xt=5)}function fs(t,e,n){var r=st,i=Zn.transition;try{Zn.transition=null,st=1,IC(t,e,n,r)}finally{Zn.transition=i,st=r}return null}function IC(t,e,n,r){do To();while(Ti!==null);if(Ge&6)throw Error(he(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(he(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(ix(t,s),t===on&&(zt=on=null,dn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||vc||(vc=!0,nE(au,function(){return To(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Zn.transition,Zn.transition=null;var o=st;st=1;var l=Ge;Ge|=4,Ap.current=null,vC(t,n),GS(n,t),Hx(Nf),cu=!!Af,Nf=Af=null,t.current=n,_C(n),Kb(),Ge=l,st=o,Zn.transition=s}else t.current=n;if(vc&&(vc=!1,Ti=t,bu=i),s=t.pendingLanes,s===0&&(Ri=null),Jb(n.stateNode),Mn(t,Ft()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Iu)throw Iu=!1,t=Kf,Kf=null,t;return bu&1&&t.tag!==0&&To(),s=t.pendingLanes,s&1?t===Yf?za++:(za=0,Yf=t):za=0,Ji(),null}function To(){if(Ti!==null){var t=D0(bu),e=Zn.transition,n=st;try{if(Zn.transition=null,st=16>t?16:t,Ti===null)var r=!1;else{if(t=Ti,Ti=null,bu=0,Ge&6)throw Error(he(331));var i=Ge;for(Ge|=4,ve=t.current;ve!==null;){var s=ve,o=s.child;if(ve.flags&16){var l=s.deletions;if(l!==null){for(var a=0;a<l.length;a++){var d=l[a];for(ve=d;ve!==null;){var h=ve;switch(h.tag){case 0:case 11:case 15:Ba(8,h,s)}var f=h.child;if(f!==null)f.return=h,ve=f;else for(;ve!==null;){h=ve;var m=h.sibling,g=h.return;if(HS(h),h===d){ve=null;break}if(m!==null){m.return=g,ve=m;break}ve=g}}}var S=s.alternate;if(S!==null){var _=S.child;if(_!==null){S.child=null;do{var A=_.sibling;_.sibling=null,_=A}while(_!==null)}}ve=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,ve=o;else e:for(;ve!==null;){if(s=ve,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Ba(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,ve=v;break e}ve=s.return}}var w=t.current;for(ve=w;ve!==null;){o=ve;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,ve=b;else e:for(o=w;ve!==null;){if(l=ve,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:ad(9,l)}}catch(M){jt(l,l.return,M)}if(l===o){ve=null;break e}var j=l.sibling;if(j!==null){j.return=l.return,ve=j;break e}ve=l.return}}if(Ge=i,Ji(),Cr&&typeof Cr.onPostCommitFiberRoot=="function")try{Cr.onPostCommitFiberRoot(Zu,t)}catch{}r=!0}return r}finally{st=n,Zn.transition=e}}return!1}function Nv(t,e,n){e=Mo(n,e),e=DS(t,e,1),t=Pi(t,e,1),e=bn(),t!==null&&(Pl(t,1,e),Mn(t,e))}function jt(t,e,n){if(t.tag===3)Nv(t,t,n);else for(;e!==null;){if(e.tag===3){Nv(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ri===null||!Ri.has(r))){t=Mo(n,t),t=jS(e,t,1),e=Pi(e,t,1),t=bn(),e!==null&&(Pl(e,1,t),Mn(e,t));break}}e=e.return}}function bC(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=bn(),t.pingedLanes|=t.suspendedLanes&n,on===t&&(dn&n)===n&&(Xt===4||Xt===3&&(dn&130023424)===dn&&500>Ft()-kp?Ss(t,0):Np|=n),Mn(t,e)}function eE(t,e){e===0&&(t.mode&1?(e=lc,lc<<=1,!(lc&130023424)&&(lc=4194304)):e=1);var n=bn();t=Qr(t,e),t!==null&&(Pl(t,e,n),Mn(t,n))}function xC(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),eE(t,n)}function CC(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(he(314))}r!==null&&r.delete(e),eE(t,n)}var tE;tE=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Dn.current)Rn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Rn=!1,mC(t,e,n);Rn=!!(t.flags&131072)}else Rn=!1,Et&&e.flags&1048576&&sS(e,gu,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Wc(t,e),t=e.pendingProps;var i=Po(e,En.current);Eo(e,n),i=Tp(null,e,r,t,i,n);var s=Ip();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,jn(r)?(s=!0,mu(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,vp(e),i.updater=od,e.stateNode=i,i._reactInternals=e,Vf(e,r,t,n),e=Bf(null,e,r,!0,s,n)):(e.tag=0,Et&&s&&dp(e),In(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Wc(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=NC(r),t=ir(r,t),i){case 0:e=Uf(null,e,r,t,n);break e;case 1:e=_v(null,e,r,t,n);break e;case 11:e=yv(null,e,r,t,n);break e;case 14:e=vv(null,e,r,ir(r.type,t),n);break e}throw Error(he(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ir(r,i),Uf(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ir(r,i),_v(t,e,r,i,n);case 3:e:{if(VS(e),t===null)throw Error(he(387));r=e.pendingProps,s=e.memoizedState,i=s.element,dS(t,e),_u(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Mo(Error(he(423)),e),e=wv(t,e,r,n,i);break e}else if(r!==i){i=Mo(Error(he(424)),e),e=wv(t,e,r,n,i);break e}else for(Bn=ki(e.stateNode.containerInfo.firstChild),Hn=e,Et=!0,or=null,n=cS(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ro(),r===i){e=Kr(t,e,n);break e}In(t,e,r,n)}e=e.child}return e;case 5:return hS(e),t===null&&Mf(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,kf(r,i)?o=null:s!==null&&kf(r,s)&&(e.flags|=32),LS(t,e),In(t,e,o,n),e.child;case 6:return t===null&&Mf(e),null;case 13:return FS(t,e,n);case 4:return _p(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Do(e,null,r,n):In(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ir(r,i),yv(t,e,r,i,n);case 7:return In(t,e,e.pendingProps,n),e.child;case 8:return In(t,e,e.pendingProps.children,n),e.child;case 12:return In(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,ht(yu,r._currentValue),r._currentValue=o,s!==null)if(ur(s.value,o)){if(s.children===i.children&&!Dn.current){e=Kr(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var a=l.firstContext;a!==null;){if(a.context===r){if(s.tag===1){a=Hr(-1,n&-n),a.tag=2;var d=s.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?a.next=a:(a.next=h.next,h.next=a),d.pending=a}}s.lanes|=n,a=s.alternate,a!==null&&(a.lanes|=n),Of(s.return,n,e),l.lanes|=n;break}a=a.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(he(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),Of(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}In(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Eo(e,n),i=er(i),r=r(i),e.flags|=1,In(t,e,r,n),e.child;case 14:return r=e.type,i=ir(r,e.pendingProps),i=ir(r.type,i),vv(t,e,r,i,n);case 15:return MS(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ir(r,i),Wc(t,e),e.tag=1,jn(r)?(t=!0,mu(e)):t=!1,Eo(e,n),RS(e,r,i),Vf(e,r,i,n),Bf(null,e,r,!0,t,n);case 19:return US(t,e,n);case 22:return OS(t,e,n)}throw Error(he(156,e.tag))};function nE(t,e){return N0(t,e)}function AC(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Jn(t,e,n,r){return new AC(t,e,n,r)}function jp(t){return t=t.prototype,!(!t||!t.isReactComponent)}function NC(t){if(typeof t=="function")return jp(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Zm)return 11;if(t===ep)return 14}return 2}function ji(t,e){var n=t.alternate;return n===null?(n=Jn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Qc(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")jp(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case so:return Es(n.children,i,s,e);case Jm:o=8,i|=8;break;case lf:return t=Jn(12,n,e,i|2),t.elementType=lf,t.lanes=s,t;case cf:return t=Jn(13,n,e,i),t.elementType=cf,t.lanes=s,t;case uf:return t=Jn(19,n,e,i),t.elementType=uf,t.lanes=s,t;case h0:return cd(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case u0:o=10;break e;case d0:o=9;break e;case Zm:o=11;break e;case ep:o=14;break e;case mi:o=16,r=null;break e}throw Error(he(130,t==null?t:typeof t,""))}return e=Jn(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Es(t,e,n,r){return t=Jn(7,t,r,e),t.lanes=n,t}function cd(t,e,n,r){return t=Jn(22,t,r,e),t.elementType=h0,t.lanes=n,t.stateNode={isHidden:!1},t}function bh(t,e,n){return t=Jn(6,t,null,e),t.lanes=n,t}function xh(t,e,n){return e=Jn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function kC(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=oh(0),this.expirationTimes=oh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=oh(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Mp(t,e,n,r,i,s,o,l,a){return t=new kC(t,e,n,l,a),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Jn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},vp(s),t}function PC(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:io,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function rE(t){if(!t)return Bi;t=t._reactInternals;e:{if(Vs(t)!==t||t.tag!==1)throw Error(he(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(jn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(he(171))}if(t.tag===1){var n=t.type;if(jn(n))return rS(t,n,e)}return e}function iE(t,e,n,r,i,s,o,l,a){return t=Mp(n,r,!0,t,i,s,o,l,a),t.context=rE(null),n=t.current,r=bn(),i=Di(n),s=Hr(r,i),s.callback=e??null,Pi(n,s,i),t.current.lanes=i,Pl(t,i,r),Mn(t,r),t}function ud(t,e,n,r){var i=e.current,s=bn(),o=Di(i);return n=rE(n),e.context===null?e.context=n:e.pendingContext=n,e=Hr(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Pi(i,e,o),t!==null&&(lr(t,i,o,s),$c(t,i,o)),o}function Cu(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function kv(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Op(t,e){kv(t,e),(t=t.alternate)&&kv(t,e)}function RC(){return null}var sE=typeof reportError=="function"?reportError:function(t){console.error(t)};function Lp(t){this._internalRoot=t}dd.prototype.render=Lp.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(he(409));ud(t,e,null,null)};dd.prototype.unmount=Lp.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ns(function(){ud(null,t,null,null)}),e[Gr]=null}};function dd(t){this._internalRoot=t}dd.prototype.unstable_scheduleHydration=function(t){if(t){var e=O0();t={blockedOn:null,target:t,priority:e};for(var n=0;n<gi.length&&e!==0&&e<gi[n].priority;n++);gi.splice(n,0,t),n===0&&V0(t)}};function Vp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function hd(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Pv(){}function DC(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var d=Cu(o);s.call(d)}}var o=iE(e,r,t,0,null,!1,!1,"",Pv);return t._reactRootContainer=o,t[Gr]=o.current,al(t.nodeType===8?t.parentNode:t),Ns(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var d=Cu(a);l.call(d)}}var a=Mp(t,0,!1,null,null,!1,!1,"",Pv);return t._reactRootContainer=a,t[Gr]=a.current,al(t.nodeType===8?t.parentNode:t),Ns(function(){ud(e,a,n,r)}),a}function fd(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var l=i;i=function(){var a=Cu(o);l.call(a)}}ud(e,o,t,i)}else o=DC(n,e,t,i,r);return Cu(o)}j0=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Aa(e.pendingLanes);n!==0&&(rp(e,n|1),Mn(e,Ft()),!(Ge&6)&&(Oo=Ft()+500,Ji()))}break;case 13:Ns(function(){var r=Qr(t,1);if(r!==null){var i=bn();lr(r,t,1,i)}}),Op(t,1)}};ip=function(t){if(t.tag===13){var e=Qr(t,134217728);if(e!==null){var n=bn();lr(e,t,134217728,n)}Op(t,134217728)}};M0=function(t){if(t.tag===13){var e=Di(t),n=Qr(t,e);if(n!==null){var r=bn();lr(n,t,e,r)}Op(t,e)}};O0=function(){return st};L0=function(t,e){var n=st;try{return st=t,e()}finally{st=n}};wf=function(t,e,n){switch(e){case"input":if(ff(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=rd(r);if(!i)throw Error(he(90));m0(r),ff(r,i)}}}break;case"textarea":g0(t,n);break;case"select":e=n.value,e!=null&&vo(t,!!n.multiple,e,!1)}};T0=Pp;I0=Ns;var jC={usingClientEntryPoint:!1,Events:[Dl,co,rd,S0,E0,Pp]},_a={findFiberByHostInstance:gs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},MC={bundleType:_a.bundleType,version:_a.version,rendererPackageName:_a.rendererPackageName,rendererConfig:_a.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ei.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=C0(t),t===null?null:t.stateNode},findFiberByHostInstance:_a.findFiberByHostInstance||RC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var _c=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!_c.isDisabled&&_c.supportsFiber)try{Zu=_c.inject(MC),Cr=_c}catch{}}qn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jC;qn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Vp(e))throw Error(he(200));return PC(t,e,null,n)};qn.createRoot=function(t,e){if(!Vp(t))throw Error(he(299));var n=!1,r="",i=sE;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Mp(t,1,!1,null,null,n,!1,r,i),t[Gr]=e.current,al(t.nodeType===8?t.parentNode:t),new Lp(e)};qn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(he(188)):(t=Object.keys(t).join(","),Error(he(268,t)));return t=C0(e),t=t===null?null:t.stateNode,t};qn.flushSync=function(t){return Ns(t)};qn.hydrate=function(t,e,n){if(!hd(e))throw Error(he(200));return fd(null,t,e,!0,n)};qn.hydrateRoot=function(t,e,n){if(!Vp(t))throw Error(he(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=sE;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=iE(e,null,t,1,n??null,i,!1,s,o),t[Gr]=e.current,al(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new dd(e)};qn.render=function(t,e,n){if(!hd(e))throw Error(he(200));return fd(null,t,e,!1,n)};qn.unmountComponentAtNode=function(t){if(!hd(t))throw Error(he(40));return t._reactRootContainer?(Ns(function(){fd(null,null,t,!1,function(){t._reactRootContainer=null,t[Gr]=null})}),!0):!1};qn.unstable_batchedUpdates=Pp;qn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!hd(n))throw Error(he(200));if(t==null||t._reactInternals===void 0)throw Error(he(38));return fd(t,e,n,!1,r)};qn.version="18.3.1-next-f1338f8080-20240426";function oE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(oE)}catch(t){console.error(t)}}oE(),o0.exports=qn;var aE=o0.exports,Rv=aE;of.createRoot=Rv.createRoot,of.hydrateRoot=Rv.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function gl(){return gl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},gl.apply(this,arguments)}var Ii;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Ii||(Ii={}));const Dv="popstate";function OC(t){t===void 0&&(t={});function e(i,s){let{pathname:o="/",search:l="",hash:a=""}=Fs(i.location.hash.substr(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),Zf("",{pathname:o,search:l,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(i,s){let o=i.document.querySelector("base"),l="";if(o&&o.getAttribute("href")){let a=i.location.href,d=a.indexOf("#");l=d===-1?a:a.slice(0,d)}return l+"#"+(typeof s=="string"?s:Au(s))}function r(i,s){Fp(i.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(s)+")")}return VC(e,n,r,t)}function Nt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Fp(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function LC(){return Math.random().toString(36).substr(2,8)}function jv(t,e){return{usr:t.state,key:t.key,idx:e}}function Zf(t,e,n,r){return n===void 0&&(n=null),gl({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Fs(e):e,{state:n,key:e&&e.key||r||LC()})}function Au(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Fs(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function VC(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,o=i.history,l=Ii.Pop,a=null,d=h();d==null&&(d=0,o.replaceState(gl({},o.state,{idx:d}),""));function h(){return(o.state||{idx:null}).idx}function f(){l=Ii.Pop;let A=h(),v=A==null?null:A-d;d=A,a&&a({action:l,location:_.location,delta:v})}function m(A,v){l=Ii.Push;let w=Zf(_.location,A,v);n&&n(w,A),d=h()+1;let b=jv(w,d),j=_.createHref(w);try{o.pushState(b,"",j)}catch(M){if(M instanceof DOMException&&M.name==="DataCloneError")throw M;i.location.assign(j)}s&&a&&a({action:l,location:_.location,delta:1})}function g(A,v){l=Ii.Replace;let w=Zf(_.location,A,v);n&&n(w,A),d=h();let b=jv(w,d),j=_.createHref(w);o.replaceState(b,"",j),s&&a&&a({action:l,location:_.location,delta:0})}function S(A){let v=i.location.origin!=="null"?i.location.origin:i.location.href,w=typeof A=="string"?A:Au(A);return w=w.replace(/ $/,"%20"),Nt(v,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,v)}let _={get action(){return l},get location(){return t(i,o)},listen(A){if(a)throw new Error("A history only accepts one active listener");return i.addEventListener(Dv,f),a=A,()=>{i.removeEventListener(Dv,f),a=null}},createHref(A){return e(i,A)},createURL:S,encodeLocation(A){let v=S(A);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:m,replace:g,go(A){return o.go(A)}};return _}var Mv;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Mv||(Mv={}));function FC(t,e,n){return n===void 0&&(n="/"),UC(t,e,n)}function UC(t,e,n,r){let i=typeof e=="string"?Fs(e):e,s=Lo(i.pathname||"/",n);if(s==null)return null;let o=lE(t);BC(o);let l=null;for(let a=0;l==null&&a<o.length;++a){let d=JC(s);l=YC(o[a],d)}return l}function lE(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(s,o,l)=>{let a={relativePath:l===void 0?s.path||"":l,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};a.relativePath.startsWith("/")&&(Nt(a.relativePath.startsWith(r),'Absolute route path "'+a.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),a.relativePath=a.relativePath.slice(r.length));let d=Mi([r,a.relativePath]),h=n.concat(a);s.children&&s.children.length>0&&(Nt(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),lE(s.children,e,h,d)),!(s.path==null&&!s.index)&&e.push({path:d,score:QC(d,s.index),routesMeta:h})};return t.forEach((s,o)=>{var l;if(s.path===""||!((l=s.path)!=null&&l.includes("?")))i(s,o);else for(let a of cE(s.path))i(s,o,a)}),e}function cE(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let o=cE(r.join("/")),l=[];return l.push(...o.map(a=>a===""?s:[s,a].join("/"))),i&&l.push(...o),l.map(a=>t.startsWith("/")&&a===""?"/":a)}function BC(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:KC(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const $C=/^:[\w-]+$/,zC=3,HC=2,WC=1,qC=10,GC=-2,Ov=t=>t==="*";function QC(t,e){let n=t.split("/"),r=n.length;return n.some(Ov)&&(r+=GC),e&&(r+=HC),n.filter(i=>!Ov(i)).reduce((i,s)=>i+($C.test(s)?zC:s===""?WC:qC),r)}function KC(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function YC(t,e,n){let{routesMeta:r}=t,i={},s="/",o=[];for(let l=0;l<r.length;++l){let a=r[l],d=l===r.length-1,h=s==="/"?e:e.slice(s.length)||"/",f=em({path:a.relativePath,caseSensitive:a.caseSensitive,end:d},h),m=a.route;if(!f)return null;Object.assign(i,f.params),o.push({params:i,pathname:Mi([s,f.pathname]),pathnameBase:nA(Mi([s,f.pathnameBase])),route:m}),f.pathnameBase!=="/"&&(s=Mi([s,f.pathnameBase]))}return o}function em(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=XC(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),l=i.slice(1);return{params:r.reduce((d,h,f)=>{let{paramName:m,isOptional:g}=h;if(m==="*"){let _=l[f]||"";o=s.slice(0,s.length-_.length).replace(/(.)\/+$/,"$1")}const S=l[f];return g&&!S?d[m]=void 0:d[m]=(S||"").replace(/%2F/g,"/"),d},{}),pathname:s,pathnameBase:o,pattern:t}}function XC(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Fp(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,a)=>(r.push({paramName:l,isOptional:a!=null}),a?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function JC(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Fp(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Lo(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function ZC(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?Fs(t):t;return{pathname:n?n.startsWith("/")?n:eA(n,e):e,search:rA(r),hash:iA(i)}}function eA(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function Ch(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function tA(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Up(t,e){let n=tA(t);return e?n.map((r,i)=>i===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function Bp(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=Fs(t):(i=gl({},t),Nt(!i.pathname||!i.pathname.includes("?"),Ch("?","pathname","search",i)),Nt(!i.pathname||!i.pathname.includes("#"),Ch("#","pathname","hash",i)),Nt(!i.search||!i.search.includes("#"),Ch("#","search","hash",i)));let s=t===""||i.pathname==="",o=s?"/":i.pathname,l;if(o==null)l=n;else{let f=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),f-=1;i.pathname=m.join("/")}l=f>=0?e[f]:"/"}let a=ZC(i,l),d=o&&o!=="/"&&o.endsWith("/"),h=(s||o===".")&&n.endsWith("/");return!a.pathname.endsWith("/")&&(d||h)&&(a.pathname+="/"),a}const Mi=t=>t.join("/").replace(/\/\/+/g,"/"),nA=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),rA=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,iA=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function sA(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const uE=["post","put","patch","delete"];new Set(uE);const oA=["get",...uE];new Set(oA);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function yl(){return yl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},yl.apply(this,arguments)}const md=C.createContext(null),dE=C.createContext(null),ti=C.createContext(null),pd=C.createContext(null),ni=C.createContext({outlet:null,matches:[],isDataRoute:!1}),hE=C.createContext(null);function aA(t,e){let{relative:n}=e===void 0?{}:e;Ko()||Nt(!1);let{basename:r,navigator:i}=C.useContext(ti),{hash:s,pathname:o,search:l}=gd(t,{relative:n}),a=o;return r!=="/"&&(a=o==="/"?r:Mi([r,o])),i.createHref({pathname:a,search:l,hash:s})}function Ko(){return C.useContext(pd)!=null}function Us(){return Ko()||Nt(!1),C.useContext(pd).location}function fE(t){C.useContext(ti).static||C.useLayoutEffect(t)}function Yo(){let{isDataRoute:t}=C.useContext(ni);return t?SA():lA()}function lA(){Ko()||Nt(!1);let t=C.useContext(md),{basename:e,future:n,navigator:r}=C.useContext(ti),{matches:i}=C.useContext(ni),{pathname:s}=Us(),o=JSON.stringify(Up(i,n.v7_relativeSplatPath)),l=C.useRef(!1);return fE(()=>{l.current=!0}),C.useCallback(function(d,h){if(h===void 0&&(h={}),!l.current)return;if(typeof d=="number"){r.go(d);return}let f=Bp(d,JSON.parse(o),s,h.relative==="path");t==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:Mi([e,f.pathname])),(h.replace?r.replace:r.push)(f,h.state,h)},[e,r,o,s,t])}function cA(){let{matches:t}=C.useContext(ni),e=t[t.length-1];return e?e.params:{}}function gd(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=C.useContext(ti),{matches:i}=C.useContext(ni),{pathname:s}=Us(),o=JSON.stringify(Up(i,r.v7_relativeSplatPath));return C.useMemo(()=>Bp(t,JSON.parse(o),s,n==="path"),[t,o,s,n])}function uA(t,e){return dA(t,e)}function dA(t,e,n,r){Ko()||Nt(!1);let{navigator:i}=C.useContext(ti),{matches:s}=C.useContext(ni),o=s[s.length-1],l=o?o.params:{};o&&o.pathname;let a=o?o.pathnameBase:"/";o&&o.route;let d=Us(),h;if(e){var f;let A=typeof e=="string"?Fs(e):e;a==="/"||(f=A.pathname)!=null&&f.startsWith(a)||Nt(!1),h=A}else h=d;let m=h.pathname||"/",g=m;if(a!=="/"){let A=a.replace(/^\//,"").split("/");g="/"+m.replace(/^\//,"").split("/").slice(A.length).join("/")}let S=FC(t,{pathname:g}),_=gA(S&&S.map(A=>Object.assign({},A,{params:Object.assign({},l,A.params),pathname:Mi([a,i.encodeLocation?i.encodeLocation(A.pathname).pathname:A.pathname]),pathnameBase:A.pathnameBase==="/"?a:Mi([a,i.encodeLocation?i.encodeLocation(A.pathnameBase).pathname:A.pathnameBase])})),s,n,r);return e&&_?C.createElement(pd.Provider,{value:{location:yl({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:Ii.Pop}},_):_}function hA(){let t=wA(),e=sA(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return C.createElement(C.Fragment,null,C.createElement("h2",null,"Unexpected Application Error!"),C.createElement("h3",{style:{fontStyle:"italic"}},e),n?C.createElement("pre",{style:i},n):null,null)}const fA=C.createElement(hA,null);class mA extends C.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?C.createElement(ni.Provider,{value:this.props.routeContext},C.createElement(hE.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function pA(t){let{routeContext:e,match:n,children:r}=t,i=C.useContext(md);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),C.createElement(ni.Provider,{value:e},r)}function gA(t,e,n,r){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var s;if(!n)return null;if(n.errors)t=n.matches;else if((s=r)!=null&&s.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,l=(i=n)==null?void 0:i.errors;if(l!=null){let h=o.findIndex(f=>f.route.id&&(l==null?void 0:l[f.route.id])!==void 0);h>=0||Nt(!1),o=o.slice(0,Math.min(o.length,h+1))}let a=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let h=0;h<o.length;h++){let f=o[h];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(d=h),f.route.id){let{loaderData:m,errors:g}=n,S=f.route.loader&&m[f.route.id]===void 0&&(!g||g[f.route.id]===void 0);if(f.route.lazy||S){a=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((h,f,m)=>{let g,S=!1,_=null,A=null;n&&(g=l&&f.route.id?l[f.route.id]:void 0,_=f.route.errorElement||fA,a&&(d<0&&m===0?(EA("route-fallback"),S=!0,A=null):d===m&&(S=!0,A=f.route.hydrateFallbackElement||null)));let v=e.concat(o.slice(0,m+1)),w=()=>{let b;return g?b=_:S?b=A:f.route.Component?b=C.createElement(f.route.Component,null):f.route.element?b=f.route.element:b=h,C.createElement(pA,{match:f,routeContext:{outlet:h,matches:v,isDataRoute:n!=null},children:b})};return n&&(f.route.ErrorBoundary||f.route.errorElement||m===0)?C.createElement(mA,{location:n.location,revalidation:n.revalidation,component:_,error:g,children:w(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):w()},null)}var mE=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(mE||{}),pE=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(pE||{});function yA(t){let e=C.useContext(md);return e||Nt(!1),e}function vA(t){let e=C.useContext(dE);return e||Nt(!1),e}function _A(t){let e=C.useContext(ni);return e||Nt(!1),e}function gE(t){let e=_A(),n=e.matches[e.matches.length-1];return n.route.id||Nt(!1),n.route.id}function wA(){var t;let e=C.useContext(hE),n=vA(),r=gE();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function SA(){let{router:t}=yA(mE.UseNavigateStable),e=gE(pE.UseNavigateStable),n=C.useRef(!1);return fE(()=>{n.current=!0}),C.useCallback(function(i,s){s===void 0&&(s={}),n.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,yl({fromRouteId:e},s)))},[t,e])}const Lv={};function EA(t,e,n){Lv[t]||(Lv[t]=!0)}function TA(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function IA(t){let{to:e,replace:n,state:r,relative:i}=t;Ko()||Nt(!1);let{future:s,static:o}=C.useContext(ti),{matches:l}=C.useContext(ni),{pathname:a}=Us(),d=Yo(),h=Bp(e,Up(l,s.v7_relativeSplatPath),a,i==="path"),f=JSON.stringify(h);return C.useEffect(()=>d(JSON.parse(f),{replace:n,state:r,relative:i}),[d,f,i,n,r]),null}function fi(t){Nt(!1)}function bA(t){let{basename:e="/",children:n=null,location:r,navigationType:i=Ii.Pop,navigator:s,static:o=!1,future:l}=t;Ko()&&Nt(!1);let a=e.replace(/^\/*/,"/"),d=C.useMemo(()=>({basename:a,navigator:s,static:o,future:yl({v7_relativeSplatPath:!1},l)}),[a,l,s,o]);typeof r=="string"&&(r=Fs(r));let{pathname:h="/",search:f="",hash:m="",state:g=null,key:S="default"}=r,_=C.useMemo(()=>{let A=Lo(h,a);return A==null?null:{location:{pathname:A,search:f,hash:m,state:g,key:S},navigationType:i}},[a,h,f,m,g,S,i]);return _==null?null:C.createElement(ti.Provider,{value:d},C.createElement(pd.Provider,{children:n,value:_}))}function xA(t){let{children:e,location:n}=t;return uA(tm(e),n)}new Promise(()=>{});function tm(t,e){e===void 0&&(e=[]);let n=[];return C.Children.forEach(t,(r,i)=>{if(!C.isValidElement(r))return;let s=[...e,i];if(r.type===C.Fragment){n.push.apply(n,tm(r.props.children,s));return}r.type!==fi&&Nt(!1),!r.props.index||!r.props.children||Nt(!1);let o={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=tm(r.props.children,s)),n.push(o)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Nu(){return Nu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Nu.apply(this,arguments)}function yE(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function CA(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function AA(t,e){return t.button===0&&(!e||e==="_self")&&!CA(t)}const NA=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],kA=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],PA="6";try{window.__reactRouterVersion=PA}catch{}const RA=C.createContext({isTransitioning:!1}),DA="startTransition",Vv=bb[DA];function jA(t){let{basename:e,children:n,future:r,window:i}=t,s=C.useRef();s.current==null&&(s.current=OC({window:i,v5Compat:!0}));let o=s.current,[l,a]=C.useState({action:o.action,location:o.location}),{v7_startTransition:d}=r||{},h=C.useCallback(f=>{d&&Vv?Vv(()=>a(f)):a(f)},[a,d]);return C.useLayoutEffect(()=>o.listen(h),[o,h]),C.useEffect(()=>TA(r),[r]),C.createElement(bA,{basename:e,children:n,location:l.location,navigationType:l.action,navigator:o,future:r})}const MA=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",OA=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,LA=C.forwardRef(function(e,n){let{onClick:r,relative:i,reloadDocument:s,replace:o,state:l,target:a,to:d,preventScrollReset:h,viewTransition:f}=e,m=yE(e,NA),{basename:g}=C.useContext(ti),S,_=!1;if(typeof d=="string"&&OA.test(d)&&(S=d,MA))try{let b=new URL(window.location.href),j=d.startsWith("//")?new URL(b.protocol+d):new URL(d),M=Lo(j.pathname,g);j.origin===b.origin&&M!=null?d=M+j.search+j.hash:_=!0}catch{}let A=aA(d,{relative:i}),v=FA(d,{replace:o,state:l,target:a,preventScrollReset:h,relative:i,viewTransition:f});function w(b){r&&r(b),b.defaultPrevented||v(b)}return C.createElement("a",Nu({},m,{href:S||A,onClick:_||s?r:w,ref:n,target:a}))}),wa=C.forwardRef(function(e,n){let{"aria-current":r="page",caseSensitive:i=!1,className:s="",end:o=!1,style:l,to:a,viewTransition:d,children:h}=e,f=yE(e,kA),m=gd(a,{relative:f.relative}),g=Us(),S=C.useContext(dE),{navigator:_,basename:A}=C.useContext(ti),v=S!=null&&UA(m)&&d===!0,w=_.encodeLocation?_.encodeLocation(m).pathname:m.pathname,b=g.pathname,j=S&&S.navigation&&S.navigation.location?S.navigation.location.pathname:null;i||(b=b.toLowerCase(),j=j?j.toLowerCase():null,w=w.toLowerCase()),j&&A&&(j=Lo(j,A)||j);const M=w!=="/"&&w.endsWith("/")?w.length-1:w.length;let U=b===w||!o&&b.startsWith(w)&&b.charAt(M)==="/",x=j!=null&&(j===w||!o&&j.startsWith(w)&&j.charAt(w.length)==="/"),I={isActive:U,isPending:x,isTransitioning:v},R=U?r:void 0,E;typeof s=="function"?E=s(I):E=[s,U?"active":null,x?"pending":null,v?"transitioning":null].filter(Boolean).join(" ");let T=typeof l=="function"?l(I):l;return C.createElement(LA,Nu({},f,{"aria-current":R,className:E,ref:n,style:T,to:a,viewTransition:d}),typeof h=="function"?h(I):h)});var nm;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(nm||(nm={}));var Fv;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Fv||(Fv={}));function VA(t){let e=C.useContext(md);return e||Nt(!1),e}function FA(t,e){let{target:n,replace:r,state:i,preventScrollReset:s,relative:o,viewTransition:l}=e===void 0?{}:e,a=Yo(),d=Us(),h=gd(t,{relative:o});return C.useCallback(f=>{if(AA(f,n)){f.preventDefault();let m=r!==void 0?r:Au(d)===Au(h);a(t,{replace:m,state:i,preventScrollReset:s,relative:o,viewTransition:l})}},[d,a,h,r,i,n,t,s,o,l])}function UA(t,e){e===void 0&&(e={});let n=C.useContext(RA);n==null&&Nt(!1);let{basename:r}=VA(nm.useViewTransitionState),i=gd(t,{relative:e.relative});if(!n.isTransitioning)return!1;let s=Lo(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=Lo(n.nextLocation.pathname,r)||n.nextLocation.pathname;return em(i.pathname,o)!=null||em(i.pathname,s)!=null}function BA(t={}){const{nonce:e,onScriptLoadSuccess:n,onScriptLoadError:r}=t,[i,s]=C.useState(!1),o=C.useRef(n);o.current=n;const l=C.useRef(r);return l.current=r,C.useEffect(()=>{const a=document.createElement("script");return a.src="https://accounts.google.com/gsi/client",a.async=!0,a.defer=!0,a.nonce=e,a.onload=()=>{var d;s(!0),(d=o.current)===null||d===void 0||d.call(o)},a.onerror=()=>{var d;s(!1),(d=l.current)===null||d===void 0||d.call(l)},document.body.appendChild(a),()=>{document.body.removeChild(a)}},[e]),i}const $A=C.createContext(null);function zA({clientId:t,nonce:e,onScriptLoadSuccess:n,onScriptLoadError:r,children:i}){const s=BA({nonce:e,onScriptLoadSuccess:n,onScriptLoadError:r}),o=C.useMemo(()=>({clientId:t,scriptLoadedSuccessfully:s}),[t,s]);return We.createElement($A.Provider,{value:o},i)}const HA=()=>{};var Uv={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vE=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},WA=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],l=t[n++],a=((i&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(a>>10)),e[r++]=String.fromCharCode(56320+(a&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},_E={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,l=o?t[i+1]:0,a=i+2<t.length,d=a?t[i+2]:0,h=s>>2,f=(s&3)<<4|l>>4;let m=(l&15)<<2|d>>6,g=d&63;a||(g=64,o||(m=64)),r.push(n[h],n[f],n[m],n[g])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(vE(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):WA(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],l=i<t.length?n[t.charAt(i)]:0;++i;const d=i<t.length?n[t.charAt(i)]:64;++i;const f=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||l==null||d==null||f==null)throw new qA;const m=s<<2|l>>4;if(r.push(m),d!==64){const g=l<<4&240|d>>2;if(r.push(g),f!==64){const S=d<<6&192|f;r.push(S)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class qA extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const GA=function(t){const e=vE(t);return _E.encodeByteArray(e,!0)},ku=function(t){return GA(t).replace(/\./g,"")},wE=function(t){try{return _E.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QA(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KA=()=>QA().__FIREBASE_DEFAULTS__,YA=()=>{if(typeof process>"u"||typeof Uv>"u")return;const t=Uv.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},XA=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&wE(t[1]);return e&&JSON.parse(e)},yd=()=>{try{return HA()||KA()||YA()||XA()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},JA=t=>{var e,n;return(n=(e=yd())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},SE=t=>{const e=JA(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},EE=()=>{var t;return(t=yd())==null?void 0:t.config},ZA=t=>{var e;return(e=yd())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eN{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bs(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function TE(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IE(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...t};return[ku(JSON.stringify(n)),ku(JSON.stringify(o)),""].join(".")}const Ha={};function tN(){const t={prod:[],emulator:[]};for(const e of Object.keys(Ha))Ha[e]?t.emulator.push(e):t.prod.push(e);return t}function nN(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Bv=!1;function bE(t,e){if(typeof window>"u"||typeof document>"u"||!Bs(window.location.host)||Ha[t]===e||Ha[t]||Bv)return;Ha[t]=e;function n(m){return`__firebase__banner__${m}`}const r="__firebase__banner",s=tN().prod.length>0;function o(){const m=document.getElementById(r);m&&m.remove()}function l(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function a(m,g){m.setAttribute("width","24"),m.setAttribute("id",g),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function d(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{Bv=!0,o()},m}function h(m,g){m.setAttribute("id",g),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function f(){const m=nN(r),g=n("text"),S=document.getElementById(g)||document.createElement("span"),_=n("learnmore"),A=document.getElementById(_)||document.createElement("a"),v=n("preprendIcon"),w=document.getElementById(v)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const b=m.element;l(b),h(A,_);const j=d();a(w,v),b.append(w,S,A,j),document.body.appendChild(b)}s?(S.innerText="Preview backend disconnected.",w.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(w.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",g)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function rN(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(dr())}function iN(){var e;const t=(e=yd())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function sN(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function oN(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function aN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function lN(){return!iN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function cN(){try{return typeof indexedDB=="object"}catch{return!1}}function uN(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)==null?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dN="FirebaseError";class ri extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=dN,Object.setPrototypeOf(this,ri.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ml.prototype.create)}}class Ml{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?hN(s,r):"Error",l=`${this.serviceName}: ${o} (${i}).`;return new ri(i,l,r)}}function hN(t,e){return t.replace(fN,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const fN=/\{\$([^}]+)}/g;function Pu(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if($v(s)&&$v(o)){if(!Pu(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function $v(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xE(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function mN(t,e){const n=new pN(t,e);return n.subscribe.bind(n)}class pN{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");gN(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=Ah),i.error===void 0&&(i.error=Ah),i.complete===void 0&&(i.complete=Ah);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function gN(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Ah(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function an(t){return t&&t._delegate?t._delegate:t}class $i{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ms="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yN{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new eN;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(_N(e))try{this.getOrInitializeService({instanceIdentifier:ms})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=ms){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ms){return this.instances.has(e)}getOptions(e=ms){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);r===l&&o.resolve(i)}return i}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:vN(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ms){return this.component?this.component.multipleInstances?e:ms:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function vN(t){return t===ms?void 0:t}function _N(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new yN(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ue;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ue||(Ue={}));const SN={debug:Ue.DEBUG,verbose:Ue.VERBOSE,info:Ue.INFO,warn:Ue.WARN,error:Ue.ERROR,silent:Ue.SILENT},EN=Ue.INFO,TN={[Ue.DEBUG]:"log",[Ue.VERBOSE]:"log",[Ue.INFO]:"info",[Ue.WARN]:"warn",[Ue.ERROR]:"error"},IN=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=TN[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class $p{constructor(e){this.name=e,this._logLevel=EN,this._logHandler=IN,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ue))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?SN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ue.DEBUG,...e),this._logHandler(this,Ue.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ue.VERBOSE,...e),this._logHandler(this,Ue.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ue.INFO,...e),this._logHandler(this,Ue.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ue.WARN,...e),this._logHandler(this,Ue.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ue.ERROR,...e),this._logHandler(this,Ue.ERROR,...e)}}const bN=(t,e)=>e.some(n=>t instanceof n);let zv,Hv;function xN(){return zv||(zv=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function CN(){return Hv||(Hv=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const CE=new WeakMap,rm=new WeakMap,AE=new WeakMap,Nh=new WeakMap,zp=new WeakMap;function AN(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Oi(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&CE.set(n,t)}).catch(()=>{}),zp.set(e,t),e}function NN(t){if(rm.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});rm.set(t,e)}let im={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return rm.get(t);if(e==="objectStoreNames")return t.objectStoreNames||AE.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Oi(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function kN(t){im=t(im)}function PN(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(kh(this),e,...n);return AE.set(r,e.sort?e.sort():[e]),Oi(r)}:CN().includes(t)?function(...e){return t.apply(kh(this),e),Oi(CE.get(this))}:function(...e){return Oi(t.apply(kh(this),e))}}function RN(t){return typeof t=="function"?PN(t):(t instanceof IDBTransaction&&NN(t),bN(t,xN())?new Proxy(t,im):t)}function Oi(t){if(t instanceof IDBRequest)return AN(t);if(Nh.has(t))return Nh.get(t);const e=RN(t);return e!==t&&(Nh.set(t,e),zp.set(e,t)),e}const kh=t=>zp.get(t);function NE(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),l=Oi(o);return r&&o.addEventListener("upgradeneeded",a=>{r(Oi(o.result),a.oldVersion,a.newVersion,Oi(o.transaction),a)}),n&&o.addEventListener("blocked",a=>n(a.oldVersion,a.newVersion,a)),l.then(a=>{s&&a.addEventListener("close",()=>s()),i&&a.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}const DN=["get","getKey","getAll","getAllKeys","count"],jN=["put","add","delete","clear"],Ph=new Map;function Wv(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Ph.get(e))return Ph.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=jN.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||DN.includes(n)))return;const s=async function(o,...l){const a=this.transaction(o,i?"readwrite":"readonly");let d=a.store;return r&&(d=d.index(l.shift())),(await Promise.all([d[n](...l),i&&a.done]))[0]};return Ph.set(e,s),s}kN(t=>({...t,get:(e,n,r)=>Wv(e,n)||t.get(e,n,r),has:(e,n)=>!!Wv(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(ON(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function ON(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const sm="@firebase/app",qv="0.14.5";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yr=new $p("@firebase/app"),LN="@firebase/app-compat",VN="@firebase/analytics-compat",FN="@firebase/analytics",UN="@firebase/app-check-compat",BN="@firebase/app-check",$N="@firebase/auth",zN="@firebase/auth-compat",HN="@firebase/database",WN="@firebase/data-connect",qN="@firebase/database-compat",GN="@firebase/functions",QN="@firebase/functions-compat",KN="@firebase/installations",YN="@firebase/installations-compat",XN="@firebase/messaging",JN="@firebase/messaging-compat",ZN="@firebase/performance",ek="@firebase/performance-compat",tk="@firebase/remote-config",nk="@firebase/remote-config-compat",rk="@firebase/storage",ik="@firebase/storage-compat",sk="@firebase/firestore",ok="@firebase/ai",ak="@firebase/firestore-compat",lk="firebase",ck="12.5.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const om="[DEFAULT]",uk={[sm]:"fire-core",[LN]:"fire-core-compat",[FN]:"fire-analytics",[VN]:"fire-analytics-compat",[BN]:"fire-app-check",[UN]:"fire-app-check-compat",[$N]:"fire-auth",[zN]:"fire-auth-compat",[HN]:"fire-rtdb",[WN]:"fire-data-connect",[qN]:"fire-rtdb-compat",[GN]:"fire-fn",[QN]:"fire-fn-compat",[KN]:"fire-iid",[YN]:"fire-iid-compat",[XN]:"fire-fcm",[JN]:"fire-fcm-compat",[ZN]:"fire-perf",[ek]:"fire-perf-compat",[tk]:"fire-rc",[nk]:"fire-rc-compat",[rk]:"fire-gcs",[ik]:"fire-gcs-compat",[sk]:"fire-fst",[ak]:"fire-fst-compat",[ok]:"fire-vertex","fire-js":"fire-js",[lk]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vl=new Map,dk=new Map,am=new Map;function Gv(t,e){try{t.container.addComponent(e)}catch(n){Yr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function ks(t){const e=t.name;if(am.has(e))return Yr.debug(`There were multiple attempts to register component ${e}.`),!1;am.set(e,t);for(const n of vl.values())Gv(n,t);for(const n of dk.values())Gv(n,t);return!0}function kE(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function vi(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hk={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Li=new Ml("app","Firebase",hk);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fk{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new $i("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Li.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ol=ck;function PE(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:om,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Li.create("bad-app-name",{appName:String(i)});if(n||(n=EE()),!n)throw Li.create("no-options");const s=vl.get(i);if(s){if(Pu(n,s.options)&&Pu(r,s.config))return s;throw Li.create("duplicate-app",{appName:i})}const o=new wN(i);for(const a of am.values())o.addComponent(a);const l=new fk(n,r,o);return vl.set(i,l),l}function Hp(t=om){const e=vl.get(t);if(!e&&t===om&&EE())return PE();if(!e)throw Li.create("no-app",{appName:t});return e}function Qv(){return Array.from(vl.values())}function Nr(t,e,n){let r=uk[t]??t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Yr.warn(o.join(" "));return}ks(new $i(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mk="firebase-heartbeat-database",pk=1,_l="firebase-heartbeat-store";let Rh=null;function RE(){return Rh||(Rh=NE(mk,pk,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(_l)}catch(n){console.warn(n)}}}}).catch(t=>{throw Li.create("idb-open",{originalErrorMessage:t.message})})),Rh}async function gk(t){try{const n=(await RE()).transaction(_l),r=await n.objectStore(_l).get(DE(t));return await n.done,r}catch(e){if(e instanceof ri)Yr.warn(e.message);else{const n=Li.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Yr.warn(n.message)}}}async function Kv(t,e){try{const r=(await RE()).transaction(_l,"readwrite");await r.objectStore(_l).put(e,DE(t)),await r.done}catch(n){if(n instanceof ri)Yr.warn(n.message);else{const r=Li.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Yr.warn(r.message)}}}function DE(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yk=1024,vk=30;class _k{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Sk(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Yv();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>vk){const o=Ek(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Yr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Yv(),{heartbeatsToSend:r,unsentEntries:i}=wk(this._heartbeatsCache.heartbeats),s=ku(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Yr.warn(n),""}}}function Yv(){return new Date().toISOString().substring(0,10)}function wk(t,e=yk){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),Xv(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Xv(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class Sk{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return cN()?uN().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await gk(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Kv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Kv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Xv(t){return ku(JSON.stringify({version:2,heartbeats:t})).length}function Ek(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tk(t){ks(new $i("platform-logger",e=>new MN(e),"PRIVATE")),ks(new $i("heartbeat",e=>new _k(e),"PRIVATE")),Nr(sm,qv,t),Nr(sm,qv,"esm2020"),Nr("fire-js","")}Tk("");function jE(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Ik=jE,ME=new Ml("auth","Firebase",jE());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ru=new $p("@firebase/auth");function bk(t,...e){Ru.logLevel<=Ue.WARN&&Ru.warn(`Auth (${Ol}): ${t}`,...e)}function Kc(t,...e){Ru.logLevel<=Ue.ERROR&&Ru.error(`Auth (${Ol}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jv(t,...e){throw Wp(t,...e)}function OE(t,...e){return Wp(t,...e)}function LE(t,e,n){const r={...Ik(),[e]:n};return new Ml("auth","Firebase",r).create(e,{appName:t.name})}function Yc(t){return LE(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Wp(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return ME.create(t,...e)}function Je(t,e,...n){if(!t)throw Wp(e,...n)}function Wa(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Kc(e),new Error(e)}function Du(t,e){t||Wa(e)}function xk(){return Zv()==="http:"||Zv()==="https:"}function Zv(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ck(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(xk()||oN()||"connection"in navigator)?navigator.onLine:!0}function Ak(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll{constructor(e,n){this.shortDelay=e,this.longDelay=n,Du(n>e,"Short delay should be less than long delay!"),this.isMobile=rN()||aN()}get(){return Ck()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nk(t,e){Du(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VE{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Wa("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Wa("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Wa("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kk={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pk=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Rk=new Ll(3e4,6e4);function FE(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function vd(t,e,n,r,i={}){return UE(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const l=xE({key:t.config.apiKey,...o}).slice(1),a=await t._getAdditionalHeaders();a["Content-Type"]="application/json",t.languageCode&&(a["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:a,...s};return sN()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&Bs(t.emulatorConfig.host)&&(d.credentials="include"),VE.fetch()(await BE(t,t.config.apiHost,n,l),d)})}async function UE(t,e,n){t._canInitEmulator=!1;const r={...kk,...e};try{const i=new Dk(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw wc(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[a,d]=l.split(" : ");if(a==="FEDERATED_USER_ID_ALREADY_LINKED")throw wc(t,"credential-already-in-use",o);if(a==="EMAIL_EXISTS")throw wc(t,"email-already-in-use",o);if(a==="USER_DISABLED")throw wc(t,"user-disabled",o);const h=r[a]||a.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw LE(t,h,d);Jv(t,h)}}catch(i){if(i instanceof ri)throw i;Jv(t,"network-request-failed",{message:String(i)})}}async function BE(t,e,n,r){const i=`${e}${n}?${r}`,s=t,o=s.config.emulator?Nk(t.config,i):`${t.config.apiScheme}://${i}`;return Pk.includes(n)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class Dk{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(OE(this.auth,"network-request-failed")),Rk.get())})}}function wc(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=OE(t,e,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jk(t,e){return vd(t,"POST","/v1/accounts:delete",e)}async function ju(t,e){return vd(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qa(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Mk(t,e=!1){const n=an(t),r=await n.getIdToken(e),i=$E(r);Je(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:qa(Dh(i.auth_time)),issuedAtTime:qa(Dh(i.iat)),expirationTime:qa(Dh(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Dh(t){return Number(t)*1e3}function $E(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Kc("JWT malformed, contained fewer than 3 sections"),null;try{const i=wE(n);return i?JSON.parse(i):(Kc("Failed to decode base64 JWT payload"),null)}catch(i){return Kc("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function e_(t){const e=$E(t);return Je(e,"internal-error"),Je(typeof e.exp<"u","internal-error"),Je(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lm(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof ri&&Ok(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function Ok({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lk{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cm{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=qa(this.lastLoginAt),this.creationTime=qa(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mu(t){var f;const e=t.auth,n=await t.getIdToken(),r=await lm(t,ju(e,{idToken:n}));Je(r==null?void 0:r.users.length,e,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const s=(f=i.providerUserInfo)!=null&&f.length?zE(i.providerUserInfo):[],o=Fk(t.providerData,s),l=t.isAnonymous,a=!(t.email&&i.passwordHash)&&!(o!=null&&o.length),d=l?a:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new cm(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function Vk(t){const e=an(t);await Mu(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Fk(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function zE(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Uk(t,e){const n=await UE(t,{},async()=>{const r=xE({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=await BE(t,i,"/v1/token",`key=${s}`),l=await t._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const a={method:"POST",headers:l,body:r};return t.emulatorConfig&&Bs(t.emulatorConfig.host)&&(a.credentials="include"),VE.fetch()(o,a)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function Bk(t,e){return vd(t,"POST","/v2/accounts:revokeToken",FE(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Je(e.idToken,"internal-error"),Je(typeof e.idToken<"u","internal-error"),Je(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):e_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Je(e.length!==0,"internal-error");const n=e_(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Je(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await Uk(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new Io;return r&&(Je(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(Je(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(Je(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Io,this.toJSON())}_performRefresh(){return Wa("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ui(t,e){Je(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class br{constructor({uid:e,auth:n,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new Lk(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new cm(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await lm(this,this.stsTokenManager.getToken(this.auth,e));return Je(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return Mk(this,e)}reload(){return Vk(this)}_assign(e){this!==e&&(Je(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new br({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Je(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Mu(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(vi(this.auth.app))return Promise.reject(Yc(this.auth));const e=await this.getIdToken();return await lm(this,jk(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,i=n.email??void 0,s=n.phoneNumber??void 0,o=n.photoURL??void 0,l=n.tenantId??void 0,a=n._redirectEventId??void 0,d=n.createdAt??void 0,h=n.lastLoginAt??void 0,{uid:f,emailVerified:m,isAnonymous:g,providerData:S,stsTokenManager:_}=n;Je(f&&_,e,"internal-error");const A=Io.fromJSON(this.name,_);Je(typeof f=="string",e,"internal-error"),ui(r,e.name),ui(i,e.name),Je(typeof m=="boolean",e,"internal-error"),Je(typeof g=="boolean",e,"internal-error"),ui(s,e.name),ui(o,e.name),ui(l,e.name),ui(a,e.name),ui(d,e.name),ui(h,e.name);const v=new br({uid:f,auth:e,email:i,emailVerified:m,displayName:r,isAnonymous:g,photoURL:o,phoneNumber:s,tenantId:l,stsTokenManager:A,createdAt:d,lastLoginAt:h});return S&&Array.isArray(S)&&(v.providerData=S.map(w=>({...w}))),a&&(v._redirectEventId=a),v}static async _fromIdTokenResponse(e,n,r=!1){const i=new Io;i.updateFromServerResponse(n);const s=new br({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Mu(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];Je(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?zE(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),l=new Io;l.updateFromIdToken(r);const a=new br({uid:i.localId,auth:e,stsTokenManager:l,isAnonymous:o}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new cm(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(a,d),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t_=new Map;function _s(t){Du(t instanceof Function,"Expected a class definition");let e=t_.get(t);return e?(Du(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,t_.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HE{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}HE.type="NONE";const n_=HE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jh(t,e,n){return`firebase:${t}:${e}:${n}`}class bo{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=jh(this.userKey,i.apiKey,s),this.fullPersistenceKey=jh("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await ju(this.auth,{idToken:e}).catch(()=>{});return n?br._fromGetAccountInfoResponse(this.auth,n,e):null}return br._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new bo(_s(n_),e,r);const i=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let s=i[0]||_s(n_);const o=jh(r,e.config.apiKey,e.name);let l=null;for(const d of n)try{const h=await d._get(o);if(h){let f;if(typeof h=="string"){const m=await ju(e,{idToken:h}).catch(()=>{});if(!m)break;f=await br._fromGetAccountInfoResponse(e,m,h)}else f=br._fromJSON(e,h);d!==s&&(l=f),s=d;break}}catch{}const a=i.filter(d=>d._shouldAllowMigration);return!s._shouldAllowMigration||!a.length?new bo(s,e,r):(s=a[0],l&&await s._set(o,l.toJSON()),await Promise.all(n.map(async d=>{if(d!==s)try{await d._remove(o)}catch{}})),new bo(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r_(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Wk(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if($k(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Gk(e))return"Blackberry";if(Qk(e))return"Webos";if(zk(e))return"Safari";if((e.includes("chrome/")||Hk(e))&&!e.includes("edge/"))return"Chrome";if(qk(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function $k(t=dr()){return/firefox\//i.test(t)}function zk(t=dr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Hk(t=dr()){return/crios\//i.test(t)}function Wk(t=dr()){return/iemobile/i.test(t)}function qk(t=dr()){return/android/i.test(t)}function Gk(t=dr()){return/blackberry/i.test(t)}function Qk(t=dr()){return/webos/i.test(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WE(t,e=[]){let n;switch(t){case"Browser":n=r_(dr());break;case"Worker":n=`${r_(dr())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ol}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kk{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,l)=>{try{const a=e(s);o(a)}catch(a){l(a)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yk(t,e={}){return vd(t,"GET","/v2/passwordPolicy",FE(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xk=6;class Jk{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??Xk,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zk{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new i_(this),this.idTokenSubscription=new i_(this),this.beforeStateQueue=new Kk(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ME,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=_s(n)),this._initializationPromise=this.queue(async()=>{var r,i,s;if(!this._deleted&&(this.persistenceManager=await bo.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)==null?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await ju(this,{idToken:e}),r=await br._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var s;if(vi(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(s=this.redirectUser)==null?void 0:s._redirectEventId,l=r==null?void 0:r._redirectEventId,a=await this.tryRedirectSignIn(e);(!o||o===l)&&(a!=null&&a.user)&&(r=a.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Je(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Mu(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Ak()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(vi(this.app))return Promise.reject(Yc(this));const n=e?an(e):null;return n&&Je(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Je(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return vi(this.app)?Promise.reject(Yc(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return vi(this.app)?Promise.reject(Yc(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(_s(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Yk(this),n=new Jk(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ml("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await Bk(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&_s(e)||this._popupRedirectResolver;Je(n,this,"argument-error"),this.redirectPersistenceManager=await bo.create(this,[_s(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Je(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const a=e.addObserver(n,r,i);return()=>{o=!0,a()}}else{const a=e.addObserver(n);return()=>{o=!0,a()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Je(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=WE(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(vi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&bk(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function eP(t){return an(t)}class i_{constructor(e){this.auth=e,this.observer=null,this.addObserver=mN(n=>this.observer=n)}get next(){return Je(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function tP(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(_s);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}new Ll(3e4,6e4);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */new Ll(2e3,1e4);/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */new Ll(3e4,6e4);/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */new Ll(5e3,15e3);var s_="@firebase/auth",o_="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nP{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Je(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rP(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function iP(t){ks(new $i("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;Je(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const a={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:WE(t)},d=new Zk(r,i,s,a);return tP(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),ks(new $i("auth-internal",e=>{const n=eP(e.getProvider("auth").getImmediate());return(r=>new nP(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Nr(s_,o_,rP(t)),Nr(s_,o_,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sP=5*60;ZA("authIdTokenMaxAge");iP("Browser");var oP="firebase",aP="12.5.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Nr(oP,aP,"app");var a_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Vi,qE;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(x,I){function R(){}R.prototype=I.prototype,x.F=I.prototype,x.prototype=new R,x.prototype.constructor=x,x.D=function(E,T,k){for(var N=Array(arguments.length-2),te=2;te<arguments.length;te++)N[te-2]=arguments[te];return I.prototype[T].apply(E,N)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(x,I,R){R||(R=0);const E=Array(16);if(typeof I=="string")for(var T=0;T<16;++T)E[T]=I.charCodeAt(R++)|I.charCodeAt(R++)<<8|I.charCodeAt(R++)<<16|I.charCodeAt(R++)<<24;else for(T=0;T<16;++T)E[T]=I[R++]|I[R++]<<8|I[R++]<<16|I[R++]<<24;I=x.g[0],R=x.g[1],T=x.g[2];let k=x.g[3],N;N=I+(k^R&(T^k))+E[0]+3614090360&4294967295,I=R+(N<<7&4294967295|N>>>25),N=k+(T^I&(R^T))+E[1]+3905402710&4294967295,k=I+(N<<12&4294967295|N>>>20),N=T+(R^k&(I^R))+E[2]+606105819&4294967295,T=k+(N<<17&4294967295|N>>>15),N=R+(I^T&(k^I))+E[3]+3250441966&4294967295,R=T+(N<<22&4294967295|N>>>10),N=I+(k^R&(T^k))+E[4]+4118548399&4294967295,I=R+(N<<7&4294967295|N>>>25),N=k+(T^I&(R^T))+E[5]+1200080426&4294967295,k=I+(N<<12&4294967295|N>>>20),N=T+(R^k&(I^R))+E[6]+2821735955&4294967295,T=k+(N<<17&4294967295|N>>>15),N=R+(I^T&(k^I))+E[7]+4249261313&4294967295,R=T+(N<<22&4294967295|N>>>10),N=I+(k^R&(T^k))+E[8]+1770035416&4294967295,I=R+(N<<7&4294967295|N>>>25),N=k+(T^I&(R^T))+E[9]+2336552879&4294967295,k=I+(N<<12&4294967295|N>>>20),N=T+(R^k&(I^R))+E[10]+4294925233&4294967295,T=k+(N<<17&4294967295|N>>>15),N=R+(I^T&(k^I))+E[11]+2304563134&4294967295,R=T+(N<<22&4294967295|N>>>10),N=I+(k^R&(T^k))+E[12]+1804603682&4294967295,I=R+(N<<7&4294967295|N>>>25),N=k+(T^I&(R^T))+E[13]+4254626195&4294967295,k=I+(N<<12&4294967295|N>>>20),N=T+(R^k&(I^R))+E[14]+2792965006&4294967295,T=k+(N<<17&4294967295|N>>>15),N=R+(I^T&(k^I))+E[15]+1236535329&4294967295,R=T+(N<<22&4294967295|N>>>10),N=I+(T^k&(R^T))+E[1]+4129170786&4294967295,I=R+(N<<5&4294967295|N>>>27),N=k+(R^T&(I^R))+E[6]+3225465664&4294967295,k=I+(N<<9&4294967295|N>>>23),N=T+(I^R&(k^I))+E[11]+643717713&4294967295,T=k+(N<<14&4294967295|N>>>18),N=R+(k^I&(T^k))+E[0]+3921069994&4294967295,R=T+(N<<20&4294967295|N>>>12),N=I+(T^k&(R^T))+E[5]+3593408605&4294967295,I=R+(N<<5&4294967295|N>>>27),N=k+(R^T&(I^R))+E[10]+38016083&4294967295,k=I+(N<<9&4294967295|N>>>23),N=T+(I^R&(k^I))+E[15]+3634488961&4294967295,T=k+(N<<14&4294967295|N>>>18),N=R+(k^I&(T^k))+E[4]+3889429448&4294967295,R=T+(N<<20&4294967295|N>>>12),N=I+(T^k&(R^T))+E[9]+568446438&4294967295,I=R+(N<<5&4294967295|N>>>27),N=k+(R^T&(I^R))+E[14]+3275163606&4294967295,k=I+(N<<9&4294967295|N>>>23),N=T+(I^R&(k^I))+E[3]+4107603335&4294967295,T=k+(N<<14&4294967295|N>>>18),N=R+(k^I&(T^k))+E[8]+1163531501&4294967295,R=T+(N<<20&4294967295|N>>>12),N=I+(T^k&(R^T))+E[13]+2850285829&4294967295,I=R+(N<<5&4294967295|N>>>27),N=k+(R^T&(I^R))+E[2]+4243563512&4294967295,k=I+(N<<9&4294967295|N>>>23),N=T+(I^R&(k^I))+E[7]+1735328473&4294967295,T=k+(N<<14&4294967295|N>>>18),N=R+(k^I&(T^k))+E[12]+2368359562&4294967295,R=T+(N<<20&4294967295|N>>>12),N=I+(R^T^k)+E[5]+4294588738&4294967295,I=R+(N<<4&4294967295|N>>>28),N=k+(I^R^T)+E[8]+2272392833&4294967295,k=I+(N<<11&4294967295|N>>>21),N=T+(k^I^R)+E[11]+1839030562&4294967295,T=k+(N<<16&4294967295|N>>>16),N=R+(T^k^I)+E[14]+4259657740&4294967295,R=T+(N<<23&4294967295|N>>>9),N=I+(R^T^k)+E[1]+2763975236&4294967295,I=R+(N<<4&4294967295|N>>>28),N=k+(I^R^T)+E[4]+1272893353&4294967295,k=I+(N<<11&4294967295|N>>>21),N=T+(k^I^R)+E[7]+4139469664&4294967295,T=k+(N<<16&4294967295|N>>>16),N=R+(T^k^I)+E[10]+3200236656&4294967295,R=T+(N<<23&4294967295|N>>>9),N=I+(R^T^k)+E[13]+681279174&4294967295,I=R+(N<<4&4294967295|N>>>28),N=k+(I^R^T)+E[0]+3936430074&4294967295,k=I+(N<<11&4294967295|N>>>21),N=T+(k^I^R)+E[3]+3572445317&4294967295,T=k+(N<<16&4294967295|N>>>16),N=R+(T^k^I)+E[6]+76029189&4294967295,R=T+(N<<23&4294967295|N>>>9),N=I+(R^T^k)+E[9]+3654602809&4294967295,I=R+(N<<4&4294967295|N>>>28),N=k+(I^R^T)+E[12]+3873151461&4294967295,k=I+(N<<11&4294967295|N>>>21),N=T+(k^I^R)+E[15]+530742520&4294967295,T=k+(N<<16&4294967295|N>>>16),N=R+(T^k^I)+E[2]+3299628645&4294967295,R=T+(N<<23&4294967295|N>>>9),N=I+(T^(R|~k))+E[0]+4096336452&4294967295,I=R+(N<<6&4294967295|N>>>26),N=k+(R^(I|~T))+E[7]+1126891415&4294967295,k=I+(N<<10&4294967295|N>>>22),N=T+(I^(k|~R))+E[14]+2878612391&4294967295,T=k+(N<<15&4294967295|N>>>17),N=R+(k^(T|~I))+E[5]+4237533241&4294967295,R=T+(N<<21&4294967295|N>>>11),N=I+(T^(R|~k))+E[12]+1700485571&4294967295,I=R+(N<<6&4294967295|N>>>26),N=k+(R^(I|~T))+E[3]+2399980690&4294967295,k=I+(N<<10&4294967295|N>>>22),N=T+(I^(k|~R))+E[10]+4293915773&4294967295,T=k+(N<<15&4294967295|N>>>17),N=R+(k^(T|~I))+E[1]+2240044497&4294967295,R=T+(N<<21&4294967295|N>>>11),N=I+(T^(R|~k))+E[8]+1873313359&4294967295,I=R+(N<<6&4294967295|N>>>26),N=k+(R^(I|~T))+E[15]+4264355552&4294967295,k=I+(N<<10&4294967295|N>>>22),N=T+(I^(k|~R))+E[6]+2734768916&4294967295,T=k+(N<<15&4294967295|N>>>17),N=R+(k^(T|~I))+E[13]+1309151649&4294967295,R=T+(N<<21&4294967295|N>>>11),N=I+(T^(R|~k))+E[4]+4149444226&4294967295,I=R+(N<<6&4294967295|N>>>26),N=k+(R^(I|~T))+E[11]+3174756917&4294967295,k=I+(N<<10&4294967295|N>>>22),N=T+(I^(k|~R))+E[2]+718787259&4294967295,T=k+(N<<15&4294967295|N>>>17),N=R+(k^(T|~I))+E[9]+3951481745&4294967295,x.g[0]=x.g[0]+I&4294967295,x.g[1]=x.g[1]+(T+(N<<21&4294967295|N>>>11))&4294967295,x.g[2]=x.g[2]+T&4294967295,x.g[3]=x.g[3]+k&4294967295}r.prototype.v=function(x,I){I===void 0&&(I=x.length);const R=I-this.blockSize,E=this.C;let T=this.h,k=0;for(;k<I;){if(T==0)for(;k<=R;)i(this,x,k),k+=this.blockSize;if(typeof x=="string"){for(;k<I;)if(E[T++]=x.charCodeAt(k++),T==this.blockSize){i(this,E),T=0;break}}else for(;k<I;)if(E[T++]=x[k++],T==this.blockSize){i(this,E),T=0;break}}this.h=T,this.o+=I},r.prototype.A=function(){var x=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);x[0]=128;for(var I=1;I<x.length-8;++I)x[I]=0;I=this.o*8;for(var R=x.length-8;R<x.length;++R)x[R]=I&255,I/=256;for(this.v(x),x=Array(16),I=0,R=0;R<4;++R)for(let E=0;E<32;E+=8)x[I++]=this.g[R]>>>E&255;return x};function s(x,I){var R=l;return Object.prototype.hasOwnProperty.call(R,x)?R[x]:R[x]=I(x)}function o(x,I){this.h=I;const R=[];let E=!0;for(let T=x.length-1;T>=0;T--){const k=x[T]|0;E&&k==I||(R[T]=k,E=!1)}this.g=R}var l={};function a(x){return-128<=x&&x<128?s(x,function(I){return new o([I|0],I<0?-1:0)}):new o([x|0],x<0?-1:0)}function d(x){if(isNaN(x)||!isFinite(x))return f;if(x<0)return A(d(-x));const I=[];let R=1;for(let E=0;x>=R;E++)I[E]=x/R|0,R*=4294967296;return new o(I,0)}function h(x,I){if(x.length==0)throw Error("number format error: empty string");if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(x.charAt(0)=="-")return A(h(x.substring(1),I));if(x.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=d(Math.pow(I,8));let E=f;for(let k=0;k<x.length;k+=8){var T=Math.min(8,x.length-k);const N=parseInt(x.substring(k,k+T),I);T<8?(T=d(Math.pow(I,T)),E=E.j(T).add(d(N))):(E=E.j(R),E=E.add(d(N)))}return E}var f=a(0),m=a(1),g=a(16777216);t=o.prototype,t.m=function(){if(_(this))return-A(this).m();let x=0,I=1;for(let R=0;R<this.g.length;R++){const E=this.i(R);x+=(E>=0?E:4294967296+E)*I,I*=4294967296}return x},t.toString=function(x){if(x=x||10,x<2||36<x)throw Error("radix out of range: "+x);if(S(this))return"0";if(_(this))return"-"+A(this).toString(x);const I=d(Math.pow(x,6));var R=this;let E="";for(;;){const T=j(R,I).g;R=v(R,T.j(I));let k=((R.g.length>0?R.g[0]:R.h)>>>0).toString(x);if(R=T,S(R))return k+E;for(;k.length<6;)k="0"+k;E=k+E}},t.i=function(x){return x<0?0:x<this.g.length?this.g[x]:this.h};function S(x){if(x.h!=0)return!1;for(let I=0;I<x.g.length;I++)if(x.g[I]!=0)return!1;return!0}function _(x){return x.h==-1}t.l=function(x){return x=v(this,x),_(x)?-1:S(x)?0:1};function A(x){const I=x.g.length,R=[];for(let E=0;E<I;E++)R[E]=~x.g[E];return new o(R,~x.h).add(m)}t.abs=function(){return _(this)?A(this):this},t.add=function(x){const I=Math.max(this.g.length,x.g.length),R=[];let E=0;for(let T=0;T<=I;T++){let k=E+(this.i(T)&65535)+(x.i(T)&65535),N=(k>>>16)+(this.i(T)>>>16)+(x.i(T)>>>16);E=N>>>16,k&=65535,N&=65535,R[T]=N<<16|k}return new o(R,R[R.length-1]&-2147483648?-1:0)};function v(x,I){return x.add(A(I))}t.j=function(x){if(S(this)||S(x))return f;if(_(this))return _(x)?A(this).j(A(x)):A(A(this).j(x));if(_(x))return A(this.j(A(x)));if(this.l(g)<0&&x.l(g)<0)return d(this.m()*x.m());const I=this.g.length+x.g.length,R=[];for(var E=0;E<2*I;E++)R[E]=0;for(E=0;E<this.g.length;E++)for(let T=0;T<x.g.length;T++){const k=this.i(E)>>>16,N=this.i(E)&65535,te=x.i(T)>>>16,J=x.i(T)&65535;R[2*E+2*T]+=N*J,w(R,2*E+2*T),R[2*E+2*T+1]+=k*J,w(R,2*E+2*T+1),R[2*E+2*T+1]+=N*te,w(R,2*E+2*T+1),R[2*E+2*T+2]+=k*te,w(R,2*E+2*T+2)}for(x=0;x<I;x++)R[x]=R[2*x+1]<<16|R[2*x];for(x=I;x<2*I;x++)R[x]=0;return new o(R,0)};function w(x,I){for(;(x[I]&65535)!=x[I];)x[I+1]+=x[I]>>>16,x[I]&=65535,I++}function b(x,I){this.g=x,this.h=I}function j(x,I){if(S(I))throw Error("division by zero");if(S(x))return new b(f,f);if(_(x))return I=j(A(x),I),new b(A(I.g),A(I.h));if(_(I))return I=j(x,A(I)),new b(A(I.g),I.h);if(x.g.length>30){if(_(x)||_(I))throw Error("slowDivide_ only works with positive integers.");for(var R=m,E=I;E.l(x)<=0;)R=M(R),E=M(E);var T=U(R,1),k=U(E,1);for(E=U(E,2),R=U(R,2);!S(E);){var N=k.add(E);N.l(x)<=0&&(T=T.add(R),k=N),E=U(E,1),R=U(R,1)}return I=v(x,T.j(I)),new b(T,I)}for(T=f;x.l(I)>=0;){for(R=Math.max(1,Math.floor(x.m()/I.m())),E=Math.ceil(Math.log(R)/Math.LN2),E=E<=48?1:Math.pow(2,E-48),k=d(R),N=k.j(I);_(N)||N.l(x)>0;)R-=E,k=d(R),N=k.j(I);S(k)&&(k=m),T=T.add(k),x=v(x,N)}return new b(T,x)}t.B=function(x){return j(this,x).h},t.and=function(x){const I=Math.max(this.g.length,x.g.length),R=[];for(let E=0;E<I;E++)R[E]=this.i(E)&x.i(E);return new o(R,this.h&x.h)},t.or=function(x){const I=Math.max(this.g.length,x.g.length),R=[];for(let E=0;E<I;E++)R[E]=this.i(E)|x.i(E);return new o(R,this.h|x.h)},t.xor=function(x){const I=Math.max(this.g.length,x.g.length),R=[];for(let E=0;E<I;E++)R[E]=this.i(E)^x.i(E);return new o(R,this.h^x.h)};function M(x){const I=x.g.length+1,R=[];for(let E=0;E<I;E++)R[E]=x.i(E)<<1|x.i(E-1)>>>31;return new o(R,x.h)}function U(x,I){const R=I>>5;I%=32;const E=x.g.length-R,T=[];for(let k=0;k<E;k++)T[k]=I>0?x.i(k+R)>>>I|x.i(k+R+1)<<32-I:x.i(k+R);return new o(T,x.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,qE=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,Vi=o}).apply(typeof a_<"u"?a_:typeof self<"u"?self:typeof window<"u"?window:{});var Sc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var GE,ka,QE,Xc,um,KE,YE,XE;(function(){var t,e=Object.defineProperty;function n(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof Sc=="object"&&Sc];for(var p=0;p<c.length;++p){var y=c[p];if(y&&y.Math==Math)return y}throw Error("Cannot find global object")}var r=n(this);function i(c,p){if(p)e:{var y=r;c=c.split(".");for(var P=0;P<c.length-1;P++){var W=c[P];if(!(W in y))break e;y=y[W]}c=c[c.length-1],P=y[c],p=p(P),p!=P&&p!=null&&e(y,c,{configurable:!0,writable:!0,value:p})}}i("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(c){return c||function(p){var y=[],P;for(P in p)Object.prototype.hasOwnProperty.call(p,P)&&y.push([P,p[P]]);return y}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},o=this||self;function l(c){var p=typeof c;return p=="object"&&c!=null||p=="function"}function a(c,p,y){return c.call.apply(c.bind,arguments)}function d(c,p,y){return d=a,d.apply(null,arguments)}function h(c,p){var y=Array.prototype.slice.call(arguments,1);return function(){var P=y.slice();return P.push.apply(P,arguments),c.apply(this,P)}}function f(c,p){function y(){}y.prototype=p.prototype,c.Z=p.prototype,c.prototype=new y,c.prototype.constructor=c,c.Ob=function(P,W,Y){for(var fe=Array(arguments.length-2),Me=2;Me<arguments.length;Me++)fe[Me-2]=arguments[Me];return p.prototype[W].apply(P,fe)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function g(c){const p=c.length;if(p>0){const y=Array(p);for(let P=0;P<p;P++)y[P]=c[P];return y}return[]}function S(c,p){for(let P=1;P<arguments.length;P++){const W=arguments[P];var y=typeof W;if(y=y!="object"?y:W?Array.isArray(W)?"array":y:"null",y=="array"||y=="object"&&typeof W.length=="number"){y=c.length||0;const Y=W.length||0;c.length=y+Y;for(let fe=0;fe<Y;fe++)c[y+fe]=W[fe]}else c.push(W)}}class _{constructor(p,y){this.i=p,this.j=y,this.h=0,this.g=null}get(){let p;return this.h>0?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function A(c){o.setTimeout(()=>{throw c},0)}function v(){var c=x;let p=null;return c.g&&(p=c.g,c.g=c.g.next,c.g||(c.h=null),p.next=null),p}class w{constructor(){this.h=this.g=null}add(p,y){const P=b.get();P.set(p,y),this.h?this.h.next=P:this.g=P,this.h=P}}var b=new _(()=>new j,c=>c.reset());class j{constructor(){this.next=this.g=this.h=null}set(p,y){this.h=p,this.g=y,this.next=null}reset(){this.next=this.g=this.h=null}}let M,U=!1,x=new w,I=()=>{const c=Promise.resolve(void 0);M=()=>{c.then(R)}};function R(){for(var c;c=v();){try{c.h.call(c.g)}catch(y){A(y)}var p=b;p.j(c),p.h<100&&(p.h++,c.next=p.g,p.g=c)}U=!1}function E(){this.u=this.u,this.C=this.C}E.prototype.u=!1,E.prototype.dispose=function(){this.u||(this.u=!0,this.N())},E.prototype[Symbol.dispose]=function(){this.dispose()},E.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function T(c,p){this.type=c,this.g=this.target=p,this.defaultPrevented=!1}T.prototype.h=function(){this.defaultPrevented=!0};var k=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var c=!1,p=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const y=()=>{};o.addEventListener("test",y,p),o.removeEventListener("test",y,p)}catch{}return c}();function N(c){return/^[\s\xa0]*$/.test(c)}function te(c,p){T.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,p)}f(te,T),te.prototype.init=function(c,p){const y=this.type=c.type,P=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=p,p=c.relatedTarget,p||(y=="mouseover"?p=c.fromElement:y=="mouseout"&&(p=c.toElement)),this.relatedTarget=p,P?(this.clientX=P.clientX!==void 0?P.clientX:P.pageX,this.clientY=P.clientY!==void 0?P.clientY:P.pageY,this.screenX=P.screenX||0,this.screenY=P.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&te.Z.h.call(this)},te.prototype.h=function(){te.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var J="closure_listenable_"+(Math.random()*1e6|0),ne=0;function ce(c,p,y,P,W){this.listener=c,this.proxy=null,this.src=p,this.type=y,this.capture=!!P,this.ha=W,this.key=++ne,this.da=this.fa=!1}function V(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function K(c,p,y){for(const P in c)p.call(y,c[P],P,c)}function B(c,p){for(const y in c)p.call(void 0,c[y],y,c)}function X(c){const p={};for(const y in c)p[y]=c[y];return p}const $="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Z(c,p){let y,P;for(let W=1;W<arguments.length;W++){P=arguments[W];for(y in P)c[y]=P[y];for(let Y=0;Y<$.length;Y++)y=$[Y],Object.prototype.hasOwnProperty.call(P,y)&&(c[y]=P[y])}}function q(c){this.src=c,this.g={},this.h=0}q.prototype.add=function(c,p,y,P,W){const Y=c.toString();c=this.g[Y],c||(c=this.g[Y]=[],this.h++);const fe=D(c,p,P,W);return fe>-1?(p=c[fe],y||(p.fa=!1)):(p=new ce(p,this.src,Y,!!P,W),p.fa=y,c.push(p)),p};function ae(c,p){const y=p.type;if(y in c.g){var P=c.g[y],W=Array.prototype.indexOf.call(P,p,void 0),Y;(Y=W>=0)&&Array.prototype.splice.call(P,W,1),Y&&(V(p),c.g[y].length==0&&(delete c.g[y],c.h--))}}function D(c,p,y,P){for(let W=0;W<c.length;++W){const Y=c[W];if(!Y.da&&Y.listener==p&&Y.capture==!!y&&Y.ha==P)return W}return-1}var G="closure_lm_"+(Math.random()*1e6|0),L={};function H(c,p,y,P,W){if(Array.isArray(p)){for(let Y=0;Y<p.length;Y++)H(c,p[Y],y,P,W);return null}return y=de(y),c&&c[J]?c.J(p,y,l(P)?!!P.capture:!1,W):z(c,p,y,!1,P,W)}function z(c,p,y,P,W,Y){if(!p)throw Error("Invalid event type");const fe=l(W)?!!W.capture:!!W;let Me=oe(c);if(Me||(c[G]=Me=new q(c)),y=Me.add(p,y,P,fe,Y),y.proxy)return y;if(P=se(),y.proxy=P,P.src=c,P.listener=y,c.addEventListener)k||(W=fe),W===void 0&&(W=!1),c.addEventListener(p.toString(),P,W);else if(c.attachEvent)c.attachEvent(Q(p.toString()),P);else if(c.addListener&&c.removeListener)c.addListener(P);else throw Error("addEventListener and attachEvent are unavailable.");return y}function se(){function c(y){return p.call(c.src,c.listener,y)}const p=F;return c}function ge(c,p,y,P,W){if(Array.isArray(p))for(var Y=0;Y<p.length;Y++)ge(c,p[Y],y,P,W);else P=l(P)?!!P.capture:!!P,y=de(y),c&&c[J]?(c=c.i,Y=String(p).toString(),Y in c.g&&(p=c.g[Y],y=D(p,y,P,W),y>-1&&(V(p[y]),Array.prototype.splice.call(p,y,1),p.length==0&&(delete c.g[Y],c.h--)))):c&&(c=oe(c))&&(p=c.g[p.toString()],c=-1,p&&(c=D(p,y,P,W)),(y=c>-1?p[c]:null)&&O(y))}function O(c){if(typeof c!="number"&&c&&!c.da){var p=c.src;if(p&&p[J])ae(p.i,c);else{var y=c.type,P=c.proxy;p.removeEventListener?p.removeEventListener(y,P,c.capture):p.detachEvent?p.detachEvent(Q(y),P):p.addListener&&p.removeListener&&p.removeListener(P),(y=oe(p))?(ae(y,c),y.h==0&&(y.src=null,p[G]=null)):V(c)}}}function Q(c){return c in L?L[c]:L[c]="on"+c}function F(c,p){if(c.da)c=!0;else{p=new te(p,this);const y=c.listener,P=c.ha||c.src;c.fa&&O(c),c=y.call(P,p)}return c}function oe(c){return c=c[G],c instanceof q?c:null}var re="__closure_events_fn_"+(Math.random()*1e9>>>0);function de(c){return typeof c=="function"?c:(c[re]||(c[re]=function(p){return c.handleEvent(p)}),c[re])}function ue(){E.call(this),this.i=new q(this),this.M=this,this.G=null}f(ue,E),ue.prototype[J]=!0,ue.prototype.removeEventListener=function(c,p,y,P){ge(this,c,p,y,P)};function pe(c,p){var y,P=c.G;if(P)for(y=[];P;P=P.G)y.push(P);if(c=c.M,P=p.type||p,typeof p=="string")p=new T(p,c);else if(p instanceof T)p.target=p.target||c;else{var W=p;p=new T(P,c),Z(p,W)}W=!0;let Y,fe;if(y)for(fe=y.length-1;fe>=0;fe--)Y=p.g=y[fe],W=De(Y,P,!0,p)&&W;if(Y=p.g=c,W=De(Y,P,!0,p)&&W,W=De(Y,P,!1,p)&&W,y)for(fe=0;fe<y.length;fe++)Y=p.g=y[fe],W=De(Y,P,!1,p)&&W}ue.prototype.N=function(){if(ue.Z.N.call(this),this.i){var c=this.i;for(const p in c.g){const y=c.g[p];for(let P=0;P<y.length;P++)V(y[P]);delete c.g[p],c.h--}}this.G=null},ue.prototype.J=function(c,p,y,P){return this.i.add(String(c),p,!1,y,P)},ue.prototype.K=function(c,p,y,P){return this.i.add(String(c),p,!0,y,P)};function De(c,p,y,P){if(p=c.i.g[String(p)],!p)return!0;p=p.concat();let W=!0;for(let Y=0;Y<p.length;++Y){const fe=p[Y];if(fe&&!fe.da&&fe.capture==y){const Me=fe.listener,Qt=fe.ha||fe.src;fe.fa&&ae(c.i,fe),W=Me.call(Qt,P)!==!1&&W}}return W&&!P.defaultPrevented}function Ze(c,p){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=d(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(p)>2147483647?-1:o.setTimeout(c,p||0)}function Tt(c){c.g=Ze(()=>{c.g=null,c.i&&(c.i=!1,Tt(c))},c.l);const p=c.h;c.h=null,c.m.apply(null,p)}class we extends E{constructor(p,y){super(),this.m=p,this.l=y,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:Tt(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ie(c){E.call(this),this.h=c,this.g={}}f(Ie,E);var Qe=[];function Ve(c){K(c.g,function(p,y){this.g.hasOwnProperty(y)&&O(p)},c),c.g={}}Ie.prototype.N=function(){Ie.Z.N.call(this),Ve(this)},Ie.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var mn=o.JSON.stringify,Zt=o.JSON.parse,It=class{stringify(c){return o.JSON.stringify(c,void 0)}parse(c){return o.JSON.parse(c,void 0)}};function vt(){}function ft(){}var ot={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function qt(){T.call(this,"d")}f(qt,T);function Lr(){T.call(this,"c")}f(Lr,T);var Se={},et=null;function ut(){return et=et||new ue}Se.Ia="serverreachability";function _t(c){T.call(this,Se.Ia,c)}f(_t,T);function On(c){const p=ut();pe(p,new _t(p))}Se.STAT_EVENT="statevent";function rs(c,p){T.call(this,Se.STAT_EVENT,c),this.stat=p}f(rs,T);function wt(c){const p=ut();pe(p,new rs(p,c))}Se.Ja="timingevent";function is(c,p){T.call(this,Se.Ja,c),this.size=p}f(is,T);function ss(c,p){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){c()},p)}function fr(){this.g=!0}fr.prototype.ua=function(){this.g=!1};function zd(c,p,y,P,W,Y){c.info(function(){if(c.g)if(Y){var fe="",Me=Y.split("&");for(let lt=0;lt<Me.length;lt++){var Qt=Me[lt].split("=");if(Qt.length>1){const en=Qt[0];Qt=Qt[1];const yr=en.split("_");fe=yr.length>=2&&yr[1]=="type"?fe+(en+"="+Qt+"&"):fe+(en+"=redacted&")}}}else fe=null;else fe=Y;return"XMLHTTP REQ ("+P+") [attempt "+W+"]: "+p+`
`+y+`
`+fe})}function Hd(c,p,y,P,W,Y,fe){c.info(function(){return"XMLHTTP RESP ("+P+") [ attempt "+W+"]: "+p+`
`+y+`
`+Y+" "+fe})}function Vr(c,p,y,P){c.info(function(){return"XMLHTTP TEXT ("+p+"): "+Pe(c,y)+(P?" "+P:"")})}function le(c,p){c.info(function(){return"TIMEOUT: "+p})}fr.prototype.info=function(){};function Pe(c,p){if(!c.g)return p;if(!p)return null;try{const Y=JSON.parse(p);if(Y){for(c=0;c<Y.length;c++)if(Array.isArray(Y[c])){var y=Y[c];if(!(y.length<2)){var P=y[1];if(Array.isArray(P)&&!(P.length<1)){var W=P[0];if(W!="noop"&&W!="stop"&&W!="close")for(let fe=1;fe<P.length;fe++)P[fe]=""}}}}return mn(Y)}catch{return p}}var Fe={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},rt={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Te;function Ke(){}f(Ke,vt),Ke.prototype.g=function(){return new XMLHttpRequest},Te=new Ke;function je(c){return encodeURIComponent(String(c))}function bt(c){var p=1;c=c.split(":");const y=[];for(;p>0&&c.length;)y.push(c.shift()),p--;return c.length&&y.push(c.join(":")),y}function Gt(c,p,y,P){this.j=c,this.i=p,this.l=y,this.S=P||1,this.V=new Ie(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new be}function be(){this.i=null,this.g="",this.h=!1}var ze={},Xe={};function at(c,p,y){c.M=1,c.A=Kl(gr(p)),c.u=y,c.R=!0,mr(c,null)}function mr(c,p){c.F=Date.now(),pr(c),c.B=gr(c.A);var y=c.B,P=c.S;Array.isArray(P)||(P=[String(P)]),ny(y.i,"t",P),c.C=0,y=c.j.L,c.h=new be,c.g=wy(c.j,y?p:null,!c.u),c.P>0&&(c.O=new we(d(c.Y,c,c.g),c.P)),p=c.V,y=c.g,P=c.ba;var W="readystatechange";Array.isArray(W)||(W&&(Qe[0]=W.toString()),W=Qe);for(let Y=0;Y<W.length;Y++){const fe=H(y,W[Y],P||p.handleEvent,!1,p.h||p);if(!fe)break;p.g[fe.key]=fe}p=c.J?X(c.J):{},c.u?(c.v||(c.v="POST"),p["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,p)):(c.v="GET",c.g.ea(c.B,c.v,null,p)),On(),zd(c.i,c.v,c.B,c.l,c.S,c.u)}Gt.prototype.ba=function(c){c=c.target;const p=this.O;p&&oi(c)==3?p.j():this.Y(c)},Gt.prototype.Y=function(c){try{if(c==this.g)e:{const Me=oi(this.g),Qt=this.g.ya(),lt=this.g.ca();if(!(Me<3)&&(Me!=3||this.g&&(this.h.h||this.g.la()||cy(this.g)))){this.K||Me!=4||Qt==7||(Qt==8||lt<=0?On(3):On(2)),nr(this);var p=this.g.ca();this.X=p;var y=os(this);if(this.o=p==200,Hd(this.i,this.v,this.B,this.l,this.S,Me,p),this.o){if(this.U&&!this.L){t:{if(this.g){var P,W=this.g;if((P=W.g?W.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!N(P)){var Y=P;break t}}Y=null}if(c=Y)Vr(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Wd(this,c);else{this.o=!1,this.m=3,wt(12),as(this),na(this);break e}}if(this.R){c=!0;let en;for(;!this.K&&this.C<y.length;)if(en=Ws(this,y),en==Xe){Me==4&&(this.m=4,wt(14),c=!1),Vr(this.i,this.l,null,"[Incomplete Response]");break}else if(en==ze){this.m=4,wt(15),Vr(this.i,this.l,y,"[Invalid Chunk]"),c=!1;break}else Vr(this.i,this.l,en,null),Wd(this,en);if(Hs(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Me!=4||y.length!=0||this.h.h||(this.m=1,wt(16),c=!1),this.o=this.o&&c,!c)Vr(this.i,this.l,y,"[Invalid Chunked Response]"),as(this),na(this);else if(y.length>0&&!this.W){this.W=!0;var fe=this.j;fe.g==this&&fe.aa&&!fe.P&&(fe.j.info("Great, no buffering proxy detected. Bytes received: "+y.length),Zd(fe),fe.P=!0,wt(11))}}else Vr(this.i,this.l,y,null),Wd(this,y);Me==4&&as(this),this.o&&!this.K&&(Me==4?gy(this.j,this):(this.o=!1,pr(this)))}else ob(this.g),p==400&&y.indexOf("Unknown SID")>0?(this.m=3,wt(12)):(this.m=0,wt(13)),as(this),na(this)}}}catch{}finally{}};function os(c){if(!Hs(c))return c.g.la();const p=cy(c.g);if(p==="")return"";let y="";const P=p.length,W=oi(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return as(c),na(c),"";c.h.i=new o.TextDecoder}for(let Y=0;Y<P;Y++)c.h.h=!0,y+=c.h.i.decode(p[Y],{stream:!(W&&Y==P-1)});return p.length=0,c.h.g+=y,c.C=0,c.h.g}function Hs(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function Ws(c,p){var y=c.C,P=p.indexOf(`
`,y);return P==-1?Xe:(y=Number(p.substring(y,P)),isNaN(y)?ze:(P+=1,P+y>p.length?Xe:(p=p.slice(P,P+y),c.C=P+y,p)))}Gt.prototype.cancel=function(){this.K=!0,as(this)};function pr(c){c.T=Date.now()+c.H,Ql(c,c.H)}function Ql(c,p){if(c.D!=null)throw Error("WatchDog timer not null");c.D=ss(d(c.aa,c),p)}function nr(c){c.D&&(o.clearTimeout(c.D),c.D=null)}Gt.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(le(this.i,this.B),this.M!=2&&(On(),wt(17)),as(this),this.m=2,na(this)):Ql(this,this.T-c)};function na(c){c.j.I==0||c.K||gy(c.j,c)}function as(c){nr(c);var p=c.O;p&&typeof p.dispose=="function"&&p.dispose(),c.O=null,Ve(c.V),c.g&&(p=c.g,c.g=null,p.abort(),p.dispose())}function Wd(c,p){try{var y=c.j;if(y.I!=0&&(y.g==c||qd(y.h,c))){if(!c.L&&qd(y.h,c)&&y.I==3){try{var P=y.Ba.g.parse(p)}catch{P=null}if(Array.isArray(P)&&P.length==3){var W=P;if(W[0]==0){e:if(!y.v){if(y.g)if(y.g.F+3e3<c.F)ec(y),Jl(y);else break e;Jd(y),wt(18)}}else y.xa=W[1],0<y.xa-y.K&&W[2]<37500&&y.F&&y.A==0&&!y.C&&(y.C=ss(d(y.Va,y),6e3));Qg(y.h)<=1&&y.ta&&(y.ta=void 0)}else cs(y,11)}else if((c.L||y.g==c)&&ec(y),!N(p))for(W=y.Ba.g.parse(p),p=0;p<W.length;p++){let lt=W[p];const en=lt[0];if(!(en<=y.K))if(y.K=en,lt=lt[1],y.I==2)if(lt[0]=="c"){y.M=lt[1],y.ba=lt[2];const yr=lt[3];yr!=null&&(y.ka=yr,y.j.info("VER="+y.ka));const us=lt[4];us!=null&&(y.za=us,y.j.info("SVER="+y.za));const ai=lt[5];ai!=null&&typeof ai=="number"&&ai>0&&(P=1.5*ai,y.O=P,y.j.info("backChannelRequestTimeoutMs_="+P)),P=y;const li=c.g;if(li){const nc=li.g?li.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(nc){var Y=P.h;Y.g||nc.indexOf("spdy")==-1&&nc.indexOf("quic")==-1&&nc.indexOf("h2")==-1||(Y.j=Y.l,Y.g=new Set,Y.h&&(Gd(Y,Y.h),Y.h=null))}if(P.G){const eh=li.g?li.g.getResponseHeader("X-HTTP-Session-Id"):null;eh&&(P.wa=eh,mt(P.J,P.G,eh))}}y.I=3,y.l&&y.l.ra(),y.aa&&(y.T=Date.now()-c.F,y.j.info("Handshake RTT: "+y.T+"ms")),P=y;var fe=c;if(P.na=_y(P,P.L?P.ba:null,P.W),fe.L){Kg(P.h,fe);var Me=fe,Qt=P.O;Qt&&(Me.H=Qt),Me.D&&(nr(Me),pr(Me)),P.g=fe}else my(P);y.i.length>0&&Zl(y)}else lt[0]!="stop"&&lt[0]!="close"||cs(y,7);else y.I==3&&(lt[0]=="stop"||lt[0]=="close"?lt[0]=="stop"?cs(y,7):Xd(y):lt[0]!="noop"&&y.l&&y.l.qa(lt),y.A=0)}}On(4)}catch{}}var GI=class{constructor(c,p){this.g=c,this.map=p}};function qg(c){this.l=c||10,o.PerformanceNavigationTiming?(c=o.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Gg(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function Qg(c){return c.h?1:c.g?c.g.size:0}function qd(c,p){return c.h?c.h==p:c.g?c.g.has(p):!1}function Gd(c,p){c.g?c.g.add(p):c.h=p}function Kg(c,p){c.h&&c.h==p?c.h=null:c.g&&c.g.has(p)&&c.g.delete(p)}qg.prototype.cancel=function(){if(this.i=Yg(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function Yg(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let p=c.i;for(const y of c.g.values())p=p.concat(y.G);return p}return g(c.i)}var Xg=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function QI(c,p){if(c){c=c.split("&");for(let y=0;y<c.length;y++){const P=c[y].indexOf("=");let W,Y=null;P>=0?(W=c[y].substring(0,P),Y=c[y].substring(P+1)):W=c[y],p(W,Y?decodeURIComponent(Y.replace(/\+/g," ")):"")}}}function ii(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let p;c instanceof ii?(this.l=c.l,ra(this,c.j),this.o=c.o,this.g=c.g,ia(this,c.u),this.h=c.h,Qd(this,ry(c.i)),this.m=c.m):c&&(p=String(c).match(Xg))?(this.l=!1,ra(this,p[1]||"",!0),this.o=sa(p[2]||""),this.g=sa(p[3]||"",!0),ia(this,p[4]),this.h=sa(p[5]||"",!0),Qd(this,p[6]||"",!0),this.m=sa(p[7]||"")):(this.l=!1,this.i=new aa(null,this.l))}ii.prototype.toString=function(){const c=[];var p=this.j;p&&c.push(oa(p,Jg,!0),":");var y=this.g;return(y||p=="file")&&(c.push("//"),(p=this.o)&&c.push(oa(p,Jg,!0),"@"),c.push(je(y).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y=this.u,y!=null&&c.push(":",String(y))),(y=this.h)&&(this.g&&y.charAt(0)!="/"&&c.push("/"),c.push(oa(y,y.charAt(0)=="/"?XI:YI,!0))),(y=this.i.toString())&&c.push("?",y),(y=this.m)&&c.push("#",oa(y,ZI)),c.join("")},ii.prototype.resolve=function(c){const p=gr(this);let y=!!c.j;y?ra(p,c.j):y=!!c.o,y?p.o=c.o:y=!!c.g,y?p.g=c.g:y=c.u!=null;var P=c.h;if(y)ia(p,c.u);else if(y=!!c.h){if(P.charAt(0)!="/")if(this.g&&!this.h)P="/"+P;else{var W=p.h.lastIndexOf("/");W!=-1&&(P=p.h.slice(0,W+1)+P)}if(W=P,W==".."||W==".")P="";else if(W.indexOf("./")!=-1||W.indexOf("/.")!=-1){P=W.lastIndexOf("/",0)==0,W=W.split("/");const Y=[];for(let fe=0;fe<W.length;){const Me=W[fe++];Me=="."?P&&fe==W.length&&Y.push(""):Me==".."?((Y.length>1||Y.length==1&&Y[0]!="")&&Y.pop(),P&&fe==W.length&&Y.push("")):(Y.push(Me),P=!0)}P=Y.join("/")}else P=W}return y?p.h=P:y=c.i.toString()!=="",y?Qd(p,ry(c.i)):y=!!c.m,y&&(p.m=c.m),p};function gr(c){return new ii(c)}function ra(c,p,y){c.j=y?sa(p,!0):p,c.j&&(c.j=c.j.replace(/:$/,""))}function ia(c,p){if(p){if(p=Number(p),isNaN(p)||p<0)throw Error("Bad port number "+p);c.u=p}else c.u=null}function Qd(c,p,y){p instanceof aa?(c.i=p,eb(c.i,c.l)):(y||(p=oa(p,JI)),c.i=new aa(p,c.l))}function mt(c,p,y){c.i.set(p,y)}function Kl(c){return mt(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function sa(c,p){return c?p?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function oa(c,p,y){return typeof c=="string"?(c=encodeURI(c).replace(p,KI),y&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function KI(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var Jg=/[#\/\?@]/g,YI=/[#\?:]/g,XI=/[#\?]/g,JI=/[#\?@]/g,ZI=/#/g;function aa(c,p){this.h=this.g=null,this.i=c||null,this.j=!!p}function ls(c){c.g||(c.g=new Map,c.h=0,c.i&&QI(c.i,function(p,y){c.add(decodeURIComponent(p.replace(/\+/g," ")),y)}))}t=aa.prototype,t.add=function(c,p){ls(this),this.i=null,c=qs(this,c);let y=this.g.get(c);return y||this.g.set(c,y=[]),y.push(p),this.h+=1,this};function Zg(c,p){ls(c),p=qs(c,p),c.g.has(p)&&(c.i=null,c.h-=c.g.get(p).length,c.g.delete(p))}function ey(c,p){return ls(c),p=qs(c,p),c.g.has(p)}t.forEach=function(c,p){ls(this),this.g.forEach(function(y,P){y.forEach(function(W){c.call(p,W,P,this)},this)},this)};function ty(c,p){ls(c);let y=[];if(typeof p=="string")ey(c,p)&&(y=y.concat(c.g.get(qs(c,p))));else for(c=Array.from(c.g.values()),p=0;p<c.length;p++)y=y.concat(c[p]);return y}t.set=function(c,p){return ls(this),this.i=null,c=qs(this,c),ey(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[p]),this.h+=1,this},t.get=function(c,p){return c?(c=ty(this,c),c.length>0?String(c[0]):p):p};function ny(c,p,y){Zg(c,p),y.length>0&&(c.i=null,c.g.set(qs(c,p),g(y)),c.h+=y.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],p=Array.from(this.g.keys());for(let P=0;P<p.length;P++){var y=p[P];const W=je(y);y=ty(this,y);for(let Y=0;Y<y.length;Y++){let fe=W;y[Y]!==""&&(fe+="="+je(y[Y])),c.push(fe)}}return this.i=c.join("&")};function ry(c){const p=new aa;return p.i=c.i,c.g&&(p.g=new Map(c.g),p.h=c.h),p}function qs(c,p){return p=String(p),c.j&&(p=p.toLowerCase()),p}function eb(c,p){p&&!c.j&&(ls(c),c.i=null,c.g.forEach(function(y,P){const W=P.toLowerCase();P!=W&&(Zg(this,P),ny(this,W,y))},c)),c.j=p}function tb(c,p){const y=new fr;if(o.Image){const P=new Image;P.onload=h(si,y,"TestLoadImage: loaded",!0,p,P),P.onerror=h(si,y,"TestLoadImage: error",!1,p,P),P.onabort=h(si,y,"TestLoadImage: abort",!1,p,P),P.ontimeout=h(si,y,"TestLoadImage: timeout",!1,p,P),o.setTimeout(function(){P.ontimeout&&P.ontimeout()},1e4),P.src=c}else p(!1)}function nb(c,p){const y=new fr,P=new AbortController,W=setTimeout(()=>{P.abort(),si(y,"TestPingServer: timeout",!1,p)},1e4);fetch(c,{signal:P.signal}).then(Y=>{clearTimeout(W),Y.ok?si(y,"TestPingServer: ok",!0,p):si(y,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(W),si(y,"TestPingServer: error",!1,p)})}function si(c,p,y,P,W){try{W&&(W.onload=null,W.onerror=null,W.onabort=null,W.ontimeout=null),P(y)}catch{}}function rb(){this.g=new It}function Kd(c){this.i=c.Sb||null,this.h=c.ab||!1}f(Kd,vt),Kd.prototype.g=function(){return new Yl(this.i,this.h)};function Yl(c,p){ue.call(this),this.H=c,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(Yl,ue),t=Yl.prototype,t.open=function(c,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=p,this.readyState=1,ca(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const p={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(p.body=c),(this.H||o).fetch(new Request(this.D,p)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,la(this)),this.readyState=0},t.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,ca(this)),this.g&&(this.readyState=3,ca(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;iy(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function iy(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}t.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var p=c.value?c.value:new Uint8Array(0);(p=this.B.decode(p,{stream:!c.done}))&&(this.response=this.responseText+=p)}c.done?la(this):ca(this),this.readyState==3&&iy(this)}},t.Oa=function(c){this.g&&(this.response=this.responseText=c,la(this))},t.Na=function(c){this.g&&(this.response=c,la(this))},t.ga=function(){this.g&&la(this)};function la(c){c.readyState=4,c.l=null,c.j=null,c.B=null,ca(c)}t.setRequestHeader=function(c,p){this.A.append(c,p)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],p=this.h.entries();for(var y=p.next();!y.done;)y=y.value,c.push(y[0]+": "+y[1]),y=p.next();return c.join(`\r
`)};function ca(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Yl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function sy(c){let p="";return K(c,function(y,P){p+=P,p+=":",p+=y,p+=`\r
`}),p}function Yd(c,p,y){e:{for(P in y){var P=!1;break e}P=!0}P||(y=sy(y),typeof c=="string"?y!=null&&je(y):mt(c,p,y))}function Rt(c){ue.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(Rt,ue);var ib=/^https?$/i,sb=["POST","PUT"];t=Rt.prototype,t.Fa=function(c){this.H=c},t.ea=function(c,p,y,P){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);p=p?p.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Te.g(),this.g.onreadystatechange=m(d(this.Ca,this));try{this.B=!0,this.g.open(p,String(c),!0),this.B=!1}catch(Y){oy(this,Y);return}if(c=y||"",y=new Map(this.headers),P)if(Object.getPrototypeOf(P)===Object.prototype)for(var W in P)y.set(W,P[W]);else if(typeof P.keys=="function"&&typeof P.get=="function")for(const Y of P.keys())y.set(Y,P.get(Y));else throw Error("Unknown input type for opt_headers: "+String(P));P=Array.from(y.keys()).find(Y=>Y.toLowerCase()=="content-type"),W=o.FormData&&c instanceof o.FormData,!(Array.prototype.indexOf.call(sb,p,void 0)>=0)||P||W||y.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Y,fe]of y)this.g.setRequestHeader(Y,fe);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(Y){oy(this,Y)}};function oy(c,p){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=p,c.o=5,ay(c),Xl(c)}function ay(c){c.A||(c.A=!0,pe(c,"complete"),pe(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,pe(this,"complete"),pe(this,"abort"),Xl(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Xl(this,!0)),Rt.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?ly(this):this.Xa())},t.Xa=function(){ly(this)};function ly(c){if(c.h&&typeof s<"u"){if(c.v&&oi(c)==4)setTimeout(c.Ca.bind(c),0);else if(pe(c,"readystatechange"),oi(c)==4){c.h=!1;try{const Y=c.ca();e:switch(Y){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var y;if(!(y=p)){var P;if(P=Y===0){let fe=String(c.D).match(Xg)[1]||null;!fe&&o.self&&o.self.location&&(fe=o.self.location.protocol.slice(0,-1)),P=!ib.test(fe?fe.toLowerCase():"")}y=P}if(y)pe(c,"complete"),pe(c,"success");else{c.o=6;try{var W=oi(c)>2?c.g.statusText:""}catch{W=""}c.l=W+" ["+c.ca()+"]",ay(c)}}finally{Xl(c)}}}}function Xl(c,p){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const y=c.g;c.g=null,p||pe(c,"ready");try{y.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function oi(c){return c.g?c.g.readyState:0}t.ca=function(){try{return oi(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(c){if(this.g){var p=this.g.responseText;return c&&p.indexOf(c)==0&&(p=p.substring(c.length)),Zt(p)}};function cy(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function ob(c){const p={};c=(c.g&&oi(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let P=0;P<c.length;P++){if(N(c[P]))continue;var y=bt(c[P]);const W=y[0];if(y=y[1],typeof y!="string")continue;y=y.trim();const Y=p[W]||[];p[W]=Y,Y.push(y)}B(p,function(P){return P.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ua(c,p,y){return y&&y.internalChannelParams&&y.internalChannelParams[c]||p}function uy(c){this.za=0,this.i=[],this.j=new fr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ua("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ua("baseRetryDelayMs",5e3,c),this.Za=ua("retryDelaySeedMs",1e4,c),this.Ta=ua("forwardChannelMaxRetries",2,c),this.va=ua("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new qg(c&&c.concurrentRequestLimit),this.Ba=new rb,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=uy.prototype,t.ka=8,t.I=1,t.connect=function(c,p,y,P){wt(0),this.W=c,this.H=p||{},y&&P!==void 0&&(this.H.OSID=y,this.H.OAID=P),this.F=this.X,this.J=_y(this,null,this.W),Zl(this)};function Xd(c){if(dy(c),c.I==3){var p=c.V++,y=gr(c.J);if(mt(y,"SID",c.M),mt(y,"RID",p),mt(y,"TYPE","terminate"),da(c,y),p=new Gt(c,c.j,p),p.M=2,p.A=Kl(gr(y)),y=!1,o.navigator&&o.navigator.sendBeacon)try{y=o.navigator.sendBeacon(p.A.toString(),"")}catch{}!y&&o.Image&&(new Image().src=p.A,y=!0),y||(p.g=wy(p.j,null),p.g.ea(p.A)),p.F=Date.now(),pr(p)}vy(c)}function Jl(c){c.g&&(Zd(c),c.g.cancel(),c.g=null)}function dy(c){Jl(c),c.v&&(o.clearTimeout(c.v),c.v=null),ec(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&o.clearTimeout(c.m),c.m=null)}function Zl(c){if(!Gg(c.h)&&!c.m){c.m=!0;var p=c.Ea;M||I(),U||(M(),U=!0),x.add(p,c),c.D=0}}function ab(c,p){return Qg(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=p.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=ss(d(c.Ea,c,p),yy(c,c.D)),c.D++,!0)}t.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const W=new Gt(this,this.j,c);let Y=this.o;if(this.U&&(Y?(Y=X(Y),Z(Y,this.U)):Y=this.U),this.u!==null||this.R||(W.J=Y,Y=null),this.S)e:{for(var p=0,y=0;y<this.i.length;y++){t:{var P=this.i[y];if("__data__"in P.map&&(P=P.map.__data__,typeof P=="string")){P=P.length;break t}P=void 0}if(P===void 0)break;if(p+=P,p>4096){p=y;break e}if(p===4096||y===this.i.length-1){p=y+1;break e}}p=1e3}else p=1e3;p=fy(this,W,p),y=gr(this.J),mt(y,"RID",c),mt(y,"CVER",22),this.G&&mt(y,"X-HTTP-Session-Id",this.G),da(this,y),Y&&(this.R?p="headers="+je(sy(Y))+"&"+p:this.u&&Yd(y,this.u,Y)),Gd(this.h,W),this.Ra&&mt(y,"TYPE","init"),this.S?(mt(y,"$req",p),mt(y,"SID","null"),W.U=!0,at(W,y,null)):at(W,y,p),this.I=2}}else this.I==3&&(c?hy(this,c):this.i.length==0||Gg(this.h)||hy(this))};function hy(c,p){var y;p?y=p.l:y=c.V++;const P=gr(c.J);mt(P,"SID",c.M),mt(P,"RID",y),mt(P,"AID",c.K),da(c,P),c.u&&c.o&&Yd(P,c.u,c.o),y=new Gt(c,c.j,y,c.D+1),c.u===null&&(y.J=c.o),p&&(c.i=p.G.concat(c.i)),p=fy(c,y,1e3),y.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),Gd(c.h,y),at(y,P,p)}function da(c,p){c.H&&K(c.H,function(y,P){mt(p,P,y)}),c.l&&K({},function(y,P){mt(p,P,y)})}function fy(c,p,y){y=Math.min(c.i.length,y);const P=c.l?d(c.l.Ka,c.l,c):null;e:{var W=c.i;let Me=-1;for(;;){const Qt=["count="+y];Me==-1?y>0?(Me=W[0].g,Qt.push("ofs="+Me)):Me=0:Qt.push("ofs="+Me);let lt=!0;for(let en=0;en<y;en++){var Y=W[en].g;const yr=W[en].map;if(Y-=Me,Y<0)Me=Math.max(0,W[en].g-100),lt=!1;else try{Y="req"+Y+"_"||"";try{var fe=yr instanceof Map?yr:Object.entries(yr);for(const[us,ai]of fe){let li=ai;l(ai)&&(li=mn(ai)),Qt.push(Y+us+"="+encodeURIComponent(li))}}catch(us){throw Qt.push(Y+"type="+encodeURIComponent("_badmap")),us}}catch{P&&P(yr)}}if(lt){fe=Qt.join("&");break e}}fe=void 0}return c=c.i.splice(0,y),p.G=c,fe}function my(c){if(!c.g&&!c.v){c.Y=1;var p=c.Da;M||I(),U||(M(),U=!0),x.add(p,c),c.A=0}}function Jd(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=ss(d(c.Da,c),yy(c,c.A)),c.A++,!0)}t.Da=function(){if(this.v=null,py(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=ss(d(this.Wa,this),c)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,wt(10),Jl(this),py(this))};function Zd(c){c.B!=null&&(o.clearTimeout(c.B),c.B=null)}function py(c){c.g=new Gt(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var p=gr(c.na);mt(p,"RID","rpc"),mt(p,"SID",c.M),mt(p,"AID",c.K),mt(p,"CI",c.F?"0":"1"),!c.F&&c.ia&&mt(p,"TO",c.ia),mt(p,"TYPE","xmlhttp"),da(c,p),c.u&&c.o&&Yd(p,c.u,c.o),c.O&&(c.g.H=c.O);var y=c.g;c=c.ba,y.M=1,y.A=Kl(gr(p)),y.u=null,y.R=!0,mr(y,c)}t.Va=function(){this.C!=null&&(this.C=null,Jl(this),Jd(this),wt(19))};function ec(c){c.C!=null&&(o.clearTimeout(c.C),c.C=null)}function gy(c,p){var y=null;if(c.g==p){ec(c),Zd(c),c.g=null;var P=2}else if(qd(c.h,p))y=p.G,Kg(c.h,p),P=1;else return;if(c.I!=0){if(p.o)if(P==1){y=p.u?p.u.length:0,p=Date.now()-p.F;var W=c.D;P=ut(),pe(P,new is(P,y)),Zl(c)}else my(c);else if(W=p.m,W==3||W==0&&p.X>0||!(P==1&&ab(c,p)||P==2&&Jd(c)))switch(y&&y.length>0&&(p=c.h,p.i=p.i.concat(y)),W){case 1:cs(c,5);break;case 4:cs(c,10);break;case 3:cs(c,6);break;default:cs(c,2)}}}function yy(c,p){let y=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(y*=2),y*p}function cs(c,p){if(c.j.info("Error code "+p),p==2){var y=d(c.bb,c),P=c.Ua;const W=!P;P=new ii(P||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ra(P,"https"),Kl(P),W?tb(P.toString(),y):nb(P.toString(),y)}else wt(2);c.I=0,c.l&&c.l.pa(p),vy(c),dy(c)}t.bb=function(c){c?(this.j.info("Successfully pinged google.com"),wt(2)):(this.j.info("Failed to ping google.com"),wt(1))};function vy(c){if(c.I=0,c.ja=[],c.l){const p=Yg(c.h);(p.length!=0||c.i.length!=0)&&(S(c.ja,p),S(c.ja,c.i),c.h.i.length=0,g(c.i),c.i.length=0),c.l.oa()}}function _y(c,p,y){var P=y instanceof ii?gr(y):new ii(y);if(P.g!="")p&&(P.g=p+"."+P.g),ia(P,P.u);else{var W=o.location;P=W.protocol,p=p?p+"."+W.hostname:W.hostname,W=+W.port;const Y=new ii(null);P&&ra(Y,P),p&&(Y.g=p),W&&ia(Y,W),y&&(Y.h=y),P=Y}return y=c.G,p=c.wa,y&&p&&mt(P,y,p),mt(P,"VER",c.ka),da(c,P),P}function wy(c,p,y){if(p&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return p=c.Aa&&!c.ma?new Rt(new Kd({ab:y})):new Rt(c.ma),p.Fa(c.L),p}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Sy(){}t=Sy.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function tc(){}tc.prototype.g=function(c,p){return new Ln(c,p)};function Ln(c,p){ue.call(this),this.g=new uy(p),this.l=c,this.h=p&&p.messageUrlParams||null,c=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(c?c["X-WebChannel-Content-Type"]=p.messageContentType:c={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.sa&&(c?c["X-WebChannel-Client-Profile"]=p.sa:c={"X-WebChannel-Client-Profile":p.sa}),this.g.U=c,(c=p&&p.Qb)&&!N(c)&&(this.g.u=c),this.A=p&&p.supportsCrossDomainXhr||!1,this.v=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!N(p)&&(this.g.G=p,c=this.h,c!==null&&p in c&&(c=this.h,p in c&&delete c[p])),this.j=new Gs(this)}f(Ln,ue),Ln.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Ln.prototype.close=function(){Xd(this.g)},Ln.prototype.o=function(c){var p=this.g;if(typeof c=="string"){var y={};y.__data__=c,c=y}else this.v&&(y={},y.__data__=mn(c),c=y);p.i.push(new GI(p.Ya++,c)),p.I==3&&Zl(p)},Ln.prototype.N=function(){this.g.l=null,delete this.j,Xd(this.g),delete this.g,Ln.Z.N.call(this)};function Ey(c){qt.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var p=c.__sm__;if(p){e:{for(const y in p){c=y;break e}c=void 0}(this.i=c)&&(c=this.i,p=p!==null&&c in p?p[c]:void 0),this.data=p}else this.data=c}f(Ey,qt);function Ty(){Lr.call(this),this.status=1}f(Ty,Lr);function Gs(c){this.g=c}f(Gs,Sy),Gs.prototype.ra=function(){pe(this.g,"a")},Gs.prototype.qa=function(c){pe(this.g,new Ey(c))},Gs.prototype.pa=function(c){pe(this.g,new Ty)},Gs.prototype.oa=function(){pe(this.g,"b")},tc.prototype.createWebChannel=tc.prototype.g,Ln.prototype.send=Ln.prototype.o,Ln.prototype.open=Ln.prototype.m,Ln.prototype.close=Ln.prototype.close,XE=function(){return new tc},YE=function(){return ut()},KE=Se,um={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Fe.NO_ERROR=0,Fe.TIMEOUT=8,Fe.HTTP_ERROR=6,Xc=Fe,rt.COMPLETE="complete",QE=rt,ft.EventType=ot,ot.OPEN="a",ot.CLOSE="b",ot.ERROR="c",ot.MESSAGE="d",ue.prototype.listen=ue.prototype.J,ka=ft,Rt.prototype.listenOnce=Rt.prototype.K,Rt.prototype.getLastError=Rt.prototype.Ha,Rt.prototype.getLastErrorCode=Rt.prototype.ya,Rt.prototype.getStatus=Rt.prototype.ca,Rt.prototype.getResponseJson=Rt.prototype.La,Rt.prototype.getResponseText=Rt.prototype.la,Rt.prototype.send=Rt.prototype.ea,Rt.prototype.setWithCredentials=Rt.prototype.Fa,GE=Rt}).apply(typeof Sc<"u"?Sc:typeof self<"u"?self:typeof window<"u"?window:{});const l_="@firebase/firestore",c_="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}vn.UNAUTHENTICATED=new vn(null),vn.GOOGLE_CREDENTIALS=new vn("google-credentials-uid"),vn.FIRST_PARTY=new vn("first-party-uid"),vn.MOCK_USER=new vn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xo="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ps=new $p("@firebase/firestore");function Zs(){return Ps.logLevel}function ye(t,...e){if(Ps.logLevel<=Ue.DEBUG){const n=e.map(qp);Ps.debug(`Firestore (${Xo}): ${t}`,...n)}}function Xr(t,...e){if(Ps.logLevel<=Ue.ERROR){const n=e.map(qp);Ps.error(`Firestore (${Xo}): ${t}`,...n)}}function Vo(t,...e){if(Ps.logLevel<=Ue.WARN){const n=e.map(qp);Ps.warn(`Firestore (${Xo}): ${t}`,...n)}}function qp(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ce(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,JE(t,r,n)}function JE(t,e,n){let r=`FIRESTORE (${Xo}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Xr(r),new Error(r)}function nt(t,e,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,t||JE(e,i,r)}function ke(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ee={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class me extends ri{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZE{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class lP{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(vn.UNAUTHENTICATED))}shutdown(){}}class cP{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class uP{constructor(e){this.t=e,this.currentUser=vn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){nt(this.o===void 0,42304);let r=this.i;const i=a=>this.i!==r?(r=this.i,n(a)):Promise.resolve();let s=new Wr;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Wr,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const a=s;e.enqueueRetryable(async()=>{await a.promise,await i(this.currentUser)})},l=a=>{ye("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=a,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(a=>l(a)),setTimeout(()=>{if(!this.auth){const a=this.t.getImmediate({optional:!0});a?l(a):(ye("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Wr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ye("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(nt(typeof r.accessToken=="string",31837,{l:r}),new ZE(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return nt(e===null||typeof e=="string",2055,{h:e}),new vn(e)}}class dP{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=vn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class hP{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new dP(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(vn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class u_{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class fP{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,vi(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){nt(this.o===void 0,3512);const r=s=>{s.error!=null&&ye("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,ye("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{ye("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):ye("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new u_(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(nt(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new u_(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mP(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gp{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=mP(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%62))}return r}}function Be(t,e){return t<e?-1:t>e?1:0}function dm(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const i=t.charAt(r),s=e.charAt(r);if(i!==s)return Mh(i)===Mh(s)?Be(i,s):Mh(i)?1:-1}return Be(t.length,e.length)}const pP=55296,gP=57343;function Mh(t){const e=t.charCodeAt(0);return e>=pP&&e<=gP}function Fo(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d_="__name__";class Er{constructor(e,n,r){n===void 0?n=0:n>e.length&&Ce(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&Ce(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Er.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Er?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=Er.compareSegments(e.get(i),n.get(i));if(s!==0)return s}return Be(e.length,n.length)}static compareSegments(e,n){const r=Er.isNumericId(e),i=Er.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?Er.extractNumericId(e).compare(Er.extractNumericId(n)):dm(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Vi.fromString(e.substring(4,e.length-2))}}class ct extends Er{construct(e,n,r){return new ct(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new me(ee.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new ct(n)}static emptyPath(){return new ct([])}}const yP=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class un extends Er{construct(e,n,r){return new un(e,n,r)}static isValidIdentifier(e){return yP.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),un.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===d_}static keyField(){return new un([d_])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new me(ee.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new me(ee.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const a=e[i+1];if(a!=="\\"&&a!=="."&&a!=="`")throw new me(ee.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=a,i+=2}else l==="`"?(o=!o,i++):l!=="."||o?(r+=l,i++):(s(),i++)}if(s(),o)throw new me(ee.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new un(n)}static emptyPath(){return new un([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ee{constructor(e){this.path=e}static fromPath(e){return new Ee(ct.fromString(e))}static fromName(e){return new Ee(ct.fromString(e).popFirst(5))}static empty(){return new Ee(ct.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ct.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ct.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ee(new ct(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eT(t,e,n){if(!n)throw new me(ee.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function vP(t,e,n,r){if(e===!0&&r===!0)throw new me(ee.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function h_(t){if(!Ee.isDocumentKey(t))throw new me(ee.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function f_(t){if(Ee.isDocumentKey(t))throw new me(ee.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function tT(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function _d(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Ce(12329,{type:typeof t})}function jr(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new me(ee.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=_d(t);throw new me(ee.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function _P(t,e){if(e<=0)throw new me(ee.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wt(t,e){const n={typeString:t};return e&&(n.value=e),n}function Vl(t,e){if(!tT(t))throw new me(ee.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new me(ee.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m_=-62135596800,p_=1e6;class gt{static now(){return gt.fromMillis(Date.now())}static fromDate(e){return gt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*p_);return new gt(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new me(ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new me(ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<m_)throw new me(ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new me(ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/p_}_compareTo(e){return this.seconds===e.seconds?Be(this.nanoseconds,e.nanoseconds):Be(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:gt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Vl(e,gt._jsonSchema))return new gt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-m_;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}gt._jsonSchemaVersion="firestore/timestamp/1.0",gt._jsonSchema={type:Wt("string",gt._jsonSchemaVersion),seconds:Wt("number"),nanoseconds:Wt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ne{static fromTimestamp(e){return new Ne(e)}static min(){return new Ne(new gt(0,0))}static max(){return new Ne(new gt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wl=-1;function wP(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=Ne.fromTimestamp(r===1e9?new gt(n+1,0):new gt(n,r));return new zi(i,Ee.empty(),e)}function SP(t){return new zi(t.readTime,t.key,wl)}class zi{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new zi(Ne.min(),Ee.empty(),wl)}static max(){return new zi(Ne.max(),Ee.empty(),wl)}}function EP(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Ee.comparator(t.documentKey,e.documentKey),n!==0?n:Be(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TP="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class IP{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jo(t){if(t.code!==ee.FAILED_PRECONDITION||t.message!==TP)throw t;ye("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ie{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Ce(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new ie((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof ie?n:ie.resolve(n)}catch(n){return ie.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):ie.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):ie.reject(n)}static resolve(e){return new ie((n,r)=>{n(e)})}static reject(e){return new ie((n,r)=>{r(e)})}static waitFor(e){return new ie((n,r)=>{let i=0,s=0,o=!1;e.forEach(l=>{++i,l.next(()=>{++s,o&&s===i&&n()},a=>r(a))}),o=!0,s===i&&n()})}static or(e){let n=ie.resolve(!1);for(const r of e)n=n.next(i=>i?ie.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new ie((r,i)=>{const s=e.length,o=new Array(s);let l=0;for(let a=0;a<s;a++){const d=a;n(e[d]).next(h=>{o[d]=h,++l,l===s&&r(o)},h=>i(h))}})}static doWhile(e,n){return new ie((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}function bP(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Zo(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wd{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}wd.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qp=-1;function Sd(t){return t==null}function Ou(t){return t===0&&1/t==-1/0}function xP(t){return typeof t=="number"&&Number.isInteger(t)&&!Ou(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nT="";function CP(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=g_(e)),e=AP(t.get(n),e);return g_(e)}function AP(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case nT:n+="";break;default:n+=s}}return n}function g_(t){return t+nT+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y_(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Zi(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function rT(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(e,n){this.comparator=e,this.root=n||cn.EMPTY}insert(e,n){return new Pt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,cn.BLACK,null,null))}remove(e){return new Pt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,cn.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ec(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ec(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ec(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ec(this.root,e,this.comparator,!0)}}class Ec{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class cn{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??cn.RED,this.left=i??cn.EMPTY,this.right=s??cn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new cn(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return cn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return cn.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,cn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,cn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ce(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ce(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ce(27949);return e+(this.isRed()?0:1)}}cn.EMPTY=null,cn.RED=!0,cn.BLACK=!1;cn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ce(57766)}get value(){throw Ce(16141)}get color(){throw Ce(16727)}get left(){throw Ce(29726)}get right(){throw Ce(36894)}copy(e,n,r,i,s){return this}insert(e,n,r){return new cn(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(e){this.comparator=e,this.data=new Pt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new v_(this.data.getIterator())}getIteratorFrom(e){return new v_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Jt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Jt(this.comparator);return n.data=e,n}}class v_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n{constructor(e){this.fields=e,e.sort(un.comparator)}static empty(){return new $n([])}unionWith(e){let n=new Jt(un.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new $n(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Fo(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new iT("Invalid base64 string: "+s):s}}(e);return new fn(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new fn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Be(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}fn.EMPTY_BYTE_STRING=new fn("");const NP=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Hi(t){if(nt(!!t,39018),typeof t=="string"){let e=0;const n=NP.exec(t);if(nt(!!n,46558,{timestamp:t}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Vt(t.seconds),nanos:Vt(t.nanos)}}function Vt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Wi(t){return typeof t=="string"?fn.fromBase64String(t):fn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sT="server_timestamp",oT="__type__",aT="__previous_value__",lT="__local_write_time__";function Ed(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[oT])==null?void 0:r.stringValue)===sT}function Td(t){const e=t.mapValue.fields[aT];return Ed(e)?Td(e):e}function Sl(t){const e=Hi(t.mapValue.fields[lT].timestampValue);return new gt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kP{constructor(e,n,r,i,s,o,l,a,d,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=a,this.useFetchStreams=d,this.isUsingEmulator=h}}const Lu="(default)";class El{constructor(e,n){this.projectId=e,this.database=n||Lu}static empty(){return new El("","")}get isDefaultDatabase(){return this.database===Lu}isEqual(e){return e instanceof El&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cT="__type__",PP="__max__",Tc={mapValue:{}},uT="__vector__",Vu="value";function qi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Ed(t)?4:DP(t)?9007199254740991:RP(t)?10:11:Ce(28295,{value:t})}function Mr(t,e){if(t===e)return!0;const n=qi(t);if(n!==qi(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Sl(t).isEqual(Sl(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Hi(i.timestampValue),l=Hi(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Wi(i.bytesValue).isEqual(Wi(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Vt(i.geoPointValue.latitude)===Vt(s.geoPointValue.latitude)&&Vt(i.geoPointValue.longitude)===Vt(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Vt(i.integerValue)===Vt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=Vt(i.doubleValue),l=Vt(s.doubleValue);return o===l?Ou(o)===Ou(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return Fo(t.arrayValue.values||[],e.arrayValue.values||[],Mr);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},l=s.mapValue.fields||{};if(y_(o)!==y_(l))return!1;for(const a in o)if(o.hasOwnProperty(a)&&(l[a]===void 0||!Mr(o[a],l[a])))return!1;return!0}(t,e);default:return Ce(52216,{left:t})}}function Tl(t,e){return(t.values||[]).find(n=>Mr(n,e))!==void 0}function Uo(t,e){if(t===e)return 0;const n=qi(t),r=qi(e);if(n!==r)return Be(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Be(t.booleanValue,e.booleanValue);case 2:return function(s,o){const l=Vt(s.integerValue||s.doubleValue),a=Vt(o.integerValue||o.doubleValue);return l<a?-1:l>a?1:l===a?0:isNaN(l)?isNaN(a)?0:-1:1}(t,e);case 3:return __(t.timestampValue,e.timestampValue);case 4:return __(Sl(t),Sl(e));case 5:return dm(t.stringValue,e.stringValue);case 6:return function(s,o){const l=Wi(s),a=Wi(o);return l.compareTo(a)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const l=s.split("/"),a=o.split("/");for(let d=0;d<l.length&&d<a.length;d++){const h=Be(l[d],a[d]);if(h!==0)return h}return Be(l.length,a.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const l=Be(Vt(s.latitude),Vt(o.latitude));return l!==0?l:Be(Vt(s.longitude),Vt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return w_(t.arrayValue,e.arrayValue);case 10:return function(s,o){var m,g,S,_;const l=s.fields||{},a=o.fields||{},d=(m=l[Vu])==null?void 0:m.arrayValue,h=(g=a[Vu])==null?void 0:g.arrayValue,f=Be(((S=d==null?void 0:d.values)==null?void 0:S.length)||0,((_=h==null?void 0:h.values)==null?void 0:_.length)||0);return f!==0?f:w_(d,h)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===Tc.mapValue&&o===Tc.mapValue)return 0;if(s===Tc.mapValue)return 1;if(o===Tc.mapValue)return-1;const l=s.fields||{},a=Object.keys(l),d=o.fields||{},h=Object.keys(d);a.sort(),h.sort();for(let f=0;f<a.length&&f<h.length;++f){const m=dm(a[f],h[f]);if(m!==0)return m;const g=Uo(l[a[f]],d[h[f]]);if(g!==0)return g}return Be(a.length,h.length)}(t.mapValue,e.mapValue);default:throw Ce(23264,{he:n})}}function __(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Be(t,e);const n=Hi(t),r=Hi(e),i=Be(n.seconds,r.seconds);return i!==0?i:Be(n.nanos,r.nanos)}function w_(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=Uo(n[i],r[i]);if(s)return s}return Be(n.length,r.length)}function Bo(t){return hm(t)}function hm(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Hi(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Wi(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return Ee.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=hm(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${hm(n.fields[o])}`;return i+"}"}(t.mapValue):Ce(61005,{value:t})}function Jc(t){switch(qi(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Td(t);return e?16+Jc(e):16;case 5:return 2*t.stringValue.length;case 6:return Wi(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+Jc(s),0)}(t.arrayValue);case 10:case 11:return function(r){let i=0;return Zi(r.fields,(s,o)=>{i+=s.length+Jc(o)}),i}(t.mapValue);default:throw Ce(13486,{value:t})}}function Fu(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function fm(t){return!!t&&"integerValue"in t}function Kp(t){return!!t&&"arrayValue"in t}function S_(t){return!!t&&"nullValue"in t}function E_(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Zc(t){return!!t&&"mapValue"in t}function RP(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[cT])==null?void 0:r.stringValue)===uT}function Ga(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Zi(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Ga(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Ga(t.arrayValue.values[n]);return e}return{...t}}function DP(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===PP}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e){this.value=e}static empty(){return new Pn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Zc(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ga(n)}setAll(e){let n=un.emptyPath(),r={},i=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const a=this.getFieldsMap(n);this.applyChanges(a,r,i),r={},i=[],n=l.popLast()}o?r[l.lastSegment()]=Ga(o):i.push(l.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Zc(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Mr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Zc(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Zi(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Pn(Ga(this.value))}}function dT(t){const e=[];return Zi(t.fields,(n,r)=>{const i=new un([n]);if(Zc(r)){const s=dT(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new $n(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wn{constructor(e,n,r,i,s,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new wn(e,0,Ne.min(),Ne.min(),Ne.min(),Pn.empty(),0)}static newFoundDocument(e,n,r,i){return new wn(e,1,n,Ne.min(),r,i,0)}static newNoDocument(e,n){return new wn(e,2,n,Ne.min(),Ne.min(),Pn.empty(),0)}static newUnknownDocument(e,n){return new wn(e,3,n,Ne.min(),Ne.min(),Pn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Ne.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Pn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Pn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ne.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof wn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new wn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $o{constructor(e,n){this.position=e,this.inclusive=n}}function T_(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=Ee.comparator(Ee.fromName(o.referenceValue),n.key):r=Uo(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function I_(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Mr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Il{constructor(e,n="asc"){this.field=e,this.dir=n}}function jP(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hT{}class Ht extends hT{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new OP(e,n,r):n==="array-contains"?new FP(e,r):n==="in"?new UP(e,r):n==="not-in"?new BP(e,r):n==="array-contains-any"?new $P(e,r):new Ht(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new LP(e,r):new VP(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Uo(n,this.value)):n!==null&&qi(this.value)===qi(n)&&this.matchesComparison(Uo(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ce(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class hr extends hT{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new hr(e,n)}matches(e){return fT(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function fT(t){return t.op==="and"}function mT(t){return MP(t)&&fT(t)}function MP(t){for(const e of t.filters)if(e instanceof hr)return!1;return!0}function mm(t){if(t instanceof Ht)return t.field.canonicalString()+t.op.toString()+Bo(t.value);if(mT(t))return t.filters.map(e=>mm(e)).join(",");{const e=t.filters.map(n=>mm(n)).join(",");return`${t.op}(${e})`}}function pT(t,e){return t instanceof Ht?function(r,i){return i instanceof Ht&&r.op===i.op&&r.field.isEqual(i.field)&&Mr(r.value,i.value)}(t,e):t instanceof hr?function(r,i){return i instanceof hr&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,l)=>s&&pT(o,i.filters[l]),!0):!1}(t,e):void Ce(19439)}function gT(t){return t instanceof Ht?function(n){return`${n.field.canonicalString()} ${n.op} ${Bo(n.value)}`}(t):t instanceof hr?function(n){return n.op.toString()+" {"+n.getFilters().map(gT).join(" ,")+"}"}(t):"Filter"}class OP extends Ht{constructor(e,n,r){super(e,n,r),this.key=Ee.fromName(r.referenceValue)}matches(e){const n=Ee.comparator(e.key,this.key);return this.matchesComparison(n)}}class LP extends Ht{constructor(e,n){super(e,"in",n),this.keys=yT("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class VP extends Ht{constructor(e,n){super(e,"not-in",n),this.keys=yT("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function yT(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>Ee.fromName(r.referenceValue))}class FP extends Ht{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Kp(n)&&Tl(n.arrayValue,this.value)}}class UP extends Ht{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Tl(this.value.arrayValue,n)}}class BP extends Ht{constructor(e,n){super(e,"not-in",n)}matches(e){if(Tl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Tl(this.value.arrayValue,n)}}class $P extends Ht{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Kp(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Tl(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zP{constructor(e,n=null,r=[],i=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=l,this.Te=null}}function b_(t,e=null,n=[],r=[],i=null,s=null,o=null){return new zP(t,e,n,r,i,s,o)}function Yp(t){const e=ke(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>mm(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Sd(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Bo(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Bo(r)).join(",")),e.Te=n}return e.Te}function Xp(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!jP(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!pT(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!I_(t.startAt,e.startAt)&&I_(t.endAt,e.endAt)}function pm(t){return Ee.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class es{constructor(e,n=null,r=[],i=[],s=null,o="F",l=null,a=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=a,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function HP(t,e,n,r,i,s,o,l){return new es(t,e,n,r,i,s,o,l)}function Jp(t){return new es(t)}function x_(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Zp(t){return t.collectionGroup!==null}function xo(t){const e=ke(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Jt(un.comparator);return o.filters.forEach(a=>{a.getFlattenedFilters().forEach(d=>{d.isInequality()&&(l=l.add(d.field))})}),l})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new Il(s,r))}),n.has(un.keyField().canonicalString())||e.Ie.push(new Il(un.keyField(),r))}return e.Ie}function kr(t){const e=ke(t);return e.Ee||(e.Ee=WP(e,xo(t))),e.Ee}function WP(t,e){if(t.limitType==="F")return b_(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Il(i.field,s)});const n=t.endAt?new $o(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new $o(t.startAt.position,t.startAt.inclusive):null;return b_(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function gm(t,e){const n=t.filters.concat([e]);return new es(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Uu(t,e,n){return new es(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Id(t,e){return Xp(kr(t),kr(e))&&t.limitType===e.limitType}function vT(t){return`${Yp(kr(t))}|lt:${t.limitType}`}function eo(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>gT(i)).join(", ")}]`),Sd(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Bo(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Bo(i)).join(",")),`Target(${r})`}(kr(t))}; limitType=${t.limitType})`}function bd(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):Ee.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of xo(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,l,a){const d=T_(o,l,a);return o.inclusive?d<=0:d<0}(r.startAt,xo(r),i)||r.endAt&&!function(o,l,a){const d=T_(o,l,a);return o.inclusive?d>=0:d>0}(r.endAt,xo(r),i))}(t,e)}function qP(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function _T(t){return(e,n)=>{let r=!1;for(const i of xo(t)){const s=GP(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function GP(t,e,n){const r=t.field.isKeyField()?Ee.comparator(e.key,n.key):function(s,o,l){const a=o.data.field(s),d=l.data.field(s);return a!==null&&d!==null?Uo(a,d):Ce(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Ce(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $s{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Zi(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return rT(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QP=new Pt(Ee.comparator);function Jr(){return QP}const wT=new Pt(Ee.comparator);function Pa(...t){let e=wT;for(const n of t)e=e.insert(n.key,n);return e}function ST(t){let e=wT;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function ws(){return Qa()}function ET(){return Qa()}function Qa(){return new $s(t=>t.toString(),(t,e)=>t.isEqual(e))}const KP=new Pt(Ee.comparator),YP=new Jt(Ee.comparator);function $e(...t){let e=YP;for(const n of t)e=e.add(n);return e}const XP=new Jt(Be);function JP(){return XP}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eg(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ou(e)?"-0":e}}function TT(t){return{integerValue:""+t}}function ZP(t,e){return xP(e)?TT(e):eg(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xd{constructor(){this._=void 0}}function eR(t,e,n){return t instanceof Bu?function(i,s){const o={fields:{[oT]:{stringValue:sT},[lT]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Ed(s)&&(s=Td(s)),s&&(o.fields[aT]=s),{mapValue:o}}(n,e):t instanceof bl?bT(t,e):t instanceof xl?xT(t,e):function(i,s){const o=IT(i,s),l=C_(o)+C_(i.Ae);return fm(o)&&fm(i.Ae)?TT(l):eg(i.serializer,l)}(t,e)}function tR(t,e,n){return t instanceof bl?bT(t,e):t instanceof xl?xT(t,e):n}function IT(t,e){return t instanceof $u?function(r){return fm(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Bu extends xd{}class bl extends xd{constructor(e){super(),this.elements=e}}function bT(t,e){const n=CT(e);for(const r of t.elements)n.some(i=>Mr(i,r))||n.push(r);return{arrayValue:{values:n}}}class xl extends xd{constructor(e){super(),this.elements=e}}function xT(t,e){let n=CT(e);for(const r of t.elements)n=n.filter(i=>!Mr(i,r));return{arrayValue:{values:n}}}class $u extends xd{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function C_(t){return Vt(t.integerValue||t.doubleValue)}function CT(t){return Kp(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function nR(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof bl&&i instanceof bl||r instanceof xl&&i instanceof xl?Fo(r.elements,i.elements,Mr):r instanceof $u&&i instanceof $u?Mr(r.Ae,i.Ae):r instanceof Bu&&i instanceof Bu}(t.transform,e.transform)}class rR{constructor(e,n){this.version=e,this.transformResults=n}}class cr{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new cr}static exists(e){return new cr(void 0,e)}static updateTime(e){return new cr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function eu(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Cd{}function AT(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new kT(t.key,cr.none()):new Fl(t.key,t.data,cr.none());{const n=t.data,r=Pn.empty();let i=new Jt(un.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new ts(t.key,r,new $n(i.toArray()),cr.none())}}function iR(t,e,n){t instanceof Fl?function(i,s,o){const l=i.value.clone(),a=N_(i.fieldTransforms,s,o.transformResults);l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof ts?function(i,s,o){if(!eu(i.precondition,s))return void s.convertToUnknownDocument(o.version);const l=N_(i.fieldTransforms,s,o.transformResults),a=s.data;a.setAll(NT(i)),a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Ka(t,e,n,r){return t instanceof Fl?function(s,o,l,a){if(!eu(s.precondition,o))return l;const d=s.value.clone(),h=k_(s.fieldTransforms,a,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof ts?function(s,o,l,a){if(!eu(s.precondition,o))return l;const d=k_(s.fieldTransforms,a,o),h=o.data;return h.setAll(NT(s)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(t,e,n,r):function(s,o,l){return eu(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function sR(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=IT(r.transform,i||null);s!=null&&(n===null&&(n=Pn.empty()),n.set(r.field,s))}return n||null}function A_(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Fo(r,i,(s,o)=>nR(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Fl extends Cd{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ts extends Cd{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function NT(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function N_(t,e,n){const r=new Map;nt(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,l=e.data.field(s.field);r.set(s.field,tR(o,l,n[i]))}return r}function k_(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,eR(s,o,e))}return r}class kT extends Cd{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class oR extends Cd{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aR{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&iR(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Ka(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Ka(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=ET();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=n.has(i.key)?null:l;const a=AT(o,l);a!==null&&r.set(i.key,a),o.isValidDocument()||o.convertToNoDocument(Ne.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),$e())}isEqual(e){return this.batchId===e.batchId&&Fo(this.mutations,e.mutations,(n,r)=>A_(n,r))&&Fo(this.baseMutations,e.baseMutations,(n,r)=>A_(n,r))}}class tg{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){nt(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=function(){return KP}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new tg(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lR{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cR{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Bt,He;function uR(t){switch(t){case ee.OK:return Ce(64938);case ee.CANCELLED:case ee.UNKNOWN:case ee.DEADLINE_EXCEEDED:case ee.RESOURCE_EXHAUSTED:case ee.INTERNAL:case ee.UNAVAILABLE:case ee.UNAUTHENTICATED:return!1;case ee.INVALID_ARGUMENT:case ee.NOT_FOUND:case ee.ALREADY_EXISTS:case ee.PERMISSION_DENIED:case ee.FAILED_PRECONDITION:case ee.ABORTED:case ee.OUT_OF_RANGE:case ee.UNIMPLEMENTED:case ee.DATA_LOSS:return!0;default:return Ce(15467,{code:t})}}function PT(t){if(t===void 0)return Xr("GRPC error has no .code"),ee.UNKNOWN;switch(t){case Bt.OK:return ee.OK;case Bt.CANCELLED:return ee.CANCELLED;case Bt.UNKNOWN:return ee.UNKNOWN;case Bt.DEADLINE_EXCEEDED:return ee.DEADLINE_EXCEEDED;case Bt.RESOURCE_EXHAUSTED:return ee.RESOURCE_EXHAUSTED;case Bt.INTERNAL:return ee.INTERNAL;case Bt.UNAVAILABLE:return ee.UNAVAILABLE;case Bt.UNAUTHENTICATED:return ee.UNAUTHENTICATED;case Bt.INVALID_ARGUMENT:return ee.INVALID_ARGUMENT;case Bt.NOT_FOUND:return ee.NOT_FOUND;case Bt.ALREADY_EXISTS:return ee.ALREADY_EXISTS;case Bt.PERMISSION_DENIED:return ee.PERMISSION_DENIED;case Bt.FAILED_PRECONDITION:return ee.FAILED_PRECONDITION;case Bt.ABORTED:return ee.ABORTED;case Bt.OUT_OF_RANGE:return ee.OUT_OF_RANGE;case Bt.UNIMPLEMENTED:return ee.UNIMPLEMENTED;case Bt.DATA_LOSS:return ee.DATA_LOSS;default:return Ce(39323,{code:t})}}(He=Bt||(Bt={}))[He.OK=0]="OK",He[He.CANCELLED=1]="CANCELLED",He[He.UNKNOWN=2]="UNKNOWN",He[He.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",He[He.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",He[He.NOT_FOUND=5]="NOT_FOUND",He[He.ALREADY_EXISTS=6]="ALREADY_EXISTS",He[He.PERMISSION_DENIED=7]="PERMISSION_DENIED",He[He.UNAUTHENTICATED=16]="UNAUTHENTICATED",He[He.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",He[He.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",He[He.ABORTED=10]="ABORTED",He[He.OUT_OF_RANGE=11]="OUT_OF_RANGE",He[He.UNIMPLEMENTED=12]="UNIMPLEMENTED",He[He.INTERNAL=13]="INTERNAL",He[He.UNAVAILABLE=14]="UNAVAILABLE",He[He.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dR(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hR=new Vi([4294967295,4294967295],0);function P_(t){const e=dR().encode(t),n=new qE;return n.update(e),new Uint8Array(n.digest())}function R_(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Vi([n,r],0),new Vi([i,s],0)]}class ng{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Ra(`Invalid padding: ${n}`);if(r<0)throw new Ra(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ra(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Ra(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Vi.fromNumber(this.ge)}ye(e,n,r){let i=e.add(n.multiply(Vi.fromNumber(r)));return i.compare(hR)===1&&(i=new Vi([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=P_(e),[r,i]=R_(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);if(!this.we(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new ng(s,i,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.ge===0)return;const n=P_(e),[r,i]=R_(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Ra extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ad{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Ul.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Ad(Ne.min(),i,new Pt(Be),Jr(),$e())}}class Ul{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Ul(r,n,$e(),$e(),$e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tu{constructor(e,n,r,i){this.be=e,this.removedTargetIds=n,this.key=r,this.De=i}}class RT{constructor(e,n){this.targetId=e,this.Ce=n}}class DT{constructor(e,n,r=fn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class D_{constructor(){this.ve=0,this.Fe=j_(),this.Me=fn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=$e(),n=$e(),r=$e();return this.Fe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:Ce(38017,{changeType:s})}}),new Ul(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=j_()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,nt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class fR{constructor(e){this.Ge=e,this.ze=new Map,this.je=Jr(),this.Je=Ic(),this.He=Ic(),this.Ye=new Pt(Be)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:Ce(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,i)=>{this.rt(i)&&n(i)})}st(e){const n=e.targetId,r=e.Ce.count,i=this.ot(n);if(i){const s=i.target;if(pm(s))if(r===0){const o=new Ee(s.path);this.et(n,o,wn.newNoDocument(o,Ne.min()))}else nt(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const l=this.ut(e),a=l?this.ct(l,e,o):1;if(a!==0){this.it(n);const d=a===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,l;try{o=Wi(r).toUint8Array()}catch(a){if(a instanceof iT)return Vo("Decoding the base64 bloom filter in existence filter failed ("+a.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw a}try{l=new ng(o,i,s)}catch(a){return Vo(a instanceof Ra?"BloomFilter error: ":"Applying bloom filter failed: ",a),null}return l.ge===0?null:l}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Ge.ht(),l=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.et(n,s,null),i++)}),i}Tt(e){const n=new Map;this.ze.forEach((s,o)=>{const l=this.ot(o);if(l){if(s.current&&pm(l.target)){const a=new Ee(l.target.path);this.It(a).has(o)||this.Et(o,a)||this.et(o,a,wn.newNoDocument(a,e))}s.Be&&(n.set(o,s.ke()),s.qe())}});let r=$e();this.He.forEach((s,o)=>{let l=!0;o.forEachWhile(a=>{const d=this.ot(a);return!d||d.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(s))}),this.je.forEach((s,o)=>o.setReadTime(e));const i=new Ad(e,n,this.Ye,this.je,r);return this.je=Jr(),this.Je=Ic(),this.He=Ic(),this.Ye=new Pt(Be),i}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,n)?i.Qe(n,1):i.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new D_,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Jt(Be),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Jt(Be),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||ye("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new D_),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Ic(){return new Pt(Ee.comparator)}function j_(){return new Pt(Ee.comparator)}const mR={asc:"ASCENDING",desc:"DESCENDING"},pR={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},gR={and:"AND",or:"OR"};class yR{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function ym(t,e){return t.useProto3Json||Sd(e)?e:{value:e}}function zu(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function jT(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function vR(t,e){return zu(t,e.toTimestamp())}function Pr(t){return nt(!!t,49232),Ne.fromTimestamp(function(n){const r=Hi(n);return new gt(r.seconds,r.nanos)}(t))}function rg(t,e){return vm(t,e).canonicalString()}function vm(t,e){const n=function(i){return new ct(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function MT(t){const e=ct.fromString(t);return nt(UT(e),10190,{key:e.toString()}),e}function _m(t,e){return rg(t.databaseId,e.path)}function Oh(t,e){const n=MT(e);if(n.get(1)!==t.databaseId.projectId)throw new me(ee.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new me(ee.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Ee(LT(n))}function OT(t,e){return rg(t.databaseId,e)}function _R(t){const e=MT(t);return e.length===4?ct.emptyPath():LT(e)}function wm(t){return new ct(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function LT(t){return nt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function M_(t,e,n){return{name:_m(t,e),fields:n.value.mapValue.fields}}function wR(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Ce(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(d,h){return d.useProto3Json?(nt(h===void 0||typeof h=="string",58123),fn.fromBase64String(h||"")):(nt(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),fn.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(d){const h=d.code===void 0?ee.UNKNOWN:PT(d.code);return new me(h,d.message||"")}(o);n=new DT(r,i,s,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Oh(t,r.document.name),s=Pr(r.document.updateTime),o=r.document.createTime?Pr(r.document.createTime):Ne.min(),l=new Pn({mapValue:{fields:r.document.fields}}),a=wn.newFoundDocument(i,s,o,l),d=r.targetIds||[],h=r.removedTargetIds||[];n=new tu(d,h,a.key,a)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Oh(t,r.document),s=r.readTime?Pr(r.readTime):Ne.min(),o=wn.newNoDocument(i,s),l=r.removedTargetIds||[];n=new tu([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Oh(t,r.document),s=r.removedTargetIds||[];n=new tu([],s,i,null)}else{if(!("filter"in e))return Ce(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new cR(i,s),l=r.targetId;n=new RT(l,o)}}return n}function SR(t,e){let n;if(e instanceof Fl)n={update:M_(t,e.key,e.value)};else if(e instanceof kT)n={delete:_m(t,e.key)};else if(e instanceof ts)n={update:M_(t,e.key,e.data),updateMask:kR(e.fieldMask)};else{if(!(e instanceof oR))return Ce(16599,{Vt:e.type});n={verify:_m(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const l=o.transform;if(l instanceof Bu)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof bl)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof xl)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof $u)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw Ce(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:vR(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ce(27497)}(t,e.precondition)),n}function ER(t,e){return t&&t.length>0?(nt(e!==void 0,14353),t.map(n=>function(i,s){let o=i.updateTime?Pr(i.updateTime):Pr(s);return o.isEqual(Ne.min())&&(o=Pr(s)),new rR(o,i.transformResults||[])}(n,e))):[]}function TR(t,e){return{documents:[OT(t,e.path)]}}function IR(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=OT(t,i);const s=function(d){if(d.length!==0)return FT(hr.create(d,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(d){if(d.length!==0)return d.map(h=>function(m){return{field:to(m.field),direction:CR(m.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=ym(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:n,parent:i}}function bR(t){let e=_R(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){nt(r===1,65062);const h=n.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];n.where&&(s=function(f){const m=VT(f);return m instanceof hr&&mT(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(f){return f.map(m=>function(S){return new Il(no(S.field),function(A){switch(A){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(S.direction))}(m))}(n.orderBy));let l=null;n.limit&&(l=function(f){let m;return m=typeof f=="object"?f.value:f,Sd(m)?null:m}(n.limit));let a=null;n.startAt&&(a=function(f){const m=!!f.before,g=f.values||[];return new $o(g,m)}(n.startAt));let d=null;return n.endAt&&(d=function(f){const m=!f.before,g=f.values||[];return new $o(g,m)}(n.endAt)),HP(e,i,o,s,l,"F",a,d)}function xR(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ce(28987,{purpose:i})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function VT(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=no(n.unaryFilter.field);return Ht.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=no(n.unaryFilter.field);return Ht.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=no(n.unaryFilter.field);return Ht.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=no(n.unaryFilter.field);return Ht.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ce(61313);default:return Ce(60726)}}(t):t.fieldFilter!==void 0?function(n){return Ht.create(no(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ce(58110);default:return Ce(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return hr.create(n.compositeFilter.filters.map(r=>VT(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ce(1026)}}(n.compositeFilter.op))}(t):Ce(30097,{filter:t})}function CR(t){return mR[t]}function AR(t){return pR[t]}function NR(t){return gR[t]}function to(t){return{fieldPath:t.canonicalString()}}function no(t){return un.fromServerFormat(t.fieldPath)}function FT(t){return t instanceof Ht?function(n){if(n.op==="=="){if(E_(n.value))return{unaryFilter:{field:to(n.field),op:"IS_NAN"}};if(S_(n.value))return{unaryFilter:{field:to(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(E_(n.value))return{unaryFilter:{field:to(n.field),op:"IS_NOT_NAN"}};if(S_(n.value))return{unaryFilter:{field:to(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:to(n.field),op:AR(n.op),value:n.value}}}(t):t instanceof hr?function(n){const r=n.getFilters().map(i=>FT(i));return r.length===1?r[0]:{compositeFilter:{op:NR(n.op),filters:r}}}(t):Ce(54877,{filter:t})}function kR(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function UT(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi{constructor(e,n,r,i,s=Ne.min(),o=Ne.min(),l=fn.EMPTY_BYTE_STRING,a=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=a}withSequenceNumber(e){return new bi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new bi(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new bi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new bi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PR{constructor(e){this.yt=e}}function RR(t){const e=bR({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Uu(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DR{constructor(){this.Cn=new jR}addToCollectionParentIndex(e,n){return this.Cn.add(n),ie.resolve()}getCollectionParents(e,n){return ie.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return ie.resolve()}deleteFieldIndex(e,n){return ie.resolve()}deleteAllFieldIndexes(e){return ie.resolve()}createTargetIndexes(e,n){return ie.resolve()}getDocumentsMatchingTarget(e,n){return ie.resolve(null)}getIndexType(e,n){return ie.resolve(0)}getFieldIndexes(e,n){return ie.resolve([])}getNextCollectionGroupToUpdate(e){return ie.resolve(null)}getMinOffset(e,n){return ie.resolve(zi.min())}getMinOffsetFromCollectionGroup(e,n){return ie.resolve(zi.min())}updateCollectionGroup(e,n,r){return ie.resolve()}updateIndexEntries(e,n){return ie.resolve()}}class jR{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Jt(ct.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Jt(ct.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O_={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},BT=41943040;class Nn{static withCacheSize(e){return new Nn(e,Nn.DEFAULT_COLLECTION_PERCENTILE,Nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Nn.DEFAULT_COLLECTION_PERCENTILE=10,Nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Nn.DEFAULT=new Nn(BT,Nn.DEFAULT_COLLECTION_PERCENTILE,Nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Nn.DISABLED=new Nn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new zo(0)}static cr(){return new zo(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L_="LruGarbageCollector",MR=1048576;function V_([t,e],[n,r]){const i=Be(t,n);return i===0?Be(e,r):i}class OR{constructor(e){this.Ir=e,this.buffer=new Jt(V_),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();V_(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class LR{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ye(L_,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Zo(n)?ye(L_,"Ignoring IndexedDB error during garbage collection: ",n):await Jo(n)}await this.Vr(3e5)})}}class VR{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return ie.resolve(wd.ce);const r=new OR(n);return this.mr.forEachTarget(e,i=>r.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>r.Ar(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(ye("LruGarbageCollector","Garbage collection skipped; disabled"),ie.resolve(O_)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(ye("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),O_):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,i,s,o,l,a,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(ye("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,o=Date.now(),this.nthSequenceNumber(e,i))).next(f=>(r=f,l=Date.now(),this.removeTargets(e,r,n))).next(f=>(s=f,a=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(d=Date.now(),Zs()<=Ue.DEBUG&&ye("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(l-o)+`ms
	Removed ${s} targets in `+(a-l)+`ms
	Removed ${f} documents in `+(d-a)+`ms
Total Duration: ${d-h}ms`),ie.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:f})))}}function FR(t,e){return new VR(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UR{constructor(){this.changes=new $s(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,wn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?ie.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BR{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $R{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Ka(r.mutation,i,$n.empty(),gt.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,$e()).next(()=>r))}getLocalViewOfDocuments(e,n,r=$e()){const i=ws();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=Pa();return s.forEach((l,a)=>{o=o.insert(l,a.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=ws();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,$e()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,i){let s=Jr();const o=Qa(),l=function(){return Qa()}();return n.forEach((a,d)=>{const h=r.get(d.key);i.has(d.key)&&(h===void 0||h.mutation instanceof ts)?s=s.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),Ka(h.mutation,d,h.mutation.getFieldMask(),gt.now())):o.set(d.key,$n.empty())}),this.recalculateAndSaveOverlays(e,s).next(a=>(a.forEach((d,h)=>o.set(d,h)),n.forEach((d,h)=>l.set(d,new BR(h,o.get(d)??null))),l))}recalculateAndSaveOverlays(e,n){const r=Qa();let i=new Pt((o,l)=>o-l),s=$e();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(a=>{const d=n.get(a);if(d===null)return;let h=r.get(a)||$n.empty();h=l.applyToLocalView(d,h),r.set(a,h);const f=(i.get(l.batchId)||$e()).add(a);i=i.insert(l.batchId,f)})}).next(()=>{const o=[],l=i.getReverseIterator();for(;l.hasNext();){const a=l.getNext(),d=a.key,h=a.value,f=ET();h.forEach(m=>{if(!s.has(m)){const g=AT(n.get(m),r.get(m));g!==null&&f.set(m,g),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,f))}return ie.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return Ee.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Zp(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):ie.resolve(ws());let l=wl,a=s;return o.next(d=>ie.forEach(d,(h,f)=>(l<f.largestBatchId&&(l=f.largestBatchId),s.get(h)?ie.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{a=a.insert(h,m)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,a,d,$e())).next(h=>({batchId:l,changes:ST(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Ee(n)).next(r=>{let i=Pa();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=Pa();return this.indexManager.getCollectionParents(e,s).next(l=>ie.forEach(l,a=>{const d=function(f,m){return new es(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,a.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(h=>{h.forEach((f,m)=>{o=o.insert(f,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((a,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,wn.newInvalidDocument(h)))});let l=Pa();return o.forEach((a,d)=>{const h=s.get(a);h!==void 0&&Ka(h.mutation,d,$n.empty(),gt.now()),bd(n,d)&&(l=l.insert(a,d))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zR{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return ie.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Pr(i.createTime)}}(n)),ie.resolve()}getNamedQuery(e,n){return ie.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(i){return{name:i.name,query:RR(i.bundledQuery),readTime:Pr(i.readTime)}}(n)),ie.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HR{constructor(){this.overlays=new Pt(Ee.comparator),this.qr=new Map}getOverlay(e,n){return ie.resolve(this.overlays.get(n))}getOverlays(e,n){const r=ws();return ie.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.St(e,n,s)}),ie.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.qr.delete(r)),ie.resolve()}getOverlaysForCollection(e,n,r){const i=ws(),s=n.length+1,o=new Ee(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const a=l.getNext().value,d=a.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===s&&a.largestBatchId>r&&i.set(a.getKey(),a)}return ie.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Pt((d,h)=>d-h);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=s.get(d.largestBatchId);h===null&&(h=ws(),s=s.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const l=ws(),a=s.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach((d,h)=>l.set(d,h)),!(l.size()>=i)););return ie.resolve(l)}St(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new lR(n,r));let s=this.qr.get(n);s===void 0&&(s=$e(),this.qr.set(n,s)),this.qr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WR{constructor(){this.sessionToken=fn.EMPTY_BYTE_STRING}getSessionToken(e){return ie.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,ie.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ig{constructor(){this.Qr=new Jt(nn.$r),this.Ur=new Jt(nn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new nn(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new nn(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new Ee(new ct([])),r=new nn(n,e),i=new nn(n,e+1),s=[];return this.Ur.forEachInRange([r,i],o=>{this.Gr(o),s.push(o.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new Ee(new ct([])),r=new nn(n,e),i=new nn(n,e+1);let s=$e();return this.Ur.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new nn(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class nn{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return Ee.comparator(e.key,n.key)||Be(e.Yr,n.Yr)}static Kr(e,n){return Be(e.Yr,n.Yr)||Ee.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qR{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Jt(nn.$r)}checkEmpty(e){return ie.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new aR(s,n,r,i);this.mutationQueue.push(o);for(const l of i)this.Zr=this.Zr.add(new nn(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return ie.resolve(o)}lookupMutationBatch(e,n){return ie.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.ei(r),s=i<0?0:i;return ie.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ie.resolve(this.mutationQueue.length===0?Qp:this.tr-1)}getAllMutationBatches(e){return ie.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new nn(n,0),i=new nn(n,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],o=>{const l=this.Xr(o.Yr);s.push(l)}),ie.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Jt(Be);return n.forEach(i=>{const s=new nn(i,0),o=new nn(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],l=>{r=r.add(l.Yr)})}),ie.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;Ee.isDocumentKey(s)||(s=s.child(""));const o=new nn(new Ee(s),0);let l=new Jt(Be);return this.Zr.forEachWhile(a=>{const d=a.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(l=l.add(a.Yr)),!0)},o),ie.resolve(this.ti(l))}ti(e){const n=[];return e.forEach(r=>{const i=this.Xr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){nt(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return ie.forEach(n.mutations,i=>{const s=new nn(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new nn(n,0),i=this.Zr.firstAfterOrEqual(r);return ie.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,ie.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GR{constructor(e){this.ri=e,this.docs=function(){return new Pt(Ee.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return ie.resolve(r?r.document.mutableCopy():wn.newInvalidDocument(n))}getEntries(e,n){let r=Jr();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():wn.newInvalidDocument(i))}),ie.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Jr();const o=n.path,l=new Ee(o.child("__id-9223372036854775808__")),a=this.docs.getIteratorFrom(l);for(;a.hasNext();){const{key:d,value:{document:h}}=a.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||EP(SP(h),r)<=0||(i.has(h.key)||bd(n,h))&&(s=s.insert(h.key,h.mutableCopy()))}return ie.resolve(s)}getAllFromCollectionGroup(e,n,r,i){Ce(9500)}ii(e,n){return ie.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new QR(this)}getSize(e){return ie.resolve(this.size)}}class QR extends UR{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)}),ie.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KR{constructor(e){this.persistence=e,this.si=new $s(n=>Yp(n),Xp),this.lastRemoteSnapshotVersion=Ne.min(),this.highestTargetId=0,this.oi=0,this._i=new ig,this.targetCount=0,this.ai=zo.ur()}forEachTarget(e,n){return this.si.forEach((r,i)=>n(i)),ie.resolve()}getLastRemoteSnapshotVersion(e){return ie.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ie.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ie.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),ie.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new zo(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,ie.resolve()}updateTargetData(e,n){return this.Pr(n),ie.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,ie.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.si.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),ie.waitFor(s).next(()=>i)}getTargetCount(e){return ie.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return ie.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),ie.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),ie.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),ie.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return ie.resolve(r)}containsKey(e,n){return ie.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $T{constructor(e,n){this.ui={},this.overlays={},this.ci=new wd(0),this.li=!1,this.li=!0,this.hi=new WR,this.referenceDelegate=e(this),this.Pi=new KR(this),this.indexManager=new DR,this.remoteDocumentCache=function(i){return new GR(i)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new PR(n),this.Ii=new zR(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new HR,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new qR(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){ye("MemoryPersistence","Starting transaction:",e);const i=new YR(this.ci.next());return this.referenceDelegate.Ei(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ai(e,n){return ie.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class YR extends IP{constructor(e){super(),this.currentSequenceNumber=e}}class sg{constructor(e){this.persistence=e,this.Ri=new ig,this.Vi=null}static mi(e){return new sg(e)}get fi(){if(this.Vi)return this.Vi;throw Ce(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),ie.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),ie.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),ie.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(i=>this.fi.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.fi.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ie.forEach(this.fi,r=>{const i=Ee.fromPath(r);return this.gi(e,i).next(s=>{s||n.removeEntry(i,Ne.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return ie.or([()=>ie.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class Hu{constructor(e,n){this.persistence=e,this.pi=new $s(r=>CP(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=FR(this,n)}static mi(e,n){return new Hu(e,n)}Ei(){}di(e){return ie.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return ie.forEach(this.pi,(r,i)=>this.br(e,r,i).next(s=>s?ie.resolve():n(i)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,o=>this.br(e,o,n).next(l=>{l||(r++,s.removeEntry(o,Ne.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),ie.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),ie.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),ie.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),ie.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Jc(e.data.value)),n}br(e,n,r){return ie.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.pi.get(n);return ie.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class og{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=i}static As(e,n){let r=$e(),i=$e();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new og(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XR{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JR{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return lN()?8:bP(dr())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.ys(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ws(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new XR;return this.Ss(e,n,o).next(l=>{if(s.result=l,this.Vs)return this.bs(e,n,o,l.size)})}).next(()=>s.result)}bs(e,n,r,i){return r.documentReadCount<this.fs?(Zs()<=Ue.DEBUG&&ye("QueryEngine","SDK will not create cache indexes for query:",eo(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ie.resolve()):(Zs()<=Ue.DEBUG&&ye("QueryEngine","Query:",eo(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(Zs()<=Ue.DEBUG&&ye("QueryEngine","The SDK decides to create cache indexes for query:",eo(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,kr(n))):ie.resolve())}ys(e,n){if(x_(n))return ie.resolve(null);let r=kr(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Uu(n,null,"F"),r=kr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=$e(...s);return this.ps.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(a=>{const d=this.Ds(n,l);return this.Cs(n,d,o,a.readTime)?this.ys(e,Uu(n,null,"F")):this.vs(e,d,n,a)}))})))}ws(e,n,r,i){return x_(n)||i.isEqual(Ne.min())?ie.resolve(null):this.ps.getDocuments(e,r).next(s=>{const o=this.Ds(n,s);return this.Cs(n,o,r,i)?ie.resolve(null):(Zs()<=Ue.DEBUG&&ye("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),eo(n)),this.vs(e,o,n,wP(i,wl)).next(l=>l))})}Ds(e,n){let r=new Jt(_T(e));return n.forEach((i,s)=>{bd(e,s)&&(r=r.add(s))}),r}Cs(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,n,r){return Zs()<=Ue.DEBUG&&ye("QueryEngine","Using full collection scan to execute query:",eo(n)),this.ps.getDocumentsMatchingQuery(e,n,zi.min(),r)}vs(e,n,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ag="LocalStore",ZR=3e8;class e2{constructor(e,n,r,i){this.persistence=e,this.Fs=n,this.serializer=i,this.Ms=new Pt(Be),this.xs=new $s(s=>Yp(s),Xp),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new $R(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function t2(t,e,n,r){return new e2(t,e,n,r)}async function zT(t,e){const n=ke(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],l=[];let a=$e();for(const d of i){o.push(d.batchId);for(const h of d.mutations)a=a.add(h.key)}for(const d of s){l.push(d.batchId);for(const h of d.mutations)a=a.add(h.key)}return n.localDocuments.getDocuments(r,a).next(d=>({Ls:d,removedBatchIds:o,addedBatchIds:l}))})})}function n2(t,e){const n=ke(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.Ns.newChangeBuffer({trackRemovals:!0});return function(l,a,d,h){const f=d.batch,m=f.keys();let g=ie.resolve();return m.forEach(S=>{g=g.next(()=>h.getEntry(a,S)).next(_=>{const A=d.docVersions.get(S);nt(A!==null,48541),_.version.compareTo(A)<0&&(f.applyToRemoteDocument(_,d),_.isValidDocument()&&(_.setReadTime(d.commitVersion),h.addEntry(_)))})}),g.next(()=>l.mutationQueue.removeMutationBatch(a,f))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let a=$e();for(let d=0;d<l.mutationResults.length;++d)l.mutationResults[d].transformResults.length>0&&(a=a.add(l.batch.mutations[d].key));return a}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function HT(t){const e=ke(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function r2(t,e){const n=ke(t),r=e.snapshotVersion;let i=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;const l=[];e.targetChanges.forEach((h,f)=>{const m=i.get(f);if(!m)return;l.push(n.Pi.removeMatchingKeys(s,h.removedDocuments,f).next(()=>n.Pi.addMatchingKeys(s,h.addedDocuments,f)));let g=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?g=g.withResumeToken(fn.EMPTY_BYTE_STRING,Ne.min()).withLastLimboFreeSnapshotVersion(Ne.min()):h.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(h.resumeToken,r)),i=i.insert(f,g),function(_,A,v){return _.resumeToken.approximateByteSize()===0||A.snapshotVersion.toMicroseconds()-_.snapshotVersion.toMicroseconds()>=ZR?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(m,g,h)&&l.push(n.Pi.updateTargetData(s,g))});let a=Jr(),d=$e();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(s,h))}),l.push(i2(s,o,e.documentUpdates).next(h=>{a=h.ks,d=h.qs})),!r.isEqual(Ne.min())){const h=n.Pi.getLastRemoteSnapshotVersion(s).next(f=>n.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r));l.push(h)}return ie.waitFor(l).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,a,d)).next(()=>a)}).then(s=>(n.Ms=i,s))}function i2(t,e,n){let r=$e(),i=$e();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Jr();return n.forEach((l,a)=>{const d=s.get(l);a.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(l)),a.isNoDocument()&&a.version.isEqual(Ne.min())?(e.removeEntry(l,a.readTime),o=o.insert(l,a)):!d.isValidDocument()||a.version.compareTo(d.version)>0||a.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(a),o=o.insert(l,a)):ye(ag,"Ignoring outdated watch update for ",l,". Current version:",d.version," Watch version:",a.version)}),{ks:o,qs:i}})}function s2(t,e){const n=ke(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Qp),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function o2(t,e){const n=ke(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Pi.getTargetData(r,e).next(s=>s?(i=s,ie.resolve(i)):n.Pi.allocateTargetId(r).next(o=>(i=new bi(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function Sm(t,e,n){const r=ke(t),i=r.Ms.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Zo(o))throw o;ye(ag,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function F_(t,e,n){const r=ke(t);let i=Ne.min(),s=$e();return r.persistence.runTransaction("Execute query","readwrite",o=>function(a,d,h){const f=ke(a),m=f.xs.get(h);return m!==void 0?ie.resolve(f.Ms.get(m)):f.Pi.getTargetData(d,h)}(r,o,kr(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,l.targetId).next(a=>{s=a})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?i:Ne.min(),n?s:$e())).next(l=>(a2(r,qP(e),l),{documents:l,Qs:s})))}function a2(t,e,n){let r=t.Os.get(e)||Ne.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.Os.set(e,r)}class U_{constructor(){this.activeTargetIds=JP()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class l2{constructor(){this.Mo=new U_,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new U_,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c2{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B_="ConnectivityMonitor";class $_{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ye(B_,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ye(B_,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bc=null;function Em(){return bc===null?bc=function(){return 268435456+Math.round(2147483648*Math.random())}():bc++,"0x"+bc.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lh="RestConnection",u2={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class d2{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===Lu?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,n,r,i,s){const o=Em(),l=this.zo(e,n.toUriEncodedString());ye(Lh,`Sending RPC '${e}' ${o}:`,l,r);const a={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(a,i,s);const{host:d}=new URL(l),h=Bs(d);return this.Jo(e,l,a,r,h).then(f=>(ye(Lh,`Received RPC '${e}' ${o}: `,f),f),f=>{throw Vo(Lh,`RPC '${e}' ${o} failed with error: `,f,"url: ",l,"request:",r),f})}Ho(e,n,r,i,s,o){return this.Go(e,n,r,i,s)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Xo}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}zo(e,n){const r=u2[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h2{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yn="WebChannelConnection";class f2 extends d2{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,i,s){const o=Em();return new Promise((l,a)=>{const d=new GE;d.setWithCredentials(!0),d.listenOnce(QE.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Xc.NO_ERROR:const f=d.getResponseJson();ye(yn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),l(f);break;case Xc.TIMEOUT:ye(yn,`RPC '${e}' ${o} timed out`),a(new me(ee.DEADLINE_EXCEEDED,"Request time out"));break;case Xc.HTTP_ERROR:const m=d.getStatus();if(ye(yn,`RPC '${e}' ${o} failed with status:`,m,"response text:",d.getResponseText()),m>0){let g=d.getResponseJson();Array.isArray(g)&&(g=g[0]);const S=g==null?void 0:g.error;if(S&&S.status&&S.message){const _=function(v){const w=v.toLowerCase().replace(/_/g,"-");return Object.values(ee).indexOf(w)>=0?w:ee.UNKNOWN}(S.status);a(new me(_,S.message))}else a(new me(ee.UNKNOWN,"Server responded with status "+d.getStatus()))}else a(new me(ee.UNAVAILABLE,"Connection failed."));break;default:Ce(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{ye(yn,`RPC '${e}' ${o} completed.`)}});const h=JSON.stringify(i);ye(yn,`RPC '${e}' ${o} sending request:`,i),d.send(n,"POST",h,r,15)})}T_(e,n,r){const i=Em(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=XE(),l=YE(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(a.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(a.useFetchStreams=!0),this.jo(a.initMessageHeaders,n,r),a.encodeInitMessageHeaders=!0;const h=s.join("");ye(yn,`Creating RPC '${e}' stream ${i}: ${h}`,a);const f=o.createWebChannel(h,a);this.I_(f);let m=!1,g=!1;const S=new h2({Yo:A=>{g?ye(yn,`Not sending because RPC '${e}' stream ${i} is closed:`,A):(m||(ye(yn,`Opening RPC '${e}' stream ${i} transport.`),f.open(),m=!0),ye(yn,`RPC '${e}' stream ${i} sending:`,A),f.send(A))},Zo:()=>f.close()}),_=(A,v,w)=>{A.listen(v,b=>{try{w(b)}catch(j){setTimeout(()=>{throw j},0)}})};return _(f,ka.EventType.OPEN,()=>{g||(ye(yn,`RPC '${e}' stream ${i} transport opened.`),S.o_())}),_(f,ka.EventType.CLOSE,()=>{g||(g=!0,ye(yn,`RPC '${e}' stream ${i} transport closed`),S.a_(),this.E_(f))}),_(f,ka.EventType.ERROR,A=>{g||(g=!0,Vo(yn,`RPC '${e}' stream ${i} transport errored. Name:`,A.name,"Message:",A.message),S.a_(new me(ee.UNAVAILABLE,"The operation could not be completed")))}),_(f,ka.EventType.MESSAGE,A=>{var v;if(!g){const w=A.data[0];nt(!!w,16349);const b=w,j=(b==null?void 0:b.error)||((v=b[0])==null?void 0:v.error);if(j){ye(yn,`RPC '${e}' stream ${i} received error:`,j);const M=j.status;let U=function(R){const E=Bt[R];if(E!==void 0)return PT(E)}(M),x=j.message;U===void 0&&(U=ee.INTERNAL,x="Unknown error status: "+M+" with message "+j.message),g=!0,S.a_(new me(U,x)),f.close()}else ye(yn,`RPC '${e}' stream ${i} received:`,w),S.u_(w)}}),_(l,KE.STAT_EVENT,A=>{A.stat===um.PROXY?ye(yn,`RPC '${e}' stream ${i} detected buffering proxy`):A.stat===um.NOPROXY&&ye(yn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{S.__()},0),S}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}function Vh(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nd(t){return new yR(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WT{constructor(e,n,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,n-r);i>0&&ye("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z_="PersistentStream";class qT{constructor(e,n,r,i,s,o,l,a){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=a,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new WT(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===ee.RESOURCE_EXHAUSTED?(Xr(n.toString()),Xr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===ee.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===n&&this.G_(r,i)},r=>{e(()=>{const i=new me(ee.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return ye(z_,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(ye(z_,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class m2 extends qT{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=wR(this.serializer,e),r=function(s){if(!("targetChange"in s))return Ne.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Ne.min():o.readTime?Pr(o.readTime):Ne.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=wm(this.serializer),n.addTarget=function(s,o){let l;const a=o.target;if(l=pm(a)?{documents:TR(s,a)}:{query:IR(s,a).ft},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=jT(s,o.resumeToken);const d=ym(s,o.expectedCount);d!==null&&(l.expectedCount=d)}else if(o.snapshotVersion.compareTo(Ne.min())>0){l.readTime=zu(s,o.snapshotVersion.toTimestamp());const d=ym(s,o.expectedCount);d!==null&&(l.expectedCount=d)}return l}(this.serializer,e);const r=xR(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=wm(this.serializer),n.removeTarget=e,this.q_(n)}}class p2 extends qT{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return nt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,nt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){nt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=ER(e.writeResults,e.commitTime),r=Pr(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=wm(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>SR(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g2{}class y2 extends g2{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new me(ee.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Go(e,vm(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new me(ee.UNKNOWN,s.toString())})}Ho(e,n,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Ho(e,vm(n,r),i,o,l,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new me(ee.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class v2{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Xr(n),this.aa=!1):ye("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rs="RemoteStore";class _2{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{zs(this)&&(ye(Rs,"Restarting streams for network reachability change."),await async function(a){const d=ke(a);d.Ea.add(4),await Bl(d),d.Ra.set("Unknown"),d.Ea.delete(4),await kd(d)}(this))})}),this.Ra=new v2(r,i)}}async function kd(t){if(zs(t))for(const e of t.da)await e(!0)}async function Bl(t){for(const e of t.da)await e(!1)}function GT(t,e){const n=ke(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),dg(n)?ug(n):ea(n).O_()&&cg(n,e))}function lg(t,e){const n=ke(t),r=ea(n);n.Ia.delete(e),r.O_()&&QT(n,e),n.Ia.size===0&&(r.O_()?r.L_():zs(n)&&n.Ra.set("Unknown"))}function cg(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ne.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}ea(t).Y_(e)}function QT(t,e){t.Va.Ue(e),ea(t).Z_(e)}function ug(t){t.Va=new fR({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),ea(t).start(),t.Ra.ua()}function dg(t){return zs(t)&&!ea(t).x_()&&t.Ia.size>0}function zs(t){return ke(t).Ea.size===0}function KT(t){t.Va=void 0}async function w2(t){t.Ra.set("Online")}async function S2(t){t.Ia.forEach((e,n)=>{cg(t,e)})}async function E2(t,e){KT(t),dg(t)?(t.Ra.ha(e),ug(t)):t.Ra.set("Unknown")}async function T2(t,e,n){if(t.Ra.set("Online"),e instanceof DT&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const l of s.targetIds)i.Ia.has(l)&&(await i.remoteSyncer.rejectListen(l,o),i.Ia.delete(l),i.Va.removeTarget(l))}(t,e)}catch(r){ye(Rs,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Wu(t,r)}else if(e instanceof tu?t.Va.Ze(e):e instanceof RT?t.Va.st(e):t.Va.tt(e),!n.isEqual(Ne.min()))try{const r=await HT(t.localStore);n.compareTo(r)>=0&&await function(s,o){const l=s.Va.Tt(o);return l.targetChanges.forEach((a,d)=>{if(a.resumeToken.approximateByteSize()>0){const h=s.Ia.get(d);h&&s.Ia.set(d,h.withResumeToken(a.resumeToken,o))}}),l.targetMismatches.forEach((a,d)=>{const h=s.Ia.get(a);if(!h)return;s.Ia.set(a,h.withResumeToken(fn.EMPTY_BYTE_STRING,h.snapshotVersion)),QT(s,a);const f=new bi(h.target,a,d,h.sequenceNumber);cg(s,f)}),s.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){ye(Rs,"Failed to raise snapshot:",r),await Wu(t,r)}}async function Wu(t,e,n){if(!Zo(e))throw e;t.Ea.add(1),await Bl(t),t.Ra.set("Offline"),n||(n=()=>HT(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ye(Rs,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await kd(t)})}function YT(t,e){return e().catch(n=>Wu(t,n,e))}async function Pd(t){const e=ke(t),n=Gi(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Qp;for(;I2(e);)try{const i=await s2(e.localStore,r);if(i===null){e.Ta.length===0&&n.L_();break}r=i.batchId,b2(e,i)}catch(i){await Wu(e,i)}XT(e)&&JT(e)}function I2(t){return zs(t)&&t.Ta.length<10}function b2(t,e){t.Ta.push(e);const n=Gi(t);n.O_()&&n.X_&&n.ea(e.mutations)}function XT(t){return zs(t)&&!Gi(t).x_()&&t.Ta.length>0}function JT(t){Gi(t).start()}async function x2(t){Gi(t).ra()}async function C2(t){const e=Gi(t);for(const n of t.Ta)e.ea(n.mutations)}async function A2(t,e,n){const r=t.Ta.shift(),i=tg.from(r,e,n);await YT(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Pd(t)}async function N2(t,e){e&&Gi(t).X_&&await async function(r,i){if(function(o){return uR(o)&&o!==ee.ABORTED}(i.code)){const s=r.Ta.shift();Gi(r).B_(),await YT(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Pd(r)}}(t,e),XT(t)&&JT(t)}async function H_(t,e){const n=ke(t);n.asyncQueue.verifyOperationInProgress(),ye(Rs,"RemoteStore received new credentials");const r=zs(n);n.Ea.add(3),await Bl(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await kd(n)}async function k2(t,e){const n=ke(t);e?(n.Ea.delete(2),await kd(n)):e||(n.Ea.add(2),await Bl(n),n.Ra.set("Unknown"))}function ea(t){return t.ma||(t.ma=function(n,r,i){const s=ke(n);return s.sa(),new m2(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:w2.bind(null,t),t_:S2.bind(null,t),r_:E2.bind(null,t),H_:T2.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),dg(t)?ug(t):t.Ra.set("Unknown")):(await t.ma.stop(),KT(t))})),t.ma}function Gi(t){return t.fa||(t.fa=function(n,r,i){const s=ke(n);return s.sa(),new p2(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:x2.bind(null,t),r_:N2.bind(null,t),ta:C2.bind(null,t),na:A2.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Pd(t)):(await t.fa.stop(),t.Ta.length>0&&(ye(Rs,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hg{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Wr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,l=new hg(e,n,o,i,s);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new me(ee.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function fg(t,e){if(Xr("AsyncQueue",`${e}: ${t}`),Zo(t))return new me(ee.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{static emptySet(e){return new Co(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||Ee.comparator(n.key,r.key):(n,r)=>Ee.comparator(n.key,r.key),this.keyedMap=Pa(),this.sortedSet=new Pt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Co)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Co;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W_{constructor(){this.ga=new Pt(Ee.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Ce(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class Ho{constructor(e,n,r,i,s,o,l,a,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=a,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new Ho(e,n,Co.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Id(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P2{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class R2{constructor(){this.queries=q_(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const i=ke(n),s=i.queries;i.queries=q_(),s.forEach((o,l)=>{for(const a of l.Sa)a.onError(r)})})(this,new me(ee.ABORTED,"Firestore shutting down"))}}function q_(){return new $s(t=>vT(t),Id)}async function ZT(t,e){const n=ke(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new P2,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await n.onListen(i,!0);break;case 1:s.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const l=fg(o,`Initialization of query '${eo(e.query)}' failed`);return void e.onError(l)}n.queries.set(i,s),s.Sa.push(e),e.va(n.onlineState),s.wa&&e.Fa(s.wa)&&mg(n)}async function e1(t,e){const n=ke(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function D2(t,e){const n=ke(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const l of o.Sa)l.Fa(i)&&(r=!0);o.wa=i}}r&&mg(n)}function j2(t,e,n){const r=ke(t),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(n);r.queries.delete(e)}function mg(t){t.Ca.forEach(e=>{e.next()})}var Tm,G_;(G_=Tm||(Tm={})).Ma="default",G_.Cache="cache";class t1{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Ho(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Ho.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Tm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n1{constructor(e){this.key=e}}class r1{constructor(e){this.key=e}}class M2{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=$e(),this.mutatedKeys=$e(),this.eu=_T(e),this.tu=new Co(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new W_,i=n?n.tu:this.tu;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,l=!1;const a=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,f)=>{const m=i.get(h),g=bd(this.query,f)?f:null,S=!!m&&this.mutatedKeys.has(m.key),_=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let A=!1;m&&g?m.data.isEqual(g.data)?S!==_&&(r.track({type:3,doc:g}),A=!0):this.su(m,g)||(r.track({type:2,doc:g}),A=!0,(a&&this.eu(g,a)>0||d&&this.eu(g,d)<0)&&(l=!0)):!m&&g?(r.track({type:0,doc:g}),A=!0):m&&!g&&(r.track({type:1,doc:m}),A=!0,(a||d)&&(l=!0)),A&&(g?(o=o.add(g),s=_?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Cs:l,mutatedKeys:s}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((h,f)=>function(g,S){const _=A=>{switch(A){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ce(20277,{Rt:A})}};return _(g)-_(S)}(h.type,f.type)||this.eu(h.doc,f.doc)),this.ou(r),i=i??!1;const l=n&&!i?this._u():[],a=this.Xa.size===0&&this.current&&!i?1:0,d=a!==this.Za;return this.Za=a,o.length!==0||d?{snapshot:new Ho(this.query,e.tu,s,o,e.mutatedKeys,a===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new W_,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=$e(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new r1(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new n1(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=$e();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Ho.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const pg="SyncEngine";class O2{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class L2{constructor(e){this.key=e,this.hu=!1}}class V2{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new $s(l=>vT(l),Id),this.Iu=new Map,this.Eu=new Set,this.du=new Pt(Ee.comparator),this.Au=new Map,this.Ru=new ig,this.Vu={},this.mu=new Map,this.fu=zo.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function F2(t,e,n=!0){const r=c1(t);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await i1(r,e,n,!0),i}async function U2(t,e){const n=c1(t);await i1(n,e,!0,!1)}async function i1(t,e,n,r){const i=await o2(t.localStore,kr(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let l;return r&&(l=await B2(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&GT(t.remoteStore,i),l}async function B2(t,e,n,r,i){t.pu=(f,m,g)=>async function(_,A,v,w){let b=A.view.ru(v);b.Cs&&(b=await F_(_.localStore,A.query,!1).then(({documents:x})=>A.view.ru(x,b)));const j=w&&w.targetChanges.get(A.targetId),M=w&&w.targetMismatches.get(A.targetId)!=null,U=A.view.applyChanges(b,_.isPrimaryClient,j,M);return K_(_,A.targetId,U.au),U.snapshot}(t,f,m,g);const s=await F_(t.localStore,e,!0),o=new M2(e,s.Qs),l=o.ru(s.documents),a=Ul.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),d=o.applyChanges(l,t.isPrimaryClient,a);K_(t,n,d.au);const h=new O2(e,n,o);return t.Tu.set(e,h),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function $2(t,e,n){const r=ke(t),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter(o=>!Id(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Sm(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&lg(r.remoteStore,i.targetId),Im(r,i.targetId)}).catch(Jo)):(Im(r,i.targetId),await Sm(r.localStore,i.targetId,!0))}async function z2(t,e){const n=ke(t),r=n.Tu.get(e),i=n.Iu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),lg(n.remoteStore,r.targetId))}async function H2(t,e,n){const r=X2(t);try{const i=await function(o,l){const a=ke(o),d=gt.now(),h=l.reduce((g,S)=>g.add(S.key),$e());let f,m;return a.persistence.runTransaction("Locally write mutations","readwrite",g=>{let S=Jr(),_=$e();return a.Ns.getEntries(g,h).next(A=>{S=A,S.forEach((v,w)=>{w.isValidDocument()||(_=_.add(v))})}).next(()=>a.localDocuments.getOverlayedDocuments(g,S)).next(A=>{f=A;const v=[];for(const w of l){const b=sR(w,f.get(w.key).overlayedDocument);b!=null&&v.push(new ts(w.key,b,dT(b.value.mapValue),cr.exists(!0)))}return a.mutationQueue.addMutationBatch(g,d,v,l)}).next(A=>{m=A;const v=A.applyToLocalDocumentSet(f,_);return a.documentOverlayCache.saveOverlays(g,A.batchId,v)})}).then(()=>({batchId:m.batchId,changes:ST(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,l,a){let d=o.Vu[o.currentUser.toKey()];d||(d=new Pt(Be)),d=d.insert(l,a),o.Vu[o.currentUser.toKey()]=d}(r,i.batchId,n),await $l(r,i.changes),await Pd(r.remoteStore)}catch(i){const s=fg(i,"Failed to persist write");n.reject(s)}}async function s1(t,e){const n=ke(t);try{const r=await r2(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Au.get(s);o&&(nt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?nt(o.hu,14607):i.removedDocuments.size>0&&(nt(o.hu,42227),o.hu=!1))}),await $l(n,r,e)}catch(r){await Jo(r)}}function Q_(t,e,n){const r=ke(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Tu.forEach((s,o)=>{const l=o.view.va(e);l.snapshot&&i.push(l.snapshot)}),function(o,l){const a=ke(o);a.onlineState=l;let d=!1;a.queries.forEach((h,f)=>{for(const m of f.Sa)m.va(l)&&(d=!0)}),d&&mg(a)}(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function W2(t,e,n){const r=ke(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Au.get(e),s=i&&i.key;if(s){let o=new Pt(Ee.comparator);o=o.insert(s,wn.newNoDocument(s,Ne.min()));const l=$e().add(s),a=new Ad(Ne.min(),new Map,new Pt(Be),o,l);await s1(r,a),r.du=r.du.remove(s),r.Au.delete(e),gg(r)}else await Sm(r.localStore,e,!1).then(()=>Im(r,e,n)).catch(Jo)}async function q2(t,e){const n=ke(t),r=e.batch.batchId;try{const i=await n2(n.localStore,e);a1(n,r,null),o1(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await $l(n,i)}catch(i){await Jo(i)}}async function G2(t,e,n){const r=ke(t);try{const i=await function(o,l){const a=ke(o);return a.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return a.mutationQueue.lookupMutationBatch(d,l).next(f=>(nt(f!==null,37113),h=f.keys(),a.mutationQueue.removeMutationBatch(d,f))).next(()=>a.mutationQueue.performConsistencyCheck(d)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(d,h,l)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>a.localDocuments.getDocuments(d,h))})}(r.localStore,e);a1(r,e,n),o1(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await $l(r,i)}catch(i){await Jo(i)}}function o1(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function a1(t,e,n){const r=ke(t);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function Im(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||l1(t,r)})}function l1(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(lg(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),gg(t))}function K_(t,e,n){for(const r of n)r instanceof n1?(t.Ru.addReference(r.key,e),Q2(t,r)):r instanceof r1?(ye(pg,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||l1(t,r.key)):Ce(19791,{wu:r})}function Q2(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(ye(pg,"New document in limbo: "+n),t.Eu.add(r),gg(t))}function gg(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new Ee(ct.fromString(e)),r=t.fu.next();t.Au.set(r,new L2(n)),t.du=t.du.insert(n,r),GT(t.remoteStore,new bi(kr(Jp(n.path)),r,"TargetPurposeLimboResolution",wd.ce))}}async function $l(t,e,n){const r=ke(t),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((l,a)=>{o.push(r.pu(a,e,n).then(d=>{var h;if((d||n)&&r.isPrimaryClient){const f=d?!d.fromCache:(h=n==null?void 0:n.targetChanges.get(a.targetId))==null?void 0:h.current;r.sharedClientState.updateQueryState(a.targetId,f?"current":"not-current")}if(d){i.push(d);const f=og.As(a.targetId,d);s.push(f)}}))}),await Promise.all(o),r.Pu.H_(i),await async function(a,d){const h=ke(a);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>ie.forEach(d,m=>ie.forEach(m.Es,g=>h.persistence.referenceDelegate.addReference(f,m.targetId,g)).next(()=>ie.forEach(m.ds,g=>h.persistence.referenceDelegate.removeReference(f,m.targetId,g)))))}catch(f){if(!Zo(f))throw f;ye(ag,"Failed to update sequence numbers: "+f)}for(const f of d){const m=f.targetId;if(!f.fromCache){const g=h.Ms.get(m),S=g.snapshotVersion,_=g.withLastLimboFreeSnapshotVersion(S);h.Ms=h.Ms.insert(m,_)}}}(r.localStore,s))}async function K2(t,e){const n=ke(t);if(!n.currentUser.isEqual(e)){ye(pg,"User change. New user:",e.toKey());const r=await zT(n.localStore,e);n.currentUser=e,function(s,o){s.mu.forEach(l=>{l.forEach(a=>{a.reject(new me(ee.CANCELLED,o))})}),s.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await $l(n,r.Ls)}}function Y2(t,e){const n=ke(t),r=n.Au.get(e);if(r&&r.hu)return $e().add(r.key);{let i=$e();const s=n.Iu.get(e);if(!s)return i;for(const o of s){const l=n.Tu.get(o);i=i.unionWith(l.view.nu)}return i}}function c1(t){const e=ke(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=s1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Y2.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=W2.bind(null,e),e.Pu.H_=D2.bind(null,e.eventManager),e.Pu.yu=j2.bind(null,e.eventManager),e}function X2(t){const e=ke(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=q2.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=G2.bind(null,e),e}class qu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Nd(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return t2(this.persistence,new JR,e.initialUser,this.serializer)}Cu(e){return new $T(sg.mi,this.serializer)}Du(e){return new l2}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}qu.provider={build:()=>new qu};class J2 extends qu{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){nt(this.persistence.referenceDelegate instanceof Hu,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new LR(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Nn.withCacheSize(this.cacheSizeBytes):Nn.DEFAULT;return new $T(r=>Hu.mi(r,n),this.serializer)}}class bm{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Q_(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=K2.bind(null,this.syncEngine),await k2(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new R2}()}createDatastore(e){const n=Nd(e.databaseInfo.databaseId),r=function(s){return new f2(s)}(e.databaseInfo);return function(s,o,l,a){return new y2(s,o,l,a)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,l){return new _2(r,i,s,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>Q_(this.syncEngine,n,0),function(){return $_.v()?new $_:new c2}())}createSyncEngine(e,n){return function(i,s,o,l,a,d,h){const f=new V2(i,s,o,l,a,d);return h&&(f.gu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=ke(i);ye(Rs,"RemoteStore shutting down."),s.Ea.add(5),await Bl(s),s.Aa.shutdown(),s.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}bm.provider={build:()=>new bm};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u1{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Xr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qi="FirestoreClient";class Z2{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=vn.UNAUTHENTICATED,this.clientId=Gp.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{ye(Qi,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(ye(Qi,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Wr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=fg(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Fh(t,e){t.asyncQueue.verifyOperationInProgress(),ye(Qi,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await zT(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Y_(t,e){t.asyncQueue.verifyOperationInProgress();const n=await eD(t);ye(Qi,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>H_(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>H_(e.remoteStore,i)),t._onlineComponents=e}async function eD(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ye(Qi,"Using user provided OfflineComponentProvider");try{await Fh(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===ee.FAILED_PRECONDITION||i.code===ee.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Vo("Error using user provided cache. Falling back to memory cache: "+n),await Fh(t,new qu)}}else ye(Qi,"Using default OfflineComponentProvider"),await Fh(t,new J2(void 0));return t._offlineComponents}async function d1(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ye(Qi,"Using user provided OnlineComponentProvider"),await Y_(t,t._uninitializedComponentsProvider._online)):(ye(Qi,"Using default OnlineComponentProvider"),await Y_(t,new bm))),t._onlineComponents}function tD(t){return d1(t).then(e=>e.syncEngine)}async function h1(t){const e=await d1(t),n=e.eventManager;return n.onListen=F2.bind(null,e.syncEngine),n.onUnlisten=$2.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=U2.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=z2.bind(null,e.syncEngine),n}function nD(t,e,n={}){const r=new Wr;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,l,a,d){const h=new u1({next:m=>{h.Nu(),o.enqueueAndForget(()=>e1(s,f));const g=m.docs.has(l);!g&&m.fromCache?d.reject(new me(ee.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&m.fromCache&&a&&a.source==="server"?d.reject(new me(ee.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(m)},error:m=>d.reject(m)}),f=new t1(Jp(l.path),h,{includeMetadataChanges:!0,qa:!0});return ZT(s,f)}(await h1(t),t.asyncQueue,e,n,r)),r.promise}function rD(t,e,n={}){const r=new Wr;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,l,a,d){const h=new u1({next:m=>{h.Nu(),o.enqueueAndForget(()=>e1(s,f)),m.fromCache&&a.source==="server"?d.reject(new me(ee.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),f=new t1(l,h,{includeMetadataChanges:!0,qa:!0});return ZT(s,f)}(await h1(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f1(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X_=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m1="firestore.googleapis.com",J_=!0;class Z_{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new me(ee.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=m1,this.ssl=J_}else this.host=e.host,this.ssl=e.ssl??J_;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=BT;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<MR)throw new me(ee.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}vP("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=f1(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new me(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new me(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new me(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Rd{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Z_({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new me(ee.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new me(ee.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Z_(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new lP;switch(r.type){case"firstParty":return new hP(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new me(ee.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=X_.get(n);r&&(ye("ComponentProvider","Removing Datastore"),X_.delete(n),r.terminate())}(this),Promise.resolve()}}function iD(t,e,n,r={}){var d;t=jr(t,Rd);const i=Bs(e),s=t._getSettings(),o={...s,emulatorOptions:t._getEmulatorOptions()},l=`${e}:${n}`;i&&(TE(`https://${l}`),bE("Firestore",!0)),s.host!==m1&&s.host!==l&&Vo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const a={...s,host:l,ssl:i,emulatorOptions:r};if(!Pu(a,o)&&(t._setSettings(a),r.mockUserToken)){let h,f;if(typeof r.mockUserToken=="string")h=r.mockUserToken,f=vn.MOCK_USER;else{h=IE(r.mockUserToken,(d=t._app)==null?void 0:d.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new me(ee.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new vn(m)}t._authCredentials=new cP(new ZE(h,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Or(this.firestore,e,this._query)}}class Ut{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Fi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ut(this.firestore,e,this._key)}toJSON(){return{type:Ut._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(Vl(n,Ut._jsonSchema))return new Ut(e,r||null,new Ee(ct.fromString(n.referencePath)))}}Ut._jsonSchemaVersion="firestore/documentReference/1.0",Ut._jsonSchema={type:Wt("string",Ut._jsonSchemaVersion),referencePath:Wt("string")};class Fi extends Or{constructor(e,n,r){super(e,n,Jp(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ut(this.firestore,null,new Ee(e))}withConverter(e){return new Fi(this.firestore,e,this._path)}}function sD(t,e,...n){if(t=an(t),eT("collection","path",e),t instanceof Rd){const r=ct.fromString(e,...n);return f_(r),new Fi(t,null,r)}{if(!(t instanceof Ut||t instanceof Fi))throw new me(ee.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ct.fromString(e,...n));return f_(r),new Fi(t.firestore,null,r)}}function p1(t,e,...n){if(t=an(t),arguments.length===1&&(e=Gp.newId()),eT("doc","path",e),t instanceof Rd){const r=ct.fromString(e,...n);return h_(r),new Ut(t,null,new Ee(r))}{if(!(t instanceof Ut||t instanceof Fi))throw new me(ee.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ct.fromString(e,...n));return h_(r),new Ut(t.firestore,t instanceof Fi?t.converter:null,new Ee(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ew="AsyncQueue";class tw{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new WT(this,"async_queue_retry"),this._c=()=>{const r=Vh();r&&ye(ew,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Vh();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Vh();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new Wr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Zo(e))throw e;ye(ew,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,Xr("INTERNAL UNHANDLED ERROR: ",nw(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const i=hg.createAndSchedule(this,e,n,r,s=>this.hc(s));return this.tc.push(i),i}uc(){this.nc&&Ce(47125,{Pc:nw(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function nw(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class ta extends Rd{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new tw,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new tw(e),this._firestoreClient=void 0,await e}}}function oD(t,e){const n=typeof t=="object"?t:Hp(),r=typeof t=="string"?t:Lu,i=kE(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=SE("firestore");s&&iD(i,...s)}return i}function yg(t){if(t._terminated)throw new me(ee.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||aD(t),t._firestoreClient}function aD(t){var r,i,s;const e=t._freezeSettings(),n=function(l,a,d,h){return new kP(l,a,d,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,f1(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((s=e.localCache)!=null&&s._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new Z2(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(l){const a=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(a),_online:a}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Xn(fn.fromBase64String(e))}catch(n){throw new me(ee.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Xn(fn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Xn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Vl(e,Xn._jsonSchema))return Xn.fromBase64String(e.bytes)}}Xn._jsonSchemaVersion="firestore/bytes/1.0",Xn._jsonSchema={type:Wt("string",Xn._jsonSchemaVersion),bytes:Wt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dd{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new me(ee.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new un(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vg{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new me(ee.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new me(ee.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Be(this._lat,e._lat)||Be(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Rr._jsonSchemaVersion}}static fromJSON(e){if(Vl(e,Rr._jsonSchema))return new Rr(e.latitude,e.longitude)}}Rr._jsonSchemaVersion="firestore/geoPoint/1.0",Rr._jsonSchema={type:Wt("string",Rr._jsonSchemaVersion),latitude:Wt("number"),longitude:Wt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Dr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Vl(e,Dr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Dr(e.vectorValues);throw new me(ee.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Dr._jsonSchemaVersion="firestore/vectorValue/1.0",Dr._jsonSchema={type:Wt("string",Dr._jsonSchemaVersion),vectorValues:Wt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lD=/^__.*__$/;class cD{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new ts(e,this.data,this.fieldMask,n,this.fieldTransforms):new Fl(e,this.data,n,this.fieldTransforms)}}class g1{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new ts(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function y1(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ce(40011,{Ac:t})}}class _g{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new _g({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Gu(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(y1(this.Ac)&&lD.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class uD{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Nd(e)}Cc(e,n,r,i=!1){return new _g({Ac:e,methodName:n,Dc:r,path:un.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function zl(t){const e=t._freezeSettings(),n=Nd(t._databaseId);return new uD(t._databaseId,!!e.ignoreUndefinedProperties,n)}function v1(t,e,n,r,i,s={}){const o=t.Cc(s.merge||s.mergeFields?2:0,e,n,i);wg("Data must be an object, but it was:",o,r);const l=w1(r,o);let a,d;if(s.merge)a=new $n(o.fieldMask),d=o.fieldTransforms;else if(s.mergeFields){const h=[];for(const f of s.mergeFields){const m=xm(e,f,n);if(!o.contains(m))throw new me(ee.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);E1(h,m)||h.push(m)}a=new $n(h),d=o.fieldTransforms.filter(f=>a.covers(f.field))}else a=null,d=o.fieldTransforms;return new cD(new Pn(l),a,d)}class jd extends vg{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof jd}}function dD(t,e,n,r){const i=t.Cc(1,e,n);wg("Data must be an object, but it was:",i,r);const s=[],o=Pn.empty();Zi(r,(a,d)=>{const h=Sg(e,a,n);d=an(d);const f=i.yc(h);if(d instanceof jd)s.push(h);else{const m=Hl(d,f);m!=null&&(s.push(h),o.set(h,m))}});const l=new $n(s);return new g1(o,l,i.fieldTransforms)}function hD(t,e,n,r,i,s){const o=t.Cc(1,e,n),l=[xm(e,r,n)],a=[i];if(s.length%2!=0)throw new me(ee.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)l.push(xm(e,s[m])),a.push(s[m+1]);const d=[],h=Pn.empty();for(let m=l.length-1;m>=0;--m)if(!E1(d,l[m])){const g=l[m];let S=a[m];S=an(S);const _=o.yc(g);if(S instanceof jd)d.push(g);else{const A=Hl(S,_);A!=null&&(d.push(g),h.set(g,A))}}const f=new $n(d);return new g1(h,f,o.fieldTransforms)}function _1(t,e,n,r=!1){return Hl(n,t.Cc(r?4:3,e))}function Hl(t,e){if(S1(t=an(t)))return wg("Unsupported field value:",e,t),w1(t,e);if(t instanceof vg)return function(r,i){if(!y1(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const l of r){let a=Hl(l,i.wc(o));a==null&&(a={nullValue:"NULL_VALUE"}),s.push(a),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=an(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return ZP(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=gt.fromDate(r);return{timestampValue:zu(i.serializer,s)}}if(r instanceof gt){const s=new gt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:zu(i.serializer,s)}}if(r instanceof Rr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Xn)return{bytesValue:jT(i.serializer,r._byteString)};if(r instanceof Ut){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:rg(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Dr)return function(o,l){return{mapValue:{fields:{[cT]:{stringValue:uT},[Vu]:{arrayValue:{values:o.toArray().map(d=>{if(typeof d!="number")throw l.Sc("VectorValues must only contain numeric values.");return eg(l.serializer,d)})}}}}}}(r,i);throw i.Sc(`Unsupported field value: ${_d(r)}`)}(t,e)}function w1(t,e){const n={};return rT(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Zi(t,(r,i)=>{const s=Hl(i,e.mc(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function S1(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof gt||t instanceof Rr||t instanceof Xn||t instanceof Ut||t instanceof vg||t instanceof Dr)}function wg(t,e,n){if(!S1(n)||!tT(n)){const r=_d(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function xm(t,e,n){if((e=an(e))instanceof Dd)return e._internalPath;if(typeof e=="string")return Sg(t,e);throw Gu("Field path arguments must be of type string or ",t,!1,void 0,n)}const fD=new RegExp("[~\\*/\\[\\]]");function Sg(t,e,n){if(e.search(fD)>=0)throw Gu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Dd(...e.split("."))._internalPath}catch{throw Gu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Gu(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let a="";return(s||o)&&(a+=" (found",s&&(a+=` in field ${r}`),o&&(a+=` in document ${i}`),a+=")"),new me(ee.INVALID_ARGUMENT,l+t+a)}function E1(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eg{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Ut(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new mD(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Md("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class mD extends Eg{data(){return super.data()}}function Md(t,e){return typeof e=="string"?Sg(t,e):e instanceof Dd?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pD(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new me(ee.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Tg{}class Wl extends Tg{}function Qu(t,e,...n){let r=[];e instanceof Tg&&r.push(e),r=r.concat(n),function(s){const o=s.filter(a=>a instanceof Ig).length,l=s.filter(a=>a instanceof Od).length;if(o>1||o>0&&l>0)throw new me(ee.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class Od extends Wl{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Od(e,n,r)}_apply(e){const n=this._parse(e);return b1(e._query,n),new Or(e.firestore,e.converter,gm(e._query,n))}_parse(e){const n=zl(e.firestore);return function(s,o,l,a,d,h,f){let m;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new me(ee.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){iw(f,h);const S=[];for(const _ of f)S.push(rw(a,s,_));m={arrayValue:{values:S}}}else m=rw(a,s,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||iw(f,h),m=_1(l,o,f,h==="in"||h==="not-in");return Ht.create(d,h,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Cm(t,e,n){const r=e,i=Md("where",t);return Od._create(i,r,n)}class Ig extends Tg{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Ig(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:hr.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const l=s.getFlattenedFilters();for(const a of l)b1(o,a),o=gm(o,a)}(e._query,n),new Or(e.firestore,e.converter,gm(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class bg extends Wl{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new bg(e,n)}_apply(e){const n=function(i,s,o){if(i.startAt!==null)throw new me(ee.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new me(ee.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Il(s,o)}(e._query,this._field,this._direction);return new Or(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new es(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}function T1(t,e="asc"){const n=e,r=Md("orderBy",t);return bg._create(r,n)}class xg extends Wl{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new xg(e,n,r)}_apply(e){return new Or(e.firestore,e.converter,Uu(e._query,this._limit,this._limitType))}}function gD(t){return _P("limit",t),xg._create("limit",t,"F")}class Cg extends Wl{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Cg(e,n,r)}_apply(e){const n=I1(e,this.type,this._docOrFields,this._inclusive);return new Or(e.firestore,e.converter,function(i,s){return new es(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}}function yD(...t){return Cg._create("startAt",t,!0)}class Ag extends Wl{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Ag(e,n,r)}_apply(e){const n=I1(e,this.type,this._docOrFields,this._inclusive);return new Or(e.firestore,e.converter,function(i,s){return new es(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}}function vD(...t){return Ag._create("endAt",t,!0)}function I1(t,e,n,r){if(n[0]=an(n[0]),n[0]instanceof Eg)return function(s,o,l,a,d){if(!a)throw new me(ee.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${l}().`);const h=[];for(const f of xo(s))if(f.field.isKeyField())h.push(Fu(o,a.key));else{const m=a.data.field(f.field);if(Ed(m))throw new me(ee.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(m===null){const g=f.field.canonicalString();throw new me(ee.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${g}' (used as the orderBy) does not exist.`)}h.push(m)}return new $o(h,d)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const i=zl(t.firestore);return function(o,l,a,d,h,f){const m=o.explicitOrderBy;if(h.length>m.length)throw new me(ee.INVALID_ARGUMENT,`Too many arguments provided to ${d}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const g=[];for(let S=0;S<h.length;S++){const _=h[S];if(m[S].field.isKeyField()){if(typeof _!="string")throw new me(ee.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${d}(), but got a ${typeof _}`);if(!Zp(o)&&_.indexOf("/")!==-1)throw new me(ee.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${d}() must be a plain document ID, but '${_}' contains a slash.`);const A=o.path.child(ct.fromString(_));if(!Ee.isDocumentKey(A))throw new me(ee.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${d}() must result in a valid document path, but '${A}' is not because it contains an odd number of segments.`);const v=new Ee(A);g.push(Fu(l,v))}else{const A=_1(a,d,_);g.push(A)}}return new $o(g,f)}(t._query,t.firestore._databaseId,i,e,n,r)}}function rw(t,e,n){if(typeof(n=an(n))=="string"){if(n==="")throw new me(ee.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Zp(e)&&n.indexOf("/")!==-1)throw new me(ee.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(ct.fromString(n));if(!Ee.isDocumentKey(r))throw new me(ee.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Fu(t,new Ee(r))}if(n instanceof Ut)return Fu(t,n._key);throw new me(ee.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${_d(n)}.`)}function iw(t,e){if(!Array.isArray(t)||t.length===0)throw new me(ee.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function b1(t,e){const n=function(i,s){for(const o of i)for(const l of o.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new me(ee.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new me(ee.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class _D{convertValue(e,n="none"){switch(qi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Vt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Wi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Ce(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Zi(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var r,i,s;const n=(s=(i=(r=e.fields)==null?void 0:r[Vu].arrayValue)==null?void 0:i.values)==null?void 0:s.map(o=>Vt(o.doubleValue));return new Dr(n)}convertGeoPoint(e){return new Rr(Vt(e.latitude),Vt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Td(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Sl(e));default:return null}}convertTimestamp(e){const n=Hi(e);return new gt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=ct.fromString(e);nt(UT(r),9688,{name:e});const i=new El(r.get(1),r.get(3)),s=new Ee(r.popFirst(5));return i.isEqual(n)||Xr(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x1(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class Da{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ts extends Eg{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new nu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Md("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new me(ee.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Ts._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Ts._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ts._jsonSchema={type:Wt("string",Ts._jsonSchemaVersion),bundleSource:Wt("string","DocumentSnapshot"),bundleName:Wt("string"),bundle:Wt("string")};class nu extends Ts{data(e={}){return super.data(e)}}class Ao{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Da(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new nu(this._firestore,this._userDataWriter,r.key,r,new Da(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new me(ee.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(l=>{const a=new nu(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Da(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:a,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const a=new nu(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Da(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,h=-1;return l.type!==0&&(d=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),h=o.indexOf(l.doc.key)),{type:wD(l.type),doc:a,oldIndex:d,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new me(ee.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ao._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Gp.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(n.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function wD(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ce(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C1(t){t=jr(t,Ut);const e=jr(t.firestore,ta);return nD(yg(e),t._key).then(n=>ID(e,t,n))}Ao._jsonSchemaVersion="firestore/querySnapshot/1.0",Ao._jsonSchema={type:Wt("string",Ao._jsonSchemaVersion),bundleSource:Wt("string","QuerySnapshot"),bundleName:Wt("string"),bundle:Wt("string")};class A1 extends _D{constructor(e){super(),this.firestore=e}convertBytes(e){return new Xn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ut(this.firestore,null,n)}}function ru(t){t=jr(t,Or);const e=jr(t.firestore,ta),n=yg(e),r=new A1(e);return pD(t._query),rD(n,t._query).then(i=>new Ao(e,r,t,i))}function SD(t,e,n){t=jr(t,Ut);const r=jr(t.firestore,ta),i=x1(t.converter,e,n);return Ng(r,[v1(zl(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,cr.none())])}function ED(t,e,n,...r){t=jr(t,Ut);const i=jr(t.firestore,ta),s=zl(i);let o;return o=typeof(e=an(e))=="string"||e instanceof Dd?hD(s,"updateDoc",t._key,e,n,r):dD(s,"updateDoc",t._key,e),Ng(i,[o.toMutation(t._key,cr.exists(!0))])}function TD(t,e){const n=jr(t.firestore,ta),r=p1(t),i=x1(t.converter,e);return Ng(n,[v1(zl(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,cr.exists(!1))]).then(()=>r)}function Ng(t,e){return function(r,i){const s=new Wr;return r.asyncQueue.enqueueAndForget(async()=>H2(await tD(r),i,s)),s.promise}(yg(t),e)}function ID(t,e,n){const r=n.docs.get(e._key),i=new A1(t);return new Ts(t,i,e._key,r,new Da(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(i){Xo=i})(Ol),ks(new $i("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),l=new ta(new uP(r.getProvider("auth-internal")),new fP(o,r.getProvider("app-check-internal")),function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new me(ee.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new El(d.options.projectId,h)}(o,i),o);return s={useFetchStreams:n,...s},l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),Nr(l_,c_,e),Nr(l_,c_,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N1="firebasestorage.googleapis.com",k1="storageBucket",bD=2*60*1e3,xD=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ot extends ri{constructor(e,n,r=0){super(Uh(e),`Firebase Storage: ${n} (${Uh(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ot.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Uh(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Mt;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Mt||(Mt={}));function Uh(t){return"storage/"+t}function kg(){const t="An unknown error occurred, please check the error payload for server response.";return new Ot(Mt.UNKNOWN,t)}function CD(t){return new Ot(Mt.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function AD(t){return new Ot(Mt.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function ND(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Ot(Mt.UNAUTHENTICATED,t)}function kD(){return new Ot(Mt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function PD(t){return new Ot(Mt.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function RD(){return new Ot(Mt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function DD(){return new Ot(Mt.CANCELED,"User canceled the upload/download.")}function jD(t){return new Ot(Mt.INVALID_URL,"Invalid URL '"+t+"'.")}function MD(t){return new Ot(Mt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function OD(){return new Ot(Mt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+k1+"' property when initializing the app?")}function LD(){return new Ot(Mt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function VD(){return new Ot(Mt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function FD(t){return new Ot(Mt.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Am(t){return new Ot(Mt.INVALID_ARGUMENT,t)}function P1(){return new Ot(Mt.APP_DELETED,"The Firebase app was deleted.")}function UD(t){return new Ot(Mt.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Ya(t,e){return new Ot(Mt.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Sa(t){throw new Ot(Mt.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=zn.makeFromUrl(e,n)}catch{return new zn(e,"")}if(r.path==="")return r;throw MD(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(j){j.path.charAt(j.path.length-1)==="/"&&(j.path_=j.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+i+o,"i"),a={bucket:1,path:3};function d(j){j.path_=decodeURIComponent(j.path)}const h="v[A-Za-z0-9_]+",f=n.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",g=new RegExp(`^https?://${f}/${h}/b/${i}/o${m}`,"i"),S={bucket:1,path:3},_=n===N1?"(?:storage.googleapis.com|storage.cloud.google.com)":n,A="([^?#]*)",v=new RegExp(`^https?://${_}/${i}/${A}`,"i"),b=[{regex:l,indices:a,postModify:s},{regex:g,indices:S,postModify:d},{regex:v,indices:{bucket:1,path:2},postModify:d}];for(let j=0;j<b.length;j++){const M=b[j],U=M.regex.exec(e);if(U){const x=U[M.indices.bucket];let I=U[M.indices.path];I||(I=""),r=new zn(x,I),M.postModify(r);break}}if(r==null)throw jD(e);return r}}class BD{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $D(t,e,n){let r=1,i=null,s=null,o=!1,l=0;function a(){return l===2}let d=!1;function h(...A){d||(d=!0,e.apply(null,A))}function f(A){i=setTimeout(()=>{i=null,t(g,a())},A)}function m(){s&&clearTimeout(s)}function g(A,...v){if(d){m();return}if(A){m(),h.call(null,A,...v);return}if(a()||o){m(),h.call(null,A,...v);return}r<64&&(r*=2);let b;l===1?(l=2,b=0):b=(r+Math.random())*1e3,f(b)}let S=!1;function _(A){S||(S=!0,m(),!d&&(i!==null?(A||(l=2),clearTimeout(i),f(0)):A||(l=1)))}return f(0),s=setTimeout(()=>{o=!0,_(!0)},n),_}function zD(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HD(t){return t!==void 0}function WD(t){return typeof t=="object"&&!Array.isArray(t)}function Pg(t){return typeof t=="string"||t instanceof String}function sw(t){return Rg()&&t instanceof Blob}function Rg(){return typeof Blob<"u"}function ow(t,e,n,r){if(r<e)throw Am(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw Am(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dg(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function R1(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var Is;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Is||(Is={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qD(t,e){const n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||i||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GD{constructor(e,n,r,i,s,o,l,a,d,h,f,m=!0,g=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=a,this.timeout_=d,this.progressCallback_=h,this.connectionFactory_=f,this.retry=m,this.isUsingEmulator=g,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((S,_)=>{this.resolve_=S,this.reject_=_,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new xc(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=l=>{const a=l.loaded,d=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(a,d)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const l=s.getErrorCode()===Is.NO_ERROR,a=s.getStatus();if(!l||qD(a,this.additionalRetryCodes_)&&this.retry){const h=s.getErrorCode()===Is.ABORT;r(!1,new xc(!1,null,h));return}const d=this.successCodes_.indexOf(a)!==-1;r(!0,new xc(d,s))})},n=(r,i)=>{const s=this.resolve_,o=this.reject_,l=i.connection;if(i.wasSuccessCode)try{const a=this.callback_(l,l.getResponse());HD(a)?s(a):s()}catch(a){o(a)}else if(l!==null){const a=kg();a.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,a)):o(a)}else if(i.canceled){const a=this.appDelete_?P1():DD();o(a)}else{const a=RD();o(a)}};this.canceled_?n(!1,new xc(!1,null,!0)):this.backoffId_=$D(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&zD(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class xc{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function QD(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function KD(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function YD(t,e){e&&(t["X-Firebase-GMPID"]=e)}function XD(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function JD(t,e,n,r,i,s,o=!0,l=!1){const a=R1(t.urlParams),d=t.url+a,h=Object.assign({},t.headers);return YD(h,e),QD(h,n),KD(h,s),XD(h,r),new GD(d,t.method,h,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o,l)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZD(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function ej(...t){const e=ZD();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(Rg())return new Blob(t);throw new Ot(Mt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function tj(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nj(t){if(typeof atob>"u")throw FD("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Bh{constructor(e,n){this.data=e,this.contentType=n||null}}function rj(t,e){switch(t){case xr.RAW:return new Bh(D1(e));case xr.BASE64:case xr.BASE64URL:return new Bh(j1(t,e));case xr.DATA_URL:return new Bh(sj(e),oj(e))}throw kg()}function D1(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const s=r,o=t.charCodeAt(++n);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function ij(t){let e;try{e=decodeURIComponent(t)}catch{throw Ya(xr.DATA_URL,"Malformed data URL.")}return D1(e)}function j1(t,e){switch(t){case xr.BASE64:{const i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw Ya(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case xr.BASE64URL:{const i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw Ya(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=nj(e)}catch(i){throw i.message.includes("polyfill")?i:Ya(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}class M1{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Ya(xr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=aj(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function sj(t){const e=new M1(t);return e.base64?j1(xr.BASE64,e.rest):ij(e.rest)}function oj(t){return new M1(t).contentType}function aj(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i{constructor(e,n){let r=0,i="";sw(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,n){if(sw(this.data_)){const r=this.data_,i=tj(r,e,n);return i===null?null:new _i(i)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new _i(r,!0)}}static getBlob(...e){if(Rg()){const n=e.map(r=>r instanceof _i?r.data_:r);return new _i(ej.apply(null,n))}else{const n=e.map(o=>Pg(o)?rj(xr.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const i=new Uint8Array(r);let s=0;return n.forEach(o=>{for(let l=0;l<o.length;l++)i[s++]=o[l]}),new _i(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O1(t){let e;try{e=JSON.parse(t)}catch{return null}return WD(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lj(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function cj(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function L1(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uj(t,e){return e}class Tn{constructor(e,n,r,i){this.server=e,this.local=n||e,this.writable=!!r,this.xform=i||uj}}let Cc=null;function dj(t){return!Pg(t)||t.length<2?t:L1(t)}function V1(){if(Cc)return Cc;const t=[];t.push(new Tn("bucket")),t.push(new Tn("generation")),t.push(new Tn("metageneration")),t.push(new Tn("name","fullPath",!0));function e(s,o){return dj(o)}const n=new Tn("name");n.xform=e,t.push(n);function r(s,o){return o!==void 0?Number(o):o}const i=new Tn("size");return i.xform=r,t.push(i),t.push(new Tn("timeCreated")),t.push(new Tn("updated")),t.push(new Tn("md5Hash",null,!0)),t.push(new Tn("cacheControl",null,!0)),t.push(new Tn("contentDisposition",null,!0)),t.push(new Tn("contentEncoding",null,!0)),t.push(new Tn("contentLanguage",null,!0)),t.push(new Tn("contentType",null,!0)),t.push(new Tn("metadata","customMetadata",!0)),Cc=t,Cc}function hj(t,e){function n(){const r=t.bucket,i=t.fullPath,s=new zn(r,i);return e._makeStorageReference(s)}Object.defineProperty(t,"ref",{get:n})}function fj(t,e,n){const r={};r.type="file";const i=n.length;for(let s=0;s<i;s++){const o=n[s];r[o.local]=o.xform(r,e[o.server])}return hj(r,t),r}function F1(t,e,n){const r=O1(e);return r===null?null:fj(t,r,n)}function mj(t,e,n,r){const i=O1(e);if(i===null||!Pg(i.downloadTokens))return null;const s=i.downloadTokens;if(s.length===0)return null;const o=encodeURIComponent;return s.split(",").map(d=>{const h=t.bucket,f=t.fullPath,m="/b/"+o(h)+"/o/"+o(f),g=Dg(m,n,r),S=R1({alt:"media",token:d});return g+S})[0]}function pj(t,e){const n={},r=e.length;for(let i=0;i<r;i++){const s=e[i];s.writable&&(n[s.server]=t[s.local])}return JSON.stringify(n)}class U1{constructor(e,n,r,i){this.url=e,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B1(t){if(!t)throw kg()}function gj(t,e){function n(r,i){const s=F1(t,i,e);return B1(s!==null),s}return n}function yj(t,e){function n(r,i){const s=F1(t,i,e);return B1(s!==null),mj(s,i,t.host,t._protocol)}return n}function $1(t){function e(n,r){let i;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?i=kD():i=ND():n.getStatus()===402?i=AD(t.bucket):n.getStatus()===403?i=PD(t.path):i=r,i.status=n.getStatus(),i.serverResponse=r.serverResponse,i}return e}function vj(t){const e=$1(t);function n(r,i){let s=e(r,i);return r.getStatus()===404&&(s=CD(t.path)),s.serverResponse=i.serverResponse,s}return n}function _j(t,e,n){const r=e.fullServerUrl(),i=Dg(r,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,l=new U1(i,s,yj(t,n),o);return l.errorHandler=vj(e),l}function wj(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function Sj(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=wj(null,e)),r}function Ej(t,e,n,r,i){const s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function l(){let b="";for(let j=0;j<2;j++)b=b+Math.random().toString().slice(2);return b}const a=l();o["Content-Type"]="multipart/related; boundary="+a;const d=Sj(e,r,i),h=pj(d,n),f="--"+a+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+a+`\r
Content-Type: `+d.contentType+`\r
\r
`,m=`\r
--`+a+"--",g=_i.getBlob(f,r,m);if(g===null)throw LD();const S={name:d.fullPath},_=Dg(s,t.host,t._protocol),A="POST",v=t.maxUploadRetryTime,w=new U1(_,A,gj(t,n),v);return w.urlParams=S,w.headers=o,w.body=g.uploadData(),w.errorHandler=$1(e),w}class Tj{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Is.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Is.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Is.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,i,s){if(this.sent_)throw Sa("cannot .send() more than once");if(Bs(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),s!==void 0)for(const o in s)s.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,s[o].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Sa("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Sa("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Sa("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Sa("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class Ij extends Tj{initXhr(){this.xhr_.responseType="text"}}function z1(){return new Ij}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds{constructor(e,n){this._service=e,n instanceof zn?this._location=n:this._location=zn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Ds(e,n)}get root(){const e=new zn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return L1(this._location.path)}get storage(){return this._service}get parent(){const e=lj(this._location.path);if(e===null)return null;const n=new zn(this._location.bucket,e);return new Ds(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw UD(e)}}function bj(t,e,n){t._throwIfRoot("uploadBytes");const r=Ej(t.storage,t._location,V1(),new _i(e,!0),n);return t.storage.makeRequestWithTokens(r,z1).then(i=>({metadata:i,ref:t}))}function xj(t){t._throwIfRoot("getDownloadURL");const e=_j(t.storage,t._location,V1());return t.storage.makeRequestWithTokens(e,z1).then(n=>{if(n===null)throw VD();return n})}function Cj(t,e){const n=cj(t._location.path,e),r=new zn(t._location.bucket,n);return new Ds(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Aj(t){return/^[A-Za-z]+:\/\//.test(t)}function Nj(t,e){return new Ds(t,e)}function H1(t,e){if(t instanceof jg){const n=t;if(n._bucket==null)throw OD();const r=new Ds(n,n._bucket);return e!=null?H1(r,e):r}else return e!==void 0?Cj(t,e):t}function kj(t,e){if(e&&Aj(e)){if(t instanceof jg)return Nj(t,e);throw Am("To use ref(service, url), the first argument must be a Storage instance.")}else return H1(t,e)}function aw(t,e){const n=e==null?void 0:e[k1];return n==null?null:zn.makeFromBucketSpec(n,t)}function Pj(t,e,n,r={}){t.host=`${e}:${n}`;const i=Bs(e);i&&(TE(`https://${t.host}/b`),bE("Storage",!0)),t._isUsingEmulator=!0,t._protocol=i?"https":"http";const{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:IE(s,t.app.options.projectId))}class jg{constructor(e,n,r,i,s,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=N1,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=bD,this._maxUploadRetryTime=xD,this._requests=new Set,i!=null?this._bucket=zn.makeFromBucketSpec(i,this._host):this._bucket=aw(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=zn.makeFromBucketSpec(this._url,e):this._bucket=aw(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){ow("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){ow("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(vi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ds(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new BD(P1());{const o=JD(e,this._appId,r,i,n,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()}}const lw="@firebase/storage",cw="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W1="storage";function uw(t,e,n){return t=an(t),bj(t,e,n)}function Rj(t){return t=an(t),xj(t)}function Dj(t,e){return t=an(t),kj(t,e)}function jj(t=Hp(),e){t=an(t);const r=kE(t,W1).getImmediate({identifier:e}),i=SE("storage");return i&&Mj(r,...i),r}function Mj(t,e,n,r={}){Pj(t,e,n,r)}function Oj(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new jg(n,r,i,e,Ol)}function Lj(){ks(new $i(W1,Oj,"PUBLIC").setMultipleInstances(!0)),Nr(lw,cw,""),Nr(lw,cw,"esm2020")}Lj();const dw={apiKey:"AIzaSyBEFE5oeajyI6VXHG5T17xLue8eRQNRzzk",authDomain:"kusgan-6ca2f.firebaseapp.com",projectId:"kusgan-6ca2f",storageBucket:"kusgan-6ca2f.firebasestorage.app",appId:"1:653741419351:web:39de9b909a028bb89a6c12"};let ds,hw,Nm;function Mg(){if(!ds){if(Qv&&Qv().length)try{ds=Hp()}catch{}if(!ds){if(!dw.projectId)throw new Error("Missing Firebase config in VITE_FIREBASE_PROJECT_ID");ds=PE(dw)}hw=oD(ds);try{Nm=jj(ds)}catch{Nm=null}}return{app:ds,db:hw}}function Og(){return Mg().db}function Ld(t){return sD(Og(),t)}function Vd(t,e){return p1(Og(),t,String(e))}async function Vj(t,e={}){const n=Ld(t);if(e.where){const i=Qu(n,Cm(e.where.field,e.where.op||"==",e.where.value));return(await ru(i)).docs.map(o=>({id:o.id,...o.data()}))}if(e.orderBy){const i=Qu(n,T1(e.orderBy.field,e.orderBy.dir||"asc"));return(await ru(i)).docs.map(o=>({id:o.id,...o.data()}))}return(await ru(n)).docs.map(i=>({id:i.id,...i.data()}))}async function Fj(t,e={}){const n=Ld(t),r=[];if(Array.isArray(e.wheres))for(const o of e.wheres)r.push(Cm(o.field,o.op||"==",o.value));else e.where&&r.push(Cm(e.where.field,e.where.op||"==",e.where.value));e.orderBy&&r.push(T1(e.orderBy.field,e.orderBy.dir||"asc")),e.startAt!==void 0&&r.push(yD(e.startAt)),e.endAt!==void 0&&r.push(vD(e.endAt)),e.limit&&r.push(gD(Number(e.limit)));const i=r.length?Qu(n,...r):Qu(n);return(await ru(i)).docs.map(o=>({id:o.id,...o.data()}))}function q1(){return Mg(),Nm}async function Uj(t,e){const n=q1();if(!n)throw new Error("Firebase Storage not initialized or not configured");const r=Dj(n,t);if(typeof e=="string"){const i=e.replace(/^data:.*;base64,/,""),s=atob(i),o=new Uint8Array(s.length);for(let l=0;l<s.length;l++)o[l]=s.charCodeAt(l);await uw(r,o)}else await uw(r,e);return await Rj(r)}async function Bj(t,e){const n=Vd(t,e),r=await C1(n);return r.exists()?{id:r.id,...r.data()}:null}async function $j(t,e){const n=Ld(t);return{id:(await TD(n,e)).id,...e}}async function zj(t,e,n){const r=Vd(t,e);return await SD(r,n,{merge:!0}),{id:e,...n}}async function Hj(t,e,n){const r=Vd(t,e);await ED(r,n);const i=await C1(r);return{id:i.id,...i.data()}}const Ae={ensureFirebase:Mg,getDB:Og,colRef:Ld,docRef:Vd,getCollection:Vj,queryCollection:Fj,getDocById:Bj,addDocument:$j,setDocument:zj,updateDocument:Hj,getStorageInstance:q1,uploadFile:Uj},Ku="authToken";function Wj(t){if(!t){try{localStorage.removeItem(Ku)}catch{}return}try{localStorage.setItem(Ku,t)}catch{}}function Xa(){try{return localStorage.getItem(Ku)}catch{return null}}function qj(){try{localStorage.removeItem(Ku)}catch{}}async function Gj(t,e={}){const n=Xa(),r=Object.assign({},e.headers||{});return n&&(r.Authorization=`Bearer ${n}`),await fetch(t,Object.assign({},e,{headers:r}))}const dt={setToken:Wj,getToken:Xa,clearToken:qj,fetchWithAuth:Gj};function Qj({setToken:t}){C.useEffect(()=>{},[]);const[e,n]=C.useState(""),[r,i]=C.useState(""),[s,o]=C.useState(""),[l,a]=C.useState(!1),d=Yo(),h=async f=>{if(f&&f.preventDefault(),o(""),!e||!r){o("Please enter username and password");return}a(!0);try{const m=await fetch("/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:r})});if(!m.ok){if(String(e).trim()==="frontdesk"&&String(r)==="Kusgan2025!"){const A=`local-token-${Date.now()}`;try{dt.setToken(A)}catch{}t(A);try{console.log("Login: used client-side fallback for frontdesk")}catch{}try{d("/")}catch{}a(!1);return}const _=await m.json().catch(()=>({}));o(_.error||"Invalid username or password"),a(!1);return}const g=await m.json();if(g&&g.ok&&g.token){try{dt.setToken(g.token)}catch{}t(g.token);try{d("/")}catch{}}else o("Login failed")}catch{if(String(e).trim()==="frontdesk"&&String(r)==="Kusgan2025!"){const S=`local-token-${Date.now()}`;try{dt.setToken(S)}catch{}t(S);try{console.log("Login: used client-side fallback for frontdesk (network error)")}catch{}try{d("/")}catch{}a(!1);return}o("Server error  please try again")}finally{a(!1)}};return u.jsx("div",{style:{minHeight:"100vh",width:"100%",margin:0,display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, rgba(255,182,213,0.94), rgba(180,196,255,0.92))",backgroundRepeat:"no-repeat",backgroundSize:"cover"},children:u.jsxs("div",{style:{width:420,minHeight:520,padding:"56px 48px",borderRadius:28,background:"#11121d",boxShadow:"0 36px 70px rgba(0,0,0,0.40)",display:"flex",flexDirection:"column",alignItems:"center",color:"#fff",textAlign:"center"},children:[u.jsx("img",{src:"/kusgan-logo.png",alt:"Kusgan Logo",style:{width:160,height:160,objectFit:"cover",borderRadius:"22px",boxShadow:"0 10px 28px rgba(215,38,96,0.35)",marginBottom:24,background:"#000"}}),u.jsx("h1",{style:{fontSize:"1.6rem",fontWeight:700,margin:"0 0 8px"},children:"Kusgan Fitness Gym"}),u.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:"column",gap:8},children:[u.jsx("div",{style:{fontSize:13,color:"#c9c9da",fontWeight:600,marginBottom:4,textAlign:"left"}}),u.jsxs("form",{onSubmit:h,style:{width:"100%",display:"flex",flexDirection:"column",gap:8},children:[u.jsx("label",{style:{fontSize:12,color:"#c9c9da",textAlign:"left"},children:"Username"}),u.jsx("input",{type:"text",value:e,onChange:f=>n(f.target.value),placeholder:"Enter staff username",style:{padding:10,fontSize:16,borderRadius:6,border:"1px solid #2a2a36",background:"#0f1114",color:"#fff"}}),u.jsx("label",{style:{fontSize:12,color:"#c9c9da",textAlign:"left"},children:"Password"}),u.jsx("input",{type:"password",value:r,onChange:f=>i(f.target.value),placeholder:"Enter staff password",style:{padding:10,fontSize:16,borderRadius:6,border:"1px solid #2a2a36",background:"#0f1114",color:"#fff"}}),s&&u.jsx("div",{style:{color:"#f44336",fontSize:13},children:s}),u.jsx("button",{type:"submit",disabled:l,style:{marginTop:6,padding:"14px 12px",borderRadius:6,background:"#1976d2",color:"#fff",border:"none",cursor:l?"default":"pointer",opacity:l?.8:1,fontSize:18,fontWeight:700},children:l?"Signing in":"Sign in"})]}),u.jsxs("div",{style:{marginTop:18,width:"100%",textAlign:"center"},children:[u.jsx("div",{style:{fontSize:13,color:"#c9c9da",fontWeight:600,marginBottom:8},children:"Sign in as Member"}),u.jsx("div",{style:{display:"flex",justifyContent:"center"},children:u.jsxs("button",{disabled:!0,style:{borderRadius:8,padding:"8px 12px",background:"#fff",color:"#888",cursor:"not-allowed",border:"1px solid #ddd",display:"inline-flex",alignItems:"center",gap:10},"aria-disabled":!0,children:[u.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,focusable:"false",children:[u.jsx("path",{fill:"#4285F4",d:"M24 9.5c3.9 0 7.2 1.4 9.6 3.7l7-7C36.4 2.4 30.6 0 24 0 14.8 0 6.9 5.5 3 13.4l8 6.2C13.5 13 18 9.5 24 9.5z"}),u.jsx("path",{fill:"#34A853",d:"M46.5 24c0-1.4-.1-2.7-.4-4H24v8h12.7c-.5 2.8-2 5.1-4.3 6.7l6.7 5.2C43.9 36.5 46.5 30.6 46.5 24z"}),u.jsx("path",{fill:"#FBBC05",d:"M11 29.6c-1.2-3.5-1.2-7.3 0-10.8L3 12.6C1.1 15.9 0 19.8 0 24s1.1 8.1 3 11.4l8-6.2z"}),u.jsx("path",{fill:"#EA4335",d:"M24 48c6.6 0 12.4-2.4 16.9-6.5l-6.7-5.2c-2.3 1.5-5 2.4-10.2 2.4-6 0-10.5-3.5-12.4-8.6l-8 6.2C6.9 42.5 14.8 48 24 48z"})]}),u.jsx("span",{style:{fontWeight:700,color:"#6b6b6b"},children:"Sign in with Google"})]})}),u.jsx("div",{style:{marginTop:8,color:"#8b8b9b",fontSize:13},children:"Member login via Google is not yet enabled."})]})]})]})})}function fw(){var s,o,l,a;const t=new Intl.DateTimeFormat("en-US",{timeZone:"Asia/Manila",weekday:"long",month:"short",day:"2-digit",year:"numeric"}).formatToParts(new Date),e=(((s=t.find(d=>d.type==="weekday"))==null?void 0:s.value)||"").toUpperCase(),n=((o=t.find(d=>d.type==="month"))==null?void 0:o.value)||"Jan",r=parseInt(((l=t.find(d=>d.type==="day"))==null?void 0:l.value)||"01",10),i=((a=t.find(d=>d.type==="year"))==null?void 0:a.value)||"0000";return{weekday:e,text:`${n}-${r}, ${i}`}}function Kj({onLogout:t=()=>{}}){const[e,n]=C.useState(fw()),[r,i]=C.useState(!1);return C.useEffect(()=>{const s=()=>n(fw()),o=setInterval(s,6e4);return s(),()=>clearInterval(o)},[]),C.useEffect(()=>{let s=!0;return(async()=>{var o;try{const l=await dt.fetchWithAuth("/auth/me");if(!s)return;if(!l.ok)return i(!1);const a=await l.json().catch(()=>({}));i(((o=a==null?void 0:a.user)==null?void 0:o.role)==="admin")}catch{i(!1)}})(),()=>{s=!1}},[]),u.jsxs("aside",{className:"sidebar",children:[u.jsx("div",{className:"brand",children:u.jsx("img",{src:"/kusgan-logo.png",alt:"Kusgan logo",className:"brand-logo",style:{width:350,height:"auto"}})}),u.jsx("div",{className:"sidebar-info",children:u.jsxs("div",{className:"date",children:[u.jsx("div",{style:{fontSize:"14px",fontStyle:"italic",color:"#e9e9ee",marginBottom:"5px"},children:"Today is"}),u.jsxs("div",{style:{fontWeight:"600",fontSize:"20px",color:"#e9e9ee",marginBottom:"25px"},children:[e.weekday," ",e.text]})]})}),u.jsxs("nav",{className:"nav",children:[u.jsx(wa,{to:"/",end:!0,children:" Dashboard"}),u.jsx(wa,{to:"/attendance",children:" Staff Attendance"}),u.jsx(wa,{to:"/members",children:" All Members"}),u.jsx(wa,{to:"/checkin",children:" Member Check-In"}),r&&u.jsx(wa,{to:"/admin",children:" Admin"})]}),u.jsx("div",{className:"sidebar-footer",children:u.jsx("button",{className:"button logout-btn",onClick:t,children:"Logout"})})]})}const xe={members:"members",gymEntries:"gymEntries",payments:"payments",progress:"progress",attendance:"attendance",pricing:"pricing"};function G1(t){if(!t)return null;const e=String(t).trim().toLowerCase();return e==="members"?xe.members:e==="gymentries"||e==="gymentries"||e==="gymentries"?xe.gymEntries:e==="payments"?xe.payments:e==="progresstracker"||e==="progress"?xe.progress:e==="attendance"?xe.attendance:e==="pricing"?xe.pricing:e}function Q1(t){if(!t)return null;const e={...t};return e.memberid=String(t.memberId||t.MemberID||t.id||t.memberid||"").trim(),e.firstname=t.firstName||t.firstname||t.FirstName||"",e.lastname=t.lastName||t.lastname||t.LastName||"",e._raw=t,e}async function Fd(){return{rows:(await Ae.getCollection(xe.members)).map(e=>({...e}))}}async function K1(){return Fd()}async function Lg(t){try{if(typeof fetch=="function"){const n=await fetch("/api/members/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(n&&n.status===201)try{return await n.json()}catch{}if(n&&n.status===409)try{return await n.json()}catch{return{ok:!1,error:"Nickname already taken"}}}}catch{}try{const n=String(t.NickName||t.nickName||t.nickname||"").trim();if(n){const r=[];try{const i=await Ae.queryCollection(xe.members,{wheres:[{field:"NickName",op:"==",value:n}]});r.push(...i||[])}catch{}try{const i=await Ae.queryCollection(xe.members,{wheres:[{field:"nickname",op:"==",value:n}]});r.push(...i||[])}catch{}if(r.length>0&&r.some(s=>String(s.NickName||s.nickname||s.nick_name||s.nickName||"").trim().toLowerCase()===n.toLowerCase()))return{ok:!1,error:"Nickname already taken"}}}catch{}const e=await Ae.addDocument(xe.members,t);return{ok:!0,id:e.id,row:e}}async function Y1(t){return Lg(t)}async function X1(t){const e=String(t.MemberID||t.memberId||t.id||t.memberid||"").trim();if(!e)throw new Error("MemberID required for update");try{return await Ae.setDocument(xe.members,e,t),{ok:!0}}catch(n){try{const r=await fetch(`/api/members/${encodeURIComponent(e)}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(r&&r.ok)try{return await r.json()}catch{return{ok:!0}}throw n}catch(r){throw r||n}}}async function Vg(t){if(!t)return null;const e=await Ae.getDocById(xe.members,String(t));return e?Q1(e):null}async function J1(t){return Vg(t)}async function Z1(t){if(!t)throw new Error("memberId required");const[e,n,r,i]=await Promise.all([Fd(),Ae.getCollection(xe.payments),Ae.getCollection(xe.gymEntries),Ae.getCollection(xe.progress)]),s=String(t).trim(),o=(e.rows||[]).find(h=>String(h.MemberID||h.memberId||h.id||h.memberid||"").trim()===s)||null;Q1(o);const l=(n||[]).filter(h=>String(h.MemberID||h.memberId||h.id||h.memberid||"").trim()===s),a=(r||[]).filter(h=>String(h.MemberID||h.memberId||h.id||h.memberid||"").trim()===s),d=(i||[]).filter(h=>String(h.MemberID||h.memberId||h.id||h.memberid||"").trim()===s);return{member:o,payments:l,gymEntries:a,progress:d}}async function Fg(){return{rows:await Ae.getCollection(xe.gymEntries)}}async function eI(){return Fg()}async function js(t){return{ok:!0,id:(await Ae.addDocument(xe.gymEntries,t)).id}}async function tI(t,e={}){if(!t)throw new Error("memberId required");const n=new Date().toISOString(),r=n.slice(0,10),i=!!e.wantsOut,s={...e};if(!i)return!s.TimeIn&&!s.timeIn&&(s.TimeIn=n),!s.Date&&!s.date&&(s.Date=r),s.MemberID=t,await js(s);const o=await Ae.getCollection(xe.gymEntries),l=f=>{try{if(String(f.MemberID||f.memberId||f.memberid||"").trim()!==String(t).trim())return!1;if(s.TimeIn&&s.Date){const g=String(f.TimeIn||f.timeIn||""),S=String(f.Date||f.date||"");if(g&&S&&String(s.TimeIn)===String(g)&&String(s.Date)===String(S))return!0}return!1}catch{return!1}};let a=null;if(s.TimeIn&&s.Date&&(a=o.find(l)||null),!a){const f=new Date;f.setHours(0,0,0,0);const m=o.filter(g=>{try{if(String(g.MemberID||g.memberId||g.memberid||"").trim()!==String(t).trim())return!1;const _=new Date(g.Date||g.date||g.DateTime||g.timestamp||g.TimeIn||"");if(isNaN(_))return!1;_.setHours(0,0,0,0);const A=_.getTime()===f.getTime(),v=g.TimeOut||g.timeOut||g.Timeout||g.TimeOUT;return A&&(!v||String(v).trim()==="")}catch{return!1}}).sort((g,S)=>{const _=g.TimeIn||g.timeIn||"",A=S.TimeIn||S.timeIn||"";return String(A).localeCompare(String(_))});a=m.length?m[0]:null}const d=new Date().toISOString();if(!a){const f={MemberID:t,TimeOut:d,Date:s.Date||r};return s.Workouts&&(f.Workouts=s.Workouts),s.Comments&&(f.Comments=s.Comments),s.Coach&&(f.Coach=s.Coach),s.Focus&&(f.Focus=s.Focus),await js(f)}const h={TimeOut:d};s.Workouts&&(h.Workouts=s.Workouts),s.Comments&&(h.Comments=s.Comments),s.Coach&&(h.Coach=s.Coach),s.Focus&&(h.Focus=s.Focus);try{const f=a.TimeIn||a.timeIn||"";if(f){const m=new Date(f),g=new Date(d);if(!isNaN(m)&&!isNaN(g)&&g>m){const S=(g-m)/36e5;h.TotalHours=Math.round(S*100)/100}}}catch{}return await Ae.updateDocument(xe.gymEntries,a.id,h),{ok:!0,id:a.id}}async function Yj(t,e={}){if(!t)throw new Error("memberId is required");const n=await Ae.getCollection(xe.gymEntries),r=new Date;r.setHours(0,0,0,0);const i=n.find(a=>{try{const d=String(a.MemberID||a.memberId||a.memberid||a.id||"");if(!d||d.trim()!==String(t).trim())return!1;const h=new Date(a.Date||a.date||a.DateTime||a.timestamp||"");if(isNaN(h))return!1;h.setHours(0,0,0,0);const f=h.getTime()===r.getTime(),m=a.TimeOut||a.timeOut||a.Timeout||a.TimeOUT;return f&&(!m||String(m).trim()==="")}catch{return!1}});if(i)return{ok:!0,id:i.id,existed:!0};const s=new Date().toISOString(),o=s.slice(0,10);return await js({MemberID:t,TimeIn:s,Date:o,...e})}async function Xj(t,e={}){if(!t)throw new Error("memberId is required");const r=(await Ae.getCollection(xe.gymEntries)).filter(l=>String(l.MemberID||l.memberId||l.memberid||"").trim()===String(t).trim()&&!(l.TimeOut||l.timeOut||"").toString().trim()).sort((l,a)=>{const d=l.TimeIn||l.timeIn||"",h=a.TimeIn||a.timeIn||"";return String(d).localeCompare(String(h))});if(!r.length){const l=new Date().toISOString(),a=l.slice(0,10);return js({MemberID:t,TimeOut:l,Date:a,...e})}const i=r[r.length-1],s=new Date().toISOString(),o={TimeOut:s};e&&Object.assign(o,e);try{const l=i.TimeIn||i.timeIn||"";if(l){const a=new Date(l),d=new Date(s);if(!isNaN(a)&&!isNaN(d)&&d>a){const h=(d-a)/36e5;o.TotalHours=Math.round(h*100)/100}}}catch{}return await Ae.updateDocument(xe.gymEntries,i.id,o),{ok:!0,id:i.id}}async function Jj(t){if(!t)throw new Error("payload required");const e=t.MemberID||t.memberId||t.memberid||"";if(t.id)return await Ae.updateDocument(xe.gymEntries,String(t.id),t),{ok:!0};const r=(await Ae.getCollection(xe.gymEntries)).find(s=>{try{const o=String(s.MemberID||s.memberId||s.memberid||"").trim();if(!o||String(o)!==String(e).trim())return!1;const l=String(s.TimeIn||s.timeIn||""),a=String(t.TimeIn||t.timeIn||""),d=String(s.Date||s.date||""),h=String(t.Date||t.date||"");return!!(a&&l&&a===l&&h&&d&&h===d||t.rowNumber&&String(s.rowNumber||"")===String(t.rowNumber))}catch{return!1}});if(r){try{const s=t.TimeIn||t.timeIn||"",o=t.TimeOut||t.timeOut||"";if(s&&o&&(t.TotalHours===void 0||t.TotalHours===null||t.TotalHours==="")){const l=new Date(s),a=new Date(o);if(!isNaN(l)&&!isNaN(a)&&a>l){const d=(a-l)/36e5;t.TotalHours=Math.round(d*100)/100}}}catch{}return await Ae.updateDocument(xe.gymEntries,r.id,t),{ok:!0,id:r.id}}return await js(t)}async function nI(t){if(!t)throw new Error("payload required");if(t.id)return await Ae.updateDocument(xe.attendance,String(t.id),t),{ok:!0};const n=(await Ae.getCollection(xe.attendance)).find(i=>{try{const s=String(i.Staff||i.staff_name||i.staff||"").trim(),o=String(t.Staff||t.staff_name||t.staff||"").trim();if(!s||!o||String(s).toLowerCase()!==String(o).toLowerCase())return!1;const l=String(i.TimeIn||i.time_in||""),a=String(t.TimeIn||t.time_in||""),d=String(i.Date||i.date||""),h=String(t.Date||t.date||"");return!!(a&&l&&a===l&&h&&d&&h===d||t.rowNumber&&String(i.rowNumber||"")===String(t.rowNumber))}catch{return!1}})||null;if(n){try{const i=t.TimeIn||t.time_in||"",s=t.TimeOut||t.time_out||"";if(i&&s&&(t.NoOfHours===void 0||t.NoOfHours===null||t.NoOfHours==="")){const o=new Date(i),l=new Date(s);if(!isNaN(o)&&!isNaN(l)&&l>o){const a=(l-o)/36e5;t.NoOfHours=Math.round(a*100)/100}}}catch{}return await Ae.updateDocument(xe.attendance,n.id,t),{ok:!0,id:n.id}}return{ok:!0,id:(await Ae.addDocument(xe.attendance,t)).id}}async function rI(){return{rows:await Ae.getCollection(xe.progress)}}async function iI(t){if(!t)throw new Error("row required");try{return{ok:!0,id:(await Ae.addDocument(xe.progress,t)).id}}catch(e){try{if(typeof fetch=="function"){const n=await fetch("/api/progress",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(n&&n.ok)try{return await n.json()}catch{return{ok:!0}}}}catch{}throw e}}async function sI({limit:t=200,days:e=90}={}){const n=new Date(Date.now()-e*24*60*60*1e3);let r=[],i=[],s=[];try{[r,i,s]=await Promise.all([Ae.getCollection(xe.members),Ae.getCollection(xe.payments),Ae.getCollection(xe.gymEntries)])}catch{r=i=s=[]}if((!r||r.length===0)&&typeof fetch=="function")try{const[h,f,m]=await Promise.all([fetch("/api/members"),fetch("/api/payments"),fetch("/api/gymEntries")]);h&&h.ok&&(r=await h.json()),f&&f.ok&&(i=await f.json()),m&&m.ok&&(s=await m.json())}catch{}const o=(r||[]).map(h=>({...h})),l=new Set,a=h=>{if(!h)return null;const f=h instanceof Date?h:new Date(h);return isNaN(f)?null:f};for(const h of o){const f=a(h.memberDate||h.member_date||h.member_since||h.membersince||h.MemberSince||h.MemberSince||h.MemberDate||h.memberSince||h.createdAt||h.created_at||h.joined||h.start_date);f&&f>=n&&l.add(String(h.memberId||h.MemberID||h.memberId||h.id||h.memberid||h.member||"").trim())}for(const h of i||[]){const f=a(h.date||h.Date||h.createdAt||h.created_at||h.timestamp);if(f&&f>=n){const m=String(h.MemberID||h.memberId||h.memberid||h.id||"").trim();m&&l.add(m)}}for(const h of s||[]){const f=a(h.Date||h.date||h.DateTime||h.timestamp||h.timeIn||h.TimeIn);if(f&&f>=n){const m=String(h.MemberID||h.memberId||h.memberid||h.id||"").trim();m&&l.add(m)}}let d=[];return l.size>0?d=o.filter(h=>l.has(String(h.memberId||h.MemberID||h.id||h.memberid||"").trim())):d=[...o].sort((h,f)=>{const m=a(h.memberDate||h.createdAt||h.joined),g=a(f.memberDate||f.createdAt||f.joined);return!m&&!g?0:m?g?g-m:-1:1}),{rows:d.slice(0,Math.max(0,Number(t)||200))}}const $h=new Map,Zj=1e3*30;async function oI(t,{limit:e=200}={}){if(!t||!String(t).trim())return{rows:[]};const r=String(t).trim().toLowerCase(),i=`search:${r}`,s=$h.get(i);if(s&&Date.now()-s.ts<Zj)return{rows:s.rows.slice(0,e)};const o=r+"",l=["firstName","firstname","lastName","lastname","nickname","nick_name","nickName"],a=new Map;try{for(const h of l)try{const f=await Ae.queryCollection(xe.members,{orderBy:{field:h},startAt:r,endAt:o,limit:e});for(const m of f)a.set(m.id||String(m.MemberID||m.memberId||m.id||""),m)}catch{continue}if(a.size===0){const h=await Ae.getCollection(xe.members);for(const f of h)JSON.stringify(f).toLowerCase().indexOf(r)!==-1&&a.set(f.id||String(f.MemberID||f.memberId||f.id||""),f)}const d=Array.from(a.values()).slice(0,e).map(h=>({...h}));return $h.set(i,{rows:d,ts:Date.now()}),{rows:d}}catch{try{const f=(await Ae.getCollection(xe.members)||[]).filter(m=>JSON.stringify(m).toLowerCase().indexOf(r)!==-1).slice(0,e);return $h.set(i,{rows:f,ts:Date.now()}),{rows:f}}catch{return{rows:[]}}}}async function eM(t){const e=G1(t);return e?{rows:await Ae.getCollection(e)}:{rows:[]}}async function tM(t,e){const n=G1(t);if(!n)throw new Error("Unknown sheet: "+t);return{ok:!0,id:(await Ae.addDocument(n,e)).id}}async function aI(){return{rows:await Ae.getCollection(xe.payments)}}async function lI(t){return{ok:!0,id:(await Ae.addDocument(xe.payments,t)).id}}async function cI(t,e){const n=r=>new Promise((i,s)=>{try{const o=new FileReader;o.onload=()=>i(o.result),o.onerror=l=>s(l),o.readAsDataURL(r)}catch(o){s(o)}});try{if(t instanceof Blob||typeof File<"u"&&t instanceof File){const d=t,h=d&&d.name||`photo-${Date.now()}.jpg`,f=`members/${String(e||"unknown")}/${h}`;return await Ae.uploadFile(f,d)}const r=t||{},i=r.memberId||r.MemberID||e||"unknown",s=r.filename||`photo-${Date.now()}.jpg`,o=r.data||r.base64||"",l=`members/${String(i)}/${s}`;return await Ae.uploadFile(l,o)}catch(r){try{let i="",s=`photo-${Date.now()}.jpg`;if(t instanceof Blob||typeof File<"u"&&t instanceof File){const a=t;i=await n(a),s=a&&a.name||s}else{const a=t||{};i=a.data||a.base64||"",s=a.filename||s}if(!i)throw new Error("no data for fallback upload");const o=await fetch("/api/upload-photo",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filename:s,data:i})});if(!o.ok)throw new Error("proxy upload failed");const l=await o.json();if(l&&l.url)return l.url.indexOf("http")===0?l.url:`${location.origin}${l.url}`;throw new Error("invalid proxy response")}catch(i){throw new Error("uploadMemberPhoto failed: "+String((i==null?void 0:i.message)||r))}}}async function uI(t){return cI(t)}async function dI(){return{rows:await Ae.getCollection(xe.pricing)}}async function hI(t){const e=await Ae.addDocument(xe.pricing,t);return{ok:!0,id:e.id,row:e}}async function fI(t,e){const n=await Ae.updateDocument(xe.pricing,String(t),e);return{ok:!0,id:n.id,row:n}}async function mI(t){const e=await Ae.getCollection(xe.attendance);return t?{rows:e.filter(n=>String(n.Date||"").startsWith(String(t)))}:{rows:e}}async function pI(t){if(!t)throw new Error("staff required");const e=new Date().toISOString();return{ok:!0,id:(await Ae.addDocument(xe.attendance,{Staff:t,TimeIn:e,Date:e.slice(0,10)})).id}}async function gI(t){const n=(await Ae.getCollection(xe.attendance)).filter(i=>String(i.Staff)===String(t)&&(!i.TimeOut||i.TimeOut==="")).sort((i,s)=>(i.TimeIn||"").localeCompare(s.TimeIn||""));if(!n.length)return{ok:!1,error:"no open entry"};const r=n[n.length-1];return await Ae.updateDocument(xe.attendance,r.id,{TimeOut:new Date().toISOString()}),{ok:!0}}async function yI(t,e={}){if(!t)throw new Error("staff required");const n=new Date().toISOString(),r=n.slice(0,10);if(!!e.wantsOut){const o=await Ae.getCollection(xe.attendance);let l=null;const a=h=>{try{if(String(h.Staff||h.staff||h.staff_name||"").trim()!==String(t).trim())return!1;if(e.TimeIn&&e.Date){const m=String(h.TimeIn||h.time_in||""),g=String(h.Date||h.date||"");if(m&&g&&String(e.TimeIn)===String(m)&&String(e.Date)===String(g))return!0}return!1}catch{return!1}};if(e.TimeIn&&e.Date&&(l=o.find(a)||null),!l){const h=new Date;h.setHours(0,0,0,0);const f=o.filter(m=>{try{if(String(m.Staff||m.staff||m.staff_name||"").trim()!==String(t).trim())return!1;const S=new Date(m.Date||m.date||m.TimeIn||m.time_in||"");if(isNaN(S))return!1;S.setHours(0,0,0,0);const _=S.getTime()===h.getTime(),A=m.TimeOut||m.time_out||m.timeout||"";return _&&(!A||String(A).trim()==="")}catch{return!1}}).sort((m,g)=>{const S=m.TimeIn||m.time_in||"",_=g.TimeIn||g.time_in||"";return String(_).localeCompare(String(S))});l=f.length?f[0]:null}if(!l){const h={Staff:t,TimeOut:n,Date:e.Date||r};return e.Notes&&(h.Notes=e.Notes),{ok:!0,id:(await Ae.addDocument(xe.attendance,h)).id}}const d={TimeOut:n};e.Notes&&(d.Notes=e.Notes);try{const h=l.TimeIn||l.time_in||l.TimeInISO||l.timeIn||"";if(h){const f=new Date(h),m=new Date(n);if(!isNaN(f)&&!isNaN(m)&&m>f){const g=(m-f)/36e5;d.NoOfHours=Math.round(g*100)/100}}}catch{}return e.TotalHours&&(d.TotalHours=e.TotalHours),await Ae.updateDocument(xe.attendance,l.id,d),{ok:!0,id:l.id}}return{ok:!0,id:(await Ae.addDocument(xe.attendance,{Staff:t,TimeIn:n,Date:r,...e})).id}}async function vI(){return{rows:[]}}const nM={fetchMembers:Fd,fetchMembersFresh:K1,addMember:Lg,saveMember:Y1,updateMember:X1,fetchMemberById:Vg,fetchMemberByIdFresh:J1,fetchMemberBundle:Z1,fetchAttendance:mI,clockIn:pI,clockOut:gI,attendanceQuickAppend:yI,fetchGymEntries:Fg,fetchGymEntriesFresh:eI,addGymEntry:js,gymQuickAppend:tI,fetchProgressTracker:rI,addProgressRow:iI,fetchPricing:dI,fetchPayments:aI,addPayment:lI,fetchDashboard:vI,fetchMembersRecent:sI,searchMembersByName:oI,addPricing:hI,updatePricing:fI,uploadPhoto:uI,upsertAttendance:nI},rM=Object.freeze(Object.defineProperty({__proto__:null,addGymEntry:js,addMember:Lg,addPayment:lI,addPricing:hI,addProgressRow:iI,attendanceQuickAppend:yI,clockIn:pI,clockOut:gI,default:nM,fetchAttendance:mI,fetchDashboard:vI,fetchGymEntries:Fg,fetchGymEntriesFresh:eI,fetchMemberBundle:Z1,fetchMemberById:Vg,fetchMemberByIdFresh:J1,fetchMembers:Fd,fetchMembersFresh:K1,fetchMembersRecent:sI,fetchPayments:aI,fetchPricing:dI,fetchProgressTracker:rI,fetchSheet:eM,gymClockIn:Yj,gymClockOut:Xj,gymQuickAppend:tI,insertRow:tM,saveMember:Y1,searchMembersByName:oI,updateMember:X1,updatePricing:fI,uploadMemberPhoto:cI,uploadPhoto:uI,upsertAttendance:nI,upsertGymEntry:Jj},Symbol.toStringTag,{value:"Module"})),Re=rM,mw=C.createContext(!1);function ns({open:t,onClose:e,title:n,children:r,width:i=760,maxHeight:s="90vh",noWrapper:o=!1,noInternalScroll:l=!1}){if(!t)return null;const a=C.useContext(mw),h={width:"min(1000px, 96vw)",background:"#fff",borderRadius:14,padding:16,border:"1px solid var(--light-border)",boxShadow:"0 20px 60px rgba(0,0,0,.2)",maxHeight:s,overflowY:"auto",overflowX:"hidden",boxSizing:"border-box"};return a&&!o?u.jsx("div",{style:h,children:r}):u.jsx(mw.Provider,{value:!0,children:u.jsx("div",{onClick:f=>{f.target===f.currentTarget&&e&&e()},style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:o?(()=>{const f={width:`min(${i}px, 96vw)`,background:"#fff",borderRadius:14,padding:16,border:"1px solid var(--light-border)",boxShadow:"0 20px 60px rgba(0,0,0,.2)",maxHeight:"98vh",overflow:"visible",boxSizing:"border-box"};return u.jsxs("div",{style:f,onClick:m=>m.stopPropagation(),children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[n?u.jsx("div",{style:{fontWeight:800,fontSize:18},children:n}):u.jsx("div",{}),u.jsx("button",{type:"button",className:"button",onClick:e,style:{background:"#eee",color:"#333"},children:""})]}),r]})})():l?(()=>{const f={...h,maxHeight:"98vh",overflowY:"visible"};return u.jsxs("div",{style:f,onClick:m=>m.stopPropagation(),children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10},children:[n?u.jsx("div",{style:{fontWeight:800,fontSize:18},children:n}):u.jsx("div",{}),u.jsx("button",{type:"button",className:"button",onClick:e,style:{background:"#eee",color:"#333"},children:""})]}),r]})})():u.jsxs("div",{style:h,onClick:f=>f.stopPropagation(),children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10},children:[n?u.jsx("div",{style:{fontWeight:800,fontSize:18},children:n}):u.jsx("div",{}),u.jsx("button",{type:"button",className:"button",onClick:e,style:{background:"#eee",color:"#333"},children:""})]}),r]})})})}const No=new Map;function iM(t,e){return No.has(t)||No.set(t,new Set),No.get(t).add(e),()=>_I(t,e)}function _I(t,e){const n=No.get(t);n&&(n.delete(e),n.size||No.delete(t))}function sM(t,e){const n=No.get(t);if(n)for(const r of Array.from(n))try{r(e)}catch(i){console.error("event handler error",i)}}const sn={on:iM,off:_I,emit:sM},{addPayment:oM,fetchPricing:aM,fetchPayments:lM}=Re,ql="Asia/Manila",Ac=()=>new Intl.DateTimeFormat("en-CA",{timeZone:ql,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date),Ks=t=>{if(!t)return"";const e=t instanceof Date?t:new Date(t);return isNaN(e)?"":new Intl.DateTimeFormat("en-CA",{timeZone:ql,year:"numeric",month:"2-digit",day:"2-digit"}).format(e)},cM=()=>new Intl.DateTimeFormat("en-PH",{timeZone:ql,hour:"2-digit",minute:"2-digit",hour12:!1}).format(new Date).replace(/^(\d{2}):(\d{2}).*$/,"$1:$2"),Nc=t=>{var o,l,a;if(!t)return"-";let e;if(typeof t=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(t)){const[d,h,f]=t.split("-").map(Number);e=new Date(Date.UTC(d,h-1,f))}else e=t instanceof Date?t:new Date(t);if(isNaN(e))return"-";const n=new Intl.DateTimeFormat("en-US",{timeZone:ql,month:"short",day:"numeric",year:"numeric"}).formatToParts(e),r=((o=n.find(d=>d.type==="month"))==null?void 0:o.value)||"",i=((l=n.find(d=>d.type==="day"))==null?void 0:l.value)||"",s=((a=n.find(d=>d.type==="year"))==null?void 0:a.value)||"";return`${r}-${i}, ${s}`},Ea=(t,e)=>{if(!t||!e)return"";const[n,r,i]=t.split("-").map(Number),s=new Date(Date.UTC(n,r-1,i));return s.setUTCDate(s.getUTCDate()+Math.max(0,Number(e)-1)),new Intl.DateTimeFormat("en-CA",{timeZone:"UTC",year:"numeric",month:"2-digit",day:"2-digit"}).format(s)},pw=t=>{const e=String(t??"").trim().toLowerCase();return e==="yes"||e==="y"||e==="true"||e==="1"},Ta=t=>{if(!t)return{gym:!1,coach:!1};const e=Object.entries(t||{}),n=s=>{for(const[o,l]of e){const a=o.toLowerCase().replace(/\s+/g,"");if(s.some(d=>a===d.toLowerCase().replace(/\s+/g,"")))return l}},r=pw(n(["Gym membership","Gym Membership","GymMembership","Membership"])),i=pw(n(["Coach subscription","Coach Subscription","CoachSubscription","Coach"]));return{gym:r,coach:i}},Ys=(t,e=0)=>{if(!t)return"";const[n,r,i]=String(t).split("-").map(Number);if([n,r,i].some(o=>Number.isNaN(o)))return"";const s=new Date(Date.UTC(n,r-1,i));return s.setUTCDate(s.getUTCDate()+Number(e||0)),new Intl.DateTimeFormat("en-CA",{timeZone:"UTC",year:"numeric",month:"2-digit",day:"2-digit"}).format(s)};function uM({open:t,onClose:e,memberId:n,onSaved:r,membershipEnd:i,coachEnd:s,isStudent:o,birthDate:l}){const[a,d]=C.useState([]),[h,f]=C.useState(!1),[m,g]=C.useState([]),[S,_]=C.useState({Particulars:"",Mode:"",Cost:"",StartDate:"",EndDate:""}),[A,v]=C.useState("");C.useEffect(()=>{let E=!0;if(!t){d([]),_({Particulars:"",Mode:"",Cost:"",StartDate:"",EndDate:""}),v("");return}return(async()=>{try{v("");let T=[];try{const k=await aM();k&&Array.isArray(k.rows)?T=k.rows:k&&Array.isArray(k)&&(T=k)}catch{}if((!T||T.length===0)&&typeof fetch=="function"){const k=["/api/products","http://localhost:4000/products"];for(const N of k)try{const te=await fetch(N);if(te&&te.ok){const J=await te.json().catch(()=>null);if(J&&Array.isArray(J)){T=(J||[]).map(ne=>({Particulars:ne.name||ne.sku||`Product ${ne.id}`,Cost:typeof ne.price<"u"?Number(ne.price).toFixed(2):"",Validity:ne.validity_days||ne.validity||0,"Gym membership":ne.is_gym_membership?"Yes":"No","Coach subscription":ne.is_coach_subscription?"Yes":"No",Notes:ne.notes||""}));break}}}catch{}}E&&d(T||[])}catch(T){E&&v((T==null?void 0:T.message)||"Failed to load pricing")}})(),()=>{E=!1}},[t]),C.useEffect(()=>{if(!t||!n){g([]);return}let E=!0;return(async()=>{try{const T=await lM(),k=T&&Array.isArray(T.rows)?T.rows:Array.isArray(T)?T:[];if(!E)return;const N=String(n).trim(),te=(k||[]).filter(J=>String(J.MemberID||J.memberId||J.MemberID||J.memberid||"").trim()===N);g(te||[])}catch{g([])}})(),()=>{E=!1}},[t,n]);const w=C.useMemo(()=>{if(!l)return!1;const E=l instanceof Date?l:new Date(l);if(isNaN(E))return!1;const T=new Date;let k=T.getFullYear()-E.getFullYear();const N=T.getMonth()-E.getMonth();return(N<0||N===0&&T.getDate()<E.getDate())&&k--,k>=60},[l]),{manilaHour:b,isOffPeakWindow:j,isDailyWindow:M}=C.useMemo(()=>{var te;const E=new Intl.DateTimeFormat("en-US",{timeZone:ql,hour12:!1,hour:"2-digit"}).formatToParts(new Date),T=Number(((te=E.find(J=>J.type==="hour"))==null?void 0:te.value)||"0"),k=T>=6&&T<15,N=T>=15&&T<22;return{manilaHour:T,isOffPeakWindow:k,isDailyWindow:N}},[]),U=C.useMemo(()=>{const E=!!(o||w);return(a||[]).filter(T=>{const k=String(T.Particulars||"").trim();k.toLowerCase();const N=/(student|senior|discount|disc)/i.test(k),te=/off\s*-?\s*peak|offpeak/i.test(k),J=/\bdaily\b|daily\s*pass|1[- ]?day/i.test(k),ne=Ta(T);if(N&&!E)return!1;const ce=(()=>{try{if(!i)return!1;const $=new Date(i);$.setHours(0,0,0,0);const Z=new Date;return Z.setHours(0,0,0,0),$>=Z}catch{return!1}})(),V=(()=>{try{if(!s)return!1;const $=new Date(s);$.setHours(0,0,0,0);const Z=new Date;return Z.setHours(0,0,0,0),$>=Z}catch{return!1}})(),K=J&&ne.gym&&!ne.coach,B=J&&ne.coach&&!ne.gym,X=J&&ne.gym&&ne.coach;return!(K&&ce||B&&V||X&&(ce||V)||te&&!j&&!(J&&ne.coach&&!ne.gym)||J&&!te&&!M&&!(ne.coach&&!ne.gym))})},[a,o,w,j,M,i,s]);C.useEffect(()=>{if(!S.Particulars)return;U.some(T=>String(T.Particulars)===String(S.Particulars))||_(T=>({...T,Particulars:"",Cost:"",EndDate:""}))},[U]);const x=C.useMemo(()=>{const E={gymOnly:[],coachOnly:[],bundle:[],merch:[]};return(U||[]).forEach(T=>{const k=Ta(T);k.gym&&!k.coach?E.gymOnly.push(T):!k.gym&&k.coach?E.coachOnly.push(T):k.gym&&k.coach?E.bundle.push(T):E.merch.push(T)}),E},[U]),I=E=>{const T=(U||[]).find(Z=>String(Z.Particulars)===String(E)),k=T?(parseFloat(T.Cost)||0).toFixed(2):"",N=T?Number(T.Validity||0):0,te=Ta(T),J=/\bdaily\b|daily\s*pass|1[- ]?day/i.test(String(E||""));let ne=!1;if(J&&m&&m.length){const q=Date.now()-30*24*60*60*1e3,ae=String(E||"").trim();(m||[]).filter(G=>{try{if(String(G.Particulars||G.Particular||"").trim()!==ae)return!1;const H=G.Date||G.DatePaid||G.DateTime||G.timestamp||G.Timestamp||G.Time||null;if(!H)return!1;let z=new Date(H);if(isNaN(z))if(/^\d{4}-\d{2}-\d{2}$/.test(String(H)))z=new Date(String(H)+"T00:00:00");else return!1;return z.getTime()>=q}catch{return!1}}).length>=12&&(ne=!0)}const ce=Ac(),V=i?Ks(i):"",K=s?Ks(s):"",B=te.gym?V&&V>=ce?Ys(V,1):ce:null,X=te.coach?K&&K>=ce?Ys(K,1):ce:null;let $=ce;te.gym&&te.coach?$=ce:te.gym&&B?$=B:te.coach&&X?$=X:$=ce,_(Z=>{const q=$||Z.StartDate||ce;return{...Z,Particulars:E,Cost:ne?"0.00":k,StartDate:q,EndDate:N?Ea(q,N):"",PromoApplied:ne}})},R=async E=>{if(E.preventDefault(),!n)return v("Missing MemberID");if(!S.Particulars)return v("Select Particulars.");if(!S.Mode)return v("Select a payment mode.");if(!S.Cost)return v("Cost is missing for this item.");f(!0),v("");try{const T=(U||[]).find(D=>String(D.Particulars)===String(S.Particulars)),k=T?Number(T.Validity||0):0,N=Ta(T),te=String((T==null?void 0:T.Particulars)||"").toLowerCase(),J=/\bdaily\b|daily\s*pass|1[- ]?day/i.test(te),ne=/off\s*-?\s*peak|offpeak/i.test(te),ce=(()=>{try{if(!i)return!1;const D=new Date(i);D.setHours(0,0,0,0);const G=new Date;return G.setHours(0,0,0,0),D>=G}catch{return!1}})();if(J&&ce){v("Daily pass not allowed: member has active membership"),f(!1);return}if(J&&!ne&&!M){v("Daily pass only available 3pm-10pm (Manila time)"),f(!1);return}if(ne&&!j){v("Off-peak pass only available 6am-3pm (Manila time)"),f(!1);return}const V=(()=>{try{if(!s)return!1;const D=new Date(s);D.setHours(0,0,0,0);const G=new Date;return G.setHours(0,0,0,0),D>=G}catch{return!1}})();if(N.coach&&V){v("Coach session not allowed: member has active coach subscription"),f(!1);return}const K=Ac(),B=i?Ks(i):"",X=s?Ks(s):"",$=N.gym?B&&B>=K?Ys(B,1):S.StartDate||K:null,Z=N.coach?X&&X>=K?Ys(X,1):S.StartDate||K:null,q=$&&k?Ea($,k):"",ae=Z&&k?Ea(Z,k):"";await oM({MemberID:n,Particulars:S.Particulars,StartDate:S.StartDate||"",EndDate:S.EndDate||"",GymValidUntil:q,CoachValidUntil:ae,Mode:S.Mode,Cost:String(S.Cost).trim(),Date:Ac(),Time:cM()}),r&&r(),e&&e()}catch(T){const k=(T==null?void 0:T.message)||"Failed to add payment";v(k);try{sn.emit("modal:error",{message:k,source:"PaymentModal",error:String(T)})}catch{}}finally{f(!1)}};return t?u.jsx(ns,{open:t,onClose:e,title:"Add Payment",width:560,noInternalScroll:!0,children:u.jsxs("form",{onSubmit:R,style:{width:"100%"},children:[A&&u.jsx("div",{className:"small-error",style:{marginBottom:8},children:A}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10,marginBottom:10},children:[u.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[u.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:4},children:"Gym Membership - Valid until"}),u.jsx("div",{style:{fontWeight:700},children:i?Nc(i):"-"})]}),u.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[u.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:4},children:"Coach Subscription - Valid until"}),u.jsx("div",{style:{fontWeight:700},children:s?Nc(s):"-"})]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[u.jsxs("label",{className:"field",style:{gridColumn:"1 / span 2"},children:[u.jsx("span",{className:"label",children:"Particulars"}),u.jsxs("select",{value:S.Particulars,onChange:E=>I(E.target.value),required:!0,children:[u.jsx("option",{value:"",children:"Choose product/service"}),x.gymOnly.length>0&&u.jsx("optgroup",{label:"Gym membership only",children:x.gymOnly.map((E,T)=>u.jsx("option",{value:E.Particulars,children:E.Particulars},`gym-${E.Particulars}-${T}`))}),x.coachOnly.length>0&&u.jsx("optgroup",{label:"Coach subscription only",children:x.coachOnly.map((E,T)=>u.jsx("option",{value:E.Particulars,children:E.Particulars},`coach-${E.Particulars}-${T}`))}),x.bundle.length>0&&u.jsx("optgroup",{label:"Gym & Coach bundle",children:x.bundle.map((E,T)=>u.jsx("option",{value:E.Particulars,children:E.Particulars},`bundle-${E.Particulars}-${T}`))}),x.merch.length>0&&u.jsx("optgroup",{label:"Merchandise",children:x.merch.map((E,T)=>u.jsx("option",{value:E.Particulars,children:E.Particulars},`merch-${E.Particulars}-${T}`))})]}),S.Particulars&&(()=>{const E=(U||[]).find(B=>String(B.Particulars)===String(S.Particulars)),T=Ta(E),k=E?Number(E.Validity||0):0;if(!k)return null;const N=Ac(),te=i?Ks(i):"",J=s?Ks(s):"",ne=T.gym?te&&te>=N?Ys(te,1):S.StartDate||N:null,ce=T.coach?J&&J>=N?Ys(J,1):S.StartDate||N:null,V=ne?Ea(ne,k):null,K=ce?Ea(ce,k):null;return!V&&!K?null:u.jsxs("div",{style:{background:"#fde8ef",border:"1px solid #ffd7e3",color:"#8b1a3b",marginTop:8,padding:8,borderRadius:8,fontSize:13,lineHeight:1.35},children:[V&&u.jsxs("div",{children:["New Gym valid until: ",u.jsx("b",{children:Nc(V)})]}),K&&u.jsxs("div",{children:["New Coach valid until: ",u.jsx("b",{children:Nc(K)})]})]})})()]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Mode of Payment"}),u.jsxs("select",{value:S.Mode,onChange:E=>_(T=>({...T,Mode:E.target.value})),required:!0,children:[u.jsx("option",{value:"",children:"Select mode"}),u.jsx("option",{value:"Cash",children:"Cash"}),u.jsx("option",{value:"GCash",children:"GCash"})]})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Cost"}),u.jsx("input",{type:"number",step:"0.01",min:"0",value:S.Cost,readOnly:!0,disabled:!0}),S.PromoApplied&&u.jsx("div",{style:{marginTop:6,fontSize:12,color:"#065f46"},children:"Promo applied  this item will be free (12 uses in last 30 days)"})]})]}),u.jsx("div",{style:{marginTop:8,color:"var(--muted)",fontSize:12},children:"Validity is applied inclusive of the Start Date."}),u.jsxs("div",{style:{marginTop:12,display:"flex",gap:10,justifyContent:"flex-end"},children:[u.jsx("button",{type:"button",className:"back-btn",onClick:e,style:{background:"#e5e7eb",color:"#111",fontWeight:700},children:"Cancel"}),u.jsx("button",{type:"submit",className:"primary-btn",disabled:h,children:"+ Add Payment"})]})]})}):null}function dM({open:t,onClose:e,onCapture:n,waitForAck:r=!1}){const i=C.useRef(null),s=C.useRef(null),o=C.useRef(!1),[l,a]=C.useState([]),[d,h]=C.useState(""),[f,m]=C.useState(""),[g,S]=C.useState(!1),_=()=>{s.current&&(s.current.getTracks().forEach(E=>E.stop()),s.current=null)},A=async(E="")=>{if(!o.current){o.current=!0,S(!0),m(""),_();try{const T=E?{video:{deviceId:{exact:E},width:{ideal:1280},height:{ideal:720}},audio:!1}:{video:{facingMode:{ideal:"environment"},width:{ideal:1280},height:{ideal:720}},audio:!1};let k;try{k=await navigator.mediaDevices.getUserMedia(T)}catch(N){try{const te=E?{video:{deviceId:{ideal:E}},audio:!1}:{video:!0,audio:!1};k=await navigator.mediaDevices.getUserMedia(te)}catch(te){const J=te||N,ne=J&&J.name?String(J.name):"";m(ne==="NotAllowedError"?"Camera permission denied. Please allow camera access in the browser site settings and macOS Privacy > Camera.":ne==="NotReadableError"?"Camera is busy or not readable. Close other apps using the camera (e.g., Zoom/Meet/FaceTime) and try again.":ne==="OverconstrainedError"||ne==="ConstraintNotSatisfiedError"?"Selected camera doesn't meet constraints. Try choosing a different camera.":ne==="NotFoundError"?"No camera found. Plug in a camera or check system permissions.":"Cannot access camera. Check site permissions and OS privacy settings.");return}}if(s.current=k,i.current){i.current.srcObject=k;try{await i.current.play()}catch{}}try{await v()}catch{}}catch{m("Cannot access camera. Check site permissions and OS privacy settings.")}finally{o.current=!1,S(!1)}}},v=async()=>{try{const T=(await navigator.mediaDevices.enumerateDevices()).filter(k=>k.kind==="videoinput");a(T),!d&&T[0]&&h(T[0].deviceId)}catch{}};C.useEffect(()=>{var E,T;if(!t){_();return}return(async()=>(m(""),await A(d||"")))(),(T=(E=navigator.mediaDevices)==null?void 0:E.addEventListener)==null||T.call(E,"devicechange",v),()=>{var k,N;(N=(k=navigator.mediaDevices)==null?void 0:k.removeEventListener)==null||N.call(k,"devicechange",v),_()}},[t]),C.useEffect(()=>{var E,T,k,N;if(!(!t||!d)){try{const te=((N=(k=(T=(E=s.current)==null?void 0:E.getVideoTracks)==null?void 0:T.call(E)[0])==null?void 0:k.getSettings)==null?void 0:N.call(k).deviceId)||"";if(te&&te===d)return}catch{}A(d)}},[d]);const w=async()=>{if(!i.current)return;const E=i.current,T=document.createElement("canvas"),k=E.videoWidth||1280,N=E.videoHeight||720,te=800,J=k>te?te/k:1,ne=Math.max(320,Math.round(k*J)),ce=Math.max(240,Math.round(N*J));T.width=ne,T.height=ce,T.getContext("2d").drawImage(E,0,0,ne,ce);const K=T.toDataURL("image/jpeg",.65);try{const B=n==null?void 0:n(K);if(r&&B&&typeof B.then=="function"){U(!0);try{await Promise.resolve(B)}catch(X){m(X&&X.message?X.message:String(X||"Failed to process photo"))}}else try{B&&typeof B.then=="function"&&B.catch(X=>{try{m(String((X==null?void 0:X.message)||X))}catch{}})}catch{}}catch(B){m(B&&B.message?B.message:String(B||"Failed to process photo"))}finally{try{U(!1)}catch{}_(),e==null||e()}},[b,j]=C.useState(null),[M,U]=C.useState(!1),x=async()=>{if(!b)return;m("");const E=n==null?void 0:n(b);if(r&&E&&typeof E.then=="function"){U(!0);try{await Promise.resolve(E)}catch(T){const k=T&&T.message?T.message:String(T||"Failed to process photo");m(k)}finally{U(!1),j(null),e==null||e()}return}try{E&&typeof E.then=="function"&&E.catch(T=>{try{m(String((T==null?void 0:T.message)||T))}catch{}})}catch{}j(null),e==null||e()},I=()=>{j(null),A(d||"")};if(!t)return null;const R=u.jsxs(ns,{open:t,onClose:e,width:720,noWrapper:!0,children:[u.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[u.jsx("label",{style:{fontWeight:600,fontSize:14},children:"Camera:"}),u.jsxs("select",{value:d,onChange:E=>h(E.target.value),style:{flex:1,padding:"8px 10px",borderRadius:8,border:"1px solid #e7e8ef"},children:[l.length===0&&u.jsx("option",{value:"",children:"(No camera found)"}),l.map(E=>u.jsx("option",{value:E.deviceId,children:E.label||"Camera"},E.deviceId))]})]}),!f&&!s.current&&u.jsx("div",{style:{color:"#666",marginBottom:8},children:"Initializing camera please allow the browser prompt."}),f?u.jsx("div",{style:{color:"#d33",marginBottom:12},children:f}):u.jsx("div",{style:{width:"100%"},children:b?u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[u.jsx("img",{src:b,alt:"preview",style:{width:"100%",borderRadius:10}}),u.jsx("div",{style:{color:"#666",fontSize:13},children:"Preview  accept to use this photo or retake."})]}):u.jsx("video",{ref:i,playsInline:!0,muted:!0,style:{width:"100%",borderRadius:10,background:"#000"}})}),u.jsx("div",{style:{display:"flex",gap:10,marginTop:12,justifyContent:"flex-end"},children:b?u.jsxs(u.Fragment,{children:[u.jsx("button",{type:"button",className:"button",onClick:I,disabled:M,children:"Retake"}),u.jsx("button",{type:"button",className:"button btn-lg",onClick:x,disabled:M,children:M?"Processing":"Use Photo"})]}):u.jsx(u.Fragment,{children:u.jsx("button",{type:"button",className:"button btn-lg",onClick:w,disabled:!!f||!s.current,children:"Capture"})})})]});return aE.createPortal(R,document.body)}const hM=["Isabel","Merida","Palompon","Ormoc","Matag-ob"],fM={Isabel:["Anislag","Antipolo","Apale","Bantigue","Binog","Bilwang","Can-andan","Cangag","Consolacion","Honan","Libertad","Mahayag","Marvel (Poblacion)","Matlang","Monte Alegre","Puting Bato","San Francisco","San Roque","Santa Cruz Relocation","Santo Nio (Poblacion)","Santo Rosario","Tabunok","Tolingon","Tubod"],Merida:["Benabaye","Cabaliwan","Calunangan","Calunasan","Cambalong","Can-unzo","Canbantug","Casilda","Lamanoc","Libas","Libjo","Lundag","Macario","Mahalit","Mahayag","Masumbang","Mat-e","Poblacion","Puerto Bello","San Isidro","San Jose","Tubod"],Palompon:["Baguinbin","Belen","Buenavista","Caduhaan","Cambakbak","Cambinoy","Cangcosme","Cangmuya","Canipaan","Cantandoy","Cantuhaon","Catigahan","Central 1 (Poblacion)","Central 2 (Poblacion)","Cruz","Duljugan","Guiwan 1 (Poblacion)","Guiwan 2 (Poblacion)","Himarco","Hinablayan (Poblacion)","Hinagbuan","Lat-osan","Liberty","Lomonon","Mabini","Magsaysay","Masaba","Mazawalo (Poblacion)","Parilla","Pinagdait (Poblacion Ypil I)","Pinaghi-usa (Poblacion Ypil II)","Plaridel","Rizal","Sabang","San Guillermo","San Isidro","San Joaquin","San Juan","San Miguel","San Pablo","San Pedro","San Roque","Santiago","Taberna","Tabunok","Tambis","Tinabilan","Tinago","Tinubdan","Bitaog (Poblacion Ypil III)"],Ormoc:["Airport","Alegria","Alta Vista","Bagongbong","Bagong Buhay","Bantigue","Batuan","Bayog","Biliboy","Borok","Cabaon-an","Cabintan","Cabulihan","Cagbuhangin","Camp Downes","Can-adieng","Can-untog","Catmon","Cogon Combado","Concepcion","Curva","Danhug","Dayhagan","Dolores","Domonar","Don Felipe Larrazabal","Don Potenciano Larrazabal","Doa Feliza Z. Mejia","Donghol","Esperanza","Gaas","Green Valley","Guintigui-an","Hibunawon","Hugpa","Ipil","Juaton","Kadaohan","Labrador (Balion)","Lao","Leondoni","Libertad","Liberty","Licuma","Liloan","Linao","Luna","Mabato","Mabini","Macabug","Magaswi","Mahayag","Mahayahay","Manlilinao","Margen","Mas-in","Matica-a","Milagro","Monterico","Nasunogan","Naungan","Nueva Sociedad","Nueva Vista","Patag","Punta","Quezon Jr.","Rufina M. Tan (Rawis)","Sabang Bao","Salvacion","San Antonio","San Isidro","San Jose","San Juan","San Pablo (Simangan)","San Vicente","Santo Nio","Sumangga","Tambulilid","Tongonan","Valencia","East (Poblacion)","West (Poblacion)","North (Poblacion)","South (Poblacion)"],"Matag-ob":["Balagtas","Bonoy","Bulak","Cambadbad","Candelaria","Cansoso","Imelda","Malazarte","Mansaha-on","Mansalip","Masaba","Naulayan","Riverside (Poblacion)","San Dionesio","San Guillermo (Poblacion)","San Marcelino","San Sebastian","San Vicente","Santa Rosa","Santo Rosario","Talisay (Poblacion)"]};function mM(t){return fM[t]||[]}const{updateMember:pM,uploadMemberPhoto:gw,fetchMemberById:gM,fetchMemberByIdFresh:yM}=Re,vM=t=>{const e={};return Object.entries(t||{}).forEach(([n,r])=>e[String(n).toLowerCase()]=r),e},it=(t,...e)=>{if(!t)return"";for(const n of e){if(t[n]!==void 0&&t[n]!==null&&t[n]!=="")return t[n];const r=String(n).toLowerCase(),i=vM(t);if(i[r]!==void 0&&i[r]!=="")return i[r];const s=r.replace(/\s+/g,"");if(i[s]!==void 0&&i[s]!=="")return i[s];const o=r.replace(/\s+/g,"_");if(i[o]!==void 0&&i[o]!=="")return i[o]}return""};function _M(t,e=`photo-${Date.now()}.jpg`){const n=t.split(","),r=n[0].match(/:(.*?);/)[1]||"image/jpeg",i=atob(n[1]);let s=i.length;const o=new Uint8Array(s);for(;s--;)o[s]=i.charCodeAt(s);return new File([o],e,{type:r})}function wM({open:t,onClose:e,member:n,onSaved:r}){const[i,s]=C.useState({lastName:"",firstName:"",middleName:"",nickName:"",gender:"",birthday:"",street:"",brgy:"",municipality:"",email:"",mobile:"",validId:"",student:!1}),[o,l]=C.useState(""),[a,d]=C.useState(""),[h,f]=C.useState(""),[m,g]=C.useState(null),S=C.useRef(null),[_,A]=C.useState(!1),[v,w]=C.useState(""),[b,j]=C.useState(!1),[M,U]=C.useState(""),x=C.useRef(!1),I=mM(i.municipality),R=J=>{const ce=String(J||"").match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return ce&&ce[1]?ce[1]:""},E=J=>{const ne=String(J||"");if(!ne)return"";const ce=ne.match(/https?:\/\/[^\s}]+/);if(ce){const K=ce[0];if(/googleusercontent\.com\//.test(K))return K;const B=K.match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return B&&B[1]?`https://drive.google.com/uc?export=view&id=${B[1]}`:K}if(/googleusercontent\.com\//.test(ne))return ne;const V=R(ne);return V?`https://drive.google.com/uc?export=view&id=${V}`:ne},T=J=>{const ne=String(J||"");if(/googleusercontent\.com\//.test(ne))return ne;const ce=R(ne);return ce?`https://drive.google.com/thumbnail?id=${ce}&sz=w1000`:ne};C.useEffect(()=>{let J=!1;if(!t){x.current=!1;return}if(x.current)return;const ne=n||{},ce=String(it(ne,"MemberID","memberId","member_id","id")||"").trim();return l(ce),(async()=>{try{if(ce){const V=await gM(String(ce).trim());if(!J&&V){const K=it(V,"LastName","lastName","last_name","Last"),B=it(V,"FirstName","firstName","first_name","First"),X=it(V,"MiddleName","middleName","middle_name"),$=it(V,"NickName","nickname","nick_name","Nick Name"),Z=it(V,"Gender","gender"),q=it(V,"Birthday","birth_date","dob","Birth Date"),ae=it(V,"Street","street"),D=it(V,"Brgy","Barangay","brgy","barangay"),G=it(V,"Municipality","City","municipality","city"),L=it(V,"Email","email"),H=it(V,"Mobile","Phone","mobile","phone"),z=it(V,"ValidID","Valid Id","Valid ID","validId","valid_id"),se=String(it(V,"Student","student")||"").toLowerCase().startsWith("y"),ge=it(V,"PhotoURL","photoUrl","photo_url","photo"),O=ge?T(E(ge)):"";d(ge||""),f(O),g(null),w("");const Q=String(D||"");s({lastName:String(K||""),firstName:String(B||""),middleName:String(X||""),nickName:String($||""),gender:String(Z||""),birthday:q?new Date(q).toISOString().slice(0,10):"",street:String(ae||""),brgy:Q,municipality:String(G||""),email:String(L||""),mobile:String(H||""),validId:String(z||""),student:se}),x.current=!0;return}}}catch{}if(!J){const V=it(ne,"LastName","lastName","last_name","Last"),K=it(ne,"FirstName","firstName","first_name","First"),B=it(ne,"MiddleName","middleName","middle_name"),X=it(ne,"NickName","nickname","nick_name","Nick Name"),$=it(ne,"Gender","gender"),Z=it(ne,"Birthday","birth_date","dob","Birth Date"),q=it(ne,"Street","street"),ae=it(ne,"Brgy","Barangay","brgy","barangay"),D=it(ne,"Municipality","City","municipality","city"),G=it(ne,"Email","email"),L=it(ne,"Mobile","Phone","mobile","phone"),H=it(ne,"ValidID","Valid Id","Valid ID","validId","valid_id"),z=String(it(ne,"Student","student")||"").toLowerCase().startsWith("y"),se=it(ne,"PhotoURL","photoUrl","photo_url","photo"),ge=se?T(E(se)):"";d(se||""),f(ge),g(null),w("");const O=String(ae||"");s({lastName:String(V||""),firstName:String(K||""),middleName:String(B||""),nickName:String(X||""),gender:String($||""),birthday:Z?new Date(Z).toISOString().slice(0,10):"",street:String(q||""),brgy:O,municipality:String(D||""),email:String(G||""),mobile:String(L||""),validId:String(H||""),student:z}),x.current=!0}})(),()=>{J=!0}},[t,n]);const k=J=>{const{name:ne,value:ce,type:V,checked:K}=J.target;if(ne==="student-select"){s(B=>({...B,student:String(ce)==="Yes"}));return}if(ne==="municipality"){s(B=>({...B,municipality:ce,brgy:""}));return}s(B=>({...B,[ne]:V==="checkbox"?K:ce}))},N=J=>{try{const ne=_M(J);S.current&&(URL.revokeObjectURL(S.current),S.current=null);const ce=URL.createObjectURL(ne);if(S.current=ce,g(ne),f(ce),o){const V=String(o).trim().toLowerCase(),K=(async()=>{try{const B=await gw(ne,V),X=typeof B=="string"?B:(B==null?void 0:B.url)||"";d(X||a);const $=X?T(E(X)):ce;return f($),g(null),X}catch(B){try{w(String(B||"Photo upload failed"))}catch{}return null}})();return Promise.resolve(K).catch(()=>null)}}catch(ne){try{w(String(ne||"Failed to handle capture"))}catch{}return Promise.resolve(null)}return Promise.resolve(null)};C.useEffect(()=>()=>{S.current&&(URL.revokeObjectURL(S.current),S.current=null)},[]);const te=async J=>{var ce;try{(ce=J==null?void 0:J.preventDefault)==null||ce.call(J)}catch{}if(!o){w("Missing MemberID");return}try{console.debug("[EditMemberModal] save() starting for",o)}catch{}const ne={MemberID:o,LastName:i.lastName.trim(),FirstName:i.firstName.trim(),MiddleName:i.middleName.trim(),NickName:String(i.nickName||"").trim().toUpperCase(),Gender:i.gender,Birthday:i.birthday||"",Street:i.street.trim(),Brgy:i.brgy.trim(),Municipality:i.municipality.trim(),Email:i.email.trim(),Mobile:i.mobile.trim(),ValidID:i.validId.trim(),Student:i.student?"Yes":"No",PhotoURL:h||a||""};try{console.debug("[EditMemberModal] optimisticPayload",ne)}catch{}A(!0),w("");try{let V=a||"";if(m)try{const X=gw(m,String(o).toLowerCase()),Z=await Promise.race([X,new Promise((q,ae)=>setTimeout(()=>ae(new Error("photo upload timeout")),15e3))]);try{console.debug("[EditMemberModal] uploadMemberPhoto result",Z)}catch{}V=typeof Z=="string"?Z:(Z==null?void 0:Z.url)||V,g(null)}catch(X){try{console.debug("[EditMemberModal] uploadMemberPhoto failed",String(X))}catch{}w(String(X)||"Photo upload failed  saving without photo change")}const K={...ne,PhotoURL:V};let B=null;try{try{console.debug("[EditMemberModal] sending update payload",K)}catch{}const X=pM(K),$=await Promise.race([X,new Promise((Z,q)=>setTimeout(()=>q(new Error("update timeout")),2e4))]);try{console.debug("[EditMemberModal] updateMember response",$)}catch{}$&&typeof $=="object"&&($.row&&typeof $.row=="object"?B=$.row:$.updated&&typeof $.updated=="object"?B=$.updated:$.data&&typeof $.data=="object"?B=$.data:["MemberID","memberid","LastName","FirstName"].some(q=>Object.prototype.hasOwnProperty.call($,q))&&(B=$));try{console.debug("[EditMemberModal] authoritative after response",B)}catch{}}catch(X){try{console.debug("[EditMemberModal] updateMember error",String(X))}catch{}w(String(X)||"Failed to update member"),sn.emit("modal:error",{message:"Failed to update member",source:"EditMemberModal",error:String(X)})}if(!B)try{try{console.debug("[EditMemberModal] fetching fresh member by id",String(o).trim())}catch{}const X=yM(String(o).trim()),$=await Promise.race([X,new Promise((Z,q)=>setTimeout(()=>q(new Error("fetch member timeout")),15e3))]);try{console.debug("[EditMemberModal] fetchMemberByIdFresh result",$)}catch{}$&&(B=$)}catch(X){try{console.debug("[EditMemberModal] fetchMemberByIdFresh failed",String(X))}catch{}}B||(B=K);try{console.debug("[EditMemberModal] final authoritative row passed to parent",B)}catch{}try{r==null||r(B)}catch{}try{e==null||e()}catch{}}catch(V){sn.emit("modal:error",{message:"Background member update failed",source:"EditMemberModal",error:String(V)}),w(String(V)||"Background member update failed")}finally{A(!1)}};return t?u.jsx(ns,{open:t,onClose:e,title:i.nickName||"Edit Member",width:1e3,noInternalScroll:!0,children:u.jsxs("form",{onSubmit:te,style:{width:"100%",padding:0,background:"transparent",border:"none",boxShadow:"none",overflow:"visible"},children:[M&&u.jsx("div",{style:{position:"fixed",top:20,right:20,background:"#16a34a",color:"#fff",padding:"8px 12px",borderRadius:10,boxShadow:"0 6px 16px rgba(0,0,0,.15)",zIndex:1e4},children:M}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"240px 1fr",gap:16},children:[u.jsxs("div",{children:[u.jsx("div",{style:{width:240,height:240,border:"1px solid var(--light-border)",borderRadius:12,background:"#fafbff",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center"},children:h?u.jsx("img",{src:h,alt:"preview",style:{width:"100%",height:"100%",objectFit:"cover"}}):u.jsx("div",{style:{color:"var(--muted)"},children:"No photo"})}),u.jsx("div",{style:{display:"flex",gap:8,marginTop:10},children:u.jsx("button",{type:"button",className:"button",onClick:()=>j(!0),disabled:!0,title:"Camera disabled in this build",style:{flex:"1 1 auto",cursor:"not-allowed",opacity:.6},children:" Change Photo"})})]}),u.jsxs("div",{style:{display:"grid",gap:12},children:[u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 160px",gap:12,alignItems:"end"},children:[u.jsxs("label",{className:"field",style:{margin:0},children:[u.jsx("span",{className:"label",children:"Valid ID *"}),u.jsx("input",{name:"validId",value:i.validId,onChange:k,required:!0})]}),u.jsxs("label",{className:"field",style:{margin:0},children:[u.jsx("span",{className:"label",children:"Student"}),u.jsxs("select",{name:"student-select",value:i.student?"Yes":"No",onChange:k,children:[u.jsx("option",{children:"Yes"}),u.jsx("option",{children:"No"})]})]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12},children:[u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Last Name *"}),u.jsx("input",{name:"lastName",value:i.lastName,onChange:k,required:!0})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"First Name *"}),u.jsx("input",{name:"firstName",value:i.firstName,onChange:k,required:!0})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Middle Name"}),u.jsx("input",{name:"middleName",value:i.middleName,onChange:k})]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Birthday *"}),u.jsx("input",{type:"date",name:"birthday",value:i.birthday,onChange:k,required:!0})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Gender *"}),u.jsxs("select",{name:"gender",value:i.gender,onChange:k,required:!0,children:[u.jsx("option",{value:"",children:" Select "}),u.jsx("option",{children:"Male"}),u.jsx("option",{children:"Female"})]})]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Mobile No. *"}),u.jsx("input",{name:"mobile",value:i.mobile,onChange:k,placeholder:"09XXXXXXXXX",required:!0})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Email Address"}),u.jsx("input",{name:"email",value:i.email,onChange:k,placeholder:"name@example.com"})]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 2fr",gap:12},children:[u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Municipality / City"}),u.jsxs("select",{name:"municipality",value:i.municipality,onChange:k,children:[u.jsx("option",{value:""}),hM.map(J=>u.jsx("option",{value:J,children:J},J))]})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Brgy."}),u.jsxs("select",{name:"brgy",value:i.brgy,onChange:k,disabled:!i.municipality,children:[u.jsx("option",{value:""}),I.map(J=>u.jsx("option",{value:J,children:J},J))]})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"House No. / Street Name / Sitio"}),u.jsx("input",{name:"street",value:i.street,onChange:k})]})]}),v&&u.jsx("div",{style:{color:"#d33",fontSize:15,marginTop:8,fontWeight:600},children:v})]})]}),u.jsxs("div",{style:{marginTop:12,display:"flex",gap:10,justifyContent:"flex-end"},children:[u.jsx("button",{type:"button",className:"back-btn",onClick:e,style:{background:"#e5e7eb",color:"#111",fontWeight:700},children:"Cancel"}),u.jsx("button",{type:"button",className:"primary-btn",disabled:_,onClick:te,children:" Save Changes"})]}),u.jsx(dM,{open:b,onClose:()=>j(!1),onCapture:N})]})}):null}var SM=Object.defineProperty,Yu=Object.getOwnPropertySymbols,wI=Object.prototype.hasOwnProperty,SI=Object.prototype.propertyIsEnumerable,yw=(t,e,n)=>e in t?SM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,km=(t,e)=>{for(var n in e||(e={}))wI.call(e,n)&&yw(t,n,e[n]);if(Yu)for(var n of Yu(e))SI.call(e,n)&&yw(t,n,e[n]);return t},Pm=(t,e)=>{var n={};for(var r in t)wI.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&Yu)for(var r of Yu(t))e.indexOf(r)<0&&SI.call(t,r)&&(n[r]=t[r]);return n};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var Ms;(t=>{const e=class Oe{constructor(a,d,h,f){if(this.version=a,this.errorCorrectionLevel=d,this.modules=[],this.isFunction=[],a<Oe.MIN_VERSION||a>Oe.MAX_VERSION)throw new RangeError("Version value out of range");if(f<-1||f>7)throw new RangeError("Mask value out of range");this.size=a*4+17;let m=[];for(let S=0;S<this.size;S++)m.push(!1);for(let S=0;S<this.size;S++)this.modules.push(m.slice()),this.isFunction.push(m.slice());this.drawFunctionPatterns();const g=this.addEccAndInterleave(h);if(this.drawCodewords(g),f==-1){let S=1e9;for(let _=0;_<8;_++){this.applyMask(_),this.drawFormatBits(_);const A=this.getPenaltyScore();A<S&&(f=_,S=A),this.applyMask(_)}}i(0<=f&&f<=7),this.mask=f,this.applyMask(f),this.drawFormatBits(f),this.isFunction=[]}static encodeText(a,d){const h=t.QrSegment.makeSegments(a);return Oe.encodeSegments(h,d)}static encodeBinary(a,d){const h=t.QrSegment.makeBytes(a);return Oe.encodeSegments([h],d)}static encodeSegments(a,d,h=1,f=40,m=-1,g=!0){if(!(Oe.MIN_VERSION<=h&&h<=f&&f<=Oe.MAX_VERSION)||m<-1||m>7)throw new RangeError("Invalid value");let S,_;for(S=h;;S++){const b=Oe.getNumDataCodewords(S,d)*8,j=o.getTotalBits(a,S);if(j<=b){_=j;break}if(S>=f)throw new RangeError("Data too long")}for(const b of[Oe.Ecc.MEDIUM,Oe.Ecc.QUARTILE,Oe.Ecc.HIGH])g&&_<=Oe.getNumDataCodewords(S,b)*8&&(d=b);let A=[];for(const b of a){n(b.mode.modeBits,4,A),n(b.numChars,b.mode.numCharCountBits(S),A);for(const j of b.getData())A.push(j)}i(A.length==_);const v=Oe.getNumDataCodewords(S,d)*8;i(A.length<=v),n(0,Math.min(4,v-A.length),A),n(0,(8-A.length%8)%8,A),i(A.length%8==0);for(let b=236;A.length<v;b^=253)n(b,8,A);let w=[];for(;w.length*8<A.length;)w.push(0);return A.forEach((b,j)=>w[j>>>3]|=b<<7-(j&7)),new Oe(S,d,w,m)}getModule(a,d){return 0<=a&&a<this.size&&0<=d&&d<this.size&&this.modules[d][a]}getModules(){return this.modules}drawFunctionPatterns(){for(let h=0;h<this.size;h++)this.setFunctionModule(6,h,h%2==0),this.setFunctionModule(h,6,h%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const a=this.getAlignmentPatternPositions(),d=a.length;for(let h=0;h<d;h++)for(let f=0;f<d;f++)h==0&&f==0||h==0&&f==d-1||h==d-1&&f==0||this.drawAlignmentPattern(a[h],a[f]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(a){const d=this.errorCorrectionLevel.formatBits<<3|a;let h=d;for(let m=0;m<10;m++)h=h<<1^(h>>>9)*1335;const f=(d<<10|h)^21522;i(f>>>15==0);for(let m=0;m<=5;m++)this.setFunctionModule(8,m,r(f,m));this.setFunctionModule(8,7,r(f,6)),this.setFunctionModule(8,8,r(f,7)),this.setFunctionModule(7,8,r(f,8));for(let m=9;m<15;m++)this.setFunctionModule(14-m,8,r(f,m));for(let m=0;m<8;m++)this.setFunctionModule(this.size-1-m,8,r(f,m));for(let m=8;m<15;m++)this.setFunctionModule(8,this.size-15+m,r(f,m));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let a=this.version;for(let h=0;h<12;h++)a=a<<1^(a>>>11)*7973;const d=this.version<<12|a;i(d>>>18==0);for(let h=0;h<18;h++){const f=r(d,h),m=this.size-11+h%3,g=Math.floor(h/3);this.setFunctionModule(m,g,f),this.setFunctionModule(g,m,f)}}drawFinderPattern(a,d){for(let h=-4;h<=4;h++)for(let f=-4;f<=4;f++){const m=Math.max(Math.abs(f),Math.abs(h)),g=a+f,S=d+h;0<=g&&g<this.size&&0<=S&&S<this.size&&this.setFunctionModule(g,S,m!=2&&m!=4)}}drawAlignmentPattern(a,d){for(let h=-2;h<=2;h++)for(let f=-2;f<=2;f++)this.setFunctionModule(a+f,d+h,Math.max(Math.abs(f),Math.abs(h))!=1)}setFunctionModule(a,d,h){this.modules[d][a]=h,this.isFunction[d][a]=!0}addEccAndInterleave(a){const d=this.version,h=this.errorCorrectionLevel;if(a.length!=Oe.getNumDataCodewords(d,h))throw new RangeError("Invalid argument");const f=Oe.NUM_ERROR_CORRECTION_BLOCKS[h.ordinal][d],m=Oe.ECC_CODEWORDS_PER_BLOCK[h.ordinal][d],g=Math.floor(Oe.getNumRawDataModules(d)/8),S=f-g%f,_=Math.floor(g/f);let A=[];const v=Oe.reedSolomonComputeDivisor(m);for(let b=0,j=0;b<f;b++){let M=a.slice(j,j+_-m+(b<S?0:1));j+=M.length;const U=Oe.reedSolomonComputeRemainder(M,v);b<S&&M.push(0),A.push(M.concat(U))}let w=[];for(let b=0;b<A[0].length;b++)A.forEach((j,M)=>{(b!=_-m||M>=S)&&w.push(j[b])});return i(w.length==g),w}drawCodewords(a){if(a.length!=Math.floor(Oe.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let d=0;for(let h=this.size-1;h>=1;h-=2){h==6&&(h=5);for(let f=0;f<this.size;f++)for(let m=0;m<2;m++){const g=h-m,_=(h+1&2)==0?this.size-1-f:f;!this.isFunction[_][g]&&d<a.length*8&&(this.modules[_][g]=r(a[d>>>3],7-(d&7)),d++)}}i(d==a.length*8)}applyMask(a){if(a<0||a>7)throw new RangeError("Mask value out of range");for(let d=0;d<this.size;d++)for(let h=0;h<this.size;h++){let f;switch(a){case 0:f=(h+d)%2==0;break;case 1:f=d%2==0;break;case 2:f=h%3==0;break;case 3:f=(h+d)%3==0;break;case 4:f=(Math.floor(h/3)+Math.floor(d/2))%2==0;break;case 5:f=h*d%2+h*d%3==0;break;case 6:f=(h*d%2+h*d%3)%2==0;break;case 7:f=((h+d)%2+h*d%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[d][h]&&f&&(this.modules[d][h]=!this.modules[d][h])}}getPenaltyScore(){let a=0;for(let m=0;m<this.size;m++){let g=!1,S=0,_=[0,0,0,0,0,0,0];for(let A=0;A<this.size;A++)this.modules[m][A]==g?(S++,S==5?a+=Oe.PENALTY_N1:S>5&&a++):(this.finderPenaltyAddHistory(S,_),g||(a+=this.finderPenaltyCountPatterns(_)*Oe.PENALTY_N3),g=this.modules[m][A],S=1);a+=this.finderPenaltyTerminateAndCount(g,S,_)*Oe.PENALTY_N3}for(let m=0;m<this.size;m++){let g=!1,S=0,_=[0,0,0,0,0,0,0];for(let A=0;A<this.size;A++)this.modules[A][m]==g?(S++,S==5?a+=Oe.PENALTY_N1:S>5&&a++):(this.finderPenaltyAddHistory(S,_),g||(a+=this.finderPenaltyCountPatterns(_)*Oe.PENALTY_N3),g=this.modules[A][m],S=1);a+=this.finderPenaltyTerminateAndCount(g,S,_)*Oe.PENALTY_N3}for(let m=0;m<this.size-1;m++)for(let g=0;g<this.size-1;g++){const S=this.modules[m][g];S==this.modules[m][g+1]&&S==this.modules[m+1][g]&&S==this.modules[m+1][g+1]&&(a+=Oe.PENALTY_N2)}let d=0;for(const m of this.modules)d=m.reduce((g,S)=>g+(S?1:0),d);const h=this.size*this.size,f=Math.ceil(Math.abs(d*20-h*10)/h)-1;return i(0<=f&&f<=9),a+=f*Oe.PENALTY_N4,i(0<=a&&a<=2568888),a}getAlignmentPatternPositions(){if(this.version==1)return[];{const a=Math.floor(this.version/7)+2,d=this.version==32?26:Math.ceil((this.version*4+4)/(a*2-2))*2;let h=[6];for(let f=this.size-7;h.length<a;f-=d)h.splice(1,0,f);return h}}static getNumRawDataModules(a){if(a<Oe.MIN_VERSION||a>Oe.MAX_VERSION)throw new RangeError("Version number out of range");let d=(16*a+128)*a+64;if(a>=2){const h=Math.floor(a/7)+2;d-=(25*h-10)*h-55,a>=7&&(d-=36)}return i(208<=d&&d<=29648),d}static getNumDataCodewords(a,d){return Math.floor(Oe.getNumRawDataModules(a)/8)-Oe.ECC_CODEWORDS_PER_BLOCK[d.ordinal][a]*Oe.NUM_ERROR_CORRECTION_BLOCKS[d.ordinal][a]}static reedSolomonComputeDivisor(a){if(a<1||a>255)throw new RangeError("Degree out of range");let d=[];for(let f=0;f<a-1;f++)d.push(0);d.push(1);let h=1;for(let f=0;f<a;f++){for(let m=0;m<d.length;m++)d[m]=Oe.reedSolomonMultiply(d[m],h),m+1<d.length&&(d[m]^=d[m+1]);h=Oe.reedSolomonMultiply(h,2)}return d}static reedSolomonComputeRemainder(a,d){let h=d.map(f=>0);for(const f of a){const m=f^h.shift();h.push(0),d.forEach((g,S)=>h[S]^=Oe.reedSolomonMultiply(g,m))}return h}static reedSolomonMultiply(a,d){if(a>>>8||d>>>8)throw new RangeError("Byte out of range");let h=0;for(let f=7;f>=0;f--)h=h<<1^(h>>>7)*285,h^=(d>>>f&1)*a;return i(h>>>8==0),h}finderPenaltyCountPatterns(a){const d=a[1];i(d<=this.size*3);const h=d>0&&a[2]==d&&a[3]==d*3&&a[4]==d&&a[5]==d;return(h&&a[0]>=d*4&&a[6]>=d?1:0)+(h&&a[6]>=d*4&&a[0]>=d?1:0)}finderPenaltyTerminateAndCount(a,d,h){return a&&(this.finderPenaltyAddHistory(d,h),d=0),d+=this.size,this.finderPenaltyAddHistory(d,h),this.finderPenaltyCountPatterns(h)}finderPenaltyAddHistory(a,d){d[0]==0&&(a+=this.size),d.pop(),d.unshift(a)}};e.MIN_VERSION=1,e.MAX_VERSION=40,e.PENALTY_N1=3,e.PENALTY_N2=3,e.PENALTY_N3=40,e.PENALTY_N4=10,e.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],e.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],t.QrCode=e;function n(l,a,d){if(a<0||a>31||l>>>a)throw new RangeError("Value out of range");for(let h=a-1;h>=0;h--)d.push(l>>>h&1)}function r(l,a){return(l>>>a&1)!=0}function i(l){if(!l)throw new Error("Assertion error")}const s=class Dt{constructor(a,d,h){if(this.mode=a,this.numChars=d,this.bitData=h,d<0)throw new RangeError("Invalid argument");this.bitData=h.slice()}static makeBytes(a){let d=[];for(const h of a)n(h,8,d);return new Dt(Dt.Mode.BYTE,a.length,d)}static makeNumeric(a){if(!Dt.isNumeric(a))throw new RangeError("String contains non-numeric characters");let d=[];for(let h=0;h<a.length;){const f=Math.min(a.length-h,3);n(parseInt(a.substring(h,h+f),10),f*3+1,d),h+=f}return new Dt(Dt.Mode.NUMERIC,a.length,d)}static makeAlphanumeric(a){if(!Dt.isAlphanumeric(a))throw new RangeError("String contains unencodable characters in alphanumeric mode");let d=[],h;for(h=0;h+2<=a.length;h+=2){let f=Dt.ALPHANUMERIC_CHARSET.indexOf(a.charAt(h))*45;f+=Dt.ALPHANUMERIC_CHARSET.indexOf(a.charAt(h+1)),n(f,11,d)}return h<a.length&&n(Dt.ALPHANUMERIC_CHARSET.indexOf(a.charAt(h)),6,d),new Dt(Dt.Mode.ALPHANUMERIC,a.length,d)}static makeSegments(a){return a==""?[]:Dt.isNumeric(a)?[Dt.makeNumeric(a)]:Dt.isAlphanumeric(a)?[Dt.makeAlphanumeric(a)]:[Dt.makeBytes(Dt.toUtf8ByteArray(a))]}static makeEci(a){let d=[];if(a<0)throw new RangeError("ECI assignment value out of range");if(a<128)n(a,8,d);else if(a<16384)n(2,2,d),n(a,14,d);else if(a<1e6)n(6,3,d),n(a,21,d);else throw new RangeError("ECI assignment value out of range");return new Dt(Dt.Mode.ECI,0,d)}static isNumeric(a){return Dt.NUMERIC_REGEX.test(a)}static isAlphanumeric(a){return Dt.ALPHANUMERIC_REGEX.test(a)}getData(){return this.bitData.slice()}static getTotalBits(a,d){let h=0;for(const f of a){const m=f.mode.numCharCountBits(d);if(f.numChars>=1<<m)return 1/0;h+=4+m+f.bitData.length}return h}static toUtf8ByteArray(a){a=encodeURI(a);let d=[];for(let h=0;h<a.length;h++)a.charAt(h)!="%"?d.push(a.charCodeAt(h)):(d.push(parseInt(a.substring(h+1,h+3),16)),h+=2);return d}};s.NUMERIC_REGEX=/^[0-9]*$/,s.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,s.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let o=s;t.QrSegment=s})(Ms||(Ms={}));(t=>{(e=>{const n=class{constructor(i,s){this.ordinal=i,this.formatBits=s}};n.LOW=new n(0,1),n.MEDIUM=new n(1,0),n.QUARTILE=new n(2,3),n.HIGH=new n(3,2),e.Ecc=n})(t.QrCode||(t.QrCode={}))})(Ms||(Ms={}));(t=>{(e=>{const n=class{constructor(i,s){this.modeBits=i,this.numBitsCharCount=s}numCharCountBits(i){return this.numBitsCharCount[Math.floor((i+7)/17)]}};n.NUMERIC=new n(1,[10,12,14]),n.ALPHANUMERIC=new n(2,[9,11,13]),n.BYTE=new n(4,[8,16,16]),n.KANJI=new n(8,[8,10,12]),n.ECI=new n(7,[0,0,0]),e.Mode=n})(t.QrSegment||(t.QrSegment={}))})(Ms||(Ms={}));var yo=Ms;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var EM={L:yo.QrCode.Ecc.LOW,M:yo.QrCode.Ecc.MEDIUM,Q:yo.QrCode.Ecc.QUARTILE,H:yo.QrCode.Ecc.HIGH},EI=128,TI="L",II="#FFFFFF",bI="#000000",xI=!1,CI=1,TM=4,IM=0,bM=.1;function AI(t,e=0){const n=[];return t.forEach(function(r,i){let s=null;r.forEach(function(o,l){if(!o&&s!==null){n.push(`M${s+e} ${i+e}h${l-s}v1H${s+e}z`),s=null;return}if(l===r.length-1){if(!o)return;s===null?n.push(`M${l+e},${i+e} h1v1H${l+e}z`):n.push(`M${s+e},${i+e} h${l+1-s}v1H${s+e}z`);return}o&&s===null&&(s=l)})}),n.join("")}function NI(t,e){return t.slice().map((n,r)=>r<e.y||r>=e.y+e.h?n:n.map((i,s)=>s<e.x||s>=e.x+e.w?i:!1))}function xM(t,e,n,r){if(r==null)return null;const i=t.length+n*2,s=Math.floor(e*bM),o=i/e,l=(r.width||s)*o,a=(r.height||s)*o,d=r.x==null?t.length/2-l/2:r.x*o,h=r.y==null?t.length/2-a/2:r.y*o,f=r.opacity==null?1:r.opacity;let m=null;if(r.excavate){let S=Math.floor(d),_=Math.floor(h),A=Math.ceil(l+d-S),v=Math.ceil(a+h-_);m={x:S,y:_,w:A,h:v}}const g=r.crossOrigin;return{x:d,y:h,h:a,w:l,excavation:m,opacity:f,crossOrigin:g}}function CM(t,e){return e!=null?Math.max(Math.floor(e),0):t?TM:IM}function kI({value:t,level:e,minVersion:n,includeMargin:r,marginSize:i,imageSettings:s,size:o,boostLevel:l}){let a=We.useMemo(()=>{const S=(Array.isArray(t)?t:[t]).reduce((_,A)=>(_.push(...yo.QrSegment.makeSegments(A)),_),[]);return yo.QrCode.encodeSegments(S,EM[e],n,void 0,void 0,l)},[t,e,n,l]);const{cells:d,margin:h,numCells:f,calculatedImageSettings:m}=We.useMemo(()=>{let g=a.getModules();const S=CM(r,i),_=g.length+S*2,A=xM(g,o,S,s);return{cells:g,margin:S,numCells:_,calculatedImageSettings:A}},[a,o,s,r,i]);return{qrcode:a,margin:h,cells:d,numCells:f,calculatedImageSettings:m}}var AM=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}(),NM=We.forwardRef(function(e,n){const r=e,{value:i,size:s=EI,level:o=TI,bgColor:l=II,fgColor:a=bI,includeMargin:d=xI,minVersion:h=CI,boostLevel:f,marginSize:m,imageSettings:g}=r,_=Pm(r,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:A}=_,v=Pm(_,["style"]),w=g==null?void 0:g.src,b=We.useRef(null),j=We.useRef(null),M=We.useCallback(te=>{b.current=te,typeof n=="function"?n(te):n&&(n.current=te)},[n]),[U,x]=We.useState(!1),{margin:I,cells:R,numCells:E,calculatedImageSettings:T}=kI({value:i,level:o,minVersion:h,boostLevel:f,includeMargin:d,marginSize:m,imageSettings:g,size:s});We.useEffect(()=>{if(b.current!=null){const te=b.current,J=te.getContext("2d");if(!J)return;let ne=R;const ce=j.current,V=T!=null&&ce!==null&&ce.complete&&ce.naturalHeight!==0&&ce.naturalWidth!==0;V&&T.excavation!=null&&(ne=NI(R,T.excavation));const K=window.devicePixelRatio||1;te.height=te.width=s*K;const B=s/E*K;J.scale(B,B),J.fillStyle=l,J.fillRect(0,0,E,E),J.fillStyle=a,AM?J.fill(new Path2D(AI(ne,I))):R.forEach(function(X,$){X.forEach(function(Z,q){Z&&J.fillRect(q+I,$+I,1,1)})}),T&&(J.globalAlpha=T.opacity),V&&J.drawImage(ce,T.x+I,T.y+I,T.w,T.h)}}),We.useEffect(()=>{x(!1)},[w]);const k=km({height:s,width:s},A);let N=null;return w!=null&&(N=We.createElement("img",{src:w,key:w,style:{display:"none"},onLoad:()=>{x(!0)},ref:j,crossOrigin:T==null?void 0:T.crossOrigin})),We.createElement(We.Fragment,null,We.createElement("canvas",km({style:k,height:s,width:s,ref:M,role:"img"},v)),N)});NM.displayName="QRCodeCanvas";var PI=We.forwardRef(function(e,n){const r=e,{value:i,size:s=EI,level:o=TI,bgColor:l=II,fgColor:a=bI,includeMargin:d=xI,minVersion:h=CI,boostLevel:f,title:m,marginSize:g,imageSettings:S}=r,_=Pm(r,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:A,cells:v,numCells:w,calculatedImageSettings:b}=kI({value:i,level:o,minVersion:h,boostLevel:f,includeMargin:d,marginSize:g,imageSettings:S,size:s});let j=v,M=null;S!=null&&b!=null&&(b.excavation!=null&&(j=NI(v,b.excavation)),M=We.createElement("image",{href:S.src,height:b.h,width:b.w,x:b.x+A,y:b.y+A,preserveAspectRatio:"none",opacity:b.opacity,crossOrigin:b.crossOrigin}));const U=AI(j,A);return We.createElement("svg",km({height:s,width:s,viewBox:`0 0 ${w} ${w}`,ref:n,role:"img"},_),!!m&&We.createElement("title",null,m),We.createElement("path",{fill:l,d:`M0,0 h${w}v${w}H0z`,shapeRendering:"crispEdges"}),We.createElement("path",{fill:a,d:U,shapeRendering:"crispEdges"}),M)});PI.displayName="QRCodeSVG";function kM({open:t,onClose:e,memberId:n="",nickname:r="",firstName:i="",lastName:s=""}){if(C.useEffect(()=>{if(!t)return;function a(d){d.key==="Escape"&&e&&e()}return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[t,e]),!t)return null;const o=r||i||s||"Member",l=String(n||o);return u.jsx("div",{onClick:a=>{a.target===a.currentTarget&&e&&e()},style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:u.jsxs("div",{style:{width:"min(98vw, 820px)",boxSizing:"border-box",padding:20,background:"#fff",borderRadius:14,border:"1px solid var(--light-border)",boxShadow:"0 20px 60px rgba(0,0,0,.2)",overflow:"visible"},onClick:a=>a.stopPropagation(),children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12},children:[u.jsx("div",{style:{fontWeight:800,fontSize:18}}),u.jsx("button",{type:"button",className:"button",onClick:e,style:{background:"#eee",color:"#333"},children:""})]}),u.jsx("div",{style:{display:"flex",justifyContent:"center"},children:u.jsx("div",{style:{width:520,maxWidth:"78vw",aspectRatio:"1 / 1",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:u.jsxs("div",{style:{width:"100%",height:"100%",borderRadius:10,border:"6px solid var(--kusgan-magenta, #c51c8a)",boxSizing:"border-box",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative",background:"#fff"},children:[u.jsx("div",{style:{position:"absolute",top:10,left:"50%",transform:"translateX(-50%)",fontSize:16,color:"var(--kusgan-magenta, #c51c8a)",fontWeight:700},children:"kusgan"}),u.jsx("div",{style:{width:"72%",height:"72%",display:"flex",alignItems:"center",justifyContent:"center"},children:u.jsx(PI,{value:l,size:Math.min(700,Math.floor(window.innerWidth*.7))})}),u.jsx("div",{style:{position:"absolute",bottom:10,left:"50%",transform:"translateX(-50%)",fontSize:16,color:"#333",fontWeight:600},children:o})]})})})]})})}const{addProgressRow:PM,uploadMemberPhoto:RM}=Re,RI="Asia/Manila",DM=()=>new Intl.DateTimeFormat("en-CA",{timeZone:RI,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date),jM=t=>{var o,l,a;if(!t)return"-";let e;if(typeof t=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(t)){const[d,h,f]=t.split("-").map(Number);e=new Date(Date.UTC(d,h-1,f))}else e=t instanceof Date?t:new Date(t);if(isNaN(e))return"-";const n=new Intl.DateTimeFormat("en-US",{timeZone:RI,month:"short",day:"numeric",year:"numeric"}).formatToParts(e),r=((o=n.find(d=>d.type==="month"))==null?void 0:o.value)||"",i=((l=n.find(d=>d.type==="day"))==null?void 0:l.value)||"",s=((a=n.find(d=>d.type==="year"))==null?void 0:a.value)||"";return`${r}-${i}, ${s}`};function MM(t,e){if(!t||!e)return 1;const[n,r,i]=t.split("-").map(Number),[s,o,l]=e.split("-").map(Number),a=Date.UTC(n,r-1,i),d=Date.UTC(s,o-1,l),h=Math.floor((d-a)/864e5);return Math.max(1,h+1)}function OM({open:t,onClose:e,memberId:n,memberSinceYMD:r,onSaved:i,memberNick:s}){const o=DM(),l=C.useMemo(()=>MM(r,o),[r,o]),[a,d]=C.useState(""),[h,f]=C.useState(""),[m,g]=C.useState(""),[S,_]=C.useState(""),[A,v]=C.useState(""),[w,b]=C.useState(""),[j,M]=C.useState(""),[U,x]=C.useState(""),[I,R]=C.useState(""),[E,T]=C.useState(""),[k,N]=C.useState(""),[te,J]=C.useState(""),[ne,ce]=C.useState(""),[V,K]=C.useState(""),[B,X]=C.useState(""),[$,Z]=C.useState(""),[q,ae]=C.useState([]),D=We.useRef(null),[G,L]=C.useState(-1),[H,z]=C.useState(""),[se,ge]=C.useState(!1),O=C.useMemo(()=>{const re=Number(a)||0,de=(Number(h)||0)/100;return!re||!de?0:Math.round(re/(de*de)*10)/10},[a,h]);C.useMemo(()=>Math.round((Number(a)||0)*2.20462262185*10)/10,[a]),C.useMemo(()=>Math.round((Number(h)||0)/2.54*10)/10,[h]),C.useEffect(()=>{t&&(d(""),f(""),g(""),_(""),v(""),b(""),M(""),x(""),R(""),T(""),N(""),J(""),ce(""),K(""),X(""),Z(""),ae([]),L(-1),ge(!1))},[t]);const Q=async re=>{if(re)try{const de=String(n||"").toLowerCase(),ue=await RM(re,de),pe=typeof ue=="string"?ue:(ue==null?void 0:ue.url)||"";ae(De=>{const Ze=Array.isArray(De)?[...De]:[];for(;Ze.length<3;)Ze.push("");const Tt=G>=0&&G<3?G:Ze.findIndex(we=>!we);return Tt===-1||(Ze[Tt]=pe),Ze})}catch(de){const ue=(de==null?void 0:de.message)||"Failed to upload photo";z(ue);try{sn.emit("modal:error",{message:ue,source:"ProgressModal",error:String(de)})}catch{}}finally{L(-1)}},F=re=>{ae(de=>{const ue=Array.isArray(de)?[...de]:[];if(re<0||re>=3)return ue;if(ue.length<3)for(;ue.length<3;)ue.push("");return ue[re]="",ue})},oe=async re=>{var ue;if((ue=re==null?void 0:re.preventDefault)==null||ue.call(re),!n||se)return;ge(!0),z("");const de={MemberID:n,Date:o,No:`Day ${l}`,"Weight (kg)":a?String(a):"","Weight(kg)":a?String(a):"",WeightKg:a?String(a):"",Weight:a?String(a):"",BMI:O?String(O):"",MuscleMass:m?String(m):"",BodyFat:S?String(S):"",VisceralFat:A?String(A):"",Photo1URL:q[0]||"",Photo2URL:q[1]||"",Photo3URL:q[2]||"","Height (cm)":h?String(h):"","Height(cm)":h?String(h):"",HeightCm:h?String(h):"",Height:h?String(h):"",Chest:w?String(w):"",Waist:j?String(j):"",Hips:U?String(U):"",Shoulders:I?String(I):"",Arms:E?String(E):"",Forearms:k?String(k):"",Thighs:te?String(te):"",Calves:ne?String(ne):"",BloodPressure:V,"RestingHeart Rate":B,Comments:$};try{await PM(de),i==null||i(),e==null||e()}catch(pe){const De=(pe==null?void 0:pe.message)||"Failed to save progress entry";z(De);try{sn.emit("modal:error",{message:De,source:"ProgressModal",error:String(pe)})}catch{}}finally{ge(!1)}};return t?u.jsxs(ns,{open:t,onClose:e,title:"Progress Entry",width:1e3,children:[H&&u.jsx("div",{className:"small-error",style:{marginBottom:8},children:H}),u.jsxs("form",{onSubmit:oe,style:{width:"100%",padding:0,background:"transparent",border:"none",boxShadow:"none",overflow:"visible"},children:[u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12,marginBottom:12},children:[u.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[u.jsx("div",{style:{fontSize:14,fontStyle:"italic",color:"var(--muted)",display:"block",marginBottom:4},children:"Nickname"}),u.jsx("div",{style:{fontWeight:700,fontSize:18},children:s||n})]}),u.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[u.jsx("div",{style:{fontSize:14,fontStyle:"italic",color:"var(--muted)",display:"block",marginBottom:4},children:"Date"}),u.jsx("div",{style:{fontWeight:700,fontSize:18},children:jM(o)})]}),u.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[u.jsx("div",{style:{fontSize:14,fontStyle:"italic",color:"var(--muted)",display:"block",marginBottom:4},children:"No."}),u.jsx("div",{style:{fontWeight:700,fontSize:18},children:`Day ${l}`})]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:12},children:[u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Weight (kg)"}),u.jsx("input",{type:"number",step:"0.1",min:"0",value:a,onChange:re=>d(re.target.value)})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Height (cm)"}),u.jsx("input",{type:"number",step:"0.1",min:"0",value:h,onChange:re=>f(re.target.value)})]}),u.jsxs("div",{className:"field",children:[u.jsx("span",{className:"label",children:"BMI"}),u.jsx("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10,fontWeight:700},children:O||"-"})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Muscle Mass"}),u.jsx("input",{type:"number",step:"0.1",min:"0",value:m,onChange:re=>g(re.target.value)})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Body Fat (%)"}),u.jsx("input",{type:"number",step:"0.1",min:"0",value:S,onChange:re=>_(re.target.value)})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Visceral Fat"}),u.jsx("input",{type:"number",step:"0.1",min:"0",value:A,onChange:re=>v(re.target.value)})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Chest (cm)"}),u.jsx("input",{type:"number",step:"0.1",min:"0",value:w,onChange:re=>b(re.target.value)})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Waist (cm)"}),u.jsx("input",{type:"number",step:"0.1",min:"0",value:j,onChange:re=>M(re.target.value)})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Hips (cm)"}),u.jsx("input",{type:"number",step:"0.1",min:"0",value:U,onChange:re=>x(re.target.value)})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Shoulders (cm)"}),u.jsx("input",{type:"number",step:"0.1",min:"0",value:I,onChange:re=>R(re.target.value)})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Arms (cm)"}),u.jsx("input",{type:"number",step:"0.1",min:"0",value:E,onChange:re=>T(re.target.value)})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Forearms (cm)"}),u.jsx("input",{type:"number",step:"0.1",min:"0",value:k,onChange:re=>N(re.target.value)})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Thighs (cm)"}),u.jsx("input",{type:"number",step:"0.1",min:"0",value:te,onChange:re=>J(re.target.value)})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Calves (cm)"}),u.jsx("input",{type:"number",step:"0.1",min:"0",value:ne,onChange:re=>ce(re.target.value)})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Blood Pressure"}),u.jsx("input",{placeholder:"120/80",value:V,onChange:re=>K(re.target.value)})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Resting Heart Rate"}),u.jsx("input",{type:"number",step:"1",min:"0",value:B,onChange:re=>X(re.target.value)})]}),u.jsx("div",{})]}),u.jsxs("div",{style:{marginTop:12},children:[u.jsx("div",{className:"label",style:{marginBottom:6},children:"Photos (max 3)"}),u.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:12},children:[0,1,2].map(re=>{const de=q[re]||"";return u.jsxs("div",{style:{position:"relative"},children:[u.jsx("div",{onClick:()=>{},style:{position:"relative",width:"100%",height:0,paddingTop:"133.333%",borderRadius:8,border:de?"1px solid #e5e7eb":"1px dashed #e5e7eb",cursor:"default",overflow:"hidden",background:de?"#fff":"#fafafa",opacity:.65},children:de?u.jsx("img",{src:de,alt:`Photo ${re+1}`,style:{position:"absolute",inset:0,width:"100%",height:"100%",objectFit:"cover"}}):u.jsx("div",{style:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",color:"#999"},children:"Photo disabled"})}),de&&u.jsx("button",{type:"button","aria-label":"Remove",onClick:()=>F(re),style:{position:"absolute",top:6,right:6,background:"rgba(0,0,0,.55)",color:"#fff",borderRadius:6,padding:"4px 6px",border:0},children:""})]},re)})})]}),u.jsx("input",{ref:D,type:"file",accept:"image/*",style:{display:"none"},onChange:re=>{var ue;const de=(ue=re.target.files)==null?void 0:ue[0];de&&Q(de)}}),u.jsxs("div",{className:"field",style:{marginTop:12},children:[u.jsx("span",{className:"label",children:"Comments"}),u.jsx("textarea",{rows:4,value:$,onChange:re=>Z(re.target.value),style:{width:"100%",borderRadius:8,border:"1px solid #e5e7eb",padding:12,fontFamily:"inherit",resize:"vertical",fontSize:16}})]}),u.jsxs("div",{style:{marginTop:12,display:"flex",gap:10,justifyContent:"flex-end"},children:[u.jsx("button",{type:"button",className:"back-btn",onClick:e,style:{background:"#e5e7eb",color:"#111",fontWeight:700},children:"Cancel"}),u.jsx("button",{type:"submit",className:"primary-btn",disabled:se,children:se?"Saving...":" Save Progress"})]})]})]}):null}const LM=(t="")=>{const e=String(t||"").match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^\/&#?]+)/);return e&&e[1]?e[1]:""},VM=(t="")=>{const e=String(t||"");if(/googleusercontent\.com\//.test(e))return e;const n=LM(e);return n?`https://drive.google.com/thumbnail?id=${n}&sz=w1000`:e},xt=(t,e=[])=>{if(!t)return"";for(const n of e){if(Object.prototype.hasOwnProperty.call(t,n))return t[n];const r=Object.keys(t).find(i=>i.toLowerCase().replace(/\s+/g,"")===n.toLowerCase().replace(/\s+/g,""));if(r)return t[r]}return""};function FM({open:t,onClose:e,row:n,memberNick:r}){if(!t)return null;const i=n||{},s=xt(i,["MemberID","memberid","member_id","id"]),o=xt(i,["Date","date","recorded","log_date","timestamp"]),l=xt(i,["No","no","entry_no","seq","number"]),a=xt(i,["Weight (kg)","Weight(kg)","WeightKg","Weight (lbs)","Weight(lbs)","Weight","Weight_lbs","weight","weight_lbs","weight_(lbs)"]),d=xt(i,["BMI","bmi"]),h=xt(i,["Height (cm)","Height(cm)","HeightCm","Height (inches)","Height(inches)","Height_in","height_in","height_inches"]),f=xt(i,["MuscleMass","muscle_mass","muscle","Muscle"]),m=xt(i,["BodyFat","body_fat","bf"]),g=xt(i,["VisceralFat","visceral_fat"]),S=xt(i,["Chest"]),_=xt(i,["Waist"]),A=xt(i,["Hips"]),v=xt(i,["Shoulders"]),w=xt(i,["Arms"]),b=xt(i,["Forearms"]),j=xt(i,["Thighs"]),M=xt(i,["Calves"]),U=xt(i,["BloodPressure","blood_pressure"]),x=xt(i,["RestingHeart Rate","RestingHeartRate","resting_heart_rate"]),I=xt(i,["Comments","comments","notes"]),R=xt(i,["Photo1URL","Photo1","photo1","photo_url","photo"]),E=xt(i,["Photo2URL","Photo2","photo2"]),T=xt(i,["Photo3URL","Photo3","photo3"]);return u.jsxs(ns,{open:t,onClose:e,title:"Progress Details",width:1e3,children:[u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12,marginBottom:12},children:[u.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[u.jsx("span",{style:{fontSize:14,fontStyle:"italic",color:"var(--muted)",display:"block",marginBottom:4},children:"Nickname"}),u.jsx("div",{style:{fontWeight:700,fontSize:18},children:r||s||"-"})]}),u.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[u.jsx("span",{style:{fontSize:14,fontStyle:"italic",color:"var(--muted)",display:"block",marginBottom:4},children:"Date"}),u.jsx("div",{style:{fontWeight:700,fontSize:18},children:BM(o)||"-"})]}),u.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[u.jsx("span",{style:{fontSize:14,fontStyle:"italic",color:"var(--muted)",display:"block",marginBottom:4},children:"No."}),u.jsx("div",{style:{fontWeight:700,fontSize:18},children:l||"-"})]})]}),u.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:12},children:[["Weight (kg)",a],["Height (cm)",h],["BMI",d],["Muscle Mass (%)",f],["Body Fat (%)",m],["Visceral Fat (%)",g],["Chest (cm)",S],["Waist (cm)",_],["Hips (cm)",A],["Shoulders (cm)",v],["Arms (cm)",w],["Forearms (cm)",b],["Thighs (cm)",j],["Calves (cm)",M],["Blood Pressure (mmHg)",U],["Resting Heart Rate (bpm)",x]].map(([k,N])=>u.jsxs("div",{className:"field",children:[u.jsx("span",{className:"label",style:{display:"block",marginBottom:6},children:k}),u.jsx("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10,fontWeight:700,fontSize:18},children:!N||String(N).trim()==="0"?"-":String(N)})]},k))}),u.jsxs("div",{className:"field",style:{marginTop:12},children:[u.jsx("span",{className:"label",children:"Comments"}),u.jsx("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:12,fontSize:16,minHeight:72},children:I?String(I):"-"})]}),u.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:12,marginTop:12},children:[R,E,T].map((k,N)=>u.jsx("div",{style:{position:"relative"},children:u.jsx("div",{style:{position:"relative",width:"100%",height:0,paddingTop:"133.333%",borderRadius:8,border:k?"1px solid #e5e7eb":"1px dashed #e5e7eb",overflow:"hidden"},children:k?u.jsx("img",{src:VM(k),alt:`Photo ${N+1}`,style:{position:"absolute",inset:0,width:"100%",height:"100%",objectFit:"cover"}}):u.jsx("div",{style:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",color:"#999"},children:"No photo"})})},N))})]})}const UM="Asia/Manila";function BM(t){var o,l,a;if(!t)return"";let e;if(typeof t=="string")if(/^\d{4}-\d{2}-\d{2}$/.test(t)){const[d,h,f]=t.split("-").map(Number);e=new Date(Date.UTC(d,h-1,f))}else{const d=new Date(t);isNaN(d)||(e=d)}else t instanceof Date&&(e=t);if(!e||isNaN(e))return String(t);const n=new Intl.DateTimeFormat("en-US",{timeZone:UM,month:"short",day:"numeric",year:"numeric"}).formatToParts(e),r=((o=n.find(d=>d.type==="month"))==null?void 0:o.value)||"",i=((l=n.find(d=>d.type==="day"))==null?void 0:l.value)||"",s=((a=n.find(d=>d.type==="year"))==null?void 0:a.value)||"";return`${r}-${i}, ${s}`}function DI({width:t="100%",height:e=200}){return u.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-start"},children:[u.jsx("div",{style:{width:150,height:200,borderRadius:12,background:"#f3f4f6",boxShadow:"inset 0 0 0 1px rgba(0,0,0,0.02)"}}),u.jsxs("div",{style:{flex:1},children:[u.jsx("div",{style:{height:22,width:"60%",background:"#f3f4f6",borderRadius:6,marginBottom:8}}),u.jsx("div",{style:{height:18,width:"40%",background:"#f3f4f6",borderRadius:6,marginBottom:14}}),u.jsx("div",{style:{height:12,width:"80%",background:"#f3f4f6",borderRadius:6,marginBottom:6}}),u.jsx("div",{style:{height:12,width:"70%",background:"#f3f4f6",borderRadius:6,marginBottom:6}}),u.jsx("div",{style:{height:12,width:"50%",background:"#f3f4f6",borderRadius:6,marginTop:10}})]})]})}function Ud({text:t="Refreshing",show:e=!0}){return e?u.jsxs("span",{className:"refresh-badge",role:"status","aria-live":"polite",children:[u.jsx("span",{className:"refresh-spinner","aria-hidden":!0}),u.jsx("span",{style:{marginLeft:8},children:t})]}):null}const An=(t,e)=>e.map(n=>t[n]).find(n=>n!==void 0&&n!==""),vw=t=>{if(!t&&t!==0)return null;try{if(t&&typeof t.toDate=="function")return t.toDate()}catch{}if(t&&typeof t.seconds=="number")return new Date(t.seconds*1e3);if(t instanceof Date)return t;const e=new Date(t);return isNaN(e)?null:e},$M="Asia/Manila",kc=t=>{var o,l,a;if(!t)return"-";const e=t instanceof Date?t:new Date(t);if(isNaN(e))return"-";const n=new Intl.DateTimeFormat("en-US",{timeZone:$M,month:"short",day:"numeric",year:"numeric"}).formatToParts(e),r=((o=n.find(d=>d.type==="month"))==null?void 0:o.value)||"",i=((l=n.find(d=>d.type==="day"))==null?void 0:l.value)||"",s=((a=n.find(d=>d.type==="year"))==null?void 0:a.value)||"";return`${r}-${i}, ${s}`},_r=t=>t==null||String(t).trim()===""?"-":String(t),ja=t=>{const n=String(t||"").match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return n&&n[1]?n[1]:""},zM=t=>{const e=String(t||"");if(!e)return"";const n=e.match(/https?:\/\/[^\s}]+/);if(n){const s=n[0];if(/googleusercontent\.com\//.test(s))return s;const o=s.match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^\/&?#]+)/);return o&&o[1]?`https://drive.google.com/uc?export=view&id=${o[1]}`:s}if(/googleusercontent\.com\//.test(e))return e;const r=e.match(/\/file\/d\/([^/]+)/)||e.match(/[?&]id=([^&]+)/)||e.match(/\/uc\?[^#]*id=([^&]+)/),i=r?r[1]:"";return i?`https://drive.google.com/uc?export=view&id=${i}`:e},_w=t=>{const e=String(t||"");if(/googleusercontent\.com\//.test(e))return e;const n=ja(e);return n?`https://drive.google.com/thumbnail?id=${n}&sz=w1000`:e};function HM({member:t,status:e={},isRefreshing:n=!1,onEdit:r=()=>{},onAddPayment:i=()=>{},onShowQr:s=()=>{},onShowProgress:o=()=>{},onCheckIn:l=()=>{}}){const[a,d]=C.useState(!1),h=An(t||{},["lastname","last_name"]),f=An(t||{},["firstname","first_name"]),m=An(t||{},["middlename","middle_name"]),g=An(t||{},["gender"]),S=An(t||{},["birthday","birth_date","dob"]),_=vw(S);An(t||{},["nick_name","nickname"]);const A=An(t||{},["street"]),v=An(t||{},["brgy","barangay"]),w=An(t||{},["municipality","city"]),b=An(t||{},["email"]),j=An(t||{},["mobile","phone"]),M=vw(An(t||{},["member_since","membersince","join_date"]));String(An(t||{},["memberid","member_id","id"])||"").trim();const U=An(t||{},["photourl","photo_url","photo"]),x=zM(U);_w(x),C.useEffect(()=>{d(!1)},[x]);const I=_?new Date().getFullYear()-_.getFullYear()-(new Date().getMonth()<_.getMonth()||new Date().getMonth()===_.getMonth()&&new Date().getDate()<_.getDate()?1:0):"-";return u.jsxs("div",{className:"member-card",style:{marginTop:12},children:[u.jsx("div",{className:"member-photo",children:u.jsx("div",{className:"photo-box",children:x&&!a?u.jsx("img",{src:_w(x),alt:"photo",onError:R=>{const E=R.currentTarget;if(!E.dataset.retry&&U){E.dataset.retry="1";const T=ja(U)||ja(x);T?E.src=`https://drive.google.com/uc?export=view&id=${T}`:E.style.display="none"}else if(E.dataset.retry==="1"){E.dataset.retry="2";const T=ja(U)||ja(x);T?E.src=`https://drive.google.com/uc?export=download&id=${T}`:d(!0)}else d(!0)}}):u.jsx("div",{style:{color:"var(--muted)",padding:16},children:"No photo"})})}),u.jsxs("div",{className:"member-info",children:[u.jsxs("div",{className:"member-grid",children:[u.jsxs("div",{className:"cell lastname",children:[u.jsx("div",{className:"label",children:"Last Name"}),u.jsx("div",{className:"value",children:_r(h)})]}),u.jsxs("div",{className:"cell firstname",children:[u.jsx("div",{className:"label",children:"First Name"}),u.jsx("div",{className:"value",children:_r(f)})]}),u.jsxs("div",{className:"cell middlename",children:[u.jsx("div",{className:"label",children:"Middle Name"}),u.jsx("div",{className:"value",children:_r(m)})]}),u.jsxs("div",{className:"cell gender",children:[u.jsx("div",{className:"label",children:"Gender"}),u.jsx("div",{className:"value",children:_r(g)})]}),u.jsxs("div",{className:"cell birthday",children:[u.jsx("div",{className:"label",children:"Birthday"}),u.jsx("div",{className:"value",children:kc(_)})]}),u.jsxs("div",{className:"cell age",children:[u.jsx("div",{className:"label",children:"Age"}),u.jsx("div",{className:"value",children:_r(I)})]}),u.jsxs("div",{className:"cell street",children:[u.jsx("div",{className:"label",children:"House No. / Street Name / Sitio"}),u.jsx("div",{className:"value",children:_r(A)})]}),u.jsxs("div",{className:"cell brgy",children:[u.jsx("div",{className:"label",children:"Brgy."}),u.jsx("div",{className:"value",children:_r(v)})]}),u.jsxs("div",{className:"cell municipality",children:[u.jsx("div",{className:"label",children:"Municipality / City"}),u.jsx("div",{className:"value",children:_r(w)})]}),u.jsxs("div",{className:"cell nickname",children:[u.jsx("div",{className:"label",children:"Member Since"}),u.jsx("div",{className:"value",children:kc(M)})]}),u.jsxs("div",{className:"cell mobile",children:[u.jsx("div",{className:"label",children:"Mobile"}),u.jsx("div",{className:"value",children:_r(j)})]}),u.jsxs("div",{className:"cell email",children:[u.jsx("div",{className:"label",children:"Email"}),u.jsx("div",{className:"value",children:_r(b)})]})]}),u.jsxs("div",{className:"status-tiles",children:[u.jsxs("div",{className:`status-tile ${e.membershipState==null?"none":e.membershipState}`,children:[u.jsx("div",{className:"title",children:"Gym Membership"}),u.jsxs("div",{style:{marginBottom:10},children:[e.membershipState==="active"&&u.jsx("span",{className:"pill ok",children:"Active"}),e.membershipState==="expired"&&u.jsx("span",{className:"pill bad",children:"Expired"}),(!e.membershipState||e.membershipState==="none")&&u.jsx("span",{className:"pill",style:{background:"#fff",color:"#555",borderColor:"#ddd"},children:"None"})]}),u.jsx("div",{className:"label",children:"Valid until"}),u.jsx("div",{className:"value",children:kc(e.membershipEnd)})]}),u.jsxs("div",{className:`status-tile ${e.coachEnd?e.coachActive?"active":"expired":"none"}`,children:[u.jsx("div",{className:"title",children:"Coach Subscription"}),u.jsxs("div",{style:{marginBottom:10},children:[e.coachActive&&u.jsx("span",{className:"pill ok",children:"Active"}),e.coachEnd&&!e.coachActive&&u.jsx("span",{className:"pill bad",children:"Expired"}),!e.coachEnd&&u.jsx("span",{className:"pill",style:{background:"#fff",color:"#555",borderColor:"#ddd"},children:"None"})]}),u.jsx("div",{className:"label",children:"Valid until"}),u.jsx("div",{className:"value",children:kc(e.coachEnd)})]})]}),u.jsxs("div",{className:"member-actions",children:[u.jsx("button",{className:"primary-btn",onClick:()=>r(),title:"Edit member details",children:" Edit"}),u.jsx("button",{className:"primary-btn",onClick:()=>i(),title:"Manage payments",children:" Add Payment"}),u.jsx("button",{className:"primary-btn",onClick:()=>s(),title:"Show QR code for this member",children:" QR Code"}),u.jsx("button",{className:"primary-btn",onClick:()=>o(),title:"Track or view progress",children:" Progress"})]})]})]})}const WM=t=>String(t||"").trim().toLowerCase().replace(/\s+/g,"_"),di=(t,e)=>e.map(n=>(t||{})[n]).find(n=>n!==void 0&&n!==""),Ia=t=>{if(!t&&t!==0)return null;try{if(t&&typeof t.toDate=="function")return t.toDate()}catch{}if(t&&typeof t.seconds=="number")return new Date(t.seconds*1e3);if(t instanceof Date)return t;if(typeof t=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(t))try{return new Date(`${t}T00:00:00+08:00`)}catch{}const e=new Date(t);return isNaN(e)?null:e},zh=t=>{const e={};return Object.entries(t||{}).forEach(([n,r])=>{e[WM(n)]=r}),e};function Zr(t,e,n=[]){const r=v=>{if(!v)return null;const w=v instanceof Date?v:Ia(v);return w?new Intl.DateTimeFormat("en-CA",{timeZone:"Asia/Manila",year:"numeric",month:"2-digit",day:"2-digit"}).format(w):null},i=r(new Date);let s=null,o=null,l=null,a=null;const d=new Map,h=Array.isArray(n)?n:[],f=v=>{const w=String(v??"").trim().toLowerCase();return w==="yes"||w==="y"||w==="true"||w==="1"},m=(v,w)=>{for(const b of w){if(v&&Object.prototype.hasOwnProperty.call(v,b))return v[b];const j=Object.keys(v||{}).find(M=>M.toLowerCase().replace(/\s+/g,"")===b.toLowerCase().replace(/\s+/g,""));if(j)return v[j]}};h.forEach(v=>{const w=String(m(v,["Particulars"])||"").trim();if(!w)return;const b=f(m(v,["Gym membership","Gym Membership","GymMembership","Membership"])),j=f(m(v,["Coach subscription","Coach Subscription","CoachSubscription","Coach"]));d.set(String(w).toLowerCase(),{gym:b,coach:j})});let g=null;if(typeof e=="string")g=String(e||"").trim().toLowerCase();else if(e&&typeof e=="object"){const v=zh(e);g=String(di(v,["memberid","member_id","id","member_id_"])||"").trim().toLowerCase()}const S=Array.isArray(t)?t:[];for(const v of S){const w=zh(v);if(g){const ne=String(di(w,["memberid","member_id","id","member_id_"])||"").trim().toLowerCase();if(!ne||ne!==g)continue}const b=String(di(w,["particulars","type","item","category","product","paymentfor","plan","description"])||"").trim(),j=di(w,["gymvaliduntil","gym_valid_until","gym_until","enddate","end_date","valid_until","expiry","expires","until","end"]),M=di(w,["coachvaliduntil","coach_valid_until","coach_until","coach_end","coachend"]),U=di(w,["enddate","end_date","valid_until","expiry","expires","until","end"]),x=Ia(j),I=Ia(M),R=Ia(U),E=r(x),T=r(I),k=r(R),N=d.get(String(b).toLowerCase())||{gym:null,coach:null},te=N.coach===!0||N.coach===null&&/coach|trainer|pt/i.test(b),J=N.gym===!0||N.gym===null&&/member|gym/i.test(b);E?(!l||E>l)&&(l=E,s=x):J&&k&&(!l||k>l)&&(l=k,s=R),T?(!a||T>a)&&(a=T,o=I):te&&k&&(!a||k>a)&&(a=k,o=R)}if((!s||s==null)&&e&&typeof e=="object"){const v=zh(e);if(String(di(v,["membershipstate","membership_state","membership","status"])||"").trim().toLowerCase()==="active")return{membershipEnd:s,membershipState:"active",coachEnd:o,coachActive:!!(a&&a>=i)};const b=di(v,["membershipend","membership_end","membershipEnd","membership_end","gymvaliduntil","gym_valid_until","gym_until","enddate","end_date","valid_until","expiry","expires","until","end","gym_valid","gym_validity","gymvalid"]);if(b){const j=Ia(b),M=r(j);j&&!isNaN(j)&&(!l||M>l)&&(l=M,s=j)}}let _=null;l&&(_=l>=i?"active":"expired");let A=!1;return a&&(A=a>=i),{membershipEnd:s,membershipState:_,coachEnd:o,coachActive:A}}const{fetchMemberBundle:qM,fetchPricing:GM,gymQuickAppend:ww,gymClockOut:QM,upsertGymEntry:KM,gymClockIn:YM,fetchMemberByIdFresh:XM}=Re,ro="Asia/Manila",Hh=t=>{var o,l,a;if(!t)return"-";const e=t instanceof Date?t:new Date(t);if(isNaN(e))return"-";const n=new Intl.DateTimeFormat("en-US",{timeZone:ro,month:"short",day:"numeric",year:"numeric"}).formatToParts(e),r=((o=n.find(d=>d.type==="month"))==null?void 0:o.value)||"",i=((l=n.find(d=>d.type==="day"))==null?void 0:l.value)||"",s=((a=n.find(d=>d.type==="year"))==null?void 0:a.value)||"";return`${r}-${i}, ${s}`},jI=t=>{const n=String(t||"").match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return n&&n[1]?n[1]:""},JM=t=>{const e=String(t||"");if(!e)return"";const n=e.match(/https?:\/\/[^\s}]+/);if(n){const i=n[0];if(/googleusercontent\.com\//.test(i))return i;const s=i.match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return s&&s[1]?`https://drive.google.com/uc?export=view&id=${s[1]}`:i}if(/googleusercontent\.com\//.test(e))return e;const r=jI(e);return r?`https://drive.google.com/uc?export=view&id=${r}`:e},ZM=t=>{const e=String(t||"");if(/googleusercontent\.com\//.test(e))return e;const n=jI(e);return n?`https://drive.google.com/thumbnail?id=${n}&sz=w1000`:e};function Bd({open:t,onClose:e,memberId:n,initialEntry:r=null,onSuccess:i,status:s=null,mode:o=null,bundleOverride:l=null,pricingOverride:a=null}){const[d,h]=C.useState(null),[f,m]=C.useState([]),[g,S]=C.useState(null),[_,A]=C.useState(!1),[v,w]=C.useState(""),[b,j]=C.useState(""),[M,U]=C.useState(""),[x,I]=C.useState(""),[R,E]=C.useState(!1),[T,k]=C.useState(!1),N=["Coach Elmer","Coach Jojo","None"],te=["Full body","Upper body","Lower body","Chest","Other"];C.useEffect(()=>{let V=!0;if(!(!t||!n))return(async()=>{A(!0);try{if(l&&String(l.member&&(l.member.MemberID||l.member.memberId||l.member.id)||"").trim()===String(n).trim()){const H=l,z=(a==null?void 0:a.rows)||(a==null?void 0:a.data)||a||[];h(H),m(Array.isArray(z)?z:(z==null?void 0:z.rows)||(z==null?void 0:z.data)||[]);const se=s||Zr((H==null?void 0:H.payments)||[],n,Array.isArray(z)?z:(z==null?void 0:z.rows)||(z==null?void 0:z.data)||[]);S(se),A(!1);return}console.debug("[CheckInConfirmModal] loading bundle for",n);const[K,B]=await Promise.all([qM(n),GM()]);if(!V)return;if(K&&!K.member)try{console.debug("[CheckInConfirmModal] bundle missing member, trying fetchMemberByIdFresh",n);const H=await XM(n);H&&(K.member=H)}catch(H){console.debug("[CheckInConfirmModal] fetchMemberByIdFresh fallback failed",H)}h(K);const X=(B==null?void 0:B.rows)||(B==null?void 0:B.data)||[];m(X);const $=s||Zr((K==null?void 0:K.payments)||[],n,X);S($);const Z=new Intl.DateTimeFormat("en-CA",{timeZone:ro,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date),ae=((K==null?void 0:K.gymEntries)||[]).filter(H=>{const z=(H==null?void 0:H.Date)||(H==null?void 0:H.date);if(!z)return!1;const se=new Date(z);return new Intl.DateTimeFormat("en-CA",{timeZone:ro,year:"numeric",month:"2-digit",day:"2-digit"}).format(se)===Z}).find(H=>!String((H==null?void 0:H.TimeOut)||(H==null?void 0:H.timeout)||"").trim());let D=!1;if(r){const H=r.Date||r.date||"";if(H){const z=new Date(H);new Intl.DateTimeFormat("en-CA",{timeZone:ro,year:"numeric",month:"2-digit",day:"2-digit"}).format(z)===Z&&!String(r.TimeOut||"").trim()&&(D=!0)}}let G=!!ae||D;o==="in"&&(G=!1),o==="out"&&(G=!0),E(G);const L=D?r:ae||null;if(G&&L){const H=L||{};w(String(H.Workouts??H.workouts??H.Done??"").trim()),j(String(H.Comments??H.comments??H.Notes??"").trim()),U(String(H.Coach??H.coach??"")||""),I(String(H.Focus??H.focus??"")||"")}else w(""),j(""),U(""),I("")}catch(K){try{console.debug("[CheckInConfirmModal] load error",K),sn.emit("modal:error",{message:"Failed to load check-in data",source:"CheckInConfirmModal",error:String(K)})}catch{}}finally{V&&A(!1)}})(),()=>{V=!1}},[t,n,r==null?void 0:r.rowNumber,r==null?void 0:r.Date,r==null?void 0:r.TimeIn,s,l,a]);const J=(d==null?void 0:d.member)||null,ne=async()=>{if(n){k(!0);try{if(r){const V=r.Date||r.date||"",K=new Intl.DateTimeFormat("en-CA",{timeZone:ro,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date),B=V?new Date(V):null,X=B?new Intl.DateTimeFormat("en-CA",{timeZone:ro,year:"numeric",month:"2-digit",day:"2-digit"}).format(B):"",$=String(r.TimeOut||r.timeout||"").trim();if(X===K&&!$){const Z=new Date().toISOString();try{const q=r.TimeIn||r.Timein||r.timeIn||r.timein||null,ae=r.Date||r.date||null,D={memberId:n,timeOut:Z,Workouts:v,Comments:b};try{console.debug("[CheckInConfirmModal] upsert payload",D)}catch{}g!=null&&g.coachActive&&(M&&M!=="None"&&(D.Coach=M),x&&(D.Focus=x)),q&&(D.TimeIn=q),ae&&(D.Date=ae),r.rowNumber&&(D.rowNumber=r.rowNumber);const G=await KM(D);try{console.debug("[CheckInConfirmModal] upsertGymEntry res",G)}catch{}try{sn.emit("gymEntry:added",{MemberID:n,...G||{},Workouts:v,Comments:b})}catch{}k(!1),i&&i(),e&&e();return}catch(q){try{sn.emit("modal:error",{message:"Failed to upsert gym entry",source:"CheckInConfirmModal",error:String(q)})}catch{}}}}try{const V={wantsOut:!0,Workouts:v,Comments:b};if(g!=null&&g.coachActive&&(M&&M!=="None"&&(V.Coach=M),x&&(V.Focus=x)),r){const K=r.TimeIn||r.Timein||r.timeIn||r.timein||null,B=r.Date||r.date||null;K&&(V.TimeIn=K),B&&(V.Date=B),r.rowNumber&&(V.rowNumber=r.rowNumber)}try{console.debug("[CheckInConfirmModal] gymQuickAppend extra",V)}catch{}await ww(n,V)}catch(V){const K={Workouts:v,Comments:b};r&&(r.TimeIn&&(K.TimeIn=r.TimeIn),r.Date&&(K.Date=r.Date),r.rowNumber&&(K.rowNumber=r.rowNumber)),g!=null&&g.coachActive&&(M&&M!=="None"&&(K.Coach=M),x&&(K.Focus=x));try{console.debug("[CheckInConfirmModal] gymQuickAppend failed, falling back to gymClockOut",K,V)}catch{}await QM(n,K)}try{sn.emit("gymEntry:added",{MemberID:n,Workouts:v,Comments:b})}catch{}k(!1),i&&i(),e&&e()}catch(V){try{sn.emit("modal:error",{message:"Checkout failed",source:"CheckInConfirmModal",error:String(V)})}catch{}k(!1)}}},ce=async()=>{if(n){k(!0);try{const V={Workouts:v,Comments:b};g!=null&&g.coachActive&&(M&&M!=="None"&&(V.Coach=M),x&&(V.Focus=x));try{await ww(n,V)}catch{await YM(n,V)}k(!1),i&&i(),e&&e()}catch(V){try{sn.emit("modal:error",{message:"Checkin failed",source:"CheckInConfirmModal",error:String(V)})}catch{}k(!1)}}};return t?u.jsx(ns,{open:t,onClose:e,width:720,noInternalScroll:!0,children:_?u.jsx("div",{style:{padding:24},children:"Loading"}):J?u.jsxs(u.Fragment,{children:[u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"auto 1fr",gap:16,alignItems:"center"},children:[u.jsx("div",{style:{width:150,height:200,borderRadius:12,overflow:"hidden",border:"1px solid #e7e8ef",background:"#fafbff"},children:J.PhotoURL||J.Photo?u.jsx("img",{src:ZM(JM(J.PhotoURL||J.Photo)),alt:"Member",style:{width:"100%",height:"100%",objectFit:"cover"}}):u.jsx("div",{style:{display:"flex",width:"100%",height:"100%",alignItems:"center",justifyContent:"center",color:"#999"},children:"No Photo"})}),u.jsxs("div",{children:[u.jsx("div",{style:{fontWeight:900,fontSize:28,lineHeight:1.1},children:J.NickName||J.Nickname||"-"}),u.jsx("div",{style:{fontWeight:700,fontSize:18,color:"#444",marginTop:4},children:[J.FirstName,J.LastName].filter(Boolean).join(" ")||"-"}),u.jsx("div",{style:{fontStyle:"italic",color:"#666",marginTop:8},children:"Member Since"}),u.jsx("div",{style:{fontWeight:800,fontSize:16},children:Hh(J.MemberSince||J["Member Since"]||J.Joined||J["Join Date"])})]})]}),u.jsxs("div",{className:"status-tiles",style:{marginTop:14},children:[u.jsxs("div",{className:`status-tile ${(g==null?void 0:g.membershipState)==null?"none":g.membershipState}`,children:[u.jsx("div",{className:"title",children:"Gym Membership"}),u.jsx("div",{style:{marginBottom:10},children:(g==null?void 0:g.membershipState)==="active"?u.jsx("span",{className:"pill ok",children:"Active"}):(g==null?void 0:g.membershipState)==="expired"?u.jsx("span",{className:"pill bad",children:"Expired"}):u.jsx("span",{className:"pill",children:"None"})}),u.jsx("div",{className:"label",children:"Valid until"}),u.jsx("div",{className:"value",children:Hh(g==null?void 0:g.membershipEnd)})]}),u.jsxs("div",{className:`status-tile ${g!=null&&g.coachActive?"active":g!=null&&g.coachEnd?"expired":"none"}`,children:[u.jsx("div",{className:"title",children:"Coach Subscription"}),u.jsx("div",{style:{marginBottom:10},children:g!=null&&g.coachActive?u.jsx("span",{className:"pill ok",children:"Active"}):g!=null&&g.coachEnd?u.jsx("span",{className:"pill bad",children:"Expired"}):u.jsx("span",{className:"pill",children:"None"})}),u.jsx("div",{className:"label",children:"Valid until"}),u.jsx("div",{className:"value",children:Hh(g==null?void 0:g.coachEnd)})]})]}),R&&u.jsx("div",{children:g!=null&&g.coachActive?u.jsxs(u.Fragment,{children:[u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:14},children:[u.jsxs("div",{className:"field",children:[u.jsx("label",{className:"label",children:"Coach"}),u.jsxs("select",{value:M,onChange:V=>U(V.target.value),children:[u.jsx("option",{value:"",children:"(Select)"}),N.map(V=>u.jsx("option",{value:V,children:V},V))]})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{className:"label",children:"Workout Focus"}),u.jsxs("select",{value:x,onChange:V=>I(V.target.value),children:[u.jsx("option",{value:"",children:"(none)"}),te.map(V=>u.jsx("option",{value:V,children:V},V))]})]})]}),u.jsxs("div",{className:"field",style:{marginTop:16},children:[u.jsx("label",{className:"label",children:"Workouts Done"}),u.jsx("textarea",{value:v,onChange:V=>w(V.target.value),placeholder:"Describe workouts done (optional)",style:{width:"100%",minHeight:48,borderRadius:8,border:"1px solid #e7e8ef",padding:"8px 12px",fontSize:15,resize:"vertical"}})]})]}):u.jsxs("div",{className:"field",style:{marginTop:16},children:[u.jsx("label",{className:"label",children:"Workouts Done"}),u.jsx("textarea",{value:v,onChange:V=>w(V.target.value),placeholder:"Describe workouts done (optional)",style:{width:"100%",minHeight:48,borderRadius:8,border:"1px solid #e7e8ef",padding:"8px 12px",fontSize:15,resize:"vertical"}})]})}),!R&&u.jsx("div",{children:(g==null?void 0:g.coachActive)&&u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:14},children:[u.jsxs("div",{className:"field",children:[u.jsx("label",{className:"label",children:"Coach"}),u.jsxs("select",{value:M,onChange:V=>U(V.target.value),children:[u.jsx("option",{value:"",children:"(Select)"}),N.map(V=>u.jsx("option",{value:V,children:V},V))]})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{className:"label",children:"Workout Focus"}),u.jsxs("select",{value:x,onChange:V=>I(V.target.value),children:[u.jsx("option",{value:"",children:"(none)"}),te.map(V=>u.jsx("option",{value:V,children:V},V))]})]})]})}),u.jsxs("div",{className:"field",style:{marginTop:16},children:[u.jsx("label",{className:"label",children:"Comments"}),u.jsx("textarea",{value:b,onChange:V=>j(V.target.value),placeholder:"Add comments (optional)",style:{width:"100%",minHeight:48,borderRadius:8,border:"1px solid #e7e8ef",padding:"8px 12px",fontSize:15,resize:"vertical"}})]}),u.jsx("div",{style:{marginTop:12,color:"#b91c1c",fontSize:13},children:!R&&(g==null?void 0:g.membershipState)!=="active"&&u.jsx("div",{style:{marginBottom:8},children:"Cannot check in: gym membership is not active."})}),u.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:16},children:R?u.jsx("button",{className:"primary-btn",onClick:ne,disabled:T||(g==null?void 0:g.coachActive)&&(!M||!x),children:T?"Checking out":"Confirm Check-Out"}):u.jsx("button",{className:"primary-btn",onClick:ce,disabled:T||(g==null?void 0:g.membershipState)!=="active"||(g==null?void 0:g.coachActive)&&(!M||!x),children:T?"Checking in":"Confirm Check-In"})})]}):u.jsx("div",{style:{padding:24},children:"Member not found."})}):null}const{fetchMemberById:eO,fetchMemberByIdFresh:Wh}=Re,Ye=(t,e=[])=>{if(!t)return"";for(const n of e){if(Object.prototype.hasOwnProperty.call(t,n))return t[n];const r=Object.keys(t).find(i=>i.toLowerCase().replace(/\s+/g,"")===n.toLowerCase().replace(/\s+/g,""));if(r)return t[r]}return""};function Ug({open:t,onClose:e,row:n,onCheckout:r}){Yo();const[i,s]=We.useState(!1),[o,l]=We.useState(null),a=n&&n.raw?n.raw:n||{},d=Ye(a,["MemberID","memberid","member_id","id"]);We.useEffect(()=>{let M=!0;return(async()=>{try{if(!d)return;let U=await eO(d);if(!M)return;if(!U)try{const R=await(Wh==null?void 0:Wh(d));R&&(U=R)}catch{}if(!U){try{const R=Ye(a,["NickName","nickname","Nick","nick","Nick_Name","Nick Name"])||Ye(n,["NickName","nickname","Nick","nick","Nick_Name","Nick Name"]);if(R){l(String(R).trim());return}const E=Ye(a,["FirstName","firstname","first_name","first"])||Ye(n,["FirstName","firstname","first_name","first"]),T=Ye(a,["LastName","lastname","last_name","last"])||Ye(n,["LastName","lastname","last_name","last"]),k=(E||"").trim()||(T||"").trim()?`${(E||"").trim()} ${(T||"").trim()}`.trim():null;if(k){l(k);return}}catch{}return}const x=U._raw||U,I=Ye(x,["NickName","nickname","Nick","nick","Nick_Name","Nick Name"]);if(I)l(String(I).trim());else{const R=(U.firstname||U.firstName||U.FirstName||"").trim(),E=(U.lastname||U.lastName||U.LastName||"").trim(),T=R||E?`${R} ${E}`.trim():null;if(T&&l(T),!T)try{const k=Ye(a,["NickName","nickname","Nick","nick","Nick_Name","Nick Name"])||Ye(n,["NickName","nickname","Nick","nick","Nick_Name","Nick Name"]);if(k){l(String(k).trim());return}const N=Ye(a,["FirstName","firstname","first_name","first"])||Ye(n,["FirstName","firstname","first_name","first"]),te=Ye(a,["LastName","lastname","last_name","last"])||Ye(n,["LastName","lastname","last_name","last"]),J=(N||"").trim()||(te||"").trim()?`${(N||"").trim()} ${(te||"").trim()}`.trim():null;if(J){l(J);return}}catch{}}}catch{}})(),()=>{M=!1}},[d]);const h=Ye(a,["Date","date","visit_date","timestamp"])||Ye(n,["Date","date","visit_date","timestamp"]),f=Ye(a,["TimeIn","timein","time_in"])||Ye(n,["TimeIn","timein","time_in"]),m=Ye(a,["TimeOut","timeout","time_out"])||Ye(n,["TimeOut","timeout","time_out"]),g=Ye(a,["TotalHours","totalhours","NoOfHours","noofhours","hours"])||Ye(n,["TotalHours","totalhours","NoOfHours","noofhours","hours"]),S=Ye(a,["Coach","coach"])||Ye(n,["Coach","coach"]),_=Ye(a,["Focus","focus"])||Ye(n,["Focus","focus"]),A=Ye(a,["Workouts","workouts","done","workouts_done"])||Ye(n,["Workouts","workouts","done","workouts_done"]),v=Ye(a,["Comments","comments","notes"])||Ye(n,["Comments","comments","notes"]);Ye(a,["Photo","photo","photo_url","PhotoURL"])||Ye(n,["Photo","photo","photo_url","PhotoURL"]);const[w,b]=We.useState(!1);if(!t)return null;const j=()=>{if(typeof r=="function")try{r(n,{checkedOut:!0})}catch(M){console.error(M)}};return u.jsxs(u.Fragment,{children:[u.jsxs(ns,{open:t,onClose:e,title:"Visit Details",noInternalScroll:!0,children:[u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:12},children:[u.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[u.jsx("span",{style:{fontSize:14,fontStyle:"italic",color:"var(--muted)",display:"block",marginBottom:4},children:"Nickname"}),u.jsx("div",{style:{fontWeight:700,fontSize:18},children:o||d||"-"})]}),u.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[u.jsx("span",{style:{fontSize:14,fontStyle:"italic",color:"var(--muted)",display:"block",marginBottom:4},children:"Date"}),u.jsx("div",{style:{fontWeight:700,fontSize:18},children:wi(h)||"-"})]})]}),u.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:12},children:[["Time In",f],["Time Out",m],["Total Hours",g]].map(([M,U])=>u.jsxs("div",{className:"field",children:[u.jsx("span",{className:"label",style:{display:"block",marginBottom:6},children:M}),u.jsx("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10,fontWeight:700,fontSize:18},children:M==="Time In"||M==="Time Out"?U?Cl(U):"-":U?String(U):"-"})]},M))}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:12},children:[u.jsxs("div",{className:"field",children:[u.jsx("span",{className:"label",children:"Coach"}),u.jsx("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:12,fontSize:16,minHeight:44},children:S||"-"})]}),u.jsxs("div",{className:"field",children:[u.jsx("span",{className:"label",children:"Focus"}),u.jsx("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:12,fontSize:16,minHeight:44},children:_||"-"})]})]}),u.jsxs("div",{className:"field",style:{marginTop:12},children:[u.jsx("span",{className:"label",children:"Workouts Done"}),u.jsx("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:12,fontSize:16,minHeight:72},children:A||"-"})]}),u.jsxs("div",{className:"field",style:{marginTop:12},children:[u.jsx("span",{className:"label",children:"Comments"}),u.jsx("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:12,fontSize:16,minHeight:72},children:v||"-"})]}),u.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:[!m&&(()=>{try{const M=String(h||"").trim();if(!M)return!1;let U="";if(/^\d{4}-\d{2}-\d{2}$/.test(M))U=M.slice(0,10);else{const I=new Date(M);if(isNaN(I))return!1;U=new Intl.DateTimeFormat("en-CA",{timeZone:"Asia/Manila"}).format(I)}const x=new Intl.DateTimeFormat("en-CA",{timeZone:"Asia/Manila"}).format(new Date);return U===x}catch{return!1}})()?u.jsx("button",{className:"primary-btn",onClick:()=>{try{if(typeof r=="function"){try{r(a)}catch(M){console.error(M)}e&&e();return}b(!0)}catch(M){console.error(M)}},children:"Check Out"}):null,u.jsx("button",{className:"primary-btn",onClick:e,children:"Close"})]})]}),w&&u.jsx(Bd,{open:w,onClose:()=>{b(!1)},memberId:d,initialEntry:a,onSuccess:()=>{b(!1),e&&e(),j()}})]})}function ba(t,e=[]){if(t)for(const n of e){if(Object.prototype.hasOwnProperty.call(t,n))return t[n];const r=Object.keys(t).find(i=>i.toLowerCase().replace(/\s+/g,"")===n.toLowerCase().replace(/\s+/g,""));if(r)return t[r]}}function Xu(t){if(!t)return"";if(typeof t=="string")return t;const e=ba(t,["NickName","nickname","Nick","nick","Nick_Name","Nick Name","name","Name"]);if(e&&String(e).trim())return String(e).trim();const n=ba(t,["FirstName","firstname","first_name","first"])||"",r=ba(t,["LastName","lastname","last_name","last"])||"",i=`${String(n).trim()} ${String(r).trim()}`.trim();if(i)return i;const s=ba(t,["DisplayName","displayname","display"]);if(s&&String(s).trim())return String(s).trim();const o=ba(t,["MemberID","memberid","member_id","id"])||"";return o&&String(o).trim()?String(o).trim():""}const{fetchMembers:tO,fetchPayments:nO,fetchGymEntries:rO,fetchProgressTracker:iO,fetchMemberBundle:Sw,fetchPricing:Ew,fetchMemberByIdFresh:sO}=Re,oO=t=>String(t||"").trim().toLowerCase().replace(/\s+/g,"_"),St=t=>Object.fromEntries(Object.entries(t||{}).map(([e,n])=>[oO(e),n])),_e=(t,e)=>e.map(n=>t[n]).find(n=>n!==void 0&&n!==""),tn=t=>{if(!t&&t!==0)return null;try{if(t&&typeof t.toDate=="function")return t.toDate()}catch{}if(t&&typeof t.seconds=="number")return new Date(t.seconds*1e3);if(t instanceof Date)return t;const e=new Date(t);return isNaN(e)?null:e},ps="Asia/Manila",Cl=t=>{if(!t)return"-";if(/^\d{1,2}:\d{2}\s?(AM|PM)$/i.test(t))return t;const e=new Date(t);if(!isNaN(e))return new Intl.DateTimeFormat("en-US",{timeZone:ps,hour:"2-digit",minute:"2-digit",hour12:!0}).format(e);const n=String(t).match(/(\d{2}):(\d{2})/);if(n){let r=parseInt(n[1],10),i=n[2],s=r>=12?"PM":"AM";return r=r%12||12,`${r}:${i} ${s}`}return"-"},wi=t=>{var o,l,a;if(!t)return"-";const e=t instanceof Date?t:new Date(t);if(isNaN(e))return"-";const n=new Intl.DateTimeFormat("en-US",{timeZone:ps,month:"short",day:"numeric",year:"numeric"}).formatToParts(e),r=((o=n.find(d=>d.type==="month"))==null?void 0:o.value)||"",i=((l=n.find(d=>d.type==="day"))==null?void 0:l.value)||"",s=((a=n.find(d=>d.type==="year"))==null?void 0:a.value)||"";return`${r}-${i}, ${s}`},$t=t=>t==null||String(t).trim()===""?"-":String(t),aO=t=>{const e=String(t||"");if(!e)return"";const n=e.match(/https?:\/\/[^\s}]+/);if(n){const s=n[0];if(/googleusercontent\.com\//.test(s))return s;const o=s.match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return o&&o[1]?`https://drive.google.com/uc?export=view&id=${o[1]}`:s}if(/googleusercontent\.com\//.test(e))return e;const r=e.match(/\/file\/d\/([^/]+)/)||e.match(/[?&]id=([^&]+)/)||e.match(/\/uc\?[^#]*id=([^&]+)/),i=r?r[1]:"";return i?`https://drive.google.com/uc?export=view&id=${i}`:e},lO=t=>{const n=String(t||"").match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return n&&n[1]?n[1]:""},cO=t=>{const e=String(t||"");if(/googleusercontent\.com\//.test(e))return e;const n=lO(e);return n?`https://drive.google.com/thumbnail?id=${n}&sz=w1000`:e};function uO(){var Vr;const[t,e]=C.useState(null),{id:n,memberId:r}=cA(),i=Yo(),s=Us(),o=We.useMemo(()=>{var le;return(le=s.state)!=null&&le.row?St(s.state.row):null},[(Vr=s.state)==null?void 0:Vr.row]),[l,a]=C.useState(o||null),[d,h]=C.useState(!o),[f,m]=C.useState(!1),[g,S]=C.useState(""),[_,A]=C.useState({membershipState:null,coachActive:!1,membershipEnd:null,coachEnd:null}),[v,w]=C.useState([]),[b,j]=C.useState([]),[M,U]=C.useState([]),[x,I]=C.useState([]),{membershipState:R,coachActive:E}=_,T=_e(l,["student"]),k=typeof T=="string"?T.trim().toLowerCase().startsWith("y"):!!T,N=_e(l,["lastname","last_name"]),te=_e(l,["firstname","first_name"]);_e(l,["middlename","middle_name"]),_e(l,["gender"]);const J=_e(l,["birthday","birth_date","dob"]),ne=tn(J),ce=_e(l,["nick_name","nickname"]);_e(l,["street"]),_e(l,["brgy","barangay"]),_e(l,["municipality","city"]),_e(l,["email"]),_e(l,["mobile","phone"]);const V=tn(_e(l,["member_since","membersince","join_date"])),K=String(_e(l,["memberid","member_id","member_id_","id"])||"").trim(),B=_e(l,["photourl","photo_url","photo"]),X=aO(B),$=cO(X),[Z,q]=C.useState(!1),[ae,D]=C.useState(!1),[G,L]=C.useState(!1),[H,z]=C.useState(!1),[se,ge]=C.useState(!1),[O,Q]=C.useState(null),[F,oe]=C.useState(!1),[re,de]=C.useState(!1),[ue,pe]=C.useState(null),[De,Ze]=C.useState(-1),[Tt,we]=C.useState(!1),[Ie,Qe]=C.useState(20),[Ve,mn]=C.useState(20),[Zt,It]=C.useState(20);C.useEffect(()=>{we(!1)},[X]);const vt=le=>{try{const Pe=St(le||{}),Fe=[Pe.timeout,Pe.time_out,Pe.timeOut,Pe.timeout,Pe.time_out_];for(const Te of Fe)if(Te&&String(Te).trim()!==""&&(tn(Te)||/\d/.test(String(Te))))return!1;const rt=String((le==null?void 0:le.TimeOut)||(le==null?void 0:le.Time_Out)||(le==null?void 0:le.TimeOUT)||(le==null?void 0:le.Timeout)||"").trim();if(rt){try{if(tn(rt))return!1}catch{}if(/\d/.test(rt))return!1}return!0}catch{return!0}},ft=We.useRef(null),ot=()=>{ft.current&&clearTimeout(ft.current),ft.current=setTimeout(()=>{qt(),ft.current=null},200)};if(C.useEffect(()=>{let le=!0;(async()=>{const Te=decodeURIComponent(r||n||"").trim(),Ke=String(_e(o||{},["memberid","member_id","id"])||"").trim(),je=Te||Ke;if(!je){h(!1);return}if(o){a(o),h(!1);try{ot(),typeof window<"u"&&setTimeout(()=>{try{ot()}catch{}},600)}catch{}return}async function bt(){const[be,ze]=await Promise.all([Sw(je,{ttlMs:0}),Ew()]),Xe=be.member?St(be.member):null,at=(be.payments||[]).map(St),mr=(be.gymEntries||[]).map(pr=>pr),os=mr.map(St),Hs=(be.progress||[]).map(St);j(mr);const Ws=((ze==null?void 0:ze.rows)||(ze==null?void 0:ze.data)||[]).map(pr=>pr);return{m:Xe,pays:at,gyms:os,progs:Hs,pricingRows:Ws}}async function Gt(){const[be,ze,Xe,at]=await Promise.all([tO(),nO(),rO(),iO()]),os=((be==null?void 0:be.rows)??(be==null?void 0:be.data)??[]).map(St).find(nr=>String(_e(nr,["memberid","member_id","member_id_","id"])||"").trim().toLowerCase()===je.toLowerCase())||null,Hs=((ze==null?void 0:ze.rows)??(ze==null?void 0:ze.data)??[]).filter(nr=>String(_e(St(nr),["memberid","member_id","member_id_","id"])||"").trim().toLowerCase()===je.toLowerCase()),Ws=((Xe==null?void 0:Xe.rows)??(Xe==null?void 0:Xe.data)??[]).filter(nr=>String(_e(St(nr),["memberid","member_id","member_id_","id"])||"").trim().toLowerCase()===je.toLowerCase()),pr=Ws.map(St);j(Ws);const Ql=((at==null?void 0:at.rows)??(at==null?void 0:at.data)??[]).filter(nr=>String(_e(St(nr),["memberid","member_id","member_id_","id"])||"").trim().toLowerCase()===je.toLowerCase());return{m:os,pays:Hs,gyms:pr,progs:Ql}}try{let be;try{be=await bt()}catch{be=await Gt()}if(!le)return;if(be.m){a(be.m);const ze=String(_e(be.m,["memberid","member_id","id"])||"").trim();U((be.pays||[]).map(St).sort((Xe,at)=>{const mr=tn(_e(Xe,["date","paid_on","created","timestamp"]))||new Date(0);return(tn(_e(at,["date","paid_on","created","timestamp"]))||new Date(0))-mr})),w(be.gyms.map(Xe=>{const at=St(Xe);return{date:tn(_e(at,["date"])),timeIn:_e(at,["timein","time_in"]),timeOut:_e(at,["timeout","time_out"]),totalHours:_e(at,["totalhours","total_hours","hours"]),coach:_e(at,["coach"]),focus:_e(at,["focus"]),raw:Xe,memberId:String(_e(at,["memberid","member_id","MemberID","id"])||"").trim()}}).filter(Xe=>!!Xe.date).sort((Xe,at)=>at.date-Xe.date)),I(be.progs.map(St).sort((Xe,at)=>{const mr=tn(_e(Xe,["date","recorded","log_date","timestamp"]))||new Date(0);return(tn(_e(at,["date","recorded","log_date","timestamp"]))||new Date(0))-mr})),A(Zr((be.pays||[]).map(St),be.m,be.pricingRows||[]))}else o||(a(null),S("Member not found"))}catch(be){le&&!o&&S(be.message||"Failed to load member")}finally{le&&h(!1)}})();const Pe=sn.on("member:updated",Te=>{try{const Ke=Te&&Te.request?Te.request:Te,je=String(_e(Ke||{},["MemberID","memberid","member_id","id"])||"").trim(),bt=decodeURIComponent(r||n||"").trim(),Gt=String(_e(o||{},["memberid","member_id","id"])||"").trim(),be=bt||Gt;je&&be&&je.toLowerCase()===be.toLowerCase()&&setTimeout(()=>ot(),120)}catch{}}),Fe=sn.on("gymEntry:added",Te=>{try{const Ke=String(_e(l||{},["memberid","member_id","id"])||"").trim();if(!Ke)return;const je=String((Te==null?void 0:Te.MemberID)||(Te==null?void 0:Te.memberid)||(Te==null?void 0:Te.Member)||"").trim();je&&je===Ke&&ot()}catch{}}),rt=sn.on("payment:added",Te=>{try{const Ke=String(_e(l||{},["memberid","member_id","id"])||"").trim();if(!Ke)return;const je=Te&&Te.request?Te.request:Te,bt=Te&&Te.response?Te.response:null,Gt=String((je==null?void 0:je.MemberID)||(je==null?void 0:je.memberid)||(bt==null?void 0:bt.MemberID)||(bt==null?void 0:bt.memberid)||(je==null?void 0:je.Member)||(bt==null?void 0:bt.Member)||"").trim();Gt&&Gt===Ke&&setTimeout(()=>ot(),120)}catch(Ke){console.debug("payment event handler error",Ke)}});return()=>{le=!1;try{Pe()}catch{}try{Fe()}catch{}try{rt()}catch{}try{ft.current&&(clearTimeout(ft.current),ft.current=null)}catch{}}},[r,n,o]),d)return u.jsx("div",{className:"content",children:u.jsx(DI,{})});if(!l)return u.jsxs("div",{className:"content",children:[u.jsx("button",{className:"back-btn",onClick:()=>i(-1),children:" Back"}),u.jsx("div",{children:g||"Member not found"})]});async function qt(){m(!0);try{const le=String(K||"").trim();if(!le)return;console.debug("refreshBundle: fetching bundle for",le);const[Pe,Fe]=await Promise.all([Sw(le,{ttlMs:0}),Ew()]);console.debug("refreshBundle: fetched bundle",Pe,Fe);const rt=Pe.member?St(Pe.member):null,Te=(Pe.payments||[]).map(St),Ke=(Pe.gymEntries||[]).map(be=>be),je=Ke.map(St),bt=(Pe.progress||[]).map(St);rt&&a(rt),j(Ke),U(Te.sort((be,ze)=>{const Xe=tn(_e(be,["date","paid_on","created","timestamp"]))||new Date(0);return(tn(_e(ze,["date","paid_on","created","timestamp"]))||new Date(0))-Xe})),w(je.map(be=>{const ze=St(be);return{date:tn(_e(ze,["date"])),timeIn:_e(ze,["timein","time_in"]),timeOut:_e(ze,["timeout","time_out"]),totalHours:_e(ze,["totalhours","total_hours","hours"]),coach:_e(ze,["coach"]),focus:_e(ze,["focus"]),raw:be,memberId:String(_e(ze,["memberid","member_id","MemberID","id"])||"").trim()}}).filter(be=>!!be.date).sort((be,ze)=>ze.date-be.date)),I(bt.sort((be,ze)=>{const Xe=tn(_e(be,["date","recorded","log_date","timestamp"]))||new Date(0);return(tn(_e(ze,["date","recorded","log_date","timestamp"]))||new Date(0))-Xe}));const Gt=((Fe==null?void 0:Fe.rows)||(Fe==null?void 0:Fe.data)||[]).map(be=>be);A(Zr(Te,le,Gt))}catch(le){console.error("refreshBundle failed",le);try{S(String((le==null?void 0:le.message)||le||"Failed to refresh member data"))}catch{}}finally{m(!1)}}const Lr=new Intl.DateTimeFormat("en-CA",{timeZone:ps,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date),Se=(v||[]).find(le=>{try{const Pe=le==null?void 0:le.date;if(!Pe)return!1;const Fe=new Date(Pe);return new Intl.DateTimeFormat("en-CA",{timeZone:ps,year:"numeric",month:"2-digit",day:"2-digit"}).format(Fe)!==Lr?!1:vt(le)}catch{return!1}}),et=(b||[]).find(le=>{try{const Pe=St(le||{}),Fe=_e(Pe,["date","Date","log_date","date_time"]);if(!Fe)return!1;const rt=new Date(Fe);return new Intl.DateTimeFormat("en-CA",{timeZone:ps,year:"numeric",month:"2-digit",day:"2-digit"}).format(rt)!==Lr?!1:vt(le)}catch{return!1}})||null,ut=!!Se||!!et,_t=(v||[]).length,On=_t?1:0,rs=Math.min(Ie||0,_t),wt=(x||[]).length,is=wt?1:0,ss=Math.min(Ve||0,wt),fr=(M||[]).length,zd=fr?1:0,Hd=Math.min(Zt||0,fr);return u.jsxs("div",{className:"content",children:[u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[u.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[u.jsx("button",{className:"back-btn",onClick:()=>i(-1),children:" Back"}),u.jsxs("div",{style:{display:"flex",gap:8},children:[u.jsx("button",{className:"back-btn",onClick:()=>{pe("in"),de(!0)},disabled:!(!ut&&R==="active"),title:ut?"Member already has an open visit for today":R==="active"?"Check in":"Gym membership is not active",style:{opacity:!ut&&R==="active"?1:.5,cursor:!ut&&R==="active"?"pointer":"not-allowed"},children:"Check In"}),u.jsx("button",{className:"back-btn",onClick:()=>{pe("out"),de(!0)},disabled:!ut,title:ut?"Member has an open visit today  checkout":"No open visit to check out",style:{opacity:ut?1:.5,cursor:ut?"pointer":"not-allowed"},children:"Check Out"})]})]})}),u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginTop:8,marginBottom:8},children:[u.jsx("h2",{style:{margin:0},children:$t(Xu(l)||ce||te||"Member")}),u.jsx("div",{children:u.jsx(Ud,{show:f&&!d})})]})]}),u.jsx(HM,{member:l,status:_,isRefreshing:f,onEdit:()=>D(!0),onAddPayment:()=>q(!0),onShowQr:()=>L(!0),onShowProgress:()=>z(!0),onCheckIn:()=>{pe("in"),de(!0)}}),u.jsx(uM,{open:Z,onClose:()=>q(!1),memberId:K,onSaved:()=>{q(!1),qt()},membershipEnd:_.membershipEnd,coachEnd:_.coachEnd,isStudent:k,birthDate:ne}),u.jsx(wM,{open:ae,onClose:()=>D(!1),member:l,onSaved:le=>{D(!1);try{if(le){const Pe=St(le)||{},Fe=Object.fromEntries(Object.entries(Pe).filter(([rt,Te])=>Te!=null&&String(Te).trim()!==""));Object.keys(Fe).length&&a(rt=>({...rt||{},...Fe}))}}catch(Pe){console.debug("onSaved merge error",Pe)}(async()=>{try{const Pe=String(_e(le||l||{},["memberid","member_id","id","MemberID"])||"").trim();if(Pe)try{const Fe=await sO(Pe);if(Fe)try{const rt=St(Fe)||{},Te=Object.fromEntries(Object.entries(rt).filter(([Ke,je])=>je!=null&&String(je).trim()!==""));if(Object.keys(Te).length)a(Ke=>({...Ke||{},...Te}));else try{qt()}catch{}}catch{try{qt()}catch{}}}catch{try{qt()}catch{}}else try{qt()}catch{}}catch{try{qt()}catch{}}})()}}),u.jsx(kM,{open:G,onClose:()=>L(!1),memberId:K,nickname:ce||te||"",firstName:te||"",lastName:N||"",memberSince:V||null,photo:$}),u.jsx(OM,{open:H,onClose:()=>z(!1),memberId:K,memberNick:ce||te||"",memberSinceYMD:V?`${V.getFullYear()}-${String(V.getMonth()+1).padStart(2,"0")}-${String(V.getDate()).padStart(2,"0")}`:"",onSaved:()=>{z(!1),qt()}}),u.jsx(FM,{open:se,onClose:()=>{ge(!1),Ze(-1)},row:De>=0?x[De]:null,memberNick:ce||te||""}),u.jsxs("div",{className:"panel",children:[u.jsx("div",{className:"panel-header",children:"Gym Visits"}),u.jsxs("table",{className:"aligned",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Date"}),u.jsx("th",{children:"Time In"}),u.jsx("th",{children:"Time Out"}),u.jsx("th",{children:"Total Hours"}),u.jsx("th",{children:"Coach"}),u.jsx("th",{children:"Focus"})]})}),u.jsx("tbody",{children:v.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:6,children:"-"})}):v.slice(0,Ie).map((le,Pe)=>u.jsxs("tr",{style:{cursor:"pointer"},onClick:()=>e(le),children:[u.jsx("td",{children:wi(le.date)}),u.jsx("td",{children:Cl(le.timeIn)}),u.jsx("td",{children:Cl(le.timeOut)}),u.jsx("td",{children:$t(le.totalHours)}),u.jsx("td",{children:$t(le.coach)}),u.jsx("td",{children:$t(le.focus)})]},Pe))})]}),u.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8},children:u.jsx("div",{className:"table-range",children:_t===0?"Showing 0 of 0":`Showing ${On}${rs} of ${_t}`})}),v.length>Ie&&u.jsx("div",{style:{textAlign:"center",marginTop:8},children:u.jsx("button",{className:"button",onClick:()=>Qe(le=>le<v.length?Math.min(le+20,v.length):20),children:Ie<v.length?`Load ${Math.min(20,v.length-Ie)} more`:"Show less"})})]}),t&&u.jsx(Ug,{open:!!t,onClose:()=>e(null),row:t,onCheckout:le=>{try{const Pe=(b||[]).find(Fe=>{try{const rt=St(Fe||{}),Te=_e(rt,["date","Date","log_date","date_time"]),Ke=_e(rt,["timein","TimeIn","time_in"]);if(!Te)return!1;const je=new Date(Te),bt=new Date((le==null?void 0:le.date)||(le==null?void 0:le.Date)||(le==null?void 0:le.date_time)||""),Gt=new Intl.DateTimeFormat("en-CA",{timeZone:ps,year:"numeric",month:"2-digit",day:"2-digit"}).format(je),be=new Intl.DateTimeFormat("en-CA",{timeZone:ps,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date(bt));if(Gt!==be)return!1;if(Ke&&(le!=null&&le.timeIn||le!=null&&le.TimeIn)){const ze=String(Ke).trim(),Xe=String(le.timeIn||le.TimeIn||le.timein||"").trim();if(ze&&Xe&&ze.indexOf(Xe)===-1&&Xe.indexOf(ze)===-1)return!1}return!0}catch{return!1}})||null;Q(Pe)}catch{Q(null)}pe("out"),de(!0)}}),u.jsx(Bd,{open:!!re,memberId:K,initialEntry:ue==="out"?O||et:null,mode:ue,onClose:()=>{de(!1),pe(null),Q(null)},status:_,onSuccess:async()=>{de(!1),pe(null),Q(null);try{await ot()}catch{}}}),v.length>200&&u.jsx("div",{style:{textAlign:"center",marginTop:8},children:u.jsx("button",{className:"button",onClick:()=>oe(le=>!le),children:F?"Show less":`Show all (${v.length})`})}),u.jsxs("div",{className:"panel",children:[u.jsx("div",{className:"panel-header",children:"Progress"}),u.jsxs("table",{className:"aligned",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Date"}),u.jsx("th",{children:"No"}),u.jsx("th",{children:"Weight"}),u.jsx("th",{children:"BMI"}),u.jsx("th",{children:"Muscle Mass"}),u.jsx("th",{children:"Body Fat"})]})}),u.jsx("tbody",{children:x.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:6,children:"-"})}):x.slice(0,Ve).map((le,Pe)=>{const Fe=tn(_e(le,["date","recorded","log_date","timestamp"])),rt=_e(le,["no","entry_no","seq","number"]),Te=_e(le,["weight","weight_kg","weight_lbs","weight_(lbs)","weight_(kg)","weight(lbs)","weightkg","weightlbs"]),Ke=_e(le,["bmi"]),je=_e(le,["musclemass","muscle_mass","muscle"]),bt=_e(le,["bodyfat","body_fat","bf"]);return u.jsxs("tr",{style:{cursor:"pointer"},onClick:()=>{Ze(Pe),ge(!0)},children:[u.jsx("td",{children:wi(Fe)}),u.jsx("td",{children:$t(rt)}),u.jsx("td",{children:$t(Te)}),u.jsx("td",{children:$t(Ke)}),u.jsx("td",{children:$t(je)}),u.jsx("td",{children:$t(bt)})]},Pe)})})]}),u.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8},children:u.jsx("div",{className:"table-range",children:wt===0?"Showing 0 of 0":`Showing ${is}${ss} of ${wt}`})}),x.length>Ve&&u.jsx("div",{style:{textAlign:"center",marginTop:8},children:u.jsx("button",{className:"button",onClick:()=>mn(le=>le<x.length?Math.min(le+20,x.length):20),children:Ve<x.length?`Load ${Math.min(20,x.length-Ve)} more`:"Show less"})})]}),u.jsxs("div",{className:"panel",children:[u.jsx("div",{className:"panel-header",children:"Payments"}),u.jsxs("table",{className:"aligned payments-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Date"}),u.jsx("th",{children:"Particulars"}),u.jsxs("th",{children:["Gym Membership",u.jsx("br",{}),u.jsx("span",{className:"th-sub",children:"Valid Until"})]}),u.jsxs("th",{children:["Coach Subscription",u.jsx("br",{}),u.jsx("span",{className:"th-sub",children:"Valid Until"})]}),u.jsx("th",{children:"Mode"}),u.jsx("th",{children:"Cost"})]})}),u.jsx("tbody",{children:M.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:6,children:"-"})}):M.slice(0,Zt).map((le,Pe)=>{const Fe=tn(_e(le,["date","paid_on","created","timestamp"])),rt=_e(le,["particulars","type","item","category","product","paymentfor","plan","description"]),Te=tn(_e(le,["gymvaliduntil","gym_valid_until","gym_until"])),Ke=tn(_e(le,["coachvaliduntil","coach_valid_until","coach_until"])),je=_e(le,["mode","payment_mode","method","via"]),bt=_e(le,["cost","amount","price","total","paid"]);return u.jsxs("tr",{children:[u.jsx("td",{children:wi(Fe)}),u.jsx("td",{children:$t(rt)}),u.jsx("td",{children:wi(Te)}),u.jsx("td",{children:wi(Ke)}),u.jsx("td",{children:$t(je)}),u.jsx("td",{children:$t(bt)})]},Pe)})})]}),u.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8},children:u.jsx("div",{className:"table-range",children:fr===0?"Showing 0 of 0":`Showing ${zd}${Hd} of ${fr}`})}),M.length>Zt&&u.jsx("div",{style:{textAlign:"center",marginTop:8},children:u.jsx("button",{className:"button",onClick:()=>It(le=>le<M.length?Math.min(le+20,M.length):20),children:Zt<M.length?`Load ${Math.min(20,M.length-Zt)} more`:"Show less"})})]})]})}const dO=t=>String(t||"").trim().toLowerCase().replace(/\s+/g,"_"),hO=t=>Object.fromEntries(Object.entries(t||{}).map(([e,n])=>[dO(e),n])),fO=(t,e)=>{try{const n=t||{};for(const r of e){if(Object.prototype.hasOwnProperty.call(n,r))return n[r];const i=Object.keys(n).find(s=>s.toLowerCase().replace(/\s+/g,"")===r.toLowerCase().replace(/\s+/g,""));if(i)return n[i]}}catch{}},Tw=t=>{if(!t&&t!==0)return null;try{if(t&&typeof t.toDate=="function")return t.toDate()}catch{}if(t&&typeof t.seconds=="number")return new Date(t.seconds*1e3);if(t instanceof Date)return t;const e=new Date(t);return isNaN(e)?null:e},Iw=t=>{try{const e=hO(t||{}),n=[e.timeout,e.time_out,e.timeOut,e.time_out_];for(const i of n)if(i&&String(i).trim()!==""&&(Tw(i)||/\d/.test(String(i))))return!1;const r=String((t==null?void 0:t.TimeOut)||(t==null?void 0:t.Time_Out)||(t==null?void 0:t.TimeOUT)||(t==null?void 0:t.Timeout)||"").trim();if(r){try{if(Tw(r))return!1}catch{}if(/\d/.test(r))return!1}return!0}catch{return!0}};function Rm(t){try{const e=new Set;return(t||[]).forEach(n=>{try{let r=String((n==null?void 0:n.MemberID)||(n==null?void 0:n.memberid)||(n==null?void 0:n.Member)||(n==null?void 0:n.member)||(n==null?void 0:n.id)||"").trim().toLowerCase();r||(r=String((n==null?void 0:n.NickName)||(n==null?void 0:n.nickname)||(n==null?void 0:n.Nick)||(n==null?void 0:n.nick)||(n==null?void 0:n.MemberName)||(n==null?void 0:n.member_name)||"").trim().toLowerCase());let i=String((n==null?void 0:n.Coach)||(n==null?void 0:n.coach)||(n==null?void 0:n.coach_name)||"").trim().toLowerCase()||"none";try{i=i.replace(/\bcoach\b/g,"").replace(/\s+/g,"").trim()||"none"}catch{}const s=(n==null?void 0:n.Date)||(n==null?void 0:n.date)||(n==null?void 0:n.time_in)||(n==null?void 0:n.Timestamp)||"";let o="";if(s&&typeof s=="string"&&/^\d{4}-\d{2}-\d{2}/.test(s))o=s.slice(0,10);else if(s&&typeof s=="string")try{o=new Date(s).toISOString().slice(0,10)}catch{o=String(s).slice(0,10)}r&&o&&e.add(`${r}::${i}::${o}`)}catch{}}),e.size}catch{return(t||[]).length}}const{fetchMembers:qh,fetchPayments:bw,fetchGymEntries:xw,fetchGymEntriesFresh:Gh,fetchPricing:Cw,fetchDashboard:mO}=Re;function Pc(){return new Date().toLocaleDateString("en-CA",{year:"numeric",month:"2-digit",day:"2-digit"})}const Vn=(t,e)=>fO(t,e);function pO(){const[t,e]=C.useState({totalMembers:0,activeGym:0,activeCoach:0,visitedToday:0,coachToday:0,checkedIn:0,cashToday:0,gcashToday:0}),[n,r]=C.useState(!0),[i,s]=C.useState(!1),[o,l]=C.useState([]),[a,d]=C.useState([]),[h,f]=C.useState([]),[m,g]=C.useState([]),[S,_]=C.useState(!1),[A,v]=C.useState(!1),[w,b]=C.useState(20),[j,M]=C.useState(20),[U,x]=C.useState(null),[I,R]=C.useState(!1),[E,T]=C.useState(null),[k,N]=C.useState(null),te=C.useMemo(()=>{const q=(h||[]).filter(ae=>{const D=ae.Date||ae.date;return(D?new Date(D).toLocaleDateString("en-CA",{year:"numeric",month:"2-digit",day:"2-digit"}):"")===Pc()});return q.sort((ae,D)=>{const G=String(Vn(ae,["TimeOut","timeout","time_out"])||"").trim(),L=String(Vn(D,["TimeOut","timeout","time_out"])||"").trim(),H=G===""||G==="-"||G==="",z=L===""||L==="-"||L==="";if(H&&!z)return-1;if(!H&&z)return 1;const se=String(Vn(ae,["TimeIn","timein","time_in"])||"").trim(),ge=String(Vn(D,["TimeIn","timein","time_in"])||"").trim();return String(ge).localeCompare(String(se))}),q.map((ae,D)=>{const G=String(Vn(ae,["MemberID","memberid","member_id","member","id"])||"").trim(),L=(o||[]).find(O=>String(Vn(O,["MemberID","memberid","member_id","id"])||"").trim()===G),H=Vn(ae,["TimeIn","timein","time_in"])||"",z=Vn(ae,["TimeOut","timeout","time_out"])||"",se=String(z).trim()===""||String(z).trim()==="-"||String(z).trim()==="",ge=Vn(ae,["TotalHours","totalhours","NoOfHours","noofhours","hours"])||"";return u.jsxs("tr",{style:{cursor:"pointer"},onClick:()=>x(ae),children:[u.jsx("td",{className:"td-fullname",style:{textAlign:"left"},children:u.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:8},children:[u.jsx("span",{children:Xu(L)}),se&&u.jsx("span",{className:"status-badge on",children:"On"})]})}),u.jsx("td",{children:Cl(H)}),u.jsx("td",{children:Cl(z)}),u.jsx("td",{children:$t(ge)}),u.jsx("td",{children:$t(ae.Coach||ae.coach)}),u.jsx("td",{children:$t(ae.Focus||ae.focus)})]},D)})},[h,o]),J=(te||[]).length,ne=J?1:0,ce=Math.min(w||0,J),V=(q,ae,D,G)=>{const L=new Map,H=we=>{const Ie=String(we??"").trim().toLowerCase();return Ie==="yes"||Ie==="y"||Ie==="true"||Ie==="1"},z=(we,Ie)=>{for(const Qe of Ie){if(we&&Object.prototype.hasOwnProperty.call(we,Qe))return we[Qe];const Ve=Object.keys(we||{}).find(mn=>mn.toLowerCase().replace(/\s+/g,"")===Qe.toLowerCase().replace(/\s+/g,""));if(Ve)return we[Ve]}};(G||[]).forEach(we=>{const Ie=String(z(we,["Particulars"])||"").trim();if(!Ie)return;const Qe=H(z(we,["Gym membership","Gym Membership","GymMembership","Membership"])),Ve=H(z(we,["Coach subscription","Coach Subscription","CoachSubscription","Coach"]));L.set(Ie.toLowerCase(),{gym:Qe,coach:Ve})});const se=new Map;(ae||[]).forEach(we=>{const Ie=String(we.MemberID||we.member_id||we.id||we.member||"").trim();Ie&&(se.has(Ie)||se.set(Ie,[]),se.get(Ie).push(we))});let ge=0,O=0;for(const we of q||[]){const Ie=String(we.MemberID||we.member_id||we.id||"").trim(),Qe=se.get(Ie)||[],Ve=Zr(Qe,we,G);if(Ve.membershipState!=="active")if((we.membershipState||we.membership_state||we.status||"").toLowerCase()==="active")Ve.membershipState="active";else{const Zt=z(we,["membershipEnd","membership_end","gymvaliduntil","gym_valid_until","gym_until","enddate","end_date","valid_until","expiry","expires","until","end","gym_valid","gym_validity","gymvalid"]);if(Zt){const It=new Date(Zt);if(!isNaN(It)){It.setHours(0,0,0,0);const vt=new Date;vt.setHours(0,0,0,0),It>=vt&&(Ve.membershipState="active")}}}Ve.membershipState==="active"&&ge++,Ve.coachActive&&O++}const Q=Pc(),F=(D||[]).filter(we=>{const Ie=we.Date||we.date;return Ie?new Date(Ie).toLocaleDateString("en-CA",{year:"numeric",month:"2-digit",day:"2-digit"})===Q:!1}),re=new Set(F.map(we=>String(we.MemberID||we.member_id||we.id||"").trim()).filter(Boolean)).size,de=Rm(F),ue=new Set;for(const we of F){const Ie=String(Vn(we,["TimeIn","timein","time_in"])||"").trim(),Qe=String(Vn(we,["MemberID","memberid","member_id","id"])||"").trim(),Ve=!Iw(we);Ie&&!Ve&&Qe&&ue.add(Qe)}const pe=ue.size;let De=0,Ze=0,Tt=0;for(const we of ae||[]){const Ie=we.Date||we.date||we.pay_date;if(!Ie||new Date(Ie).toLocaleDateString("en-CA",{year:"numeric",month:"2-digit",day:"2-digit"})!==Q)continue;const Ve=parseFloat(we.Cost||we.amount||0)||0;Tt+=Ve;const mn=String(we.Mode||we.mode||we.method||"").toLowerCase();mn==="cash"&&(De+=Ve),mn==="gcash"&&(Ze+=Ve)}return{totalMembers:(q||[]).length,activeGym:ge,activeCoach:O,visitedToday:re,coachToday:de,checkedIn:pe,cashToday:De,gcashToday:Ze,totalPaymentsToday:Tt}},K=C.useMemo(()=>{const q=Pc(),ae=L=>L.Date||L.date||L.pay_date||L.created||L.timestamp||null,D=L=>{if(!L&&L!==0)return 0;if(typeof L=="number")return L;try{if(L&&typeof L.seconds=="number")return L.seconds*1e3}catch{}const H=Date.parse(String(L));return isNaN(H)?0:H};return(a||[]).filter(L=>{const H=ae(L);return(H?new Date(H).toLocaleDateString("en-CA",{year:"numeric",month:"2-digit",day:"2-digit"}):"")===q}).sort((L,H)=>{const z=D(ae(L));return(D(ae(H))||0)-(z||0)}).map((L,H)=>{const z=(o||[]).find(F=>{const oe=String(L.MemberID||L.member_id||L.id||L.member||"").trim();return oe?String(F.MemberID||F.member_id||F.id||"").trim()===oe:!1}),se=L.gymvaliduntil||L.GymValidUntil||L.gym_valid_until||L.gym_until||L.EndDate||L.Enddate||L.enddate||L.end_date||L.end||L.valid_until||L.expiry||L.expires||L.until||"",ge=L.coachvaliduntil||L.CoachValidUntil||L.coach_valid_until||L.coach_until||"",O=wi(se),Q=wi(ge);return u.jsxs("tr",{children:[u.jsx("td",{children:Xu(z)}),u.jsx("td",{children:$t(L.Particulars||L.particulars||L.type||L.item||L.category||L.product||L.paymentfor||L.plan||L.description)}),u.jsx("td",{children:$t(O)}),u.jsx("td",{children:$t(Q)}),u.jsx("td",{children:$t(L.Mode||L.mode||L.method)}),u.jsx("td",{children:$t((parseFloat(L.Cost||L.amount||0)||0).toLocaleString())})]},H)})},[a,o]),B=(K||[]).length,X=B?1:0,$=Math.min(j||0,B);C.useEffect(()=>{async function q(){r(!0);try{const pe=await mO();if(pe&&pe.ok){const{totalMembers:De=0,activeGym:Ze=0,activeCoach:Tt=0,visitedToday:we=0,coachToday:Ie=0,checkedIn:Qe=0,cashToday:Ve=0,gcashToday:mn=0,totalPaymentsToday:Zt=0}=pe;e({totalMembers:De,activeGym:Ze,activeCoach:Tt,visitedToday:we,coachToday:Ie,checkedIn:Qe,cashToday:Ve,gcashToday:mn,totalPaymentsToday:Zt}),r(!1),(async()=>{s(!0);try{const[It,vt,ft,ot]=await Promise.all([qh(),bw(),xw(),Cw()]);l((It==null?void 0:It.rows)||(It==null?void 0:It.data)||[]),d((vt==null?void 0:vt.rows)||(vt==null?void 0:vt.data)||[]),f((ft==null?void 0:ft.rows)||(ft==null?void 0:ft.data)||[]),g((ot==null?void 0:ot.rows)||(ot==null?void 0:ot.data)||[]);try{const qt=V((It==null?void 0:It.rows)||(It==null?void 0:It.data)||[],(vt==null?void 0:vt.rows)||(vt==null?void 0:vt.data)||[],(ft==null?void 0:ft.rows)||(ft==null?void 0:ft.data)||[],(ot==null?void 0:ot.rows)||(ot==null?void 0:ot.data)||[]);e(qt)}catch(qt){console.warn("Failed to recompute stats after background fetch",qt)}}catch{}finally{s(!1)}})();return}}catch{}s(!0);const[L,H,z,se]=await Promise.all([qh(),bw(),xw(),Cw()]),ge=(L==null?void 0:L.rows)||(L==null?void 0:L.data)||[],O=(H==null?void 0:H.rows)||(H==null?void 0:H.data)||[],Q=(z==null?void 0:z.rows)||(z==null?void 0:z.data)||[],F=(se==null?void 0:se.rows)||(se==null?void 0:se.data)||[];l(ge),d(O),f(Q),g(F),s(!1);const oe=ge,re=O,de=Q,ue=F;e(pe=>({...pe,totalMembers:oe.length})),setTimeout(()=>{const pe=new Map,De=Se=>{const et=String(Se??"").trim().toLowerCase();return et==="yes"||et==="y"||et==="true"||et==="1"},Ze=(Se,et)=>{for(const ut of et){if(Se&&Object.prototype.hasOwnProperty.call(Se,ut))return Se[ut];const _t=Object.keys(Se||{}).find(On=>On.toLowerCase().replace(/\s+/g,"")===ut.toLowerCase().replace(/\s+/g,""));if(_t)return Se[_t]}};ue.forEach(Se=>{const et=String(Ze(Se,["Particulars"])||"").trim();if(!et)return;const ut=De(Ze(Se,["Gym membership","Gym Membership","GymMembership","Membership"])),_t=De(Ze(Se,["Coach subscription","Coach Subscription","CoachSubscription","Coach"]));pe.set(et.toLowerCase(),{gym:ut,coach:_t})});const Tt=new Map;re.forEach(Se=>{const et=String(Se.MemberID||Se.member_id||Se.id||Se.member||"").trim();et&&(Tt.has(et)||Tt.set(et,[]),Tt.get(et).push(Se))});let we=0,Ie=0;for(const Se of oe){const et=String(Se.MemberID||Se.member_id||Se.id||"").trim(),ut=Tt.get(et)||[],_t=Zr(ut,Se,ue);if(_t.membershipState!=="active")if((Se.membershipState||Se.membership_state||Se.status||"").toLowerCase()==="active")_t.membershipState="active";else{const rs=Ze(Se,["membershipEnd","membership_end","gymvaliduntil","gym_valid_until","gym_until","enddate","end_date","valid_until","expiry","expires","until","end","gym_valid","gym_validity","gymvalid"]);if(rs){const wt=new Date(rs);if(!isNaN(wt)){wt.setHours(0,0,0,0);const is=new Date;is.setHours(0,0,0,0),wt>=is&&(_t.membershipState="active")}}}_t.membershipState==="active"&&we++,_t.coachActive&&Ie++}const Qe=Pc(),Ve=[];for(const Se of de){const et=Se.Date||Se.date;if(!et)continue;new Date(et).toLocaleDateString("en-CA",{year:"numeric",month:"2-digit",day:"2-digit"})===Qe&&Ve.push(Se)}const Zt=new Set(Ve.map(Se=>String(Se.MemberID||Se.member_id||Se.id||"").trim()).filter(Boolean)).size,It=Rm(Ve),vt=new Set;for(const Se of Ve){const et=String(Vn(Se,["TimeIn","timein","time_in"])||"").trim(),ut=String(Vn(Se,["MemberID","memberid","member_id","id"])||"").trim(),_t=!Iw(Se);et&&!_t&&ut&&vt.add(ut)}const ft=vt.size;let ot=0,qt=0,Lr=0;for(const Se of re){const et=Se.Date||Se.date||Se.pay_date;if(!et||new Date(et).toLocaleDateString("en-CA",{year:"numeric",month:"2-digit",day:"2-digit"})!==Qe)continue;const _t=parseFloat(Se.Cost||Se.amount||0)||0;Lr+=_t;const On=String(Se.Mode||Se.mode||Se.method||"").toLowerCase();On==="cash"&&(ot+=_t),On==="gcash"&&(qt+=_t)}e({totalMembers:oe.length,activeGym:we,activeCoach:Ie,visitedToday:Zt,coachToday:It,checkedIn:ft,cashToday:ot,gcashToday:qt,totalPaymentsToday:Lr}),r(!1),setShowLoadingToast(!1)},20)}q();const ae=sn.on("gymEntry:added",async L=>{try{s(!0);const H=await Gh();f((H==null?void 0:H.rows)||(H==null?void 0:H.data)||[]),s(!1)}catch{}}),D=sn.on("member:updated",async()=>{try{const L=await qh();l((L==null?void 0:L.rows)||(L==null?void 0:L.data)||[])}catch{}}),G=setInterval(async()=>{try{const L=await Gh();f((L==null?void 0:L.rows)||(L==null?void 0:L.data)||[])}catch{}},15e3);return()=>{ae(),D(),clearInterval(G)}},[]),C.useEffect(()=>{try{const q=V(o||[],a||[],h||[],m||[]);e(q)}catch(q){console.warn("Failed to recompute stats on data change",q)}},[o,a,h,m]);const Z=q=>{if(!q)return;const ae=String(q.MemberID||q.member_id||q.id||q.member||"").trim();ae&&(T(ae),N(q||null),R(!0),x(null))};return u.jsxs("div",{className:"dashboard-content",children:[u.jsxs("h2",{className:"dashboard-title",children:["Daily Dashboard ",u.jsx(Ud,{show:i&&!n})]}),u.jsxs("div",{className:"dashboard-grid-3x3",children:[u.jsxs("div",{className:"dashboard-card",children:[u.jsx("div",{className:"dashboard-label",children:"Total Members"}),u.jsx("div",{className:"dashboard-value magenta",children:t.totalMembers})]}),u.jsxs("div",{className:"dashboard-card",children:[u.jsx("div",{className:"dashboard-label",children:"Active Gym Memberships"}),u.jsx("div",{className:"dashboard-value magenta",children:t.activeGym})]}),u.jsxs("div",{className:"dashboard-card",children:[u.jsx("div",{className:"dashboard-label",children:"Active Coach Subscriptions"}),u.jsx("div",{className:"dashboard-value magenta",children:t.activeCoach})]}),u.jsxs("div",{className:"dashboard-card",children:[u.jsx("div",{className:"dashboard-label",children:"Member Visits"}),u.jsx("div",{className:"dashboard-value magenta",children:t.visitedToday})]}),u.jsxs("div",{className:"dashboard-card",children:[u.jsx("div",{className:"dashboard-label",children:"Coaching Sessions"}),u.jsx("div",{className:"dashboard-value magenta",children:t.coachToday})]}),u.jsxs("div",{className:"dashboard-card",children:[u.jsx("div",{className:"dashboard-label",children:"Currently Checked-In"}),u.jsx("div",{className:"dashboard-value magenta",children:t.checkedIn})]}),u.jsxs("div",{className:"dashboard-card",children:[u.jsx("div",{className:"dashboard-label",children:"Cash Revenue"}),u.jsxs("div",{className:"dashboard-value magenta",children:[" ",t.cashToday.toLocaleString()]})]}),u.jsxs("div",{className:"dashboard-card",children:[u.jsx("div",{className:"dashboard-label",children:"GCash Revenue"}),u.jsxs("div",{className:"dashboard-value magenta",children:[" ",t.gcashToday.toLocaleString()]})]}),u.jsxs("div",{className:"dashboard-card",children:[u.jsx("div",{className:"dashboard-label",children:"Total Revenue"}),u.jsxs("div",{className:"dashboard-value magenta",children:[" ",(t.totalPaymentsToday||0).toLocaleString()]})]})]}),u.jsxs("div",{style:{marginTop:24},className:"panel",children:[u.jsx("div",{className:"panel-header",children:"Gym Entries Today"}),u.jsxs("table",{className:"aligned",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Nickname"}),u.jsx("th",{children:"Time In"}),u.jsx("th",{children:"Time Out"}),u.jsx("th",{children:"Total Hours"}),u.jsx("th",{children:"Coach"}),u.jsx("th",{children:"Focus"})]})}),u.jsx("tbody",{children:!te||Array.isArray(te)&&te.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:6,children:"-"})}):(te||[]).slice(0,w)})]}),u.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8},children:u.jsx("div",{className:"table-range",children:J===0?"Showing 0 of 0":`Showing ${ne}${ce} of ${J}`})}),J>w&&u.jsx("div",{style:{textAlign:"center",marginTop:8},children:u.jsx("button",{className:"button",onClick:()=>b(q=>q<J?Math.min(q+20,J):20),children:w<J?`Load ${Math.min(20,J-w)} more`:"Show less"})})]}),u.jsx(Ug,{open:!!U,onClose:()=>x(null),row:U,onCheckout:q=>Z(q)}),u.jsx(Bd,{open:I,memberId:E,initialEntry:k,onClose:()=>{R(!1),T(null),N(null)},onSuccess:async()=>{try{const q=await Gh();f((q==null?void 0:q.rows)||(q==null?void 0:q.data)||[])}catch(q){console.error(q)}R(!1),T(null),N(null)}}),u.jsxs("div",{style:{marginTop:24},className:"panel",children:[u.jsx("div",{className:"panel-header",children:"Payments Today"}),u.jsxs("table",{className:"aligned payments-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Nickname"}),u.jsx("th",{children:"Particulars"}),u.jsxs("th",{children:["Gym Membership",u.jsx("br",{}),"Valid Until"]}),u.jsxs("th",{children:["Coach Subscription",u.jsx("br",{}),"Valid Until"]}),u.jsx("th",{children:"Mode"}),u.jsx("th",{children:"Cost"})]})}),u.jsx("tbody",{children:!K||Array.isArray(K)&&K.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:6,children:"-"})}):(K||[]).slice(0,j)})]}),u.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8},children:u.jsx("div",{className:"table-range",children:B===0?"Showing 0 of 0":`Showing ${X}${$} of ${B}`})}),B>j&&u.jsx("div",{style:{textAlign:"center",marginTop:8},children:u.jsx("button",{className:"button",onClick:()=>M(q=>q<B?Math.min(q+20,B):20),children:j<B?`Load ${Math.min(20,B-j)} more`:"Show less"})})]}),n&&u.jsx("div",{style:{marginTop:24},children:"Loading"})]})}const gO="modulepreload",yO=function(t){return"/"+t},Aw={},vO=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(n.map(a=>{if(a=yO(a),a in Aw)return;Aw[a]=!0;const d=a.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${h}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":gO,d||(f.as="script"),f.crossOrigin="",f.href=a,l&&f.setAttribute("nonce",l),document.head.appendChild(f),d)return new Promise((m,g)=>{f.addEventListener("load",m),f.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${a}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return i.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})};var MI={exports:{}},OI={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wo=C;function _O(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var wO=typeof Object.is=="function"?Object.is:_O,SO=Wo.useState,EO=Wo.useEffect,TO=Wo.useLayoutEffect,IO=Wo.useDebugValue;function bO(t,e){var n=e(),r=SO({inst:{value:n,getSnapshot:e}}),i=r[0].inst,s=r[1];return TO(function(){i.value=n,i.getSnapshot=e,Qh(i)&&s({inst:i})},[t,n,e]),EO(function(){return Qh(i)&&s({inst:i}),t(function(){Qh(i)&&s({inst:i})})},[t]),IO(n),n}function Qh(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!wO(t,n)}catch{return!0}}function xO(t,e){return e()}var CO=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?xO:bO;OI.useSyncExternalStore=Wo.useSyncExternalStore!==void 0?Wo.useSyncExternalStore:CO;MI.exports=OI;var AO=MI.exports;const LI=0,VI=1,FI=2,Nw=3;var kw=Object.prototype.hasOwnProperty;function Dm(t,e){var n,r;if(t===e)return!0;if(t&&e&&(n=t.constructor)===e.constructor){if(n===Date)return t.getTime()===e.getTime();if(n===RegExp)return t.toString()===e.toString();if(n===Array){if((r=t.length)===e.length)for(;r--&&Dm(t[r],e[r]););return r===-1}if(!n||typeof t=="object"){r=0;for(n in t)if(kw.call(t,n)&&++r&&!kw.call(e,n)||!(n in e)||!Dm(t[n],e[n]))return!1;return Object.keys(e).length===r}}return t!==t&&e!==e}const Br=new WeakMap,xi=()=>{},Sn=xi(),jm=Object,qe=t=>t===Sn,Ir=t=>typeof t=="function",Ki=(t,e)=>({...t,...e}),UI=t=>Ir(t.then),Kh={},Rc={},Bg="undefined",Gl=typeof window!=Bg,Mm=typeof document!=Bg,NO=Gl&&"Deno"in window,kO=()=>Gl&&typeof window.requestAnimationFrame!=Bg,BI=(t,e)=>{const n=Br.get(t);return[()=>!qe(e)&&t.get(e)||Kh,r=>{if(!qe(e)){const i=t.get(e);e in Rc||(Rc[e]=i),n[5](e,Ki(i,r),i||Kh)}},n[6],()=>!qe(e)&&e in Rc?Rc[e]:!qe(e)&&t.get(e)||Kh]};let Om=!0;const PO=()=>Om,[Lm,Vm]=Gl&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[xi,xi],RO=()=>{const t=Mm&&document.visibilityState;return qe(t)||t!=="hidden"},DO=t=>(Mm&&document.addEventListener("visibilitychange",t),Lm("focus",t),()=>{Mm&&document.removeEventListener("visibilitychange",t),Vm("focus",t)}),jO=t=>{const e=()=>{Om=!0,t()},n=()=>{Om=!1};return Lm("online",e),Lm("offline",n),()=>{Vm("online",e),Vm("offline",n)}},MO={isOnline:PO,isVisible:RO},OO={initFocus:DO,initReconnect:jO},Pw=!We.useId,Al=!Gl||NO,LO=t=>kO()?window.requestAnimationFrame(t):setTimeout(t,1),Yh=Al?C.useEffect:C.useLayoutEffect,Xh=typeof navigator<"u"&&navigator.connection,Rw=!Al&&Xh&&(["slow-2g","2g"].includes(Xh.effectiveType)||Xh.saveData),Dc=new WeakMap,VO=t=>jm.prototype.toString.call(t),Jh=(t,e)=>t===`[object ${e}]`;let FO=0;const Fm=t=>{const e=typeof t,n=VO(t),r=Jh(n,"Date"),i=Jh(n,"RegExp"),s=Jh(n,"Object");let o,l;if(jm(t)===t&&!r&&!i){if(o=Dc.get(t),o)return o;if(o=++FO+"~",Dc.set(t,o),Array.isArray(t)){for(o="@",l=0;l<t.length;l++)o+=Fm(t[l])+",";Dc.set(t,o)}if(s){o="#";const a=jm.keys(t).sort();for(;!qe(l=a.pop());)qe(t[l])||(o+=l+":"+Fm(t[l])+",");Dc.set(t,o)}}else o=r?t.toJSON():e=="symbol"?t.toString():e=="string"?JSON.stringify(t):""+t;return o},$g=t=>{if(Ir(t))try{t=t()}catch{t=""}const e=t;return t=typeof t=="string"?t:(Array.isArray(t)?t.length:t)?Fm(t):"",[t,e]};let UO=0;const Um=()=>++UO;async function $I(...t){const[e,n,r,i]=t,s=Ki({populateCache:!0,throwOnError:!0},typeof i=="boolean"?{revalidate:i}:i||{});let o=s.populateCache;const l=s.rollbackOnError;let a=s.optimisticData;const d=m=>typeof l=="function"?l(m):l!==!1,h=s.throwOnError;if(Ir(n)){const m=n,g=[],S=e.keys();for(const _ of S)!/^\$(inf|sub)\$/.test(_)&&m(e.get(_)._k)&&g.push(_);return Promise.all(g.map(f))}return f(n);async function f(m){const[g]=$g(m);if(!g)return;const[S,_]=BI(e,g),[A,v,w,b]=Br.get(e),j=()=>{const te=A[g];return(Ir(s.revalidate)?s.revalidate(S().data,m):s.revalidate!==!1)&&(delete w[g],delete b[g],te&&te[0])?te[0](FI).then(()=>S().data):S().data};if(t.length<3)return j();let M=r,U,x=!1;const I=Um();v[g]=[I,0];const R=!qe(a),E=S(),T=E.data,k=E._c,N=qe(k)?T:k;if(R&&(a=Ir(a)?a(N,T):a,_({data:a,_c:N})),Ir(M))try{M=M(N)}catch(te){U=te,x=!0}if(M&&UI(M))if(M=await M.catch(te=>{U=te,x=!0}),I!==v[g][0]){if(x)throw U;return M}else x&&R&&d(U)&&(o=!0,_({data:N,_c:Sn}));if(o&&!x)if(Ir(o)){const te=o(M,N);_({data:te,error:Sn,_c:Sn})}else _({data:M,error:Sn,_c:Sn});if(v[g][1]=Um(),Promise.resolve(j()).then(()=>{_({_c:Sn})}),x){if(h)throw U;return}return M}}const Dw=(t,e)=>{for(const n in t)t[n][0]&&t[n][0](e)},BO=(t,e)=>{if(!Br.has(t)){const n=Ki(OO,e),r=Object.create(null),i=$I.bind(Sn,t);let s=xi;const o=Object.create(null),l=(h,f)=>{const m=o[h]||[];return o[h]=m,m.push(f),()=>m.splice(m.indexOf(f),1)},a=(h,f,m)=>{t.set(h,f);const g=o[h];if(g)for(const S of g)S(f,m)},d=()=>{if(!Br.has(t)&&(Br.set(t,[r,Object.create(null),Object.create(null),Object.create(null),i,a,l]),!Al)){const h=n.initFocus(setTimeout.bind(Sn,Dw.bind(Sn,r,LI))),f=n.initReconnect(setTimeout.bind(Sn,Dw.bind(Sn,r,VI)));s=()=>{h&&h(),f&&f(),Br.delete(t)}}};return d(),[t,i,d,s]}return[t,Br.get(t)[4]]},$O=(t,e,n,r,i)=>{const s=n.errorRetryCount,o=i.retryCount,l=~~((Math.random()+.5)*(1<<(o<8?o:8)))*n.errorRetryInterval;!qe(s)&&o>s||setTimeout(r,l,i)},zO=Dm,[zI,HO]=BO(new Map),WO=Ki({onLoadingSlow:xi,onSuccess:xi,onError:xi,onErrorRetry:$O,onDiscarded:xi,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:Rw?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:Rw?5e3:3e3,compare:zO,isPaused:()=>!1,cache:zI,mutate:HO,fallback:{}},MO),qO=(t,e)=>{const n=Ki(t,e);if(e){const{use:r,fallback:i}=t,{use:s,fallback:o}=e;r&&s&&(n.use=r.concat(s)),i&&o&&(n.fallback=Ki(i,o))}return n},GO=C.createContext({}),QO="$inf$",HI=Gl&&window.__SWR_DEVTOOLS_USE__,KO=HI?window.__SWR_DEVTOOLS_USE__:[],YO=()=>{HI&&(window.__SWR_DEVTOOLS_REACT__=We)},XO=t=>Ir(t[1])?[t[0],t[1],t[2]||{}]:[t[0],null,(t[1]===null?t[2]:t[1])||{}],JO=()=>{const t=C.useContext(GO);return C.useMemo(()=>Ki(WO,t),[t])},ZO=t=>(e,n,r)=>t(e,n&&((...s)=>{const[o]=$g(e),[,,,l]=Br.get(zI);if(o.startsWith(QO))return n(...s);const a=l[o];return qe(a)?n(...s):(delete l[o],a)}),r),eL=KO.concat(ZO),tL=t=>function(...n){const r=JO(),[i,s,o]=XO(n),l=qO(r,o);let a=t;const{use:d}=l,h=(d||[]).concat(eL);for(let f=h.length;f--;)a=h[f](a);return a(i,s||l.fetcher||null,l)},nL=(t,e,n)=>{const r=e[t]||(e[t]=[]);return r.push(n),()=>{const i=r.indexOf(n);i>=0&&(r[i]=r[r.length-1],r.pop())}};YO();const Zh=We.use||(t=>{switch(t.status){case"pending":throw t;case"fulfilled":return t.value;case"rejected":throw t.reason;default:throw t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}),t}}),ef={dedupe:!0},jw=Promise.resolve(Sn),rL=(t,e,n)=>{const{cache:r,compare:i,suspense:s,fallbackData:o,revalidateOnMount:l,revalidateIfStale:a,refreshInterval:d,refreshWhenHidden:h,refreshWhenOffline:f,keepPreviousData:m}=n,[g,S,_,A]=Br.get(r),[v,w]=$g(t),b=C.useRef(!1),j=C.useRef(!1),M=C.useRef(v),U=C.useRef(e),x=C.useRef(n),I=()=>x.current,R=()=>I().isVisible()&&I().isOnline(),[E,T,k,N]=BI(r,v),te=C.useRef({}).current,J=qe(o)?qe(n.fallback)?Sn:n.fallback[v]:o,ne=(O,Q)=>{for(const F in te){const oe=F;if(oe==="data"){if(!i(O[oe],Q[oe])&&(!qe(O[oe])||!i(ae,Q[oe])))return!1}else if(Q[oe]!==O[oe])return!1}return!0},ce=C.useMemo(()=>{const O=!v||!e?!1:qe(l)?I().isPaused()||s?!1:a!==!1:l,Q=pe=>{const De=Ki(pe);return delete De._k,O?{isValidating:!0,isLoading:!0,...De}:De},F=E(),oe=N(),re=Q(F),de=F===oe?re:Q(oe);let ue=re;return[()=>{const pe=Q(E());return ne(pe,ue)?(ue.data=pe.data,ue.isLoading=pe.isLoading,ue.isValidating=pe.isValidating,ue.error=pe.error,ue):(ue=pe,pe)},()=>de]},[r,v]),V=AO.useSyncExternalStore(C.useCallback(O=>k(v,(Q,F)=>{ne(F,Q)||O()}),[r,v]),ce[0],ce[1]),K=!b.current,B=g[v]&&g[v].length>0,X=V.data,$=qe(X)?J&&UI(J)?Zh(J):J:X,Z=V.error,q=C.useRef($),ae=m?qe(X)?qe(q.current)?$:q.current:X:$,D=B&&!qe(Z)?!1:K&&!qe(l)?l:I().isPaused()?!1:s?qe($)?!1:a:qe($)||a,G=!!(v&&e&&K&&D),L=qe(V.isValidating)?G:V.isValidating,H=qe(V.isLoading)?G:V.isLoading,z=C.useCallback(async O=>{const Q=U.current;if(!v||!Q||j.current||I().isPaused())return!1;let F,oe,re=!0;const de=O||{},ue=!_[v]||!de.dedupe,pe=()=>Pw?!j.current&&v===M.current&&b.current:v===M.current,De={isValidating:!1,isLoading:!1},Ze=()=>{T(De)},Tt=()=>{const Ie=_[v];Ie&&Ie[1]===oe&&delete _[v]},we={isValidating:!0};qe(E().data)&&(we.isLoading=!0);try{if(ue&&(T(we),n.loadingTimeout&&qe(E().data)&&setTimeout(()=>{re&&pe()&&I().onLoadingSlow(v,n)},n.loadingTimeout),_[v]=[Q(w),Um()]),[F,oe]=_[v],F=await F,ue&&setTimeout(Tt,n.dedupingInterval),!_[v]||_[v][1]!==oe)return ue&&pe()&&I().onDiscarded(v),!1;De.error=Sn;const Ie=S[v];if(!qe(Ie)&&(oe<=Ie[0]||oe<=Ie[1]||Ie[1]===0))return Ze(),ue&&pe()&&I().onDiscarded(v),!1;const Qe=E().data;De.data=i(Qe,F)?Qe:F,ue&&pe()&&I().onSuccess(F,v,n)}catch(Ie){Tt();const Qe=I(),{shouldRetryOnError:Ve}=Qe;Qe.isPaused()||(De.error=Ie,ue&&pe()&&(Qe.onError(Ie,v,Qe),(Ve===!0||Ir(Ve)&&Ve(Ie))&&(!I().revalidateOnFocus||!I().revalidateOnReconnect||R())&&Qe.onErrorRetry(Ie,v,Qe,mn=>{const Zt=g[v];Zt&&Zt[0]&&Zt[0](Nw,mn)},{retryCount:(de.retryCount||0)+1,dedupe:!0})))}return re=!1,Ze(),!0},[v,r]),se=C.useCallback((...O)=>$I(r,M.current,...O),[]);if(Yh(()=>{U.current=e,x.current=n,qe(X)||(q.current=X)}),Yh(()=>{if(!v)return;const O=z.bind(Sn,ef);let Q=0;I().revalidateOnFocus&&(Q=Date.now()+I().focusThrottleInterval);const oe=nL(v,g,(re,de={})=>{if(re==LI){const ue=Date.now();I().revalidateOnFocus&&ue>Q&&R()&&(Q=ue+I().focusThrottleInterval,O())}else if(re==VI)I().revalidateOnReconnect&&R()&&O();else{if(re==FI)return z();if(re==Nw)return z(de)}});return j.current=!1,M.current=v,b.current=!0,T({_k:w}),D&&(_[v]||(qe($)||Al?O():LO(O))),()=>{j.current=!0,oe()}},[v]),Yh(()=>{let O;function Q(){const oe=Ir(d)?d(E().data):d;oe&&O!==-1&&(O=setTimeout(F,oe))}function F(){!E().error&&(h||I().isVisible())&&(f||I().isOnline())?z(ef).then(Q):Q()}return Q(),()=>{O&&(clearTimeout(O),O=-1)}},[d,h,f,v]),C.useDebugValue(ae),s){const O=v&&qe($);if(!Pw&&Al&&O)throw new Error("Fallback data is required when using Suspense in SSR.");O&&(U.current=e,x.current=n,j.current=!1);const Q=A[v],F=!qe(Q)&&O?se(Q):jw;if(Zh(F),!qe(Z)&&O)throw Z;const oe=O?z(ef):jw;!qe(ae)&&O&&(oe.status="fulfilled",oe.value=!0),Zh(oe)}return{mutate:se,get data(){return te.data=!0,ae},get error(){return te.error=!0,Z},get isValidating(){return te.isValidating=!0,L},get isLoading(){return te.isLoading=!0,H}}},iL=tL(rL);function Bm(){return Bm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Bm.apply(null,arguments)}function Mw(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function $m(t,e){return $m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},$m(t,e)}function sL(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,$m(t,e)}var Ow=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function oL(t,e){return!!(t===e||Ow(t)&&Ow(e))}function aL(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!oL(t[n],e[n]))return!1;return!0}function tf(t,e){e===void 0&&(e=aL);var n,r=[],i,s=!1;function o(){for(var l=[],a=0;a<arguments.length;a++)l[a]=arguments[a];return s&&n===this&&e(l,r)||(i=t.apply(this,l),s=!0,n=this,r=l),i}return o}var lL=typeof performance=="object"&&typeof performance.now=="function",Lw=lL?function(){return performance.now()}:function(){return Date.now()};function Vw(t){cancelAnimationFrame(t.id)}function cL(t,e){var n=Lw();function r(){Lw()-n>=e?t.call(null):i.id=requestAnimationFrame(r)}var i={id:requestAnimationFrame(r)};return i}var nf=-1;function Fw(t){if(t===void 0&&(t=!1),nf===-1||t){var e=document.createElement("div"),n=e.style;n.width="50px",n.height="50px",n.overflow="scroll",document.body.appendChild(e),nf=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return nf}var Xs=null;function Uw(t){if(t===void 0&&(t=!1),Xs===null||t){var e=document.createElement("div"),n=e.style;n.width="50px",n.height="50px",n.overflow="scroll",n.direction="rtl";var r=document.createElement("div"),i=r.style;return i.width="100px",i.height="100px",e.appendChild(r),document.body.appendChild(e),e.scrollLeft>0?Xs="positive-descending":(e.scrollLeft=1,e.scrollLeft===0?Xs="negative":Xs="positive-ascending"),document.body.removeChild(e),Xs}return Xs}var uL=150,dL=function(e,n){return e};function hL(t){var e,n=t.getItemOffset,r=t.getEstimatedTotalSize,i=t.getItemSize,s=t.getOffsetForIndexAndAlignment,o=t.getStartIndexForOffset,l=t.getStopIndexForStartIndex,a=t.initInstanceProps,d=t.shouldResetStyleCacheOnItemSizeChange,h=t.validateProps;return e=function(f){sL(m,f);function m(S){var _;return _=f.call(this,S)||this,_._instanceProps=a(_.props,Mw(_)),_._outerRef=void 0,_._resetIsScrollingTimeoutId=null,_.state={instance:Mw(_),isScrolling:!1,scrollDirection:"forward",scrollOffset:typeof _.props.initialScrollOffset=="number"?_.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},_._callOnItemsRendered=void 0,_._callOnItemsRendered=tf(function(A,v,w,b){return _.props.onItemsRendered({overscanStartIndex:A,overscanStopIndex:v,visibleStartIndex:w,visibleStopIndex:b})}),_._callOnScroll=void 0,_._callOnScroll=tf(function(A,v,w){return _.props.onScroll({scrollDirection:A,scrollOffset:v,scrollUpdateWasRequested:w})}),_._getItemStyle=void 0,_._getItemStyle=function(A){var v=_.props,w=v.direction,b=v.itemSize,j=v.layout,M=_._getItemStyleCache(d&&b,d&&j,d&&w),U;if(M.hasOwnProperty(A))U=M[A];else{var x=n(_.props,A,_._instanceProps),I=i(_.props,A,_._instanceProps),R=w==="horizontal"||j==="horizontal",E=w==="rtl",T=R?x:0;M[A]=U={position:"absolute",left:E?void 0:T,right:E?T:void 0,top:R?0:x,height:R?"100%":I,width:R?I:"100%"}}return U},_._getItemStyleCache=void 0,_._getItemStyleCache=tf(function(A,v,w){return{}}),_._onScrollHorizontal=function(A){var v=A.currentTarget,w=v.clientWidth,b=v.scrollLeft,j=v.scrollWidth;_.setState(function(M){if(M.scrollOffset===b)return null;var U=_.props.direction,x=b;if(U==="rtl")switch(Uw()){case"negative":x=-b;break;case"positive-descending":x=j-w-b;break}return x=Math.max(0,Math.min(x,j-w)),{isScrolling:!0,scrollDirection:M.scrollOffset<x?"forward":"backward",scrollOffset:x,scrollUpdateWasRequested:!1}},_._resetIsScrollingDebounced)},_._onScrollVertical=function(A){var v=A.currentTarget,w=v.clientHeight,b=v.scrollHeight,j=v.scrollTop;_.setState(function(M){if(M.scrollOffset===j)return null;var U=Math.max(0,Math.min(j,b-w));return{isScrolling:!0,scrollDirection:M.scrollOffset<U?"forward":"backward",scrollOffset:U,scrollUpdateWasRequested:!1}},_._resetIsScrollingDebounced)},_._outerRefSetter=function(A){var v=_.props.outerRef;_._outerRef=A,typeof v=="function"?v(A):v!=null&&typeof v=="object"&&v.hasOwnProperty("current")&&(v.current=A)},_._resetIsScrollingDebounced=function(){_._resetIsScrollingTimeoutId!==null&&Vw(_._resetIsScrollingTimeoutId),_._resetIsScrollingTimeoutId=cL(_._resetIsScrolling,uL)},_._resetIsScrolling=function(){_._resetIsScrollingTimeoutId=null,_.setState({isScrolling:!1},function(){_._getItemStyleCache(-1,null)})},_}m.getDerivedStateFromProps=function(_,A){return fL(_,A),h(_),null};var g=m.prototype;return g.scrollTo=function(_){_=Math.max(0,_),this.setState(function(A){return A.scrollOffset===_?null:{scrollDirection:A.scrollOffset<_?"forward":"backward",scrollOffset:_,scrollUpdateWasRequested:!0}},this._resetIsScrollingDebounced)},g.scrollToItem=function(_,A){A===void 0&&(A="auto");var v=this.props,w=v.itemCount,b=v.layout,j=this.state.scrollOffset;_=Math.max(0,Math.min(_,w-1));var M=0;if(this._outerRef){var U=this._outerRef;b==="vertical"?M=U.scrollWidth>U.clientWidth?Fw():0:M=U.scrollHeight>U.clientHeight?Fw():0}this.scrollTo(s(this.props,_,A,j,this._instanceProps,M))},g.componentDidMount=function(){var _=this.props,A=_.direction,v=_.initialScrollOffset,w=_.layout;if(typeof v=="number"&&this._outerRef!=null){var b=this._outerRef;A==="horizontal"||w==="horizontal"?b.scrollLeft=v:b.scrollTop=v}this._callPropsCallbacks()},g.componentDidUpdate=function(){var _=this.props,A=_.direction,v=_.layout,w=this.state,b=w.scrollOffset,j=w.scrollUpdateWasRequested;if(j&&this._outerRef!=null){var M=this._outerRef;if(A==="horizontal"||v==="horizontal")if(A==="rtl")switch(Uw()){case"negative":M.scrollLeft=-b;break;case"positive-ascending":M.scrollLeft=b;break;default:var U=M.clientWidth,x=M.scrollWidth;M.scrollLeft=x-U-b;break}else M.scrollLeft=b;else M.scrollTop=b}this._callPropsCallbacks()},g.componentWillUnmount=function(){this._resetIsScrollingTimeoutId!==null&&Vw(this._resetIsScrollingTimeoutId)},g.render=function(){var _=this.props,A=_.children,v=_.className,w=_.direction,b=_.height,j=_.innerRef,M=_.innerElementType,U=_.innerTagName,x=_.itemCount,I=_.itemData,R=_.itemKey,E=R===void 0?dL:R,T=_.layout,k=_.outerElementType,N=_.outerTagName,te=_.style,J=_.useIsScrolling,ne=_.width,ce=this.state.isScrolling,V=w==="horizontal"||T==="horizontal",K=V?this._onScrollHorizontal:this._onScrollVertical,B=this._getRangeToRender(),X=B[0],$=B[1],Z=[];if(x>0)for(var q=X;q<=$;q++)Z.push(C.createElement(A,{data:I,key:E(q,I),index:q,isScrolling:J?ce:void 0,style:this._getItemStyle(q)}));var ae=r(this.props,this._instanceProps);return C.createElement(k||N||"div",{className:v,onScroll:K,ref:this._outerRefSetter,style:Bm({position:"relative",height:b,width:ne,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:w},te)},C.createElement(M||U||"div",{children:Z,ref:j,style:{height:V?"100%":ae,pointerEvents:ce?"none":void 0,width:V?ae:"100%"}}))},g._callPropsCallbacks=function(){if(typeof this.props.onItemsRendered=="function"){var _=this.props.itemCount;if(_>0){var A=this._getRangeToRender(),v=A[0],w=A[1],b=A[2],j=A[3];this._callOnItemsRendered(v,w,b,j)}}if(typeof this.props.onScroll=="function"){var M=this.state,U=M.scrollDirection,x=M.scrollOffset,I=M.scrollUpdateWasRequested;this._callOnScroll(U,x,I)}},g._getRangeToRender=function(){var _=this.props,A=_.itemCount,v=_.overscanCount,w=this.state,b=w.isScrolling,j=w.scrollDirection,M=w.scrollOffset;if(A===0)return[0,0,0,0];var U=o(this.props,M,this._instanceProps),x=l(this.props,U,M,this._instanceProps),I=!b||j==="backward"?Math.max(1,v):1,R=!b||j==="forward"?Math.max(1,v):1;return[Math.max(0,U-I),Math.max(0,Math.min(A-1,x+R)),U,x]},m}(C.PureComponent),e.defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},e}var fL=function(e,n){e.children,e.direction,e.height,e.layout,e.innerTagName,e.outerTagName,e.width,n.instance},mL=hL({getItemOffset:function(e,n){var r=e.itemSize;return n*r},getItemSize:function(e,n){var r=e.itemSize;return r},getEstimatedTotalSize:function(e){var n=e.itemCount,r=e.itemSize;return r*n},getOffsetForIndexAndAlignment:function(e,n,r,i,s,o){var l=e.direction,a=e.height,d=e.itemCount,h=e.itemSize,f=e.layout,m=e.width,g=l==="horizontal"||f==="horizontal",S=g?m:a,_=Math.max(0,d*h-S),A=Math.min(_,n*h),v=Math.max(0,n*h-S+h+o);switch(r==="smart"&&(i>=v-S&&i<=A+S?r="auto":r="center"),r){case"start":return A;case"end":return v;case"center":{var w=Math.round(v+(A-v)/2);return w<Math.ceil(S/2)?0:w>_+Math.floor(S/2)?_:w}case"auto":default:return i>=v&&i<=A?i:i<v?v:A}},getStartIndexForOffset:function(e,n){var r=e.itemCount,i=e.itemSize;return Math.max(0,Math.min(r-1,Math.floor(n/i)))},getStopIndexForStartIndex:function(e,n,r){var i=e.direction,s=e.height,o=e.itemCount,l=e.itemSize,a=e.layout,d=e.width,h=i==="horizontal"||a==="horizontal",f=n*l,m=h?d:s,g=Math.ceil((m+r-f)/l);return Math.max(0,Math.min(o-1,n+g-1))},initInstanceProps:function(e){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(e){e.itemSize}});const pL="kusgan-local-cache",gL=1,Nl="kv",zg="state",rf="__kusgan_sync_lock__";let tt={members:[],attendance:[],payments:[],gymEntries:[],progress:[],queue:[]},sf=null;function Hg(){return sf||(sf=NE(pL,gL,{upgrade(t){t.objectStoreNames.contains(Nl)||t.createObjectStore(Nl)}})),sf}async function yL(){try{const e=await(await Hg()).get(Nl,zg);e&&typeof e=="object"&&(tt=Object.assign(tt,e),tt.members||(tt.members=[]),tt.attendance||(tt.attendance=[]),tt.queue||(tt.queue=[]),tt.payments||(tt.payments=[]),tt.gymEntries||(tt.gymEntries=[]),tt.progress||(tt.progress=[]))}catch(t){console.warn("localCache: failed to load from idb",t&&t.message)}}async function $d(t){try{await(await Hg()).put(Nl,t,zg)}catch(e){console.warn("localCache: failed to write to idb",e&&e.message)}}function Os(){return tt||(tt={members:[],attendance:[],payments:[],gymEntries:[],progress:[],queue:[]}),tt.members||(tt.members=[]),tt.attendance||(tt.attendance=[]),tt.queue||(tt.queue=[]),tt.payments||(tt.payments=[]),tt.gymEntries||(tt.gymEntries=[]),tt.progress||(tt.progress=[]),tt}yL();function vL(t){return Os()[t]||[]}function _L(t,e){const n=Os();n[t]=Array.isArray(e)?e:[],$d(n).catch(()=>{})}function wL(t){const e=Os();e.queue.unshift(t),$d(e).catch(()=>{})}function WI(t){wL({id:"q-"+Date.now()+"-"+Math.floor(Math.random()*1e3),...t}),Wg()}function SL(t){const n=new Date().toISOString(),r=n.slice(0,10),i=n.slice(11,16),s="local-"+Date.now(),o={id:s,Staff:t,staff_name:t,Date:r,TimeIn:i,time_in:n,status:"On Duty",_localPending:!0},l=Os();return l.attendance=[o,...l.attendance||[]],$d(l).catch(()=>{}),WI({method:"POST",path:"/attendance/kiosk",body:{staff_name:t},tempId:s,collection:"attendance"}),o}async function EL(t){try{const e=Xa&&typeof Xa=="function"?Xa():null,n={"Content-Type":"application/json"};e&&(n.Authorization=`Bearer ${e}`);const r=await fetch(t.path,{method:t.method||"POST",headers:n,body:JSON.stringify(t.body||{})}),i=await r.json().catch(()=>({}));if(!r.ok)throw new Error(i&&i.error?i.error:"Request failed");return{ok:!0,json:i}}catch(e){return{ok:!1,error:String(e&&e.message||e)}}}async function Wg(){if(!window[rf]){window[rf]=!0;try{let t=Os();for(;(t.queue||[]).length;){const e=t.queue[t.queue.length-1];if(!e)break;const n=await EL(e);if(n.ok){if(t=Os(),t.queue=(t.queue||[]).filter(r=>r.id!==e.id),e.collection==="attendance"&&e.tempId)try{const r=n.json&&(n.json.row||n.json);r&&(t.attendance=(t.attendance||[]).map(i=>i.id===e.tempId?r:i))}catch{}if(e.collection==="members"&&e.tempId)try{const r=n.json&&(n.json.row||n.json);r&&(t.members=(t.members||[]).map(i=>i.id===e.tempId?r:i))}catch{}$d(t).catch(()=>{})}else break}}finally{window[rf]=!1}}}window.addEventListener&&window.addEventListener("online",()=>{Wg()});async function TL(){try{tt={members:[],attendance:[],payments:[],gymEntries:[],progress:[],queue:[]},await(await Hg()).delete(Nl,zg)}catch(t){console.warn("localCache.clearCache failed",t&&t.message)}}Os();const Fn={getCached:vL,setCached:_L,addOptimisticAttendance:SL,enqueueWrite:WI,processQueue:Wg,clearCache:TL},IL=We.lazy(()=>vO(()=>import("./AddMemberModal-Ct2x2RWu.js"),[])),Lt={members:null,payments:null,gymEntries:null,ts:{members:0,payments:0,gymEntries:0}},zm="kusgan.members.cache.v1",bL=1e3*60*60;function xL(){try{if(typeof window>"u"||!window.localStorage)return;const t=window.localStorage.getItem(zm);if(!t)return;const e=JSON.parse(t);if(!e||!e.ts||Date.now()-(e.ts.members||0)>bL)return;Lt.members=e.members||null,Lt.payments=e.payments||null,Lt.gymEntries=e.gymEntries||null,Lt.ts=e.ts||Lt.ts}catch(t){console.debug("Members: failed to load cache from localStorage",t)}}function CL(){try{if(typeof window>"u"||!window.localStorage)return;const t={members:Lt.members,payments:Lt.payments,gymEntries:Lt.gymEntries,ts:Lt.ts};typeof window.requestIdleCallback=="function"?window.requestIdleCallback(()=>{try{window.localStorage.setItem(zm,JSON.stringify(t))}catch(e){console.debug("Members: failed to save cache to localStorage",e)}},{timeout:2e3}):setTimeout(()=>{try{window.localStorage.setItem(zm,JSON.stringify(t))}catch(e){console.debug("Members: failed to save cache to localStorage",e)}},0)}catch(t){console.debug("Members: failed to save cache to localStorage",t)}}try{xL()}catch{}const AL=t=>String(t||"").trim().toLowerCase().replace(/\s+/g,"_"),Bw=t=>["yes","y","true","1"].includes(String(t||"").trim().toLowerCase()),Kt=(t,e)=>e.map(n=>t[n]).find(n=>n!==void 0&&n!==""),Si=t=>{if(t instanceof Date)return t;const e=new Date(t);return isNaN(e)?null:e},NL=(t,e)=>t&&e&&t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate(),Ja=t=>{const e={};return Object.entries(t||{}).forEach(([n,r])=>{e[AL(n)]=r}),e},$w=t=>{if(!t)return null;let n=Si(Kt(t,["member_since","membersince","member_date","memberdate","createdat","created_at","created","join_date","joined","start_date","memberdateexcel","membersinceexcel"]));if(n)return n;try{const r=t._raw||t;if(n=Kt(r,["MemberSince","Member Since","MemberDate","Member Date","createdAt","created_at","Created","Joined","Join Date","start_date"]),n)return Si(n)}catch{}return null},zw=t=>String(t||"").toLowerCase().replace(/(?:^|[\s\-])([a-z])/g,(n,r)=>n.replace(r,r.toUpperCase())),hi=t=>t?`${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()]}-${t.getDate()}, ${t.getFullYear()}`:"",jc=t=>{if(!t)return!1;const e=t instanceof Date?new Date(t):new Date(t);if(isNaN(e))return!1;const n=new Date;return n.setHours(0,0,0,0),e.setHours(0,0,0,0),e>=n};function Hw(t){const e=new Map;for(const r of t){const i=Ja(r),s=Kt(i,["memberid","member_id","id","member_id_"]);s&&(e.has(s)||e.set(s,[]),e.get(s).push(r))}const n=new Map;for(const[r,i]of e){const s=Zr(i);n.set(r,{membershipEnd:s.membershipEnd||null,coachEnd:s.coachEnd||null,membershipState:s.membershipState||null,coachActive:!!s.coachActive})}return n}function Ww(t){const e=new Map;for(const n of t){const r=Ja(n),i=Kt(r,["memberid","member_id","id","member_id_"]);if(!i)continue;const s=Si(Kt(r,["date","visit_date","entry_date","log_date","timestamp","checkin"]));if(!s)continue;const o=e.get(i);(!o||s>o)&&e.set(i,s)}return e}function kL(){const t=Yo(),[e,n]=C.useState(20),[r,i]=C.useState([]),[s,o]=C.useState(new Map),[l,a]=C.useState(new Map),[d,h]=C.useState(!0),[f,m]=C.useState(!1),[g,S]=C.useState(""),[_,A]=C.useState(""),[v,w]=C.useState(""),[b,j]=C.useState(!1),M=C.useRef(null),[U,x]=C.useState(!1),I=C.useRef(null),[R,E]=C.useState(600);C.useEffect(()=>{function $(){try{const Z=window.innerHeight||800,ae=Math.max(300,Z-220);E(ae)}catch{E(600)}}return $(),window.addEventListener("resize",$),()=>window.removeEventListener("resize",$)},[]);const T=async()=>{const[Z,q,ae]=await Promise.all([Re.fetchMembersRecent({days:5}),Re.fetchPayments(),Re.fetchGymEntries()]);return{members:((Z==null?void 0:Z.rows)??(Z==null?void 0:Z.data)??[]).map(Ja),payments:(q==null?void 0:q.rows)??(q==null?void 0:q.data)??[],gymEntries:(ae==null?void 0:ae.rows)??(ae==null?void 0:ae.data)??[]}},{data:k,error:N,isLoading:te,isValidating:J,mutate:ne}=iL("members:recent",T,{revalidateOnFocus:!0,dedupingInterval:2e3,fallbackData:Lt.members?{members:Lt.members,payments:Lt.payments,gymEntries:Lt.gymEntries}:void 0});C.useEffect(()=>{if(k)try{i(k.members||[]),o(Hw(k.payments||[])),a(Ww(k.gymEntries||[])),Lt.members=k.members||[],Lt.payments=k.payments||[],Lt.gymEntries=k.gymEntries||[],Lt.ts=Lt.ts||{},Lt.ts.members=Date.now(),Lt.ts.payments=Date.now(),Lt.ts.gymEntries=Date.now(),CL()}catch($){console.error("Members: failed to hydrate from SWR data",$)}},[k]),C.useEffect(()=>{try{const $=Fn.getCached("members")||[];$&&$.length&&i(Z=>Z&&Z.length?Z:$.map(Ja))}catch{}},[]),C.useEffect(()=>{let $=!1;async function Z(){if(v){h(!0);try{const[q,ae,D]=await Promise.all([Re.searchMembersByName(v),Re.fetchPayments(),Re.fetchGymEntries()]);if($)return;const G=((q==null?void 0:q.rows)??[]).map(Ja);i(G),o(Hw((ae==null?void 0:ae.rows)||[])),a(Ww((D==null?void 0:D.rows)||[]))}catch(q){$||S((q==null?void 0:q.message)||String(q))}finally{$||h(!1)}}}return v&&Z(),()=>{$=!0}},[v]),C.useEffect(()=>{h(!!te),m(!!te),N&&S(N.message||String(N))},[te,N]),C.useEffect(()=>(M.current&&clearTimeout(M.current),M.current=setTimeout(()=>w(_.trim()),250),()=>{M.current&&clearTimeout(M.current)}),[_]);const ce=C.useMemo(()=>{const $=v.trim().toLowerCase();let Z=r;$&&(Z=r.filter(D=>["first_name","firstname","last_name","lastname","nick_name","nickname","mobile","email"].some(G=>String(D[G]??"").toLowerCase().includes($))));const q=new Date,ae=Z.map(D=>{const G=Kt(D,["memberid","member_id","id","member_id_"]),L=G?l.get(G):null,H=L?NL(L,q):!1,z=Si(Kt(D,["member_since","membersince","member_date","memberdate","member_date","createdat","created_at","join_date","joined","start_date"])),se=z?z.getTime():0,ge=L?L.getTime():-1;return{r:D,lastVisit:L,isToday:H,joinTs:se,visitTs:ge,memberId:G}});return ae.sort((D,G)=>G.joinTs-D.joinTs||G.visitTs-D.visitTs),ae},[r,v,l]),V=(ce||[]).length,K=V?1:0,B=Math.min(e||0,V);return C.useCallback(($,Z)=>{$&&t(`/members/${encodeURIComponent($)}`,{state:{row:Z}})},[t]),u.jsxs("div",{className:"content",ref:I,style:{minHeight:"calc(100vh - 120px)",display:"flex",flexDirection:"column"},children:[u.jsxs("h2",{className:"dashboard-title",children:["All Members ",u.jsx(Ud,{show:J&&!te})]}),u.jsxs("div",{className:"toolbar",style:{display:"flex",justifyContent:"center",alignItems:"center",gap:12,marginBottom:12},children:[u.jsx("input",{className:"search-wide",style:{width:"60%",maxWidth:960,minWidth:320},placeholder:"Search members by name",value:_,onChange:$=>A($.target.value)}),u.jsx("button",{className:"button",onClick:()=>x(!0),children:"+ Add Member"})]}),d&&u.jsx("div",{style:{color:"var(--muted)",textAlign:"center",padding:16},children:"Loading"}),g&&u.jsxs("div",{children:["Error: ",g]}),!d&&!g&&u.jsxs("div",{className:"panel",style:{display:"flex",flexDirection:"column"},children:[r.length===0&&u.jsxs("div",{style:{padding:24,textAlign:"center",color:"#b91c1c",fontWeight:600},children:["No member data loaded.",u.jsx("br",{}),"Please check your API connection or try again later."]}),u.jsx("div",{style:{width:"100%"},children:ce.length===0?u.jsx("div",{style:{padding:12},children:"No members found."}):ce.length<=120?u.jsx("div",{className:"members-list-wrapper",style:{display:"flex",justifyContent:"center"},children:u.jsxs("table",{className:"attendance-table aligned",style:{width:"100%"},children:[u.jsxs("colgroup",{children:[u.jsx("col",{style:{width:"15%"}}),u.jsx("col",{style:{width:"25%"}}),u.jsx("col",{style:{width:"15%"}}),u.jsx("col",{style:{width:"15%"}}),u.jsx("col",{style:{width:"15%"}}),u.jsx("col",{style:{width:"15%"}})]}),u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{style:{textAlign:"center"},children:"Nick Name"}),u.jsx("th",{style:{textAlign:"center"},children:"Full Name"}),u.jsx("th",{style:{textAlign:"center"},children:"Member Since"}),u.jsx("th",{style:{textAlign:"center"},children:"Last Gym Visit"}),u.jsx("th",{style:{textAlign:"center"},children:"Gym Valid Until"}),u.jsx("th",{style:{textAlign:"center"},children:"Coach Valid Until"})]})}),u.jsx("tbody",{children:ce.slice(0,e).map(({r:$,lastVisit:Z,isToday:q,memberId:ae},D)=>{const G=ae?s.get(ae):void 0,L=Bw(Kt($,["student","is_student","student?"]));let H=Number(Kt($,["age","years_old"]));if(isNaN(H)){const de=Kt($,["birthday","birth_date","dob"]),ue=Si(de);if(ue){const pe=new Date;H=pe.getFullYear()-ue.getFullYear()-(pe.getMonth()<ue.getMonth()||pe.getMonth()===ue.getMonth()&&pe.getDate()<ue.getDate()?1:0)}}const z=!isNaN(H)&&H>=60,se=String(Kt($,["first_name","firstname","first","given_name"])??""),ge=String(Kt($,["last_name","lastname","last","surname"])??""),O=[se,ge].filter(Boolean).map(zw).join(" "),Q=String($.nick_name??$.nickname??"").toUpperCase(),F=$w($)||Si(Kt($,["member_since","membersince","member_date","memberdate","member_date","createdat","created_at","join_date","joined","start_date"])),oe=(G==null?void 0:G.membershipEnd)||null,re=(G==null?void 0:G.coachEnd)||null;return u.jsxs("tr",{className:"row-link",onClick:()=>t(`/members/${encodeURIComponent(ae)}`,{state:{row:$}}),style:{cursor:"pointer"},children:[u.jsx("td",{style:{textAlign:"center"},children:u.jsx("strong",{children:Q})}),u.jsxs("td",{style:{textAlign:"left"},children:[O," ",u.jsxs("span",{style:{display:"inline-flex",gap:6,marginLeft:8},children:[L&&u.jsx("span",{className:"pill student",children:"Student"}),z&&u.jsx("span",{className:"pill senior",children:"Senior"})]})]}),u.jsx("td",{style:{textAlign:"center"},children:hi(F)}),u.jsx("td",{style:{textAlign:"center"},children:q?u.jsx("span",{className:"pill ok",children:"Visited today"}):Z?hi(new Date(Z)):""}),u.jsx("td",{style:{textAlign:"center",color:oe?jc(oe)?"green":"red":"inherit"},children:oe?hi(new Date(oe)):""}),u.jsx("td",{style:{textAlign:"center",color:re?jc(re)?"green":"red":"inherit"},children:re?hi(new Date(re)):""})]},D)})})]})}):u.jsxs("div",{className:"members-list-wrapper",style:{width:"100%",display:"flex",flexDirection:"column",flex:1},children:[u.jsxs("div",{style:{display:"flex",padding:"8px 12px",fontWeight:700,borderBottom:"1px solid var(--light-border)",background:"var(--panel-header-bg)"},children:[u.jsx("div",{style:{width:"15%",textAlign:"center"},children:"Nick Name"}),u.jsx("div",{style:{width:"25%",textAlign:"left"},children:"Full Name"}),u.jsx("div",{style:{width:"15%",textAlign:"center"},children:"Member Since"}),u.jsx("div",{style:{width:"15%",textAlign:"center"},children:"Last Gym Visit"}),u.jsx("div",{style:{width:"15%",textAlign:"center"},children:"Gym Valid Until"}),u.jsx("div",{style:{width:"15%",textAlign:"center"},children:"Coach Valid Until"})]}),u.jsx(mL,{height:Math.min(R,Math.max(200,Math.min(ce.length,e)*56)),itemCount:Math.min(ce.length,e),itemSize:56,width:"100%",children:({index:$,style:Z})=>{const{r:q,lastVisit:ae,isToday:D,memberId:G}=ce[$],L=G?s.get(G):void 0,H=Bw(Kt(q,["student","is_student","student?"]));let z=Number(Kt(q,["age","years_old"]));if(isNaN(z)){const ue=Kt(q,["birthday","birth_date","dob"]),pe=Si(ue);if(pe){const De=new Date;z=De.getFullYear()-pe.getFullYear()-(De.getMonth()<pe.getMonth()||De.getMonth()===pe.getMonth()&&De.getDate()<pe.getDate()?1:0)}}const se=!isNaN(z)&&z>=60,ge=String(Kt(q,["first_name","firstname","first","given_name"])??""),O=String(Kt(q,["last_name","lastname","last","surname"])??""),Q=[ge,O].filter(Boolean).map(zw).join(" "),F=String(q.nick_name??q.nickname??"").toUpperCase(),oe=$w(q)||Si(Kt(q,["member_since","membersince","member_date","memberdate","member_date","createdat","created_at","join_date","joined","start_date"])),re=(L==null?void 0:L.membershipEnd)||null,de=(L==null?void 0:L.coachEnd)||null;return u.jsxs("div",{style:{...Z,display:"flex",alignItems:"center",padding:"8px 12px",borderBottom:"1px solid rgba(0,0,0,0.04)",cursor:"pointer"},className:"row-link",onClick:()=>t(`/members/${encodeURIComponent(G)}`,{state:{row:q}}),children:[u.jsx("div",{style:{width:"15%",textAlign:"center"},children:u.jsx("strong",{children:F})}),u.jsxs("div",{style:{width:"25%"},children:[Q,u.jsxs("span",{style:{display:"inline-flex",gap:6,marginLeft:8,verticalAlign:"middle"},children:[H&&u.jsx("span",{className:"pill student",children:"Student"}),se&&u.jsx("span",{className:"pill senior",children:"Senior"})]})]}),u.jsx("div",{style:{width:"15%",textAlign:"center"},children:hi(oe)}),u.jsx("div",{style:{width:"15%",textAlign:"center"},children:D?u.jsx("span",{className:"pill ok",children:"Visited today"}):ae?hi(new Date(ae)):""}),u.jsx("div",{style:{width:"15%",textAlign:"center",color:re?jc(re)?"green":"red":"inherit"},children:re?hi(new Date(re)):""}),u.jsx("div",{style:{width:"15%",textAlign:"center",color:de?jc(de)?"green":"red":"inherit"},children:de?hi(new Date(de)):""})]},$)}})]})}),u.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8},children:u.jsx("div",{className:"table-range",children:V===0?"Showing 0 of 0":`Showing ${K}${B} of ${V}`})}),V>e&&u.jsx("div",{style:{textAlign:"center",marginTop:8},children:u.jsx("button",{className:"button",onClick:()=>n($=>$<V?Math.min($+20,V):20),children:e<V?`Load ${Math.min(20,V-e)} more`:"Show less"})})]}),u.jsx(C.Suspense,{fallback:u.jsx(DI,{}),children:u.jsx(IL,{open:U,onClose:()=>x(!1),onSaved:async()=>{try{await ne()}catch{}}})})]})}function PL({open:t,onClose:e,onDetected:n}){const r=C.useRef(null),i=C.useRef(null),[s,o]=C.useState(""),l=C.useRef(0),a=C.useRef(null),d=()=>{l.current&&cancelAnimationFrame(l.current),l.current=0,i.current&&(i.current.getTracks().forEach(m=>m.stop()),i.current=null)};async function h(){var m,g;try{if("BarcodeDetector"in window){const S=await((g=(m=window.BarcodeDetector).getSupportedFormats)==null?void 0:g.call(m))||[];if(S.includes("qr_code")||S.includes("qr"))return a.current=new window.BarcodeDetector({formats:["qr_code"]}),!0}}catch{}return a.current=null,!1}async function f(){o("");const m=await h();try{const g=await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"}},audio:!1});i.current=g;const S=r.current;if(S&&(S.srcObject=g,await S.play().catch(()=>{})),m){const _=async()=>{if(!r.current||r.current.readyState<2){l.current=requestAnimationFrame(_);return}try{const A=await a.current.detect(r.current);if(A&&A.length){const v=String(A[0].rawValue||A[0].raw||"").trim();if(v){n==null||n(v),e==null||e();return}}}catch{}l.current=requestAnimationFrame(_)};l.current=requestAnimationFrame(_)}else o("QR scanning isn't supported by this browser. Type the ID instead.")}catch(g){const S=(g==null?void 0:g.name)||"";o(S==="NotAllowedError"?"Camera permission denied. Allow access in browser/site settings.":S==="NotFoundError"?"No camera found.":"Cannot access camera.")}}return C.useEffect(()=>{if(!t){d();return}return f(),d},[t]),t?u.jsx("div",{style:qw.overlay,children:u.jsxs("div",{style:qw.modal,children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[u.jsx("div",{style:{fontWeight:800},children:"Scan QR Code"}),u.jsx("button",{className:"button btn-lg",style:{background:"#555"},onClick:e,children:"Close"})]}),s&&u.jsx("div",{style:{color:"#d33",marginBottom:8},children:s}),u.jsx("video",{ref:r,playsInline:!0,muted:!0,style:{width:"100%",borderRadius:10,background:"#000"}}),u.jsx("div",{style:{color:"#666",fontSize:12,marginTop:8},children:"Point the camera at the QR code."})]})}):null}const qw={overlay:{position:"fixed",inset:0,background:"rgba(0,0,0,.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},modal:{width:"min(720px, 92vw)",background:"#fff",borderRadius:12,padding:16,border:"1px solid #e7e8ef",boxShadow:"0 6px 24px rgba(0,0,0,.2)"}},{fetchMemberBundle:RL,fetchPricing:Gw,fetchMembers:DL,fetchPayments:jL,fetchGymEntries:ML}=Re,Mc="Asia/Manila",OL=t=>{if(!t)return!1;const e=t instanceof Date?new Date(t):new Date(t);if(isNaN(e))return!1;const n=new Date;return n.setHours(0,0,0,0),e.setHours(0,0,0,0),e>=n},qI=t=>{const n=String(t||"").match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return n&&n[1]?n[1]:""},LL=t=>{const e=String(t||"");if(!e)return"";const n=e.match(/https?:\/\/[^\s}]+/);if(n){const i=n[0];if(/googleusercontent\.com\//.test(i))return i;const s=i.match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return s&&s[1]?`https://drive.google.com/uc?export=view&id=${s[1]}`:i}if(/googleusercontent\.com\//.test(e))return e;const r=qI(e);return r?`https://drive.google.com/uc?export=view&id=${r}`:e},VL=t=>{const e=String(t||"");if(/googleusercontent\.com\//.test(e))return e;const n=qI(e);return n?`https://drive.google.com/thumbnail?id=${n}&sz=w1000`:e};function FL(){const[t,e]=C.useState(!1),[n,r]=C.useState(""),[i,s]=C.useState([]),[o,l]=C.useState(null),[a,d]=C.useState([]),[h,f]=C.useState(null),[m,g]=C.useState(!1),[S,_]=C.useState(null),[A,v]=C.useState(""),[w,b]=C.useState(""),[j,M]=C.useState(""),[U,x]=C.useState(!1),[I,R]=C.useState(""),[E,T]=C.useState(""),[k,N]=C.useState(!1),[te,J]=C.useState(!1),ne=C.useRef(null),ce=C.useRef(null);C.useEffect(()=>{let B=!0;return(async()=>{try{const[X,$,Z]=await Promise.all([DL(),jL(),Gw()]);if(!B)return;const q=((X==null?void 0:X.rows)||(X==null?void 0:X.data)||[]).slice(),ae=($==null?void 0:$.rows)||($==null?void 0:$.data)||[],D=(Z==null?void 0:Z.rows)||(Z==null?void 0:Z.data)||[],G=await ML(),L=(G==null?void 0:G.rows)||(G==null?void 0:G.data)||[],H=new Intl.DateTimeFormat("en-CA",{timeZone:Mc,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date),z=q.filter(se=>{const ge=(se.MemberID||se.member_id||se.id||"").toString().trim(),O=ae.filter(de=>String(de.MemberID||de.member_id||de.id||"").trim()===String(ge).trim()),Q=Zr(O,ge,D);return Q.membershipState==="active"||OL(Q==null?void 0:Q.membershipEnd)?!L.filter(de=>{try{const ue=String(de.MemberID||de.memberId||de.memberid||de.id||"").trim();if(!ue||String(ue)!==String(ge))return!1;const pe=de.Date||de.date||de.DateTime||de.timestamp||de.checkin;return pe?new Intl.DateTimeFormat("en-CA",{timeZone:Mc,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date(pe))===H:!1}catch{return!1}}).some(de=>{try{const ue=String(de.TimeOut||de.timeOut||de.time_out||de.Timeout||"").trim();return ue?/\d/.test(ue)?!1:["-","","",""].includes(ue):!0}catch{return!0}}):!1});z.sort((se,ge)=>{const O=String(se.Nickname||se.NickName||se["Nick Name"]||"").toLowerCase(),Q=String(ge.Nickname||ge.NickName||ge["Nick Name"]||"").toLowerCase();return O.localeCompare(Q)}),s(z)}catch(X){console.error(X)}})(),()=>{B=!1}},[]),C.useEffect(()=>{J(!1)},[o==null?void 0:o.member]);const V=async B=>{const[X,$]=await Promise.all([RL(B),Gw()]),Z=($==null?void 0:$.rows)||($==null?void 0:$.data)||[];l(X),d(Z);const q=Zr(X.payments||[],B,Z);return f(q),{b:X,rows:Z,status:q}},K=async B=>{var L,H;const X=String(B||"").trim();if(!X)return;r(X),g(!0),M(""),l(null),f(null);const $=await V(X),Z=((L=$==null?void 0:$.b)==null?void 0:L.member)||null,q=$==null?void 0:$.status;if(Z&&(Z.NickName||Z.Nickname||Z["Nick Name"]||Z.nick_name||Z.nickname),!Z||(q==null?void 0:q.membershipState)!=="active"){M(null),setTimeout(()=>{M("NO ACTIVE GYM MEMBERSHIP")},100);return}const ae=new Intl.DateTimeFormat("en-CA",{timeZone:Mc,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date),G=(((H=$==null?void 0:$.b)==null?void 0:H.gymEntries)||[]).filter(z=>{const se=(z==null?void 0:z.Date)||(z==null?void 0:z.date);if(!se)return!1;const ge=new Date(se);return new Intl.DateTimeFormat("en-CA",{timeZone:Mc,year:"numeric",month:"2-digit",day:"2-digit"}).format(ge)===ae}).find(z=>!String((z==null?void 0:z.TimeOut)||"").trim());G?(N(!0),M(""),_(G||null)):(N(!1),M(""),_(null))};return C.useEffect(()=>{const B=async $=>{try{const Z=String($&&($.MemberID||$.memberid||$.Member)||"").trim();if(!Z||!n||String(Z)!==String(n))return;await V(n),_(null)}catch(Z){console.debug("CheckIn: gymEntry event handler failed",Z)}},X=sn.on("gymEntry:added",B);return()=>{try{X()}catch{}}},[n]),C.useMemo(()=>{const B=(o==null?void 0:o.member)||null;if(!B)return null;const X=L=>L.map(H=>B[H]).find(H=>H!==void 0&&H!==""),$=X(["FirstName","First","first"]),Z=X(["LastName","Last","last"]),q=X(["NickName","Nickname","Nick Name","nick_name","nickname"]),ae=X(["PhotoURL","Photo","photo","photo_url"]),D=VL(LL(ae)),G=B.MemberSince||B["Member Since"]||B.Joined||B["Join Date"]||B.join_date;return{first:$,last:Z,nick:q,photo:D,memberSince:G}},[o]),u.jsxs("div",{className:"content",children:[u.jsx("h2",{className:"dashboard-title",children:"Member Check-In"}),u.jsx("div",{className:"card",style:{marginTop:8,marginBottom:12,maxWidth:480,minHeight:600,marginLeft:"auto",marginRight:"auto",padding:16,border:"2px solid #d7d9e5",background:"#fff",boxShadow:"0 10px 24px rgba(0,0,0,.12)",display:"flex",alignItems:"center",justifyContent:"center"},children:u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12,alignItems:"center",width:"100%"},children:[u.jsx("img",{src:"/favicon.png",onError:B=>{try{B.currentTarget.onerror=null,B.currentTarget.src="/kusgan-logo.png"}catch{}},alt:"Kusgan logo",style:{width:250,height:250,objectFit:"contain",opacity:1,marginBottom:8}}),u.jsx("div",{style:{maxWidth:420,width:"100%",margin:"0 auto"},children:u.jsx("button",{className:"primary-btn",style:{fontSize:"1.1rem",height:54,width:"100%"},onClick:()=>e(!0),children:" Scan QR Code"})}),u.jsx("div",{style:{color:"#666",textAlign:"center",marginTop:24},children:"or select a member below"}),u.jsx("div",{style:{maxWidth:420,width:"100%",margin:"0 auto"},children:u.jsxs("select",{value:n,onChange:B=>r(B.target.value),style:{width:"100%",height:44,padding:"8px 12px",border:"1px solid #e7e8ef",borderRadius:10},children:[u.jsx("option",{value:"",children:"Select member"}),i.map(B=>{const X=String(B.MemberID||B.memberId||B.id||B.memberid||"").trim();return u.jsxs("option",{value:X,children:[B.Nickname||B.NickName||B["Nick Name"]||"Member","  ",B.FirstName||B.First||""," ",B.LastName||B.Last||""]},X||JSON.stringify(B))})]})}),u.jsx("div",{style:{maxWidth:420,width:"100%",margin:"0 auto"},children:u.jsx("button",{className:"primary-btn",style:{fontSize:"1.1rem",height:54,width:"100%"},onClick:()=>{n&&K(String(n).trim())},children:"Proceed"})})]})}),u.jsx(PL,{open:t,onClose:()=>e(!1),onDetected:K}),u.jsx(Bd,{open:m,memberId:n,initialEntry:S,onClose:()=>{g(!1),M("")},bundleOverride:o,pricingOverride:{rows:a},status:h,onSuccess:()=>{g(!1),M(""),l(null),f(null),_(null)}}),U&&u.jsx("div",{style:{position:"fixed",top:24,right:24,zIndex:2e3,pointerEvents:ne.current?"auto":"none"},children:u.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",background:"#333",color:"#fff",fontWeight:600,fontSize:16,borderRadius:8,boxShadow:"0 2px 12px rgba(0,0,0,.12)",padding:"10px 14px",minWidth:220,textAlign:"left",letterSpacing:.1},children:[u.jsx("div",{style:{flex:1},children:j}),ne.current?u.jsx("button",{style:{background:"transparent",color:"#fff",border:"1px solid rgba(255,255,255,0.18)",padding:"6px 10px",borderRadius:6,cursor:"pointer"},onClick:()=>{const B=ne.current;if(B){try{B.timer&&clearTimeout(B.timer)}catch{}ne.current=null,B.type==="checkin"?(N(!1),l(X=>{if(!X)return X;const $=(X.gymEntries||[]).filter(Z=>!(String(Z.MemberID||"")===String(B.memberId)&&String(Z.TimeIn||"")===String(B.nowIso)));return{...X,gymEntries:$}})):B.type==="checkout"&&(N(!0),l(X=>{if(!X)return X;const $=(X.gymEntries||[]).map(Z=>String(Z.MemberID||"")===String(B.memberId)&&String(Z.TimeOut||"").length>0?{...Z,TimeOut:""}:Z);return{...X,gymEntries:$}})),M("Action cancelled"),x(!0),ce.current&&clearTimeout(ce.current),ce.current=setTimeout(()=>{x(!1),M("")},1800)}},children:"Undo"}):null]})})]})}const UL=["Coach Jojo","Coach Elmer","Bezza","Jeanette","Johanna","Patpat","Sheena","Xyza"],Qn="Asia/Manila",Hm=t=>{if(!t)return"";try{const e=new Date(t);return new Intl.DateTimeFormat("en-PH",{hour:"numeric",minute:"2-digit",hour12:!0,timeZone:Qn}).format(e)}catch{return String(t)}},Qw=t=>{var e,n,r;if(!t)return"";try{const i=String(t||"");let s=null;if(/^\d{4}-\d{2}-\d{2}$/.test(i)?s=new Date(i+"T00:00:00"):s=new Date(i),isNaN(s))return i.slice(0,10);const o=new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",timeZone:Qn}).formatToParts(s),l=((e=o.find(h=>h.type==="month"))==null?void 0:e.value)||"",a=((n=o.find(h=>h.type==="day"))==null?void 0:n.value)||"",d=((r=o.find(h=>h.type==="year"))==null?void 0:r.value)||"";return`${l}-${a}, ${d}`}catch{return String(t)}},Oc=t=>{try{const e=(t==null?void 0:t.time_in)||(t==null?void 0:t.timeIn)||(t==null?void 0:t.TimeIn)||(t==null?void 0:t.TimeInISO)||null,n=(t==null?void 0:t.TimeIn)||(t==null?void 0:t.time_in_short)||null;if(e)return Hm(e);const r=String((t==null?void 0:t.TimeIn)||(t==null?void 0:t.time_in)||(t==null?void 0:t.TimeIn)||"");if(/^\d{1,2}:\d{2}$/.test(r)){const[i,s]=r.split(":").map(l=>Number(l)),o=new Date;return o.setHours(i,s,0,0),new Intl.DateTimeFormat("en-PH",{hour:"numeric",minute:"2-digit",hour12:!0,timeZone:Qn}).format(o)}return r||""}catch{return""}},wr=t=>{try{const e=(t==null?void 0:t.Date)||(t==null?void 0:t.date)||(t==null?void 0:t.time_in)||(t==null?void 0:t.timeIn)||(t==null?void 0:t.Timestamp)||(t==null?void 0:t.timestamp)||(t==null?void 0:t.TimestampISO)||(t==null?void 0:t.timestampISO)||"";if(e&&typeof e=="object"&&(e.seconds||e._seconds)){const i=e.seconds||e._seconds,s=new Date(i*1e3);return new Intl.DateTimeFormat("en-CA",{timeZone:Qn}).format(s)}const n=String(e||"").trim();if(!n)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(n))return n.slice(0,10);const r=new Date(n);return isNaN(r)?n.slice(0,10):new Intl.DateTimeFormat("en-CA",{timeZone:Qn}).format(r)}catch{return""}};function BL(){const[t,e]=C.useState(""),[n,r]=C.useState([]),[i,s]=C.useState([]),[o,l]=C.useState([]),[a,d]=C.useState(null),[h,f]=C.useState(!1),[m,g]=C.useState(!1),[S,_]=C.useState(""),A=D=>{if(!D)return!1;const G=String(D).trim().toLowerCase(),L=new Intl.DateTimeFormat("en-CA",{timeZone:Qn}).format(new Date);for(const H of n||[])try{const z=String((H==null?void 0:H.Staff)||(H==null?void 0:H.staff)||(H==null?void 0:H.staff_name)||"").trim().toLowerCase(),se=wr(H)||"",ge=String((H==null?void 0:H.TimeIn)||(H==null?void 0:H.time_in)||(H==null?void 0:H.timein)||"").trim(),O=String((H==null?void 0:H.TimeOut)||(H==null?void 0:H.time_out)||(H==null?void 0:H.timeout)||"").trim();if(z===G&&se===L&&ge&&(O===""||O==="-"||O===""||O===null||typeof O>"u"))return!0}catch{}return!1},v=async()=>{f(!0),_("");try{const D=Fn.getCached("attendance")||[];D&&D.length&&r(D);let G=[];try{if(Re&&typeof Re.fetchAttendance=="function"){const L=await Re.fetchAttendance();G=L&&(L.rows||L.data)?L.rows||L.data:Array.isArray(L)?L:[]}else{const H=await(await fetch("/attendance")).json();G=Array.isArray(H)?H:[]}}catch(L){console.warn("fetch attendance failed",L&&L.message),G=[]}r(G),Fn.setCached("attendance",G);try{const L=await Re.fetchMembers(),H=L&&(L.rows||L.data)?L.rows||L.data:Array.isArray(L)?L:[];l(Array.isArray(H)?H:[])}catch{}try{const L=await Re.fetchGymEntries(),H=L&&(L.rows||L.data)?L.rows||L.data:Array.isArray(L)?L:[];s(Array.isArray(H)?H:[])}catch{}Fn.processQueue()}catch(D){console.error("load attendance",D),_("Failed to load attendance")}finally{f(!1)}};C.useEffect(()=>{v()},[]);const w=new Intl.DateTimeFormat("en-CA",{timeZone:Qn}).format(new Date),[b,j]=C.useState(20),[M,U]=C.useState(20),x=["Coach Jojo","Coach Elmer"],[I,R]=C.useState(x[0]),[E,T]=C.useState([]),[k,N]=C.useState(0),te=C.useMemo(()=>{try{const D=new Set;(i||[]).forEach(L=>{const H=String((L==null?void 0:L.Coach)||(L==null?void 0:L.coach)||"").trim();H&&D.add(H)});const G=Array.from(D);return G.length?G:x}catch{return x}},[i]);C.useEffect(()=>{try{!I&&te&&te.length&&R(te[0]),I&&te&&te.length&&!te.includes(I)&&R(te[0])}catch{}},[te]);const J=(D,G)=>{try{if(!D||!G)return[];const L=new Date(D.getFullYear(),D.getMonth(),1),H=new Date(G.getFullYear(),G.getMonth(),G.getDate()),z=[];let se=new Date(L);for(;se<=H;){const O=se.getFullYear(),Q=se.getMonth(),F=new Date(O,Q,1),oe=new Date(O,Q,15),re=new Date(O,Q+1,0);z.push({label:`${F.toLocaleString("en-US",{month:"short"})} 1-15, ${O}`,start:new Intl.DateTimeFormat("en-CA",{timeZone:Qn}).format(F),end:new Intl.DateTimeFormat("en-CA",{timeZone:Qn}).format(oe)}),z.push({label:`${F.toLocaleString("en-US",{month:"short"})} 16-${re.getDate()}, ${O}`,start:new Intl.DateTimeFormat("en-CA",{timeZone:Qn}).format(new Date(O,Q,16)),end:new Intl.DateTimeFormat("en-CA",{timeZone:Qn}).format(re)}),se=new Date(O,Q+1,1)}const ge=[];for(const O of z)ge.find(Q=>Q.label===O.label)||ge.push(O);return ge}catch{return[]}};C.useEffect(()=>{try{if(!i||i.length===0){const Q=new Date,F="2025-11-16",re=J(new Date(2025,10,16),Q).filter(pe=>pe.end>=F);T(re);const de=w,ue=re.findIndex(pe=>pe.start<=de&&pe.end>=de);ue>=0&&N(ue);return}let D=null;for(const Q of i){const F=wr(Q)||"";if(!F)continue;const oe=new Date(F+"T00:00:00");isNaN(oe)||(!D||oe<D)&&(D=oe)}const G=new Date,L=D||new Date(G.getFullYear(),G.getMonth(),1),H=J(L,G),z="2025-11-16",se=H.filter(Q=>Q.end>=z);T(se);const ge=w,O=se.findIndex(Q=>Q.start<=ge&&Q.end>=ge);O>=0&&N(O)}catch{}},[i]);const ne=C.useMemo(()=>{try{const D=(()=>{const G=new Date;return G.setDate(G.getDate()-19),new Intl.DateTimeFormat("en-CA",{timeZone:Qn}).format(G)})();return(n||[]).filter(G=>{const L=wr(G)||"";return L&&L>=D&&(G.Staff||G.staff||G.staff_name)}).sort((G,L)=>{const H=(wr(G)||"0000-00-00")+"T"+String((G==null?void 0:G.TimeIn)||(G==null?void 0:G.time_in)||"00:00");return((wr(L)||"0000-00-00")+"T"+String((L==null?void 0:L.TimeIn)||(L==null?void 0:L.time_in)||"00:00")).localeCompare(H)})}catch{return[]}},[n]),ce=(ne||[]).length,V=ce?1:0,K=Math.min(b||0,ce),B=C.useMemo(()=>{try{if(!E||E.length===0)return[];const D=E[k]||E[0],G=(D==null?void 0:D.start)||"",L=(D==null?void 0:D.end)||"";return(i||[]).filter(z=>{try{const se=String((z==null?void 0:z.Coach)||(z==null?void 0:z.coach)||"").trim();if(!se)return!1;if(I){const O=se.toLowerCase().replace(/\s+/g,""),Q=String(I).toLowerCase().replace(/\s+/g,"");if(!(O.includes(Q)||Q.includes(O)))return!1}const ge=wr(z)||"";return ge?ge>=G&&ge<=L:!1}catch{return!1}}).sort((z,se)=>String((se==null?void 0:se.TimeIn)||(se==null?void 0:se.time_in)||"").localeCompare(String((z==null?void 0:z.TimeIn)||(z==null?void 0:z.time_in)||"")))}catch{return[]}},[i,E,I,k]),X=C.useMemo(()=>Rm(B),[B]),$=(B||[]).length,Z=$?1:0,q=Math.min(M||0,$),ae=async()=>{if(t){g(!0),_("");try{await v()}catch{}try{if(A(t)){const G=new Date().toISOString();r(L=>L&&(L||[]).map(z=>{try{const se=String((z==null?void 0:z.Staff)||(z==null?void 0:z.staff)||(z==null?void 0:z.staff_name)||"").trim(),ge=wr(z)||"",O=w,Q=String((z==null?void 0:z.TimeOut)||(z==null?void 0:z.time_out)||(z==null?void 0:z.timeout)||"").trim();if(se===String(t).trim()&&ge===O&&(!Q||Q==="-"||Q===""))return{...z,TimeOut:G}}catch{}return z}));try{if(Re&&typeof Re.attendanceQuickAppend=="function"){await Re.attendanceQuickAppend(t,{wantsOut:!0});const L=z=>new Promise(se=>setTimeout(se,z));let H=!1;for(let z=0;z<8;z++){try{const se=await Re.fetchAttendance(w),ge=(se==null?void 0:se.rows)||(se==null?void 0:se.data)||[];r(ge);const O=new Date;if(O.setHours(0,0,0,0),(ge||[]).some(F=>{try{const oe=String((F==null?void 0:F.Staff)||(F==null?void 0:F.staff)||(F==null?void 0:F.staff_name)||"").trim();if(!oe||oe.toLowerCase()!==String(t).trim().toLowerCase())return!1;const re=new Date(F.Date||F.date||F.TimeIn||F.time_in||"");if(isNaN(re)||(re.setHours(0,0,0,0),re.getTime()!==O.getTime()))return!1;const de=String((F==null?void 0:F.TimeOut)||(F==null?void 0:F.time_out)||(F==null?void 0:F.timeout)||"").trim();return!!de&&de!=="-"&&de!==""}catch{return!1}})){H=!0;break}}catch{}await L(300)}if(!H){const z=await Re.fetchAttendance(w);r((z==null?void 0:z.rows)||(z==null?void 0:z.data)||[])}}else Re&&typeof Re.clockOut=="function"?(await Re.clockOut(t),await v()):(Fn.enqueueWrite({method:"POST",path:"/attendance/kiosk",body:{staff_name:t,wantsOut:!0},collection:"attendance"}),await Fn.processQueue(),await v())}catch(L){console.warn("attendance clockOut failed, falling back to queue",L&&L.message),Fn.enqueueWrite({method:"POST",path:"/attendance/kiosk",body:{staff_name:t,wantsOut:!0},collection:"attendance"}),await Fn.processQueue(),await v()}}else{const G=Fn.addOptimisticAttendance(t);r(L=>{const H=(L||[]).filter(z=>String(z.id)!==String(G.id));return[G,...H]});try{if(Re&&typeof Re.attendanceQuickAppend=="function"){await Re.attendanceQuickAppend(t,{});const L=z=>new Promise(se=>setTimeout(se,z));let H=!1;for(let z=0;z<8;z++){try{const se=await Re.fetchAttendance(w),ge=(se==null?void 0:se.rows)||(se==null?void 0:se.data)||[];r(ge);const O=new Date;if(O.setHours(0,0,0,0),(ge||[]).some(F=>{try{const oe=String((F==null?void 0:F.Staff)||(F==null?void 0:F.staff)||(F==null?void 0:F.staff_name)||"").trim();if(!oe||oe.toLowerCase()!==String(t).trim().toLowerCase())return!1;const re=new Date(F.Date||F.date||F.TimeIn||F.time_in||"");return isNaN(re)||(re.setHours(0,0,0,0),re.getTime()!==O.getTime())?!1:!!String((F==null?void 0:F.TimeIn)||(F==null?void 0:F.time_in)||(F==null?void 0:F.TimeInISO)||(F==null?void 0:F.timeIn)||"").trim()}catch{return!1}})){H=!0;break}}catch{}await L(300)}if(!H){const z=await Re.fetchAttendance(w);r((z==null?void 0:z.rows)||(z==null?void 0:z.data)||[])}}else Re&&typeof Re.clockIn=="function"?(await Re.clockIn(t),await v()):(Fn.enqueueWrite({method:"POST",path:"/attendance/kiosk",body:{staff_name:t},tempId:G.id,collection:"attendance"}),await Fn.processQueue(),await v())}catch(L){console.warn("attendance client write failed, falling back to queue",L&&L.message),Fn.enqueueWrite({method:"POST",path:"/attendance/kiosk",body:{staff_name:t},tempId:G.id,collection:"attendance"}),await Fn.processQueue(),await v()}}}catch(D){console.error("kiosk error",D),_((D==null?void 0:D.message)||"Action failed")}finally{g(!1)}}};return u.jsxs("div",{className:"dashboard-content",children:[u.jsxs("h2",{className:"dashboard-title",children:["Staff Attendance ",u.jsx(Ud,{show:h&&!m})]}),u.jsxs("div",{className:"panel",children:[u.jsx("div",{className:"panel-header",children:"Select Staff Member"}),u.jsx("div",{style:{display:"flex",justifyContent:"center"},children:u.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",padding:12},children:[u.jsxs("select",{value:t,onChange:D=>e(D.target.value),style:{width:300,height:44,padding:"8px 12px",border:"1px solid #e7e8ef",borderRadius:10,fontSize:18},children:[u.jsx("option",{value:"",children:"(choose)"}),UL.map(D=>u.jsx("option",{value:D,children:D},D))]}),u.jsx("button",{className:"primary-btn",onClick:ae,disabled:!t||m,children:m?"Processing":t&&A(t)?"Sign Out":"Sign In"})]})})]}),u.jsxs("div",{className:"panel",children:[u.jsx("div",{className:"panel-header",children:"Attendance Records"}),S&&u.jsx("div",{className:"small-error",children:S}),u.jsx("div",{style:{overflowX:"auto",padding:8},children:u.jsxs("table",{className:"attendance-table aligned",style:{width:"100%"},children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Date"}),u.jsx("th",{children:"Staff"}),u.jsx("th",{children:"Time In"}),u.jsx("th",{children:"Time Out"}),u.jsx("th",{style:{textAlign:"center"},children:"Hours"})]})}),u.jsx("tbody",{children:ne.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:5,style:{textAlign:"center",color:"var(--muted)"},children:"No records."})}):ne.slice(0,b).map((D,G)=>{const L=wr(D)||"",H=Oc(D),z=(D==null?void 0:D.time_out)||(D==null?void 0:D.TimeOut)||(D==null?void 0:D.timeOut)||"",se=z?z.length===5?Oc({TimeIn:z}):Hm(z):"",ge=typeof(D==null?void 0:D.TotalHours)<"u"&&(D==null?void 0:D.TotalHours)!==null?String(D==null?void 0:D.TotalHours):typeof(D==null?void 0:D.NoOfHours)<"u"&&(D==null?void 0:D.NoOfHours)!==null?String(D==null?void 0:D.NoOfHours):typeof(D==null?void 0:D.hours)<"u"&&(D==null?void 0:D.hours)!==null?String(D==null?void 0:D.hours):"",O=String((D==null?void 0:D.TimeOut)||(D==null?void 0:D.time_out)||(D==null?void 0:D.timeout)||"").trim(),Q=O===""||O==="-"||O===""||O==="null"||typeof O>"u",F=String((D==null?void 0:D.Staff)||(D==null?void 0:D.staff)||(D==null?void 0:D.staff_name)||""),oe=(wr(D)||"")===w;return u.jsxs("tr",{children:[u.jsx("td",{children:Qw(L)}),u.jsxs("td",{style:{fontWeight:700},children:[F,Q&&oe&&u.jsx("span",{style:{marginLeft:8},className:"status-badge on",children:"On"})]}),u.jsx("td",{children:H}),u.jsx("td",{children:se}),u.jsx("td",{style:{textAlign:"center"},children:ge})]},(L||"")+"|"+String((D==null?void 0:D.Staff)||(D==null?void 0:D.staff)||G))})})]})}),u.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8},children:u.jsx("div",{className:"table-range",children:ce===0?"Showing 0 of 0":`Showing ${V}${K} of ${ce}`})}),ce>b&&u.jsx("div",{style:{textAlign:"center",marginTop:8},children:u.jsx("button",{className:"button",onClick:()=>j(D=>D<ce?Math.min(D+20,ce):20),children:b<ce?`Load ${Math.min(20,ce-b)} more`:"Show less"})})]}),u.jsxs("div",{className:"panel",style:{marginTop:18},children:[u.jsx("div",{className:"panel-header",children:"Coaching Sessions"}),u.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",justifyContent:"center",flexWrap:"wrap",padding:"8px 0 6px 0"},children:[u.jsxs("div",{children:[u.jsx("div",{style:{fontSize:12,color:"var(--muted)",marginBottom:6},children:"Coach"}),u.jsx("select",{value:I,onChange:D=>R(D.target.value),style:{width:260,height:44,padding:"8px 12px",border:"1px solid #e7e8ef",borderRadius:10,fontSize:16},children:te.map(D=>u.jsx("option",{value:D,children:D},D))})]}),u.jsxs("div",{children:[u.jsx("div",{style:{fontSize:12,color:"var(--muted)",marginBottom:6},children:"Period"}),u.jsx("select",{value:k,onChange:D=>N(Number(D.target.value)),style:{width:260,height:44,padding:"8px 12px",border:"1px solid #e7e8ef",borderRadius:10,fontSize:16},children:E.map((D,G)=>u.jsx("option",{value:G,children:D.label},D.label))})]})]}),u.jsxs("div",{style:{paddingTop:6,paddingBottom:12,fontWeight:700,paddingLeft:8},children:["Sessions: ",X||0]}),u.jsx("div",{style:{overflowX:"auto",padding:8},children:u.jsxs("table",{className:"attendance-table aligned",style:{width:"100%"},children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Date"}),u.jsx("th",{children:"Member"}),u.jsx("th",{children:"Time In"}),u.jsx("th",{children:"Time Out"}),u.jsx("th",{style:{textAlign:"center"},children:"Hours"}),u.jsx("th",{children:"Focus"})]})}),u.jsx("tbody",{children:E.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:6,children:"No periods"})}):B.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:6,children:"No sessions for selected coach / period."})}):B.slice(0,M).map((D,G)=>{const L=wr(D)||"",H=Oc(D),z=(D==null?void 0:D.time_out)||(D==null?void 0:D.TimeOut)||(D==null?void 0:D.timeOut)||"",se=z?z.length===5?Oc({TimeIn:z}):Hm(z):"",ge=typeof(D==null?void 0:D.TotalHours)<"u"&&(D==null?void 0:D.TotalHours)!==null?String(D==null?void 0:D.TotalHours):typeof(D==null?void 0:D.NoOfHours)<"u"&&(D==null?void 0:D.NoOfHours)!==null?String(D==null?void 0:D.NoOfHours):typeof(D==null?void 0:D.hours)<"u"&&(D==null?void 0:D.hours)!==null?String(D==null?void 0:D.hours):"",O=String((D==null?void 0:D.MemberID)||(D==null?void 0:D.memberid)||(D==null?void 0:D.member)||(D==null?void 0:D.Member)||(D==null?void 0:D.id)||"").trim(),Q=(o||[]).find(oe=>String((oe==null?void 0:oe.MemberID)||(oe==null?void 0:oe.memberid)||(oe==null?void 0:oe.id)||"").trim()===O)||null,F=Q?Xu(Q):String((D==null?void 0:D.NickName)||(D==null?void 0:D.nickname)||(D==null?void 0:D.Member)||(D==null?void 0:D.member)||"")||"";return u.jsxs("tr",{style:{cursor:"pointer"},onClick:()=>d(D),children:[u.jsx("td",{children:Qw(L)}),u.jsx("td",{style:{fontWeight:700},children:F}),u.jsx("td",{children:H}),u.jsx("td",{children:se}),u.jsx("td",{style:{textAlign:"center"},children:ge}),u.jsx("td",{children:String((D==null?void 0:D.Focus)||(D==null?void 0:D.focus)||"")})]},(L||"")+"|"+F+"|"+G)})})]})}),u.jsx(Ug,{open:!!a,onClose:()=>d(null),row:a,onCheckout:async D=>{try{await v()}catch{}d(null)}}),u.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8},children:u.jsx("div",{className:"table-range",children:$===0?"Showing 0 of 0":`Showing ${Z}${q} of ${$}`})}),$>M&&u.jsx("div",{style:{textAlign:"center",marginTop:8},children:u.jsx("button",{className:"button",onClick:()=>U(D=>D<$?Math.min(D+20,$):20),children:M<$?`Load ${Math.min(20,$-M)} more`:"Show less"})})]})]})}const{fetchPricing:Js}=Re;function $L(){const[t,e]=C.useState(""),[n,r]=C.useState("Staff"),[i,s]=C.useState(""),[o,l]=C.useState(!1),[a,d]=C.useState(""),[h,f]=C.useState(null),[m,g]=C.useState(""),[S,_]=C.useState([]),[A,v]=C.useState(null),[w,b]=C.useState(""),j={padding:"8px 12px",fontSize:14,lineHeight:"1",minHeight:36},[M,U]=C.useState([]),[x,I]=C.useState(""),[R,E]=C.useState(""),[T,k]=C.useState([]),[N,te]=C.useState("No"),[J,ne]=C.useState("No"),[ce,V]=C.useState(""),[K,B]=C.useState(""),[X,$]=C.useState(!1),[Z,q]=C.useState(""),[ae,D]=C.useState("");C.useEffect(()=>{let O=!0;return(async()=>{try{const Q=await dt.fetchWithAuth("/products");if(!O)return;if(!Q.ok){U([]);return}const F=await Q.json().catch(()=>[]);U(F||[])}catch{U([])}})(),()=>{O=!1}},[]),C.useEffect(()=>{let O=!0;return(async()=>{try{const Q=await Js();if(!O)return;k((Q==null?void 0:Q.rows)||(Q==null?void 0:Q.data)||[])}catch{k([])}})(),()=>{O=!1}},[]);const G=(()=>{const O={};(T||[]).forEach(F=>{const oe=String(F.Particulars||F.particulars||F.name||"").trim();oe&&(O[oe.toLowerCase()]=F)});const Q=[];return(T||[]).forEach(F=>{const oe=String(F.Particulars||F.particulars||F.name||"").trim();oe&&Q.push({id:F.id||F.ID||F._id||null,particulars:oe,gym:(F["Gym membership"]??F["Gym Membership"]??F.gym_membership??F.is_gym_membership??"")||"",coach:(F["Coach subscription"]??F["Coach Subscription"]??F.coach_subscription??F.is_coach_subscription??"")||"",cost:F.Cost||F.cost||F.Price||F.price||"",validity:F.Validity||F.validity||F.validity_days||F.ValidityDays||0,source:"pricing",raw:F})}),(M||[]).forEach(F=>{const oe=String(F.name||F.Particulars||F.particulars||"").trim();oe&&(O[oe.toLowerCase()]||Q.push({id:F.id||null,particulars:oe,gym:(F.is_gym_membership||F.is_gym||F.gym,F.is_gym_membership||F.gym?"Yes":"No"),coach:(F.is_coach_subscription||F.is_coach||F.coach,F.is_coach_subscription||F.coach?"Yes":"No"),cost:F.price||F.Cost||F.cost||"",validity:F.validity_days||F.Validity||F.validity||0,source:"products",raw:F}))}),Q})(),L=(()=>{const O=[],Q=[],F=[],oe=[];return G.forEach(re=>{const de=String(re.gym||"").toLowerCase().startsWith("y"),ue=String(re.coach||"").toLowerCase().startsWith("y");de&&!ue?O.push(re):!de&&ue?Q.push(re):de&&ue?F.push(re):oe.push(re)}),{gymOnly:O,coachOnly:Q,bundle:F,merch:oe}})();C.useEffect(()=>{let O=!0;return(async()=>{var Q;try{const F=await dt.fetchWithAuth("/users");if(!O)return;if(F&&F.ok){const oe=await F.json().catch(()=>[]);_(oe||[]);return}try{const oe=await dt.fetchWithAuth("/auth/me");if(oe&&oe.ok){const re=await oe.json().catch(()=>({})),de=((Q=re==null?void 0:re.user)==null?void 0:Q.username)||"";_(de?[{id:null,username:de}]:[]);return}}catch{}_([])}catch{}})(),()=>{O=!1}},[]);const H=async()=>{try{let O;try{O=await dt.fetchWithAuth("/users")}catch{O=null}if(!O||!O.ok)try{const F=`${window.location.protocol}//${window.location.hostname}:4000`,oe=dt.getToken&&dt.getToken(),re={};oe&&(re.Authorization=`Bearer ${oe}`);const de=await fetch(`${F}/users`,{headers:re});if(!de.ok){_([]);return}const ue=await de.json().catch(()=>[]);_(ue||[]);return}catch{_([]);return}const Q=await O.json().catch(()=>[]);_(Q||[])}catch{_([])}},z=async()=>{try{const O=await dt.fetchWithAuth("/products");if(!O.ok)return;const Q=await O.json().catch(()=>[]);U(Q||[])}catch{}},se=async O=>{if(O&&O.preventDefault(),s(""),!t)return s("Please enter username");l(!0);try{const Q=await dt.fetchWithAuth("/staff",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({full_name:t,role:n})});if(!Q.ok){const oe=await Q.json().catch(()=>({}));return s(oe.error||"Failed to add staff")}const F=await Q.json().catch(()=>({}));try{const oe=Math.random().toString(36).slice(-10),re=a||oe;let de;try{de=await dt.fetchWithAuth("/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:re,role:n==="Admin"?"admin":"staff"})})}catch{de=null}if(!de||!de.ok)try{const ue=`${window.location.protocol}//${window.location.hostname}:4000`,pe=dt.getToken&&dt.getToken(),De={"Content-Type":"application/json"};pe&&(De.Authorization=`Bearer ${pe}`);const Ze=await fetch(`${ue}/users`,{method:"POST",headers:De,body:JSON.stringify({username:t,password:re,role:n==="Admin"?"admin":"staff"})});if(!Ze.ok){let Tt="";try{Tt=await Ze.text()}catch{Tt=""}s(`Staff added. User creation failed: ${Ze.status} ${Tt||Ze.statusText||"error"}`),e(""),d(""),l(!1);return}await H(),s(`Staff added. User created (password: ${re})`),e(""),d(""),l(!1);return}catch{s("Staff added. User creation failed (network)"),e(""),d(""),l(!1);return}try{await de.json().catch(()=>({}))}catch{}await H(),s(`Staff added. User created (password: ${re})`),e(""),d(""),l(!1)}catch{s("Staff added. User creation failed"),e(""),d(""),l(!1);return}}catch{s("Server error"),l(!1)}},ge=O=>{if(!O.id){s("Cannot change status for current user from here");return}(async()=>{try{const Q=!O.active;if(!(await dt.fetchWithAuth(`/users/${O.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...O,active:Q})})).ok)return s("Update failed");await H(),s(Q?"User activated":"User deactivated")}catch{s("Server error")}})()};return u.jsx("div",{className:"content",children:u.jsxs("div",{className:"panel",children:[u.jsx("div",{className:"panel-header",children:"Admin Console"}),u.jsx("div",{style:{color:"var(--muted)",marginBottom:8},children:"Add staff accounts and manage products/services."}),u.jsxs("div",{className:"panel",style:{marginTop:12},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsx("div",{className:"panel-header",children:"Users"}),u.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[u.jsx("div",{style:{color:"var(--muted)",fontSize:13}}),u.jsx("button",{className:"button",style:j,onClick:()=>{H(),s("Refreshed users")},children:"Refresh"})]})]}),u.jsxs("div",{style:{marginTop:6},children:[u.jsxs("form",{onSubmit:se,style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap",marginBottom:12},children:[u.jsx("input",{className:"input-compact",value:t,onChange:O=>e(O.target.value),placeholder:"username (e.g. jsmith)",style:{width:240}}),u.jsxs("select",{className:"select-compact",value:n,onChange:O=>r(O.target.value),style:{width:140},children:[u.jsx("option",{children:"Staff"}),u.jsx("option",{children:"Admin"})]}),u.jsx("input",{type:"password",className:"input-compact",placeholder:"password (optional)",value:a,onChange:O=>d(O.target.value),style:{width:180}}),u.jsx("button",{type:"submit",className:"button btn-compact",disabled:o,style:j,children:"Add"}),o&&u.jsx("div",{style:{color:"var(--muted)",marginLeft:8},children:"Adding..."})]}),u.jsx("div",{style:{marginTop:0,color:"var(--muted)",fontSize:13,marginBottom:12},children:"Creates a staff record; a login user will be created automatically (you may provide a password)."}),u.jsxs("ul",{style:{listStyle:"none",paddingLeft:0},children:[S.map(O=>u.jsxs("li",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 0",borderBottom:"1px solid var(--light-border)"},children:[u.jsxs("div",{children:[u.jsx("div",{style:{fontWeight:700},children:O.username}),u.jsx("div",{style:{color:"var(--muted)",fontSize:13},children:O.role||(O.id?"":"You")})]}),u.jsx("div",{style:{display:"flex",gap:8,alignItems:"center"},children:A===(O.id??"self")?u.jsxs(u.Fragment,{children:[u.jsx("input",{className:"input-compact",value:w,onChange:Q=>b(Q.target.value),placeholder:"new password",style:{width:140}}),u.jsx("button",{className:"button btn-compact",style:j,onClick:async()=>{if(!w)return s("Enter new password");try{let Q;if(O.id?Q=await dt.fetchWithAuth(`/api/users/${O.id}/password`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:w})}):Q=await dt.fetchWithAuth("/api/users/self/password",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:w})}),!Q.ok){const F=await Q.json().catch(()=>({}));s(F.error||"Reset failed");return}s("Password reset"),v(null),b(""),await H()}catch{s("Server error")}},children:"Save"}),u.jsx("button",{className:"button",style:j,onClick:()=>{v(null),b("")},children:"Cancel"})]}):u.jsxs(u.Fragment,{children:[u.jsx("button",{className:"button btn-compact",style:j,onClick:()=>{v(O.id??"self"),b("")},children:"Reset"}),O.id?u.jsx("button",{className:"button",style:j,onClick:()=>ge(O),children:O.active??!0?"Deactivate":"Activate"}):null]})})]},O.id??O.username)),S.length===0&&u.jsx("li",{style:{color:"#888",padding:12},children:"No users found."})]})]}),u.jsx("div",{className:"panel-header",style:{marginTop:18},children:"Pricing Rules"}),u.jsxs("div",{style:{marginTop:8},children:[u.jsx("div",{style:{color:"var(--muted)",marginBottom:8},children:"This table lists the product rules used by the app to decide whether a Particulars value grants gym access and/or coach subscription."}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[u.jsx("div",{style:{color:"var(--muted)"},children:"This table lists the product rules used by the app to decide whether a Particulars value grants gym access and/or coach subscription."}),u.jsx("div",{children:X?u.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[u.jsx("input",{placeholder:"Merchandise name",value:Z,onChange:O=>q(O.target.value),style:{width:240}}),u.jsx("input",{placeholder:"Price",value:ae,onChange:O=>D(O.target.value),style:{width:120}}),u.jsx("button",{className:"button",onClick:async()=>{if(!Z)return s("Enter merchandise name");try{const O={Particulars:Z,Cost:Number(ae)||0,Validity:0,"Gym membership":"No","Coach subscription":"No"};await Re.addPricing(O);const Q=await Js();k((Q==null?void 0:Q.rows)||[]),q(""),D(""),$(!1),s("Merchandise added")}catch{s("Add failed")}},children:"Add"}),u.jsx("button",{className:"button",onClick:()=>{$(!1),q(""),D("")},children:"Cancel"})]}):u.jsx("button",{className:"button",onClick:()=>$(!0),children:"Add Merchandise"})})]}),u.jsxs("table",{className:"aligned",style:{width:"100%",borderCollapse:"collapse"},children:[u.jsxs("colgroup",{children:[u.jsx("col",{style:{width:"36%"}}),u.jsx("col",{style:{width:"14%"}}),u.jsx("col",{style:{width:"14%"}}),u.jsx("col",{style:{width:"14%"}}),u.jsx("col",{style:{width:"12%"}}),u.jsx("col",{style:{width:"10%"}})]}),u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Particulars"}),u.jsx("th",{children:"Gym Membership"}),u.jsx("th",{children:"Coach Subscription"}),u.jsx("th",{children:"Cost"}),u.jsx("th",{children:"Validity (days)"}),u.jsx("th",{children:"Actions"})]})}),u.jsx("tbody",{children:L.gymOnly.length+L.coachOnly.length+L.bundle.length+L.merch.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:6,style:{color:"#888",padding:12},children:"No pricing rules configured."})}):u.jsxs(u.Fragment,{children:[L.gymOnly.length>0&&u.jsxs(u.Fragment,{children:[u.jsx("tr",{style:{background:"var(--muted-background)",fontWeight:700},children:u.jsx("td",{colSpan:6,style:{padding:8},children:"Gym Membership Only"})}),L.gymOnly.map(O=>{const Q=h===(O.id||O.particulars);return u.jsxs("tr",{style:{borderTop:"1px solid var(--light-border)"},children:[u.jsx("td",{style:{padding:"6px 8px"},children:O.particulars}),u.jsx("td",{style:{textAlign:"center"},children:O.gym}),u.jsx("td",{style:{textAlign:"center"},children:O.coach}),u.jsx("td",{style:{textAlign:"center"},children:Q?u.jsx("input",{value:m,onChange:F=>g(F.target.value),style:{width:96}}):O.cost||""}),u.jsx("td",{style:{textAlign:"center"},children:O.validity||""}),u.jsx("td",{style:{textAlign:"right"},children:Q?u.jsxs(u.Fragment,{children:[u.jsx("button",{className:"button",onClick:async()=>{try{if(O.source==="pricing"){await Re.updatePricing(O.id,{Cost:Number(m)||0});const F=await Js();k((F==null?void 0:F.rows)||[])}else O.source==="products"&&O.id&&(await dt.fetchWithAuth(`/products/${O.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...O.raw,price:Number(m)||0})}),await z());f(null),g(""),s("Pricing updated")}catch{s("Update failed")}},children:"Save"}),u.jsx("button",{className:"button",onClick:()=>{f(null),g("")},children:"Cancel"})]}):u.jsx("button",{className:"button",onClick:()=>{f(O.id||O.particulars),g(O.cost||"")},children:"Edit"})})]},O.id||O.particulars)})]}),L.coachOnly.length>0&&u.jsxs(u.Fragment,{children:[u.jsx("tr",{style:{background:"var(--muted-background)",fontWeight:700},children:u.jsx("td",{colSpan:6,style:{padding:8},children:"Coach Subscription Only"})}),L.coachOnly.map(O=>{const Q=h===(O.id||O.particulars);return u.jsxs("tr",{style:{borderTop:"1px solid var(--light-border)"},children:[u.jsx("td",{style:{padding:"6px 8px"},children:O.particulars}),u.jsx("td",{style:{textAlign:"center"},children:O.gym}),u.jsx("td",{style:{textAlign:"center"},children:O.coach}),u.jsx("td",{style:{textAlign:"center"},children:Q?u.jsx("input",{value:m,onChange:F=>g(F.target.value),style:{width:96}}):O.cost||""}),u.jsx("td",{style:{textAlign:"center"},children:O.validity||""}),u.jsx("td",{style:{textAlign:"right"},children:Q?u.jsxs(u.Fragment,{children:[u.jsx("button",{className:"button",onClick:async()=>{try{if(O.source==="pricing"){await Re.updatePricing(O.id,{Cost:Number(m)||0});const F=await Js();k((F==null?void 0:F.rows)||[])}else O.source==="products"&&O.id&&(await dt.fetchWithAuth(`/products/${O.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...O.raw,price:Number(m)||0})}),await z());f(null),g(""),s("Pricing updated")}catch{s("Update failed")}},children:"Save"}),u.jsx("button",{className:"button",onClick:()=>{f(null),g("")},children:"Cancel"})]}):u.jsx("button",{className:"button",onClick:()=>{f(O.id||O.particulars),g(O.cost||"")},children:"Edit"})})]},O.id||O.particulars)})]}),L.bundle.length>0&&u.jsxs(u.Fragment,{children:[u.jsx("tr",{style:{background:"var(--muted-background)",fontWeight:700},children:u.jsx("td",{colSpan:6,style:{padding:8},children:"Gym & Coach Bundle"})}),L.bundle.map(O=>{const Q=h===(O.id||O.particulars);return u.jsxs("tr",{style:{borderTop:"1px solid var(--light-border)"},children:[u.jsx("td",{style:{padding:"6px 8px"},children:O.particulars}),u.jsx("td",{style:{textAlign:"center"},children:O.gym}),u.jsx("td",{style:{textAlign:"center"},children:O.coach}),u.jsx("td",{style:{textAlign:"center"},children:Q?u.jsx("input",{value:m,onChange:F=>g(F.target.value),style:{width:96}}):O.cost||""}),u.jsx("td",{style:{textAlign:"center"},children:O.validity||""}),u.jsx("td",{style:{textAlign:"right"},children:Q?u.jsxs(u.Fragment,{children:[u.jsx("button",{className:"button",onClick:async()=>{try{if(O.source==="pricing"){await Re.updatePricing(O.id,{Cost:Number(m)||0});const F=await Js();k((F==null?void 0:F.rows)||[])}else O.source==="products"&&O.id&&(await dt.fetchWithAuth(`/products/${O.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...O.raw,price:Number(m)||0})}),await z());f(null),g(""),s("Pricing updated")}catch{s("Update failed")}},children:"Save"}),u.jsx("button",{className:"button",onClick:()=>{f(null),g("")},children:"Cancel"})]}):u.jsx("button",{className:"button",onClick:()=>{f(O.id||O.particulars),g(O.cost||"")},children:"Edit"})})]},O.id||O.particulars)})]}),L.merch.length>0&&u.jsxs(u.Fragment,{children:[u.jsx("tr",{style:{background:"var(--muted-background)",fontWeight:700},children:u.jsx("td",{colSpan:6,style:{padding:8},children:"Merchandise"})}),L.merch.map(O=>{const Q=h===(O.id||O.particulars);return u.jsxs("tr",{style:{borderTop:"1px solid var(--light-border)"},children:[u.jsx("td",{style:{padding:"6px 8px"},children:O.particulars}),u.jsx("td",{style:{textAlign:"center"},children:O.gym}),u.jsx("td",{style:{textAlign:"center"},children:O.coach}),u.jsx("td",{style:{textAlign:"center"},children:Q?u.jsx("input",{value:m,onChange:F=>g(F.target.value),style:{width:96}}):O.cost||""}),u.jsx("td",{style:{textAlign:"center"},children:O.validity||""}),u.jsx("td",{style:{textAlign:"right"},children:Q?u.jsxs(u.Fragment,{children:[u.jsx("button",{className:"button",onClick:async()=>{try{if(O.source==="pricing"){await Re.updatePricing(O.id,{Cost:Number(m)||0});const F=await Js();k((F==null?void 0:F.rows)||[])}else O.source==="products"&&O.id&&(await dt.fetchWithAuth(`/products/${O.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...O.raw,price:Number(m)||0})}),await z());f(null),g(""),s("Pricing updated")}catch{s("Update failed")}},children:"Save"}),u.jsx("button",{className:"button",onClick:()=>{f(null),g("")},children:"Cancel"})]}):u.jsx("button",{className:"button",onClick:()=>{f(O.id||O.particulars),g(O.cost||"")},children:"Edit"})})]},O.id||O.particulars)})]})]})})]})]})]}),i&&u.jsx("div",{style:{marginTop:12,color:"#2b7",fontWeight:600},children:i})]})})}function zL(){const[t,e]=C.useState([]);return C.useEffect(()=>{const n=sn.on("modal:error",r=>{const i=Date.now()+Math.random(),s={id:i,message:(r==null?void 0:r.message)||"An error occurred",source:(r==null?void 0:r.source)||""};e(o=>[...o,s]),setTimeout(()=>e(o=>o.filter(l=>l.id!==i)),6e3)});return()=>n()},[]),t.length?u.jsx("div",{style:{position:"fixed",top:20,right:20,zIndex:99999,display:"flex",flexDirection:"column",gap:8},children:t.map(n=>u.jsxs("div",{style:{background:"#111",color:"#fff",padding:"10px 14px",borderRadius:10,minWidth:240,boxShadow:"0 8px 24px rgba(0,0,0,.2)"},children:[u.jsx("div",{style:{fontWeight:700,marginBottom:4},children:n.source||"Error"}),u.jsx("div",{style:{fontSize:13},children:n.message})]},n.id))}):null}function HL({open:t,onClose:e}){const[n,r]=C.useState(""),[i,s]=C.useState(""),[o,l]=C.useState(!1),[a,d]=C.useState(""),h=n.length>=6&&n===i;async function f(m){if(m.preventDefault(),d(""),!h){d("Passwords must match and be at least 6 characters");return}l(!0);try{const g=await dt.fetchWithAuth("/api/users/self/password",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:n})});if(!g.ok){const S=await g.text().catch(()=>"");d("Password change failed: "+(S||g.statusText||g.status));return}alert("Password changed successfully"),r(""),s(""),e&&e()}catch{d("Password change error")}finally{l(!1)}}return u.jsx(ns,{open:t,onClose:e,title:"Reset password",children:u.jsxs("form",{className:"reset-password-form",onSubmit:f,children:[u.jsxs("div",{className:"reset-password-row",children:[u.jsx("label",{children:"New password"}),u.jsx("input",{type:"password",value:n,onChange:m=>r(m.target.value),placeholder:"At least 6 characters",autoFocus:!0})]}),u.jsxs("div",{className:"reset-password-row",children:[u.jsx("label",{children:"Confirm password"}),u.jsx("input",{type:"password",value:i,onChange:m=>s(m.target.value),placeholder:"Repeat new password"})]}),a?u.jsx("div",{className:"reset-password-error",children:a}):null,u.jsxs("div",{className:"reset-password-actions",children:[u.jsx("button",{type:"button",className:"button",onClick:e,disabled:o,style:{background:"#eee",color:"#333"},children:"Cancel"}),u.jsx("button",{type:"submit",className:"button",disabled:!h||o,style:{opacity:!h||o?.6:1},children:o?u.jsx("span",{className:"spinner"}):"Change password"})]})]})})}function WL(){const[t,e]=C.useState(""),[n,r]=C.useState(""),[i,s]=C.useState(!1);C.useEffect(()=>{const a=dt.getToken();a&&e(a)},[]);const o=a=>{e(a);try{dt.setToken(a)}catch{}},l=()=>{e(""),localStorage.removeItem("authToken")};return C.useEffect(()=>{let a=!0;if(t){try{if(String(t).startsWith("local-token-")){r("FRONTDESK");return}}catch{}return(async()=>{try{const d=await dt.fetchWithAuth("/auth/me");if(!a)return;if(!d.ok)return r("");const h=await d.json().catch(()=>({})),f=h&&h.user&&h.user.username?h.user.username:"";r(f||"")}catch{r("")}})(),()=>{a=!1}}},[t]),t?u.jsxs("div",{className:"app",children:[u.jsx(zL,{}),u.jsx(Kj,{onLogout:l}),u.jsxs("div",{className:"main-content",children:[u.jsxs("div",{className:"topbar",children:[u.jsxs("div",{className:"topbar-left",children:["Welcome, ",String(n||"YOU").toUpperCase()]}),u.jsx("div",{className:"topbar-right",children:u.jsx("button",{className:"button",onClick:()=>s(!0),children:"Reset password"})})]}),u.jsx(HL,{open:i,onClose:()=>s(!1)}),u.jsxs(xA,{children:[u.jsx(fi,{path:"/",element:u.jsx(pO,{})}),u.jsx(fi,{path:"/attendance",element:u.jsx(BL,{})}),u.jsx(fi,{path:"/members",element:u.jsx(kL,{})}),u.jsx(fi,{path:"/members/:memberId",element:u.jsx(uO,{})}),u.jsx(fi,{path:"/checkin",element:u.jsx(FL,{})}),u.jsx(fi,{path:"/admin",element:u.jsx($L,{})}),u.jsx(fi,{path:"*",element:u.jsx(IA,{to:"/",replace:!0})})]})]})]}):u.jsx(Qj,{setToken:o})}class qL extends We.Component{constructor(e){super(e),this.state={error:null,info:null}}componentDidCatch(e,n){this.setState({error:e,info:n})}render(){const{error:e,info:n}=this.state;return e?u.jsxs("div",{style:{padding:24,fontFamily:"sans-serif"},children:[u.jsx("h2",{style:{color:"#c92a2a"},children:"Application error"}),u.jsx("div",{style:{marginBottom:12,color:"#444"},children:"An uncaught error occurred while rendering the app."}),u.jsxs("details",{style:{whiteSpace:"pre-wrap",background:"#fff8f8",padding:12,borderRadius:6,border:"1px solid #ffd6d6"},children:[u.jsx("summary",{style:{cursor:"pointer",fontWeight:700},children:"Error details"}),u.jsx("div",{style:{marginTop:8},children:String(e&&e.toString())}),u.jsx("div",{style:{marginTop:8},children:n&&n.componentStack})]})]}):this.props.children}}try{console.log("[app] starting main.jsx",{base:"/",hasClientId:!1});const t=document.getElementById("root");t&&(t.innerHTML='<div style="padding:20px;font-family:sans-serif;color:#333">Mounting Kusgan app...</div>')}catch{}try{of.createRoot(document.getElementById("root")).render(u.jsx(We.StrictMode,{children:u.jsx(zA,{clientId:"",children:u.jsx(jA,{children:u.jsx(qL,{children:u.jsx(WL,{})})})})}))}catch(t){console.error("[app] render failure",t);const e=document.getElementById("root");e&&(e.innerHTML=`<div style="padding:20px;font-family:sans-serif;color:#900"><h2>Render error</h2><pre>${String(t)}</pre></div>`)}export{dM as C,ns as M,hM as a,Re as b,sn as e,mM as g,u as j,Fn as l,C as r,Yo as u};
