function fb(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function mb(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var cw={exports:{}},Iu={},uw={exports:{}},Me={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hl=Symbol.for("react.element"),pb=Symbol.for("react.portal"),gb=Symbol.for("react.fragment"),yb=Symbol.for("react.strict_mode"),vb=Symbol.for("react.profiler"),_b=Symbol.for("react.provider"),wb=Symbol.for("react.context"),Sb=Symbol.for("react.forward_ref"),Eb=Symbol.for("react.suspense"),Tb=Symbol.for("react.memo"),bb=Symbol.for("react.lazy"),Gg=Symbol.iterator;function xb(t){return t===null||typeof t!="object"?null:(t=Gg&&t[Gg]||t["@@iterator"],typeof t=="function"?t:null)}var dw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},hw=Object.assign,fw={};function Co(t,e,n){this.props=t,this.context=e,this.refs=fw,this.updater=n||dw}Co.prototype.isReactComponent={};Co.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Co.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function mw(){}mw.prototype=Co.prototype;function hm(t,e,n){this.props=t,this.context=e,this.refs=fw,this.updater=n||dw}var fm=hm.prototype=new mw;fm.constructor=hm;hw(fm,Co.prototype);fm.isPureReactComponent=!0;var Qg=Array.isArray,pw=Object.prototype.hasOwnProperty,mm={current:null},gw={key:!0,ref:!0,__self:!0,__source:!0};function yw(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)pw.call(e,r)&&!gw.hasOwnProperty(r)&&(i[r]=e[r]);var c=arguments.length-2;if(c===1)i.children=n;else if(1<c){for(var a=Array(c),d=0;d<c;d++)a[d]=arguments[d+2];i.children=a}if(t&&t.defaultProps)for(r in c=t.defaultProps,c)i[r]===void 0&&(i[r]=c[r]);return{$$typeof:hl,type:t,key:s,ref:o,props:i,_owner:mm.current}}function Ib(t,e){return{$$typeof:hl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function pm(t){return typeof t=="object"&&t!==null&&t.$$typeof===hl}function Cb(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Kg=/\/+/g;function Ad(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Cb(""+t.key):e.toString(36)}function yc(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case hl:case pb:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Ad(o,0):r,Qg(i)?(n="",t!=null&&(n=t.replace(Kg,"$&/")+"/"),yc(i,e,n,"",function(d){return d})):i!=null&&(pm(i)&&(i=Ib(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Kg,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",Qg(t))for(var c=0;c<t.length;c++){s=t[c];var a=r+Ad(s,c);o+=yc(s,e,n,a,i)}else if(a=xb(t),typeof a=="function")for(t=a.call(t),c=0;!(s=t.next()).done;)s=s.value,a=r+Ad(s,c++),o+=yc(s,e,n,a,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Ll(t,e,n){if(t==null)return t;var r=[],i=0;return yc(t,r,"","",function(s){return e.call(n,s,i++)}),r}function Ab(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var yn={current:null},vc={transition:null},Nb={ReactCurrentDispatcher:yn,ReactCurrentBatchConfig:vc,ReactCurrentOwner:mm};function vw(){throw Error("act(...) is not supported in production builds of React.")}Me.Children={map:Ll,forEach:function(t,e,n){Ll(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Ll(t,function(){e++}),e},toArray:function(t){return Ll(t,function(e){return e})||[]},only:function(t){if(!pm(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Me.Component=Co;Me.Fragment=gb;Me.Profiler=vb;Me.PureComponent=hm;Me.StrictMode=yb;Me.Suspense=Eb;Me.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Nb;Me.act=vw;Me.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=hw({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=mm.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(a in e)pw.call(e,a)&&!gw.hasOwnProperty(a)&&(r[a]=e[a]===void 0&&c!==void 0?c[a]:e[a])}var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){c=Array(a);for(var d=0;d<a;d++)c[d]=arguments[d+2];r.children=c}return{$$typeof:hl,type:t.type,key:i,ref:s,props:r,_owner:o}};Me.createContext=function(t){return t={$$typeof:wb,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:_b,_context:t},t.Consumer=t};Me.createElement=yw;Me.createFactory=function(t){var e=yw.bind(null,t);return e.type=t,e};Me.createRef=function(){return{current:null}};Me.forwardRef=function(t){return{$$typeof:Sb,render:t}};Me.isValidElement=pm;Me.lazy=function(t){return{$$typeof:bb,_payload:{_status:-1,_result:t},_init:Ab}};Me.memo=function(t,e){return{$$typeof:Tb,type:t,compare:e===void 0?null:e}};Me.startTransition=function(t){var e=vc.transition;vc.transition={};try{t()}finally{vc.transition=e}};Me.unstable_act=vw;Me.useCallback=function(t,e){return yn.current.useCallback(t,e)};Me.useContext=function(t){return yn.current.useContext(t)};Me.useDebugValue=function(){};Me.useDeferredValue=function(t){return yn.current.useDeferredValue(t)};Me.useEffect=function(t,e){return yn.current.useEffect(t,e)};Me.useId=function(){return yn.current.useId()};Me.useImperativeHandle=function(t,e,n){return yn.current.useImperativeHandle(t,e,n)};Me.useInsertionEffect=function(t,e){return yn.current.useInsertionEffect(t,e)};Me.useLayoutEffect=function(t,e){return yn.current.useLayoutEffect(t,e)};Me.useMemo=function(t,e){return yn.current.useMemo(t,e)};Me.useReducer=function(t,e,n){return yn.current.useReducer(t,e,n)};Me.useRef=function(t){return yn.current.useRef(t)};Me.useState=function(t){return yn.current.useState(t)};Me.useSyncExternalStore=function(t,e,n){return yn.current.useSyncExternalStore(t,e,n)};Me.useTransition=function(){return yn.current.useTransition()};Me.version="18.3.1";uw.exports=Me;var N=uw.exports;const Ue=mb(N),kb=fb({__proto__:null,default:Ue},[N]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pb=N,Rb=Symbol.for("react.element"),Db=Symbol.for("react.fragment"),jb=Object.prototype.hasOwnProperty,Mb=Pb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ob={key:!0,ref:!0,__self:!0,__source:!0};function _w(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)jb.call(e,r)&&!Ob.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:Rb,type:t,key:s,ref:o,props:i,_owner:Mb.current}}Iu.Fragment=Db;Iu.jsx=_w;Iu.jsxs=_w;cw.exports=Iu;var u=cw.exports,Nh={},ww={exports:{}},Fn={},Sw={exports:{}},Ew={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(A,F){var O=A.length;A.push(F);e:for(;0<O;){var z=O-1>>>1,$=A[z];if(0<i($,F))A[z]=F,A[O]=$,O=z;else break e}}function n(A){return A.length===0?null:A[0]}function r(A){if(A.length===0)return null;var F=A[0],O=A.pop();if(O!==F){A[0]=O;e:for(var z=0,$=A.length,G=$>>>1;z<G;){var J=2*(z+1)-1,ae=A[J],de=J+1,ie=A[de];if(0>i(ae,O))de<$&&0>i(ie,ae)?(A[z]=ie,A[de]=O,z=de):(A[z]=ae,A[J]=O,z=J);else if(de<$&&0>i(ie,O))A[z]=ie,A[de]=O,z=de;else break e}}return F}function i(A,F){var O=A.sortIndex-F.sortIndex;return O!==0?O:A.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var a=[],d=[],h=1,f=null,p=3,v=!1,x=!1,_=!1,P=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(A){for(var F=n(d);F!==null;){if(F.callback===null)r(d);else if(F.startTime<=A)r(d),F.sortIndex=F.expirationTime,e(a,F);else break;F=n(d)}}function M(A){if(_=!1,T(A),!x)if(n(a)!==null)x=!0,V(L);else{var F=n(d);F!==null&&q(M,F.startTime-A)}}function L(A,F){x=!1,_&&(_=!1,y(b),b=-1),v=!0;var O=p;try{for(T(F),f=n(a);f!==null&&(!(f.expirationTime>F)||A&&!E());){var z=f.callback;if(typeof z=="function"){f.callback=null,p=f.priorityLevel;var $=z(f.expirationTime<=F);F=t.unstable_now(),typeof $=="function"?f.callback=$:f===n(a)&&r(a),T(F)}else r(a);f=n(a)}if(f!==null)var G=!0;else{var J=n(d);J!==null&&q(M,J.startTime-F),G=!1}return G}finally{f=null,p=O,v=!1}}var B=!1,C=null,b=-1,R=5,S=-1;function E(){return!(t.unstable_now()-S<R)}function j(){if(C!==null){var A=t.unstable_now();S=A;var F=!0;try{F=C(!0,A)}finally{F?k():(B=!1,C=null)}}else B=!1}var k;if(typeof w=="function")k=function(){w(j)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,I=Q.port2;Q.port1.onmessage=j,k=function(){I.postMessage(null)}}else k=function(){P(j,0)};function V(A){C=A,B||(B=!0,k())}function q(A,F){b=P(function(){A(t.unstable_now())},F)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(A){A.callback=null},t.unstable_continueExecution=function(){x||v||(x=!0,V(L))},t.unstable_forceFrameRate=function(A){0>A||125<A?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<A?Math.floor(1e3/A):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(a)},t.unstable_next=function(A){switch(p){case 1:case 2:case 3:var F=3;break;default:F=p}var O=p;p=F;try{return A()}finally{p=O}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(A,F){switch(A){case 1:case 2:case 3:case 4:case 5:break;default:A=3}var O=p;p=A;try{return F()}finally{p=O}},t.unstable_scheduleCallback=function(A,F,O){var z=t.unstable_now();switch(typeof O=="object"&&O!==null?(O=O.delay,O=typeof O=="number"&&0<O?z+O:z):O=z,A){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=O+$,A={id:h++,callback:F,priorityLevel:A,startTime:O,expirationTime:$,sortIndex:-1},O>z?(A.sortIndex=O,e(d,A),n(a)===null&&A===n(d)&&(_?(y(b),b=-1):_=!0,q(M,O-z))):(A.sortIndex=$,e(a,A),x||v||(x=!0,V(L))),A},t.unstable_shouldYield=E,t.unstable_wrapCallback=function(A){var F=p;return function(){var O=p;p=F;try{return A.apply(this,arguments)}finally{p=O}}}})(Ew);Sw.exports=Ew;var Vb=Sw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lb=N,Ln=Vb;function se(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Tw=new Set,ja={};function vs(t,e){co(t,e),co(t+"Capture",e)}function co(t,e){for(ja[t]=e,t=0;t<e.length;t++)Tw.add(e[t])}var Vr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),kh=Object.prototype.hasOwnProperty,Fb=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Yg={},Xg={};function Ub(t){return kh.call(Xg,t)?!0:kh.call(Yg,t)?!1:Fb.test(t)?Xg[t]=!0:(Yg[t]=!0,!1)}function Bb(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function zb(t,e,n,r){if(e===null||typeof e>"u"||Bb(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function vn(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var en={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){en[t]=new vn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];en[e]=new vn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){en[t]=new vn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){en[t]=new vn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){en[t]=new vn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){en[t]=new vn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){en[t]=new vn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){en[t]=new vn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){en[t]=new vn(t,5,!1,t.toLowerCase(),null,!1,!1)});var gm=/[\-:]([a-z])/g;function ym(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(gm,ym);en[e]=new vn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(gm,ym);en[e]=new vn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(gm,ym);en[e]=new vn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){en[t]=new vn(t,1,!1,t.toLowerCase(),null,!1,!1)});en.xlinkHref=new vn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){en[t]=new vn(t,1,!1,t.toLowerCase(),null,!0,!0)});function vm(t,e,n,r){var i=en.hasOwnProperty(e)?en[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(zb(e,n,i,r)&&(n=null),r||i===null?Ub(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Hr=Lb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Fl=Symbol.for("react.element"),Us=Symbol.for("react.portal"),Bs=Symbol.for("react.fragment"),_m=Symbol.for("react.strict_mode"),Ph=Symbol.for("react.profiler"),bw=Symbol.for("react.provider"),xw=Symbol.for("react.context"),wm=Symbol.for("react.forward_ref"),Rh=Symbol.for("react.suspense"),Dh=Symbol.for("react.suspense_list"),Sm=Symbol.for("react.memo"),ni=Symbol.for("react.lazy"),Iw=Symbol.for("react.offscreen"),Jg=Symbol.iterator;function Ko(t){return t===null||typeof t!="object"?null:(t=Jg&&t[Jg]||t["@@iterator"],typeof t=="function"?t:null)}var _t=Object.assign,Nd;function ca(t){if(Nd===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Nd=e&&e[1]||""}return`
`+Nd+t}var kd=!1;function Pd(t,e){if(!t||kd)return"";kd=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,c=s.length-1;1<=o&&0<=c&&i[o]!==s[c];)c--;for(;1<=o&&0<=c;o--,c--)if(i[o]!==s[c]){if(o!==1||c!==1)do if(o--,c--,0>c||i[o]!==s[c]){var a=`
`+i[o].replace(" at new "," at ");return t.displayName&&a.includes("<anonymous>")&&(a=a.replace("<anonymous>",t.displayName)),a}while(1<=o&&0<=c);break}}}finally{kd=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?ca(t):""}function $b(t){switch(t.tag){case 5:return ca(t.type);case 16:return ca("Lazy");case 13:return ca("Suspense");case 19:return ca("SuspenseList");case 0:case 2:case 15:return t=Pd(t.type,!1),t;case 11:return t=Pd(t.type.render,!1),t;case 1:return t=Pd(t.type,!0),t;default:return""}}function jh(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Bs:return"Fragment";case Us:return"Portal";case Ph:return"Profiler";case _m:return"StrictMode";case Rh:return"Suspense";case Dh:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case xw:return(t.displayName||"Context")+".Consumer";case bw:return(t._context.displayName||"Context")+".Provider";case wm:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Sm:return e=t.displayName||null,e!==null?e:jh(t.type)||"Memo";case ni:e=t._payload,t=t._init;try{return jh(t(e))}catch{}}return null}function Hb(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return jh(e);case 8:return e===_m?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ai(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Cw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Wb(t){var e=Cw(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ul(t){t._valueTracker||(t._valueTracker=Wb(t))}function Aw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Cw(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Oc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Mh(t,e){var n=e.checked;return _t({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Zg(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ai(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Nw(t,e){e=e.checked,e!=null&&vm(t,"checked",e,!1)}function Oh(t,e){Nw(t,e);var n=Ai(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Vh(t,e.type,n):e.hasOwnProperty("defaultValue")&&Vh(t,e.type,Ai(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function ey(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Vh(t,e,n){(e!=="number"||Oc(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ua=Array.isArray;function Zs(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ai(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Lh(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(se(91));return _t({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function ty(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(se(92));if(ua(n)){if(1<n.length)throw Error(se(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ai(n)}}function kw(t,e){var n=Ai(e.value),r=Ai(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function ny(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Pw(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Fh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Pw(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Bl,Rw=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Bl=Bl||document.createElement("div"),Bl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Bl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ma(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var va={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(va).forEach(function(t){qb.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),va[e]=va[t]})});function Dw(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||va.hasOwnProperty(t)&&va[t]?(""+e).trim():e+"px"}function jw(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=Dw(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var Gb=_t({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Uh(t,e){if(e){if(Gb[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(se(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(se(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(se(61))}if(e.style!=null&&typeof e.style!="object")throw Error(se(62))}}function Bh(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var zh=null;function Em(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var $h=null,eo=null,to=null;function ry(t){if(t=pl(t)){if(typeof $h!="function")throw Error(se(280));var e=t.stateNode;e&&(e=Pu(e),$h(t.stateNode,t.type,e))}}function Mw(t){eo?to?to.push(t):to=[t]:eo=t}function Ow(){if(eo){var t=eo,e=to;if(to=eo=null,ry(t),e)for(t=0;t<e.length;t++)ry(e[t])}}function Vw(t,e){return t(e)}function Lw(){}var Rd=!1;function Fw(t,e,n){if(Rd)return t(e,n);Rd=!0;try{return Vw(t,e,n)}finally{Rd=!1,(eo!==null||to!==null)&&(Lw(),Ow())}}function Oa(t,e){var n=t.stateNode;if(n===null)return null;var r=Pu(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(se(231,e,typeof n));return n}var Hh=!1;if(Vr)try{var Yo={};Object.defineProperty(Yo,"passive",{get:function(){Hh=!0}}),window.addEventListener("test",Yo,Yo),window.removeEventListener("test",Yo,Yo)}catch{Hh=!1}function Qb(t,e,n,r,i,s,o,c,a){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var _a=!1,Vc=null,Lc=!1,Wh=null,Kb={onError:function(t){_a=!0,Vc=t}};function Yb(t,e,n,r,i,s,o,c,a){_a=!1,Vc=null,Qb.apply(Kb,arguments)}function Xb(t,e,n,r,i,s,o,c,a){if(Yb.apply(this,arguments),_a){if(_a){var d=Vc;_a=!1,Vc=null}else throw Error(se(198));Lc||(Lc=!0,Wh=d)}}function _s(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Uw(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function iy(t){if(_s(t)!==t)throw Error(se(188))}function Jb(t){var e=t.alternate;if(!e){if(e=_s(t),e===null)throw Error(se(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return iy(i),t;if(s===r)return iy(i),e;s=s.sibling}throw Error(se(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,c=i.child;c;){if(c===n){o=!0,n=i,r=s;break}if(c===r){o=!0,r=i,n=s;break}c=c.sibling}if(!o){for(c=s.child;c;){if(c===n){o=!0,n=s,r=i;break}if(c===r){o=!0,r=s,n=i;break}c=c.sibling}if(!o)throw Error(se(189))}}if(n.alternate!==r)throw Error(se(190))}if(n.tag!==3)throw Error(se(188));return n.stateNode.current===n?t:e}function Bw(t){return t=Jb(t),t!==null?zw(t):null}function zw(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=zw(t);if(e!==null)return e;t=t.sibling}return null}var $w=Ln.unstable_scheduleCallback,sy=Ln.unstable_cancelCallback,Zb=Ln.unstable_shouldYield,ex=Ln.unstable_requestPaint,Nt=Ln.unstable_now,tx=Ln.unstable_getCurrentPriorityLevel,Tm=Ln.unstable_ImmediatePriority,Hw=Ln.unstable_UserBlockingPriority,Fc=Ln.unstable_NormalPriority,nx=Ln.unstable_LowPriority,Ww=Ln.unstable_IdlePriority,Cu=null,gr=null;function rx(t){if(gr&&typeof gr.onCommitFiberRoot=="function")try{gr.onCommitFiberRoot(Cu,t,void 0,(t.current.flags&128)===128)}catch{}}var er=Math.clz32?Math.clz32:ox,ix=Math.log,sx=Math.LN2;function ox(t){return t>>>=0,t===0?32:31-(ix(t)/sx|0)|0}var zl=64,$l=4194304;function da(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Uc(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var c=o&~i;c!==0?r=da(c):(s&=o,s!==0&&(r=da(s)))}else o=n&~i,o!==0?r=da(o):s!==0&&(r=da(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-er(e),i=1<<n,r|=t[n],e&=~i;return r}function ax(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function lx(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-er(s),c=1<<o,a=i[o];a===-1?(!(c&n)||c&r)&&(i[o]=ax(c,e)):a<=e&&(t.expiredLanes|=c),s&=~c}}function qh(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function qw(){var t=zl;return zl<<=1,!(zl&4194240)&&(zl=64),t}function Dd(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function fl(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-er(e),t[e]=n}function cx(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-er(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function bm(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-er(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Ze=0;function Gw(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Qw,xm,Kw,Yw,Xw,Gh=!1,Hl=[],mi=null,pi=null,gi=null,Va=new Map,La=new Map,ii=[],ux="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function oy(t,e){switch(t){case"focusin":case"focusout":mi=null;break;case"dragenter":case"dragleave":pi=null;break;case"mouseover":case"mouseout":gi=null;break;case"pointerover":case"pointerout":Va.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":La.delete(e.pointerId)}}function Xo(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=pl(e),e!==null&&xm(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function dx(t,e,n,r,i){switch(e){case"focusin":return mi=Xo(mi,t,e,n,r,i),!0;case"dragenter":return pi=Xo(pi,t,e,n,r,i),!0;case"mouseover":return gi=Xo(gi,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Va.set(s,Xo(Va.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,La.set(s,Xo(La.get(s)||null,t,e,n,r,i)),!0}return!1}function Jw(t){var e=Zi(t.target);if(e!==null){var n=_s(e);if(n!==null){if(e=n.tag,e===13){if(e=Uw(n),e!==null){t.blockedOn=e,Xw(t.priority,function(){Kw(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function _c(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Qh(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);zh=r,n.target.dispatchEvent(r),zh=null}else return e=pl(n),e!==null&&xm(e),t.blockedOn=n,!1;e.shift()}return!0}function ay(t,e,n){_c(t)&&n.delete(e)}function hx(){Gh=!1,mi!==null&&_c(mi)&&(mi=null),pi!==null&&_c(pi)&&(pi=null),gi!==null&&_c(gi)&&(gi=null),Va.forEach(ay),La.forEach(ay)}function Jo(t,e){t.blockedOn===e&&(t.blockedOn=null,Gh||(Gh=!0,Ln.unstable_scheduleCallback(Ln.unstable_NormalPriority,hx)))}function Fa(t){function e(i){return Jo(i,t)}if(0<Hl.length){Jo(Hl[0],t);for(var n=1;n<Hl.length;n++){var r=Hl[n];r.blockedOn===t&&(r.blockedOn=null)}}for(mi!==null&&Jo(mi,t),pi!==null&&Jo(pi,t),gi!==null&&Jo(gi,t),Va.forEach(e),La.forEach(e),n=0;n<ii.length;n++)r=ii[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<ii.length&&(n=ii[0],n.blockedOn===null);)Jw(n),n.blockedOn===null&&ii.shift()}var no=Hr.ReactCurrentBatchConfig,Bc=!0;function fx(t,e,n,r){var i=Ze,s=no.transition;no.transition=null;try{Ze=1,Im(t,e,n,r)}finally{Ze=i,no.transition=s}}function mx(t,e,n,r){var i=Ze,s=no.transition;no.transition=null;try{Ze=4,Im(t,e,n,r)}finally{Ze=i,no.transition=s}}function Im(t,e,n,r){if(Bc){var i=Qh(t,e,n,r);if(i===null)$d(t,e,r,zc,n),oy(t,r);else if(dx(i,t,e,n,r))r.stopPropagation();else if(oy(t,r),e&4&&-1<ux.indexOf(t)){for(;i!==null;){var s=pl(i);if(s!==null&&Qw(s),s=Qh(t,e,n,r),s===null&&$d(t,e,r,zc,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else $d(t,e,r,null,n)}}var zc=null;function Qh(t,e,n,r){if(zc=null,t=Em(r),t=Zi(t),t!==null)if(e=_s(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Uw(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return zc=t,null}function Zw(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(tx()){case Tm:return 1;case Hw:return 4;case Fc:case nx:return 16;case Ww:return 536870912;default:return 16}default:return 16}}var ci=null,Cm=null,wc=null;function e0(){if(wc)return wc;var t,e=Cm,n=e.length,r,i="value"in ci?ci.value:ci.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return wc=i.slice(t,1<r?1-r:void 0)}function Sc(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Wl(){return!0}function ly(){return!1}function Un(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(n=t[c],this[c]=n?n(s):s[c]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Wl:ly,this.isPropagationStopped=ly,this}return _t(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Wl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Wl)},persist:function(){},isPersistent:Wl}),e}var Ao={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Am=Un(Ao),ml=_t({},Ao,{view:0,detail:0}),px=Un(ml),jd,Md,Zo,Au=_t({},ml,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Nm,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Zo&&(Zo&&t.type==="mousemove"?(jd=t.screenX-Zo.screenX,Md=t.screenY-Zo.screenY):Md=jd=0,Zo=t),jd)},movementY:function(t){return"movementY"in t?t.movementY:Md}}),cy=Un(Au),gx=_t({},Au,{dataTransfer:0}),yx=Un(gx),vx=_t({},ml,{relatedTarget:0}),Od=Un(vx),_x=_t({},Ao,{animationName:0,elapsedTime:0,pseudoElement:0}),wx=Un(_x),Sx=_t({},Ao,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Ex=Un(Sx),Tx=_t({},Ao,{data:0}),uy=Un(Tx),bx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xx={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ix={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cx(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Ix[t])?!!e[t]:!1}function Nm(){return Cx}var Ax=_t({},ml,{key:function(t){if(t.key){var e=bx[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Sc(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?xx[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Nm,charCode:function(t){return t.type==="keypress"?Sc(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Sc(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Nx=Un(Ax),kx=_t({},Au,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),dy=Un(kx),Px=_t({},ml,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Nm}),Rx=Un(Px),Dx=_t({},Ao,{propertyName:0,elapsedTime:0,pseudoElement:0}),jx=Un(Dx),Mx=_t({},Au,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Ox=Un(Mx),Vx=[9,13,27,32],km=Vr&&"CompositionEvent"in window,wa=null;Vr&&"documentMode"in document&&(wa=document.documentMode);var Lx=Vr&&"TextEvent"in window&&!wa,t0=Vr&&(!km||wa&&8<wa&&11>=wa),hy=" ",fy=!1;function n0(t,e){switch(t){case"keyup":return Vx.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function r0(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var zs=!1;function Fx(t,e){switch(t){case"compositionend":return r0(e);case"keypress":return e.which!==32?null:(fy=!0,hy);case"textInput":return t=e.data,t===hy&&fy?null:t;default:return null}}function Ux(t,e){if(zs)return t==="compositionend"||!km&&n0(t,e)?(t=e0(),wc=Cm=ci=null,zs=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return t0&&e.locale!=="ko"?null:e.data;default:return null}}var Bx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function my(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Bx[t.type]:e==="textarea"}function i0(t,e,n,r){Mw(r),e=$c(e,"onChange"),0<e.length&&(n=new Am("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Sa=null,Ua=null;function zx(t){p0(t,0)}function Nu(t){var e=Ws(t);if(Aw(e))return t}function $x(t,e){if(t==="change")return e}var s0=!1;if(Vr){var Vd;if(Vr){var Ld="oninput"in document;if(!Ld){var py=document.createElement("div");py.setAttribute("oninput","return;"),Ld=typeof py.oninput=="function"}Vd=Ld}else Vd=!1;s0=Vd&&(!document.documentMode||9<document.documentMode)}function gy(){Sa&&(Sa.detachEvent("onpropertychange",o0),Ua=Sa=null)}function o0(t){if(t.propertyName==="value"&&Nu(Ua)){var e=[];i0(e,Ua,t,Em(t)),Fw(zx,e)}}function Hx(t,e,n){t==="focusin"?(gy(),Sa=e,Ua=n,Sa.attachEvent("onpropertychange",o0)):t==="focusout"&&gy()}function Wx(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Nu(Ua)}function qx(t,e){if(t==="click")return Nu(e)}function Gx(t,e){if(t==="input"||t==="change")return Nu(e)}function Qx(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var rr=typeof Object.is=="function"?Object.is:Qx;function Ba(t,e){if(rr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!kh.call(e,i)||!rr(t[i],e[i]))return!1}return!0}function yy(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function vy(t,e){var n=yy(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=yy(n)}}function a0(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?a0(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function l0(){for(var t=window,e=Oc();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Oc(t.document)}return e}function Pm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Kx(t){var e=l0(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&a0(n.ownerDocument.documentElement,n)){if(r!==null&&Pm(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=vy(n,s);var o=vy(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Yx=Vr&&"documentMode"in document&&11>=document.documentMode,$s=null,Kh=null,Ea=null,Yh=!1;function _y(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Yh||$s==null||$s!==Oc(r)||(r=$s,"selectionStart"in r&&Pm(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ea&&Ba(Ea,r)||(Ea=r,r=$c(Kh,"onSelect"),0<r.length&&(e=new Am("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=$s)))}function ql(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Hs={animationend:ql("Animation","AnimationEnd"),animationiteration:ql("Animation","AnimationIteration"),animationstart:ql("Animation","AnimationStart"),transitionend:ql("Transition","TransitionEnd")},Fd={},c0={};Vr&&(c0=document.createElement("div").style,"AnimationEvent"in window||(delete Hs.animationend.animation,delete Hs.animationiteration.animation,delete Hs.animationstart.animation),"TransitionEvent"in window||delete Hs.transitionend.transition);function ku(t){if(Fd[t])return Fd[t];if(!Hs[t])return t;var e=Hs[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in c0)return Fd[t]=e[n];return t}var u0=ku("animationend"),d0=ku("animationiteration"),h0=ku("animationstart"),f0=ku("transitionend"),m0=new Map,wy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Li(t,e){m0.set(t,e),vs(e,[t])}for(var Ud=0;Ud<wy.length;Ud++){var Bd=wy[Ud],Xx=Bd.toLowerCase(),Jx=Bd[0].toUpperCase()+Bd.slice(1);Li(Xx,"on"+Jx)}Li(u0,"onAnimationEnd");Li(d0,"onAnimationIteration");Li(h0,"onAnimationStart");Li("dblclick","onDoubleClick");Li("focusin","onFocus");Li("focusout","onBlur");Li(f0,"onTransitionEnd");co("onMouseEnter",["mouseout","mouseover"]);co("onMouseLeave",["mouseout","mouseover"]);co("onPointerEnter",["pointerout","pointerover"]);co("onPointerLeave",["pointerout","pointerover"]);vs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));vs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));vs("onBeforeInput",["compositionend","keypress","textInput","paste"]);vs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));vs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));vs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ha="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Zx=new Set("cancel close invalid load scroll toggle".split(" ").concat(ha));function Sy(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Xb(r,e,void 0,t),t.currentTarget=null}function p0(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var c=r[o],a=c.instance,d=c.currentTarget;if(c=c.listener,a!==s&&i.isPropagationStopped())break e;Sy(i,c,d),s=a}else for(o=0;o<r.length;o++){if(c=r[o],a=c.instance,d=c.currentTarget,c=c.listener,a!==s&&i.isPropagationStopped())break e;Sy(i,c,d),s=a}}}if(Lc)throw t=Wh,Lc=!1,Wh=null,t}function ct(t,e){var n=e[tf];n===void 0&&(n=e[tf]=new Set);var r=t+"__bubble";n.has(r)||(g0(e,t,2,!1),n.add(r))}function zd(t,e,n){var r=0;e&&(r|=4),g0(n,t,r,e)}var Gl="_reactListening"+Math.random().toString(36).slice(2);function za(t){if(!t[Gl]){t[Gl]=!0,Tw.forEach(function(n){n!=="selectionchange"&&(Zx.has(n)||zd(n,!1,t),zd(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Gl]||(e[Gl]=!0,zd("selectionchange",!1,e))}}function g0(t,e,n,r){switch(Zw(e)){case 1:var i=fx;break;case 4:i=mx;break;default:i=Im}n=i.bind(null,e,n,t),i=void 0,!Hh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function $d(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var c=r.stateNode.containerInfo;if(c===i||c.nodeType===8&&c.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var a=o.tag;if((a===3||a===4)&&(a=o.stateNode.containerInfo,a===i||a.nodeType===8&&a.parentNode===i))return;o=o.return}for(;c!==null;){if(o=Zi(c),o===null)return;if(a=o.tag,a===5||a===6){r=s=o;continue e}c=c.parentNode}}r=r.return}Fw(function(){var d=s,h=Em(n),f=[];e:{var p=m0.get(t);if(p!==void 0){var v=Am,x=t;switch(t){case"keypress":if(Sc(n)===0)break e;case"keydown":case"keyup":v=Nx;break;case"focusin":x="focus",v=Od;break;case"focusout":x="blur",v=Od;break;case"beforeblur":case"afterblur":v=Od;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=cy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=yx;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=Rx;break;case u0:case d0:case h0:v=wx;break;case f0:v=jx;break;case"scroll":v=px;break;case"wheel":v=Ox;break;case"copy":case"cut":case"paste":v=Ex;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=dy}var _=(e&4)!==0,P=!_&&t==="scroll",y=_?p!==null?p+"Capture":null:p;_=[];for(var w=d,T;w!==null;){T=w;var M=T.stateNode;if(T.tag===5&&M!==null&&(T=M,y!==null&&(M=Oa(w,y),M!=null&&_.push($a(w,M,T)))),P)break;w=w.return}0<_.length&&(p=new v(p,x,null,n,h),f.push({event:p,listeners:_}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",v=t==="mouseout"||t==="pointerout",p&&n!==zh&&(x=n.relatedTarget||n.fromElement)&&(Zi(x)||x[Lr]))break e;if((v||p)&&(p=h.window===h?h:(p=h.ownerDocument)?p.defaultView||p.parentWindow:window,v?(x=n.relatedTarget||n.toElement,v=d,x=x?Zi(x):null,x!==null&&(P=_s(x),x!==P||x.tag!==5&&x.tag!==6)&&(x=null)):(v=null,x=d),v!==x)){if(_=cy,M="onMouseLeave",y="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(_=dy,M="onPointerLeave",y="onPointerEnter",w="pointer"),P=v==null?p:Ws(v),T=x==null?p:Ws(x),p=new _(M,w+"leave",v,n,h),p.target=P,p.relatedTarget=T,M=null,Zi(h)===d&&(_=new _(y,w+"enter",x,n,h),_.target=T,_.relatedTarget=P,M=_),P=M,v&&x)t:{for(_=v,y=x,w=0,T=_;T;T=ks(T))w++;for(T=0,M=y;M;M=ks(M))T++;for(;0<w-T;)_=ks(_),w--;for(;0<T-w;)y=ks(y),T--;for(;w--;){if(_===y||y!==null&&_===y.alternate)break t;_=ks(_),y=ks(y)}_=null}else _=null;v!==null&&Ey(f,p,v,_,!1),x!==null&&P!==null&&Ey(f,P,x,_,!0)}}e:{if(p=d?Ws(d):window,v=p.nodeName&&p.nodeName.toLowerCase(),v==="select"||v==="input"&&p.type==="file")var L=$x;else if(my(p))if(s0)L=Gx;else{L=Wx;var B=Hx}else(v=p.nodeName)&&v.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(L=qx);if(L&&(L=L(t,d))){i0(f,L,n,h);break e}B&&B(t,p,d),t==="focusout"&&(B=p._wrapperState)&&B.controlled&&p.type==="number"&&Vh(p,"number",p.value)}switch(B=d?Ws(d):window,t){case"focusin":(my(B)||B.contentEditable==="true")&&($s=B,Kh=d,Ea=null);break;case"focusout":Ea=Kh=$s=null;break;case"mousedown":Yh=!0;break;case"contextmenu":case"mouseup":case"dragend":Yh=!1,_y(f,n,h);break;case"selectionchange":if(Yx)break;case"keydown":case"keyup":_y(f,n,h)}var C;if(km)e:{switch(t){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else zs?n0(t,n)&&(b="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(b="onCompositionStart");b&&(t0&&n.locale!=="ko"&&(zs||b!=="onCompositionStart"?b==="onCompositionEnd"&&zs&&(C=e0()):(ci=h,Cm="value"in ci?ci.value:ci.textContent,zs=!0)),B=$c(d,b),0<B.length&&(b=new uy(b,t,null,n,h),f.push({event:b,listeners:B}),C?b.data=C:(C=r0(n),C!==null&&(b.data=C)))),(C=Lx?Fx(t,n):Ux(t,n))&&(d=$c(d,"onBeforeInput"),0<d.length&&(h=new uy("onBeforeInput","beforeinput",null,n,h),f.push({event:h,listeners:d}),h.data=C))}p0(f,e)})}function $a(t,e,n){return{instance:t,listener:e,currentTarget:n}}function $c(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Oa(t,n),s!=null&&r.unshift($a(t,s,i)),s=Oa(t,e),s!=null&&r.push($a(t,s,i))),t=t.return}return r}function ks(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Ey(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var c=n,a=c.alternate,d=c.stateNode;if(a!==null&&a===r)break;c.tag===5&&d!==null&&(c=d,i?(a=Oa(n,s),a!=null&&o.unshift($a(n,a,c))):i||(a=Oa(n,s),a!=null&&o.push($a(n,a,c)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var eI=/\r\n?/g,tI=/\u0000|\uFFFD/g;function Ty(t){return(typeof t=="string"?t:""+t).replace(eI,`
`).replace(tI,"")}function Ql(t,e,n){if(e=Ty(e),Ty(t)!==e&&n)throw Error(se(425))}function Hc(){}var Xh=null,Jh=null;function Zh(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var ef=typeof setTimeout=="function"?setTimeout:void 0,nI=typeof clearTimeout=="function"?clearTimeout:void 0,by=typeof Promise=="function"?Promise:void 0,rI=typeof queueMicrotask=="function"?queueMicrotask:typeof by<"u"?function(t){return by.resolve(null).then(t).catch(iI)}:ef;function iI(t){setTimeout(function(){throw t})}function Hd(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Fa(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Fa(e)}function yi(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function xy(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var No=Math.random().toString(36).slice(2),fr="__reactFiber$"+No,Ha="__reactProps$"+No,Lr="__reactContainer$"+No,tf="__reactEvents$"+No,sI="__reactListeners$"+No,oI="__reactHandles$"+No;function Zi(t){var e=t[fr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Lr]||n[fr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=xy(t);t!==null;){if(n=t[fr])return n;t=xy(t)}return e}t=n,n=t.parentNode}return null}function pl(t){return t=t[fr]||t[Lr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ws(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(se(33))}function Pu(t){return t[Ha]||null}var nf=[],qs=-1;function Fi(t){return{current:t}}function dt(t){0>qs||(t.current=nf[qs],nf[qs]=null,qs--)}function at(t,e){qs++,nf[qs]=t.current,t.current=e}var Ni={},hn=Fi(Ni),xn=Fi(!1),as=Ni;function uo(t,e){var n=t.type.contextTypes;if(!n)return Ni;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function In(t){return t=t.childContextTypes,t!=null}function Wc(){dt(xn),dt(hn)}function Iy(t,e,n){if(hn.current!==Ni)throw Error(se(168));at(hn,e),at(xn,n)}function y0(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(se(108,Hb(t)||"Unknown",i));return _t({},n,r)}function qc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ni,as=hn.current,at(hn,t),at(xn,xn.current),!0}function Cy(t,e,n){var r=t.stateNode;if(!r)throw Error(se(169));n?(t=y0(t,e,as),r.__reactInternalMemoizedMergedChildContext=t,dt(xn),dt(hn),at(hn,t)):dt(xn),at(xn,n)}var Pr=null,Ru=!1,Wd=!1;function v0(t){Pr===null?Pr=[t]:Pr.push(t)}function aI(t){Ru=!0,v0(t)}function Ui(){if(!Wd&&Pr!==null){Wd=!0;var t=0,e=Ze;try{var n=Pr;for(Ze=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Pr=null,Ru=!1}catch(i){throw Pr!==null&&(Pr=Pr.slice(t+1)),$w(Tm,Ui),i}finally{Ze=e,Wd=!1}}return null}var Gs=[],Qs=0,Gc=null,Qc=0,zn=[],$n=0,ls=null,Dr=1,jr="";function Ki(t,e){Gs[Qs++]=Qc,Gs[Qs++]=Gc,Gc=t,Qc=e}function _0(t,e,n){zn[$n++]=Dr,zn[$n++]=jr,zn[$n++]=ls,ls=t;var r=Dr;t=jr;var i=32-er(r)-1;r&=~(1<<i),n+=1;var s=32-er(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Dr=1<<32-er(e)+i|n<<i|r,jr=s+t}else Dr=1<<s|n<<i|r,jr=t}function Rm(t){t.return!==null&&(Ki(t,1),_0(t,1,0))}function Dm(t){for(;t===Gc;)Gc=Gs[--Qs],Gs[Qs]=null,Qc=Gs[--Qs],Gs[Qs]=null;for(;t===ls;)ls=zn[--$n],zn[$n]=null,jr=zn[--$n],zn[$n]=null,Dr=zn[--$n],zn[$n]=null}var Vn=null,jn=null,ft=!1,Zn=null;function w0(t,e){var n=Wn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Ay(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Vn=t,jn=yi(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Vn=t,jn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ls!==null?{id:Dr,overflow:jr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Wn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Vn=t,jn=null,!0):!1;default:return!1}}function rf(t){return(t.mode&1)!==0&&(t.flags&128)===0}function sf(t){if(ft){var e=jn;if(e){var n=e;if(!Ay(t,e)){if(rf(t))throw Error(se(418));e=yi(n.nextSibling);var r=Vn;e&&Ay(t,e)?w0(r,n):(t.flags=t.flags&-4097|2,ft=!1,Vn=t)}}else{if(rf(t))throw Error(se(418));t.flags=t.flags&-4097|2,ft=!1,Vn=t}}}function Ny(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Vn=t}function Kl(t){if(t!==Vn)return!1;if(!ft)return Ny(t),ft=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Zh(t.type,t.memoizedProps)),e&&(e=jn)){if(rf(t))throw S0(),Error(se(418));for(;e;)w0(t,e),e=yi(e.nextSibling)}if(Ny(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(se(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){jn=yi(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}jn=null}}else jn=Vn?yi(t.stateNode.nextSibling):null;return!0}function S0(){for(var t=jn;t;)t=yi(t.nextSibling)}function ho(){jn=Vn=null,ft=!1}function jm(t){Zn===null?Zn=[t]:Zn.push(t)}var lI=Hr.ReactCurrentBatchConfig;function ea(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(se(309));var r=n.stateNode}if(!r)throw Error(se(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var c=i.refs;o===null?delete c[s]:c[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(se(284));if(!n._owner)throw Error(se(290,t))}return t}function Yl(t,e){throw t=Object.prototype.toString.call(e),Error(se(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function ky(t){var e=t._init;return e(t._payload)}function E0(t){function e(y,w){if(t){var T=y.deletions;T===null?(y.deletions=[w],y.flags|=16):T.push(w)}}function n(y,w){if(!t)return null;for(;w!==null;)e(y,w),w=w.sibling;return null}function r(y,w){for(y=new Map;w!==null;)w.key!==null?y.set(w.key,w):y.set(w.index,w),w=w.sibling;return y}function i(y,w){return y=Si(y,w),y.index=0,y.sibling=null,y}function s(y,w,T){return y.index=T,t?(T=y.alternate,T!==null?(T=T.index,T<w?(y.flags|=2,w):T):(y.flags|=2,w)):(y.flags|=1048576,w)}function o(y){return t&&y.alternate===null&&(y.flags|=2),y}function c(y,w,T,M){return w===null||w.tag!==6?(w=Jd(T,y.mode,M),w.return=y,w):(w=i(w,T),w.return=y,w)}function a(y,w,T,M){var L=T.type;return L===Bs?h(y,w,T.props.children,M,T.key):w!==null&&(w.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===ni&&ky(L)===w.type)?(M=i(w,T.props),M.ref=ea(y,w,T),M.return=y,M):(M=Ac(T.type,T.key,T.props,null,y.mode,M),M.ref=ea(y,w,T),M.return=y,M)}function d(y,w,T,M){return w===null||w.tag!==4||w.stateNode.containerInfo!==T.containerInfo||w.stateNode.implementation!==T.implementation?(w=Zd(T,y.mode,M),w.return=y,w):(w=i(w,T.children||[]),w.return=y,w)}function h(y,w,T,M,L){return w===null||w.tag!==7?(w=is(T,y.mode,M,L),w.return=y,w):(w=i(w,T),w.return=y,w)}function f(y,w,T){if(typeof w=="string"&&w!==""||typeof w=="number")return w=Jd(""+w,y.mode,T),w.return=y,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Fl:return T=Ac(w.type,w.key,w.props,null,y.mode,T),T.ref=ea(y,null,w),T.return=y,T;case Us:return w=Zd(w,y.mode,T),w.return=y,w;case ni:var M=w._init;return f(y,M(w._payload),T)}if(ua(w)||Ko(w))return w=is(w,y.mode,T,null),w.return=y,w;Yl(y,w)}return null}function p(y,w,T,M){var L=w!==null?w.key:null;if(typeof T=="string"&&T!==""||typeof T=="number")return L!==null?null:c(y,w,""+T,M);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Fl:return T.key===L?a(y,w,T,M):null;case Us:return T.key===L?d(y,w,T,M):null;case ni:return L=T._init,p(y,w,L(T._payload),M)}if(ua(T)||Ko(T))return L!==null?null:h(y,w,T,M,null);Yl(y,T)}return null}function v(y,w,T,M,L){if(typeof M=="string"&&M!==""||typeof M=="number")return y=y.get(T)||null,c(w,y,""+M,L);if(typeof M=="object"&&M!==null){switch(M.$$typeof){case Fl:return y=y.get(M.key===null?T:M.key)||null,a(w,y,M,L);case Us:return y=y.get(M.key===null?T:M.key)||null,d(w,y,M,L);case ni:var B=M._init;return v(y,w,T,B(M._payload),L)}if(ua(M)||Ko(M))return y=y.get(T)||null,h(w,y,M,L,null);Yl(w,M)}return null}function x(y,w,T,M){for(var L=null,B=null,C=w,b=w=0,R=null;C!==null&&b<T.length;b++){C.index>b?(R=C,C=null):R=C.sibling;var S=p(y,C,T[b],M);if(S===null){C===null&&(C=R);break}t&&C&&S.alternate===null&&e(y,C),w=s(S,w,b),B===null?L=S:B.sibling=S,B=S,C=R}if(b===T.length)return n(y,C),ft&&Ki(y,b),L;if(C===null){for(;b<T.length;b++)C=f(y,T[b],M),C!==null&&(w=s(C,w,b),B===null?L=C:B.sibling=C,B=C);return ft&&Ki(y,b),L}for(C=r(y,C);b<T.length;b++)R=v(C,y,b,T[b],M),R!==null&&(t&&R.alternate!==null&&C.delete(R.key===null?b:R.key),w=s(R,w,b),B===null?L=R:B.sibling=R,B=R);return t&&C.forEach(function(E){return e(y,E)}),ft&&Ki(y,b),L}function _(y,w,T,M){var L=Ko(T);if(typeof L!="function")throw Error(se(150));if(T=L.call(T),T==null)throw Error(se(151));for(var B=L=null,C=w,b=w=0,R=null,S=T.next();C!==null&&!S.done;b++,S=T.next()){C.index>b?(R=C,C=null):R=C.sibling;var E=p(y,C,S.value,M);if(E===null){C===null&&(C=R);break}t&&C&&E.alternate===null&&e(y,C),w=s(E,w,b),B===null?L=E:B.sibling=E,B=E,C=R}if(S.done)return n(y,C),ft&&Ki(y,b),L;if(C===null){for(;!S.done;b++,S=T.next())S=f(y,S.value,M),S!==null&&(w=s(S,w,b),B===null?L=S:B.sibling=S,B=S);return ft&&Ki(y,b),L}for(C=r(y,C);!S.done;b++,S=T.next())S=v(C,y,b,S.value,M),S!==null&&(t&&S.alternate!==null&&C.delete(S.key===null?b:S.key),w=s(S,w,b),B===null?L=S:B.sibling=S,B=S);return t&&C.forEach(function(j){return e(y,j)}),ft&&Ki(y,b),L}function P(y,w,T,M){if(typeof T=="object"&&T!==null&&T.type===Bs&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case Fl:e:{for(var L=T.key,B=w;B!==null;){if(B.key===L){if(L=T.type,L===Bs){if(B.tag===7){n(y,B.sibling),w=i(B,T.props.children),w.return=y,y=w;break e}}else if(B.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===ni&&ky(L)===B.type){n(y,B.sibling),w=i(B,T.props),w.ref=ea(y,B,T),w.return=y,y=w;break e}n(y,B);break}else e(y,B);B=B.sibling}T.type===Bs?(w=is(T.props.children,y.mode,M,T.key),w.return=y,y=w):(M=Ac(T.type,T.key,T.props,null,y.mode,M),M.ref=ea(y,w,T),M.return=y,y=M)}return o(y);case Us:e:{for(B=T.key;w!==null;){if(w.key===B)if(w.tag===4&&w.stateNode.containerInfo===T.containerInfo&&w.stateNode.implementation===T.implementation){n(y,w.sibling),w=i(w,T.children||[]),w.return=y,y=w;break e}else{n(y,w);break}else e(y,w);w=w.sibling}w=Zd(T,y.mode,M),w.return=y,y=w}return o(y);case ni:return B=T._init,P(y,w,B(T._payload),M)}if(ua(T))return x(y,w,T,M);if(Ko(T))return _(y,w,T,M);Yl(y,T)}return typeof T=="string"&&T!==""||typeof T=="number"?(T=""+T,w!==null&&w.tag===6?(n(y,w.sibling),w=i(w,T),w.return=y,y=w):(n(y,w),w=Jd(T,y.mode,M),w.return=y,y=w),o(y)):n(y,w)}return P}var fo=E0(!0),T0=E0(!1),Kc=Fi(null),Yc=null,Ks=null,Mm=null;function Om(){Mm=Ks=Yc=null}function Vm(t){var e=Kc.current;dt(Kc),t._currentValue=e}function of(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ro(t,e){Yc=t,Mm=Ks=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(bn=!0),t.firstContext=null)}function Gn(t){var e=t._currentValue;if(Mm!==t)if(t={context:t,memoizedValue:e,next:null},Ks===null){if(Yc===null)throw Error(se(308));Ks=t,Yc.dependencies={lanes:0,firstContext:t}}else Ks=Ks.next=t;return e}var es=null;function Lm(t){es===null?es=[t]:es.push(t)}function b0(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Lm(e)):(n.next=i.next,i.next=n),e.interleaved=n,Fr(t,r)}function Fr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ri=!1;function Fm(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function x0(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Mr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function vi(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,qe&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Fr(t,n)}return i=r.interleaved,i===null?(e.next=e,Lm(r)):(e.next=i.next,i.next=e),r.interleaved=e,Fr(t,n)}function Ec(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,bm(t,n)}}function Py(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Xc(t,e,n,r){var i=t.updateQueue;ri=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,c=i.shared.pending;if(c!==null){i.shared.pending=null;var a=c,d=a.next;a.next=null,o===null?s=d:o.next=d,o=a;var h=t.alternate;h!==null&&(h=h.updateQueue,c=h.lastBaseUpdate,c!==o&&(c===null?h.firstBaseUpdate=d:c.next=d,h.lastBaseUpdate=a))}if(s!==null){var f=i.baseState;o=0,h=d=a=null,c=s;do{var p=c.lane,v=c.eventTime;if((r&p)===p){h!==null&&(h=h.next={eventTime:v,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var x=t,_=c;switch(p=e,v=n,_.tag){case 1:if(x=_.payload,typeof x=="function"){f=x.call(v,f,p);break e}f=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=_.payload,p=typeof x=="function"?x.call(v,f,p):x,p==null)break e;f=_t({},f,p);break e;case 2:ri=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,p=i.effects,p===null?i.effects=[c]:p.push(c))}else v={eventTime:v,lane:p,tag:c.tag,payload:c.payload,callback:c.callback,next:null},h===null?(d=h=v,a=f):h=h.next=v,o|=p;if(c=c.next,c===null){if(c=i.shared.pending,c===null)break;p=c,c=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(!0);if(h===null&&(a=f),i.baseState=a,i.firstBaseUpdate=d,i.lastBaseUpdate=h,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);us|=o,t.lanes=o,t.memoizedState=f}}function Ry(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(se(191,i));i.call(r)}}}var gl={},yr=Fi(gl),Wa=Fi(gl),qa=Fi(gl);function ts(t){if(t===gl)throw Error(se(174));return t}function Um(t,e){switch(at(qa,e),at(Wa,t),at(yr,gl),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Fh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Fh(e,t)}dt(yr),at(yr,e)}function mo(){dt(yr),dt(Wa),dt(qa)}function I0(t){ts(qa.current);var e=ts(yr.current),n=Fh(e,t.type);e!==n&&(at(Wa,t),at(yr,n))}function Bm(t){Wa.current===t&&(dt(yr),dt(Wa))}var gt=Fi(0);function Jc(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var qd=[];function zm(){for(var t=0;t<qd.length;t++)qd[t]._workInProgressVersionPrimary=null;qd.length=0}var Tc=Hr.ReactCurrentDispatcher,Gd=Hr.ReactCurrentBatchConfig,cs=0,yt=null,Ft=null,Wt=null,Zc=!1,Ta=!1,Ga=0,cI=0;function sn(){throw Error(se(321))}function $m(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!rr(t[n],e[n]))return!1;return!0}function Hm(t,e,n,r,i,s){if(cs=s,yt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Tc.current=t===null||t.memoizedState===null?fI:mI,t=n(r,i),Ta){s=0;do{if(Ta=!1,Ga=0,25<=s)throw Error(se(301));s+=1,Wt=Ft=null,e.updateQueue=null,Tc.current=pI,t=n(r,i)}while(Ta)}if(Tc.current=eu,e=Ft!==null&&Ft.next!==null,cs=0,Wt=Ft=yt=null,Zc=!1,e)throw Error(se(300));return t}function Wm(){var t=Ga!==0;return Ga=0,t}function dr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wt===null?yt.memoizedState=Wt=t:Wt=Wt.next=t,Wt}function Qn(){if(Ft===null){var t=yt.alternate;t=t!==null?t.memoizedState:null}else t=Ft.next;var e=Wt===null?yt.memoizedState:Wt.next;if(e!==null)Wt=e,Ft=t;else{if(t===null)throw Error(se(310));Ft=t,t={memoizedState:Ft.memoizedState,baseState:Ft.baseState,baseQueue:Ft.baseQueue,queue:Ft.queue,next:null},Wt===null?yt.memoizedState=Wt=t:Wt=Wt.next=t}return Wt}function Qa(t,e){return typeof e=="function"?e(t):e}function Qd(t){var e=Qn(),n=e.queue;if(n===null)throw Error(se(311));n.lastRenderedReducer=t;var r=Ft,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var c=o=null,a=null,d=s;do{var h=d.lane;if((cs&h)===h)a!==null&&(a=a.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var f={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};a===null?(c=a=f,o=r):a=a.next=f,yt.lanes|=h,us|=h}d=d.next}while(d!==null&&d!==s);a===null?o=r:a.next=c,rr(r,e.memoizedState)||(bn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=a,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,yt.lanes|=s,us|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Kd(t){var e=Qn(),n=e.queue;if(n===null)throw Error(se(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);rr(s,e.memoizedState)||(bn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function C0(){}function A0(t,e){var n=yt,r=Qn(),i=e(),s=!rr(r.memoizedState,i);if(s&&(r.memoizedState=i,bn=!0),r=r.queue,qm(P0.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Wt!==null&&Wt.memoizedState.tag&1){if(n.flags|=2048,Ka(9,k0.bind(null,n,r,i,e),void 0,null),Gt===null)throw Error(se(349));cs&30||N0(n,e,i)}return i}function N0(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=yt.updateQueue,e===null?(e={lastEffect:null,stores:null},yt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function k0(t,e,n,r){e.value=n,e.getSnapshot=r,R0(e)&&D0(t)}function P0(t,e,n){return n(function(){R0(e)&&D0(t)})}function R0(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!rr(t,n)}catch{return!0}}function D0(t){var e=Fr(t,1);e!==null&&tr(e,t,1,-1)}function Dy(t){var e=dr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Qa,lastRenderedState:t},e.queue=t,t=t.dispatch=hI.bind(null,yt,t),[e.memoizedState,t]}function Ka(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=yt.updateQueue,e===null?(e={lastEffect:null,stores:null},yt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function j0(){return Qn().memoizedState}function bc(t,e,n,r){var i=dr();yt.flags|=t,i.memoizedState=Ka(1|e,n,void 0,r===void 0?null:r)}function Du(t,e,n,r){var i=Qn();r=r===void 0?null:r;var s=void 0;if(Ft!==null){var o=Ft.memoizedState;if(s=o.destroy,r!==null&&$m(r,o.deps)){i.memoizedState=Ka(e,n,s,r);return}}yt.flags|=t,i.memoizedState=Ka(1|e,n,s,r)}function jy(t,e){return bc(8390656,8,t,e)}function qm(t,e){return Du(2048,8,t,e)}function M0(t,e){return Du(4,2,t,e)}function O0(t,e){return Du(4,4,t,e)}function V0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function L0(t,e,n){return n=n!=null?n.concat([t]):null,Du(4,4,V0.bind(null,e,t),n)}function Gm(){}function F0(t,e){var n=Qn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&$m(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function U0(t,e){var n=Qn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&$m(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function B0(t,e,n){return cs&21?(rr(n,e)||(n=qw(),yt.lanes|=n,us|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,bn=!0),t.memoizedState=n)}function uI(t,e){var n=Ze;Ze=n!==0&&4>n?n:4,t(!0);var r=Gd.transition;Gd.transition={};try{t(!1),e()}finally{Ze=n,Gd.transition=r}}function z0(){return Qn().memoizedState}function dI(t,e,n){var r=wi(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},$0(t))H0(e,n);else if(n=b0(t,e,n,r),n!==null){var i=gn();tr(n,t,r,i),W0(n,e,r)}}function hI(t,e,n){var r=wi(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if($0(t))H0(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,c=s(o,n);if(i.hasEagerState=!0,i.eagerState=c,rr(c,o)){var a=e.interleaved;a===null?(i.next=i,Lm(e)):(i.next=a.next,a.next=i),e.interleaved=i;return}}catch{}finally{}n=b0(t,e,i,r),n!==null&&(i=gn(),tr(n,t,r,i),W0(n,e,r))}}function $0(t){var e=t.alternate;return t===yt||e!==null&&e===yt}function H0(t,e){Ta=Zc=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function W0(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,bm(t,n)}}var eu={readContext:Gn,useCallback:sn,useContext:sn,useEffect:sn,useImperativeHandle:sn,useInsertionEffect:sn,useLayoutEffect:sn,useMemo:sn,useReducer:sn,useRef:sn,useState:sn,useDebugValue:sn,useDeferredValue:sn,useTransition:sn,useMutableSource:sn,useSyncExternalStore:sn,useId:sn,unstable_isNewReconciler:!1},fI={readContext:Gn,useCallback:function(t,e){return dr().memoizedState=[t,e===void 0?null:e],t},useContext:Gn,useEffect:jy,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,bc(4194308,4,V0.bind(null,e,t),n)},useLayoutEffect:function(t,e){return bc(4194308,4,t,e)},useInsertionEffect:function(t,e){return bc(4,2,t,e)},useMemo:function(t,e){var n=dr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=dr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=dI.bind(null,yt,t),[r.memoizedState,t]},useRef:function(t){var e=dr();return t={current:t},e.memoizedState=t},useState:Dy,useDebugValue:Gm,useDeferredValue:function(t){return dr().memoizedState=t},useTransition:function(){var t=Dy(!1),e=t[0];return t=uI.bind(null,t[1]),dr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=yt,i=dr();if(ft){if(n===void 0)throw Error(se(407));n=n()}else{if(n=e(),Gt===null)throw Error(se(349));cs&30||N0(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,jy(P0.bind(null,r,s,t),[t]),r.flags|=2048,Ka(9,k0.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=dr(),e=Gt.identifierPrefix;if(ft){var n=jr,r=Dr;n=(r&~(1<<32-er(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Ga++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=cI++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},mI={readContext:Gn,useCallback:F0,useContext:Gn,useEffect:qm,useImperativeHandle:L0,useInsertionEffect:M0,useLayoutEffect:O0,useMemo:U0,useReducer:Qd,useRef:j0,useState:function(){return Qd(Qa)},useDebugValue:Gm,useDeferredValue:function(t){var e=Qn();return B0(e,Ft.memoizedState,t)},useTransition:function(){var t=Qd(Qa)[0],e=Qn().memoizedState;return[t,e]},useMutableSource:C0,useSyncExternalStore:A0,useId:z0,unstable_isNewReconciler:!1},pI={readContext:Gn,useCallback:F0,useContext:Gn,useEffect:qm,useImperativeHandle:L0,useInsertionEffect:M0,useLayoutEffect:O0,useMemo:U0,useReducer:Kd,useRef:j0,useState:function(){return Kd(Qa)},useDebugValue:Gm,useDeferredValue:function(t){var e=Qn();return Ft===null?e.memoizedState=t:B0(e,Ft.memoizedState,t)},useTransition:function(){var t=Kd(Qa)[0],e=Qn().memoizedState;return[t,e]},useMutableSource:C0,useSyncExternalStore:A0,useId:z0,unstable_isNewReconciler:!1};function Xn(t,e){if(t&&t.defaultProps){e=_t({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function af(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:_t({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var ju={isMounted:function(t){return(t=t._reactInternals)?_s(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=gn(),i=wi(t),s=Mr(r,i);s.payload=e,n!=null&&(s.callback=n),e=vi(t,s,i),e!==null&&(tr(e,t,i,r),Ec(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=gn(),i=wi(t),s=Mr(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=vi(t,s,i),e!==null&&(tr(e,t,i,r),Ec(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=gn(),r=wi(t),i=Mr(n,r);i.tag=2,e!=null&&(i.callback=e),e=vi(t,i,r),e!==null&&(tr(e,t,r,n),Ec(e,t,r))}};function My(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Ba(n,r)||!Ba(i,s):!0}function q0(t,e,n){var r=!1,i=Ni,s=e.contextType;return typeof s=="object"&&s!==null?s=Gn(s):(i=In(e)?as:hn.current,r=e.contextTypes,s=(r=r!=null)?uo(t,i):Ni),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=ju,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function Oy(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&ju.enqueueReplaceState(e,e.state,null)}function lf(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Fm(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Gn(s):(s=In(e)?as:hn.current,i.context=uo(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(af(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&ju.enqueueReplaceState(i,i.state,null),Xc(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function po(t,e){try{var n="",r=e;do n+=$b(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Yd(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function cf(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var gI=typeof WeakMap=="function"?WeakMap:Map;function G0(t,e,n){n=Mr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){nu||(nu=!0,_f=r),cf(t,e)},n}function Q0(t,e,n){n=Mr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){cf(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){cf(t,e),typeof r!="function"&&(_i===null?_i=new Set([this]):_i.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Vy(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new gI;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=kI.bind(null,t,e,n),e.then(t,t))}function Ly(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Fy(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Mr(-1,1),e.tag=2,vi(n,e,1))),n.lanes|=1),t)}var yI=Hr.ReactCurrentOwner,bn=!1;function pn(t,e,n,r){e.child=t===null?T0(e,null,n,r):fo(e,t.child,n,r)}function Uy(t,e,n,r,i){n=n.render;var s=e.ref;return ro(e,i),r=Hm(t,e,n,r,s,i),n=Wm(),t!==null&&!bn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ur(t,e,i)):(ft&&n&&Rm(e),e.flags|=1,pn(t,e,r,i),e.child)}function By(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!tp(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,K0(t,e,s,r,i)):(t=Ac(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Ba,n(o,r)&&t.ref===e.ref)return Ur(t,e,i)}return e.flags|=1,t=Si(s,r),t.ref=e.ref,t.return=e,e.child=t}function K0(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Ba(s,r)&&t.ref===e.ref)if(bn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(bn=!0);else return e.lanes=t.lanes,Ur(t,e,i)}return uf(t,e,n,r,i)}function Y0(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},at(Xs,Dn),Dn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,at(Xs,Dn),Dn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,at(Xs,Dn),Dn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,at(Xs,Dn),Dn|=r;return pn(t,e,i,n),e.child}function X0(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function uf(t,e,n,r,i){var s=In(n)?as:hn.current;return s=uo(e,s),ro(e,i),n=Hm(t,e,n,r,s,i),r=Wm(),t!==null&&!bn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ur(t,e,i)):(ft&&r&&Rm(e),e.flags|=1,pn(t,e,n,i),e.child)}function zy(t,e,n,r,i){if(In(n)){var s=!0;qc(e)}else s=!1;if(ro(e,i),e.stateNode===null)xc(t,e),q0(e,n,r),lf(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,c=e.memoizedProps;o.props=c;var a=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=Gn(d):(d=In(n)?as:hn.current,d=uo(e,d));var h=n.getDerivedStateFromProps,f=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==r||a!==d)&&Oy(e,o,r,d),ri=!1;var p=e.memoizedState;o.state=p,Xc(e,r,o,i),a=e.memoizedState,c!==r||p!==a||xn.current||ri?(typeof h=="function"&&(af(e,n,h,r),a=e.memoizedState),(c=ri||My(e,n,c,r,p,a,d))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=a),o.props=r,o.state=a,o.context=d,r=c):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,x0(t,e),c=e.memoizedProps,d=e.type===e.elementType?c:Xn(e.type,c),o.props=d,f=e.pendingProps,p=o.context,a=n.contextType,typeof a=="object"&&a!==null?a=Gn(a):(a=In(n)?as:hn.current,a=uo(e,a));var v=n.getDerivedStateFromProps;(h=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==f||p!==a)&&Oy(e,o,r,a),ri=!1,p=e.memoizedState,o.state=p,Xc(e,r,o,i);var x=e.memoizedState;c!==f||p!==x||xn.current||ri?(typeof v=="function"&&(af(e,n,v,r),x=e.memoizedState),(d=ri||My(e,n,d,r,p,x,a)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,x,a),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,x,a)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=x),o.props=r,o.state=x,o.context=a,r=d):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return df(t,e,n,r,s,i)}function df(t,e,n,r,i,s){X0(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&Cy(e,n,!1),Ur(t,e,s);r=e.stateNode,yI.current=e;var c=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=fo(e,t.child,null,s),e.child=fo(e,null,c,s)):pn(t,e,c,s),e.memoizedState=r.state,i&&Cy(e,n,!0),e.child}function J0(t){var e=t.stateNode;e.pendingContext?Iy(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Iy(t,e.context,!1),Um(t,e.containerInfo)}function $y(t,e,n,r,i){return ho(),jm(i),e.flags|=256,pn(t,e,n,r),e.child}var hf={dehydrated:null,treeContext:null,retryLane:0};function ff(t){return{baseLanes:t,cachePool:null,transitions:null}}function Z0(t,e,n){var r=e.pendingProps,i=gt.current,s=!1,o=(e.flags&128)!==0,c;if((c=o)||(c=t!==null&&t.memoizedState===null?!1:(i&2)!==0),c?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),at(gt,i&1),t===null)return sf(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Vu(o,r,0,null),t=is(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=ff(n),e.memoizedState=hf,t):Qm(e,o));if(i=t.memoizedState,i!==null&&(c=i.dehydrated,c!==null))return vI(t,e,o,r,c,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,c=i.sibling;var a={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=a,e.deletions=null):(r=Si(i,a),r.subtreeFlags=i.subtreeFlags&14680064),c!==null?s=Si(c,s):(s=is(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?ff(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=hf,r}return s=t.child,t=s.sibling,r=Si(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Qm(t,e){return e=Vu({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Xl(t,e,n,r){return r!==null&&jm(r),fo(e,t.child,null,n),t=Qm(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function vI(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=Yd(Error(se(422))),Xl(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Vu({mode:"visible",children:r.children},i,0,null),s=is(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&fo(e,t.child,null,o),e.child.memoizedState=ff(o),e.memoizedState=hf,s);if(!(e.mode&1))return Xl(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var c=r.dgst;return r=c,s=Error(se(419)),r=Yd(s,r,void 0),Xl(t,e,o,r)}if(c=(o&t.childLanes)!==0,bn||c){if(r=Gt,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Fr(t,i),tr(r,t,i,-1))}return ep(),r=Yd(Error(se(421))),Xl(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=PI.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,jn=yi(i.nextSibling),Vn=e,ft=!0,Zn=null,t!==null&&(zn[$n++]=Dr,zn[$n++]=jr,zn[$n++]=ls,Dr=t.id,jr=t.overflow,ls=e),e=Qm(e,r.children),e.flags|=4096,e)}function Hy(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),of(t.return,e,n)}function Xd(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function eS(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(pn(t,e,r.children,n),r=gt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Hy(t,n,e);else if(t.tag===19)Hy(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(at(gt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Jc(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Xd(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Jc(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Xd(e,!0,n,null,s);break;case"together":Xd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function xc(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ur(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),us|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(se(153));if(e.child!==null){for(t=e.child,n=Si(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Si(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function _I(t,e,n){switch(e.tag){case 3:J0(e),ho();break;case 5:I0(e);break;case 1:In(e.type)&&qc(e);break;case 4:Um(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;at(Kc,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(at(gt,gt.current&1),e.flags|=128,null):n&e.child.childLanes?Z0(t,e,n):(at(gt,gt.current&1),t=Ur(t,e,n),t!==null?t.sibling:null);at(gt,gt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return eS(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),at(gt,gt.current),r)break;return null;case 22:case 23:return e.lanes=0,Y0(t,e,n)}return Ur(t,e,n)}var tS,mf,nS,rS;tS=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};mf=function(){};nS=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,ts(yr.current);var s=null;switch(n){case"input":i=Mh(t,i),r=Mh(t,r),s=[];break;case"select":i=_t({},i,{value:void 0}),r=_t({},r,{value:void 0}),s=[];break;case"textarea":i=Lh(t,i),r=Lh(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Hc)}Uh(n,r);var o;n=null;for(d in i)if(!r.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var c=i[d];for(o in c)c.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(ja.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in r){var a=r[d];if(c=i!=null?i[d]:void 0,r.hasOwnProperty(d)&&a!==c&&(a!=null||c!=null))if(d==="style")if(c){for(o in c)!c.hasOwnProperty(o)||a&&a.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in a)a.hasOwnProperty(o)&&c[o]!==a[o]&&(n||(n={}),n[o]=a[o])}else n||(s||(s=[]),s.push(d,n)),n=a;else d==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,c=c?c.__html:void 0,a!=null&&c!==a&&(s=s||[]).push(d,a)):d==="children"?typeof a!="string"&&typeof a!="number"||(s=s||[]).push(d,""+a):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(ja.hasOwnProperty(d)?(a!=null&&d==="onScroll"&&ct("scroll",t),s||c===a||(s=[])):(s=s||[]).push(d,a))}n&&(s=s||[]).push("style",n);var d=s;(e.updateQueue=d)&&(e.flags|=4)}};rS=function(t,e,n,r){n!==r&&(e.flags|=4)};function ta(t,e){if(!ft)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function on(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function wI(t,e,n){var r=e.pendingProps;switch(Dm(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return on(e),null;case 1:return In(e.type)&&Wc(),on(e),null;case 3:return r=e.stateNode,mo(),dt(xn),dt(hn),zm(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Kl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Zn!==null&&(Ef(Zn),Zn=null))),mf(t,e),on(e),null;case 5:Bm(e);var i=ts(qa.current);if(n=e.type,t!==null&&e.stateNode!=null)nS(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(se(166));return on(e),null}if(t=ts(yr.current),Kl(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[fr]=e,r[Ha]=s,t=(e.mode&1)!==0,n){case"dialog":ct("cancel",r),ct("close",r);break;case"iframe":case"object":case"embed":ct("load",r);break;case"video":case"audio":for(i=0;i<ha.length;i++)ct(ha[i],r);break;case"source":ct("error",r);break;case"img":case"image":case"link":ct("error",r),ct("load",r);break;case"details":ct("toggle",r);break;case"input":Zg(r,s),ct("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},ct("invalid",r);break;case"textarea":ty(r,s),ct("invalid",r)}Uh(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var c=s[o];o==="children"?typeof c=="string"?r.textContent!==c&&(s.suppressHydrationWarning!==!0&&Ql(r.textContent,c,t),i=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(s.suppressHydrationWarning!==!0&&Ql(r.textContent,c,t),i=["children",""+c]):ja.hasOwnProperty(o)&&c!=null&&o==="onScroll"&&ct("scroll",r)}switch(n){case"input":Ul(r),ey(r,s,!0);break;case"textarea":Ul(r),ny(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Hc)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Pw(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[fr]=e,t[Ha]=r,tS(t,e,!1,!1),e.stateNode=t;e:{switch(o=Bh(n,r),n){case"dialog":ct("cancel",t),ct("close",t),i=r;break;case"iframe":case"object":case"embed":ct("load",t),i=r;break;case"video":case"audio":for(i=0;i<ha.length;i++)ct(ha[i],t);i=r;break;case"source":ct("error",t),i=r;break;case"img":case"image":case"link":ct("error",t),ct("load",t),i=r;break;case"details":ct("toggle",t),i=r;break;case"input":Zg(t,r),i=Mh(t,r),ct("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=_t({},r,{value:void 0}),ct("invalid",t);break;case"textarea":ty(t,r),i=Lh(t,r),ct("invalid",t);break;default:i=r}Uh(n,i),c=i;for(s in c)if(c.hasOwnProperty(s)){var a=c[s];s==="style"?jw(t,a):s==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,a!=null&&Rw(t,a)):s==="children"?typeof a=="string"?(n!=="textarea"||a!=="")&&Ma(t,a):typeof a=="number"&&Ma(t,""+a):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(ja.hasOwnProperty(s)?a!=null&&s==="onScroll"&&ct("scroll",t):a!=null&&vm(t,s,a,o))}switch(n){case"input":Ul(t),ey(t,r,!1);break;case"textarea":Ul(t),ny(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ai(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Zs(t,!!r.multiple,s,!1):r.defaultValue!=null&&Zs(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Hc)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return on(e),null;case 6:if(t&&e.stateNode!=null)rS(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(se(166));if(n=ts(qa.current),ts(yr.current),Kl(e)){if(r=e.stateNode,n=e.memoizedProps,r[fr]=e,(s=r.nodeValue!==n)&&(t=Vn,t!==null))switch(t.tag){case 3:Ql(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ql(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[fr]=e,e.stateNode=r}return on(e),null;case 13:if(dt(gt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ft&&jn!==null&&e.mode&1&&!(e.flags&128))S0(),ho(),e.flags|=98560,s=!1;else if(s=Kl(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(se(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(se(317));s[fr]=e}else ho(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;on(e),s=!1}else Zn!==null&&(Ef(Zn),Zn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||gt.current&1?Ut===0&&(Ut=3):ep())),e.updateQueue!==null&&(e.flags|=4),on(e),null);case 4:return mo(),mf(t,e),t===null&&za(e.stateNode.containerInfo),on(e),null;case 10:return Vm(e.type._context),on(e),null;case 17:return In(e.type)&&Wc(),on(e),null;case 19:if(dt(gt),s=e.memoizedState,s===null)return on(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)ta(s,!1);else{if(Ut!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Jc(t),o!==null){for(e.flags|=128,ta(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return at(gt,gt.current&1|2),e.child}t=t.sibling}s.tail!==null&&Nt()>go&&(e.flags|=128,r=!0,ta(s,!1),e.lanes=4194304)}else{if(!r)if(t=Jc(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ta(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!ft)return on(e),null}else 2*Nt()-s.renderingStartTime>go&&n!==1073741824&&(e.flags|=128,r=!0,ta(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Nt(),e.sibling=null,n=gt.current,at(gt,r?n&1|2:n&1),e):(on(e),null);case 22:case 23:return Zm(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Dn&1073741824&&(on(e),e.subtreeFlags&6&&(e.flags|=8192)):on(e),null;case 24:return null;case 25:return null}throw Error(se(156,e.tag))}function SI(t,e){switch(Dm(e),e.tag){case 1:return In(e.type)&&Wc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return mo(),dt(xn),dt(hn),zm(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Bm(e),null;case 13:if(dt(gt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(se(340));ho()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return dt(gt),null;case 4:return mo(),null;case 10:return Vm(e.type._context),null;case 22:case 23:return Zm(),null;case 24:return null;default:return null}}var Jl=!1,cn=!1,EI=typeof WeakSet=="function"?WeakSet:Set,fe=null;function Ys(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){bt(t,e,r)}else n.current=null}function pf(t,e,n){try{n()}catch(r){bt(t,e,r)}}var Wy=!1;function TI(t,e){if(Xh=Bc,t=l0(),Pm(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,c=-1,a=-1,d=0,h=0,f=t,p=null;t:for(;;){for(var v;f!==n||i!==0&&f.nodeType!==3||(c=o+i),f!==s||r!==0&&f.nodeType!==3||(a=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(v=f.firstChild)!==null;)p=f,f=v;for(;;){if(f===t)break t;if(p===n&&++d===i&&(c=o),p===s&&++h===r&&(a=o),(v=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=v}n=c===-1||a===-1?null:{start:c,end:a}}else n=null}n=n||{start:0,end:0}}else n=null;for(Jh={focusedElem:t,selectionRange:n},Bc=!1,fe=e;fe!==null;)if(e=fe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,fe=t;else for(;fe!==null;){e=fe;try{var x=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var _=x.memoizedProps,P=x.memoizedState,y=e.stateNode,w=y.getSnapshotBeforeUpdate(e.elementType===e.type?_:Xn(e.type,_),P);y.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var T=e.stateNode.containerInfo;T.nodeType===1?T.textContent="":T.nodeType===9&&T.documentElement&&T.removeChild(T.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(se(163))}}catch(M){bt(e,e.return,M)}if(t=e.sibling,t!==null){t.return=e.return,fe=t;break}fe=e.return}return x=Wy,Wy=!1,x}function ba(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&pf(e,n,s)}i=i.next}while(i!==r)}}function Mu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function gf(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function iS(t){var e=t.alternate;e!==null&&(t.alternate=null,iS(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[fr],delete e[Ha],delete e[tf],delete e[sI],delete e[oI])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function sS(t){return t.tag===5||t.tag===3||t.tag===4}function qy(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||sS(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function yf(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Hc));else if(r!==4&&(t=t.child,t!==null))for(yf(t,e,n),t=t.sibling;t!==null;)yf(t,e,n),t=t.sibling}function vf(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(vf(t,e,n),t=t.sibling;t!==null;)vf(t,e,n),t=t.sibling}var Yt=null,Jn=!1;function Jr(t,e,n){for(n=n.child;n!==null;)oS(t,e,n),n=n.sibling}function oS(t,e,n){if(gr&&typeof gr.onCommitFiberUnmount=="function")try{gr.onCommitFiberUnmount(Cu,n)}catch{}switch(n.tag){case 5:cn||Ys(n,e);case 6:var r=Yt,i=Jn;Yt=null,Jr(t,e,n),Yt=r,Jn=i,Yt!==null&&(Jn?(t=Yt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Yt.removeChild(n.stateNode));break;case 18:Yt!==null&&(Jn?(t=Yt,n=n.stateNode,t.nodeType===8?Hd(t.parentNode,n):t.nodeType===1&&Hd(t,n),Fa(t)):Hd(Yt,n.stateNode));break;case 4:r=Yt,i=Jn,Yt=n.stateNode.containerInfo,Jn=!0,Jr(t,e,n),Yt=r,Jn=i;break;case 0:case 11:case 14:case 15:if(!cn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&pf(n,e,o),i=i.next}while(i!==r)}Jr(t,e,n);break;case 1:if(!cn&&(Ys(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){bt(n,e,c)}Jr(t,e,n);break;case 21:Jr(t,e,n);break;case 22:n.mode&1?(cn=(r=cn)||n.memoizedState!==null,Jr(t,e,n),cn=r):Jr(t,e,n);break;default:Jr(t,e,n)}}function Gy(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new EI),e.forEach(function(r){var i=RI.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Yn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,c=o;e:for(;c!==null;){switch(c.tag){case 5:Yt=c.stateNode,Jn=!1;break e;case 3:Yt=c.stateNode.containerInfo,Jn=!0;break e;case 4:Yt=c.stateNode.containerInfo,Jn=!0;break e}c=c.return}if(Yt===null)throw Error(se(160));oS(s,o,i),Yt=null,Jn=!1;var a=i.alternate;a!==null&&(a.return=null),i.return=null}catch(d){bt(i,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)aS(e,t),e=e.sibling}function aS(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Yn(e,t),cr(t),r&4){try{ba(3,t,t.return),Mu(3,t)}catch(_){bt(t,t.return,_)}try{ba(5,t,t.return)}catch(_){bt(t,t.return,_)}}break;case 1:Yn(e,t),cr(t),r&512&&n!==null&&Ys(n,n.return);break;case 5:if(Yn(e,t),cr(t),r&512&&n!==null&&Ys(n,n.return),t.flags&32){var i=t.stateNode;try{Ma(i,"")}catch(_){bt(t,t.return,_)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,c=t.type,a=t.updateQueue;if(t.updateQueue=null,a!==null)try{c==="input"&&s.type==="radio"&&s.name!=null&&Nw(i,s),Bh(c,o);var d=Bh(c,s);for(o=0;o<a.length;o+=2){var h=a[o],f=a[o+1];h==="style"?jw(i,f):h==="dangerouslySetInnerHTML"?Rw(i,f):h==="children"?Ma(i,f):vm(i,h,f,d)}switch(c){case"input":Oh(i,s);break;case"textarea":kw(i,s);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var v=s.value;v!=null?Zs(i,!!s.multiple,v,!1):p!==!!s.multiple&&(s.defaultValue!=null?Zs(i,!!s.multiple,s.defaultValue,!0):Zs(i,!!s.multiple,s.multiple?[]:"",!1))}i[Ha]=s}catch(_){bt(t,t.return,_)}}break;case 6:if(Yn(e,t),cr(t),r&4){if(t.stateNode===null)throw Error(se(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(_){bt(t,t.return,_)}}break;case 3:if(Yn(e,t),cr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Fa(e.containerInfo)}catch(_){bt(t,t.return,_)}break;case 4:Yn(e,t),cr(t);break;case 13:Yn(e,t),cr(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Xm=Nt())),r&4&&Gy(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(cn=(d=cn)||h,Yn(e,t),cn=d):Yn(e,t),cr(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(fe=t,h=t.child;h!==null;){for(f=fe=h;fe!==null;){switch(p=fe,v=p.child,p.tag){case 0:case 11:case 14:case 15:ba(4,p,p.return);break;case 1:Ys(p,p.return);var x=p.stateNode;if(typeof x.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,x.props=e.memoizedProps,x.state=e.memoizedState,x.componentWillUnmount()}catch(_){bt(r,n,_)}}break;case 5:Ys(p,p.return);break;case 22:if(p.memoizedState!==null){Ky(f);continue}}v!==null?(v.return=p,fe=v):Ky(f)}h=h.sibling}e:for(h=null,f=t;;){if(f.tag===5){if(h===null){h=f;try{i=f.stateNode,d?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(c=f.stateNode,a=f.memoizedProps.style,o=a!=null&&a.hasOwnProperty("display")?a.display:null,c.style.display=Dw("display",o))}catch(_){bt(t,t.return,_)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(_){bt(t,t.return,_)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Yn(e,t),cr(t),r&4&&Gy(t);break;case 21:break;default:Yn(e,t),cr(t)}}function cr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(sS(n)){var r=n;break e}n=n.return}throw Error(se(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Ma(i,""),r.flags&=-33);var s=qy(t);vf(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,c=qy(t);yf(t,c,o);break;default:throw Error(se(161))}}catch(a){bt(t,t.return,a)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function bI(t,e,n){fe=t,lS(t)}function lS(t,e,n){for(var r=(t.mode&1)!==0;fe!==null;){var i=fe,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Jl;if(!o){var c=i.alternate,a=c!==null&&c.memoizedState!==null||cn;c=Jl;var d=cn;if(Jl=o,(cn=a)&&!d)for(fe=i;fe!==null;)o=fe,a=o.child,o.tag===22&&o.memoizedState!==null?Yy(i):a!==null?(a.return=o,fe=a):Yy(i);for(;s!==null;)fe=s,lS(s),s=s.sibling;fe=i,Jl=c,cn=d}Qy(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,fe=s):Qy(t)}}function Qy(t){for(;fe!==null;){var e=fe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:cn||Mu(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!cn)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Xn(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Ry(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Ry(e,o,n)}break;case 5:var c=e.stateNode;if(n===null&&e.flags&4){n=c;var a=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":a.autoFocus&&n.focus();break;case"img":a.src&&(n.src=a.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&Fa(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(se(163))}cn||e.flags&512&&gf(e)}catch(p){bt(e,e.return,p)}}if(e===t){fe=null;break}if(n=e.sibling,n!==null){n.return=e.return,fe=n;break}fe=e.return}}function Ky(t){for(;fe!==null;){var e=fe;if(e===t){fe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,fe=n;break}fe=e.return}}function Yy(t){for(;fe!==null;){var e=fe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Mu(4,e)}catch(a){bt(e,n,a)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(a){bt(e,i,a)}}var s=e.return;try{gf(e)}catch(a){bt(e,s,a)}break;case 5:var o=e.return;try{gf(e)}catch(a){bt(e,o,a)}}}catch(a){bt(e,e.return,a)}if(e===t){fe=null;break}var c=e.sibling;if(c!==null){c.return=e.return,fe=c;break}fe=e.return}}var xI=Math.ceil,tu=Hr.ReactCurrentDispatcher,Km=Hr.ReactCurrentOwner,qn=Hr.ReactCurrentBatchConfig,qe=0,Gt=null,jt=null,Zt=0,Dn=0,Xs=Fi(0),Ut=0,Ya=null,us=0,Ou=0,Ym=0,xa=null,En=null,Xm=0,go=1/0,kr=null,nu=!1,_f=null,_i=null,Zl=!1,ui=null,ru=0,Ia=0,wf=null,Ic=-1,Cc=0;function gn(){return qe&6?Nt():Ic!==-1?Ic:Ic=Nt()}function wi(t){return t.mode&1?qe&2&&Zt!==0?Zt&-Zt:lI.transition!==null?(Cc===0&&(Cc=qw()),Cc):(t=Ze,t!==0||(t=window.event,t=t===void 0?16:Zw(t.type)),t):1}function tr(t,e,n,r){if(50<Ia)throw Ia=0,wf=null,Error(se(185));fl(t,n,r),(!(qe&2)||t!==Gt)&&(t===Gt&&(!(qe&2)&&(Ou|=n),Ut===4&&si(t,Zt)),Cn(t,r),n===1&&qe===0&&!(e.mode&1)&&(go=Nt()+500,Ru&&Ui()))}function Cn(t,e){var n=t.callbackNode;lx(t,e);var r=Uc(t,t===Gt?Zt:0);if(r===0)n!==null&&sy(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&sy(n),e===1)t.tag===0?aI(Xy.bind(null,t)):v0(Xy.bind(null,t)),rI(function(){!(qe&6)&&Ui()}),n=null;else{switch(Gw(r)){case 1:n=Tm;break;case 4:n=Hw;break;case 16:n=Fc;break;case 536870912:n=Ww;break;default:n=Fc}n=gS(n,cS.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function cS(t,e){if(Ic=-1,Cc=0,qe&6)throw Error(se(327));var n=t.callbackNode;if(io()&&t.callbackNode!==n)return null;var r=Uc(t,t===Gt?Zt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=iu(t,r);else{e=r;var i=qe;qe|=2;var s=dS();(Gt!==t||Zt!==e)&&(kr=null,go=Nt()+500,rs(t,e));do try{AI();break}catch(c){uS(t,c)}while(!0);Om(),tu.current=s,qe=i,jt!==null?e=0:(Gt=null,Zt=0,e=Ut)}if(e!==0){if(e===2&&(i=qh(t),i!==0&&(r=i,e=Sf(t,i))),e===1)throw n=Ya,rs(t,0),si(t,r),Cn(t,Nt()),n;if(e===6)si(t,r);else{if(i=t.current.alternate,!(r&30)&&!II(i)&&(e=iu(t,r),e===2&&(s=qh(t),s!==0&&(r=s,e=Sf(t,s))),e===1))throw n=Ya,rs(t,0),si(t,r),Cn(t,Nt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(se(345));case 2:Yi(t,En,kr);break;case 3:if(si(t,r),(r&130023424)===r&&(e=Xm+500-Nt(),10<e)){if(Uc(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){gn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=ef(Yi.bind(null,t,En,kr),e);break}Yi(t,En,kr);break;case 4:if(si(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-er(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=Nt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*xI(r/1960))-r,10<r){t.timeoutHandle=ef(Yi.bind(null,t,En,kr),r);break}Yi(t,En,kr);break;case 5:Yi(t,En,kr);break;default:throw Error(se(329))}}}return Cn(t,Nt()),t.callbackNode===n?cS.bind(null,t):null}function Sf(t,e){var n=xa;return t.current.memoizedState.isDehydrated&&(rs(t,e).flags|=256),t=iu(t,e),t!==2&&(e=En,En=n,e!==null&&Ef(e)),t}function Ef(t){En===null?En=t:En.push.apply(En,t)}function II(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!rr(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function si(t,e){for(e&=~Ym,e&=~Ou,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-er(e),r=1<<n;t[n]=-1,e&=~r}}function Xy(t){if(qe&6)throw Error(se(327));io();var e=Uc(t,0);if(!(e&1))return Cn(t,Nt()),null;var n=iu(t,e);if(t.tag!==0&&n===2){var r=qh(t);r!==0&&(e=r,n=Sf(t,r))}if(n===1)throw n=Ya,rs(t,0),si(t,e),Cn(t,Nt()),n;if(n===6)throw Error(se(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Yi(t,En,kr),Cn(t,Nt()),null}function Jm(t,e){var n=qe;qe|=1;try{return t(e)}finally{qe=n,qe===0&&(go=Nt()+500,Ru&&Ui())}}function ds(t){ui!==null&&ui.tag===0&&!(qe&6)&&io();var e=qe;qe|=1;var n=qn.transition,r=Ze;try{if(qn.transition=null,Ze=1,t)return t()}finally{Ze=r,qn.transition=n,qe=e,!(qe&6)&&Ui()}}function Zm(){Dn=Xs.current,dt(Xs)}function rs(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,nI(n)),jt!==null)for(n=jt.return;n!==null;){var r=n;switch(Dm(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Wc();break;case 3:mo(),dt(xn),dt(hn),zm();break;case 5:Bm(r);break;case 4:mo();break;case 13:dt(gt);break;case 19:dt(gt);break;case 10:Vm(r.type._context);break;case 22:case 23:Zm()}n=n.return}if(Gt=t,jt=t=Si(t.current,null),Zt=Dn=e,Ut=0,Ya=null,Ym=Ou=us=0,En=xa=null,es!==null){for(e=0;e<es.length;e++)if(n=es[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}es=null}return t}function uS(t,e){do{var n=jt;try{if(Om(),Tc.current=eu,Zc){for(var r=yt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Zc=!1}if(cs=0,Wt=Ft=yt=null,Ta=!1,Ga=0,Km.current=null,n===null||n.return===null){Ut=1,Ya=e,jt=null;break}e:{var s=t,o=n.return,c=n,a=e;if(e=Zt,c.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){var d=a,h=c,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var v=Ly(o);if(v!==null){v.flags&=-257,Fy(v,o,c,s,e),v.mode&1&&Vy(s,d,e),e=v,a=d;var x=e.updateQueue;if(x===null){var _=new Set;_.add(a),e.updateQueue=_}else x.add(a);break e}else{if(!(e&1)){Vy(s,d,e),ep();break e}a=Error(se(426))}}else if(ft&&c.mode&1){var P=Ly(o);if(P!==null){!(P.flags&65536)&&(P.flags|=256),Fy(P,o,c,s,e),jm(po(a,c));break e}}s=a=po(a,c),Ut!==4&&(Ut=2),xa===null?xa=[s]:xa.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var y=G0(s,a,e);Py(s,y);break e;case 1:c=a;var w=s.type,T=s.stateNode;if(!(s.flags&128)&&(typeof w.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(_i===null||!_i.has(T)))){s.flags|=65536,e&=-e,s.lanes|=e;var M=Q0(s,c,e);Py(s,M);break e}}s=s.return}while(s!==null)}fS(n)}catch(L){e=L,jt===n&&n!==null&&(jt=n=n.return);continue}break}while(!0)}function dS(){var t=tu.current;return tu.current=eu,t===null?eu:t}function ep(){(Ut===0||Ut===3||Ut===2)&&(Ut=4),Gt===null||!(us&268435455)&&!(Ou&268435455)||si(Gt,Zt)}function iu(t,e){var n=qe;qe|=2;var r=dS();(Gt!==t||Zt!==e)&&(kr=null,rs(t,e));do try{CI();break}catch(i){uS(t,i)}while(!0);if(Om(),qe=n,tu.current=r,jt!==null)throw Error(se(261));return Gt=null,Zt=0,Ut}function CI(){for(;jt!==null;)hS(jt)}function AI(){for(;jt!==null&&!Zb();)hS(jt)}function hS(t){var e=pS(t.alternate,t,Dn);t.memoizedProps=t.pendingProps,e===null?fS(t):jt=e,Km.current=null}function fS(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=SI(n,e),n!==null){n.flags&=32767,jt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ut=6,jt=null;return}}else if(n=wI(n,e,Dn),n!==null){jt=n;return}if(e=e.sibling,e!==null){jt=e;return}jt=e=t}while(e!==null);Ut===0&&(Ut=5)}function Yi(t,e,n){var r=Ze,i=qn.transition;try{qn.transition=null,Ze=1,NI(t,e,n,r)}finally{qn.transition=i,Ze=r}return null}function NI(t,e,n,r){do io();while(ui!==null);if(qe&6)throw Error(se(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(se(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(cx(t,s),t===Gt&&(jt=Gt=null,Zt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Zl||(Zl=!0,gS(Fc,function(){return io(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=qn.transition,qn.transition=null;var o=Ze;Ze=1;var c=qe;qe|=4,Km.current=null,TI(t,n),aS(n,t),Kx(Jh),Bc=!!Xh,Jh=Xh=null,t.current=n,bI(n),ex(),qe=c,Ze=o,qn.transition=s}else t.current=n;if(Zl&&(Zl=!1,ui=t,ru=i),s=t.pendingLanes,s===0&&(_i=null),rx(n.stateNode),Cn(t,Nt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(nu)throw nu=!1,t=_f,_f=null,t;return ru&1&&t.tag!==0&&io(),s=t.pendingLanes,s&1?t===wf?Ia++:(Ia=0,wf=t):Ia=0,Ui(),null}function io(){if(ui!==null){var t=Gw(ru),e=qn.transition,n=Ze;try{if(qn.transition=null,Ze=16>t?16:t,ui===null)var r=!1;else{if(t=ui,ui=null,ru=0,qe&6)throw Error(se(331));var i=qe;for(qe|=4,fe=t.current;fe!==null;){var s=fe,o=s.child;if(fe.flags&16){var c=s.deletions;if(c!==null){for(var a=0;a<c.length;a++){var d=c[a];for(fe=d;fe!==null;){var h=fe;switch(h.tag){case 0:case 11:case 15:ba(8,h,s)}var f=h.child;if(f!==null)f.return=h,fe=f;else for(;fe!==null;){h=fe;var p=h.sibling,v=h.return;if(iS(h),h===d){fe=null;break}if(p!==null){p.return=v,fe=p;break}fe=v}}}var x=s.alternate;if(x!==null){var _=x.child;if(_!==null){x.child=null;do{var P=_.sibling;_.sibling=null,_=P}while(_!==null)}}fe=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,fe=o;else e:for(;fe!==null;){if(s=fe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:ba(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,fe=y;break e}fe=s.return}}var w=t.current;for(fe=w;fe!==null;){o=fe;var T=o.child;if(o.subtreeFlags&2064&&T!==null)T.return=o,fe=T;else e:for(o=w;fe!==null;){if(c=fe,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:Mu(9,c)}}catch(L){bt(c,c.return,L)}if(c===o){fe=null;break e}var M=c.sibling;if(M!==null){M.return=c.return,fe=M;break e}fe=c.return}}if(qe=i,Ui(),gr&&typeof gr.onPostCommitFiberRoot=="function")try{gr.onPostCommitFiberRoot(Cu,t)}catch{}r=!0}return r}finally{Ze=n,qn.transition=e}}return!1}function Jy(t,e,n){e=po(n,e),e=G0(t,e,1),t=vi(t,e,1),e=gn(),t!==null&&(fl(t,1,e),Cn(t,e))}function bt(t,e,n){if(t.tag===3)Jy(t,t,n);else for(;e!==null;){if(e.tag===3){Jy(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(_i===null||!_i.has(r))){t=po(n,t),t=Q0(e,t,1),e=vi(e,t,1),t=gn(),e!==null&&(fl(e,1,t),Cn(e,t));break}}e=e.return}}function kI(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=gn(),t.pingedLanes|=t.suspendedLanes&n,Gt===t&&(Zt&n)===n&&(Ut===4||Ut===3&&(Zt&130023424)===Zt&&500>Nt()-Xm?rs(t,0):Ym|=n),Cn(t,e)}function mS(t,e){e===0&&(t.mode&1?(e=$l,$l<<=1,!($l&130023424)&&($l=4194304)):e=1);var n=gn();t=Fr(t,e),t!==null&&(fl(t,e,n),Cn(t,n))}function PI(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),mS(t,n)}function RI(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(se(314))}r!==null&&r.delete(e),mS(t,n)}var pS;pS=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||xn.current)bn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return bn=!1,_I(t,e,n);bn=!!(t.flags&131072)}else bn=!1,ft&&e.flags&1048576&&_0(e,Qc,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;xc(t,e),t=e.pendingProps;var i=uo(e,hn.current);ro(e,n),i=Hm(null,e,r,t,i,n);var s=Wm();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,In(r)?(s=!0,qc(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Fm(e),i.updater=ju,e.stateNode=i,i._reactInternals=e,lf(e,r,t,n),e=df(null,e,r,!0,s,n)):(e.tag=0,ft&&s&&Rm(e),pn(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(xc(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=jI(r),t=Xn(r,t),i){case 0:e=uf(null,e,r,t,n);break e;case 1:e=zy(null,e,r,t,n);break e;case 11:e=Uy(null,e,r,t,n);break e;case 14:e=By(null,e,r,Xn(r.type,t),n);break e}throw Error(se(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Xn(r,i),uf(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Xn(r,i),zy(t,e,r,i,n);case 3:e:{if(J0(e),t===null)throw Error(se(387));r=e.pendingProps,s=e.memoizedState,i=s.element,x0(t,e),Xc(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=po(Error(se(423)),e),e=$y(t,e,r,n,i);break e}else if(r!==i){i=po(Error(se(424)),e),e=$y(t,e,r,n,i);break e}else for(jn=yi(e.stateNode.containerInfo.firstChild),Vn=e,ft=!0,Zn=null,n=T0(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ho(),r===i){e=Ur(t,e,n);break e}pn(t,e,r,n)}e=e.child}return e;case 5:return I0(e),t===null&&sf(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Zh(r,i)?o=null:s!==null&&Zh(r,s)&&(e.flags|=32),X0(t,e),pn(t,e,o,n),e.child;case 6:return t===null&&sf(e),null;case 13:return Z0(t,e,n);case 4:return Um(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=fo(e,null,r,n):pn(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Xn(r,i),Uy(t,e,r,i,n);case 7:return pn(t,e,e.pendingProps,n),e.child;case 8:return pn(t,e,e.pendingProps.children,n),e.child;case 12:return pn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,at(Kc,r._currentValue),r._currentValue=o,s!==null)if(rr(s.value,o)){if(s.children===i.children&&!xn.current){e=Ur(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var c=s.dependencies;if(c!==null){o=s.child;for(var a=c.firstContext;a!==null;){if(a.context===r){if(s.tag===1){a=Mr(-1,n&-n),a.tag=2;var d=s.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?a.next=a:(a.next=h.next,h.next=a),d.pending=a}}s.lanes|=n,a=s.alternate,a!==null&&(a.lanes|=n),of(s.return,n,e),c.lanes|=n;break}a=a.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(se(341));o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),of(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}pn(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,ro(e,n),i=Gn(i),r=r(i),e.flags|=1,pn(t,e,r,n),e.child;case 14:return r=e.type,i=Xn(r,e.pendingProps),i=Xn(r.type,i),By(t,e,r,i,n);case 15:return K0(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Xn(r,i),xc(t,e),e.tag=1,In(r)?(t=!0,qc(e)):t=!1,ro(e,n),q0(e,r,i),lf(e,r,i,n),df(null,e,r,!0,t,n);case 19:return eS(t,e,n);case 22:return Y0(t,e,n)}throw Error(se(156,e.tag))};function gS(t,e){return $w(t,e)}function DI(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Wn(t,e,n,r){return new DI(t,e,n,r)}function tp(t){return t=t.prototype,!(!t||!t.isReactComponent)}function jI(t){if(typeof t=="function")return tp(t)?1:0;if(t!=null){if(t=t.$$typeof,t===wm)return 11;if(t===Sm)return 14}return 2}function Si(t,e){var n=t.alternate;return n===null?(n=Wn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ac(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")tp(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Bs:return is(n.children,i,s,e);case _m:o=8,i|=8;break;case Ph:return t=Wn(12,n,e,i|2),t.elementType=Ph,t.lanes=s,t;case Rh:return t=Wn(13,n,e,i),t.elementType=Rh,t.lanes=s,t;case Dh:return t=Wn(19,n,e,i),t.elementType=Dh,t.lanes=s,t;case Iw:return Vu(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case bw:o=10;break e;case xw:o=9;break e;case wm:o=11;break e;case Sm:o=14;break e;case ni:o=16,r=null;break e}throw Error(se(130,t==null?t:typeof t,""))}return e=Wn(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function is(t,e,n,r){return t=Wn(7,t,r,e),t.lanes=n,t}function Vu(t,e,n,r){return t=Wn(22,t,r,e),t.elementType=Iw,t.lanes=n,t.stateNode={isHidden:!1},t}function Jd(t,e,n){return t=Wn(6,t,null,e),t.lanes=n,t}function Zd(t,e,n){return e=Wn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function MI(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Dd(0),this.expirationTimes=Dd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Dd(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function np(t,e,n,r,i,s,o,c,a){return t=new MI(t,e,n,c,a),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Wn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fm(s),t}function OI(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Us,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function yS(t){if(!t)return Ni;t=t._reactInternals;e:{if(_s(t)!==t||t.tag!==1)throw Error(se(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(In(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(se(171))}if(t.tag===1){var n=t.type;if(In(n))return y0(t,n,e)}return e}function vS(t,e,n,r,i,s,o,c,a){return t=np(n,r,!0,t,i,s,o,c,a),t.context=yS(null),n=t.current,r=gn(),i=wi(n),s=Mr(r,i),s.callback=e??null,vi(n,s,i),t.current.lanes=i,fl(t,i,r),Cn(t,r),t}function Lu(t,e,n,r){var i=e.current,s=gn(),o=wi(i);return n=yS(n),e.context===null?e.context=n:e.pendingContext=n,e=Mr(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=vi(i,e,o),t!==null&&(tr(t,i,o,s),Ec(t,i,o)),o}function su(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Zy(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function rp(t,e){Zy(t,e),(t=t.alternate)&&Zy(t,e)}function VI(){return null}var _S=typeof reportError=="function"?reportError:function(t){console.error(t)};function ip(t){this._internalRoot=t}Fu.prototype.render=ip.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(se(409));Lu(t,e,null,null)};Fu.prototype.unmount=ip.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ds(function(){Lu(null,t,null,null)}),e[Lr]=null}};function Fu(t){this._internalRoot=t}Fu.prototype.unstable_scheduleHydration=function(t){if(t){var e=Yw();t={blockedOn:null,target:t,priority:e};for(var n=0;n<ii.length&&e!==0&&e<ii[n].priority;n++);ii.splice(n,0,t),n===0&&Jw(t)}};function sp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Uu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function ev(){}function LI(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var d=su(o);s.call(d)}}var o=vS(e,r,t,0,null,!1,!1,"",ev);return t._reactRootContainer=o,t[Lr]=o.current,za(t.nodeType===8?t.parentNode:t),ds(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var c=r;r=function(){var d=su(a);c.call(d)}}var a=np(t,0,!1,null,null,!1,!1,"",ev);return t._reactRootContainer=a,t[Lr]=a.current,za(t.nodeType===8?t.parentNode:t),ds(function(){Lu(e,a,n,r)}),a}function Bu(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var c=i;i=function(){var a=su(o);c.call(a)}}Lu(e,o,t,i)}else o=LI(n,e,t,i,r);return su(o)}Qw=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=da(e.pendingLanes);n!==0&&(bm(e,n|1),Cn(e,Nt()),!(qe&6)&&(go=Nt()+500,Ui()))}break;case 13:ds(function(){var r=Fr(t,1);if(r!==null){var i=gn();tr(r,t,1,i)}}),rp(t,1)}};xm=function(t){if(t.tag===13){var e=Fr(t,134217728);if(e!==null){var n=gn();tr(e,t,134217728,n)}rp(t,134217728)}};Kw=function(t){if(t.tag===13){var e=wi(t),n=Fr(t,e);if(n!==null){var r=gn();tr(n,t,e,r)}rp(t,e)}};Yw=function(){return Ze};Xw=function(t,e){var n=Ze;try{return Ze=t,e()}finally{Ze=n}};$h=function(t,e,n){switch(e){case"input":if(Oh(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Pu(r);if(!i)throw Error(se(90));Aw(r),Oh(r,i)}}}break;case"textarea":kw(t,n);break;case"select":e=n.value,e!=null&&Zs(t,!!n.multiple,e,!1)}};Vw=Jm;Lw=ds;var FI={usingClientEntryPoint:!1,Events:[pl,Ws,Pu,Mw,Ow,Jm]},na={findFiberByHostInstance:Zi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},UI={bundleType:na.bundleType,version:na.version,rendererPackageName:na.rendererPackageName,rendererConfig:na.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Hr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Bw(t),t===null?null:t.stateNode},findFiberByHostInstance:na.findFiberByHostInstance||VI,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ec=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ec.isDisabled&&ec.supportsFiber)try{Cu=ec.inject(UI),gr=ec}catch{}}Fn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=FI;Fn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!sp(e))throw Error(se(200));return OI(t,e,null,n)};Fn.createRoot=function(t,e){if(!sp(t))throw Error(se(299));var n=!1,r="",i=_S;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=np(t,1,!1,null,null,n,!1,r,i),t[Lr]=e.current,za(t.nodeType===8?t.parentNode:t),new ip(e)};Fn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(se(188)):(t=Object.keys(t).join(","),Error(se(268,t)));return t=Bw(e),t=t===null?null:t.stateNode,t};Fn.flushSync=function(t){return ds(t)};Fn.hydrate=function(t,e,n){if(!Uu(e))throw Error(se(200));return Bu(null,t,e,!0,n)};Fn.hydrateRoot=function(t,e,n){if(!sp(t))throw Error(se(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=_S;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=vS(e,null,t,1,n??null,i,!1,s,o),t[Lr]=e.current,za(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Fu(e)};Fn.render=function(t,e,n){if(!Uu(e))throw Error(se(200));return Bu(null,t,e,!1,n)};Fn.unmountComponentAtNode=function(t){if(!Uu(t))throw Error(se(40));return t._reactRootContainer?(ds(function(){Bu(null,null,t,!1,function(){t._reactRootContainer=null,t[Lr]=null})}),!0):!1};Fn.unstable_batchedUpdates=Jm;Fn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Uu(n))throw Error(se(200));if(t==null||t._reactInternals===void 0)throw Error(se(38));return Bu(t,e,n,!1,r)};Fn.version="18.3.1-next-f1338f8080-20240426";function wS(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(wS)}catch(t){console.error(t)}}wS(),ww.exports=Fn;var SS=ww.exports,tv=SS;Nh.createRoot=tv.createRoot,Nh.hydrateRoot=tv.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Xa(){return Xa=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Xa.apply(this,arguments)}var di;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(di||(di={}));const nv="popstate";function BI(t){t===void 0&&(t={});function e(i,s){let{pathname:o="/",search:c="",hash:a=""}=ws(i.location.hash.substr(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),Tf("",{pathname:o,search:c,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(i,s){let o=i.document.querySelector("base"),c="";if(o&&o.getAttribute("href")){let a=i.location.href,d=a.indexOf("#");c=d===-1?a:a.slice(0,d)}return c+"#"+(typeof s=="string"?s:ou(s))}function r(i,s){op(i.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(s)+")")}return $I(e,n,r,t)}function vt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function op(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function zI(){return Math.random().toString(36).substr(2,8)}function rv(t,e){return{usr:t.state,key:t.key,idx:e}}function Tf(t,e,n,r){return n===void 0&&(n=null),Xa({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?ws(e):e,{state:n,key:e&&e.key||r||zI()})}function ou(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function ws(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function $I(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,o=i.history,c=di.Pop,a=null,d=h();d==null&&(d=0,o.replaceState(Xa({},o.state,{idx:d}),""));function h(){return(o.state||{idx:null}).idx}function f(){c=di.Pop;let P=h(),y=P==null?null:P-d;d=P,a&&a({action:c,location:_.location,delta:y})}function p(P,y){c=di.Push;let w=Tf(_.location,P,y);n&&n(w,P),d=h()+1;let T=rv(w,d),M=_.createHref(w);try{o.pushState(T,"",M)}catch(L){if(L instanceof DOMException&&L.name==="DataCloneError")throw L;i.location.assign(M)}s&&a&&a({action:c,location:_.location,delta:1})}function v(P,y){c=di.Replace;let w=Tf(_.location,P,y);n&&n(w,P),d=h();let T=rv(w,d),M=_.createHref(w);o.replaceState(T,"",M),s&&a&&a({action:c,location:_.location,delta:0})}function x(P){let y=i.location.origin!=="null"?i.location.origin:i.location.href,w=typeof P=="string"?P:ou(P);return w=w.replace(/ $/,"%20"),vt(y,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,y)}let _={get action(){return c},get location(){return t(i,o)},listen(P){if(a)throw new Error("A history only accepts one active listener");return i.addEventListener(nv,f),a=P,()=>{i.removeEventListener(nv,f),a=null}},createHref(P){return e(i,P)},createURL:x,encodeLocation(P){let y=x(P);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:p,replace:v,go(P){return o.go(P)}};return _}var iv;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(iv||(iv={}));function HI(t,e,n){return n===void 0&&(n="/"),WI(t,e,n)}function WI(t,e,n,r){let i=typeof e=="string"?ws(e):e,s=yo(i.pathname||"/",n);if(s==null)return null;let o=ES(t);qI(o);let c=null;for(let a=0;c==null&&a<o.length;++a){let d=rC(s);c=tC(o[a],d)}return c}function ES(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(s,o,c)=>{let a={relativePath:c===void 0?s.path||"":c,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};a.relativePath.startsWith("/")&&(vt(a.relativePath.startsWith(r),'Absolute route path "'+a.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),a.relativePath=a.relativePath.slice(r.length));let d=Ei([r,a.relativePath]),h=n.concat(a);s.children&&s.children.length>0&&(vt(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),ES(s.children,e,h,d)),!(s.path==null&&!s.index)&&e.push({path:d,score:ZI(d,s.index),routesMeta:h})};return t.forEach((s,o)=>{var c;if(s.path===""||!((c=s.path)!=null&&c.includes("?")))i(s,o);else for(let a of TS(s.path))i(s,o,a)}),e}function TS(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let o=TS(r.join("/")),c=[];return c.push(...o.map(a=>a===""?s:[s,a].join("/"))),i&&c.push(...o),c.map(a=>t.startsWith("/")&&a===""?"/":a)}function qI(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:eC(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const GI=/^:[\w-]+$/,QI=3,KI=2,YI=1,XI=10,JI=-2,sv=t=>t==="*";function ZI(t,e){let n=t.split("/"),r=n.length;return n.some(sv)&&(r+=JI),e&&(r+=KI),n.filter(i=>!sv(i)).reduce((i,s)=>i+(GI.test(s)?QI:s===""?YI:XI),r)}function eC(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function tC(t,e,n){let{routesMeta:r}=t,i={},s="/",o=[];for(let c=0;c<r.length;++c){let a=r[c],d=c===r.length-1,h=s==="/"?e:e.slice(s.length)||"/",f=bf({path:a.relativePath,caseSensitive:a.caseSensitive,end:d},h),p=a.route;if(!f)return null;Object.assign(i,f.params),o.push({params:i,pathname:Ei([s,f.pathname]),pathnameBase:aC(Ei([s,f.pathnameBase])),route:p}),f.pathnameBase!=="/"&&(s=Ei([s,f.pathnameBase]))}return o}function bf(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=nC(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),c=i.slice(1);return{params:r.reduce((d,h,f)=>{let{paramName:p,isOptional:v}=h;if(p==="*"){let _=c[f]||"";o=s.slice(0,s.length-_.length).replace(/(.)\/+$/,"$1")}const x=c[f];return v&&!x?d[p]=void 0:d[p]=(x||"").replace(/%2F/g,"/"),d},{}),pathname:s,pathnameBase:o,pattern:t}}function nC(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),op(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,a)=>(r.push({paramName:c,isOptional:a!=null}),a?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function rC(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return op(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function yo(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function iC(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?ws(t):t;return{pathname:n?n.startsWith("/")?n:sC(n,e):e,search:lC(r),hash:cC(i)}}function sC(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function eh(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function oC(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function ap(t,e){let n=oC(t);return e?n.map((r,i)=>i===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function lp(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=ws(t):(i=Xa({},t),vt(!i.pathname||!i.pathname.includes("?"),eh("?","pathname","search",i)),vt(!i.pathname||!i.pathname.includes("#"),eh("#","pathname","hash",i)),vt(!i.search||!i.search.includes("#"),eh("#","search","hash",i)));let s=t===""||i.pathname==="",o=s?"/":i.pathname,c;if(o==null)c=n;else{let f=e.length-1;if(!r&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),f-=1;i.pathname=p.join("/")}c=f>=0?e[f]:"/"}let a=iC(i,c),d=o&&o!=="/"&&o.endsWith("/"),h=(s||o===".")&&n.endsWith("/");return!a.pathname.endsWith("/")&&(d||h)&&(a.pathname+="/"),a}const Ei=t=>t.join("/").replace(/\/\/+/g,"/"),aC=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),lC=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,cC=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function uC(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const bS=["post","put","patch","delete"];new Set(bS);const dC=["get",...bS];new Set(dC);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ja(){return Ja=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ja.apply(this,arguments)}const zu=N.createContext(null),xS=N.createContext(null),Wr=N.createContext(null),$u=N.createContext(null),qr=N.createContext({outlet:null,matches:[],isDataRoute:!1}),IS=N.createContext(null);function hC(t,e){let{relative:n}=e===void 0?{}:e;ko()||vt(!1);let{basename:r,navigator:i}=N.useContext(Wr),{hash:s,pathname:o,search:c}=Hu(t,{relative:n}),a=o;return r!=="/"&&(a=o==="/"?r:Ei([r,o])),i.createHref({pathname:a,search:c,hash:s})}function ko(){return N.useContext($u)!=null}function Ss(){return ko()||vt(!1),N.useContext($u).location}function CS(t){N.useContext(Wr).static||N.useLayoutEffect(t)}function Po(){let{isDataRoute:t}=N.useContext(qr);return t?IC():fC()}function fC(){ko()||vt(!1);let t=N.useContext(zu),{basename:e,future:n,navigator:r}=N.useContext(Wr),{matches:i}=N.useContext(qr),{pathname:s}=Ss(),o=JSON.stringify(ap(i,n.v7_relativeSplatPath)),c=N.useRef(!1);return CS(()=>{c.current=!0}),N.useCallback(function(d,h){if(h===void 0&&(h={}),!c.current)return;if(typeof d=="number"){r.go(d);return}let f=lp(d,JSON.parse(o),s,h.relative==="path");t==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:Ei([e,f.pathname])),(h.replace?r.replace:r.push)(f,h.state,h)},[e,r,o,s,t])}function mC(){let{matches:t}=N.useContext(qr),e=t[t.length-1];return e?e.params:{}}function Hu(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=N.useContext(Wr),{matches:i}=N.useContext(qr),{pathname:s}=Ss(),o=JSON.stringify(ap(i,r.v7_relativeSplatPath));return N.useMemo(()=>lp(t,JSON.parse(o),s,n==="path"),[t,o,s,n])}function pC(t,e){return gC(t,e)}function gC(t,e,n,r){ko()||vt(!1);let{navigator:i}=N.useContext(Wr),{matches:s}=N.useContext(qr),o=s[s.length-1],c=o?o.params:{};o&&o.pathname;let a=o?o.pathnameBase:"/";o&&o.route;let d=Ss(),h;if(e){var f;let P=typeof e=="string"?ws(e):e;a==="/"||(f=P.pathname)!=null&&f.startsWith(a)||vt(!1),h=P}else h=d;let p=h.pathname||"/",v=p;if(a!=="/"){let P=a.replace(/^\//,"").split("/");v="/"+p.replace(/^\//,"").split("/").slice(P.length).join("/")}let x=HI(t,{pathname:v}),_=SC(x&&x.map(P=>Object.assign({},P,{params:Object.assign({},c,P.params),pathname:Ei([a,i.encodeLocation?i.encodeLocation(P.pathname).pathname:P.pathname]),pathnameBase:P.pathnameBase==="/"?a:Ei([a,i.encodeLocation?i.encodeLocation(P.pathnameBase).pathname:P.pathnameBase])})),s,n,r);return e&&_?N.createElement($u.Provider,{value:{location:Ja({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:di.Pop}},_):_}function yC(){let t=xC(),e=uC(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return N.createElement(N.Fragment,null,N.createElement("h2",null,"Unexpected Application Error!"),N.createElement("h3",{style:{fontStyle:"italic"}},e),n?N.createElement("pre",{style:i},n):null,null)}const vC=N.createElement(yC,null);class _C extends N.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?N.createElement(qr.Provider,{value:this.props.routeContext},N.createElement(IS.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function wC(t){let{routeContext:e,match:n,children:r}=t,i=N.useContext(zu);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),N.createElement(qr.Provider,{value:e},r)}function SC(t,e,n,r){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var s;if(!n)return null;if(n.errors)t=n.matches;else if((s=r)!=null&&s.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,c=(i=n)==null?void 0:i.errors;if(c!=null){let h=o.findIndex(f=>f.route.id&&(c==null?void 0:c[f.route.id])!==void 0);h>=0||vt(!1),o=o.slice(0,Math.min(o.length,h+1))}let a=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let h=0;h<o.length;h++){let f=o[h];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(d=h),f.route.id){let{loaderData:p,errors:v}=n,x=f.route.loader&&p[f.route.id]===void 0&&(!v||v[f.route.id]===void 0);if(f.route.lazy||x){a=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((h,f,p)=>{let v,x=!1,_=null,P=null;n&&(v=c&&f.route.id?c[f.route.id]:void 0,_=f.route.errorElement||vC,a&&(d<0&&p===0?(CC("route-fallback"),x=!0,P=null):d===p&&(x=!0,P=f.route.hydrateFallbackElement||null)));let y=e.concat(o.slice(0,p+1)),w=()=>{let T;return v?T=_:x?T=P:f.route.Component?T=N.createElement(f.route.Component,null):f.route.element?T=f.route.element:T=h,N.createElement(wC,{match:f,routeContext:{outlet:h,matches:y,isDataRoute:n!=null},children:T})};return n&&(f.route.ErrorBoundary||f.route.errorElement||p===0)?N.createElement(_C,{location:n.location,revalidation:n.revalidation,component:_,error:v,children:w(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):w()},null)}var AS=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(AS||{}),NS=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(NS||{});function EC(t){let e=N.useContext(zu);return e||vt(!1),e}function TC(t){let e=N.useContext(xS);return e||vt(!1),e}function bC(t){let e=N.useContext(qr);return e||vt(!1),e}function kS(t){let e=bC(),n=e.matches[e.matches.length-1];return n.route.id||vt(!1),n.route.id}function xC(){var t;let e=N.useContext(IS),n=TC(),r=kS();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function IC(){let{router:t}=EC(AS.UseNavigateStable),e=kS(NS.UseNavigateStable),n=N.useRef(!1);return CS(()=>{n.current=!0}),N.useCallback(function(i,s){s===void 0&&(s={}),n.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Ja({fromRouteId:e},s)))},[t,e])}const ov={};function CC(t,e,n){ov[t]||(ov[t]=!0)}function AC(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function NC(t){let{to:e,replace:n,state:r,relative:i}=t;ko()||vt(!1);let{future:s,static:o}=N.useContext(Wr),{matches:c}=N.useContext(qr),{pathname:a}=Ss(),d=Po(),h=lp(e,ap(c,s.v7_relativeSplatPath),a,i==="path"),f=JSON.stringify(h);return N.useEffect(()=>d(JSON.parse(f),{replace:n,state:r,relative:i}),[d,f,i,n,r]),null}function ti(t){vt(!1)}function kC(t){let{basename:e="/",children:n=null,location:r,navigationType:i=di.Pop,navigator:s,static:o=!1,future:c}=t;ko()&&vt(!1);let a=e.replace(/^\/*/,"/"),d=N.useMemo(()=>({basename:a,navigator:s,static:o,future:Ja({v7_relativeSplatPath:!1},c)}),[a,c,s,o]);typeof r=="string"&&(r=ws(r));let{pathname:h="/",search:f="",hash:p="",state:v=null,key:x="default"}=r,_=N.useMemo(()=>{let P=yo(h,a);return P==null?null:{location:{pathname:P,search:f,hash:p,state:v,key:x},navigationType:i}},[a,h,f,p,v,x,i]);return _==null?null:N.createElement(Wr.Provider,{value:d},N.createElement($u.Provider,{children:n,value:_}))}function PC(t){let{children:e,location:n}=t;return pC(xf(e),n)}new Promise(()=>{});function xf(t,e){e===void 0&&(e=[]);let n=[];return N.Children.forEach(t,(r,i)=>{if(!N.isValidElement(r))return;let s=[...e,i];if(r.type===N.Fragment){n.push.apply(n,xf(r.props.children,s));return}r.type!==ti&&vt(!1),!r.props.index||!r.props.children||vt(!1);let o={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=xf(r.props.children,s)),n.push(o)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function au(){return au=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},au.apply(this,arguments)}function PS(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function RC(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function DC(t,e){return t.button===0&&(!e||e==="_self")&&!RC(t)}const jC=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],MC=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],OC="6";try{window.__reactRouterVersion=OC}catch{}const VC=N.createContext({isTransitioning:!1}),LC="startTransition",av=kb[LC];function FC(t){let{basename:e,children:n,future:r,window:i}=t,s=N.useRef();s.current==null&&(s.current=BI({window:i,v5Compat:!0}));let o=s.current,[c,a]=N.useState({action:o.action,location:o.location}),{v7_startTransition:d}=r||{},h=N.useCallback(f=>{d&&av?av(()=>a(f)):a(f)},[a,d]);return N.useLayoutEffect(()=>o.listen(h),[o,h]),N.useEffect(()=>AC(r),[r]),N.createElement(kC,{basename:e,children:n,location:c.location,navigationType:c.action,navigator:o,future:r})}const UC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",BC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,zC=N.forwardRef(function(e,n){let{onClick:r,relative:i,reloadDocument:s,replace:o,state:c,target:a,to:d,preventScrollReset:h,viewTransition:f}=e,p=PS(e,jC),{basename:v}=N.useContext(Wr),x,_=!1;if(typeof d=="string"&&BC.test(d)&&(x=d,UC))try{let T=new URL(window.location.href),M=d.startsWith("//")?new URL(T.protocol+d):new URL(d),L=yo(M.pathname,v);M.origin===T.origin&&L!=null?d=L+M.search+M.hash:_=!0}catch{}let P=hC(d,{relative:i}),y=HC(d,{replace:o,state:c,target:a,preventScrollReset:h,relative:i,viewTransition:f});function w(T){r&&r(T),T.defaultPrevented||y(T)}return N.createElement("a",au({},p,{href:x||P,onClick:_||s?r:w,ref:n,target:a}))}),ra=N.forwardRef(function(e,n){let{"aria-current":r="page",caseSensitive:i=!1,className:s="",end:o=!1,style:c,to:a,viewTransition:d,children:h}=e,f=PS(e,MC),p=Hu(a,{relative:f.relative}),v=Ss(),x=N.useContext(xS),{navigator:_,basename:P}=N.useContext(Wr),y=x!=null&&WC(p)&&d===!0,w=_.encodeLocation?_.encodeLocation(p).pathname:p.pathname,T=v.pathname,M=x&&x.navigation&&x.navigation.location?x.navigation.location.pathname:null;i||(T=T.toLowerCase(),M=M?M.toLowerCase():null,w=w.toLowerCase()),M&&P&&(M=yo(M,P)||M);const L=w!=="/"&&w.endsWith("/")?w.length-1:w.length;let B=T===w||!o&&T.startsWith(w)&&T.charAt(L)==="/",C=M!=null&&(M===w||!o&&M.startsWith(w)&&M.charAt(w.length)==="/"),b={isActive:B,isPending:C,isTransitioning:y},R=B?r:void 0,S;typeof s=="function"?S=s(b):S=[s,B?"active":null,C?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let E=typeof c=="function"?c(b):c;return N.createElement(zC,au({},f,{"aria-current":R,className:S,ref:n,style:E,to:a,viewTransition:d}),typeof h=="function"?h(b):h)});var If;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(If||(If={}));var lv;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(lv||(lv={}));function $C(t){let e=N.useContext(zu);return e||vt(!1),e}function HC(t,e){let{target:n,replace:r,state:i,preventScrollReset:s,relative:o,viewTransition:c}=e===void 0?{}:e,a=Po(),d=Ss(),h=Hu(t,{relative:o});return N.useCallback(f=>{if(DC(f,n)){f.preventDefault();let p=r!==void 0?r:ou(d)===ou(h);a(t,{replace:p,state:i,preventScrollReset:s,relative:o,viewTransition:c})}},[d,a,h,r,i,n,t,s,o,c])}function WC(t,e){e===void 0&&(e={});let n=N.useContext(VC);n==null&&vt(!1);let{basename:r}=$C(If.useViewTransitionState),i=Hu(t,{relative:e.relative});if(!n.isTransitioning)return!1;let s=yo(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=yo(n.nextLocation.pathname,r)||n.nextLocation.pathname;return bf(i.pathname,o)!=null||bf(i.pathname,s)!=null}function qC(t={}){const{nonce:e,onScriptLoadSuccess:n,onScriptLoadError:r}=t,[i,s]=N.useState(!1),o=N.useRef(n);o.current=n;const c=N.useRef(r);return c.current=r,N.useEffect(()=>{const a=document.createElement("script");return a.src="https://accounts.google.com/gsi/client",a.async=!0,a.defer=!0,a.nonce=e,a.onload=()=>{var d;s(!0),(d=o.current)===null||d===void 0||d.call(o)},a.onerror=()=>{var d;s(!1),(d=c.current)===null||d===void 0||d.call(c)},document.body.appendChild(a),()=>{document.body.removeChild(a)}},[e]),i}const RS=N.createContext(null);function GC({clientId:t,nonce:e,onScriptLoadSuccess:n,onScriptLoadError:r,children:i}){const s=qC({nonce:e,onScriptLoadSuccess:n,onScriptLoadError:r}),o=N.useMemo(()=>({clientId:t,scriptLoadedSuccessfully:s}),[t,s]);return Ue.createElement(RS.Provider,{value:o},i)}function QC(){const t=N.useContext(RS);if(!t)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return t}function KC(t){var e;return(e=t==null?void 0:t.clientId)!==null&&e!==void 0?e:t==null?void 0:t.client_id}const YC={large:40,medium:32,small:20};function XC({onSuccess:t,onError:e,useOneTap:n,promptMomentNotification:r,type:i="standard",theme:s="outline",size:o="large",text:c,shape:a,logo_alignment:d,width:h,locale:f,click_listener:p,containerProps:v,...x}){const _=N.useRef(null),{clientId:P,scriptLoadedSuccessfully:y}=QC(),w=N.useRef(t);w.current=t;const T=N.useRef(e);T.current=e;const M=N.useRef(r);return M.current=r,N.useEffect(()=>{var L,B,C,b,R,S,E,j,k;if(y)return(C=(B=(L=window==null?void 0:window.google)===null||L===void 0?void 0:L.accounts)===null||B===void 0?void 0:B.id)===null||C===void 0||C.initialize({client_id:P,callback:Q=>{var I;if(!(Q!=null&&Q.credential))return(I=T.current)===null||I===void 0?void 0:I.call(T);const{credential:V,select_by:q}=Q;w.current({credential:V,clientId:KC(Q),select_by:q})},...x}),(S=(R=(b=window==null?void 0:window.google)===null||b===void 0?void 0:b.accounts)===null||R===void 0?void 0:R.id)===null||S===void 0||S.renderButton(_.current,{type:i,theme:s,size:o,text:c,shape:a,logo_alignment:d,width:h,locale:f,click_listener:p}),n&&((k=(j=(E=window==null?void 0:window.google)===null||E===void 0?void 0:E.accounts)===null||j===void 0?void 0:j.id)===null||k===void 0||k.prompt(M.current)),()=>{var Q,I,V;n&&((V=(I=(Q=window==null?void 0:window.google)===null||Q===void 0?void 0:Q.accounts)===null||I===void 0?void 0:I.id)===null||V===void 0||V.cancel())}},[P,y,n,i,s,o,c,a,d,h,f]),Ue.createElement("div",{...v,ref:_,style:{height:YC[o],...v==null?void 0:v.style}})}const lu="authToken";function JC(t){if(!t){try{localStorage.removeItem(lu)}catch{}return}try{localStorage.setItem(lu,t)}catch{}}function Ca(){try{return localStorage.getItem(lu)}catch{return null}}function ZC(){try{localStorage.removeItem(lu)}catch{}}async function eA(t,e={}){const n=Ca(),r=Object.assign({},e.headers||{});return n&&(r.Authorization=`Bearer ${n}`),await fetch(t,Object.assign({},e,{headers:r}))}const Tt={setToken:JC,getToken:Ca,clearToken:ZC,fetchWithAuth:eA};function tA({setToken:t}){N.useEffect(()=>{},[]);const[e,n]=N.useState(""),[r,i]=N.useState(""),[s,o]=N.useState(""),[c,a]=N.useState(!1),d=Po(),h=async f=>{if(f&&f.preventDefault(),o(""),!e||!r){o("Please enter username and password");return}a(!0);try{const p=await fetch("/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:r})});if(!p.ok){const x=await p.json().catch(()=>({}));o(x.error||"Invalid username or password"),a(!1);return}const v=await p.json();if(v&&v.ok&&v.token){try{Tt.setToken(v.token)}catch{}t(v.token);try{d("/")}catch{}}else o("Login failed")}catch{o("Server error  please try again")}finally{a(!1)}};return u.jsx("div",{style:{minHeight:"100vh",width:"100%",margin:0,display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, rgba(255,182,213,0.94), rgba(180,196,255,0.92))",backgroundRepeat:"no-repeat",backgroundSize:"cover"},children:u.jsxs("div",{style:{width:420,minHeight:520,padding:"56px 48px",borderRadius:28,background:"#11121d",boxShadow:"0 36px 70px rgba(0,0,0,0.40)",display:"flex",flexDirection:"column",alignItems:"center",color:"#fff",textAlign:"center"},children:[u.jsx("img",{src:"/kusgan-frontend/kusgan-logo.png",alt:"Kusgan Logo",style:{width:160,height:160,objectFit:"cover",borderRadius:"22px",boxShadow:"0 10px 28px rgba(215,38,96,0.35)",marginBottom:24,background:"#000"}}),u.jsx("h1",{style:{fontSize:"1.6rem",fontWeight:700,margin:"0 0 8px"},children:"Kusgan Fitness Gym"}),u.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:"column",gap:8},children:[u.jsx("div",{style:{fontSize:13,color:"#c9c9da",fontWeight:600,marginBottom:4,textAlign:"left"}}),u.jsxs("form",{onSubmit:h,style:{width:"100%",display:"flex",flexDirection:"column",gap:8},children:[u.jsx("label",{style:{fontSize:12,color:"#c9c9da",textAlign:"left"},children:"Username"}),u.jsx("input",{type:"text",value:e,onChange:f=>n(f.target.value),placeholder:"Enter staff username",style:{padding:10,fontSize:16,borderRadius:6,border:"1px solid #2a2a36",background:"#0f1114",color:"#fff"}}),u.jsx("label",{style:{fontSize:12,color:"#c9c9da",textAlign:"left"},children:"Password"}),u.jsx("input",{type:"password",value:r,onChange:f=>i(f.target.value),placeholder:"Enter staff password",style:{padding:10,fontSize:16,borderRadius:6,border:"1px solid #2a2a36",background:"#0f1114",color:"#fff"}}),s&&u.jsx("div",{style:{color:"#f44336",fontSize:13},children:s}),u.jsx("button",{type:"submit",disabled:c,style:{marginTop:6,padding:12,borderRadius:6,background:"#1976d2",color:"#fff",border:"none",cursor:c?"default":"pointer",opacity:c?.8:1},children:c?"Signing in":"Sign in"})]}),u.jsxs("div",{style:{marginTop:18,width:"100%",textAlign:"center"},children:[u.jsx("div",{style:{fontSize:13,color:"#c9c9da",fontWeight:600,marginBottom:8},children:"Sign in as Member"}),u.jsx("div",{style:{opacity:.5,pointerEvents:"none",display:"flex",justifyContent:"center"},children:u.jsx(XC,{onSuccess:()=>{},onError:()=>{}})}),u.jsx("div",{style:{marginTop:8,color:"#8b8b9b",fontSize:13},children:"Member login via Google is not yet enabled."})]})]})]})})}function cv(){var s,o,c,a;const t=new Intl.DateTimeFormat("en-US",{timeZone:"Asia/Manila",weekday:"long",month:"short",day:"2-digit",year:"numeric"}).formatToParts(new Date),e=(((s=t.find(d=>d.type==="weekday"))==null?void 0:s.value)||"").toUpperCase(),n=((o=t.find(d=>d.type==="month"))==null?void 0:o.value)||"Jan",r=parseInt(((c=t.find(d=>d.type==="day"))==null?void 0:c.value)||"01",10),i=((a=t.find(d=>d.type==="year"))==null?void 0:a.value)||"0000";return{weekday:e,text:`${n}-${r}, ${i}`}}function nA({onLogout:t=()=>{}}){const[e,n]=N.useState(cv()),[r,i]=N.useState(!1);return N.useEffect(()=>{const s=()=>n(cv()),o=setInterval(s,6e4);return s(),()=>clearInterval(o)},[]),N.useEffect(()=>{let s=!0;return(async()=>{var o;try{const c=await Tt.fetchWithAuth("/auth/me");if(!s)return;if(!c.ok)return i(!1);const a=await c.json().catch(()=>({}));i(((o=a==null?void 0:a.user)==null?void 0:o.role)==="admin")}catch{i(!1)}})(),()=>{s=!1}},[]),u.jsxs("aside",{className:"sidebar",children:[u.jsx("div",{className:"brand",children:u.jsx("img",{src:"/kusgan-frontend/kusgan-logo.png",alt:"Kusgan logo",className:"brand-logo",style:{width:350,height:"auto"}})}),u.jsx("div",{className:"sidebar-info",children:u.jsxs("div",{className:"date",children:[u.jsx("div",{style:{fontSize:"14px",fontStyle:"italic",color:"#e9e9ee",marginBottom:"5px"},children:"Today is"}),u.jsxs("div",{style:{fontWeight:"600",fontSize:"20px",color:"#e9e9ee",marginBottom:"25px"},children:[e.weekday," ",e.text]})]})}),u.jsxs("nav",{className:"nav",children:[u.jsx(ra,{to:"/",end:!0,children:" Dashboard"}),u.jsx(ra,{to:"/attendance",children:" Staff Attendance"}),u.jsx(ra,{to:"/members",children:" All Members"}),u.jsx(ra,{to:"/checkin",children:" Member Check-In"}),r&&u.jsx(ra,{to:"/admin",children:" Admin"})]}),u.jsx("div",{className:"sidebar-footer",children:u.jsx("button",{className:"button logout-btn",onClick:t,children:"Logout"})})]})}const rA=()=>{};var uv={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DS=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},iA=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],c=t[n++],a=((i&7)<<18|(s&63)<<12|(o&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(a>>10)),e[r++]=String.fromCharCode(56320+(a&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},jS={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,c=o?t[i+1]:0,a=i+2<t.length,d=a?t[i+2]:0,h=s>>2,f=(s&3)<<4|c>>4;let p=(c&15)<<2|d>>6,v=d&63;a||(v=64,o||(p=64)),r.push(n[h],n[f],n[p],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(DS(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):iA(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],c=i<t.length?n[t.charAt(i)]:0;++i;const d=i<t.length?n[t.charAt(i)]:64;++i;const f=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||c==null||d==null||f==null)throw new sA;const p=s<<2|c>>4;if(r.push(p),d!==64){const v=c<<4&240|d>>2;if(r.push(v),f!==64){const x=d<<6&192|f;r.push(x)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class sA extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const oA=function(t){const e=DS(t);return jS.encodeByteArray(e,!0)},cu=function(t){return oA(t).replace(/\./g,"")},aA=function(t){try{return jS.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lA(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cA=()=>lA().__FIREBASE_DEFAULTS__,uA=()=>{if(typeof process>"u"||typeof uv>"u")return;const t=uv.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},dA=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&aA(t[1]);return e&&JSON.parse(e)},cp=()=>{try{return rA()||cA()||uA()||dA()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},hA=t=>{var e,n;return(n=(e=cp())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},MS=t=>{const e=hA(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},OS=()=>{var t;return(t=cp())==null?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fA{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yl(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function VS(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LS(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...t};return[cu(JSON.stringify(n)),cu(JSON.stringify(o)),""].join(".")}const Aa={};function mA(){const t={prod:[],emulator:[]};for(const e of Object.keys(Aa))Aa[e]?t.emulator.push(e):t.prod.push(e);return t}function pA(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let dv=!1;function FS(t,e){if(typeof window>"u"||typeof document>"u"||!yl(window.location.host)||Aa[t]===e||Aa[t]||dv)return;Aa[t]=e;function n(p){return`__firebase__banner__${p}`}const r="__firebase__banner",s=mA().prod.length>0;function o(){const p=document.getElementById(r);p&&p.remove()}function c(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function a(p,v){p.setAttribute("width","24"),p.setAttribute("id",v),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function d(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{dv=!0,o()},p}function h(p,v){p.setAttribute("id",v),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function f(){const p=pA(r),v=n("text"),x=document.getElementById(v)||document.createElement("span"),_=n("learnmore"),P=document.getElementById(_)||document.createElement("a"),y=n("preprendIcon"),w=document.getElementById(y)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const T=p.element;c(T),h(P,_);const M=d();a(w,y),T.append(w,x,P,M),document.body.appendChild(T)}s?(x.innerText="Preview backend disconnected.",w.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(w.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,x.innerText="Preview backend running in this workspace."),x.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gA(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function yA(){var e;const t=(e=cp())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function vA(){return!yA()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function _A(){try{return typeof indexedDB=="object"}catch{return!1}}function wA(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)==null?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SA="FirebaseError";class Es extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=SA,Object.setPrototypeOf(this,Es.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,US.prototype.create)}}class US{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?EA(s,r):"Error",c=`${this.serviceName}: ${o} (${i}).`;return new Es(i,c,r)}}function EA(t,e){return t.replace(TA,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const TA=/\{\$([^}]+)}/g;function uu(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(hv(s)&&hv(o)){if(!uu(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function hv(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function An(t){return t&&t._delegate?t._delegate:t}class vo{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bA{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new fA;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(IA(e))try{this.getOrInitializeService({instanceIdentifier:Xi})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Xi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Xi){return this.instances.has(e)}getOptions(e=Xi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(s);r===c&&o.resolve(i)}return i}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:xA(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Xi){return this.component?this.component.multipleInstances?e:Xi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function xA(t){return t===Xi?void 0:t}function IA(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CA{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new bA(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var He;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(He||(He={}));const AA={debug:He.DEBUG,verbose:He.VERBOSE,info:He.INFO,warn:He.WARN,error:He.ERROR,silent:He.SILENT},NA=He.INFO,kA={[He.DEBUG]:"log",[He.VERBOSE]:"log",[He.INFO]:"info",[He.WARN]:"warn",[He.ERROR]:"error"},PA=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=kA[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class BS{constructor(e){this.name=e,this._logLevel=NA,this._logHandler=PA,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in He))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?AA[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,He.DEBUG,...e),this._logHandler(this,He.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,He.VERBOSE,...e),this._logHandler(this,He.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,He.INFO,...e),this._logHandler(this,He.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,He.WARN,...e),this._logHandler(this,He.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,He.ERROR,...e),this._logHandler(this,He.ERROR,...e)}}const RA=(t,e)=>e.some(n=>t instanceof n);let fv,mv;function DA(){return fv||(fv=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function jA(){return mv||(mv=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const zS=new WeakMap,Cf=new WeakMap,$S=new WeakMap,th=new WeakMap,up=new WeakMap;function MA(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Ti(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&zS.set(n,t)}).catch(()=>{}),up.set(e,t),e}function OA(t){if(Cf.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});Cf.set(t,e)}let Af={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Cf.get(t);if(e==="objectStoreNames")return t.objectStoreNames||$S.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ti(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function VA(t){Af=t(Af)}function LA(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(nh(this),e,...n);return $S.set(r,e.sort?e.sort():[e]),Ti(r)}:jA().includes(t)?function(...e){return t.apply(nh(this),e),Ti(zS.get(this))}:function(...e){return Ti(t.apply(nh(this),e))}}function FA(t){return typeof t=="function"?LA(t):(t instanceof IDBTransaction&&OA(t),RA(t,DA())?new Proxy(t,Af):t)}function Ti(t){if(t instanceof IDBRequest)return MA(t);if(th.has(t))return th.get(t);const e=FA(t);return e!==t&&(th.set(t,e),up.set(e,t)),e}const nh=t=>up.get(t);function HS(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),c=Ti(o);return r&&o.addEventListener("upgradeneeded",a=>{r(Ti(o.result),a.oldVersion,a.newVersion,Ti(o.transaction),a)}),n&&o.addEventListener("blocked",a=>n(a.oldVersion,a.newVersion,a)),c.then(a=>{s&&a.addEventListener("close",()=>s()),i&&a.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}const UA=["get","getKey","getAll","getAllKeys","count"],BA=["put","add","delete","clear"],rh=new Map;function pv(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(rh.get(e))return rh.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=BA.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||UA.includes(n)))return;const s=async function(o,...c){const a=this.transaction(o,i?"readwrite":"readonly");let d=a.store;return r&&(d=d.index(c.shift())),(await Promise.all([d[n](...c),i&&a.done]))[0]};return rh.set(e,s),s}VA(t=>({...t,get:(e,n,r)=>pv(e,n)||t.get(e,n,r),has:(e,n)=>!!pv(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zA{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if($A(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function $A(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Nf="@firebase/app",gv="0.14.5";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Br=new BS("@firebase/app"),HA="@firebase/app-compat",WA="@firebase/analytics-compat",qA="@firebase/analytics",GA="@firebase/app-check-compat",QA="@firebase/app-check",KA="@firebase/auth",YA="@firebase/auth-compat",XA="@firebase/database",JA="@firebase/data-connect",ZA="@firebase/database-compat",eN="@firebase/functions",tN="@firebase/functions-compat",nN="@firebase/installations",rN="@firebase/installations-compat",iN="@firebase/messaging",sN="@firebase/messaging-compat",oN="@firebase/performance",aN="@firebase/performance-compat",lN="@firebase/remote-config",cN="@firebase/remote-config-compat",uN="@firebase/storage",dN="@firebase/storage-compat",hN="@firebase/firestore",fN="@firebase/ai",mN="@firebase/firestore-compat",pN="firebase",gN="12.5.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kf="[DEFAULT]",yN={[Nf]:"fire-core",[HA]:"fire-core-compat",[qA]:"fire-analytics",[WA]:"fire-analytics-compat",[QA]:"fire-app-check",[GA]:"fire-app-check-compat",[KA]:"fire-auth",[YA]:"fire-auth-compat",[XA]:"fire-rtdb",[JA]:"fire-data-connect",[ZA]:"fire-rtdb-compat",[eN]:"fire-fn",[tN]:"fire-fn-compat",[nN]:"fire-iid",[rN]:"fire-iid-compat",[iN]:"fire-fcm",[sN]:"fire-fcm-compat",[oN]:"fire-perf",[aN]:"fire-perf-compat",[lN]:"fire-rc",[cN]:"fire-rc-compat",[uN]:"fire-gcs",[dN]:"fire-gcs-compat",[hN]:"fire-fst",[mN]:"fire-fst-compat",[fN]:"fire-vertex","fire-js":"fire-js",[pN]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Za=new Map,vN=new Map,Pf=new Map;function yv(t,e){try{t.container.addComponent(e)}catch(n){Br.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function el(t){const e=t.name;if(Pf.has(e))return Br.debug(`There were multiple attempts to register component ${e}.`),!1;Pf.set(e,t);for(const n of Za.values())yv(n,t);for(const n of vN.values())yv(n,t);return!0}function WS(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function qS(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _N={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},bi=new US("app","Firebase",_N);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wN{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new vo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw bi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GS=gN;function QS(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:kf,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw bi.create("bad-app-name",{appName:String(i)});if(n||(n=OS()),!n)throw bi.create("no-options");const s=Za.get(i);if(s){if(uu(n,s.options)&&uu(r,s.config))return s;throw bi.create("duplicate-app",{appName:i})}const o=new CA(i);for(const a of Pf.values())o.addComponent(a);const c=new wN(n,r,o);return Za.set(i,c),c}function dp(t=kf){const e=Za.get(t);if(!e&&t===kf&&OS())return QS();if(!e)throw bi.create("no-app",{appName:t});return e}function vv(){return Array.from(Za.values())}function xi(t,e,n){let r=yN[t]??t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Br.warn(o.join(" "));return}el(new vo(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SN="firebase-heartbeat-database",EN=1,tl="firebase-heartbeat-store";let ih=null;function KS(){return ih||(ih=HS(SN,EN,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(tl)}catch(n){console.warn(n)}}}}).catch(t=>{throw bi.create("idb-open",{originalErrorMessage:t.message})})),ih}async function TN(t){try{const n=(await KS()).transaction(tl),r=await n.objectStore(tl).get(YS(t));return await n.done,r}catch(e){if(e instanceof Es)Br.warn(e.message);else{const n=bi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Br.warn(n.message)}}}async function _v(t,e){try{const r=(await KS()).transaction(tl,"readwrite");await r.objectStore(tl).put(e,YS(t)),await r.done}catch(n){if(n instanceof Es)Br.warn(n.message);else{const r=bi.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Br.warn(r.message)}}}function YS(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bN=1024,xN=30;class IN{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new AN(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=wv();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>xN){const o=NN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Br.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=wv(),{heartbeatsToSend:r,unsentEntries:i}=CN(this._heartbeatsCache.heartbeats),s=cu(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Br.warn(n),""}}}function wv(){return new Date().toISOString().substring(0,10)}function CN(t,e=bN){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),Sv(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Sv(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class AN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return _A()?wA().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await TN(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return _v(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return _v(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Sv(t){return cu(JSON.stringify({version:2,heartbeats:t})).length}function NN(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kN(t){el(new vo("platform-logger",e=>new zA(e),"PRIVATE")),el(new vo("heartbeat",e=>new IN(e),"PRIVATE")),xi(Nf,gv,t),xi(Nf,gv,"esm2020"),xi("fire-js","")}kN("");var PN="firebase",RN="12.5.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */xi(PN,RN,"app");var Ev=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ii,XS;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(C,b){function R(){}R.prototype=b.prototype,C.F=b.prototype,C.prototype=new R,C.prototype.constructor=C,C.D=function(S,E,j){for(var k=Array(arguments.length-2),Q=2;Q<arguments.length;Q++)k[Q-2]=arguments[Q];return b.prototype[E].apply(S,k)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(C,b,R){R||(R=0);const S=Array(16);if(typeof b=="string")for(var E=0;E<16;++E)S[E]=b.charCodeAt(R++)|b.charCodeAt(R++)<<8|b.charCodeAt(R++)<<16|b.charCodeAt(R++)<<24;else for(E=0;E<16;++E)S[E]=b[R++]|b[R++]<<8|b[R++]<<16|b[R++]<<24;b=C.g[0],R=C.g[1],E=C.g[2];let j=C.g[3],k;k=b+(j^R&(E^j))+S[0]+3614090360&4294967295,b=R+(k<<7&4294967295|k>>>25),k=j+(E^b&(R^E))+S[1]+3905402710&4294967295,j=b+(k<<12&4294967295|k>>>20),k=E+(R^j&(b^R))+S[2]+606105819&4294967295,E=j+(k<<17&4294967295|k>>>15),k=R+(b^E&(j^b))+S[3]+3250441966&4294967295,R=E+(k<<22&4294967295|k>>>10),k=b+(j^R&(E^j))+S[4]+4118548399&4294967295,b=R+(k<<7&4294967295|k>>>25),k=j+(E^b&(R^E))+S[5]+1200080426&4294967295,j=b+(k<<12&4294967295|k>>>20),k=E+(R^j&(b^R))+S[6]+2821735955&4294967295,E=j+(k<<17&4294967295|k>>>15),k=R+(b^E&(j^b))+S[7]+4249261313&4294967295,R=E+(k<<22&4294967295|k>>>10),k=b+(j^R&(E^j))+S[8]+1770035416&4294967295,b=R+(k<<7&4294967295|k>>>25),k=j+(E^b&(R^E))+S[9]+2336552879&4294967295,j=b+(k<<12&4294967295|k>>>20),k=E+(R^j&(b^R))+S[10]+4294925233&4294967295,E=j+(k<<17&4294967295|k>>>15),k=R+(b^E&(j^b))+S[11]+2304563134&4294967295,R=E+(k<<22&4294967295|k>>>10),k=b+(j^R&(E^j))+S[12]+1804603682&4294967295,b=R+(k<<7&4294967295|k>>>25),k=j+(E^b&(R^E))+S[13]+4254626195&4294967295,j=b+(k<<12&4294967295|k>>>20),k=E+(R^j&(b^R))+S[14]+2792965006&4294967295,E=j+(k<<17&4294967295|k>>>15),k=R+(b^E&(j^b))+S[15]+1236535329&4294967295,R=E+(k<<22&4294967295|k>>>10),k=b+(E^j&(R^E))+S[1]+4129170786&4294967295,b=R+(k<<5&4294967295|k>>>27),k=j+(R^E&(b^R))+S[6]+3225465664&4294967295,j=b+(k<<9&4294967295|k>>>23),k=E+(b^R&(j^b))+S[11]+643717713&4294967295,E=j+(k<<14&4294967295|k>>>18),k=R+(j^b&(E^j))+S[0]+3921069994&4294967295,R=E+(k<<20&4294967295|k>>>12),k=b+(E^j&(R^E))+S[5]+3593408605&4294967295,b=R+(k<<5&4294967295|k>>>27),k=j+(R^E&(b^R))+S[10]+38016083&4294967295,j=b+(k<<9&4294967295|k>>>23),k=E+(b^R&(j^b))+S[15]+3634488961&4294967295,E=j+(k<<14&4294967295|k>>>18),k=R+(j^b&(E^j))+S[4]+3889429448&4294967295,R=E+(k<<20&4294967295|k>>>12),k=b+(E^j&(R^E))+S[9]+568446438&4294967295,b=R+(k<<5&4294967295|k>>>27),k=j+(R^E&(b^R))+S[14]+3275163606&4294967295,j=b+(k<<9&4294967295|k>>>23),k=E+(b^R&(j^b))+S[3]+4107603335&4294967295,E=j+(k<<14&4294967295|k>>>18),k=R+(j^b&(E^j))+S[8]+1163531501&4294967295,R=E+(k<<20&4294967295|k>>>12),k=b+(E^j&(R^E))+S[13]+2850285829&4294967295,b=R+(k<<5&4294967295|k>>>27),k=j+(R^E&(b^R))+S[2]+4243563512&4294967295,j=b+(k<<9&4294967295|k>>>23),k=E+(b^R&(j^b))+S[7]+1735328473&4294967295,E=j+(k<<14&4294967295|k>>>18),k=R+(j^b&(E^j))+S[12]+2368359562&4294967295,R=E+(k<<20&4294967295|k>>>12),k=b+(R^E^j)+S[5]+4294588738&4294967295,b=R+(k<<4&4294967295|k>>>28),k=j+(b^R^E)+S[8]+2272392833&4294967295,j=b+(k<<11&4294967295|k>>>21),k=E+(j^b^R)+S[11]+1839030562&4294967295,E=j+(k<<16&4294967295|k>>>16),k=R+(E^j^b)+S[14]+4259657740&4294967295,R=E+(k<<23&4294967295|k>>>9),k=b+(R^E^j)+S[1]+2763975236&4294967295,b=R+(k<<4&4294967295|k>>>28),k=j+(b^R^E)+S[4]+1272893353&4294967295,j=b+(k<<11&4294967295|k>>>21),k=E+(j^b^R)+S[7]+4139469664&4294967295,E=j+(k<<16&4294967295|k>>>16),k=R+(E^j^b)+S[10]+3200236656&4294967295,R=E+(k<<23&4294967295|k>>>9),k=b+(R^E^j)+S[13]+681279174&4294967295,b=R+(k<<4&4294967295|k>>>28),k=j+(b^R^E)+S[0]+3936430074&4294967295,j=b+(k<<11&4294967295|k>>>21),k=E+(j^b^R)+S[3]+3572445317&4294967295,E=j+(k<<16&4294967295|k>>>16),k=R+(E^j^b)+S[6]+76029189&4294967295,R=E+(k<<23&4294967295|k>>>9),k=b+(R^E^j)+S[9]+3654602809&4294967295,b=R+(k<<4&4294967295|k>>>28),k=j+(b^R^E)+S[12]+3873151461&4294967295,j=b+(k<<11&4294967295|k>>>21),k=E+(j^b^R)+S[15]+530742520&4294967295,E=j+(k<<16&4294967295|k>>>16),k=R+(E^j^b)+S[2]+3299628645&4294967295,R=E+(k<<23&4294967295|k>>>9),k=b+(E^(R|~j))+S[0]+4096336452&4294967295,b=R+(k<<6&4294967295|k>>>26),k=j+(R^(b|~E))+S[7]+1126891415&4294967295,j=b+(k<<10&4294967295|k>>>22),k=E+(b^(j|~R))+S[14]+2878612391&4294967295,E=j+(k<<15&4294967295|k>>>17),k=R+(j^(E|~b))+S[5]+4237533241&4294967295,R=E+(k<<21&4294967295|k>>>11),k=b+(E^(R|~j))+S[12]+1700485571&4294967295,b=R+(k<<6&4294967295|k>>>26),k=j+(R^(b|~E))+S[3]+2399980690&4294967295,j=b+(k<<10&4294967295|k>>>22),k=E+(b^(j|~R))+S[10]+4293915773&4294967295,E=j+(k<<15&4294967295|k>>>17),k=R+(j^(E|~b))+S[1]+2240044497&4294967295,R=E+(k<<21&4294967295|k>>>11),k=b+(E^(R|~j))+S[8]+1873313359&4294967295,b=R+(k<<6&4294967295|k>>>26),k=j+(R^(b|~E))+S[15]+4264355552&4294967295,j=b+(k<<10&4294967295|k>>>22),k=E+(b^(j|~R))+S[6]+2734768916&4294967295,E=j+(k<<15&4294967295|k>>>17),k=R+(j^(E|~b))+S[13]+1309151649&4294967295,R=E+(k<<21&4294967295|k>>>11),k=b+(E^(R|~j))+S[4]+4149444226&4294967295,b=R+(k<<6&4294967295|k>>>26),k=j+(R^(b|~E))+S[11]+3174756917&4294967295,j=b+(k<<10&4294967295|k>>>22),k=E+(b^(j|~R))+S[2]+718787259&4294967295,E=j+(k<<15&4294967295|k>>>17),k=R+(j^(E|~b))+S[9]+3951481745&4294967295,C.g[0]=C.g[0]+b&4294967295,C.g[1]=C.g[1]+(E+(k<<21&4294967295|k>>>11))&4294967295,C.g[2]=C.g[2]+E&4294967295,C.g[3]=C.g[3]+j&4294967295}r.prototype.v=function(C,b){b===void 0&&(b=C.length);const R=b-this.blockSize,S=this.C;let E=this.h,j=0;for(;j<b;){if(E==0)for(;j<=R;)i(this,C,j),j+=this.blockSize;if(typeof C=="string"){for(;j<b;)if(S[E++]=C.charCodeAt(j++),E==this.blockSize){i(this,S),E=0;break}}else for(;j<b;)if(S[E++]=C[j++],E==this.blockSize){i(this,S),E=0;break}}this.h=E,this.o+=b},r.prototype.A=function(){var C=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);C[0]=128;for(var b=1;b<C.length-8;++b)C[b]=0;b=this.o*8;for(var R=C.length-8;R<C.length;++R)C[R]=b&255,b/=256;for(this.v(C),C=Array(16),b=0,R=0;R<4;++R)for(let S=0;S<32;S+=8)C[b++]=this.g[R]>>>S&255;return C};function s(C,b){var R=c;return Object.prototype.hasOwnProperty.call(R,C)?R[C]:R[C]=b(C)}function o(C,b){this.h=b;const R=[];let S=!0;for(let E=C.length-1;E>=0;E--){const j=C[E]|0;S&&j==b||(R[E]=j,S=!1)}this.g=R}var c={};function a(C){return-128<=C&&C<128?s(C,function(b){return new o([b|0],b<0?-1:0)}):new o([C|0],C<0?-1:0)}function d(C){if(isNaN(C)||!isFinite(C))return f;if(C<0)return P(d(-C));const b=[];let R=1;for(let S=0;C>=R;S++)b[S]=C/R|0,R*=4294967296;return new o(b,0)}function h(C,b){if(C.length==0)throw Error("number format error: empty string");if(b=b||10,b<2||36<b)throw Error("radix out of range: "+b);if(C.charAt(0)=="-")return P(h(C.substring(1),b));if(C.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=d(Math.pow(b,8));let S=f;for(let j=0;j<C.length;j+=8){var E=Math.min(8,C.length-j);const k=parseInt(C.substring(j,j+E),b);E<8?(E=d(Math.pow(b,E)),S=S.j(E).add(d(k))):(S=S.j(R),S=S.add(d(k)))}return S}var f=a(0),p=a(1),v=a(16777216);t=o.prototype,t.m=function(){if(_(this))return-P(this).m();let C=0,b=1;for(let R=0;R<this.g.length;R++){const S=this.i(R);C+=(S>=0?S:4294967296+S)*b,b*=4294967296}return C},t.toString=function(C){if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(x(this))return"0";if(_(this))return"-"+P(this).toString(C);const b=d(Math.pow(C,6));var R=this;let S="";for(;;){const E=M(R,b).g;R=y(R,E.j(b));let j=((R.g.length>0?R.g[0]:R.h)>>>0).toString(C);if(R=E,x(R))return j+S;for(;j.length<6;)j="0"+j;S=j+S}},t.i=function(C){return C<0?0:C<this.g.length?this.g[C]:this.h};function x(C){if(C.h!=0)return!1;for(let b=0;b<C.g.length;b++)if(C.g[b]!=0)return!1;return!0}function _(C){return C.h==-1}t.l=function(C){return C=y(this,C),_(C)?-1:x(C)?0:1};function P(C){const b=C.g.length,R=[];for(let S=0;S<b;S++)R[S]=~C.g[S];return new o(R,~C.h).add(p)}t.abs=function(){return _(this)?P(this):this},t.add=function(C){const b=Math.max(this.g.length,C.g.length),R=[];let S=0;for(let E=0;E<=b;E++){let j=S+(this.i(E)&65535)+(C.i(E)&65535),k=(j>>>16)+(this.i(E)>>>16)+(C.i(E)>>>16);S=k>>>16,j&=65535,k&=65535,R[E]=k<<16|j}return new o(R,R[R.length-1]&-2147483648?-1:0)};function y(C,b){return C.add(P(b))}t.j=function(C){if(x(this)||x(C))return f;if(_(this))return _(C)?P(this).j(P(C)):P(P(this).j(C));if(_(C))return P(this.j(P(C)));if(this.l(v)<0&&C.l(v)<0)return d(this.m()*C.m());const b=this.g.length+C.g.length,R=[];for(var S=0;S<2*b;S++)R[S]=0;for(S=0;S<this.g.length;S++)for(let E=0;E<C.g.length;E++){const j=this.i(S)>>>16,k=this.i(S)&65535,Q=C.i(E)>>>16,I=C.i(E)&65535;R[2*S+2*E]+=k*I,w(R,2*S+2*E),R[2*S+2*E+1]+=j*I,w(R,2*S+2*E+1),R[2*S+2*E+1]+=k*Q,w(R,2*S+2*E+1),R[2*S+2*E+2]+=j*Q,w(R,2*S+2*E+2)}for(C=0;C<b;C++)R[C]=R[2*C+1]<<16|R[2*C];for(C=b;C<2*b;C++)R[C]=0;return new o(R,0)};function w(C,b){for(;(C[b]&65535)!=C[b];)C[b+1]+=C[b]>>>16,C[b]&=65535,b++}function T(C,b){this.g=C,this.h=b}function M(C,b){if(x(b))throw Error("division by zero");if(x(C))return new T(f,f);if(_(C))return b=M(P(C),b),new T(P(b.g),P(b.h));if(_(b))return b=M(C,P(b)),new T(P(b.g),b.h);if(C.g.length>30){if(_(C)||_(b))throw Error("slowDivide_ only works with positive integers.");for(var R=p,S=b;S.l(C)<=0;)R=L(R),S=L(S);var E=B(R,1),j=B(S,1);for(S=B(S,2),R=B(R,2);!x(S);){var k=j.add(S);k.l(C)<=0&&(E=E.add(R),j=k),S=B(S,1),R=B(R,1)}return b=y(C,E.j(b)),new T(E,b)}for(E=f;C.l(b)>=0;){for(R=Math.max(1,Math.floor(C.m()/b.m())),S=Math.ceil(Math.log(R)/Math.LN2),S=S<=48?1:Math.pow(2,S-48),j=d(R),k=j.j(b);_(k)||k.l(C)>0;)R-=S,j=d(R),k=j.j(b);x(j)&&(j=p),E=E.add(j),C=y(C,k)}return new T(E,C)}t.B=function(C){return M(this,C).h},t.and=function(C){const b=Math.max(this.g.length,C.g.length),R=[];for(let S=0;S<b;S++)R[S]=this.i(S)&C.i(S);return new o(R,this.h&C.h)},t.or=function(C){const b=Math.max(this.g.length,C.g.length),R=[];for(let S=0;S<b;S++)R[S]=this.i(S)|C.i(S);return new o(R,this.h|C.h)},t.xor=function(C){const b=Math.max(this.g.length,C.g.length),R=[];for(let S=0;S<b;S++)R[S]=this.i(S)^C.i(S);return new o(R,this.h^C.h)};function L(C){const b=C.g.length+1,R=[];for(let S=0;S<b;S++)R[S]=C.i(S)<<1|C.i(S-1)>>>31;return new o(R,C.h)}function B(C,b){const R=b>>5;b%=32;const S=C.g.length-R,E=[];for(let j=0;j<S;j++)E[j]=b>0?C.i(j+R)>>>b|C.i(j+R+1)<<32-b:C.i(j+R);return new o(E,C.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,XS=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,Ii=o}).apply(typeof Ev<"u"?Ev:typeof self<"u"?self:typeof window<"u"?window:{});var tc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var JS,fa,ZS,Nc,Rf,e1,t1,n1;(function(){var t,e=Object.defineProperty;function n(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof tc=="object"&&tc];for(var m=0;m<l.length;++m){var g=l[m];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function i(l,m){if(m)e:{var g=r;l=l.split(".");for(var D=0;D<l.length-1;D++){var W=l[D];if(!(W in g))break e;g=g[W]}l=l[l.length-1],D=g[l],m=m(D),m!=D&&m!=null&&e(g,l,{configurable:!0,writable:!0,value:m})}}i("Symbol.dispose",function(l){return l||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(l){return l||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(l){return l||function(m){var g=[],D;for(D in m)Object.prototype.hasOwnProperty.call(m,D)&&g.push([D,m[D]]);return g}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},o=this||self;function c(l){var m=typeof l;return m=="object"&&l!=null||m=="function"}function a(l,m,g){return l.call.apply(l.bind,arguments)}function d(l,m,g){return d=a,d.apply(null,arguments)}function h(l,m){var g=Array.prototype.slice.call(arguments,1);return function(){var D=g.slice();return D.push.apply(D,arguments),l.apply(this,D)}}function f(l,m){function g(){}g.prototype=m.prototype,l.Z=m.prototype,l.prototype=new g,l.prototype.constructor=l,l.Ob=function(D,W,K){for(var le=Array(arguments.length-2),Re=2;Re<arguments.length;Re++)le[Re-2]=arguments[Re];return m.prototype[W].apply(D,le)}}var p=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?l=>l&&AsyncContext.Snapshot.wrap(l):l=>l;function v(l){const m=l.length;if(m>0){const g=Array(m);for(let D=0;D<m;D++)g[D]=l[D];return g}return[]}function x(l,m){for(let D=1;D<arguments.length;D++){const W=arguments[D];var g=typeof W;if(g=g!="object"?g:W?Array.isArray(W)?"array":g:"null",g=="array"||g=="object"&&typeof W.length=="number"){g=l.length||0;const K=W.length||0;l.length=g+K;for(let le=0;le<K;le++)l[g+le]=W[le]}else l.push(W)}}class _{constructor(m,g){this.i=m,this.j=g,this.h=0,this.g=null}get(){let m;return this.h>0?(this.h--,m=this.g,this.g=m.next,m.next=null):m=this.i(),m}}function P(l){o.setTimeout(()=>{throw l},0)}function y(){var l=C;let m=null;return l.g&&(m=l.g,l.g=l.g.next,l.g||(l.h=null),m.next=null),m}class w{constructor(){this.h=this.g=null}add(m,g){const D=T.get();D.set(m,g),this.h?this.h.next=D:this.g=D,this.h=D}}var T=new _(()=>new M,l=>l.reset());class M{constructor(){this.next=this.g=this.h=null}set(m,g){this.h=m,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let L,B=!1,C=new w,b=()=>{const l=Promise.resolve(void 0);L=()=>{l.then(R)}};function R(){for(var l;l=y();){try{l.h.call(l.g)}catch(g){P(g)}var m=T;m.j(l),m.h<100&&(m.h++,l.next=m.g,m.g=l)}B=!1}function S(){this.u=this.u,this.C=this.C}S.prototype.u=!1,S.prototype.dispose=function(){this.u||(this.u=!0,this.N())},S.prototype[Symbol.dispose]=function(){this.dispose()},S.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function E(l,m){this.type=l,this.g=this.target=m,this.defaultPrevented=!1}E.prototype.h=function(){this.defaultPrevented=!0};var j=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var l=!1,m=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const g=()=>{};o.addEventListener("test",g,m),o.removeEventListener("test",g,m)}catch{}return l}();function k(l){return/^[\s\xa0]*$/.test(l)}function Q(l,m){E.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l&&this.init(l,m)}f(Q,E),Q.prototype.init=function(l,m){const g=this.type=l.type,D=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;this.target=l.target||l.srcElement,this.g=m,m=l.relatedTarget,m||(g=="mouseover"?m=l.fromElement:g=="mouseout"&&(m=l.toElement)),this.relatedTarget=m,D?(this.clientX=D.clientX!==void 0?D.clientX:D.pageX,this.clientY=D.clientY!==void 0?D.clientY:D.pageY,this.screenX=D.screenX||0,this.screenY=D.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=l.pointerType,this.state=l.state,this.i=l,l.defaultPrevented&&Q.Z.h.call(this)},Q.prototype.h=function(){Q.Z.h.call(this);const l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var I="closure_listenable_"+(Math.random()*1e6|0),V=0;function q(l,m,g,D,W){this.listener=l,this.proxy=null,this.src=m,this.type=g,this.capture=!!D,this.ha=W,this.key=++V,this.da=this.fa=!1}function A(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function F(l,m,g){for(const D in l)m.call(g,l[D],D,l)}function O(l,m){for(const g in l)m.call(void 0,l[g],g,l)}function z(l){const m={};for(const g in l)m[g]=l[g];return m}const $="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function G(l,m){let g,D;for(let W=1;W<arguments.length;W++){D=arguments[W];for(g in D)l[g]=D[g];for(let K=0;K<$.length;K++)g=$[K],Object.prototype.hasOwnProperty.call(D,g)&&(l[g]=D[g])}}function J(l){this.src=l,this.g={},this.h=0}J.prototype.add=function(l,m,g,D,W){const K=l.toString();l=this.g[K],l||(l=this.g[K]=[],this.h++);const le=de(l,m,D,W);return le>-1?(m=l[le],g||(m.fa=!1)):(m=new q(m,this.src,K,!!D,W),m.fa=g,l.push(m)),m};function ae(l,m){const g=m.type;if(g in l.g){var D=l.g[g],W=Array.prototype.indexOf.call(D,m,void 0),K;(K=W>=0)&&Array.prototype.splice.call(D,W,1),K&&(A(m),l.g[g].length==0&&(delete l.g[g],l.h--))}}function de(l,m,g,D){for(let W=0;W<l.length;++W){const K=l[W];if(!K.da&&K.listener==m&&K.capture==!!g&&K.ha==D)return W}return-1}var ie="closure_lm_"+(Math.random()*1e6|0),_e={};function Te(l,m,g,D,W){if(Array.isArray(m)){for(let K=0;K<m.length;K++)Te(l,m[K],g,D,W);return null}return g=re(g),l&&l[I]?l.J(m,g,c(D)?!!D.capture:!1,W):ge(l,m,g,!1,D,W)}function ge(l,m,g,D,W,K){if(!m)throw Error("Invalid event type");const le=c(W)?!!W.capture:!!W;let Re=te(l);if(Re||(l[ie]=Re=new J(l)),g=Re.add(m,g,D,le,K),g.proxy)return g;if(D=Pe(),g.proxy=D,D.src=l,D.listener=g,l.addEventListener)j||(W=le),W===void 0&&(W=!1),l.addEventListener(m.toString(),D,W);else if(l.attachEvent)l.attachEvent(Z(m.toString()),D);else if(l.addListener&&l.removeListener)l.addListener(D);else throw Error("addEventListener and attachEvent are unavailable.");return g}function Pe(){function l(g){return m.call(l.src,l.listener,g)}const m=H;return l}function xe(l,m,g,D,W){if(Array.isArray(m))for(var K=0;K<m.length;K++)xe(l,m[K],g,D,W);else D=c(D)?!!D.capture:!!D,g=re(g),l&&l[I]?(l=l.i,K=String(m).toString(),K in l.g&&(m=l.g[K],g=de(m,g,D,W),g>-1&&(A(m[g]),Array.prototype.splice.call(m,g,1),m.length==0&&(delete l.g[K],l.h--)))):l&&(l=te(l))&&(m=l.g[m.toString()],l=-1,m&&(l=de(m,g,D,W)),(g=l>-1?m[l]:null)&&U(g))}function U(l){if(typeof l!="number"&&l&&!l.da){var m=l.src;if(m&&m[I])ae(m.i,l);else{var g=l.type,D=l.proxy;m.removeEventListener?m.removeEventListener(g,D,l.capture):m.detachEvent?m.detachEvent(Z(g),D):m.addListener&&m.removeListener&&m.removeListener(D),(g=te(m))?(ae(g,l),g.h==0&&(g.src=null,m[ie]=null)):A(l)}}}function Z(l){return l in _e?_e[l]:_e[l]="on"+l}function H(l,m){if(l.da)l=!0;else{m=new Q(m,this);const g=l.listener,D=l.ha||l.src;l.fa&&U(l),l=g.call(D,m)}return l}function te(l){return l=l[ie],l instanceof J?l:null}var X="__closure_events_fn_"+(Math.random()*1e9>>>0);function re(l){return typeof l=="function"?l:(l[X]||(l[X]=function(m){return l.handleEvent(m)}),l[X])}function oe(){S.call(this),this.i=new J(this),this.M=this,this.G=null}f(oe,S),oe.prototype[I]=!0,oe.prototype.removeEventListener=function(l,m,g,D){xe(this,l,m,g,D)};function ue(l,m){var g,D=l.G;if(D)for(g=[];D;D=D.G)g.push(D);if(l=l.M,D=m.type||m,typeof m=="string")m=new E(m,l);else if(m instanceof E)m.target=m.target||l;else{var W=m;m=new E(D,l),G(m,W)}W=!0;let K,le;if(g)for(le=g.length-1;le>=0;le--)K=m.g=g[le],W=be(K,D,!0,m)&&W;if(K=m.g=l,W=be(K,D,!0,m)&&W,W=be(K,D,!1,m)&&W,g)for(le=0;le<g.length;le++)K=m.g=g[le],W=be(K,D,!1,m)&&W}oe.prototype.N=function(){if(oe.Z.N.call(this),this.i){var l=this.i;for(const m in l.g){const g=l.g[m];for(let D=0;D<g.length;D++)A(g[D]);delete l.g[m],l.h--}}this.G=null},oe.prototype.J=function(l,m,g,D){return this.i.add(String(l),m,!1,g,D)},oe.prototype.K=function(l,m,g,D){return this.i.add(String(l),m,!0,g,D)};function be(l,m,g,D){if(m=l.i.g[String(m)],!m)return!0;m=m.concat();let W=!0;for(let K=0;K<m.length;++K){const le=m[K];if(le&&!le.da&&le.capture==g){const Re=le.listener,Vt=le.ha||le.src;le.fa&&ae(l.i,le),W=Re.call(Vt,D)!==!1&&W}}return W&&!D.defaultPrevented}function De(l,m){if(typeof l!="function")if(l&&typeof l.handleEvent=="function")l=d(l.handleEvent,l);else throw Error("Invalid listener argument");return Number(m)>2147483647?-1:o.setTimeout(l,m||0)}function et(l){l.g=De(()=>{l.g=null,l.i&&(l.i=!1,et(l))},l.l);const m=l.h;l.h=null,l.m.apply(null,m)}class nn extends S{constructor(m,g){super(),this.m=m,this.l=g,this.h=null,this.i=!1,this.g=null}j(m){this.h=arguments,this.g?this.i=!0:et(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function st(l){S.call(this),this.h=l,this.g={}}f(st,S);var Qt=[];function me(l){F(l.g,function(m,g){this.g.hasOwnProperty(g)&&U(m)},l),l.g={}}st.prototype.N=function(){st.Z.N.call(this),me(this)},st.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Fe=o.JSON.stringify,ot=o.JSON.parse,Pt=class{stringify(l){return o.JSON.stringify(l,void 0)}parse(l){return o.JSON.parse(l,void 0)}};function Kn(){}function Nn(){}var rn={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function fn(){E.call(this,"d")}f(fn,E);function Is(){E.call(this,"c")}f(Is,E);var xr={},Vo=null;function kn(){return Vo=Vo||new oe}xr.Ia="serverreachability";function Lo(l){E.call(this,xr.Ia,l)}f(Lo,E);function ne(l){const m=kn();ue(m,new Lo(m))}xr.STAT_EVENT="statevent";function Ce(l,m){E.call(this,xr.STAT_EVENT,l),this.stat=m}f(Ce,E);function Ee(l){const m=kn();ue(m,new Ce(m,l))}xr.Ja="timingevent";function Xe(l,m){E.call(this,xr.Ja,l),this.size=m}f(Xe,E);function ye(l,m){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){l()},m)}function Be(){this.g=!0}Be.prototype.ua=function(){this.g=!1};function Oe(l,m,g,D,W,K){l.info(function(){if(l.g)if(K){var le="",Re=K.split("&");for(let rt=0;rt<Re.length;rt++){var Vt=Re[rt].split("=");if(Vt.length>1){const zt=Vt[0];Vt=Vt[1];const lr=zt.split("_");le=lr.length>=2&&lr[1]=="type"?le+(zt+"="+Vt+"&"):le+(zt+"=redacted&")}}}else le=null;else le=K;return"XMLHTTP REQ ("+D+") [attempt "+W+"]: "+m+`
`+g+`
`+le})}function mt(l,m,g,D,W,K,le){l.info(function(){return"XMLHTTP RESP ("+D+") [ attempt "+W+"]: "+m+`
`+g+`
`+K+" "+le})}function Kt(l,m,g,D){l.info(function(){return"XMLHTTP TEXT ("+m+"): "+ze(l,g)+(D?" "+D:"")})}function we(l,m){l.info(function(){return"TIMEOUT: "+m})}Be.prototype.info=function(){};function ze(l,m){if(!l.g)return m;if(!m)return null;try{const K=JSON.parse(m);if(K){for(l=0;l<K.length;l++)if(Array.isArray(K[l])){var g=K[l];if(!(g.length<2)){var D=g[1];if(Array.isArray(D)&&!(D.length<1)){var W=D[0];if(W!="noop"&&W!="stop"&&W!="close")for(let le=1;le<D.length;le++)D[le]=""}}}}return Fe(K)}catch{return m}}var Ge={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},nt={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},sr;function Ir(){}f(Ir,Kn),Ir.prototype.g=function(){return new XMLHttpRequest},sr=new Ir;function Cr(l){return encodeURIComponent(String(l))}function Cs(l){var m=1;l=l.split(":");const g=[];for(;m>0&&l.length;)g.push(l.shift()),m--;return l.length&&g.push(l.join(":")),g}function _n(l,m,g,D){this.j=l,this.i=m,this.l=g,this.S=D||1,this.V=new st(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Al}function Al(){this.i=null,this.g="",this.h=!1}var or={},pd={};function gd(l,m,g){l.M=1,l.A=kl(ar(m)),l.u=g,l.R=!0,hg(l,null)}function hg(l,m){l.F=Date.now(),Nl(l),l.B=ar(l.A);var g=l.B,D=l.S;Array.isArray(D)||(D=[String(D)]),xg(g.i,"t",D),l.C=0,g=l.j.L,l.h=new Al,l.g=$g(l.j,g?m:null,!l.u),l.P>0&&(l.O=new nn(d(l.Y,l,l.g),l.P)),m=l.V,g=l.g,D=l.ba;var W="readystatechange";Array.isArray(W)||(W&&(Qt[0]=W.toString()),W=Qt);for(let K=0;K<W.length;K++){const le=Te(g,W[K],D||m.handleEvent,!1,m.h||m);if(!le)break;m.g[le.key]=le}m=l.J?z(l.J):{},l.u?(l.v||(l.v="POST"),m["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.B,l.v,l.u,m)):(l.v="GET",l.g.ea(l.B,l.v,null,m)),ne(),Oe(l.i,l.v,l.B,l.l,l.S,l.u)}_n.prototype.ba=function(l){l=l.target;const m=this.O;m&&Kr(l)==3?m.j():this.Y(l)},_n.prototype.Y=function(l){try{if(l==this.g)e:{const Re=Kr(this.g),Vt=this.g.ya(),rt=this.g.ca();if(!(Re<3)&&(Re!=3||this.g&&(this.h.h||this.g.la()||Rg(this.g)))){this.K||Re!=4||Vt==7||(Vt==8||rt<=0?ne(3):ne(2)),yd(this);var m=this.g.ca();this.X=m;var g=YT(this);if(this.o=m==200,mt(this.i,this.v,this.B,this.l,this.S,Re,m),this.o){if(this.U&&!this.L){t:{if(this.g){var D,W=this.g;if((D=W.g?W.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(D)){var K=D;break t}}K=null}if(l=K)Kt(this.i,this.l,l,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,vd(this,l);else{this.o=!1,this.m=3,Ee(12),Hi(this),Fo(this);break e}}if(this.R){l=!0;let zt;for(;!this.K&&this.C<g.length;)if(zt=XT(this,g),zt==pd){Re==4&&(this.m=4,Ee(14),l=!1),Kt(this.i,this.l,null,"[Incomplete Response]");break}else if(zt==or){this.m=4,Ee(15),Kt(this.i,this.l,g,"[Invalid Chunk]"),l=!1;break}else Kt(this.i,this.l,zt,null),vd(this,zt);if(fg(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Re!=4||g.length!=0||this.h.h||(this.m=1,Ee(16),l=!1),this.o=this.o&&l,!l)Kt(this.i,this.l,g,"[Invalid Chunked Response]"),Hi(this),Fo(this);else if(g.length>0&&!this.W){this.W=!0;var le=this.j;le.g==this&&le.aa&&!le.P&&(le.j.info("Great, no buffering proxy detected. Bytes received: "+g.length),Id(le),le.P=!0,Ee(11))}}else Kt(this.i,this.l,g,null),vd(this,g);Re==4&&Hi(this),this.o&&!this.K&&(Re==4?Fg(this.j,this):(this.o=!1,Nl(this)))}else db(this.g),m==400&&g.indexOf("Unknown SID")>0?(this.m=3,Ee(12)):(this.m=0,Ee(13)),Hi(this),Fo(this)}}}catch{}finally{}};function YT(l){if(!fg(l))return l.g.la();const m=Rg(l.g);if(m==="")return"";let g="";const D=m.length,W=Kr(l.g)==4;if(!l.h.i){if(typeof TextDecoder>"u")return Hi(l),Fo(l),"";l.h.i=new o.TextDecoder}for(let K=0;K<D;K++)l.h.h=!0,g+=l.h.i.decode(m[K],{stream:!(W&&K==D-1)});return m.length=0,l.h.g+=g,l.C=0,l.h.g}function fg(l){return l.g?l.v=="GET"&&l.M!=2&&l.j.Aa:!1}function XT(l,m){var g=l.C,D=m.indexOf(`
`,g);return D==-1?pd:(g=Number(m.substring(g,D)),isNaN(g)?or:(D+=1,D+g>m.length?pd:(m=m.slice(D,D+g),l.C=D+g,m)))}_n.prototype.cancel=function(){this.K=!0,Hi(this)};function Nl(l){l.T=Date.now()+l.H,mg(l,l.H)}function mg(l,m){if(l.D!=null)throw Error("WatchDog timer not null");l.D=ye(d(l.aa,l),m)}function yd(l){l.D&&(o.clearTimeout(l.D),l.D=null)}_n.prototype.aa=function(){this.D=null;const l=Date.now();l-this.T>=0?(we(this.i,this.B),this.M!=2&&(ne(),Ee(17)),Hi(this),this.m=2,Fo(this)):mg(this,this.T-l)};function Fo(l){l.j.I==0||l.K||Fg(l.j,l)}function Hi(l){yd(l);var m=l.O;m&&typeof m.dispose=="function"&&m.dispose(),l.O=null,me(l.V),l.g&&(m=l.g,l.g=null,m.abort(),m.dispose())}function vd(l,m){try{var g=l.j;if(g.I!=0&&(g.g==l||_d(g.h,l))){if(!l.L&&_d(g.h,l)&&g.I==3){try{var D=g.Ba.g.parse(m)}catch{D=null}if(Array.isArray(D)&&D.length==3){var W=D;if(W[0]==0){e:if(!g.v){if(g.g)if(g.g.F+3e3<l.F)Ml(g),Dl(g);else break e;xd(g),Ee(18)}}else g.xa=W[1],0<g.xa-g.K&&W[2]<37500&&g.F&&g.A==0&&!g.C&&(g.C=ye(d(g.Va,g),6e3));yg(g.h)<=1&&g.ta&&(g.ta=void 0)}else qi(g,11)}else if((l.L||g.g==l)&&Ml(g),!k(m))for(W=g.Ba.g.parse(m),m=0;m<W.length;m++){let rt=W[m];const zt=rt[0];if(!(zt<=g.K))if(g.K=zt,rt=rt[1],g.I==2)if(rt[0]=="c"){g.M=rt[1],g.ba=rt[2];const lr=rt[3];lr!=null&&(g.ka=lr,g.j.info("VER="+g.ka));const Gi=rt[4];Gi!=null&&(g.za=Gi,g.j.info("SVER="+g.za));const Yr=rt[5];Yr!=null&&typeof Yr=="number"&&Yr>0&&(D=1.5*Yr,g.O=D,g.j.info("backChannelRequestTimeoutMs_="+D)),D=g;const Xr=l.g;if(Xr){const Vl=Xr.g?Xr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Vl){var K=D.h;K.g||Vl.indexOf("spdy")==-1&&Vl.indexOf("quic")==-1&&Vl.indexOf("h2")==-1||(K.j=K.l,K.g=new Set,K.h&&(wd(K,K.h),K.h=null))}if(D.G){const Cd=Xr.g?Xr.g.getResponseHeader("X-HTTP-Session-Id"):null;Cd&&(D.wa=Cd,lt(D.J,D.G,Cd))}}g.I=3,g.l&&g.l.ra(),g.aa&&(g.T=Date.now()-l.F,g.j.info("Handshake RTT: "+g.T+"ms")),D=g;var le=l;if(D.na=zg(D,D.L?D.ba:null,D.W),le.L){vg(D.h,le);var Re=le,Vt=D.O;Vt&&(Re.H=Vt),Re.D&&(yd(Re),Nl(Re)),D.g=le}else Vg(D);g.i.length>0&&jl(g)}else rt[0]!="stop"&&rt[0]!="close"||qi(g,7);else g.I==3&&(rt[0]=="stop"||rt[0]=="close"?rt[0]=="stop"?qi(g,7):bd(g):rt[0]!="noop"&&g.l&&g.l.qa(rt),g.A=0)}}ne(4)}catch{}}var JT=class{constructor(l,m){this.g=l,this.map=m}};function pg(l){this.l=l||10,o.PerformanceNavigationTiming?(l=o.performance.getEntriesByType("navigation"),l=l.length>0&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function gg(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function yg(l){return l.h?1:l.g?l.g.size:0}function _d(l,m){return l.h?l.h==m:l.g?l.g.has(m):!1}function wd(l,m){l.g?l.g.add(m):l.h=m}function vg(l,m){l.h&&l.h==m?l.h=null:l.g&&l.g.has(m)&&l.g.delete(m)}pg.prototype.cancel=function(){if(this.i=_g(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function _g(l){if(l.h!=null)return l.i.concat(l.h.G);if(l.g!=null&&l.g.size!==0){let m=l.i;for(const g of l.g.values())m=m.concat(g.G);return m}return v(l.i)}var wg=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ZT(l,m){if(l){l=l.split("&");for(let g=0;g<l.length;g++){const D=l[g].indexOf("=");let W,K=null;D>=0?(W=l[g].substring(0,D),K=l[g].substring(D+1)):W=l[g],m(W,K?decodeURIComponent(K.replace(/\+/g," ")):"")}}}function Gr(l){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let m;l instanceof Gr?(this.l=l.l,Uo(this,l.j),this.o=l.o,this.g=l.g,Bo(this,l.u),this.h=l.h,Sd(this,Ig(l.i)),this.m=l.m):l&&(m=String(l).match(wg))?(this.l=!1,Uo(this,m[1]||"",!0),this.o=zo(m[2]||""),this.g=zo(m[3]||"",!0),Bo(this,m[4]),this.h=zo(m[5]||"",!0),Sd(this,m[6]||"",!0),this.m=zo(m[7]||"")):(this.l=!1,this.i=new Ho(null,this.l))}Gr.prototype.toString=function(){const l=[];var m=this.j;m&&l.push($o(m,Sg,!0),":");var g=this.g;return(g||m=="file")&&(l.push("//"),(m=this.o)&&l.push($o(m,Sg,!0),"@"),l.push(Cr(g).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.u,g!=null&&l.push(":",String(g))),(g=this.h)&&(this.g&&g.charAt(0)!="/"&&l.push("/"),l.push($o(g,g.charAt(0)=="/"?nb:tb,!0))),(g=this.i.toString())&&l.push("?",g),(g=this.m)&&l.push("#",$o(g,ib)),l.join("")},Gr.prototype.resolve=function(l){const m=ar(this);let g=!!l.j;g?Uo(m,l.j):g=!!l.o,g?m.o=l.o:g=!!l.g,g?m.g=l.g:g=l.u!=null;var D=l.h;if(g)Bo(m,l.u);else if(g=!!l.h){if(D.charAt(0)!="/")if(this.g&&!this.h)D="/"+D;else{var W=m.h.lastIndexOf("/");W!=-1&&(D=m.h.slice(0,W+1)+D)}if(W=D,W==".."||W==".")D="";else if(W.indexOf("./")!=-1||W.indexOf("/.")!=-1){D=W.lastIndexOf("/",0)==0,W=W.split("/");const K=[];for(let le=0;le<W.length;){const Re=W[le++];Re=="."?D&&le==W.length&&K.push(""):Re==".."?((K.length>1||K.length==1&&K[0]!="")&&K.pop(),D&&le==W.length&&K.push("")):(K.push(Re),D=!0)}D=K.join("/")}else D=W}return g?m.h=D:g=l.i.toString()!=="",g?Sd(m,Ig(l.i)):g=!!l.m,g&&(m.m=l.m),m};function ar(l){return new Gr(l)}function Uo(l,m,g){l.j=g?zo(m,!0):m,l.j&&(l.j=l.j.replace(/:$/,""))}function Bo(l,m){if(m){if(m=Number(m),isNaN(m)||m<0)throw Error("Bad port number "+m);l.u=m}else l.u=null}function Sd(l,m,g){m instanceof Ho?(l.i=m,sb(l.i,l.l)):(g||(m=$o(m,rb)),l.i=new Ho(m,l.l))}function lt(l,m,g){l.i.set(m,g)}function kl(l){return lt(l,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),l}function zo(l,m){return l?m?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function $o(l,m,g){return typeof l=="string"?(l=encodeURI(l).replace(m,eb),g&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function eb(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var Sg=/[#\/\?@]/g,tb=/[#\?:]/g,nb=/[#\?]/g,rb=/[#\?@]/g,ib=/#/g;function Ho(l,m){this.h=this.g=null,this.i=l||null,this.j=!!m}function Wi(l){l.g||(l.g=new Map,l.h=0,l.i&&ZT(l.i,function(m,g){l.add(decodeURIComponent(m.replace(/\+/g," ")),g)}))}t=Ho.prototype,t.add=function(l,m){Wi(this),this.i=null,l=As(this,l);let g=this.g.get(l);return g||this.g.set(l,g=[]),g.push(m),this.h+=1,this};function Eg(l,m){Wi(l),m=As(l,m),l.g.has(m)&&(l.i=null,l.h-=l.g.get(m).length,l.g.delete(m))}function Tg(l,m){return Wi(l),m=As(l,m),l.g.has(m)}t.forEach=function(l,m){Wi(this),this.g.forEach(function(g,D){g.forEach(function(W){l.call(m,W,D,this)},this)},this)};function bg(l,m){Wi(l);let g=[];if(typeof m=="string")Tg(l,m)&&(g=g.concat(l.g.get(As(l,m))));else for(l=Array.from(l.g.values()),m=0;m<l.length;m++)g=g.concat(l[m]);return g}t.set=function(l,m){return Wi(this),this.i=null,l=As(this,l),Tg(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[m]),this.h+=1,this},t.get=function(l,m){return l?(l=bg(this,l),l.length>0?String(l[0]):m):m};function xg(l,m,g){Eg(l,m),g.length>0&&(l.i=null,l.g.set(As(l,m),v(g)),l.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],m=Array.from(this.g.keys());for(let D=0;D<m.length;D++){var g=m[D];const W=Cr(g);g=bg(this,g);for(let K=0;K<g.length;K++){let le=W;g[K]!==""&&(le+="="+Cr(g[K])),l.push(le)}}return this.i=l.join("&")};function Ig(l){const m=new Ho;return m.i=l.i,l.g&&(m.g=new Map(l.g),m.h=l.h),m}function As(l,m){return m=String(m),l.j&&(m=m.toLowerCase()),m}function sb(l,m){m&&!l.j&&(Wi(l),l.i=null,l.g.forEach(function(g,D){const W=D.toLowerCase();D!=W&&(Eg(this,D),xg(this,W,g))},l)),l.j=m}function ob(l,m){const g=new Be;if(o.Image){const D=new Image;D.onload=h(Qr,g,"TestLoadImage: loaded",!0,m,D),D.onerror=h(Qr,g,"TestLoadImage: error",!1,m,D),D.onabort=h(Qr,g,"TestLoadImage: abort",!1,m,D),D.ontimeout=h(Qr,g,"TestLoadImage: timeout",!1,m,D),o.setTimeout(function(){D.ontimeout&&D.ontimeout()},1e4),D.src=l}else m(!1)}function ab(l,m){const g=new Be,D=new AbortController,W=setTimeout(()=>{D.abort(),Qr(g,"TestPingServer: timeout",!1,m)},1e4);fetch(l,{signal:D.signal}).then(K=>{clearTimeout(W),K.ok?Qr(g,"TestPingServer: ok",!0,m):Qr(g,"TestPingServer: server error",!1,m)}).catch(()=>{clearTimeout(W),Qr(g,"TestPingServer: error",!1,m)})}function Qr(l,m,g,D,W){try{W&&(W.onload=null,W.onerror=null,W.onabort=null,W.ontimeout=null),D(g)}catch{}}function lb(){this.g=new Pt}function Ed(l){this.i=l.Sb||null,this.h=l.ab||!1}f(Ed,Kn),Ed.prototype.g=function(){return new Pl(this.i,this.h)};function Pl(l,m){oe.call(this),this.H=l,this.o=m,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(Pl,oe),t=Pl.prototype,t.open=function(l,m){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=l,this.D=m,this.readyState=1,qo(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const m={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};l&&(m.body=l),(this.H||o).fetch(new Request(this.D,m)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Wo(this)),this.readyState=0},t.Pa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,qo(this)),this.g&&(this.readyState=3,qo(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Cg(this)}else l.text().then(this.Oa.bind(this),this.ga.bind(this))};function Cg(l){l.j.read().then(l.Ma.bind(l)).catch(l.ga.bind(l))}t.Ma=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var m=l.value?l.value:new Uint8Array(0);(m=this.B.decode(m,{stream:!l.done}))&&(this.response=this.responseText+=m)}l.done?Wo(this):qo(this),this.readyState==3&&Cg(this)}},t.Oa=function(l){this.g&&(this.response=this.responseText=l,Wo(this))},t.Na=function(l){this.g&&(this.response=l,Wo(this))},t.ga=function(){this.g&&Wo(this)};function Wo(l){l.readyState=4,l.l=null,l.j=null,l.B=null,qo(l)}t.setRequestHeader=function(l,m){this.A.append(l,m)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],m=this.h.entries();for(var g=m.next();!g.done;)g=g.value,l.push(g[0]+": "+g[1]),g=m.next();return l.join(`\r
`)};function qo(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(Pl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function Ag(l){let m="";return F(l,function(g,D){m+=D,m+=":",m+=g,m+=`\r
`}),m}function Td(l,m,g){e:{for(D in g){var D=!1;break e}D=!0}D||(g=Ag(g),typeof l=="string"?g!=null&&Cr(g):lt(l,m,g))}function St(l){oe.call(this),this.headers=new Map,this.L=l||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(St,oe);var cb=/^https?$/i,ub=["POST","PUT"];t=St.prototype,t.Fa=function(l){this.H=l},t.ea=function(l,m,g,D){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);m=m?m.toUpperCase():"GET",this.D=l,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():sr.g(),this.g.onreadystatechange=p(d(this.Ca,this));try{this.B=!0,this.g.open(m,String(l),!0),this.B=!1}catch(K){Ng(this,K);return}if(l=g||"",g=new Map(this.headers),D)if(Object.getPrototypeOf(D)===Object.prototype)for(var W in D)g.set(W,D[W]);else if(typeof D.keys=="function"&&typeof D.get=="function")for(const K of D.keys())g.set(K,D.get(K));else throw Error("Unknown input type for opt_headers: "+String(D));D=Array.from(g.keys()).find(K=>K.toLowerCase()=="content-type"),W=o.FormData&&l instanceof o.FormData,!(Array.prototype.indexOf.call(ub,m,void 0)>=0)||D||W||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[K,le]of g)this.g.setRequestHeader(K,le);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(l),this.v=!1}catch(K){Ng(this,K)}};function Ng(l,m){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=m,l.o=5,kg(l),Rl(l)}function kg(l){l.A||(l.A=!0,ue(l,"complete"),ue(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=l||7,ue(this,"complete"),ue(this,"abort"),Rl(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Rl(this,!0)),St.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?Pg(this):this.Xa())},t.Xa=function(){Pg(this)};function Pg(l){if(l.h&&typeof s<"u"){if(l.v&&Kr(l)==4)setTimeout(l.Ca.bind(l),0);else if(ue(l,"readystatechange"),Kr(l)==4){l.h=!1;try{const K=l.ca();e:switch(K){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var m=!0;break e;default:m=!1}var g;if(!(g=m)){var D;if(D=K===0){let le=String(l.D).match(wg)[1]||null;!le&&o.self&&o.self.location&&(le=o.self.location.protocol.slice(0,-1)),D=!cb.test(le?le.toLowerCase():"")}g=D}if(g)ue(l,"complete"),ue(l,"success");else{l.o=6;try{var W=Kr(l)>2?l.g.statusText:""}catch{W=""}l.l=W+" ["+l.ca()+"]",kg(l)}}finally{Rl(l)}}}}function Rl(l,m){if(l.g){l.m&&(clearTimeout(l.m),l.m=null);const g=l.g;l.g=null,m||ue(l,"ready");try{g.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Kr(l){return l.g?l.g.readyState:0}t.ca=function(){try{return Kr(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(l){if(this.g){var m=this.g.responseText;return l&&m.indexOf(l)==0&&(m=m.substring(l.length)),ot(m)}};function Rg(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.F){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function db(l){const m={};l=(l.g&&Kr(l)>=2&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let D=0;D<l.length;D++){if(k(l[D]))continue;var g=Cs(l[D]);const W=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const K=m[W]||[];m[W]=K,K.push(g)}O(m,function(D){return D.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Go(l,m,g){return g&&g.internalChannelParams&&g.internalChannelParams[l]||m}function Dg(l){this.za=0,this.i=[],this.j=new Be,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Go("failFast",!1,l),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Go("baseRetryDelayMs",5e3,l),this.Za=Go("retryDelaySeedMs",1e4,l),this.Ta=Go("forwardChannelMaxRetries",2,l),this.va=Go("forwardChannelRequestTimeoutMs",2e4,l),this.ma=l&&l.xmlHttpFactory||void 0,this.Ua=l&&l.Rb||void 0,this.Aa=l&&l.useFetchStreams||!1,this.O=void 0,this.L=l&&l.supportsCrossDomainXhr||!1,this.M="",this.h=new pg(l&&l.concurrentRequestLimit),this.Ba=new lb,this.S=l&&l.fastHandshake||!1,this.R=l&&l.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=l&&l.Pb||!1,l&&l.ua&&this.j.ua(),l&&l.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&l&&l.detectBufferingProxy||!1,this.ia=void 0,l&&l.longPollingTimeout&&l.longPollingTimeout>0&&(this.ia=l.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Dg.prototype,t.ka=8,t.I=1,t.connect=function(l,m,g,D){Ee(0),this.W=l,this.H=m||{},g&&D!==void 0&&(this.H.OSID=g,this.H.OAID=D),this.F=this.X,this.J=zg(this,null,this.W),jl(this)};function bd(l){if(jg(l),l.I==3){var m=l.V++,g=ar(l.J);if(lt(g,"SID",l.M),lt(g,"RID",m),lt(g,"TYPE","terminate"),Qo(l,g),m=new _n(l,l.j,m),m.M=2,m.A=kl(ar(g)),g=!1,o.navigator&&o.navigator.sendBeacon)try{g=o.navigator.sendBeacon(m.A.toString(),"")}catch{}!g&&o.Image&&(new Image().src=m.A,g=!0),g||(m.g=$g(m.j,null),m.g.ea(m.A)),m.F=Date.now(),Nl(m)}Bg(l)}function Dl(l){l.g&&(Id(l),l.g.cancel(),l.g=null)}function jg(l){Dl(l),l.v&&(o.clearTimeout(l.v),l.v=null),Ml(l),l.h.cancel(),l.m&&(typeof l.m=="number"&&o.clearTimeout(l.m),l.m=null)}function jl(l){if(!gg(l.h)&&!l.m){l.m=!0;var m=l.Ea;L||b(),B||(L(),B=!0),C.add(m,l),l.D=0}}function hb(l,m){return yg(l.h)>=l.h.j-(l.m?1:0)?!1:l.m?(l.i=m.G.concat(l.i),!0):l.I==1||l.I==2||l.D>=(l.Sa?0:l.Ta)?!1:(l.m=ye(d(l.Ea,l,m),Ug(l,l.D)),l.D++,!0)}t.Ea=function(l){if(this.m)if(this.m=null,this.I==1){if(!l){this.V=Math.floor(Math.random()*1e5),l=this.V++;const W=new _n(this,this.j,l);let K=this.o;if(this.U&&(K?(K=z(K),G(K,this.U)):K=this.U),this.u!==null||this.R||(W.J=K,K=null),this.S)e:{for(var m=0,g=0;g<this.i.length;g++){t:{var D=this.i[g];if("__data__"in D.map&&(D=D.map.__data__,typeof D=="string")){D=D.length;break t}D=void 0}if(D===void 0)break;if(m+=D,m>4096){m=g;break e}if(m===4096||g===this.i.length-1){m=g+1;break e}}m=1e3}else m=1e3;m=Og(this,W,m),g=ar(this.J),lt(g,"RID",l),lt(g,"CVER",22),this.G&&lt(g,"X-HTTP-Session-Id",this.G),Qo(this,g),K&&(this.R?m="headers="+Cr(Ag(K))+"&"+m:this.u&&Td(g,this.u,K)),wd(this.h,W),this.Ra&&lt(g,"TYPE","init"),this.S?(lt(g,"$req",m),lt(g,"SID","null"),W.U=!0,gd(W,g,null)):gd(W,g,m),this.I=2}}else this.I==3&&(l?Mg(this,l):this.i.length==0||gg(this.h)||Mg(this))};function Mg(l,m){var g;m?g=m.l:g=l.V++;const D=ar(l.J);lt(D,"SID",l.M),lt(D,"RID",g),lt(D,"AID",l.K),Qo(l,D),l.u&&l.o&&Td(D,l.u,l.o),g=new _n(l,l.j,g,l.D+1),l.u===null&&(g.J=l.o),m&&(l.i=m.G.concat(l.i)),m=Og(l,g,1e3),g.H=Math.round(l.va*.5)+Math.round(l.va*.5*Math.random()),wd(l.h,g),gd(g,D,m)}function Qo(l,m){l.H&&F(l.H,function(g,D){lt(m,D,g)}),l.l&&F({},function(g,D){lt(m,D,g)})}function Og(l,m,g){g=Math.min(l.i.length,g);const D=l.l?d(l.l.Ka,l.l,l):null;e:{var W=l.i;let Re=-1;for(;;){const Vt=["count="+g];Re==-1?g>0?(Re=W[0].g,Vt.push("ofs="+Re)):Re=0:Vt.push("ofs="+Re);let rt=!0;for(let zt=0;zt<g;zt++){var K=W[zt].g;const lr=W[zt].map;if(K-=Re,K<0)Re=Math.max(0,W[zt].g-100),rt=!1;else try{K="req"+K+"_"||"";try{var le=lr instanceof Map?lr:Object.entries(lr);for(const[Gi,Yr]of le){let Xr=Yr;c(Yr)&&(Xr=Fe(Yr)),Vt.push(K+Gi+"="+encodeURIComponent(Xr))}}catch(Gi){throw Vt.push(K+"type="+encodeURIComponent("_badmap")),Gi}}catch{D&&D(lr)}}if(rt){le=Vt.join("&");break e}}le=void 0}return l=l.i.splice(0,g),m.G=l,le}function Vg(l){if(!l.g&&!l.v){l.Y=1;var m=l.Da;L||b(),B||(L(),B=!0),C.add(m,l),l.A=0}}function xd(l){return l.g||l.v||l.A>=3?!1:(l.Y++,l.v=ye(d(l.Da,l),Ug(l,l.A)),l.A++,!0)}t.Da=function(){if(this.v=null,Lg(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var l=4*this.T;this.j.info("BP detection timer enabled: "+l),this.B=ye(d(this.Wa,this),l)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ee(10),Dl(this),Lg(this))};function Id(l){l.B!=null&&(o.clearTimeout(l.B),l.B=null)}function Lg(l){l.g=new _n(l,l.j,"rpc",l.Y),l.u===null&&(l.g.J=l.o),l.g.P=0;var m=ar(l.na);lt(m,"RID","rpc"),lt(m,"SID",l.M),lt(m,"AID",l.K),lt(m,"CI",l.F?"0":"1"),!l.F&&l.ia&&lt(m,"TO",l.ia),lt(m,"TYPE","xmlhttp"),Qo(l,m),l.u&&l.o&&Td(m,l.u,l.o),l.O&&(l.g.H=l.O);var g=l.g;l=l.ba,g.M=1,g.A=kl(ar(m)),g.u=null,g.R=!0,hg(g,l)}t.Va=function(){this.C!=null&&(this.C=null,Dl(this),xd(this),Ee(19))};function Ml(l){l.C!=null&&(o.clearTimeout(l.C),l.C=null)}function Fg(l,m){var g=null;if(l.g==m){Ml(l),Id(l),l.g=null;var D=2}else if(_d(l.h,m))g=m.G,vg(l.h,m),D=1;else return;if(l.I!=0){if(m.o)if(D==1){g=m.u?m.u.length:0,m=Date.now()-m.F;var W=l.D;D=kn(),ue(D,new Xe(D,g)),jl(l)}else Vg(l);else if(W=m.m,W==3||W==0&&m.X>0||!(D==1&&hb(l,m)||D==2&&xd(l)))switch(g&&g.length>0&&(m=l.h,m.i=m.i.concat(g)),W){case 1:qi(l,5);break;case 4:qi(l,10);break;case 3:qi(l,6);break;default:qi(l,2)}}}function Ug(l,m){let g=l.Qa+Math.floor(Math.random()*l.Za);return l.isActive()||(g*=2),g*m}function qi(l,m){if(l.j.info("Error code "+m),m==2){var g=d(l.bb,l),D=l.Ua;const W=!D;D=new Gr(D||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Uo(D,"https"),kl(D),W?ob(D.toString(),g):ab(D.toString(),g)}else Ee(2);l.I=0,l.l&&l.l.pa(m),Bg(l),jg(l)}t.bb=function(l){l?(this.j.info("Successfully pinged google.com"),Ee(2)):(this.j.info("Failed to ping google.com"),Ee(1))};function Bg(l){if(l.I=0,l.ja=[],l.l){const m=_g(l.h);(m.length!=0||l.i.length!=0)&&(x(l.ja,m),x(l.ja,l.i),l.h.i.length=0,v(l.i),l.i.length=0),l.l.oa()}}function zg(l,m,g){var D=g instanceof Gr?ar(g):new Gr(g);if(D.g!="")m&&(D.g=m+"."+D.g),Bo(D,D.u);else{var W=o.location;D=W.protocol,m=m?m+"."+W.hostname:W.hostname,W=+W.port;const K=new Gr(null);D&&Uo(K,D),m&&(K.g=m),W&&Bo(K,W),g&&(K.h=g),D=K}return g=l.G,m=l.wa,g&&m&&lt(D,g,m),lt(D,"VER",l.ka),Qo(l,D),D}function $g(l,m,g){if(m&&!l.L)throw Error("Can't create secondary domain capable XhrIo object.");return m=l.Aa&&!l.ma?new St(new Ed({ab:g})):new St(l.ma),m.Fa(l.L),m}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Hg(){}t=Hg.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Ol(){}Ol.prototype.g=function(l,m){return new Pn(l,m)};function Pn(l,m){oe.call(this),this.g=new Dg(m),this.l=l,this.h=m&&m.messageUrlParams||null,l=m&&m.messageHeaders||null,m&&m.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=m&&m.initMessageHeaders||null,m&&m.messageContentType&&(l?l["X-WebChannel-Content-Type"]=m.messageContentType:l={"X-WebChannel-Content-Type":m.messageContentType}),m&&m.sa&&(l?l["X-WebChannel-Client-Profile"]=m.sa:l={"X-WebChannel-Client-Profile":m.sa}),this.g.U=l,(l=m&&m.Qb)&&!k(l)&&(this.g.u=l),this.A=m&&m.supportsCrossDomainXhr||!1,this.v=m&&m.sendRawJson||!1,(m=m&&m.httpSessionIdParam)&&!k(m)&&(this.g.G=m,l=this.h,l!==null&&m in l&&(l=this.h,m in l&&delete l[m])),this.j=new Ns(this)}f(Pn,oe),Pn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Pn.prototype.close=function(){bd(this.g)},Pn.prototype.o=function(l){var m=this.g;if(typeof l=="string"){var g={};g.__data__=l,l=g}else this.v&&(g={},g.__data__=Fe(l),l=g);m.i.push(new JT(m.Ya++,l)),m.I==3&&jl(m)},Pn.prototype.N=function(){this.g.l=null,delete this.j,bd(this.g),delete this.g,Pn.Z.N.call(this)};function Wg(l){fn.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var m=l.__sm__;if(m){e:{for(const g in m){l=g;break e}l=void 0}(this.i=l)&&(l=this.i,m=m!==null&&l in m?m[l]:void 0),this.data=m}else this.data=l}f(Wg,fn);function qg(){Is.call(this),this.status=1}f(qg,Is);function Ns(l){this.g=l}f(Ns,Hg),Ns.prototype.ra=function(){ue(this.g,"a")},Ns.prototype.qa=function(l){ue(this.g,new Wg(l))},Ns.prototype.pa=function(l){ue(this.g,new qg)},Ns.prototype.oa=function(){ue(this.g,"b")},Ol.prototype.createWebChannel=Ol.prototype.g,Pn.prototype.send=Pn.prototype.o,Pn.prototype.open=Pn.prototype.m,Pn.prototype.close=Pn.prototype.close,n1=function(){return new Ol},t1=function(){return kn()},e1=xr,Rf={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Ge.NO_ERROR=0,Ge.TIMEOUT=8,Ge.HTTP_ERROR=6,Nc=Ge,nt.COMPLETE="complete",ZS=nt,Nn.EventType=rn,rn.OPEN="a",rn.CLOSE="b",rn.ERROR="c",rn.MESSAGE="d",oe.prototype.listen=oe.prototype.J,fa=Nn,St.prototype.listenOnce=St.prototype.K,St.prototype.getLastError=St.prototype.Ha,St.prototype.getLastErrorCode=St.prototype.ya,St.prototype.getStatus=St.prototype.ca,St.prototype.getResponseJson=St.prototype.La,St.prototype.getResponseText=St.prototype.la,St.prototype.send=St.prototype.ea,St.prototype.setWithCredentials=St.prototype.Fa,JS=St}).apply(typeof tc<"u"?tc:typeof self<"u"?self:typeof window<"u"?window:{});const Tv="@firebase/firestore",bv="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ln.UNAUTHENTICATED=new ln(null),ln.GOOGLE_CREDENTIALS=new ln("google-credentials-uid"),ln.FIRST_PARTY=new ln("first-party-uid"),ln.MOCK_USER=new ln("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ro="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hs=new BS("@firebase/firestore");function Ms(){return hs.logLevel}function he(t,...e){if(hs.logLevel<=He.DEBUG){const n=e.map(hp);hs.debug(`Firestore (${Ro}): ${t}`,...n)}}function zr(t,...e){if(hs.logLevel<=He.ERROR){const n=e.map(hp);hs.error(`Firestore (${Ro}): ${t}`,...n)}}function _o(t,...e){if(hs.logLevel<=He.WARN){const n=e.map(hp);hs.warn(`Firestore (${Ro}): ${t}`,...n)}}function hp(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Se(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,r1(t,r,n)}function r1(t,e,n){let r=`FIRESTORE (${Ro}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw zr(r),new Error(r)}function Ye(t,e,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,t||r1(e,i,r)}function Ae(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ce extends Es{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i1{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class DN{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(ln.UNAUTHENTICATED))}shutdown(){}}class jN{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class MN{constructor(e){this.t=e,this.currentUser=ln.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Ye(this.o===void 0,42304);let r=this.i;const i=a=>this.i!==r?(r=this.i,n(a)):Promise.resolve();let s=new Or;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Or,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const a=s;e.enqueueRetryable(async()=>{await a.promise,await i(this.currentUser)})},c=a=>{he("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=a,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(a=>c(a)),setTimeout(()=>{if(!this.auth){const a=this.t.getImmediate({optional:!0});a?c(a):(he("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Or)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(he("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ye(typeof r.accessToken=="string",31837,{l:r}),new i1(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ye(e===null||typeof e=="string",2055,{h:e}),new ln(e)}}class ON{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=ln.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class VN{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new ON(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(ln.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class xv{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class LN{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,qS(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Ye(this.o===void 0,3512);const r=s=>{s.error!=null&&he("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,he("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{he("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):he("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new xv(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Ye(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new xv(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FN(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fp{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=FN(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%62))}return r}}function Ve(t,e){return t<e?-1:t>e?1:0}function Df(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const i=t.charAt(r),s=e.charAt(r);if(i!==s)return sh(i)===sh(s)?Ve(i,s):sh(i)?1:-1}return Ve(t.length,e.length)}const UN=55296,BN=57343;function sh(t){const e=t.charCodeAt(0);return e>=UN&&e<=BN}function wo(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iv="__name__";class hr{constructor(e,n,r){n===void 0?n=0:n>e.length&&Se(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&Se(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return hr.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof hr?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=hr.compareSegments(e.get(i),n.get(i));if(s!==0)return s}return Ve(e.length,n.length)}static compareSegments(e,n){const r=hr.isNumericId(e),i=hr.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?hr.extractNumericId(e).compare(hr.extractNumericId(n)):Df(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ii.fromString(e.substring(4,e.length-2))}}class it extends hr{construct(e,n,r){return new it(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new ce(Y.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new it(n)}static emptyPath(){return new it([])}}const zN=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Jt extends hr{construct(e,n,r){return new Jt(e,n,r)}static isValidIdentifier(e){return zN.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Jt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Iv}static keyField(){return new Jt([Iv])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new ce(Y.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const c=e[i];if(c==="\\"){if(i+1===e.length)throw new ce(Y.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const a=e[i+1];if(a!=="\\"&&a!=="."&&a!=="`")throw new ce(Y.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=a,i+=2}else c==="`"?(o=!o,i++):c!=="."||o?(r+=c,i++):(s(),i++)}if(s(),o)throw new ce(Y.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Jt(n)}static emptyPath(){return new Jt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ve{constructor(e){this.path=e}static fromPath(e){return new ve(it.fromString(e))}static fromName(e){return new ve(it.fromString(e).popFirst(5))}static empty(){return new ve(it.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&it.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return it.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ve(new it(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s1(t,e,n){if(!n)throw new ce(Y.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function $N(t,e,n,r){if(e===!0&&r===!0)throw new ce(Y.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Cv(t){if(!ve.isDocumentKey(t))throw new ce(Y.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Av(t){if(ve.isDocumentKey(t))throw new ce(Y.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function o1(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Wu(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Se(12329,{type:typeof t})}function Er(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ce(Y.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Wu(t);throw new ce(Y.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function HN(t,e){if(e<=0)throw new ce(Y.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ot(t,e){const n={typeString:t};return e&&(n.value=e),n}function vl(t,e){if(!o1(t))throw new ce(Y.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new ce(Y.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nv=-62135596800,kv=1e6;class ut{static now(){return ut.fromMillis(Date.now())}static fromDate(e){return ut.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*kv);return new ut(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ce(Y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ce(Y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<Nv)throw new ce(Y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ce(Y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/kv}_compareTo(e){return this.seconds===e.seconds?Ve(this.nanoseconds,e.nanoseconds):Ve(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ut._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(vl(e,ut._jsonSchema))return new ut(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Nv;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ut._jsonSchemaVersion="firestore/timestamp/1.0",ut._jsonSchema={type:Ot("string",ut._jsonSchemaVersion),seconds:Ot("number"),nanoseconds:Ot("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ie{static fromTimestamp(e){return new Ie(e)}static min(){return new Ie(new ut(0,0))}static max(){return new Ie(new ut(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nl=-1;function WN(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=Ie.fromTimestamp(r===1e9?new ut(n+1,0):new ut(n,r));return new ki(i,ve.empty(),e)}function qN(t){return new ki(t.readTime,t.key,nl)}class ki{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new ki(Ie.min(),ve.empty(),nl)}static max(){return new ki(Ie.max(),ve.empty(),nl)}}function GN(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ve.comparator(t.documentKey,e.documentKey),n!==0?n:Ve(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class KN{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Do(t){if(t.code!==Y.FAILED_PRECONDITION||t.message!==QN)throw t;he("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ee{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Se(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new ee((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof ee?n:ee.resolve(n)}catch(n){return ee.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):ee.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):ee.reject(n)}static resolve(e){return new ee((n,r)=>{n(e)})}static reject(e){return new ee((n,r)=>{r(e)})}static waitFor(e){return new ee((n,r)=>{let i=0,s=0,o=!1;e.forEach(c=>{++i,c.next(()=>{++s,o&&s===i&&n()},a=>r(a))}),o=!0,s===i&&n()})}static or(e){let n=ee.resolve(!1);for(const r of e)n=n.next(i=>i?ee.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new ee((r,i)=>{const s=e.length,o=new Array(s);let c=0;for(let a=0;a<s;a++){const d=a;n(e[d]).next(h=>{o[d]=h,++c,c===s&&r(o)},h=>i(h))}})}static doWhile(e,n){return new ee((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}function YN(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function jo(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qu{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}qu.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mp=-1;function Gu(t){return t==null}function du(t){return t===0&&1/t==-1/0}function XN(t){return typeof t=="number"&&Number.isInteger(t)&&!du(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a1="";function JN(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Pv(e)),e=ZN(t.get(n),e);return Pv(e)}function ZN(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case a1:n+="";break;default:n+=s}}return n}function Pv(t){return t+a1+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rv(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Bi(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function l1(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wt{constructor(e,n){this.comparator=e,this.root=n||Xt.EMPTY}insert(e,n){return new wt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Xt.BLACK,null,null))}remove(e){return new wt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Xt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new nc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new nc(this.root,e,this.comparator,!1)}getReverseIterator(){return new nc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new nc(this.root,e,this.comparator,!0)}}class nc{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Xt{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Xt.RED,this.left=i??Xt.EMPTY,this.right=s??Xt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Xt(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Xt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Xt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Xt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Xt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Se(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Se(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Se(27949);return e+(this.isRed()?0:1)}}Xt.EMPTY=null,Xt.RED=!0,Xt.BLACK=!1;Xt.EMPTY=new class{constructor(){this.size=0}get key(){throw Se(57766)}get value(){throw Se(16141)}get color(){throw Se(16727)}get left(){throw Se(29726)}get right(){throw Se(36894)}copy(e,n,r,i,s){return this}insert(e,n,r){return new Xt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(e){this.comparator=e,this.data=new wt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Dv(this.data.getIterator())}getIteratorFrom(e){return new Dv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Bt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Bt(this.comparator);return n.data=e,n}}class Dv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mn{constructor(e){this.fields=e,e.sort(Jt.comparator)}static empty(){return new Mn([])}unionWith(e){let n=new Bt(Jt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Mn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return wo(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c1 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new c1("Invalid base64 string: "+s):s}}(e);return new tn(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new tn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ve(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}tn.EMPTY_BYTE_STRING=new tn("");const ek=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Pi(t){if(Ye(!!t,39018),typeof t=="string"){let e=0;const n=ek.exec(t);if(Ye(!!n,46558,{timestamp:t}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:At(t.seconds),nanos:At(t.nanos)}}function At(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ri(t){return typeof t=="string"?tn.fromBase64String(t):tn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u1="server_timestamp",d1="__type__",h1="__previous_value__",f1="__local_write_time__";function Qu(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[d1])==null?void 0:r.stringValue)===u1}function Ku(t){const e=t.mapValue.fields[h1];return Qu(e)?Ku(e):e}function rl(t){const e=Pi(t.mapValue.fields[f1].timestampValue);return new ut(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tk{constructor(e,n,r,i,s,o,c,a,d,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=a,this.useFetchStreams=d,this.isUsingEmulator=h}}const hu="(default)";class il{constructor(e,n){this.projectId=e,this.database=n||hu}static empty(){return new il("","")}get isDefaultDatabase(){return this.database===hu}isEqual(e){return e instanceof il&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m1="__type__",nk="__max__",rc={mapValue:{}},p1="__vector__",fu="value";function Di(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Qu(t)?4:ik(t)?9007199254740991:rk(t)?10:11:Se(28295,{value:t})}function Tr(t,e){if(t===e)return!0;const n=Di(t);if(n!==Di(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return rl(t).isEqual(rl(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Pi(i.timestampValue),c=Pi(s.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Ri(i.bytesValue).isEqual(Ri(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return At(i.geoPointValue.latitude)===At(s.geoPointValue.latitude)&&At(i.geoPointValue.longitude)===At(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return At(i.integerValue)===At(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=At(i.doubleValue),c=At(s.doubleValue);return o===c?du(o)===du(c):isNaN(o)&&isNaN(c)}return!1}(t,e);case 9:return wo(t.arrayValue.values||[],e.arrayValue.values||[],Tr);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},c=s.mapValue.fields||{};if(Rv(o)!==Rv(c))return!1;for(const a in o)if(o.hasOwnProperty(a)&&(c[a]===void 0||!Tr(o[a],c[a])))return!1;return!0}(t,e);default:return Se(52216,{left:t})}}function sl(t,e){return(t.values||[]).find(n=>Tr(n,e))!==void 0}function So(t,e){if(t===e)return 0;const n=Di(t),r=Di(e);if(n!==r)return Ve(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ve(t.booleanValue,e.booleanValue);case 2:return function(s,o){const c=At(s.integerValue||s.doubleValue),a=At(o.integerValue||o.doubleValue);return c<a?-1:c>a?1:c===a?0:isNaN(c)?isNaN(a)?0:-1:1}(t,e);case 3:return jv(t.timestampValue,e.timestampValue);case 4:return jv(rl(t),rl(e));case 5:return Df(t.stringValue,e.stringValue);case 6:return function(s,o){const c=Ri(s),a=Ri(o);return c.compareTo(a)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const c=s.split("/"),a=o.split("/");for(let d=0;d<c.length&&d<a.length;d++){const h=Ve(c[d],a[d]);if(h!==0)return h}return Ve(c.length,a.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const c=Ve(At(s.latitude),At(o.latitude));return c!==0?c:Ve(At(s.longitude),At(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Mv(t.arrayValue,e.arrayValue);case 10:return function(s,o){var p,v,x,_;const c=s.fields||{},a=o.fields||{},d=(p=c[fu])==null?void 0:p.arrayValue,h=(v=a[fu])==null?void 0:v.arrayValue,f=Ve(((x=d==null?void 0:d.values)==null?void 0:x.length)||0,((_=h==null?void 0:h.values)==null?void 0:_.length)||0);return f!==0?f:Mv(d,h)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===rc.mapValue&&o===rc.mapValue)return 0;if(s===rc.mapValue)return 1;if(o===rc.mapValue)return-1;const c=s.fields||{},a=Object.keys(c),d=o.fields||{},h=Object.keys(d);a.sort(),h.sort();for(let f=0;f<a.length&&f<h.length;++f){const p=Df(a[f],h[f]);if(p!==0)return p;const v=So(c[a[f]],d[h[f]]);if(v!==0)return v}return Ve(a.length,h.length)}(t.mapValue,e.mapValue);default:throw Se(23264,{he:n})}}function jv(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ve(t,e);const n=Pi(t),r=Pi(e),i=Ve(n.seconds,r.seconds);return i!==0?i:Ve(n.nanos,r.nanos)}function Mv(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=So(n[i],r[i]);if(s)return s}return Ve(n.length,r.length)}function Eo(t){return jf(t)}function jf(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Pi(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Ri(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ve.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=jf(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${jf(n.fields[o])}`;return i+"}"}(t.mapValue):Se(61005,{value:t})}function kc(t){switch(Di(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Ku(t);return e?16+kc(e):16;case 5:return 2*t.stringValue.length;case 6:return Ri(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+kc(s),0)}(t.arrayValue);case 10:case 11:return function(r){let i=0;return Bi(r.fields,(s,o)=>{i+=s.length+kc(o)}),i}(t.mapValue);default:throw Se(13486,{value:t})}}function mu(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Mf(t){return!!t&&"integerValue"in t}function pp(t){return!!t&&"arrayValue"in t}function Ov(t){return!!t&&"nullValue"in t}function Vv(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Pc(t){return!!t&&"mapValue"in t}function rk(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[m1])==null?void 0:r.stringValue)===p1}function Na(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Bi(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Na(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Na(t.arrayValue.values[n]);return e}return{...t}}function ik(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===nk}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tn{constructor(e){this.value=e}static empty(){return new Tn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Pc(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Na(n)}setAll(e){let n=Jt.emptyPath(),r={},i=[];e.forEach((o,c)=>{if(!n.isImmediateParentOf(c)){const a=this.getFieldsMap(n);this.applyChanges(a,r,i),r={},i=[],n=c.popLast()}o?r[c.lastSegment()]=Na(o):i.push(c.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Pc(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Tr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Pc(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Bi(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Tn(Na(this.value))}}function g1(t){const e=[];return Bi(t.fields,(n,r)=>{const i=new Jt([n]);if(Pc(r)){const s=g1(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Mn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e,n,r,i,s,o,c){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=c}static newInvalidDocument(e){return new un(e,0,Ie.min(),Ie.min(),Ie.min(),Tn.empty(),0)}static newFoundDocument(e,n,r,i){return new un(e,1,n,Ie.min(),r,i,0)}static newNoDocument(e,n){return new un(e,2,n,Ie.min(),Ie.min(),Tn.empty(),0)}static newUnknownDocument(e,n){return new un(e,3,n,Ie.min(),Ie.min(),Tn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Ie.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Tn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Tn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ie.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof un&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new un(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class To{constructor(e,n){this.position=e,this.inclusive=n}}function Lv(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=ve.comparator(ve.fromName(o.referenceValue),n.key):r=So(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Fv(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Tr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ol{constructor(e,n="asc"){this.field=e,this.dir=n}}function sk(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y1{}class Mt extends y1{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new ak(e,n,r):n==="array-contains"?new uk(e,r):n==="in"?new dk(e,r):n==="not-in"?new hk(e,r):n==="array-contains-any"?new fk(e,r):new Mt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new lk(e,r):new ck(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(So(n,this.value)):n!==null&&Di(this.value)===Di(n)&&this.matchesComparison(So(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Se(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ir extends y1{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new ir(e,n)}matches(e){return v1(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function v1(t){return t.op==="and"}function _1(t){return ok(t)&&v1(t)}function ok(t){for(const e of t.filters)if(e instanceof ir)return!1;return!0}function Of(t){if(t instanceof Mt)return t.field.canonicalString()+t.op.toString()+Eo(t.value);if(_1(t))return t.filters.map(e=>Of(e)).join(",");{const e=t.filters.map(n=>Of(n)).join(",");return`${t.op}(${e})`}}function w1(t,e){return t instanceof Mt?function(r,i){return i instanceof Mt&&r.op===i.op&&r.field.isEqual(i.field)&&Tr(r.value,i.value)}(t,e):t instanceof ir?function(r,i){return i instanceof ir&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,c)=>s&&w1(o,i.filters[c]),!0):!1}(t,e):void Se(19439)}function S1(t){return t instanceof Mt?function(n){return`${n.field.canonicalString()} ${n.op} ${Eo(n.value)}`}(t):t instanceof ir?function(n){return n.op.toString()+" {"+n.getFilters().map(S1).join(" ,")+"}"}(t):"Filter"}class ak extends Mt{constructor(e,n,r){super(e,n,r),this.key=ve.fromName(r.referenceValue)}matches(e){const n=ve.comparator(e.key,this.key);return this.matchesComparison(n)}}class lk extends Mt{constructor(e,n){super(e,"in",n),this.keys=E1("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class ck extends Mt{constructor(e,n){super(e,"not-in",n),this.keys=E1("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function E1(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>ve.fromName(r.referenceValue))}class uk extends Mt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return pp(n)&&sl(n.arrayValue,this.value)}}class dk extends Mt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&sl(this.value.arrayValue,n)}}class hk extends Mt{constructor(e,n){super(e,"not-in",n)}matches(e){if(sl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!sl(this.value.arrayValue,n)}}class fk extends Mt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!pp(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>sl(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mk{constructor(e,n=null,r=[],i=[],s=null,o=null,c=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=c,this.Te=null}}function Uv(t,e=null,n=[],r=[],i=null,s=null,o=null){return new mk(t,e,n,r,i,s,o)}function gp(t){const e=Ae(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Of(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Gu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Eo(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Eo(r)).join(",")),e.Te=n}return e.Te}function yp(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!sk(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!w1(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Fv(t.startAt,e.startAt)&&Fv(t.endAt,e.endAt)}function Vf(t){return ve.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zi{constructor(e,n=null,r=[],i=[],s=null,o="F",c=null,a=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=c,this.endAt=a,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function pk(t,e,n,r,i,s,o,c){return new zi(t,e,n,r,i,s,o,c)}function vp(t){return new zi(t)}function Bv(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function _p(t){return t.collectionGroup!==null}function so(t){const e=Ae(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new Bt(Jt.comparator);return o.filters.forEach(a=>{a.getFlattenedFilters().forEach(d=>{d.isInequality()&&(c=c.add(d.field))})}),c})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new ol(s,r))}),n.has(Jt.keyField().canonicalString())||e.Ie.push(new ol(Jt.keyField(),r))}return e.Ie}function vr(t){const e=Ae(t);return e.Ee||(e.Ee=gk(e,so(t))),e.Ee}function gk(t,e){if(t.limitType==="F")return Uv(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new ol(i.field,s)});const n=t.endAt?new To(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new To(t.startAt.position,t.startAt.inclusive):null;return Uv(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Lf(t,e){const n=t.filters.concat([e]);return new zi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function pu(t,e,n){return new zi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Yu(t,e){return yp(vr(t),vr(e))&&t.limitType===e.limitType}function T1(t){return`${gp(vr(t))}|lt:${t.limitType}`}function Os(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>S1(i)).join(", ")}]`),Gu(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Eo(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Eo(i)).join(",")),`Target(${r})`}(vr(t))}; limitType=${t.limitType})`}function Xu(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):ve.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of so(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,c,a){const d=Lv(o,c,a);return o.inclusive?d<=0:d<0}(r.startAt,so(r),i)||r.endAt&&!function(o,c,a){const d=Lv(o,c,a);return o.inclusive?d>=0:d>0}(r.endAt,so(r),i))}(t,e)}function yk(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function b1(t){return(e,n)=>{let r=!1;for(const i of so(t)){const s=vk(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function vk(t,e,n){const r=t.field.isKeyField()?ve.comparator(e.key,n.key):function(s,o,c){const a=o.data.field(s),d=c.data.field(s);return a!==null&&d!==null?So(a,d):Se(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Se(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Bi(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return l1(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _k=new wt(ve.comparator);function $r(){return _k}const x1=new wt(ve.comparator);function ma(...t){let e=x1;for(const n of t)e=e.insert(n.key,n);return e}function I1(t){let e=x1;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function ns(){return ka()}function C1(){return ka()}function ka(){return new Ts(t=>t.toString(),(t,e)=>t.isEqual(e))}const wk=new wt(ve.comparator),Sk=new Bt(ve.comparator);function Le(...t){let e=Sk;for(const n of t)e=e.add(n);return e}const Ek=new Bt(Ve);function Tk(){return Ek}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wp(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:du(e)?"-0":e}}function A1(t){return{integerValue:""+t}}function bk(t,e){return XN(e)?A1(e):wp(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju{constructor(){this._=void 0}}function xk(t,e,n){return t instanceof gu?function(i,s){const o={fields:{[d1]:{stringValue:u1},[f1]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Qu(s)&&(s=Ku(s)),s&&(o.fields[h1]=s),{mapValue:o}}(n,e):t instanceof al?k1(t,e):t instanceof ll?P1(t,e):function(i,s){const o=N1(i,s),c=zv(o)+zv(i.Ae);return Mf(o)&&Mf(i.Ae)?A1(c):wp(i.serializer,c)}(t,e)}function Ik(t,e,n){return t instanceof al?k1(t,e):t instanceof ll?P1(t,e):n}function N1(t,e){return t instanceof yu?function(r){return Mf(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class gu extends Ju{}class al extends Ju{constructor(e){super(),this.elements=e}}function k1(t,e){const n=R1(e);for(const r of t.elements)n.some(i=>Tr(i,r))||n.push(r);return{arrayValue:{values:n}}}class ll extends Ju{constructor(e){super(),this.elements=e}}function P1(t,e){let n=R1(e);for(const r of t.elements)n=n.filter(i=>!Tr(i,r));return{arrayValue:{values:n}}}class yu extends Ju{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function zv(t){return At(t.integerValue||t.doubleValue)}function R1(t){return pp(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Ck(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof al&&i instanceof al||r instanceof ll&&i instanceof ll?wo(r.elements,i.elements,Tr):r instanceof yu&&i instanceof yu?Tr(r.Ae,i.Ae):r instanceof gu&&i instanceof gu}(t.transform,e.transform)}class Ak{constructor(e,n){this.version=e,this.transformResults=n}}class nr{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new nr}static exists(e){return new nr(void 0,e)}static updateTime(e){return new nr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Rc(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Zu{}function D1(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new M1(t.key,nr.none()):new _l(t.key,t.data,nr.none());{const n=t.data,r=Tn.empty();let i=new Bt(Jt.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new $i(t.key,r,new Mn(i.toArray()),nr.none())}}function Nk(t,e,n){t instanceof _l?function(i,s,o){const c=i.value.clone(),a=Hv(i.fieldTransforms,s,o.transformResults);c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):t instanceof $i?function(i,s,o){if(!Rc(i.precondition,s))return void s.convertToUnknownDocument(o.version);const c=Hv(i.fieldTransforms,s,o.transformResults),a=s.data;a.setAll(j1(i)),a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Pa(t,e,n,r){return t instanceof _l?function(s,o,c,a){if(!Rc(s.precondition,o))return c;const d=s.value.clone(),h=Wv(s.fieldTransforms,a,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof $i?function(s,o,c,a){if(!Rc(s.precondition,o))return c;const d=Wv(s.fieldTransforms,a,o),h=o.data;return h.setAll(j1(s)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),c===null?null:c.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(t,e,n,r):function(s,o,c){return Rc(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c}(t,e,n)}function kk(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=N1(r.transform,i||null);s!=null&&(n===null&&(n=Tn.empty()),n.set(r.field,s))}return n||null}function $v(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&wo(r,i,(s,o)=>Ck(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class _l extends Zu{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class $i extends Zu{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function j1(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Hv(t,e,n){const r=new Map;Ye(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,c=e.data.field(s.field);r.set(s.field,Ik(o,c,n[i]))}return r}function Wv(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,xk(s,o,e))}return r}class M1 extends Zu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Pk extends Zu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rk{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&Nk(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Pa(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Pa(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=C1();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let c=this.applyToLocalView(o,s.mutatedFields);c=n.has(i.key)?null:c;const a=D1(o,c);a!==null&&r.set(i.key,a),o.isValidDocument()||o.convertToNoDocument(Ie.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Le())}isEqual(e){return this.batchId===e.batchId&&wo(this.mutations,e.mutations,(n,r)=>$v(n,r))&&wo(this.baseMutations,e.baseMutations,(n,r)=>$v(n,r))}}class Sp{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){Ye(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=function(){return wk}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new Sp(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dk{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jk{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Rt,$e;function Mk(t){switch(t){case Y.OK:return Se(64938);case Y.CANCELLED:case Y.UNKNOWN:case Y.DEADLINE_EXCEEDED:case Y.RESOURCE_EXHAUSTED:case Y.INTERNAL:case Y.UNAVAILABLE:case Y.UNAUTHENTICATED:return!1;case Y.INVALID_ARGUMENT:case Y.NOT_FOUND:case Y.ALREADY_EXISTS:case Y.PERMISSION_DENIED:case Y.FAILED_PRECONDITION:case Y.ABORTED:case Y.OUT_OF_RANGE:case Y.UNIMPLEMENTED:case Y.DATA_LOSS:return!0;default:return Se(15467,{code:t})}}function O1(t){if(t===void 0)return zr("GRPC error has no .code"),Y.UNKNOWN;switch(t){case Rt.OK:return Y.OK;case Rt.CANCELLED:return Y.CANCELLED;case Rt.UNKNOWN:return Y.UNKNOWN;case Rt.DEADLINE_EXCEEDED:return Y.DEADLINE_EXCEEDED;case Rt.RESOURCE_EXHAUSTED:return Y.RESOURCE_EXHAUSTED;case Rt.INTERNAL:return Y.INTERNAL;case Rt.UNAVAILABLE:return Y.UNAVAILABLE;case Rt.UNAUTHENTICATED:return Y.UNAUTHENTICATED;case Rt.INVALID_ARGUMENT:return Y.INVALID_ARGUMENT;case Rt.NOT_FOUND:return Y.NOT_FOUND;case Rt.ALREADY_EXISTS:return Y.ALREADY_EXISTS;case Rt.PERMISSION_DENIED:return Y.PERMISSION_DENIED;case Rt.FAILED_PRECONDITION:return Y.FAILED_PRECONDITION;case Rt.ABORTED:return Y.ABORTED;case Rt.OUT_OF_RANGE:return Y.OUT_OF_RANGE;case Rt.UNIMPLEMENTED:return Y.UNIMPLEMENTED;case Rt.DATA_LOSS:return Y.DATA_LOSS;default:return Se(39323,{code:t})}}($e=Rt||(Rt={}))[$e.OK=0]="OK",$e[$e.CANCELLED=1]="CANCELLED",$e[$e.UNKNOWN=2]="UNKNOWN",$e[$e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",$e[$e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",$e[$e.NOT_FOUND=5]="NOT_FOUND",$e[$e.ALREADY_EXISTS=6]="ALREADY_EXISTS",$e[$e.PERMISSION_DENIED=7]="PERMISSION_DENIED",$e[$e.UNAUTHENTICATED=16]="UNAUTHENTICATED",$e[$e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",$e[$e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",$e[$e.ABORTED=10]="ABORTED",$e[$e.OUT_OF_RANGE=11]="OUT_OF_RANGE",$e[$e.UNIMPLEMENTED=12]="UNIMPLEMENTED",$e[$e.INTERNAL=13]="INTERNAL",$e[$e.UNAVAILABLE=14]="UNAVAILABLE",$e[$e.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ok(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vk=new Ii([4294967295,4294967295],0);function qv(t){const e=Ok().encode(t),n=new XS;return n.update(e),new Uint8Array(n.digest())}function Gv(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ii([n,r],0),new Ii([i,s],0)]}class Ep{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new pa(`Invalid padding: ${n}`);if(r<0)throw new pa(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new pa(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new pa(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Ii.fromNumber(this.ge)}ye(e,n,r){let i=e.add(n.multiply(Ii.fromNumber(r)));return i.compare(Vk)===1&&(i=new Ii([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=qv(e),[r,i]=Gv(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);if(!this.we(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new Ep(s,i,n);return r.forEach(c=>o.insert(c)),o}insert(e){if(this.ge===0)return;const n=qv(e),[r,i]=Gv(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class pa extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ed{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,wl.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new ed(Ie.min(),i,new wt(Ve),$r(),Le())}}class wl{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new wl(r,n,Le(),Le(),Le())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dc{constructor(e,n,r,i){this.be=e,this.removedTargetIds=n,this.key=r,this.De=i}}class V1{constructor(e,n){this.targetId=e,this.Ce=n}}class L1{constructor(e,n,r=tn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class Qv{constructor(){this.ve=0,this.Fe=Kv(),this.Me=tn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Le(),n=Le(),r=Le();return this.Fe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:Se(38017,{changeType:s})}}),new wl(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=Kv()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ye(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class Lk{constructor(e){this.Ge=e,this.ze=new Map,this.je=$r(),this.Je=ic(),this.He=ic(),this.Ye=new wt(Ve)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:Se(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,i)=>{this.rt(i)&&n(i)})}st(e){const n=e.targetId,r=e.Ce.count,i=this.ot(n);if(i){const s=i.target;if(Vf(s))if(r===0){const o=new ve(s.path);this.et(n,o,un.newNoDocument(o,Ie.min()))}else Ye(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const c=this.ut(e),a=c?this.ct(c,e,o):1;if(a!==0){this.it(n);const d=a===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,c;try{o=Ri(r).toUint8Array()}catch(a){if(a instanceof c1)return _o("Decoding the base64 bloom filter in existence filter failed ("+a.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw a}try{c=new Ep(o,i,s)}catch(a){return _o(a instanceof pa?"BloomFilter error: ":"Applying bloom filter failed: ",a),null}return c.ge===0?null:c}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Ge.ht(),c=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(c)||(this.et(n,s,null),i++)}),i}Tt(e){const n=new Map;this.ze.forEach((s,o)=>{const c=this.ot(o);if(c){if(s.current&&Vf(c.target)){const a=new ve(c.target.path);this.It(a).has(o)||this.Et(o,a)||this.et(o,a,un.newNoDocument(a,e))}s.Be&&(n.set(o,s.ke()),s.qe())}});let r=Le();this.He.forEach((s,o)=>{let c=!0;o.forEachWhile(a=>{const d=this.ot(a);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(r=r.add(s))}),this.je.forEach((s,o)=>o.setReadTime(e));const i=new ed(e,n,this.Ye,this.je,r);return this.je=$r(),this.Je=ic(),this.He=ic(),this.Ye=new wt(Ve),i}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,n)?i.Qe(n,1):i.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new Qv,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Bt(Ve),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Bt(Ve),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||he("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Qv),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function ic(){return new wt(ve.comparator)}function Kv(){return new wt(ve.comparator)}const Fk={asc:"ASCENDING",desc:"DESCENDING"},Uk={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Bk={and:"AND",or:"OR"};class zk{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Ff(t,e){return t.useProto3Json||Gu(e)?e:{value:e}}function vu(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function F1(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function $k(t,e){return vu(t,e.toTimestamp())}function _r(t){return Ye(!!t,49232),Ie.fromTimestamp(function(n){const r=Pi(n);return new ut(r.seconds,r.nanos)}(t))}function Tp(t,e){return Uf(t,e).canonicalString()}function Uf(t,e){const n=function(i){return new it(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function U1(t){const e=it.fromString(t);return Ye(W1(e),10190,{key:e.toString()}),e}function Bf(t,e){return Tp(t.databaseId,e.path)}function oh(t,e){const n=U1(e);if(n.get(1)!==t.databaseId.projectId)throw new ce(Y.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ce(Y.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ve(z1(n))}function B1(t,e){return Tp(t.databaseId,e)}function Hk(t){const e=U1(t);return e.length===4?it.emptyPath():z1(e)}function zf(t){return new it(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function z1(t){return Ye(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Yv(t,e,n){return{name:Bf(t,e),fields:n.value.mapValue.fields}}function Wk(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Se(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(d,h){return d.useProto3Json?(Ye(h===void 0||typeof h=="string",58123),tn.fromBase64String(h||"")):(Ye(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),tn.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&function(d){const h=d.code===void 0?Y.UNKNOWN:O1(d.code);return new ce(h,d.message||"")}(o);n=new L1(r,i,s,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=oh(t,r.document.name),s=_r(r.document.updateTime),o=r.document.createTime?_r(r.document.createTime):Ie.min(),c=new Tn({mapValue:{fields:r.document.fields}}),a=un.newFoundDocument(i,s,o,c),d=r.targetIds||[],h=r.removedTargetIds||[];n=new Dc(d,h,a.key,a)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=oh(t,r.document),s=r.readTime?_r(r.readTime):Ie.min(),o=un.newNoDocument(i,s),c=r.removedTargetIds||[];n=new Dc([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=oh(t,r.document),s=r.removedTargetIds||[];n=new Dc([],s,i,null)}else{if(!("filter"in e))return Se(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new jk(i,s),c=r.targetId;n=new V1(c,o)}}return n}function qk(t,e){let n;if(e instanceof _l)n={update:Yv(t,e.key,e.value)};else if(e instanceof M1)n={delete:Bf(t,e.key)};else if(e instanceof $i)n={update:Yv(t,e.key,e.data),updateMask:tP(e.fieldMask)};else{if(!(e instanceof Pk))return Se(16599,{Vt:e.type});n={verify:Bf(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const c=o.transform;if(c instanceof gu)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof al)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof ll)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof yu)return{fieldPath:o.field.canonicalString(),increment:c.Ae};throw Se(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:$k(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Se(27497)}(t,e.precondition)),n}function Gk(t,e){return t&&t.length>0?(Ye(e!==void 0,14353),t.map(n=>function(i,s){let o=i.updateTime?_r(i.updateTime):_r(s);return o.isEqual(Ie.min())&&(o=_r(s)),new Ak(o,i.transformResults||[])}(n,e))):[]}function Qk(t,e){return{documents:[B1(t,e.path)]}}function Kk(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=B1(t,i);const s=function(d){if(d.length!==0)return H1(ir.create(d,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(d){if(d.length!==0)return d.map(h=>function(p){return{field:Vs(p.field),direction:Jk(p.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const c=Ff(t,e.limit);return c!==null&&(n.structuredQuery.limit=c),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:n,parent:i}}function Yk(t){let e=Hk(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Ye(r===1,65062);const h=n.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];n.where&&(s=function(f){const p=$1(f);return p instanceof ir&&_1(p)?p.getFilters():[p]}(n.where));let o=[];n.orderBy&&(o=function(f){return f.map(p=>function(x){return new ol(Ls(x.field),function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(p))}(n.orderBy));let c=null;n.limit&&(c=function(f){let p;return p=typeof f=="object"?f.value:f,Gu(p)?null:p}(n.limit));let a=null;n.startAt&&(a=function(f){const p=!!f.before,v=f.values||[];return new To(v,p)}(n.startAt));let d=null;return n.endAt&&(d=function(f){const p=!f.before,v=f.values||[];return new To(v,p)}(n.endAt)),pk(e,i,o,s,c,"F",a,d)}function Xk(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Se(28987,{purpose:i})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function $1(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Ls(n.unaryFilter.field);return Mt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Ls(n.unaryFilter.field);return Mt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Ls(n.unaryFilter.field);return Mt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Ls(n.unaryFilter.field);return Mt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Se(61313);default:return Se(60726)}}(t):t.fieldFilter!==void 0?function(n){return Mt.create(Ls(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Se(58110);default:return Se(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return ir.create(n.compositeFilter.filters.map(r=>$1(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Se(1026)}}(n.compositeFilter.op))}(t):Se(30097,{filter:t})}function Jk(t){return Fk[t]}function Zk(t){return Uk[t]}function eP(t){return Bk[t]}function Vs(t){return{fieldPath:t.canonicalString()}}function Ls(t){return Jt.fromServerFormat(t.fieldPath)}function H1(t){return t instanceof Mt?function(n){if(n.op==="=="){if(Vv(n.value))return{unaryFilter:{field:Vs(n.field),op:"IS_NAN"}};if(Ov(n.value))return{unaryFilter:{field:Vs(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Vv(n.value))return{unaryFilter:{field:Vs(n.field),op:"IS_NOT_NAN"}};if(Ov(n.value))return{unaryFilter:{field:Vs(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Vs(n.field),op:Zk(n.op),value:n.value}}}(t):t instanceof ir?function(n){const r=n.getFilters().map(i=>H1(i));return r.length===1?r[0]:{compositeFilter:{op:eP(n.op),filters:r}}}(t):Se(54877,{filter:t})}function tP(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function W1(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(e,n,r,i,s=Ie.min(),o=Ie.min(),c=tn.EMPTY_BYTE_STRING,a=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=a}withSequenceNumber(e){return new hi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new hi(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new hi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new hi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nP{constructor(e){this.yt=e}}function rP(t){const e=Yk({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?pu(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iP{constructor(){this.Cn=new sP}addToCollectionParentIndex(e,n){return this.Cn.add(n),ee.resolve()}getCollectionParents(e,n){return ee.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return ee.resolve()}deleteFieldIndex(e,n){return ee.resolve()}deleteAllFieldIndexes(e){return ee.resolve()}createTargetIndexes(e,n){return ee.resolve()}getDocumentsMatchingTarget(e,n){return ee.resolve(null)}getIndexType(e,n){return ee.resolve(0)}getFieldIndexes(e,n){return ee.resolve([])}getNextCollectionGroupToUpdate(e){return ee.resolve(null)}getMinOffset(e,n){return ee.resolve(ki.min())}getMinOffsetFromCollectionGroup(e,n){return ee.resolve(ki.min())}updateCollectionGroup(e,n,r){return ee.resolve()}updateIndexEntries(e,n){return ee.resolve()}}class sP{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Bt(it.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Bt(it.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xv={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},q1=41943040;class Sn{static withCacheSize(e){return new Sn(e,Sn.DEFAULT_COLLECTION_PERCENTILE,Sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Sn.DEFAULT_COLLECTION_PERCENTILE=10,Sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Sn.DEFAULT=new Sn(q1,Sn.DEFAULT_COLLECTION_PERCENTILE,Sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Sn.DISABLED=new Sn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new bo(0)}static cr(){return new bo(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jv="LruGarbageCollector",oP=1048576;function Zv([t,e],[n,r]){const i=Ve(t,n);return i===0?Ve(e,r):i}class aP{constructor(e){this.Ir=e,this.buffer=new Bt(Zv),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Zv(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class lP{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){he(Jv,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){jo(n)?he(Jv,"Ignoring IndexedDB error during garbage collection: ",n):await Do(n)}await this.Vr(3e5)})}}class cP{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return ee.resolve(qu.ce);const r=new aP(n);return this.mr.forEachTarget(e,i=>r.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>r.Ar(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(he("LruGarbageCollector","Garbage collection skipped; disabled"),ee.resolve(Xv)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(he("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Xv):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,i,s,o,c,a,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(he("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,o=Date.now(),this.nthSequenceNumber(e,i))).next(f=>(r=f,c=Date.now(),this.removeTargets(e,r,n))).next(f=>(s=f,a=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(d=Date.now(),Ms()<=He.DEBUG&&he("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(c-o)+`ms
	Removed ${s} targets in `+(a-c)+`ms
	Removed ${f} documents in `+(d-a)+`ms
Total Duration: ${d-h}ms`),ee.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:f})))}}function uP(t,e){return new cP(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dP{constructor(){this.changes=new Ts(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,un.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?ee.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hP{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fP{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Pa(r.mutation,i,Mn.empty(),ut.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Le()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Le()){const i=ns();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=ma();return s.forEach((c,a)=>{o=o.insert(c,a.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=ns();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Le()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,c)=>{n.set(o,c)})})}computeViews(e,n,r,i){let s=$r();const o=ka(),c=function(){return ka()}();return n.forEach((a,d)=>{const h=r.get(d.key);i.has(d.key)&&(h===void 0||h.mutation instanceof $i)?s=s.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),Pa(h.mutation,d,h.mutation.getFieldMask(),ut.now())):o.set(d.key,Mn.empty())}),this.recalculateAndSaveOverlays(e,s).next(a=>(a.forEach((d,h)=>o.set(d,h)),n.forEach((d,h)=>c.set(d,new hP(h,o.get(d)??null))),c))}recalculateAndSaveOverlays(e,n){const r=ka();let i=new wt((o,c)=>o-c),s=Le();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const c of o)c.keys().forEach(a=>{const d=n.get(a);if(d===null)return;let h=r.get(a)||Mn.empty();h=c.applyToLocalView(d,h),r.set(a,h);const f=(i.get(c.batchId)||Le()).add(a);i=i.insert(c.batchId,f)})}).next(()=>{const o=[],c=i.getReverseIterator();for(;c.hasNext();){const a=c.getNext(),d=a.key,h=a.value,f=C1();h.forEach(p=>{if(!s.has(p)){const v=D1(n.get(p),r.get(p));v!==null&&f.set(p,v),s=s.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,f))}return ee.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return ve.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):_p(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):ee.resolve(ns());let c=nl,a=s;return o.next(d=>ee.forEach(d,(h,f)=>(c<f.largestBatchId&&(c=f.largestBatchId),s.get(h)?ee.resolve():this.remoteDocumentCache.getEntry(e,h).next(p=>{a=a.insert(h,p)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,a,d,Le())).next(h=>({batchId:c,changes:I1(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ve(n)).next(r=>{let i=ma();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=ma();return this.indexManager.getCollectionParents(e,s).next(c=>ee.forEach(c,a=>{const d=function(f,p){return new zi(p,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,a.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(h=>{h.forEach((f,p)=>{o=o.insert(f,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((a,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,un.newInvalidDocument(h)))});let c=ma();return o.forEach((a,d)=>{const h=s.get(a);h!==void 0&&Pa(h.mutation,d,Mn.empty(),ut.now()),Xu(n,d)&&(c=c.insert(a,d))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mP{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return ee.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:_r(i.createTime)}}(n)),ee.resolve()}getNamedQuery(e,n){return ee.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(i){return{name:i.name,query:rP(i.bundledQuery),readTime:_r(i.readTime)}}(n)),ee.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pP{constructor(){this.overlays=new wt(ve.comparator),this.qr=new Map}getOverlay(e,n){return ee.resolve(this.overlays.get(n))}getOverlays(e,n){const r=ns();return ee.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.St(e,n,s)}),ee.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.qr.delete(r)),ee.resolve()}getOverlaysForCollection(e,n,r){const i=ns(),s=n.length+1,o=new ve(n.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const a=c.getNext().value,d=a.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===s&&a.largestBatchId>r&&i.set(a.getKey(),a)}return ee.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new wt((d,h)=>d-h);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=s.get(d.largestBatchId);h===null&&(h=ns(),s=s.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const c=ns(),a=s.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach((d,h)=>c.set(d,h)),!(c.size()>=i)););return ee.resolve(c)}St(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Dk(n,r));let s=this.qr.get(n);s===void 0&&(s=Le(),this.qr.set(n,s)),this.qr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gP{constructor(){this.sessionToken=tn.EMPTY_BYTE_STRING}getSessionToken(e){return ee.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,ee.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bp{constructor(){this.Qr=new Bt(Ht.$r),this.Ur=new Bt(Ht.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new Ht(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new Ht(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new ve(new it([])),r=new Ht(n,e),i=new Ht(n,e+1),s=[];return this.Ur.forEachInRange([r,i],o=>{this.Gr(o),s.push(o.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new ve(new it([])),r=new Ht(n,e),i=new Ht(n,e+1);let s=Le();return this.Ur.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new Ht(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Ht{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return ve.comparator(e.key,n.key)||Ve(e.Yr,n.Yr)}static Kr(e,n){return Ve(e.Yr,n.Yr)||ve.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yP{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Bt(Ht.$r)}checkEmpty(e){return ee.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Rk(s,n,r,i);this.mutationQueue.push(o);for(const c of i)this.Zr=this.Zr.add(new Ht(c.key,s)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return ee.resolve(o)}lookupMutationBatch(e,n){return ee.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.ei(r),s=i<0?0:i;return ee.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ee.resolve(this.mutationQueue.length===0?mp:this.tr-1)}getAllMutationBatches(e){return ee.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Ht(n,0),i=new Ht(n,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],o=>{const c=this.Xr(o.Yr);s.push(c)}),ee.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Bt(Ve);return n.forEach(i=>{const s=new Ht(i,0),o=new Ht(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],c=>{r=r.add(c.Yr)})}),ee.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;ve.isDocumentKey(s)||(s=s.child(""));const o=new Ht(new ve(s),0);let c=new Bt(Ve);return this.Zr.forEachWhile(a=>{const d=a.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(c=c.add(a.Yr)),!0)},o),ee.resolve(this.ti(c))}ti(e){const n=[];return e.forEach(r=>{const i=this.Xr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){Ye(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return ee.forEach(n.mutations,i=>{const s=new Ht(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new Ht(n,0),i=this.Zr.firstAfterOrEqual(r);return ee.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,ee.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vP{constructor(e){this.ri=e,this.docs=function(){return new wt(ve.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return ee.resolve(r?r.document.mutableCopy():un.newInvalidDocument(n))}getEntries(e,n){let r=$r();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():un.newInvalidDocument(i))}),ee.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=$r();const o=n.path,c=new ve(o.child("__id-9223372036854775808__")),a=this.docs.getIteratorFrom(c);for(;a.hasNext();){const{key:d,value:{document:h}}=a.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||GN(qN(h),r)<=0||(i.has(h.key)||Xu(n,h))&&(s=s.insert(h.key,h.mutableCopy()))}return ee.resolve(s)}getAllFromCollectionGroup(e,n,r,i){Se(9500)}ii(e,n){return ee.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new _P(this)}getSize(e){return ee.resolve(this.size)}}class _P extends dP{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)}),ee.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wP{constructor(e){this.persistence=e,this.si=new Ts(n=>gp(n),yp),this.lastRemoteSnapshotVersion=Ie.min(),this.highestTargetId=0,this.oi=0,this._i=new bp,this.targetCount=0,this.ai=bo.ur()}forEachTarget(e,n){return this.si.forEach((r,i)=>n(i)),ee.resolve()}getLastRemoteSnapshotVersion(e){return ee.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ee.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ee.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),ee.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new bo(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,ee.resolve()}updateTargetData(e,n){return this.Pr(n),ee.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,ee.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.si.forEach((o,c)=>{c.sequenceNumber<=n&&r.get(c.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)}),ee.waitFor(s).next(()=>i)}getTargetCount(e){return ee.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return ee.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),ee.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),ee.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),ee.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return ee.resolve(r)}containsKey(e,n){return ee.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G1{constructor(e,n){this.ui={},this.overlays={},this.ci=new qu(0),this.li=!1,this.li=!0,this.hi=new gP,this.referenceDelegate=e(this),this.Pi=new wP(this),this.indexManager=new iP,this.remoteDocumentCache=function(i){return new vP(i)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new nP(n),this.Ii=new mP(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new pP,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new yP(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){he("MemoryPersistence","Starting transaction:",e);const i=new SP(this.ci.next());return this.referenceDelegate.Ei(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ai(e,n){return ee.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class SP extends KN{constructor(e){super(),this.currentSequenceNumber=e}}class xp{constructor(e){this.persistence=e,this.Ri=new bp,this.Vi=null}static mi(e){return new xp(e)}get fi(){if(this.Vi)return this.Vi;throw Se(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),ee.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),ee.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),ee.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(i=>this.fi.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.fi.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ee.forEach(this.fi,r=>{const i=ve.fromPath(r);return this.gi(e,i).next(s=>{s||n.removeEntry(i,Ie.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return ee.or([()=>ee.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class _u{constructor(e,n){this.persistence=e,this.pi=new Ts(r=>JN(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=uP(this,n)}static mi(e,n){return new _u(e,n)}Ei(){}di(e){return ee.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return ee.forEach(this.pi,(r,i)=>this.br(e,r,i).next(s=>s?ee.resolve():n(i)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,o=>this.br(e,o,n).next(c=>{c||(r++,s.removeEntry(o,Ie.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),ee.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),ee.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),ee.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),ee.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=kc(e.data.value)),n}br(e,n,r){return ee.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.pi.get(n);return ee.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ip{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=i}static As(e,n){let r=Le(),i=Le();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Ip(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EP{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TP{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return vA()?8:YN(gA())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.ys(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ws(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new EP;return this.Ss(e,n,o).next(c=>{if(s.result=c,this.Vs)return this.bs(e,n,o,c.size)})}).next(()=>s.result)}bs(e,n,r,i){return r.documentReadCount<this.fs?(Ms()<=He.DEBUG&&he("QueryEngine","SDK will not create cache indexes for query:",Os(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ee.resolve()):(Ms()<=He.DEBUG&&he("QueryEngine","Query:",Os(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(Ms()<=He.DEBUG&&he("QueryEngine","The SDK decides to create cache indexes for query:",Os(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,vr(n))):ee.resolve())}ys(e,n){if(Bv(n))return ee.resolve(null);let r=vr(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=pu(n,null,"F"),r=vr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=Le(...s);return this.ps.getDocuments(e,o).next(c=>this.indexManager.getMinOffset(e,r).next(a=>{const d=this.Ds(n,c);return this.Cs(n,d,o,a.readTime)?this.ys(e,pu(n,null,"F")):this.vs(e,d,n,a)}))})))}ws(e,n,r,i){return Bv(n)||i.isEqual(Ie.min())?ee.resolve(null):this.ps.getDocuments(e,r).next(s=>{const o=this.Ds(n,s);return this.Cs(n,o,r,i)?ee.resolve(null):(Ms()<=He.DEBUG&&he("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Os(n)),this.vs(e,o,n,WN(i,nl)).next(c=>c))})}Ds(e,n){let r=new Bt(b1(e));return n.forEach((i,s)=>{Xu(e,s)&&(r=r.add(s))}),r}Cs(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,n,r){return Ms()<=He.DEBUG&&he("QueryEngine","Using full collection scan to execute query:",Os(n)),this.ps.getDocumentsMatchingQuery(e,n,ki.min(),r)}vs(e,n,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cp="LocalStore",bP=3e8;class xP{constructor(e,n,r,i){this.persistence=e,this.Fs=n,this.serializer=i,this.Ms=new wt(Ve),this.xs=new Ts(s=>gp(s),yp),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new fP(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function IP(t,e,n,r){return new xP(t,e,n,r)}async function Q1(t,e){const n=Ae(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],c=[];let a=Le();for(const d of i){o.push(d.batchId);for(const h of d.mutations)a=a.add(h.key)}for(const d of s){c.push(d.batchId);for(const h of d.mutations)a=a.add(h.key)}return n.localDocuments.getDocuments(r,a).next(d=>({Ls:d,removedBatchIds:o,addedBatchIds:c}))})})}function CP(t,e){const n=Ae(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.Ns.newChangeBuffer({trackRemovals:!0});return function(c,a,d,h){const f=d.batch,p=f.keys();let v=ee.resolve();return p.forEach(x=>{v=v.next(()=>h.getEntry(a,x)).next(_=>{const P=d.docVersions.get(x);Ye(P!==null,48541),_.version.compareTo(P)<0&&(f.applyToRemoteDocument(_,d),_.isValidDocument()&&(_.setReadTime(d.commitVersion),h.addEntry(_)))})}),v.next(()=>c.mutationQueue.removeMutationBatch(a,f))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(c){let a=Le();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(a=a.add(c.batch.mutations[d].key));return a}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function K1(t){const e=Ae(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function AP(t,e){const n=Ae(t),r=e.snapshotVersion;let i=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;const c=[];e.targetChanges.forEach((h,f)=>{const p=i.get(f);if(!p)return;c.push(n.Pi.removeMatchingKeys(s,h.removedDocuments,f).next(()=>n.Pi.addMatchingKeys(s,h.addedDocuments,f)));let v=p.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?v=v.withResumeToken(tn.EMPTY_BYTE_STRING,Ie.min()).withLastLimboFreeSnapshotVersion(Ie.min()):h.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(h.resumeToken,r)),i=i.insert(f,v),function(_,P,y){return _.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-_.snapshotVersion.toMicroseconds()>=bP?!0:y.addedDocuments.size+y.modifiedDocuments.size+y.removedDocuments.size>0}(p,v,h)&&c.push(n.Pi.updateTargetData(s,v))});let a=$r(),d=Le();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&c.push(n.persistence.referenceDelegate.updateLimboDocument(s,h))}),c.push(NP(s,o,e.documentUpdates).next(h=>{a=h.ks,d=h.qs})),!r.isEqual(Ie.min())){const h=n.Pi.getLastRemoteSnapshotVersion(s).next(f=>n.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r));c.push(h)}return ee.waitFor(c).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,a,d)).next(()=>a)}).then(s=>(n.Ms=i,s))}function NP(t,e,n){let r=Le(),i=Le();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=$r();return n.forEach((c,a)=>{const d=s.get(c);a.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(c)),a.isNoDocument()&&a.version.isEqual(Ie.min())?(e.removeEntry(c,a.readTime),o=o.insert(c,a)):!d.isValidDocument()||a.version.compareTo(d.version)>0||a.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(a),o=o.insert(c,a)):he(Cp,"Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",a.version)}),{ks:o,qs:i}})}function kP(t,e){const n=Ae(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=mp),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function PP(t,e){const n=Ae(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Pi.getTargetData(r,e).next(s=>s?(i=s,ee.resolve(i)):n.Pi.allocateTargetId(r).next(o=>(i=new hi(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function $f(t,e,n){const r=Ae(t),i=r.Ms.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!jo(o))throw o;he(Cp,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function e_(t,e,n){const r=Ae(t);let i=Ie.min(),s=Le();return r.persistence.runTransaction("Execute query","readwrite",o=>function(a,d,h){const f=Ae(a),p=f.xs.get(h);return p!==void 0?ee.resolve(f.Ms.get(p)):f.Pi.getTargetData(d,h)}(r,o,vr(e)).next(c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,c.targetId).next(a=>{s=a})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?i:Ie.min(),n?s:Le())).next(c=>(RP(r,yk(e),c),{documents:c,Qs:s})))}function RP(t,e,n){let r=t.Os.get(e)||Ie.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.Os.set(e,r)}class t_{constructor(){this.activeTargetIds=Tk()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class DP{constructor(){this.Mo=new t_,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new t_,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jP{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n_="ConnectivityMonitor";class r_{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){he(n_,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){he(n_,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sc=null;function Hf(){return sc===null?sc=function(){return 268435456+Math.round(2147483648*Math.random())}():sc++,"0x"+sc.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ah="RestConnection",MP={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class OP{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===hu?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,n,r,i,s){const o=Hf(),c=this.zo(e,n.toUriEncodedString());he(ah,`Sending RPC '${e}' ${o}:`,c,r);const a={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(a,i,s);const{host:d}=new URL(c),h=yl(d);return this.Jo(e,c,a,r,h).then(f=>(he(ah,`Received RPC '${e}' ${o}: `,f),f),f=>{throw _o(ah,`RPC '${e}' ${o} failed with error: `,f,"url: ",c,"request:",r),f})}Ho(e,n,r,i,s,o){return this.Go(e,n,r,i,s)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ro}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}zo(e,n){const r=MP[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VP{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const an="WebChannelConnection";class LP extends OP{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,i,s){const o=Hf();return new Promise((c,a)=>{const d=new JS;d.setWithCredentials(!0),d.listenOnce(ZS.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Nc.NO_ERROR:const f=d.getResponseJson();he(an,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),c(f);break;case Nc.TIMEOUT:he(an,`RPC '${e}' ${o} timed out`),a(new ce(Y.DEADLINE_EXCEEDED,"Request time out"));break;case Nc.HTTP_ERROR:const p=d.getStatus();if(he(an,`RPC '${e}' ${o} failed with status:`,p,"response text:",d.getResponseText()),p>0){let v=d.getResponseJson();Array.isArray(v)&&(v=v[0]);const x=v==null?void 0:v.error;if(x&&x.status&&x.message){const _=function(y){const w=y.toLowerCase().replace(/_/g,"-");return Object.values(Y).indexOf(w)>=0?w:Y.UNKNOWN}(x.status);a(new ce(_,x.message))}else a(new ce(Y.UNKNOWN,"Server responded with status "+d.getStatus()))}else a(new ce(Y.UNAVAILABLE,"Connection failed."));break;default:Se(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{he(an,`RPC '${e}' ${o} completed.`)}});const h=JSON.stringify(i);he(an,`RPC '${e}' ${o} sending request:`,i),d.send(n,"POST",h,r,15)})}T_(e,n,r){const i=Hf(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=n1(),c=t1(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(a.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(a.useFetchStreams=!0),this.jo(a.initMessageHeaders,n,r),a.encodeInitMessageHeaders=!0;const h=s.join("");he(an,`Creating RPC '${e}' stream ${i}: ${h}`,a);const f=o.createWebChannel(h,a);this.I_(f);let p=!1,v=!1;const x=new VP({Yo:P=>{v?he(an,`Not sending because RPC '${e}' stream ${i} is closed:`,P):(p||(he(an,`Opening RPC '${e}' stream ${i} transport.`),f.open(),p=!0),he(an,`RPC '${e}' stream ${i} sending:`,P),f.send(P))},Zo:()=>f.close()}),_=(P,y,w)=>{P.listen(y,T=>{try{w(T)}catch(M){setTimeout(()=>{throw M},0)}})};return _(f,fa.EventType.OPEN,()=>{v||(he(an,`RPC '${e}' stream ${i} transport opened.`),x.o_())}),_(f,fa.EventType.CLOSE,()=>{v||(v=!0,he(an,`RPC '${e}' stream ${i} transport closed`),x.a_(),this.E_(f))}),_(f,fa.EventType.ERROR,P=>{v||(v=!0,_o(an,`RPC '${e}' stream ${i} transport errored. Name:`,P.name,"Message:",P.message),x.a_(new ce(Y.UNAVAILABLE,"The operation could not be completed")))}),_(f,fa.EventType.MESSAGE,P=>{var y;if(!v){const w=P.data[0];Ye(!!w,16349);const T=w,M=(T==null?void 0:T.error)||((y=T[0])==null?void 0:y.error);if(M){he(an,`RPC '${e}' stream ${i} received error:`,M);const L=M.status;let B=function(R){const S=Rt[R];if(S!==void 0)return O1(S)}(L),C=M.message;B===void 0&&(B=Y.INTERNAL,C="Unknown error status: "+L+" with message "+M.message),v=!0,x.a_(new ce(B,C)),f.close()}else he(an,`RPC '${e}' stream ${i} received:`,w),x.u_(w)}}),_(c,e1.STAT_EVENT,P=>{P.stat===Rf.PROXY?he(an,`RPC '${e}' stream ${i} detected buffering proxy`):P.stat===Rf.NOPROXY&&he(an,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{x.__()},0),x}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}function lh(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function td(t){return new zk(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y1{constructor(e,n,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,n-r);i>0&&he("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i_="PersistentStream";class X1{constructor(e,n,r,i,s,o,c,a){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=a,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Y1(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===Y.RESOURCE_EXHAUSTED?(zr(n.toString()),zr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===Y.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===n&&this.G_(r,i)},r=>{e(()=>{const i=new ce(Y.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return he(i_,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(he(i_,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class FP extends X1{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=Wk(this.serializer,e),r=function(s){if(!("targetChange"in s))return Ie.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Ie.min():o.readTime?_r(o.readTime):Ie.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=zf(this.serializer),n.addTarget=function(s,o){let c;const a=o.target;if(c=Vf(a)?{documents:Qk(s,a)}:{query:Kk(s,a).ft},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=F1(s,o.resumeToken);const d=Ff(s,o.expectedCount);d!==null&&(c.expectedCount=d)}else if(o.snapshotVersion.compareTo(Ie.min())>0){c.readTime=vu(s,o.snapshotVersion.toTimestamp());const d=Ff(s,o.expectedCount);d!==null&&(c.expectedCount=d)}return c}(this.serializer,e);const r=Xk(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=zf(this.serializer),n.removeTarget=e,this.q_(n)}}class UP extends X1{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return Ye(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ye(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ye(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=Gk(e.writeResults,e.commitTime),r=_r(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=zf(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>qk(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BP{}class zP extends BP{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new ce(Y.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Go(e,Uf(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ce(Y.UNKNOWN,s.toString())})}Ho(e,n,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.Ho(e,Uf(n,r),i,o,c,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ce(Y.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class $P{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(zr(n),this.aa=!1):he("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fs="RemoteStore";class HP{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{bs(this)&&(he(fs,"Restarting streams for network reachability change."),await async function(a){const d=Ae(a);d.Ea.add(4),await Sl(d),d.Ra.set("Unknown"),d.Ea.delete(4),await nd(d)}(this))})}),this.Ra=new $P(r,i)}}async function nd(t){if(bs(t))for(const e of t.da)await e(!0)}async function Sl(t){for(const e of t.da)await e(!1)}function J1(t,e){const n=Ae(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),Pp(n)?kp(n):Mo(n).O_()&&Np(n,e))}function Ap(t,e){const n=Ae(t),r=Mo(n);n.Ia.delete(e),r.O_()&&Z1(n,e),n.Ia.size===0&&(r.O_()?r.L_():bs(n)&&n.Ra.set("Unknown"))}function Np(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ie.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Mo(t).Y_(e)}function Z1(t,e){t.Va.Ue(e),Mo(t).Z_(e)}function kp(t){t.Va=new Lk({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Mo(t).start(),t.Ra.ua()}function Pp(t){return bs(t)&&!Mo(t).x_()&&t.Ia.size>0}function bs(t){return Ae(t).Ea.size===0}function eE(t){t.Va=void 0}async function WP(t){t.Ra.set("Online")}async function qP(t){t.Ia.forEach((e,n)=>{Np(t,e)})}async function GP(t,e){eE(t),Pp(t)?(t.Ra.ha(e),kp(t)):t.Ra.set("Unknown")}async function QP(t,e,n){if(t.Ra.set("Online"),e instanceof L1&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const c of s.targetIds)i.Ia.has(c)&&(await i.remoteSyncer.rejectListen(c,o),i.Ia.delete(c),i.Va.removeTarget(c))}(t,e)}catch(r){he(fs,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await wu(t,r)}else if(e instanceof Dc?t.Va.Ze(e):e instanceof V1?t.Va.st(e):t.Va.tt(e),!n.isEqual(Ie.min()))try{const r=await K1(t.localStore);n.compareTo(r)>=0&&await function(s,o){const c=s.Va.Tt(o);return c.targetChanges.forEach((a,d)=>{if(a.resumeToken.approximateByteSize()>0){const h=s.Ia.get(d);h&&s.Ia.set(d,h.withResumeToken(a.resumeToken,o))}}),c.targetMismatches.forEach((a,d)=>{const h=s.Ia.get(a);if(!h)return;s.Ia.set(a,h.withResumeToken(tn.EMPTY_BYTE_STRING,h.snapshotVersion)),Z1(s,a);const f=new hi(h.target,a,d,h.sequenceNumber);Np(s,f)}),s.remoteSyncer.applyRemoteEvent(c)}(t,n)}catch(r){he(fs,"Failed to raise snapshot:",r),await wu(t,r)}}async function wu(t,e,n){if(!jo(e))throw e;t.Ea.add(1),await Sl(t),t.Ra.set("Offline"),n||(n=()=>K1(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{he(fs,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await nd(t)})}function tE(t,e){return e().catch(n=>wu(t,n,e))}async function rd(t){const e=Ae(t),n=ji(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:mp;for(;KP(e);)try{const i=await kP(e.localStore,r);if(i===null){e.Ta.length===0&&n.L_();break}r=i.batchId,YP(e,i)}catch(i){await wu(e,i)}nE(e)&&rE(e)}function KP(t){return bs(t)&&t.Ta.length<10}function YP(t,e){t.Ta.push(e);const n=ji(t);n.O_()&&n.X_&&n.ea(e.mutations)}function nE(t){return bs(t)&&!ji(t).x_()&&t.Ta.length>0}function rE(t){ji(t).start()}async function XP(t){ji(t).ra()}async function JP(t){const e=ji(t);for(const n of t.Ta)e.ea(n.mutations)}async function ZP(t,e,n){const r=t.Ta.shift(),i=Sp.from(r,e,n);await tE(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await rd(t)}async function eR(t,e){e&&ji(t).X_&&await async function(r,i){if(function(o){return Mk(o)&&o!==Y.ABORTED}(i.code)){const s=r.Ta.shift();ji(r).B_(),await tE(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await rd(r)}}(t,e),nE(t)&&rE(t)}async function s_(t,e){const n=Ae(t);n.asyncQueue.verifyOperationInProgress(),he(fs,"RemoteStore received new credentials");const r=bs(n);n.Ea.add(3),await Sl(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await nd(n)}async function tR(t,e){const n=Ae(t);e?(n.Ea.delete(2),await nd(n)):e||(n.Ea.add(2),await Sl(n),n.Ra.set("Unknown"))}function Mo(t){return t.ma||(t.ma=function(n,r,i){const s=Ae(n);return s.sa(),new FP(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:WP.bind(null,t),t_:qP.bind(null,t),r_:GP.bind(null,t),H_:QP.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Pp(t)?kp(t):t.Ra.set("Unknown")):(await t.ma.stop(),eE(t))})),t.ma}function ji(t){return t.fa||(t.fa=function(n,r,i){const s=Ae(n);return s.sa(),new UP(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:XP.bind(null,t),r_:eR.bind(null,t),ta:JP.bind(null,t),na:ZP.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await rd(t)):(await t.fa.stop(),t.Ta.length>0&&(he(fs,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rp{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Or,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,c=new Rp(e,n,o,i,s);return c.start(r),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ce(Y.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Dp(t,e){if(zr("AsyncQueue",`${e}: ${t}`),jo(t))return new ce(Y.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oo{static emptySet(e){return new oo(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||ve.comparator(n.key,r.key):(n,r)=>ve.comparator(n.key,r.key),this.keyedMap=ma(),this.sortedSet=new wt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof oo)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new oo;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o_{constructor(){this.ga=new wt(ve.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Se(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class xo{constructor(e,n,r,i,s,o,c,a,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=a,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(c=>{o.push({type:0,doc:c})}),new xo(e,n,oo.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Yu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nR{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class rR{constructor(){this.queries=a_(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const i=Ae(n),s=i.queries;i.queries=a_(),s.forEach((o,c)=>{for(const a of c.Sa)a.onError(r)})})(this,new ce(Y.ABORTED,"Firestore shutting down"))}}function a_(){return new Ts(t=>T1(t),Yu)}async function iE(t,e){const n=Ae(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new nR,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await n.onListen(i,!0);break;case 1:s.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const c=Dp(o,`Initialization of query '${Os(e.query)}' failed`);return void e.onError(c)}n.queries.set(i,s),s.Sa.push(e),e.va(n.onlineState),s.wa&&e.Fa(s.wa)&&jp(n)}async function sE(t,e){const n=Ae(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function iR(t,e){const n=Ae(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const c of o.Sa)c.Fa(i)&&(r=!0);o.wa=i}}r&&jp(n)}function sR(t,e,n){const r=Ae(t),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(n);r.queries.delete(e)}function jp(t){t.Ca.forEach(e=>{e.next()})}var Wf,l_;(l_=Wf||(Wf={})).Ma="default",l_.Cache="cache";class oE{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new xo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=xo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Wf.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aE{constructor(e){this.key=e}}class lE{constructor(e){this.key=e}}class oR{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Le(),this.mutatedKeys=Le(),this.eu=b1(e),this.tu=new oo(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new o_,i=n?n.tu:this.tu;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,c=!1;const a=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,f)=>{const p=i.get(h),v=Xu(this.query,f)?f:null,x=!!p&&this.mutatedKeys.has(p.key),_=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let P=!1;p&&v?p.data.isEqual(v.data)?x!==_&&(r.track({type:3,doc:v}),P=!0):this.su(p,v)||(r.track({type:2,doc:v}),P=!0,(a&&this.eu(v,a)>0||d&&this.eu(v,d)<0)&&(c=!0)):!p&&v?(r.track({type:0,doc:v}),P=!0):p&&!v&&(r.track({type:1,doc:p}),P=!0,(a||d)&&(c=!0)),P&&(v?(o=o.add(v),s=_?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Cs:c,mutatedKeys:s}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((h,f)=>function(v,x){const _=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Se(20277,{Rt:P})}};return _(v)-_(x)}(h.type,f.type)||this.eu(h.doc,f.doc)),this.ou(r),i=i??!1;const c=n&&!i?this._u():[],a=this.Xa.size===0&&this.current&&!i?1:0,d=a!==this.Za;return this.Za=a,o.length!==0||d?{snapshot:new xo(this.query,e.tu,s,o,e.mutatedKeys,a===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new o_,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Le(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new lE(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new aE(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=Le();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return xo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Mp="SyncEngine";class aR{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class lR{constructor(e){this.key=e,this.hu=!1}}class cR{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Ts(c=>T1(c),Yu),this.Iu=new Map,this.Eu=new Set,this.du=new wt(ve.comparator),this.Au=new Map,this.Ru=new bp,this.Vu={},this.mu=new Map,this.fu=bo.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function uR(t,e,n=!0){const r=mE(t);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await cE(r,e,n,!0),i}async function dR(t,e){const n=mE(t);await cE(n,e,!0,!1)}async function cE(t,e,n,r){const i=await PP(t.localStore,vr(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let c;return r&&(c=await hR(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&J1(t.remoteStore,i),c}async function hR(t,e,n,r,i){t.pu=(f,p,v)=>async function(_,P,y,w){let T=P.view.ru(y);T.Cs&&(T=await e_(_.localStore,P.query,!1).then(({documents:C})=>P.view.ru(C,T)));const M=w&&w.targetChanges.get(P.targetId),L=w&&w.targetMismatches.get(P.targetId)!=null,B=P.view.applyChanges(T,_.isPrimaryClient,M,L);return u_(_,P.targetId,B.au),B.snapshot}(t,f,p,v);const s=await e_(t.localStore,e,!0),o=new oR(e,s.Qs),c=o.ru(s.documents),a=wl.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),d=o.applyChanges(c,t.isPrimaryClient,a);u_(t,n,d.au);const h=new aR(e,n,o);return t.Tu.set(e,h),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function fR(t,e,n){const r=Ae(t),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter(o=>!Yu(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await $f(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Ap(r.remoteStore,i.targetId),qf(r,i.targetId)}).catch(Do)):(qf(r,i.targetId),await $f(r.localStore,i.targetId,!0))}async function mR(t,e){const n=Ae(t),r=n.Tu.get(e),i=n.Iu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Ap(n.remoteStore,r.targetId))}async function pR(t,e,n){const r=ER(t);try{const i=await function(o,c){const a=Ae(o),d=ut.now(),h=c.reduce((v,x)=>v.add(x.key),Le());let f,p;return a.persistence.runTransaction("Locally write mutations","readwrite",v=>{let x=$r(),_=Le();return a.Ns.getEntries(v,h).next(P=>{x=P,x.forEach((y,w)=>{w.isValidDocument()||(_=_.add(y))})}).next(()=>a.localDocuments.getOverlayedDocuments(v,x)).next(P=>{f=P;const y=[];for(const w of c){const T=kk(w,f.get(w.key).overlayedDocument);T!=null&&y.push(new $i(w.key,T,g1(T.value.mapValue),nr.exists(!0)))}return a.mutationQueue.addMutationBatch(v,d,y,c)}).next(P=>{p=P;const y=P.applyToLocalDocumentSet(f,_);return a.documentOverlayCache.saveOverlays(v,P.batchId,y)})}).then(()=>({batchId:p.batchId,changes:I1(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,c,a){let d=o.Vu[o.currentUser.toKey()];d||(d=new wt(Ve)),d=d.insert(c,a),o.Vu[o.currentUser.toKey()]=d}(r,i.batchId,n),await El(r,i.changes),await rd(r.remoteStore)}catch(i){const s=Dp(i,"Failed to persist write");n.reject(s)}}async function uE(t,e){const n=Ae(t);try{const r=await AP(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Au.get(s);o&&(Ye(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?Ye(o.hu,14607):i.removedDocuments.size>0&&(Ye(o.hu,42227),o.hu=!1))}),await El(n,r,e)}catch(r){await Do(r)}}function c_(t,e,n){const r=Ae(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Tu.forEach((s,o)=>{const c=o.view.va(e);c.snapshot&&i.push(c.snapshot)}),function(o,c){const a=Ae(o);a.onlineState=c;let d=!1;a.queries.forEach((h,f)=>{for(const p of f.Sa)p.va(c)&&(d=!0)}),d&&jp(a)}(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function gR(t,e,n){const r=Ae(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Au.get(e),s=i&&i.key;if(s){let o=new wt(ve.comparator);o=o.insert(s,un.newNoDocument(s,Ie.min()));const c=Le().add(s),a=new ed(Ie.min(),new Map,new wt(Ve),o,c);await uE(r,a),r.du=r.du.remove(s),r.Au.delete(e),Op(r)}else await $f(r.localStore,e,!1).then(()=>qf(r,e,n)).catch(Do)}async function yR(t,e){const n=Ae(t),r=e.batch.batchId;try{const i=await CP(n.localStore,e);hE(n,r,null),dE(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await El(n,i)}catch(i){await Do(i)}}async function vR(t,e,n){const r=Ae(t);try{const i=await function(o,c){const a=Ae(o);return a.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return a.mutationQueue.lookupMutationBatch(d,c).next(f=>(Ye(f!==null,37113),h=f.keys(),a.mutationQueue.removeMutationBatch(d,f))).next(()=>a.mutationQueue.performConsistencyCheck(d)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(d,h,c)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>a.localDocuments.getDocuments(d,h))})}(r.localStore,e);hE(r,e,n),dE(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await El(r,i)}catch(i){await Do(i)}}function dE(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function hE(t,e,n){const r=Ae(t);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function qf(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||fE(t,r)})}function fE(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Ap(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),Op(t))}function u_(t,e,n){for(const r of n)r instanceof aE?(t.Ru.addReference(r.key,e),_R(t,r)):r instanceof lE?(he(Mp,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||fE(t,r.key)):Se(19791,{wu:r})}function _R(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(he(Mp,"New document in limbo: "+n),t.Eu.add(r),Op(t))}function Op(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new ve(it.fromString(e)),r=t.fu.next();t.Au.set(r,new lR(n)),t.du=t.du.insert(n,r),J1(t.remoteStore,new hi(vr(vp(n.path)),r,"TargetPurposeLimboResolution",qu.ce))}}async function El(t,e,n){const r=Ae(t),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((c,a)=>{o.push(r.pu(a,e,n).then(d=>{var h;if((d||n)&&r.isPrimaryClient){const f=d?!d.fromCache:(h=n==null?void 0:n.targetChanges.get(a.targetId))==null?void 0:h.current;r.sharedClientState.updateQueryState(a.targetId,f?"current":"not-current")}if(d){i.push(d);const f=Ip.As(a.targetId,d);s.push(f)}}))}),await Promise.all(o),r.Pu.H_(i),await async function(a,d){const h=Ae(a);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>ee.forEach(d,p=>ee.forEach(p.Es,v=>h.persistence.referenceDelegate.addReference(f,p.targetId,v)).next(()=>ee.forEach(p.ds,v=>h.persistence.referenceDelegate.removeReference(f,p.targetId,v)))))}catch(f){if(!jo(f))throw f;he(Cp,"Failed to update sequence numbers: "+f)}for(const f of d){const p=f.targetId;if(!f.fromCache){const v=h.Ms.get(p),x=v.snapshotVersion,_=v.withLastLimboFreeSnapshotVersion(x);h.Ms=h.Ms.insert(p,_)}}}(r.localStore,s))}async function wR(t,e){const n=Ae(t);if(!n.currentUser.isEqual(e)){he(Mp,"User change. New user:",e.toKey());const r=await Q1(n.localStore,e);n.currentUser=e,function(s,o){s.mu.forEach(c=>{c.forEach(a=>{a.reject(new ce(Y.CANCELLED,o))})}),s.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await El(n,r.Ls)}}function SR(t,e){const n=Ae(t),r=n.Au.get(e);if(r&&r.hu)return Le().add(r.key);{let i=Le();const s=n.Iu.get(e);if(!s)return i;for(const o of s){const c=n.Tu.get(o);i=i.unionWith(c.view.nu)}return i}}function mE(t){const e=Ae(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=uE.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=SR.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=gR.bind(null,e),e.Pu.H_=iR.bind(null,e.eventManager),e.Pu.yu=sR.bind(null,e.eventManager),e}function ER(t){const e=Ae(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=yR.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=vR.bind(null,e),e}class Su{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=td(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return IP(this.persistence,new TP,e.initialUser,this.serializer)}Cu(e){return new G1(xp.mi,this.serializer)}Du(e){return new DP}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Su.provider={build:()=>new Su};class TR extends Su{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){Ye(this.persistence.referenceDelegate instanceof _u,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new lP(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Sn.withCacheSize(this.cacheSizeBytes):Sn.DEFAULT;return new G1(r=>_u.mi(r,n),this.serializer)}}class Gf{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>c_(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=wR.bind(null,this.syncEngine),await tR(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new rR}()}createDatastore(e){const n=td(e.databaseInfo.databaseId),r=function(s){return new LP(s)}(e.databaseInfo);return function(s,o,c,a){return new zP(s,o,c,a)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,c){return new HP(r,i,s,o,c)}(this.localStore,this.datastore,e.asyncQueue,n=>c_(this.syncEngine,n,0),function(){return r_.v()?new r_:new jP}())}createSyncEngine(e,n){return function(i,s,o,c,a,d,h){const f=new cR(i,s,o,c,a,d);return h&&(f.gu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=Ae(i);he(fs,"RemoteStore shutting down."),s.Ea.add(5),await Sl(s),s.Aa.shutdown(),s.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}Gf.provider={build:()=>new Gf};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pE{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):zr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mi="FirestoreClient";class bR{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=ln.UNAUTHENTICATED,this.clientId=fp.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{he(Mi,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(he(Mi,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Or;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Dp(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function ch(t,e){t.asyncQueue.verifyOperationInProgress(),he(Mi,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await Q1(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function d_(t,e){t.asyncQueue.verifyOperationInProgress();const n=await xR(t);he(Mi,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>s_(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>s_(e.remoteStore,i)),t._onlineComponents=e}async function xR(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){he(Mi,"Using user provided OfflineComponentProvider");try{await ch(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===Y.FAILED_PRECONDITION||i.code===Y.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;_o("Error using user provided cache. Falling back to memory cache: "+n),await ch(t,new Su)}}else he(Mi,"Using default OfflineComponentProvider"),await ch(t,new TR(void 0));return t._offlineComponents}async function gE(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(he(Mi,"Using user provided OnlineComponentProvider"),await d_(t,t._uninitializedComponentsProvider._online)):(he(Mi,"Using default OnlineComponentProvider"),await d_(t,new Gf))),t._onlineComponents}function IR(t){return gE(t).then(e=>e.syncEngine)}async function yE(t){const e=await gE(t),n=e.eventManager;return n.onListen=uR.bind(null,e.syncEngine),n.onUnlisten=fR.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=dR.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=mR.bind(null,e.syncEngine),n}function CR(t,e,n={}){const r=new Or;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,c,a,d){const h=new pE({next:p=>{h.Nu(),o.enqueueAndForget(()=>sE(s,f));const v=p.docs.has(c);!v&&p.fromCache?d.reject(new ce(Y.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&p.fromCache&&a&&a.source==="server"?d.reject(new ce(Y.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(p)},error:p=>d.reject(p)}),f=new oE(vp(c.path),h,{includeMetadataChanges:!0,qa:!0});return iE(s,f)}(await yE(t),t.asyncQueue,e,n,r)),r.promise}function AR(t,e,n={}){const r=new Or;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,c,a,d){const h=new pE({next:p=>{h.Nu(),o.enqueueAndForget(()=>sE(s,f)),p.fromCache&&a.source==="server"?d.reject(new ce(Y.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(p)},error:p=>d.reject(p)}),f=new oE(c,h,{includeMetadataChanges:!0,qa:!0});return iE(s,f)}(await yE(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vE(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h_=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _E="firestore.googleapis.com",f_=!0;class m_{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ce(Y.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=_E,this.ssl=f_}else this.host=e.host,this.ssl=e.ssl??f_;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=q1;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<oP)throw new ce(Y.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}$N("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=vE(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new ce(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new ce(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new ce(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class id{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new m_({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ce(Y.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ce(Y.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new m_(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new DN;switch(r.type){case"firstParty":return new VN(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ce(Y.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=h_.get(n);r&&(he("ComponentProvider","Removing Datastore"),h_.delete(n),r.terminate())}(this),Promise.resolve()}}function NR(t,e,n,r={}){var d;t=Er(t,id);const i=yl(e),s=t._getSettings(),o={...s,emulatorOptions:t._getEmulatorOptions()},c=`${e}:${n}`;i&&(VS(`https://${c}`),FS("Firestore",!0)),s.host!==_E&&s.host!==c&&_o("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const a={...s,host:c,ssl:i,emulatorOptions:r};if(!uu(a,o)&&(t._setSettings(a),r.mockUserToken)){let h,f;if(typeof r.mockUserToken=="string")h=r.mockUserToken,f=ln.MOCK_USER;else{h=LS(r.mockUserToken,(d=t._app)==null?void 0:d.options.projectId);const p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new ce(Y.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new ln(p)}t._authCredentials=new jN(new i1(h,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new br(this.firestore,e,this._query)}}class kt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ci(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new kt(this.firestore,e,this._key)}toJSON(){return{type:kt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(vl(n,kt._jsonSchema))return new kt(e,r||null,new ve(it.fromString(n.referencePath)))}}kt._jsonSchemaVersion="firestore/documentReference/1.0",kt._jsonSchema={type:Ot("string",kt._jsonSchemaVersion),referencePath:Ot("string")};class Ci extends br{constructor(e,n,r){super(e,n,vp(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new kt(this.firestore,null,new ve(e))}withConverter(e){return new Ci(this.firestore,e,this._path)}}function kR(t,e,...n){if(t=An(t),s1("collection","path",e),t instanceof id){const r=it.fromString(e,...n);return Av(r),new Ci(t,null,r)}{if(!(t instanceof kt||t instanceof Ci))throw new ce(Y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(it.fromString(e,...n));return Av(r),new Ci(t.firestore,null,r)}}function wE(t,e,...n){if(t=An(t),arguments.length===1&&(e=fp.newId()),s1("doc","path",e),t instanceof id){const r=it.fromString(e,...n);return Cv(r),new kt(t,null,new ve(r))}{if(!(t instanceof kt||t instanceof Ci))throw new ce(Y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(it.fromString(e,...n));return Cv(r),new kt(t.firestore,t instanceof Ci?t.converter:null,new ve(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p_="AsyncQueue";class g_{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Y1(this,"async_queue_retry"),this._c=()=>{const r=lh();r&&he(p_,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=lh();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=lh();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new Or;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!jo(e))throw e;he(p_,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,zr("INTERNAL UNHANDLED ERROR: ",y_(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const i=Rp.createAndSchedule(this,e,n,r,s=>this.hc(s));return this.tc.push(i),i}uc(){this.nc&&Se(47125,{Pc:y_(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function y_(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Oo extends id{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new g_,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new g_(e),this._firestoreClient=void 0,await e}}}function PR(t,e){const n=typeof t=="object"?t:dp(),r=typeof t=="string"?t:hu,i=WS(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=MS("firestore");s&&NR(i,...s)}return i}function Vp(t){if(t._terminated)throw new ce(Y.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||RR(t),t._firestoreClient}function RR(t){var r,i,s;const e=t._freezeSettings(),n=function(c,a,d,h){return new tk(c,a,d,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,vE(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((s=e.localCache)!=null&&s._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new bR(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(c){const a=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(a),_online:a}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Hn(tn.fromBase64String(e))}catch(n){throw new ce(Y.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Hn(tn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Hn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(vl(e,Hn._jsonSchema))return Hn.fromBase64String(e.bytes)}}Hn._jsonSchemaVersion="firestore/bytes/1.0",Hn._jsonSchema={type:Ot("string",Hn._jsonSchemaVersion),bytes:Ot("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sd{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new ce(Y.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Jt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lp{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ce(Y.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ce(Y.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ve(this._lat,e._lat)||Ve(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:wr._jsonSchemaVersion}}static fromJSON(e){if(vl(e,wr._jsonSchema))return new wr(e.latitude,e.longitude)}}wr._jsonSchemaVersion="firestore/geoPoint/1.0",wr._jsonSchema={type:Ot("string",wr._jsonSchemaVersion),latitude:Ot("number"),longitude:Ot("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Sr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(vl(e,Sr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Sr(e.vectorValues);throw new ce(Y.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Sr._jsonSchemaVersion="firestore/vectorValue/1.0",Sr._jsonSchema={type:Ot("string",Sr._jsonSchemaVersion),vectorValues:Ot("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DR=/^__.*__$/;class jR{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new $i(e,this.data,this.fieldMask,n,this.fieldTransforms):new _l(e,this.data,n,this.fieldTransforms)}}class SE{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new $i(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function EE(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Se(40011,{Ac:t})}}class Fp{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Fp({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Eu(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(EE(this.Ac)&&DR.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class MR{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||td(e)}Cc(e,n,r,i=!1){return new Fp({Ac:e,methodName:n,Dc:r,path:Jt.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Tl(t){const e=t._freezeSettings(),n=td(t._databaseId);return new MR(t._databaseId,!!e.ignoreUndefinedProperties,n)}function TE(t,e,n,r,i,s={}){const o=t.Cc(s.merge||s.mergeFields?2:0,e,n,i);Up("Data must be an object, but it was:",o,r);const c=xE(r,o);let a,d;if(s.merge)a=new Mn(o.fieldMask),d=o.fieldTransforms;else if(s.mergeFields){const h=[];for(const f of s.mergeFields){const p=Qf(e,f,n);if(!o.contains(p))throw new ce(Y.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);CE(h,p)||h.push(p)}a=new Mn(h),d=o.fieldTransforms.filter(f=>a.covers(f.field))}else a=null,d=o.fieldTransforms;return new jR(new Tn(c),a,d)}class od extends Lp{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof od}}function OR(t,e,n,r){const i=t.Cc(1,e,n);Up("Data must be an object, but it was:",i,r);const s=[],o=Tn.empty();Bi(r,(a,d)=>{const h=Bp(e,a,n);d=An(d);const f=i.yc(h);if(d instanceof od)s.push(h);else{const p=bl(d,f);p!=null&&(s.push(h),o.set(h,p))}});const c=new Mn(s);return new SE(o,c,i.fieldTransforms)}function VR(t,e,n,r,i,s){const o=t.Cc(1,e,n),c=[Qf(e,r,n)],a=[i];if(s.length%2!=0)throw new ce(Y.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<s.length;p+=2)c.push(Qf(e,s[p])),a.push(s[p+1]);const d=[],h=Tn.empty();for(let p=c.length-1;p>=0;--p)if(!CE(d,c[p])){const v=c[p];let x=a[p];x=An(x);const _=o.yc(v);if(x instanceof od)d.push(v);else{const P=bl(x,_);P!=null&&(d.push(v),h.set(v,P))}}const f=new Mn(d);return new SE(h,f,o.fieldTransforms)}function bE(t,e,n,r=!1){return bl(n,t.Cc(r?4:3,e))}function bl(t,e){if(IE(t=An(t)))return Up("Unsupported field value:",e,t),xE(t,e);if(t instanceof Lp)return function(r,i){if(!EE(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const c of r){let a=bl(c,i.wc(o));a==null&&(a={nullValue:"NULL_VALUE"}),s.push(a),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=An(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return bk(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=ut.fromDate(r);return{timestampValue:vu(i.serializer,s)}}if(r instanceof ut){const s=new ut(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:vu(i.serializer,s)}}if(r instanceof wr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Hn)return{bytesValue:F1(i.serializer,r._byteString)};if(r instanceof kt){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Tp(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Sr)return function(o,c){return{mapValue:{fields:{[m1]:{stringValue:p1},[fu]:{arrayValue:{values:o.toArray().map(d=>{if(typeof d!="number")throw c.Sc("VectorValues must only contain numeric values.");return wp(c.serializer,d)})}}}}}}(r,i);throw i.Sc(`Unsupported field value: ${Wu(r)}`)}(t,e)}function xE(t,e){const n={};return l1(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Bi(t,(r,i)=>{const s=bl(i,e.mc(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function IE(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ut||t instanceof wr||t instanceof Hn||t instanceof kt||t instanceof Lp||t instanceof Sr)}function Up(t,e,n){if(!IE(n)||!o1(n)){const r=Wu(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function Qf(t,e,n){if((e=An(e))instanceof sd)return e._internalPath;if(typeof e=="string")return Bp(t,e);throw Eu("Field path arguments must be of type string or ",t,!1,void 0,n)}const LR=new RegExp("[~\\*/\\[\\]]");function Bp(t,e,n){if(e.search(LR)>=0)throw Eu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new sd(...e.split("."))._internalPath}catch{throw Eu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Eu(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let c=`Function ${e}() called with invalid data`;n&&(c+=" (via `toFirestore()`)"),c+=". ";let a="";return(s||o)&&(a+=" (found",s&&(a+=` in field ${r}`),o&&(a+=` in document ${i}`),a+=")"),new ce(Y.INVALID_ARGUMENT,c+t+a)}function CE(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zp{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new kt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new FR(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(ad("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class FR extends zp{data(){return super.data()}}function ad(t,e){return typeof e=="string"?Bp(t,e):e instanceof sd?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UR(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ce(Y.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class $p{}class xl extends $p{}function Tu(t,e,...n){let r=[];e instanceof $p&&r.push(e),r=r.concat(n),function(s){const o=s.filter(a=>a instanceof Hp).length,c=s.filter(a=>a instanceof ld).length;if(o>1||o>0&&c>0)throw new ce(Y.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class ld extends xl{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new ld(e,n,r)}_apply(e){const n=this._parse(e);return kE(e._query,n),new br(e.firestore,e.converter,Lf(e._query,n))}_parse(e){const n=Tl(e.firestore);return function(s,o,c,a,d,h,f){let p;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new ce(Y.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){__(f,h);const x=[];for(const _ of f)x.push(v_(a,s,_));p={arrayValue:{values:x}}}else p=v_(a,s,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||__(f,h),p=bE(c,o,f,h==="in"||h==="not-in");return Mt.create(d,h,p)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Kf(t,e,n){const r=e,i=ad("where",t);return ld._create(i,r,n)}class Hp extends $p{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Hp(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:ir.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const c=s.getFlattenedFilters();for(const a of c)kE(o,a),o=Lf(o,a)}(e._query,n),new br(e.firestore,e.converter,Lf(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Wp extends xl{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Wp(e,n)}_apply(e){const n=function(i,s,o){if(i.startAt!==null)throw new ce(Y.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new ce(Y.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ol(s,o)}(e._query,this._field,this._direction);return new br(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new zi(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}function AE(t,e="asc"){const n=e,r=ad("orderBy",t);return Wp._create(r,n)}class qp extends xl{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new qp(e,n,r)}_apply(e){return new br(e.firestore,e.converter,pu(e._query,this._limit,this._limitType))}}function BR(t){return HN("limit",t),qp._create("limit",t,"F")}class Gp extends xl{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Gp(e,n,r)}_apply(e){const n=NE(e,this.type,this._docOrFields,this._inclusive);return new br(e.firestore,e.converter,function(i,s){return new zi(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}}function zR(...t){return Gp._create("startAt",t,!0)}class Qp extends xl{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Qp(e,n,r)}_apply(e){const n=NE(e,this.type,this._docOrFields,this._inclusive);return new br(e.firestore,e.converter,function(i,s){return new zi(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}}function $R(...t){return Qp._create("endAt",t,!0)}function NE(t,e,n,r){if(n[0]=An(n[0]),n[0]instanceof zp)return function(s,o,c,a,d){if(!a)throw new ce(Y.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${c}().`);const h=[];for(const f of so(s))if(f.field.isKeyField())h.push(mu(o,a.key));else{const p=a.data.field(f.field);if(Qu(p))throw new ce(Y.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(p===null){const v=f.field.canonicalString();throw new ce(Y.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${v}' (used as the orderBy) does not exist.`)}h.push(p)}return new To(h,d)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const i=Tl(t.firestore);return function(o,c,a,d,h,f){const p=o.explicitOrderBy;if(h.length>p.length)throw new ce(Y.INVALID_ARGUMENT,`Too many arguments provided to ${d}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const v=[];for(let x=0;x<h.length;x++){const _=h[x];if(p[x].field.isKeyField()){if(typeof _!="string")throw new ce(Y.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${d}(), but got a ${typeof _}`);if(!_p(o)&&_.indexOf("/")!==-1)throw new ce(Y.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${d}() must be a plain document ID, but '${_}' contains a slash.`);const P=o.path.child(it.fromString(_));if(!ve.isDocumentKey(P))throw new ce(Y.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${d}() must result in a valid document path, but '${P}' is not because it contains an odd number of segments.`);const y=new ve(P);v.push(mu(c,y))}else{const P=bE(a,d,_);v.push(P)}}return new To(v,f)}(t._query,t.firestore._databaseId,i,e,n,r)}}function v_(t,e,n){if(typeof(n=An(n))=="string"){if(n==="")throw new ce(Y.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!_p(e)&&n.indexOf("/")!==-1)throw new ce(Y.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(it.fromString(n));if(!ve.isDocumentKey(r))throw new ce(Y.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return mu(t,new ve(r))}if(n instanceof kt)return mu(t,n._key);throw new ce(Y.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Wu(n)}.`)}function __(t,e){if(!Array.isArray(t)||t.length===0)throw new ce(Y.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function kE(t,e){const n=function(i,s){for(const o of i)for(const c of o.getFlattenedFilters())if(s.indexOf(c.op)>=0)return c.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new ce(Y.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ce(Y.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class HR{convertValue(e,n="none"){switch(Di(e)){case 0:return null;case 1:return e.booleanValue;case 2:return At(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ri(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Se(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Bi(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var r,i,s;const n=(s=(i=(r=e.fields)==null?void 0:r[fu].arrayValue)==null?void 0:i.values)==null?void 0:s.map(o=>At(o.doubleValue));return new Sr(n)}convertGeoPoint(e){return new wr(At(e.latitude),At(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Ku(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(rl(e));default:return null}}convertTimestamp(e){const n=Pi(e);return new ut(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=it.fromString(e);Ye(W1(r),9688,{name:e});const i=new il(r.get(1),r.get(3)),s=new ve(r.popFirst(5));return i.isEqual(n)||zr(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PE(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class ga{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ss extends zp{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new jc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(ad("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ce(Y.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=ss._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}ss._jsonSchemaVersion="firestore/documentSnapshot/1.0",ss._jsonSchema={type:Ot("string",ss._jsonSchemaVersion),bundleSource:Ot("string","DocumentSnapshot"),bundleName:Ot("string"),bundle:Ot("string")};class jc extends ss{data(e={}){return super.data(e)}}class ao{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new ga(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new jc(this._firestore,this._userDataWriter,r.key,r,new ga(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new ce(Y.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(c=>{const a=new jc(i._firestore,i._userDataWriter,c.doc.key,c.doc,new ga(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:a,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(c=>s||c.type!==3).map(c=>{const a=new jc(i._firestore,i._userDataWriter,c.doc.key,c.doc,new ga(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,h=-1;return c.type!==0&&(d=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),h=o.indexOf(c.doc.key)),{type:WR(c.type),doc:a,oldIndex:d,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ce(Y.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ao._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=fp.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(n.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function WR(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Se(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RE(t){t=Er(t,kt);const e=Er(t.firestore,Oo);return CR(Vp(e),t._key).then(n=>KR(e,t,n))}ao._jsonSchemaVersion="firestore/querySnapshot/1.0",ao._jsonSchema={type:Ot("string",ao._jsonSchemaVersion),bundleSource:Ot("string","QuerySnapshot"),bundleName:Ot("string"),bundle:Ot("string")};class DE extends HR{constructor(e){super(),this.firestore=e}convertBytes(e){return new Hn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new kt(this.firestore,null,n)}}function Mc(t){t=Er(t,br);const e=Er(t.firestore,Oo),n=Vp(e),r=new DE(e);return UR(t._query),AR(n,t._query).then(i=>new ao(e,r,t,i))}function qR(t,e,n){t=Er(t,kt);const r=Er(t.firestore,Oo),i=PE(t.converter,e,n);return Kp(r,[TE(Tl(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,nr.none())])}function GR(t,e,n,...r){t=Er(t,kt);const i=Er(t.firestore,Oo),s=Tl(i);let o;return o=typeof(e=An(e))=="string"||e instanceof sd?VR(s,"updateDoc",t._key,e,n,r):OR(s,"updateDoc",t._key,e),Kp(i,[o.toMutation(t._key,nr.exists(!0))])}function QR(t,e){const n=Er(t.firestore,Oo),r=wE(t),i=PE(t.converter,e);return Kp(n,[TE(Tl(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,nr.exists(!1))]).then(()=>r)}function Kp(t,e){return function(r,i){const s=new Or;return r.asyncQueue.enqueueAndForget(async()=>pR(await IR(r),i,s)),s.promise}(Vp(t),e)}function KR(t,e,n){const r=n.docs.get(e._key),i=new DE(t);return new ss(t,i,e._key,r,new ga(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(i){Ro=i})(GS),el(new vo("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),c=new Oo(new MN(r.getProvider("auth-internal")),new LN(o,r.getProvider("app-check-internal")),function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new ce(Y.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new il(d.options.projectId,h)}(o,i),o);return s={useFetchStreams:n,...s},c._setSettings(s),c},"PUBLIC").setMultipleInstances(!0)),xi(Tv,bv,e),xi(Tv,bv,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jE="firebasestorage.googleapis.com",ME="storageBucket",YR=2*60*1e3,XR=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It extends Es{constructor(e,n,r=0){super(uh(e),`Firebase Storage: ${n} (${uh(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,It.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return uh(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var xt;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(xt||(xt={}));function uh(t){return"storage/"+t}function Yp(){const t="An unknown error occurred, please check the error payload for server response.";return new It(xt.UNKNOWN,t)}function JR(t){return new It(xt.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function ZR(t){return new It(xt.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function e2(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new It(xt.UNAUTHENTICATED,t)}function t2(){return new It(xt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function n2(t){return new It(xt.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function r2(){return new It(xt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function i2(){return new It(xt.CANCELED,"User canceled the upload/download.")}function s2(t){return new It(xt.INVALID_URL,"Invalid URL '"+t+"'.")}function o2(t){return new It(xt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function a2(){return new It(xt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+ME+"' property when initializing the app?")}function l2(){return new It(xt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function c2(){return new It(xt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function u2(t){return new It(xt.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Yf(t){return new It(xt.INVALID_ARGUMENT,t)}function OE(){return new It(xt.APP_DELETED,"The Firebase app was deleted.")}function d2(t){return new It(xt.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Ra(t,e){return new It(xt.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function ia(t){throw new It(xt.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=On.makeFromUrl(e,n)}catch{return new On(e,"")}if(r.path==="")return r;throw o2(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(M){M.path.charAt(M.path.length-1)==="/"&&(M.path_=M.path_.slice(0,-1))}const o="(/(.*))?$",c=new RegExp("^gs://"+i+o,"i"),a={bucket:1,path:3};function d(M){M.path_=decodeURIComponent(M.path)}const h="v[A-Za-z0-9_]+",f=n.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",v=new RegExp(`^https?://${f}/${h}/b/${i}/o${p}`,"i"),x={bucket:1,path:3},_=n===jE?"(?:storage.googleapis.com|storage.cloud.google.com)":n,P="([^?#]*)",y=new RegExp(`^https?://${_}/${i}/${P}`,"i"),T=[{regex:c,indices:a,postModify:s},{regex:v,indices:x,postModify:d},{regex:y,indices:{bucket:1,path:2},postModify:d}];for(let M=0;M<T.length;M++){const L=T[M],B=L.regex.exec(e);if(B){const C=B[L.indices.bucket];let b=B[L.indices.path];b||(b=""),r=new On(C,b),L.postModify(r);break}}if(r==null)throw s2(e);return r}}class h2{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f2(t,e,n){let r=1,i=null,s=null,o=!1,c=0;function a(){return c===2}let d=!1;function h(...P){d||(d=!0,e.apply(null,P))}function f(P){i=setTimeout(()=>{i=null,t(v,a())},P)}function p(){s&&clearTimeout(s)}function v(P,...y){if(d){p();return}if(P){p(),h.call(null,P,...y);return}if(a()||o){p(),h.call(null,P,...y);return}r<64&&(r*=2);let T;c===1?(c=2,T=0):T=(r+Math.random())*1e3,f(T)}let x=!1;function _(P){x||(x=!0,p(),!d&&(i!==null?(P||(c=2),clearTimeout(i),f(0)):P||(c=1)))}return f(0),s=setTimeout(()=>{o=!0,_(!0)},n),_}function m2(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p2(t){return t!==void 0}function g2(t){return typeof t=="object"&&!Array.isArray(t)}function Xp(t){return typeof t=="string"||t instanceof String}function w_(t){return Jp()&&t instanceof Blob}function Jp(){return typeof Blob<"u"}function S_(t,e,n,r){if(r<e)throw Yf(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw Yf(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zp(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function VE(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var os;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(os||(os={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y2(t,e){const n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||i||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v2{constructor(e,n,r,i,s,o,c,a,d,h,f,p=!0,v=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=c,this.errorCallback_=a,this.timeout_=d,this.progressCallback_=h,this.connectionFactory_=f,this.retry=p,this.isUsingEmulator=v,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((x,_)=>{this.resolve_=x,this.reject_=_,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new oc(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=c=>{const a=c.loaded,d=c.lengthComputable?c.total:-1;this.progressCallback_!==null&&this.progressCallback_(a,d)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const c=s.getErrorCode()===os.NO_ERROR,a=s.getStatus();if(!c||y2(a,this.additionalRetryCodes_)&&this.retry){const h=s.getErrorCode()===os.ABORT;r(!1,new oc(!1,null,h));return}const d=this.successCodes_.indexOf(a)!==-1;r(!0,new oc(d,s))})},n=(r,i)=>{const s=this.resolve_,o=this.reject_,c=i.connection;if(i.wasSuccessCode)try{const a=this.callback_(c,c.getResponse());p2(a)?s(a):s()}catch(a){o(a)}else if(c!==null){const a=Yp();a.serverResponse=c.getErrorText(),this.errorCallback_?o(this.errorCallback_(c,a)):o(a)}else if(i.canceled){const a=this.appDelete_?OE():i2();o(a)}else{const a=r2();o(a)}};this.canceled_?n(!1,new oc(!1,null,!0)):this.backoffId_=f2(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&m2(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class oc{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function _2(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function w2(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function S2(t,e){e&&(t["X-Firebase-GMPID"]=e)}function E2(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function T2(t,e,n,r,i,s,o=!0,c=!1){const a=VE(t.urlParams),d=t.url+a,h=Object.assign({},t.headers);return S2(h,e),_2(h,n),w2(h,s),E2(h,r),new v2(d,t.method,h,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o,c)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b2(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function x2(...t){const e=b2();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(Jp())return new Blob(t);throw new It(xt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function I2(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C2(t){if(typeof atob>"u")throw u2("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class dh{constructor(e,n){this.data=e,this.contentType=n||null}}function A2(t,e){switch(t){case pr.RAW:return new dh(LE(e));case pr.BASE64:case pr.BASE64URL:return new dh(FE(t,e));case pr.DATA_URL:return new dh(k2(e),P2(e))}throw Yp()}function LE(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const s=r,o=t.charCodeAt(++n);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function N2(t){let e;try{e=decodeURIComponent(t)}catch{throw Ra(pr.DATA_URL,"Malformed data URL.")}return LE(e)}function FE(t,e){switch(t){case pr.BASE64:{const i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw Ra(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case pr.BASE64URL:{const i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw Ra(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=C2(e)}catch(i){throw i.message.includes("polyfill")?i:Ra(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}class UE{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Ra(pr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=R2(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function k2(t){const e=new UE(t);return e.base64?FE(pr.BASE64,e.rest):N2(e.rest)}function P2(t){return new UE(t).contentType}function R2(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi{constructor(e,n){let r=0,i="";w_(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,n){if(w_(this.data_)){const r=this.data_,i=I2(r,e,n);return i===null?null:new oi(i)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new oi(r,!0)}}static getBlob(...e){if(Jp()){const n=e.map(r=>r instanceof oi?r.data_:r);return new oi(x2.apply(null,n))}else{const n=e.map(o=>Xp(o)?A2(pr.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const i=new Uint8Array(r);let s=0;return n.forEach(o=>{for(let c=0;c<o.length;c++)i[s++]=o[c]}),new oi(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BE(t){let e;try{e=JSON.parse(t)}catch{return null}return g2(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D2(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function j2(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function zE(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M2(t,e){return e}class mn{constructor(e,n,r,i){this.server=e,this.local=n||e,this.writable=!!r,this.xform=i||M2}}let ac=null;function O2(t){return!Xp(t)||t.length<2?t:zE(t)}function $E(){if(ac)return ac;const t=[];t.push(new mn("bucket")),t.push(new mn("generation")),t.push(new mn("metageneration")),t.push(new mn("name","fullPath",!0));function e(s,o){return O2(o)}const n=new mn("name");n.xform=e,t.push(n);function r(s,o){return o!==void 0?Number(o):o}const i=new mn("size");return i.xform=r,t.push(i),t.push(new mn("timeCreated")),t.push(new mn("updated")),t.push(new mn("md5Hash",null,!0)),t.push(new mn("cacheControl",null,!0)),t.push(new mn("contentDisposition",null,!0)),t.push(new mn("contentEncoding",null,!0)),t.push(new mn("contentLanguage",null,!0)),t.push(new mn("contentType",null,!0)),t.push(new mn("metadata","customMetadata",!0)),ac=t,ac}function V2(t,e){function n(){const r=t.bucket,i=t.fullPath,s=new On(r,i);return e._makeStorageReference(s)}Object.defineProperty(t,"ref",{get:n})}function L2(t,e,n){const r={};r.type="file";const i=n.length;for(let s=0;s<i;s++){const o=n[s];r[o.local]=o.xform(r,e[o.server])}return V2(r,t),r}function HE(t,e,n){const r=BE(e);return r===null?null:L2(t,r,n)}function F2(t,e,n,r){const i=BE(e);if(i===null||!Xp(i.downloadTokens))return null;const s=i.downloadTokens;if(s.length===0)return null;const o=encodeURIComponent;return s.split(",").map(d=>{const h=t.bucket,f=t.fullPath,p="/b/"+o(h)+"/o/"+o(f),v=Zp(p,n,r),x=VE({alt:"media",token:d});return v+x})[0]}function U2(t,e){const n={},r=e.length;for(let i=0;i<r;i++){const s=e[i];s.writable&&(n[s.server]=t[s.local])}return JSON.stringify(n)}class WE{constructor(e,n,r,i){this.url=e,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qE(t){if(!t)throw Yp()}function B2(t,e){function n(r,i){const s=HE(t,i,e);return qE(s!==null),s}return n}function z2(t,e){function n(r,i){const s=HE(t,i,e);return qE(s!==null),F2(s,i,t.host,t._protocol)}return n}function GE(t){function e(n,r){let i;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?i=t2():i=e2():n.getStatus()===402?i=ZR(t.bucket):n.getStatus()===403?i=n2(t.path):i=r,i.status=n.getStatus(),i.serverResponse=r.serverResponse,i}return e}function $2(t){const e=GE(t);function n(r,i){let s=e(r,i);return r.getStatus()===404&&(s=JR(t.path)),s.serverResponse=i.serverResponse,s}return n}function H2(t,e,n){const r=e.fullServerUrl(),i=Zp(r,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,c=new WE(i,s,z2(t,n),o);return c.errorHandler=$2(e),c}function W2(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function q2(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=W2(null,e)),r}function G2(t,e,n,r,i){const s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function c(){let T="";for(let M=0;M<2;M++)T=T+Math.random().toString().slice(2);return T}const a=c();o["Content-Type"]="multipart/related; boundary="+a;const d=q2(e,r,i),h=U2(d,n),f="--"+a+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+a+`\r
Content-Type: `+d.contentType+`\r
\r
`,p=`\r
--`+a+"--",v=oi.getBlob(f,r,p);if(v===null)throw l2();const x={name:d.fullPath},_=Zp(s,t.host,t._protocol),P="POST",y=t.maxUploadRetryTime,w=new WE(_,P,B2(t,n),y);return w.urlParams=x,w.headers=o,w.body=v.uploadData(),w.errorHandler=GE(e),w}class Q2{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=os.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=os.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=os.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,i,s){if(this.sent_)throw ia("cannot .send() more than once");if(yl(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),s!==void 0)for(const o in s)s.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,s[o].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw ia("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw ia("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw ia("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw ia("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class K2 extends Q2{initXhr(){this.xhr_.responseType="text"}}function QE(){return new K2}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ms{constructor(e,n){this._service=e,n instanceof On?this._location=n:this._location=On.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new ms(e,n)}get root(){const e=new On(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return zE(this._location.path)}get storage(){return this._service}get parent(){const e=D2(this._location.path);if(e===null)return null;const n=new On(this._location.bucket,e);return new ms(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw d2(e)}}function Y2(t,e,n){t._throwIfRoot("uploadBytes");const r=G2(t.storage,t._location,$E(),new oi(e,!0),n);return t.storage.makeRequestWithTokens(r,QE).then(i=>({metadata:i,ref:t}))}function X2(t){t._throwIfRoot("getDownloadURL");const e=H2(t.storage,t._location,$E());return t.storage.makeRequestWithTokens(e,QE).then(n=>{if(n===null)throw c2();return n})}function J2(t,e){const n=j2(t._location.path,e),r=new On(t._location.bucket,n);return new ms(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z2(t){return/^[A-Za-z]+:\/\//.test(t)}function eD(t,e){return new ms(t,e)}function KE(t,e){if(t instanceof eg){const n=t;if(n._bucket==null)throw a2();const r=new ms(n,n._bucket);return e!=null?KE(r,e):r}else return e!==void 0?J2(t,e):t}function tD(t,e){if(e&&Z2(e)){if(t instanceof eg)return eD(t,e);throw Yf("To use ref(service, url), the first argument must be a Storage instance.")}else return KE(t,e)}function E_(t,e){const n=e==null?void 0:e[ME];return n==null?null:On.makeFromBucketSpec(n,t)}function nD(t,e,n,r={}){t.host=`${e}:${n}`;const i=yl(e);i&&(VS(`https://${t.host}/b`),FS("Storage",!0)),t._isUsingEmulator=!0,t._protocol=i?"https":"http";const{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:LS(s,t.app.options.projectId))}class eg{constructor(e,n,r,i,s,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=jE,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=YR,this._maxUploadRetryTime=XR,this._requests=new Set,i!=null?this._bucket=On.makeFromBucketSpec(i,this._host):this._bucket=E_(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=On.makeFromBucketSpec(this._url,e):this._bucket=E_(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){S_("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){S_("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(qS(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ms(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new h2(OE());{const o=T2(e,this._appId,r,i,n,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()}}const T_="@firebase/storage",b_="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YE="storage";function x_(t,e,n){return t=An(t),Y2(t,e,n)}function rD(t){return t=An(t),X2(t)}function iD(t,e){return t=An(t),tD(t,e)}function sD(t=dp(),e){t=An(t);const r=WS(t,YE).getImmediate({identifier:e}),i=MS("storage");return i&&oD(r,...i),r}function oD(t,e,n,r={}){nD(t,e,n,r)}function aD(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new eg(n,r,i,e,GS)}function lD(){el(new vo(YE,aD,"PUBLIC").setMultipleInstances(!0)),xi(T_,b_,""),xi(T_,b_,"esm2020")}lD();const I_={apiKey:"AIzaSyBEFE5oeajyI6VXHG5T17xLue8eRQNRzzk",authDomain:"kusgan-6ca2f.firebaseapp.com",projectId:"kusgan-6ca2f",storageBucket:"kusgan-6ca2f.firebasestorage.app",appId:"1:653741419351:web:39de9b909a028bb89a6c12"};let Qi,C_,Xf;function tg(){if(!Qi){if(vv&&vv().length)try{Qi=dp()}catch{}if(!Qi){if(!I_.projectId)throw new Error("Missing Firebase config in VITE_FIREBASE_PROJECT_ID");Qi=QS(I_)}C_=PR(Qi);try{Xf=sD(Qi)}catch{Xf=null}}return{app:Qi,db:C_}}function ng(){return tg().db}function cd(t){return kR(ng(),t)}function ud(t,e){return wE(ng(),t,String(e))}async function cD(t,e={}){const n=cd(t);if(e.where){const i=Tu(n,Kf(e.where.field,e.where.op||"==",e.where.value));return(await Mc(i)).docs.map(o=>({id:o.id,...o.data()}))}if(e.orderBy){const i=Tu(n,AE(e.orderBy.field,e.orderBy.dir||"asc"));return(await Mc(i)).docs.map(o=>({id:o.id,...o.data()}))}return(await Mc(n)).docs.map(i=>({id:i.id,...i.data()}))}async function uD(t,e={}){const n=cd(t),r=[];if(Array.isArray(e.wheres))for(const o of e.wheres)r.push(Kf(o.field,o.op||"==",o.value));else e.where&&r.push(Kf(e.where.field,e.where.op||"==",e.where.value));e.orderBy&&r.push(AE(e.orderBy.field,e.orderBy.dir||"asc")),e.startAt!==void 0&&r.push(zR(e.startAt)),e.endAt!==void 0&&r.push($R(e.endAt)),e.limit&&r.push(BR(Number(e.limit)));const i=r.length?Tu(n,...r):Tu(n);return(await Mc(i)).docs.map(o=>({id:o.id,...o.data()}))}function XE(){return tg(),Xf}async function dD(t,e){const n=XE();if(!n)throw new Error("Firebase Storage not initialized or not configured");const r=iD(n,t);if(typeof e=="string"){const i=e.replace(/^data:.*;base64,/,""),s=atob(i),o=new Uint8Array(s.length);for(let c=0;c<s.length;c++)o[c]=s.charCodeAt(c);await x_(r,o)}else await x_(r,e);return await rD(r)}async function hD(t,e){const n=ud(t,e),r=await RE(n);return r.exists()?{id:r.id,...r.data()}:null}async function fD(t,e){const n=cd(t);return{id:(await QR(n,e)).id,...e}}async function mD(t,e,n){const r=ud(t,e);return await qR(r,n,{merge:!0}),{id:e,...n}}async function pD(t,e,n){const r=ud(t,e);await GR(r,n);const i=await RE(r);return{id:i.id,...i.data()}}const ke={ensureFirebase:tg,getDB:ng,colRef:cd,docRef:ud,getCollection:cD,queryCollection:uD,getDocById:hD,addDocument:fD,setDocument:mD,updateDocument:pD,getStorageInstance:XE,uploadFile:dD},Ne={members:"members",gymEntries:"gymEntries",payments:"payments",progress:"progress",attendance:"attendance",pricing:"pricing"};function JE(t){if(!t)return null;const e=String(t).trim().toLowerCase();return e==="members"?Ne.members:e==="gymentries"||e==="gymentries"||e==="gymentries"?Ne.gymEntries:e==="payments"?Ne.payments:e==="progresstracker"||e==="progress"?Ne.progress:e==="attendance"?Ne.attendance:e==="pricing"?Ne.pricing:e}function ZE(t){if(!t)return null;const e={...t};return e.memberid=String(t.memberId||t.MemberID||t.id||t.memberid||"").trim(),e.firstname=t.firstName||t.firstname||t.FirstName||"",e.lastname=t.lastName||t.lastname||t.LastName||"",e._raw=t,e}async function dd(){return{rows:(await ke.getCollection(Ne.members)).map(e=>({...e}))}}async function eT(){return dd()}async function rg(t){try{if(typeof fetch=="function"){const n=await fetch("/api/members/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(n&&n.status===201)try{return await n.json()}catch{}if(n&&n.status===409)try{return await n.json()}catch{return{ok:!1,error:"Nickname already taken"}}}}catch{}try{const n=String(t.NickName||t.nickName||t.nickname||"").trim();if(n){const r=[];try{const i=await ke.queryCollection(Ne.members,{wheres:[{field:"NickName",op:"==",value:n}]});r.push(...i||[])}catch{}try{const i=await ke.queryCollection(Ne.members,{wheres:[{field:"nickname",op:"==",value:n}]});r.push(...i||[])}catch{}if(r.length>0&&r.some(s=>String(s.NickName||s.nickname||s.nick_name||s.nickName||"").trim().toLowerCase()===n.toLowerCase()))return{ok:!1,error:"Nickname already taken"}}}catch{}const e=await ke.addDocument(Ne.members,t);return{ok:!0,id:e.id,row:e}}async function tT(t){return rg(t)}async function nT(t){const e=String(t.MemberID||t.memberId||t.id||t.memberid||"").trim();if(!e)throw new Error("MemberID required for update");try{return await ke.setDocument(Ne.members,e,t),{ok:!0}}catch(n){try{const r=await fetch(`/api/members/${encodeURIComponent(e)}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(r&&r.ok)try{return await r.json()}catch{return{ok:!0}}throw n}catch(r){throw r||n}}}async function ig(t){if(!t)return null;const e=await ke.getDocById(Ne.members,String(t));return e?ZE(e):null}async function rT(t){return ig(t)}async function iT(t){if(!t)throw new Error("memberId required");const[e,n,r,i]=await Promise.all([dd(),ke.getCollection(Ne.payments),ke.getCollection(Ne.gymEntries),ke.getCollection(Ne.progress)]),s=String(t).trim(),o=(e.rows||[]).find(h=>String(h.MemberID||h.memberId||h.id||h.memberid||"").trim()===s)||null;ZE(o);const c=(n||[]).filter(h=>String(h.MemberID||h.memberId||h.id||h.memberid||"").trim()===s),a=(r||[]).filter(h=>String(h.MemberID||h.memberId||h.id||h.memberid||"").trim()===s),d=(i||[]).filter(h=>String(h.MemberID||h.memberId||h.id||h.memberid||"").trim()===s);return{member:o,payments:c,gymEntries:a,progress:d}}async function sg(){return{rows:await ke.getCollection(Ne.gymEntries)}}async function sT(){return sg()}async function ps(t){return{ok:!0,id:(await ke.addDocument(Ne.gymEntries,t)).id}}async function oT(t,e={}){if(!t)throw new Error("memberId required");const n=new Date().toISOString(),r=n.slice(0,10),i=!!e.wantsOut,s={...e};if(!i)return!s.TimeIn&&!s.timeIn&&(s.TimeIn=n),!s.Date&&!s.date&&(s.Date=r),s.MemberID=t,await ps(s);const o=await ke.getCollection(Ne.gymEntries),c=f=>{try{if(String(f.MemberID||f.memberId||f.memberid||"").trim()!==String(t).trim())return!1;if(s.TimeIn&&s.Date){const v=String(f.TimeIn||f.timeIn||""),x=String(f.Date||f.date||"");if(v&&x&&String(s.TimeIn)===String(v)&&String(s.Date)===String(x))return!0}return!1}catch{return!1}};let a=null;if(s.TimeIn&&s.Date&&(a=o.find(c)||null),!a){const f=new Date;f.setHours(0,0,0,0);const p=o.filter(v=>{try{if(String(v.MemberID||v.memberId||v.memberid||"").trim()!==String(t).trim())return!1;const _=new Date(v.Date||v.date||v.DateTime||v.timestamp||v.TimeIn||"");if(isNaN(_))return!1;_.setHours(0,0,0,0);const P=_.getTime()===f.getTime(),y=v.TimeOut||v.timeOut||v.Timeout||v.TimeOUT;return P&&(!y||String(y).trim()==="")}catch{return!1}}).sort((v,x)=>{const _=v.TimeIn||v.timeIn||"",P=x.TimeIn||x.timeIn||"";return String(P).localeCompare(String(_))});a=p.length?p[0]:null}const d=new Date().toISOString();if(!a){const f={MemberID:t,TimeOut:d,Date:s.Date||r};return s.Workouts&&(f.Workouts=s.Workouts),s.Comments&&(f.Comments=s.Comments),s.Coach&&(f.Coach=s.Coach),s.Focus&&(f.Focus=s.Focus),await ps(f)}const h={TimeOut:d};s.Workouts&&(h.Workouts=s.Workouts),s.Comments&&(h.Comments=s.Comments),s.Coach&&(h.Coach=s.Coach),s.Focus&&(h.Focus=s.Focus);try{const f=a.TimeIn||a.timeIn||"";if(f){const p=new Date(f),v=new Date(d);if(!isNaN(p)&&!isNaN(v)&&v>p){const x=(v-p)/36e5;h.TotalHours=Math.round(x*100)/100}}}catch{}return await ke.updateDocument(Ne.gymEntries,a.id,h),{ok:!0,id:a.id}}async function gD(t,e={}){if(!t)throw new Error("memberId is required");const n=await ke.getCollection(Ne.gymEntries),r=new Date;r.setHours(0,0,0,0);const i=n.find(a=>{try{const d=String(a.MemberID||a.memberId||a.memberid||a.id||"");if(!d||d.trim()!==String(t).trim())return!1;const h=new Date(a.Date||a.date||a.DateTime||a.timestamp||"");if(isNaN(h))return!1;h.setHours(0,0,0,0);const f=h.getTime()===r.getTime(),p=a.TimeOut||a.timeOut||a.Timeout||a.TimeOUT;return f&&(!p||String(p).trim()==="")}catch{return!1}});if(i)return{ok:!0,id:i.id,existed:!0};const s=new Date().toISOString(),o=s.slice(0,10);return await ps({MemberID:t,TimeIn:s,Date:o,...e})}async function yD(t,e={}){if(!t)throw new Error("memberId is required");const r=(await ke.getCollection(Ne.gymEntries)).filter(c=>String(c.MemberID||c.memberId||c.memberid||"").trim()===String(t).trim()&&!(c.TimeOut||c.timeOut||"").toString().trim()).sort((c,a)=>{const d=c.TimeIn||c.timeIn||"",h=a.TimeIn||a.timeIn||"";return String(d).localeCompare(String(h))});if(!r.length){const c=new Date().toISOString(),a=c.slice(0,10);return ps({MemberID:t,TimeOut:c,Date:a,...e})}const i=r[r.length-1],s=new Date().toISOString(),o={TimeOut:s};e&&Object.assign(o,e);try{const c=i.TimeIn||i.timeIn||"";if(c){const a=new Date(c),d=new Date(s);if(!isNaN(a)&&!isNaN(d)&&d>a){const h=(d-a)/36e5;o.TotalHours=Math.round(h*100)/100}}}catch{}return await ke.updateDocument(Ne.gymEntries,i.id,o),{ok:!0,id:i.id}}async function vD(t){if(!t)throw new Error("payload required");const e=t.MemberID||t.memberId||t.memberid||"";if(t.id)return await ke.updateDocument(Ne.gymEntries,String(t.id),t),{ok:!0};const r=(await ke.getCollection(Ne.gymEntries)).find(s=>{try{const o=String(s.MemberID||s.memberId||s.memberid||"").trim();if(!o||String(o)!==String(e).trim())return!1;const c=String(s.TimeIn||s.timeIn||""),a=String(t.TimeIn||t.timeIn||""),d=String(s.Date||s.date||""),h=String(t.Date||t.date||"");return!!(a&&c&&a===c&&h&&d&&h===d||t.rowNumber&&String(s.rowNumber||"")===String(t.rowNumber))}catch{return!1}});if(r){try{const s=t.TimeIn||t.timeIn||"",o=t.TimeOut||t.timeOut||"";if(s&&o&&(t.TotalHours===void 0||t.TotalHours===null||t.TotalHours==="")){const c=new Date(s),a=new Date(o);if(!isNaN(c)&&!isNaN(a)&&a>c){const d=(a-c)/36e5;t.TotalHours=Math.round(d*100)/100}}}catch{}return await ke.updateDocument(Ne.gymEntries,r.id,t),{ok:!0,id:r.id}}return await ps(t)}async function aT(){return{rows:await ke.getCollection(Ne.progress)}}async function lT(t){if(!t)throw new Error("row required");try{return{ok:!0,id:(await ke.addDocument(Ne.progress,t)).id}}catch(e){try{if(typeof fetch=="function"){const n=await fetch("/api/progress",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(n&&n.ok)try{return await n.json()}catch{return{ok:!0}}}}catch{}throw e}}async function cT({limit:t=200,days:e=90}={}){const n=new Date(Date.now()-e*24*60*60*1e3);let r=[],i=[],s=[];try{[r,i,s]=await Promise.all([ke.getCollection(Ne.members),ke.getCollection(Ne.payments),ke.getCollection(Ne.gymEntries)])}catch{r=i=s=[]}if((!r||r.length===0)&&typeof fetch=="function")try{const[h,f,p]=await Promise.all([fetch("/api/members"),fetch("/api/payments"),fetch("/api/gymEntries")]);h&&h.ok&&(r=await h.json()),f&&f.ok&&(i=await f.json()),p&&p.ok&&(s=await p.json())}catch{}const o=(r||[]).map(h=>({...h})),c=new Set,a=h=>{if(!h)return null;const f=h instanceof Date?h:new Date(h);return isNaN(f)?null:f};for(const h of o){const f=a(h.memberDate||h.member_date||h.member_since||h.membersince||h.MemberSince||h.MemberSince||h.MemberDate||h.memberSince||h.createdAt||h.created_at||h.joined||h.start_date);f&&f>=n&&c.add(String(h.memberId||h.MemberID||h.memberId||h.id||h.memberid||h.member||"").trim())}for(const h of i||[]){const f=a(h.date||h.Date||h.createdAt||h.created_at||h.timestamp);if(f&&f>=n){const p=String(h.MemberID||h.memberId||h.memberid||h.id||"").trim();p&&c.add(p)}}for(const h of s||[]){const f=a(h.Date||h.date||h.DateTime||h.timestamp||h.timeIn||h.TimeIn);if(f&&f>=n){const p=String(h.MemberID||h.memberId||h.memberid||h.id||"").trim();p&&c.add(p)}}let d=[];return c.size>0?d=o.filter(h=>c.has(String(h.memberId||h.MemberID||h.id||h.memberid||"").trim())):d=[...o].sort((h,f)=>{const p=a(h.memberDate||h.createdAt||h.joined),v=a(f.memberDate||f.createdAt||f.joined);return!p&&!v?0:p?v?v-p:-1:1}),{rows:d.slice(0,Math.max(0,Number(t)||200))}}const hh=new Map,_D=1e3*30;async function uT(t,{limit:e=200}={}){if(!t||!String(t).trim())return{rows:[]};const r=String(t).trim().toLowerCase(),i=`search:${r}`,s=hh.get(i);if(s&&Date.now()-s.ts<_D)return{rows:s.rows.slice(0,e)};const o=r+"",c=["firstName","firstname","lastName","lastname","nickname","nick_name","nickName"],a=new Map;try{for(const h of c)try{const f=await ke.queryCollection(Ne.members,{orderBy:{field:h},startAt:r,endAt:o,limit:e});for(const p of f)a.set(p.id||String(p.MemberID||p.memberId||p.id||""),p)}catch{continue}if(a.size===0){const h=await ke.getCollection(Ne.members);for(const f of h)JSON.stringify(f).toLowerCase().indexOf(r)!==-1&&a.set(f.id||String(f.MemberID||f.memberId||f.id||""),f)}const d=Array.from(a.values()).slice(0,e).map(h=>({...h}));return hh.set(i,{rows:d,ts:Date.now()}),{rows:d}}catch{try{const f=(await ke.getCollection(Ne.members)||[]).filter(p=>JSON.stringify(p).toLowerCase().indexOf(r)!==-1).slice(0,e);return hh.set(i,{rows:f,ts:Date.now()}),{rows:f}}catch{return{rows:[]}}}}async function wD(t){const e=JE(t);return e?{rows:await ke.getCollection(e)}:{rows:[]}}async function SD(t,e){const n=JE(t);if(!n)throw new Error("Unknown sheet: "+t);return{ok:!0,id:(await ke.addDocument(n,e)).id}}async function dT(){return{rows:await ke.getCollection(Ne.payments)}}async function hT(t){return{ok:!0,id:(await ke.addDocument(Ne.payments,t)).id}}async function fT(t,e){const n=r=>new Promise((i,s)=>{try{const o=new FileReader;o.onload=()=>i(o.result),o.onerror=c=>s(c),o.readAsDataURL(r)}catch(o){s(o)}});try{if(t instanceof Blob||typeof File<"u"&&t instanceof File){const d=t,h=d&&d.name||`photo-${Date.now()}.jpg`,f=`members/${String(e||"unknown")}/${h}`;return await ke.uploadFile(f,d)}const r=t||{},i=r.memberId||r.MemberID||e||"unknown",s=r.filename||`photo-${Date.now()}.jpg`,o=r.data||r.base64||"",c=`members/${String(i)}/${s}`;return await ke.uploadFile(c,o)}catch(r){try{let i="",s=`photo-${Date.now()}.jpg`;if(t instanceof Blob||typeof File<"u"&&t instanceof File){const a=t;i=await n(a),s=a&&a.name||s}else{const a=t||{};i=a.data||a.base64||"",s=a.filename||s}if(!i)throw new Error("no data for fallback upload");const o=await fetch("/api/upload-photo",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filename:s,data:i})});if(!o.ok)throw new Error("proxy upload failed");const c=await o.json();if(c&&c.url)return c.url.indexOf("http")===0?c.url:`${location.origin}${c.url}`;throw new Error("invalid proxy response")}catch(i){throw new Error("uploadMemberPhoto failed: "+String((i==null?void 0:i.message)||r))}}}async function mT(t){return fT(t)}async function pT(){return{rows:await ke.getCollection(Ne.pricing)}}async function gT(t){const e=await ke.addDocument(Ne.pricing,t);return{ok:!0,id:e.id,row:e}}async function yT(t,e){const n=await ke.updateDocument(Ne.pricing,String(t),e);return{ok:!0,id:n.id,row:n}}async function vT(t){const e=await ke.getCollection(Ne.attendance);return t?{rows:e.filter(n=>String(n.Date||"").startsWith(String(t)))}:{rows:e}}async function _T(t){if(!t)throw new Error("staff required");const e=new Date().toISOString();return{ok:!0,id:(await ke.addDocument(Ne.attendance,{Staff:t,TimeIn:e,Date:e.slice(0,10)})).id}}async function wT(t){const n=(await ke.getCollection(Ne.attendance)).filter(i=>String(i.Staff)===String(t)&&(!i.TimeOut||i.TimeOut==="")).sort((i,s)=>(i.TimeIn||"").localeCompare(s.TimeIn||""));if(!n.length)return{ok:!1,error:"no open entry"};const r=n[n.length-1];return await ke.updateDocument(Ne.attendance,r.id,{TimeOut:new Date().toISOString()}),{ok:!0}}async function ED(t,e={}){if(!t)throw new Error("staff required");const n=new Date().toISOString(),r=n.slice(0,10);return{ok:!0,id:(await ke.addDocument(Ne.attendance,{Staff:t,TimeIn:n,Date:r,...e})).id}}async function ST(){return{rows:[]}}const TD={fetchMembers:dd,fetchMembersFresh:eT,addMember:rg,saveMember:tT,updateMember:nT,fetchMemberById:ig,fetchMemberByIdFresh:rT,fetchMemberBundle:iT,fetchAttendance:vT,clockIn:_T,clockOut:wT,fetchGymEntries:sg,fetchGymEntriesFresh:sT,addGymEntry:ps,gymQuickAppend:oT,fetchProgressTracker:aT,addProgressRow:lT,fetchPricing:pT,fetchPayments:dT,addPayment:hT,fetchDashboard:ST,fetchMembersRecent:cT,searchMembersByName:uT,addPricing:gT,updatePricing:yT,uploadPhoto:mT},bD=Object.freeze(Object.defineProperty({__proto__:null,addGymEntry:ps,addMember:rg,addPayment:hT,addPricing:gT,addProgressRow:lT,attendanceQuickAppend:ED,clockIn:_T,clockOut:wT,default:TD,fetchAttendance:vT,fetchDashboard:ST,fetchGymEntries:sg,fetchGymEntriesFresh:sT,fetchMemberBundle:iT,fetchMemberById:ig,fetchMemberByIdFresh:rT,fetchMembers:dd,fetchMembersFresh:eT,fetchMembersRecent:cT,fetchPayments:dT,fetchPricing:pT,fetchProgressTracker:aT,fetchSheet:wD,gymClockIn:gD,gymClockOut:yD,gymQuickAppend:oT,insertRow:SD,saveMember:tT,searchMembersByName:uT,updateMember:nT,updatePricing:yT,uploadMemberPhoto:fT,uploadPhoto:mT,upsertGymEntry:vD},Symbol.toStringTag,{value:"Module"})),tt=bD,A_=N.createContext(!1);function xs({open:t,onClose:e,title:n,children:r,width:i=760,maxHeight:s="90vh",noWrapper:o=!1,noInternalScroll:c=!1}){if(!t)return null;const a=N.useContext(A_),h={width:"min(1000px, 96vw)",background:"#fff",borderRadius:14,padding:16,border:"1px solid var(--light-border)",boxShadow:"0 20px 60px rgba(0,0,0,.2)",maxHeight:s,overflowY:"auto",overflowX:"hidden",boxSizing:"border-box"};return a&&!o?u.jsx("div",{style:h,children:r}):u.jsx(A_.Provider,{value:!0,children:u.jsx("div",{onClick:f=>{f.target===f.currentTarget&&e&&e()},style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:o?(()=>{const f={width:`min(${i}px, 96vw)`,background:"#fff",borderRadius:14,padding:16,border:"1px solid var(--light-border)",boxShadow:"0 20px 60px rgba(0,0,0,.2)",maxHeight:"98vh",overflow:"visible",boxSizing:"border-box"};return u.jsxs("div",{style:f,onClick:p=>p.stopPropagation(),children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[n?u.jsx("div",{style:{fontWeight:800,fontSize:18},children:n}):u.jsx("div",{}),u.jsx("button",{type:"button",className:"button",onClick:e,style:{background:"#eee",color:"#333"},children:""})]}),r]})})():c?(()=>{const f={...h,maxHeight:"98vh",overflowY:"visible"};return u.jsxs("div",{style:f,onClick:p=>p.stopPropagation(),children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10},children:[n?u.jsx("div",{style:{fontWeight:800,fontSize:18},children:n}):u.jsx("div",{}),u.jsx("button",{type:"button",className:"button",onClick:e,style:{background:"#eee",color:"#333"},children:""})]}),r]})})():u.jsxs("div",{style:h,onClick:f=>f.stopPropagation(),children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10},children:[n?u.jsx("div",{style:{fontWeight:800,fontSize:18},children:n}):u.jsx("div",{}),u.jsx("button",{type:"button",className:"button",onClick:e,style:{background:"#eee",color:"#333"},children:""})]}),r]})})})}const lo=new Map;function xD(t,e){return lo.has(t)||lo.set(t,new Set),lo.get(t).add(e),()=>ET(t,e)}function ET(t,e){const n=lo.get(t);n&&(n.delete(e),n.size||lo.delete(t))}function ID(t,e){const n=lo.get(t);if(n)for(const r of Array.from(n))try{r(e)}catch(i){console.error("event handler error",i)}}const qt={on:xD,off:ET,emit:ID},{addPayment:CD,fetchPricing:AD,fetchPayments:ND}=tt,Il="Asia/Manila",lc=()=>new Intl.DateTimeFormat("en-CA",{timeZone:Il,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date),Ps=t=>{if(!t)return"";const e=t instanceof Date?t:new Date(t);return isNaN(e)?"":new Intl.DateTimeFormat("en-CA",{timeZone:Il,year:"numeric",month:"2-digit",day:"2-digit"}).format(e)},kD=()=>new Intl.DateTimeFormat("en-PH",{timeZone:Il,hour:"2-digit",minute:"2-digit",hour12:!1}).format(new Date).replace(/^(\d{2}):(\d{2}).*$/,"$1:$2"),cc=t=>{var o,c,a;if(!t)return"-";let e;if(typeof t=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(t)){const[d,h,f]=t.split("-").map(Number);e=new Date(Date.UTC(d,h-1,f))}else e=t instanceof Date?t:new Date(t);if(isNaN(e))return"-";const n=new Intl.DateTimeFormat("en-US",{timeZone:Il,month:"short",day:"numeric",year:"numeric"}).formatToParts(e),r=((o=n.find(d=>d.type==="month"))==null?void 0:o.value)||"",i=((c=n.find(d=>d.type==="day"))==null?void 0:c.value)||"",s=((a=n.find(d=>d.type==="year"))==null?void 0:a.value)||"";return`${r}-${i}, ${s}`},sa=(t,e)=>{if(!t||!e)return"";const[n,r,i]=t.split("-").map(Number),s=new Date(Date.UTC(n,r-1,i));return s.setUTCDate(s.getUTCDate()+Math.max(0,Number(e)-1)),new Intl.DateTimeFormat("en-CA",{timeZone:"UTC",year:"numeric",month:"2-digit",day:"2-digit"}).format(s)},N_=t=>{const e=String(t??"").trim().toLowerCase();return e==="yes"||e==="y"||e==="true"||e==="1"},oa=t=>{if(!t)return{gym:!1,coach:!1};const e=Object.entries(t||{}),n=s=>{for(const[o,c]of e){const a=o.toLowerCase().replace(/\s+/g,"");if(s.some(d=>a===d.toLowerCase().replace(/\s+/g,"")))return c}},r=N_(n(["Gym membership","Gym Membership","GymMembership","Membership"])),i=N_(n(["Coach subscription","Coach Subscription","CoachSubscription","Coach"]));return{gym:r,coach:i}},Rs=(t,e=0)=>{if(!t)return"";const[n,r,i]=String(t).split("-").map(Number);if([n,r,i].some(o=>Number.isNaN(o)))return"";const s=new Date(Date.UTC(n,r-1,i));return s.setUTCDate(s.getUTCDate()+Number(e||0)),new Intl.DateTimeFormat("en-CA",{timeZone:"UTC",year:"numeric",month:"2-digit",day:"2-digit"}).format(s)};function PD({open:t,onClose:e,memberId:n,onSaved:r,membershipEnd:i,coachEnd:s,isStudent:o,birthDate:c}){const[a,d]=N.useState([]),[h,f]=N.useState(!1),[p,v]=N.useState([]),[x,_]=N.useState({Particulars:"",Mode:"",Cost:"",StartDate:"",EndDate:""}),[P,y]=N.useState("");N.useEffect(()=>{let S=!0;if(!t){d([]),_({Particulars:"",Mode:"",Cost:"",StartDate:"",EndDate:""}),y("");return}return(async()=>{try{y("");let E=[];try{const j=await AD();j&&Array.isArray(j.rows)?E=j.rows:j&&Array.isArray(j)&&(E=j)}catch{}if((!E||E.length===0)&&typeof fetch=="function"){const j=["/api/products","http://localhost:4000/products"];for(const k of j)try{const Q=await fetch(k);if(Q&&Q.ok){const I=await Q.json().catch(()=>null);if(I&&Array.isArray(I)){E=(I||[]).map(V=>({Particulars:V.name||V.sku||`Product ${V.id}`,Cost:typeof V.price<"u"?Number(V.price).toFixed(2):"",Validity:V.validity_days||V.validity||0,"Gym membership":V.is_gym_membership?"Yes":"No","Coach subscription":V.is_coach_subscription?"Yes":"No",Notes:V.notes||""}));break}}}catch{}}S&&d(E||[])}catch(E){S&&y((E==null?void 0:E.message)||"Failed to load pricing")}})(),()=>{S=!1}},[t]),N.useEffect(()=>{if(!t||!n){v([]);return}let S=!0;return(async()=>{try{const E=await ND(),j=E&&Array.isArray(E.rows)?E.rows:Array.isArray(E)?E:[];if(!S)return;const k=String(n).trim(),Q=(j||[]).filter(I=>String(I.MemberID||I.memberId||I.MemberID||I.memberid||"").trim()===k);v(Q||[])}catch{v([])}})(),()=>{S=!1}},[t,n]);const w=N.useMemo(()=>{if(!c)return!1;const S=c instanceof Date?c:new Date(c);if(isNaN(S))return!1;const E=new Date;let j=E.getFullYear()-S.getFullYear();const k=E.getMonth()-S.getMonth();return(k<0||k===0&&E.getDate()<S.getDate())&&j--,j>=60},[c]),{manilaHour:T,isOffPeakWindow:M,isDailyWindow:L}=N.useMemo(()=>{var Q;const S=new Intl.DateTimeFormat("en-US",{timeZone:Il,hour12:!1,hour:"2-digit"}).formatToParts(new Date),E=Number(((Q=S.find(I=>I.type==="hour"))==null?void 0:Q.value)||"0"),j=E>=6&&E<15,k=E>=15&&E<22;return{manilaHour:E,isOffPeakWindow:j,isDailyWindow:k}},[]),B=N.useMemo(()=>{const S=!!(o||w);return(a||[]).filter(E=>{const j=String(E.Particulars||"").trim();j.toLowerCase();const k=/(student|senior|discount|disc)/i.test(j),Q=/off\s*-?\s*peak|offpeak/i.test(j),I=/\bdaily\b|daily\s*pass|1[- ]?day/i.test(j),V=oa(E);if(k&&!S)return!1;const q=(()=>{try{if(!i)return!1;const $=new Date(i);$.setHours(0,0,0,0);const G=new Date;return G.setHours(0,0,0,0),$>=G}catch{return!1}})(),A=(()=>{try{if(!s)return!1;const $=new Date(s);$.setHours(0,0,0,0);const G=new Date;return G.setHours(0,0,0,0),$>=G}catch{return!1}})(),F=I&&V.gym&&!V.coach,O=I&&V.coach&&!V.gym,z=I&&V.gym&&V.coach;return!(F&&q||O&&A||z&&(q||A)||Q&&!M&&!(I&&V.coach&&!V.gym)||I&&!Q&&!L&&!(V.coach&&!V.gym))})},[a,o,w,M,L,i,s]);N.useEffect(()=>{if(!x.Particulars)return;B.some(E=>String(E.Particulars)===String(x.Particulars))||_(E=>({...E,Particulars:"",Cost:"",EndDate:""}))},[B]);const C=N.useMemo(()=>{const S={gymOnly:[],coachOnly:[],bundle:[],merch:[]};return(B||[]).forEach(E=>{const j=oa(E);j.gym&&!j.coach?S.gymOnly.push(E):!j.gym&&j.coach?S.coachOnly.push(E):j.gym&&j.coach?S.bundle.push(E):S.merch.push(E)}),S},[B]),b=S=>{const E=(B||[]).find(G=>String(G.Particulars)===String(S)),j=E?(parseFloat(E.Cost)||0).toFixed(2):"",k=E?Number(E.Validity||0):0,Q=oa(E),I=/\bdaily\b|daily\s*pass|1[- ]?day/i.test(String(S||""));let V=!1;if(I&&p&&p.length){const J=Date.now()-30*24*60*60*1e3,ae=String(S||"").trim();(p||[]).filter(ie=>{try{if(String(ie.Particulars||ie.Particular||"").trim()!==ae)return!1;const Te=ie.Date||ie.DatePaid||ie.DateTime||ie.timestamp||ie.Timestamp||ie.Time||null;if(!Te)return!1;let ge=new Date(Te);if(isNaN(ge))if(/^\d{4}-\d{2}-\d{2}$/.test(String(Te)))ge=new Date(String(Te)+"T00:00:00");else return!1;return ge.getTime()>=J}catch{return!1}}).length>=12&&(V=!0)}const q=lc(),A=i?Ps(i):"",F=s?Ps(s):"",O=Q.gym?A&&A>=q?Rs(A,1):q:null,z=Q.coach?F&&F>=q?Rs(F,1):q:null;let $=q;Q.gym&&Q.coach?$=q:Q.gym&&O?$=O:Q.coach&&z?$=z:$=q,_(G=>{const J=$||G.StartDate||q;return{...G,Particulars:S,Cost:V?"0.00":j,StartDate:J,EndDate:k?sa(J,k):"",PromoApplied:V}})},R=async S=>{if(S.preventDefault(),!n)return y("Missing MemberID");if(!x.Particulars)return y("Select Particulars.");if(!x.Mode)return y("Select a payment mode.");if(!x.Cost)return y("Cost is missing for this item.");f(!0),y("");try{const E=(B||[]).find(de=>String(de.Particulars)===String(x.Particulars)),j=E?Number(E.Validity||0):0,k=oa(E),Q=String((E==null?void 0:E.Particulars)||"").toLowerCase(),I=/\bdaily\b|daily\s*pass|1[- ]?day/i.test(Q),V=/off\s*-?\s*peak|offpeak/i.test(Q),q=(()=>{try{if(!i)return!1;const de=new Date(i);de.setHours(0,0,0,0);const ie=new Date;return ie.setHours(0,0,0,0),de>=ie}catch{return!1}})();if(I&&q){y("Daily pass not allowed: member has active membership"),f(!1);return}if(I&&!V&&!L){y("Daily pass only available 3pm-10pm (Manila time)"),f(!1);return}if(V&&!M){y("Off-peak pass only available 6am-3pm (Manila time)"),f(!1);return}const A=(()=>{try{if(!s)return!1;const de=new Date(s);de.setHours(0,0,0,0);const ie=new Date;return ie.setHours(0,0,0,0),de>=ie}catch{return!1}})();if(k.coach&&A){y("Coach session not allowed: member has active coach subscription"),f(!1);return}const F=lc(),O=i?Ps(i):"",z=s?Ps(s):"",$=k.gym?O&&O>=F?Rs(O,1):x.StartDate||F:null,G=k.coach?z&&z>=F?Rs(z,1):x.StartDate||F:null,J=$&&j?sa($,j):"",ae=G&&j?sa(G,j):"";await CD({MemberID:n,Particulars:x.Particulars,StartDate:x.StartDate||"",EndDate:x.EndDate||"",GymValidUntil:J,CoachValidUntil:ae,Mode:x.Mode,Cost:String(x.Cost).trim(),Date:lc(),Time:kD()}),r&&r(),e&&e()}catch(E){const j=(E==null?void 0:E.message)||"Failed to add payment";y(j);try{qt.emit("modal:error",{message:j,source:"PaymentModal",error:String(E)})}catch{}}finally{f(!1)}};return t?u.jsx(xs,{open:t,onClose:e,title:"Add Payment",width:560,noInternalScroll:!0,children:u.jsxs("form",{onSubmit:R,style:{width:"100%"},children:[P&&u.jsx("div",{className:"small-error",style:{marginBottom:8},children:P}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10,marginBottom:10},children:[u.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[u.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:4},children:"Gym Membership - Valid until"}),u.jsx("div",{style:{fontWeight:700},children:i?cc(i):"-"})]}),u.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[u.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:4},children:"Coach Subscription - Valid until"}),u.jsx("div",{style:{fontWeight:700},children:s?cc(s):"-"})]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[u.jsxs("label",{className:"field",style:{gridColumn:"1 / span 2"},children:[u.jsx("span",{className:"label",children:"Particulars"}),u.jsxs("select",{value:x.Particulars,onChange:S=>b(S.target.value),required:!0,children:[u.jsx("option",{value:"",children:"Choose product/service"}),C.gymOnly.length>0&&u.jsx("optgroup",{label:"Gym membership only",children:C.gymOnly.map((S,E)=>u.jsx("option",{value:S.Particulars,children:S.Particulars},`gym-${S.Particulars}-${E}`))}),C.coachOnly.length>0&&u.jsx("optgroup",{label:"Coach subscription only",children:C.coachOnly.map((S,E)=>u.jsx("option",{value:S.Particulars,children:S.Particulars},`coach-${S.Particulars}-${E}`))}),C.bundle.length>0&&u.jsx("optgroup",{label:"Gym & Coach bundle",children:C.bundle.map((S,E)=>u.jsx("option",{value:S.Particulars,children:S.Particulars},`bundle-${S.Particulars}-${E}`))}),C.merch.length>0&&u.jsx("optgroup",{label:"Merchandise",children:C.merch.map((S,E)=>u.jsx("option",{value:S.Particulars,children:S.Particulars},`merch-${S.Particulars}-${E}`))})]}),x.Particulars&&(()=>{const S=(B||[]).find(O=>String(O.Particulars)===String(x.Particulars)),E=oa(S),j=S?Number(S.Validity||0):0;if(!j)return null;const k=lc(),Q=i?Ps(i):"",I=s?Ps(s):"",V=E.gym?Q&&Q>=k?Rs(Q,1):x.StartDate||k:null,q=E.coach?I&&I>=k?Rs(I,1):x.StartDate||k:null,A=V?sa(V,j):null,F=q?sa(q,j):null;return!A&&!F?null:u.jsxs("div",{style:{background:"#fde8ef",border:"1px solid #ffd7e3",color:"#8b1a3b",marginTop:8,padding:8,borderRadius:8,fontSize:13,lineHeight:1.35},children:[A&&u.jsxs("div",{children:["New Gym valid until: ",u.jsx("b",{children:cc(A)})]}),F&&u.jsxs("div",{children:["New Coach valid until: ",u.jsx("b",{children:cc(F)})]})]})})()]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Mode of Payment"}),u.jsxs("select",{value:x.Mode,onChange:S=>_(E=>({...E,Mode:S.target.value})),required:!0,children:[u.jsx("option",{value:"",children:"Select mode"}),u.jsx("option",{value:"Cash",children:"Cash"}),u.jsx("option",{value:"GCash",children:"GCash"})]})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Cost"}),u.jsx("input",{type:"number",step:"0.01",min:"0",value:x.Cost,readOnly:!0,disabled:!0}),x.PromoApplied&&u.jsx("div",{style:{marginTop:6,fontSize:12,color:"#065f46"},children:"Promo applied  this item will be free (12 uses in last 30 days)"})]})]}),u.jsx("div",{style:{marginTop:8,color:"var(--muted)",fontSize:12},children:"Validity is applied inclusive of the Start Date."}),u.jsxs("div",{style:{marginTop:12,display:"flex",gap:10,justifyContent:"flex-end"},children:[u.jsx("button",{type:"button",className:"back-btn",onClick:e,style:{background:"#e5e7eb",color:"#111",fontWeight:700},children:"Cancel"}),u.jsx("button",{type:"submit",className:"primary-btn",disabled:h,children:"+ Add Payment"})]})]})}):null}function RD({open:t,onClose:e,onCapture:n,waitForAck:r=!1}){const i=N.useRef(null),s=N.useRef(null),o=N.useRef(!1),[c,a]=N.useState([]),[d,h]=N.useState(""),[f,p]=N.useState(""),[v,x]=N.useState(!1),_=()=>{s.current&&(s.current.getTracks().forEach(S=>S.stop()),s.current=null)},P=async(S="")=>{if(!o.current){o.current=!0,x(!0),p(""),_();try{const E=S?{video:{deviceId:{exact:S},width:{ideal:1280},height:{ideal:720}},audio:!1}:{video:{facingMode:{ideal:"environment"},width:{ideal:1280},height:{ideal:720}},audio:!1};let j;try{j=await navigator.mediaDevices.getUserMedia(E)}catch(k){try{const Q=S?{video:{deviceId:{ideal:S}},audio:!1}:{video:!0,audio:!1};j=await navigator.mediaDevices.getUserMedia(Q)}catch(Q){const I=Q||k,V=I&&I.name?String(I.name):"";p(V==="NotAllowedError"?"Camera permission denied. Please allow camera access in the browser site settings and macOS Privacy > Camera.":V==="NotReadableError"?"Camera is busy or not readable. Close other apps using the camera (e.g., Zoom/Meet/FaceTime) and try again.":V==="OverconstrainedError"||V==="ConstraintNotSatisfiedError"?"Selected camera doesn't meet constraints. Try choosing a different camera.":V==="NotFoundError"?"No camera found. Plug in a camera or check system permissions.":"Cannot access camera. Check site permissions and OS privacy settings.");return}}if(s.current=j,i.current){i.current.srcObject=j;try{await i.current.play()}catch{}}try{await y()}catch{}}catch{p("Cannot access camera. Check site permissions and OS privacy settings.")}finally{o.current=!1,x(!1)}}},y=async()=>{try{const E=(await navigator.mediaDevices.enumerateDevices()).filter(j=>j.kind==="videoinput");a(E),!d&&E[0]&&h(E[0].deviceId)}catch{}};N.useEffect(()=>{var S,E;if(!t){_();return}return(async()=>(p(""),await P(d||"")))(),(E=(S=navigator.mediaDevices)==null?void 0:S.addEventListener)==null||E.call(S,"devicechange",y),()=>{var j,k;(k=(j=navigator.mediaDevices)==null?void 0:j.removeEventListener)==null||k.call(j,"devicechange",y),_()}},[t]),N.useEffect(()=>{var S,E,j,k;if(!(!t||!d)){try{const Q=((k=(j=(E=(S=s.current)==null?void 0:S.getVideoTracks)==null?void 0:E.call(S)[0])==null?void 0:j.getSettings)==null?void 0:k.call(j).deviceId)||"";if(Q&&Q===d)return}catch{}P(d)}},[d]);const w=async()=>{if(!i.current)return;const S=i.current,E=document.createElement("canvas"),j=S.videoWidth||1280,k=S.videoHeight||720,Q=800,I=j>Q?Q/j:1,V=Math.max(320,Math.round(j*I)),q=Math.max(240,Math.round(k*I));E.width=V,E.height=q,E.getContext("2d").drawImage(S,0,0,V,q);const F=E.toDataURL("image/jpeg",.65);try{const O=n==null?void 0:n(F);if(r&&O&&typeof O.then=="function"){B(!0);try{await Promise.resolve(O)}catch(z){p(z&&z.message?z.message:String(z||"Failed to process photo"))}}else try{O&&typeof O.then=="function"&&O.catch(z=>{try{p(String((z==null?void 0:z.message)||z))}catch{}})}catch{}}catch(O){p(O&&O.message?O.message:String(O||"Failed to process photo"))}finally{try{B(!1)}catch{}_(),e==null||e()}},[T,M]=N.useState(null),[L,B]=N.useState(!1),C=async()=>{if(!T)return;p("");const S=n==null?void 0:n(T);if(r&&S&&typeof S.then=="function"){B(!0);try{await Promise.resolve(S)}catch(E){const j=E&&E.message?E.message:String(E||"Failed to process photo");p(j)}finally{B(!1),M(null),e==null||e()}return}try{S&&typeof S.then=="function"&&S.catch(E=>{try{p(String((E==null?void 0:E.message)||E))}catch{}})}catch{}M(null),e==null||e()},b=()=>{M(null),P(d||"")};if(!t)return null;const R=u.jsxs(xs,{open:t,onClose:e,width:720,noWrapper:!0,children:[u.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[u.jsx("label",{style:{fontWeight:600,fontSize:14},children:"Camera:"}),u.jsxs("select",{value:d,onChange:S=>h(S.target.value),style:{flex:1,padding:"8px 10px",borderRadius:8,border:"1px solid #e7e8ef"},children:[c.length===0&&u.jsx("option",{value:"",children:"(No camera found)"}),c.map(S=>u.jsx("option",{value:S.deviceId,children:S.label||"Camera"},S.deviceId))]})]}),!f&&!s.current&&u.jsx("div",{style:{color:"#666",marginBottom:8},children:"Initializing camera please allow the browser prompt."}),f?u.jsx("div",{style:{color:"#d33",marginBottom:12},children:f}):u.jsx("div",{style:{width:"100%"},children:T?u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[u.jsx("img",{src:T,alt:"preview",style:{width:"100%",borderRadius:10}}),u.jsx("div",{style:{color:"#666",fontSize:13},children:"Preview  accept to use this photo or retake."})]}):u.jsx("video",{ref:i,playsInline:!0,muted:!0,style:{width:"100%",borderRadius:10,background:"#000"}})}),u.jsx("div",{style:{display:"flex",gap:10,marginTop:12,justifyContent:"flex-end"},children:T?u.jsxs(u.Fragment,{children:[u.jsx("button",{type:"button",className:"button",onClick:b,disabled:L,children:"Retake"}),u.jsx("button",{type:"button",className:"button btn-lg",onClick:C,disabled:L,children:L?"Processing":"Use Photo"})]}):u.jsx(u.Fragment,{children:u.jsx("button",{type:"button",className:"button btn-lg",onClick:w,disabled:!!f||!s.current,children:"Capture"})})})]});return SS.createPortal(R,document.body)}const DD=["Isabel","Merida","Palompon","Ormoc","Matag-ob"],jD={Isabel:["Anislag","Antipolo","Apale","Bantigue","Binog","Bilwang","Can-andan","Cangag","Consolacion","Honan","Libertad","Mahayag","Marvel (Poblacion)","Matlang","Monte Alegre","Puting Bato","San Francisco","San Roque","Santa Cruz Relocation","Santo Nio (Poblacion)","Santo Rosario","Tabunok","Tolingon","Tubod"],Merida:["Benabaye","Cabaliwan","Calunangan","Calunasan","Cambalong","Can-unzo","Canbantug","Casilda","Lamanoc","Libas","Libjo","Lundag","Macario","Mahalit","Mahayag","Masumbang","Mat-e","Poblacion","Puerto Bello","San Isidro","San Jose","Tubod"],Palompon:["Baguinbin","Belen","Buenavista","Caduhaan","Cambakbak","Cambinoy","Cangcosme","Cangmuya","Canipaan","Cantandoy","Cantuhaon","Catigahan","Central 1 (Poblacion)","Central 2 (Poblacion)","Cruz","Duljugan","Guiwan 1 (Poblacion)","Guiwan 2 (Poblacion)","Himarco","Hinablayan (Poblacion)","Hinagbuan","Lat-osan","Liberty","Lomonon","Mabini","Magsaysay","Masaba","Mazawalo (Poblacion)","Parilla","Pinagdait (Poblacion Ypil I)","Pinaghi-usa (Poblacion Ypil II)","Plaridel","Rizal","Sabang","San Guillermo","San Isidro","San Joaquin","San Juan","San Miguel","San Pablo","San Pedro","San Roque","Santiago","Taberna","Tabunok","Tambis","Tinabilan","Tinago","Tinubdan","Bitaog (Poblacion Ypil III)"],Ormoc:["Airport","Alegria","Alta Vista","Bagongbong","Bagong Buhay","Bantigue","Batuan","Bayog","Biliboy","Borok","Cabaon-an","Cabintan","Cabulihan","Cagbuhangin","Camp Downes","Can-adieng","Can-untog","Catmon","Cogon Combado","Concepcion","Curva","Danhug","Dayhagan","Dolores","Domonar","Don Felipe Larrazabal","Don Potenciano Larrazabal","Doa Feliza Z. Mejia","Donghol","Esperanza","Gaas","Green Valley","Guintigui-an","Hibunawon","Hugpa","Ipil","Juaton","Kadaohan","Labrador (Balion)","Lao","Leondoni","Libertad","Liberty","Licuma","Liloan","Linao","Luna","Mabato","Mabini","Macabug","Magaswi","Mahayag","Mahayahay","Manlilinao","Margen","Mas-in","Matica-a","Milagro","Monterico","Nasunogan","Naungan","Nueva Sociedad","Nueva Vista","Patag","Punta","Quezon Jr.","Rufina M. Tan (Rawis)","Sabang Bao","Salvacion","San Antonio","San Isidro","San Jose","San Juan","San Pablo (Simangan)","San Vicente","Santo Nio","Sumangga","Tambulilid","Tongonan","Valencia","East (Poblacion)","West (Poblacion)","North (Poblacion)","South (Poblacion)"],"Matag-ob":["Balagtas","Bonoy","Bulak","Cambadbad","Candelaria","Cansoso","Imelda","Malazarte","Mansaha-on","Mansalip","Masaba","Naulayan","Riverside (Poblacion)","San Dionesio","San Guillermo (Poblacion)","San Marcelino","San Sebastian","San Vicente","Santa Rosa","Santo Rosario","Talisay (Poblacion)"]};function MD(t){return jD[t]||[]}const{updateMember:OD,uploadMemberPhoto:k_,fetchMemberById:VD,fetchMemberByIdFresh:LD}=tt,FD=t=>{const e={};return Object.entries(t||{}).forEach(([n,r])=>e[String(n).toLowerCase()]=r),e},Je=(t,...e)=>{if(!t)return"";for(const n of e){if(t[n]!==void 0&&t[n]!==null&&t[n]!=="")return t[n];const r=String(n).toLowerCase(),i=FD(t);if(i[r]!==void 0&&i[r]!=="")return i[r];const s=r.replace(/\s+/g,"");if(i[s]!==void 0&&i[s]!=="")return i[s];const o=r.replace(/\s+/g,"_");if(i[o]!==void 0&&i[o]!=="")return i[o]}return""};function UD(t,e=`photo-${Date.now()}.jpg`){const n=t.split(","),r=n[0].match(/:(.*?);/)[1]||"image/jpeg",i=atob(n[1]);let s=i.length;const o=new Uint8Array(s);for(;s--;)o[s]=i.charCodeAt(s);return new File([o],e,{type:r})}function BD({open:t,onClose:e,member:n,onSaved:r}){const[i,s]=N.useState({lastName:"",firstName:"",middleName:"",nickName:"",gender:"",birthday:"",street:"",brgy:"",municipality:"",email:"",mobile:"",validId:"",student:!1}),[o,c]=N.useState(""),[a,d]=N.useState(""),[h,f]=N.useState(""),[p,v]=N.useState(null),x=N.useRef(null),[_,P]=N.useState(!1),[y,w]=N.useState(""),[T,M]=N.useState(!1),[L,B]=N.useState(""),C=N.useRef(!1),b=MD(i.municipality),R=I=>{const q=String(I||"").match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return q&&q[1]?q[1]:""},S=I=>{const V=String(I||"");if(!V)return"";const q=V.match(/https?:\/\/[^\s}]+/);if(q){const F=q[0];if(/googleusercontent\.com\//.test(F))return F;const O=F.match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return O&&O[1]?`https://drive.google.com/uc?export=view&id=${O[1]}`:F}if(/googleusercontent\.com\//.test(V))return V;const A=R(V);return A?`https://drive.google.com/uc?export=view&id=${A}`:V},E=I=>{const V=String(I||"");if(/googleusercontent\.com\//.test(V))return V;const q=R(V);return q?`https://drive.google.com/thumbnail?id=${q}&sz=w1000`:V};N.useEffect(()=>{let I=!1;if(!t){C.current=!1;return}if(C.current)return;const V=n||{},q=String(Je(V,"MemberID","memberId","member_id","id")||"").trim();return c(q),(async()=>{try{if(q){const A=await VD(String(q).trim());if(!I&&A){const F=Je(A,"LastName","lastName","last_name","Last"),O=Je(A,"FirstName","firstName","first_name","First"),z=Je(A,"MiddleName","middleName","middle_name"),$=Je(A,"NickName","nickname","nick_name","Nick Name"),G=Je(A,"Gender","gender"),J=Je(A,"Birthday","birth_date","dob","Birth Date"),ae=Je(A,"Street","street"),de=Je(A,"Brgy","Barangay","brgy","barangay"),ie=Je(A,"Municipality","City","municipality","city"),_e=Je(A,"Email","email"),Te=Je(A,"Mobile","Phone","mobile","phone"),ge=Je(A,"ValidID","Valid Id","Valid ID","validId","valid_id"),Pe=String(Je(A,"Student","student")||"").toLowerCase().startsWith("y"),xe=Je(A,"PhotoURL","photoUrl","photo_url","photo"),U=xe?E(S(xe)):"";d(xe||""),f(U),v(null),w("");const Z=String(de||"");s({lastName:String(F||""),firstName:String(O||""),middleName:String(z||""),nickName:String($||""),gender:String(G||""),birthday:J?new Date(J).toISOString().slice(0,10):"",street:String(ae||""),brgy:Z,municipality:String(ie||""),email:String(_e||""),mobile:String(Te||""),validId:String(ge||""),student:Pe}),C.current=!0;return}}}catch{}if(!I){const A=Je(V,"LastName","lastName","last_name","Last"),F=Je(V,"FirstName","firstName","first_name","First"),O=Je(V,"MiddleName","middleName","middle_name"),z=Je(V,"NickName","nickname","nick_name","Nick Name"),$=Je(V,"Gender","gender"),G=Je(V,"Birthday","birth_date","dob","Birth Date"),J=Je(V,"Street","street"),ae=Je(V,"Brgy","Barangay","brgy","barangay"),de=Je(V,"Municipality","City","municipality","city"),ie=Je(V,"Email","email"),_e=Je(V,"Mobile","Phone","mobile","phone"),Te=Je(V,"ValidID","Valid Id","Valid ID","validId","valid_id"),ge=String(Je(V,"Student","student")||"").toLowerCase().startsWith("y"),Pe=Je(V,"PhotoURL","photoUrl","photo_url","photo"),xe=Pe?E(S(Pe)):"";d(Pe||""),f(xe),v(null),w("");const U=String(ae||"");s({lastName:String(A||""),firstName:String(F||""),middleName:String(O||""),nickName:String(z||""),gender:String($||""),birthday:G?new Date(G).toISOString().slice(0,10):"",street:String(J||""),brgy:U,municipality:String(de||""),email:String(ie||""),mobile:String(_e||""),validId:String(Te||""),student:ge}),C.current=!0}})(),()=>{I=!0}},[t,n]);const j=I=>{const{name:V,value:q,type:A,checked:F}=I.target;if(V==="student-select"){s(O=>({...O,student:String(q)==="Yes"}));return}if(V==="municipality"){s(O=>({...O,municipality:q,brgy:""}));return}s(O=>({...O,[V]:A==="checkbox"?F:q}))},k=I=>{try{const V=UD(I);x.current&&(URL.revokeObjectURL(x.current),x.current=null);const q=URL.createObjectURL(V);if(x.current=q,v(V),f(q),o){const A=String(o).trim().toLowerCase(),F=(async()=>{try{const O=await k_(V,A),z=typeof O=="string"?O:(O==null?void 0:O.url)||"";d(z||a);const $=z?E(S(z)):q;return f($),v(null),z}catch(O){try{w(String(O||"Photo upload failed"))}catch{}return null}})();return Promise.resolve(F).catch(()=>null)}}catch(V){try{w(String(V||"Failed to handle capture"))}catch{}return Promise.resolve(null)}return Promise.resolve(null)};N.useEffect(()=>()=>{x.current&&(URL.revokeObjectURL(x.current),x.current=null)},[]);const Q=async I=>{var q;try{(q=I==null?void 0:I.preventDefault)==null||q.call(I)}catch{}if(!o){w("Missing MemberID");return}try{console.debug("[EditMemberModal] save() starting for",o)}catch{}const V={MemberID:o,LastName:i.lastName.trim(),FirstName:i.firstName.trim(),MiddleName:i.middleName.trim(),NickName:String(i.nickName||"").trim().toUpperCase(),Gender:i.gender,Birthday:i.birthday||"",Street:i.street.trim(),Brgy:i.brgy.trim(),Municipality:i.municipality.trim(),Email:i.email.trim(),Mobile:i.mobile.trim(),ValidID:i.validId.trim(),Student:i.student?"Yes":"No",PhotoURL:h||a||""};try{console.debug("[EditMemberModal] optimisticPayload",V)}catch{}P(!0),w("");try{let A=a||"";if(p)try{const z=k_(p,String(o).toLowerCase()),G=await Promise.race([z,new Promise((J,ae)=>setTimeout(()=>ae(new Error("photo upload timeout")),15e3))]);try{console.debug("[EditMemberModal] uploadMemberPhoto result",G)}catch{}A=typeof G=="string"?G:(G==null?void 0:G.url)||A,v(null)}catch(z){try{console.debug("[EditMemberModal] uploadMemberPhoto failed",String(z))}catch{}w(String(z)||"Photo upload failed  saving without photo change")}const F={...V,PhotoURL:A};let O=null;try{try{console.debug("[EditMemberModal] sending update payload",F)}catch{}const z=OD(F),$=await Promise.race([z,new Promise((G,J)=>setTimeout(()=>J(new Error("update timeout")),2e4))]);try{console.debug("[EditMemberModal] updateMember response",$)}catch{}$&&typeof $=="object"&&($.row&&typeof $.row=="object"?O=$.row:$.updated&&typeof $.updated=="object"?O=$.updated:$.data&&typeof $.data=="object"?O=$.data:["MemberID","memberid","LastName","FirstName"].some(J=>Object.prototype.hasOwnProperty.call($,J))&&(O=$));try{console.debug("[EditMemberModal] authoritative after response",O)}catch{}}catch(z){try{console.debug("[EditMemberModal] updateMember error",String(z))}catch{}w(String(z)||"Failed to update member"),qt.emit("modal:error",{message:"Failed to update member",source:"EditMemberModal",error:String(z)})}if(!O)try{try{console.debug("[EditMemberModal] fetching fresh member by id",String(o).trim())}catch{}const z=LD(String(o).trim()),$=await Promise.race([z,new Promise((G,J)=>setTimeout(()=>J(new Error("fetch member timeout")),15e3))]);try{console.debug("[EditMemberModal] fetchMemberByIdFresh result",$)}catch{}$&&(O=$)}catch(z){try{console.debug("[EditMemberModal] fetchMemberByIdFresh failed",String(z))}catch{}}O||(O=F);try{console.debug("[EditMemberModal] final authoritative row passed to parent",O)}catch{}try{r==null||r(O)}catch{}try{e==null||e()}catch{}}catch(A){qt.emit("modal:error",{message:"Background member update failed",source:"EditMemberModal",error:String(A)}),w(String(A)||"Background member update failed")}finally{P(!1)}};return t?u.jsx(xs,{open:t,onClose:e,title:i.nickName||"Edit Member",width:1e3,noInternalScroll:!0,children:u.jsxs("form",{onSubmit:Q,style:{width:"100%",padding:0,background:"transparent",border:"none",boxShadow:"none",overflow:"visible"},children:[L&&u.jsx("div",{style:{position:"fixed",top:20,right:20,background:"#16a34a",color:"#fff",padding:"8px 12px",borderRadius:10,boxShadow:"0 6px 16px rgba(0,0,0,.15)",zIndex:1e4},children:L}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"240px 1fr",gap:16},children:[u.jsxs("div",{children:[u.jsx("div",{style:{width:240,height:240,border:"1px solid var(--light-border)",borderRadius:12,background:"#fafbff",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center"},children:h?u.jsx("img",{src:h,alt:"preview",style:{width:"100%",height:"100%",objectFit:"cover"}}):u.jsx("div",{style:{color:"var(--muted)"},children:"No photo"})}),u.jsx("div",{style:{display:"flex",gap:8,marginTop:10},children:u.jsx("button",{type:"button",className:"button",onClick:()=>M(!0),disabled:!0,title:"Camera disabled in this build",style:{flex:"1 1 auto",cursor:"not-allowed",opacity:.6},children:" Change Photo"})})]}),u.jsxs("div",{style:{display:"grid",gap:12},children:[u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 160px",gap:12,alignItems:"end"},children:[u.jsxs("label",{className:"field",style:{margin:0},children:[u.jsx("span",{className:"label",children:"Valid ID *"}),u.jsx("input",{name:"validId",value:i.validId,onChange:j,required:!0})]}),u.jsxs("label",{className:"field",style:{margin:0},children:[u.jsx("span",{className:"label",children:"Student"}),u.jsxs("select",{name:"student-select",value:i.student?"Yes":"No",onChange:j,children:[u.jsx("option",{children:"Yes"}),u.jsx("option",{children:"No"})]})]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12},children:[u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Last Name *"}),u.jsx("input",{name:"lastName",value:i.lastName,onChange:j,required:!0})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"First Name *"}),u.jsx("input",{name:"firstName",value:i.firstName,onChange:j,required:!0})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Middle Name"}),u.jsx("input",{name:"middleName",value:i.middleName,onChange:j})]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Birthday *"}),u.jsx("input",{type:"date",name:"birthday",value:i.birthday,onChange:j,required:!0})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Gender *"}),u.jsxs("select",{name:"gender",value:i.gender,onChange:j,required:!0,children:[u.jsx("option",{value:"",children:" Select "}),u.jsx("option",{children:"Male"}),u.jsx("option",{children:"Female"})]})]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Mobile No. *"}),u.jsx("input",{name:"mobile",value:i.mobile,onChange:j,placeholder:"09XXXXXXXXX",required:!0})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Email Address"}),u.jsx("input",{name:"email",value:i.email,onChange:j,placeholder:"name@example.com"})]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 2fr",gap:12},children:[u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Municipality / City"}),u.jsxs("select",{name:"municipality",value:i.municipality,onChange:j,children:[u.jsx("option",{value:""}),DD.map(I=>u.jsx("option",{value:I,children:I},I))]})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Brgy."}),u.jsxs("select",{name:"brgy",value:i.brgy,onChange:j,disabled:!i.municipality,children:[u.jsx("option",{value:""}),b.map(I=>u.jsx("option",{value:I,children:I},I))]})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"House No. / Street Name / Sitio"}),u.jsx("input",{name:"street",value:i.street,onChange:j})]})]}),y&&u.jsx("div",{style:{color:"#d33",fontSize:15,marginTop:8,fontWeight:600},children:y})]})]}),u.jsxs("div",{style:{marginTop:12,display:"flex",gap:10,justifyContent:"flex-end"},children:[u.jsx("button",{type:"button",className:"back-btn",onClick:e,style:{background:"#e5e7eb",color:"#111",fontWeight:700},children:"Cancel"}),u.jsx("button",{type:"button",className:"primary-btn",disabled:_,onClick:Q,children:" Save Changes"})]}),u.jsx(RD,{open:T,onClose:()=>M(!1),onCapture:k})]})}):null}var zD=Object.defineProperty,bu=Object.getOwnPropertySymbols,TT=Object.prototype.hasOwnProperty,bT=Object.prototype.propertyIsEnumerable,P_=(t,e,n)=>e in t?zD(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Jf=(t,e)=>{for(var n in e||(e={}))TT.call(e,n)&&P_(t,n,e[n]);if(bu)for(var n of bu(e))bT.call(e,n)&&P_(t,n,e[n]);return t},Zf=(t,e)=>{var n={};for(var r in t)TT.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&bu)for(var r of bu(t))e.indexOf(r)<0&&bT.call(t,r)&&(n[r]=t[r]);return n};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var gs;(t=>{const e=class je{constructor(a,d,h,f){if(this.version=a,this.errorCorrectionLevel=d,this.modules=[],this.isFunction=[],a<je.MIN_VERSION||a>je.MAX_VERSION)throw new RangeError("Version value out of range");if(f<-1||f>7)throw new RangeError("Mask value out of range");this.size=a*4+17;let p=[];for(let x=0;x<this.size;x++)p.push(!1);for(let x=0;x<this.size;x++)this.modules.push(p.slice()),this.isFunction.push(p.slice());this.drawFunctionPatterns();const v=this.addEccAndInterleave(h);if(this.drawCodewords(v),f==-1){let x=1e9;for(let _=0;_<8;_++){this.applyMask(_),this.drawFormatBits(_);const P=this.getPenaltyScore();P<x&&(f=_,x=P),this.applyMask(_)}}i(0<=f&&f<=7),this.mask=f,this.applyMask(f),this.drawFormatBits(f),this.isFunction=[]}static encodeText(a,d){const h=t.QrSegment.makeSegments(a);return je.encodeSegments(h,d)}static encodeBinary(a,d){const h=t.QrSegment.makeBytes(a);return je.encodeSegments([h],d)}static encodeSegments(a,d,h=1,f=40,p=-1,v=!0){if(!(je.MIN_VERSION<=h&&h<=f&&f<=je.MAX_VERSION)||p<-1||p>7)throw new RangeError("Invalid value");let x,_;for(x=h;;x++){const T=je.getNumDataCodewords(x,d)*8,M=o.getTotalBits(a,x);if(M<=T){_=M;break}if(x>=f)throw new RangeError("Data too long")}for(const T of[je.Ecc.MEDIUM,je.Ecc.QUARTILE,je.Ecc.HIGH])v&&_<=je.getNumDataCodewords(x,T)*8&&(d=T);let P=[];for(const T of a){n(T.mode.modeBits,4,P),n(T.numChars,T.mode.numCharCountBits(x),P);for(const M of T.getData())P.push(M)}i(P.length==_);const y=je.getNumDataCodewords(x,d)*8;i(P.length<=y),n(0,Math.min(4,y-P.length),P),n(0,(8-P.length%8)%8,P),i(P.length%8==0);for(let T=236;P.length<y;T^=253)n(T,8,P);let w=[];for(;w.length*8<P.length;)w.push(0);return P.forEach((T,M)=>w[M>>>3]|=T<<7-(M&7)),new je(x,d,w,p)}getModule(a,d){return 0<=a&&a<this.size&&0<=d&&d<this.size&&this.modules[d][a]}getModules(){return this.modules}drawFunctionPatterns(){for(let h=0;h<this.size;h++)this.setFunctionModule(6,h,h%2==0),this.setFunctionModule(h,6,h%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const a=this.getAlignmentPatternPositions(),d=a.length;for(let h=0;h<d;h++)for(let f=0;f<d;f++)h==0&&f==0||h==0&&f==d-1||h==d-1&&f==0||this.drawAlignmentPattern(a[h],a[f]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(a){const d=this.errorCorrectionLevel.formatBits<<3|a;let h=d;for(let p=0;p<10;p++)h=h<<1^(h>>>9)*1335;const f=(d<<10|h)^21522;i(f>>>15==0);for(let p=0;p<=5;p++)this.setFunctionModule(8,p,r(f,p));this.setFunctionModule(8,7,r(f,6)),this.setFunctionModule(8,8,r(f,7)),this.setFunctionModule(7,8,r(f,8));for(let p=9;p<15;p++)this.setFunctionModule(14-p,8,r(f,p));for(let p=0;p<8;p++)this.setFunctionModule(this.size-1-p,8,r(f,p));for(let p=8;p<15;p++)this.setFunctionModule(8,this.size-15+p,r(f,p));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let a=this.version;for(let h=0;h<12;h++)a=a<<1^(a>>>11)*7973;const d=this.version<<12|a;i(d>>>18==0);for(let h=0;h<18;h++){const f=r(d,h),p=this.size-11+h%3,v=Math.floor(h/3);this.setFunctionModule(p,v,f),this.setFunctionModule(v,p,f)}}drawFinderPattern(a,d){for(let h=-4;h<=4;h++)for(let f=-4;f<=4;f++){const p=Math.max(Math.abs(f),Math.abs(h)),v=a+f,x=d+h;0<=v&&v<this.size&&0<=x&&x<this.size&&this.setFunctionModule(v,x,p!=2&&p!=4)}}drawAlignmentPattern(a,d){for(let h=-2;h<=2;h++)for(let f=-2;f<=2;f++)this.setFunctionModule(a+f,d+h,Math.max(Math.abs(f),Math.abs(h))!=1)}setFunctionModule(a,d,h){this.modules[d][a]=h,this.isFunction[d][a]=!0}addEccAndInterleave(a){const d=this.version,h=this.errorCorrectionLevel;if(a.length!=je.getNumDataCodewords(d,h))throw new RangeError("Invalid argument");const f=je.NUM_ERROR_CORRECTION_BLOCKS[h.ordinal][d],p=je.ECC_CODEWORDS_PER_BLOCK[h.ordinal][d],v=Math.floor(je.getNumRawDataModules(d)/8),x=f-v%f,_=Math.floor(v/f);let P=[];const y=je.reedSolomonComputeDivisor(p);for(let T=0,M=0;T<f;T++){let L=a.slice(M,M+_-p+(T<x?0:1));M+=L.length;const B=je.reedSolomonComputeRemainder(L,y);T<x&&L.push(0),P.push(L.concat(B))}let w=[];for(let T=0;T<P[0].length;T++)P.forEach((M,L)=>{(T!=_-p||L>=x)&&w.push(M[T])});return i(w.length==v),w}drawCodewords(a){if(a.length!=Math.floor(je.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let d=0;for(let h=this.size-1;h>=1;h-=2){h==6&&(h=5);for(let f=0;f<this.size;f++)for(let p=0;p<2;p++){const v=h-p,_=(h+1&2)==0?this.size-1-f:f;!this.isFunction[_][v]&&d<a.length*8&&(this.modules[_][v]=r(a[d>>>3],7-(d&7)),d++)}}i(d==a.length*8)}applyMask(a){if(a<0||a>7)throw new RangeError("Mask value out of range");for(let d=0;d<this.size;d++)for(let h=0;h<this.size;h++){let f;switch(a){case 0:f=(h+d)%2==0;break;case 1:f=d%2==0;break;case 2:f=h%3==0;break;case 3:f=(h+d)%3==0;break;case 4:f=(Math.floor(h/3)+Math.floor(d/2))%2==0;break;case 5:f=h*d%2+h*d%3==0;break;case 6:f=(h*d%2+h*d%3)%2==0;break;case 7:f=((h+d)%2+h*d%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[d][h]&&f&&(this.modules[d][h]=!this.modules[d][h])}}getPenaltyScore(){let a=0;for(let p=0;p<this.size;p++){let v=!1,x=0,_=[0,0,0,0,0,0,0];for(let P=0;P<this.size;P++)this.modules[p][P]==v?(x++,x==5?a+=je.PENALTY_N1:x>5&&a++):(this.finderPenaltyAddHistory(x,_),v||(a+=this.finderPenaltyCountPatterns(_)*je.PENALTY_N3),v=this.modules[p][P],x=1);a+=this.finderPenaltyTerminateAndCount(v,x,_)*je.PENALTY_N3}for(let p=0;p<this.size;p++){let v=!1,x=0,_=[0,0,0,0,0,0,0];for(let P=0;P<this.size;P++)this.modules[P][p]==v?(x++,x==5?a+=je.PENALTY_N1:x>5&&a++):(this.finderPenaltyAddHistory(x,_),v||(a+=this.finderPenaltyCountPatterns(_)*je.PENALTY_N3),v=this.modules[P][p],x=1);a+=this.finderPenaltyTerminateAndCount(v,x,_)*je.PENALTY_N3}for(let p=0;p<this.size-1;p++)for(let v=0;v<this.size-1;v++){const x=this.modules[p][v];x==this.modules[p][v+1]&&x==this.modules[p+1][v]&&x==this.modules[p+1][v+1]&&(a+=je.PENALTY_N2)}let d=0;for(const p of this.modules)d=p.reduce((v,x)=>v+(x?1:0),d);const h=this.size*this.size,f=Math.ceil(Math.abs(d*20-h*10)/h)-1;return i(0<=f&&f<=9),a+=f*je.PENALTY_N4,i(0<=a&&a<=2568888),a}getAlignmentPatternPositions(){if(this.version==1)return[];{const a=Math.floor(this.version/7)+2,d=this.version==32?26:Math.ceil((this.version*4+4)/(a*2-2))*2;let h=[6];for(let f=this.size-7;h.length<a;f-=d)h.splice(1,0,f);return h}}static getNumRawDataModules(a){if(a<je.MIN_VERSION||a>je.MAX_VERSION)throw new RangeError("Version number out of range");let d=(16*a+128)*a+64;if(a>=2){const h=Math.floor(a/7)+2;d-=(25*h-10)*h-55,a>=7&&(d-=36)}return i(208<=d&&d<=29648),d}static getNumDataCodewords(a,d){return Math.floor(je.getNumRawDataModules(a)/8)-je.ECC_CODEWORDS_PER_BLOCK[d.ordinal][a]*je.NUM_ERROR_CORRECTION_BLOCKS[d.ordinal][a]}static reedSolomonComputeDivisor(a){if(a<1||a>255)throw new RangeError("Degree out of range");let d=[];for(let f=0;f<a-1;f++)d.push(0);d.push(1);let h=1;for(let f=0;f<a;f++){for(let p=0;p<d.length;p++)d[p]=je.reedSolomonMultiply(d[p],h),p+1<d.length&&(d[p]^=d[p+1]);h=je.reedSolomonMultiply(h,2)}return d}static reedSolomonComputeRemainder(a,d){let h=d.map(f=>0);for(const f of a){const p=f^h.shift();h.push(0),d.forEach((v,x)=>h[x]^=je.reedSolomonMultiply(v,p))}return h}static reedSolomonMultiply(a,d){if(a>>>8||d>>>8)throw new RangeError("Byte out of range");let h=0;for(let f=7;f>=0;f--)h=h<<1^(h>>>7)*285,h^=(d>>>f&1)*a;return i(h>>>8==0),h}finderPenaltyCountPatterns(a){const d=a[1];i(d<=this.size*3);const h=d>0&&a[2]==d&&a[3]==d*3&&a[4]==d&&a[5]==d;return(h&&a[0]>=d*4&&a[6]>=d?1:0)+(h&&a[6]>=d*4&&a[0]>=d?1:0)}finderPenaltyTerminateAndCount(a,d,h){return a&&(this.finderPenaltyAddHistory(d,h),d=0),d+=this.size,this.finderPenaltyAddHistory(d,h),this.finderPenaltyCountPatterns(h)}finderPenaltyAddHistory(a,d){d[0]==0&&(a+=this.size),d.pop(),d.unshift(a)}};e.MIN_VERSION=1,e.MAX_VERSION=40,e.PENALTY_N1=3,e.PENALTY_N2=3,e.PENALTY_N3=40,e.PENALTY_N4=10,e.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],e.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],t.QrCode=e;function n(c,a,d){if(a<0||a>31||c>>>a)throw new RangeError("Value out of range");for(let h=a-1;h>=0;h--)d.push(c>>>h&1)}function r(c,a){return(c>>>a&1)!=0}function i(c){if(!c)throw new Error("Assertion error")}const s=class Et{constructor(a,d,h){if(this.mode=a,this.numChars=d,this.bitData=h,d<0)throw new RangeError("Invalid argument");this.bitData=h.slice()}static makeBytes(a){let d=[];for(const h of a)n(h,8,d);return new Et(Et.Mode.BYTE,a.length,d)}static makeNumeric(a){if(!Et.isNumeric(a))throw new RangeError("String contains non-numeric characters");let d=[];for(let h=0;h<a.length;){const f=Math.min(a.length-h,3);n(parseInt(a.substring(h,h+f),10),f*3+1,d),h+=f}return new Et(Et.Mode.NUMERIC,a.length,d)}static makeAlphanumeric(a){if(!Et.isAlphanumeric(a))throw new RangeError("String contains unencodable characters in alphanumeric mode");let d=[],h;for(h=0;h+2<=a.length;h+=2){let f=Et.ALPHANUMERIC_CHARSET.indexOf(a.charAt(h))*45;f+=Et.ALPHANUMERIC_CHARSET.indexOf(a.charAt(h+1)),n(f,11,d)}return h<a.length&&n(Et.ALPHANUMERIC_CHARSET.indexOf(a.charAt(h)),6,d),new Et(Et.Mode.ALPHANUMERIC,a.length,d)}static makeSegments(a){return a==""?[]:Et.isNumeric(a)?[Et.makeNumeric(a)]:Et.isAlphanumeric(a)?[Et.makeAlphanumeric(a)]:[Et.makeBytes(Et.toUtf8ByteArray(a))]}static makeEci(a){let d=[];if(a<0)throw new RangeError("ECI assignment value out of range");if(a<128)n(a,8,d);else if(a<16384)n(2,2,d),n(a,14,d);else if(a<1e6)n(6,3,d),n(a,21,d);else throw new RangeError("ECI assignment value out of range");return new Et(Et.Mode.ECI,0,d)}static isNumeric(a){return Et.NUMERIC_REGEX.test(a)}static isAlphanumeric(a){return Et.ALPHANUMERIC_REGEX.test(a)}getData(){return this.bitData.slice()}static getTotalBits(a,d){let h=0;for(const f of a){const p=f.mode.numCharCountBits(d);if(f.numChars>=1<<p)return 1/0;h+=4+p+f.bitData.length}return h}static toUtf8ByteArray(a){a=encodeURI(a);let d=[];for(let h=0;h<a.length;h++)a.charAt(h)!="%"?d.push(a.charCodeAt(h)):(d.push(parseInt(a.substring(h+1,h+3),16)),h+=2);return d}};s.NUMERIC_REGEX=/^[0-9]*$/,s.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,s.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let o=s;t.QrSegment=s})(gs||(gs={}));(t=>{(e=>{const n=class{constructor(i,s){this.ordinal=i,this.formatBits=s}};n.LOW=new n(0,1),n.MEDIUM=new n(1,0),n.QUARTILE=new n(2,3),n.HIGH=new n(3,2),e.Ecc=n})(t.QrCode||(t.QrCode={}))})(gs||(gs={}));(t=>{(e=>{const n=class{constructor(i,s){this.modeBits=i,this.numBitsCharCount=s}numCharCountBits(i){return this.numBitsCharCount[Math.floor((i+7)/17)]}};n.NUMERIC=new n(1,[10,12,14]),n.ALPHANUMERIC=new n(2,[9,11,13]),n.BYTE=new n(4,[8,16,16]),n.KANJI=new n(8,[8,10,12]),n.ECI=new n(7,[0,0,0]),e.Mode=n})(t.QrSegment||(t.QrSegment={}))})(gs||(gs={}));var Js=gs;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var $D={L:Js.QrCode.Ecc.LOW,M:Js.QrCode.Ecc.MEDIUM,Q:Js.QrCode.Ecc.QUARTILE,H:Js.QrCode.Ecc.HIGH},xT=128,IT="L",CT="#FFFFFF",AT="#000000",NT=!1,kT=1,HD=4,WD=0,qD=.1;function PT(t,e=0){const n=[];return t.forEach(function(r,i){let s=null;r.forEach(function(o,c){if(!o&&s!==null){n.push(`M${s+e} ${i+e}h${c-s}v1H${s+e}z`),s=null;return}if(c===r.length-1){if(!o)return;s===null?n.push(`M${c+e},${i+e} h1v1H${c+e}z`):n.push(`M${s+e},${i+e} h${c+1-s}v1H${s+e}z`);return}o&&s===null&&(s=c)})}),n.join("")}function RT(t,e){return t.slice().map((n,r)=>r<e.y||r>=e.y+e.h?n:n.map((i,s)=>s<e.x||s>=e.x+e.w?i:!1))}function GD(t,e,n,r){if(r==null)return null;const i=t.length+n*2,s=Math.floor(e*qD),o=i/e,c=(r.width||s)*o,a=(r.height||s)*o,d=r.x==null?t.length/2-c/2:r.x*o,h=r.y==null?t.length/2-a/2:r.y*o,f=r.opacity==null?1:r.opacity;let p=null;if(r.excavate){let x=Math.floor(d),_=Math.floor(h),P=Math.ceil(c+d-x),y=Math.ceil(a+h-_);p={x,y:_,w:P,h:y}}const v=r.crossOrigin;return{x:d,y:h,h:a,w:c,excavation:p,opacity:f,crossOrigin:v}}function QD(t,e){return e!=null?Math.max(Math.floor(e),0):t?HD:WD}function DT({value:t,level:e,minVersion:n,includeMargin:r,marginSize:i,imageSettings:s,size:o,boostLevel:c}){let a=Ue.useMemo(()=>{const x=(Array.isArray(t)?t:[t]).reduce((_,P)=>(_.push(...Js.QrSegment.makeSegments(P)),_),[]);return Js.QrCode.encodeSegments(x,$D[e],n,void 0,void 0,c)},[t,e,n,c]);const{cells:d,margin:h,numCells:f,calculatedImageSettings:p}=Ue.useMemo(()=>{let v=a.getModules();const x=QD(r,i),_=v.length+x*2,P=GD(v,o,x,s);return{cells:v,margin:x,numCells:_,calculatedImageSettings:P}},[a,o,s,r,i]);return{qrcode:a,margin:h,cells:d,numCells:f,calculatedImageSettings:p}}var KD=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}(),YD=Ue.forwardRef(function(e,n){const r=e,{value:i,size:s=xT,level:o=IT,bgColor:c=CT,fgColor:a=AT,includeMargin:d=NT,minVersion:h=kT,boostLevel:f,marginSize:p,imageSettings:v}=r,_=Zf(r,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:P}=_,y=Zf(_,["style"]),w=v==null?void 0:v.src,T=Ue.useRef(null),M=Ue.useRef(null),L=Ue.useCallback(Q=>{T.current=Q,typeof n=="function"?n(Q):n&&(n.current=Q)},[n]),[B,C]=Ue.useState(!1),{margin:b,cells:R,numCells:S,calculatedImageSettings:E}=DT({value:i,level:o,minVersion:h,boostLevel:f,includeMargin:d,marginSize:p,imageSettings:v,size:s});Ue.useEffect(()=>{if(T.current!=null){const Q=T.current,I=Q.getContext("2d");if(!I)return;let V=R;const q=M.current,A=E!=null&&q!==null&&q.complete&&q.naturalHeight!==0&&q.naturalWidth!==0;A&&E.excavation!=null&&(V=RT(R,E.excavation));const F=window.devicePixelRatio||1;Q.height=Q.width=s*F;const O=s/S*F;I.scale(O,O),I.fillStyle=c,I.fillRect(0,0,S,S),I.fillStyle=a,KD?I.fill(new Path2D(PT(V,b))):R.forEach(function(z,$){z.forEach(function(G,J){G&&I.fillRect(J+b,$+b,1,1)})}),E&&(I.globalAlpha=E.opacity),A&&I.drawImage(q,E.x+b,E.y+b,E.w,E.h)}}),Ue.useEffect(()=>{C(!1)},[w]);const j=Jf({height:s,width:s},P);let k=null;return w!=null&&(k=Ue.createElement("img",{src:w,key:w,style:{display:"none"},onLoad:()=>{C(!0)},ref:M,crossOrigin:E==null?void 0:E.crossOrigin})),Ue.createElement(Ue.Fragment,null,Ue.createElement("canvas",Jf({style:j,height:s,width:s,ref:L,role:"img"},y)),k)});YD.displayName="QRCodeCanvas";var jT=Ue.forwardRef(function(e,n){const r=e,{value:i,size:s=xT,level:o=IT,bgColor:c=CT,fgColor:a=AT,includeMargin:d=NT,minVersion:h=kT,boostLevel:f,title:p,marginSize:v,imageSettings:x}=r,_=Zf(r,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:P,cells:y,numCells:w,calculatedImageSettings:T}=DT({value:i,level:o,minVersion:h,boostLevel:f,includeMargin:d,marginSize:v,imageSettings:x,size:s});let M=y,L=null;x!=null&&T!=null&&(T.excavation!=null&&(M=RT(y,T.excavation)),L=Ue.createElement("image",{href:x.src,height:T.h,width:T.w,x:T.x+P,y:T.y+P,preserveAspectRatio:"none",opacity:T.opacity,crossOrigin:T.crossOrigin}));const B=PT(M,P);return Ue.createElement("svg",Jf({height:s,width:s,viewBox:`0 0 ${w} ${w}`,ref:n,role:"img"},_),!!p&&Ue.createElement("title",null,p),Ue.createElement("path",{fill:c,d:`M0,0 h${w}v${w}H0z`,shapeRendering:"crispEdges"}),Ue.createElement("path",{fill:a,d:B,shapeRendering:"crispEdges"}),L)});jT.displayName="QRCodeSVG";function XD({open:t,onClose:e,memberId:n="",nickname:r="",firstName:i="",lastName:s=""}){if(N.useEffect(()=>{if(!t)return;function a(d){d.key==="Escape"&&e&&e()}return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[t,e]),!t)return null;const o=r||i||s||"Member",c=String(n||o);return u.jsx("div",{onClick:a=>{a.target===a.currentTarget&&e&&e()},style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:u.jsxs("div",{style:{width:"min(98vw, 820px)",boxSizing:"border-box",padding:20,background:"#fff",borderRadius:14,border:"1px solid var(--light-border)",boxShadow:"0 20px 60px rgba(0,0,0,.2)",overflow:"visible"},onClick:a=>a.stopPropagation(),children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12},children:[u.jsx("div",{style:{fontWeight:800,fontSize:18}}),u.jsx("button",{type:"button",className:"button",onClick:e,style:{background:"#eee",color:"#333"},children:""})]}),u.jsx("div",{style:{display:"flex",justifyContent:"center"},children:u.jsx("div",{style:{width:520,maxWidth:"78vw",aspectRatio:"1 / 1",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:u.jsxs("div",{style:{width:"100%",height:"100%",borderRadius:10,border:"6px solid var(--kusgan-magenta, #c51c8a)",boxSizing:"border-box",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative",background:"#fff"},children:[u.jsx("div",{style:{position:"absolute",top:10,left:"50%",transform:"translateX(-50%)",fontSize:16,color:"var(--kusgan-magenta, #c51c8a)",fontWeight:700},children:"kusgan"}),u.jsx("div",{style:{width:"72%",height:"72%",display:"flex",alignItems:"center",justifyContent:"center"},children:u.jsx(jT,{value:c,size:Math.min(700,Math.floor(window.innerWidth*.7))})}),u.jsx("div",{style:{position:"absolute",bottom:10,left:"50%",transform:"translateX(-50%)",fontSize:16,color:"#333",fontWeight:600},children:o})]})})})]})})}const{addProgressRow:JD,uploadMemberPhoto:ZD}=tt,MT="Asia/Manila",ej=()=>new Intl.DateTimeFormat("en-CA",{timeZone:MT,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date),tj=t=>{var o,c,a;if(!t)return"-";let e;if(typeof t=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(t)){const[d,h,f]=t.split("-").map(Number);e=new Date(Date.UTC(d,h-1,f))}else e=t instanceof Date?t:new Date(t);if(isNaN(e))return"-";const n=new Intl.DateTimeFormat("en-US",{timeZone:MT,month:"short",day:"numeric",year:"numeric"}).formatToParts(e),r=((o=n.find(d=>d.type==="month"))==null?void 0:o.value)||"",i=((c=n.find(d=>d.type==="day"))==null?void 0:c.value)||"",s=((a=n.find(d=>d.type==="year"))==null?void 0:a.value)||"";return`${r}-${i}, ${s}`};function nj(t,e){if(!t||!e)return 1;const[n,r,i]=t.split("-").map(Number),[s,o,c]=e.split("-").map(Number),a=Date.UTC(n,r-1,i),d=Date.UTC(s,o-1,c),h=Math.floor((d-a)/864e5);return Math.max(1,h+1)}function rj({open:t,onClose:e,memberId:n,memberSinceYMD:r,onSaved:i,memberNick:s}){const o=ej(),c=N.useMemo(()=>nj(r,o),[r,o]),[a,d]=N.useState(""),[h,f]=N.useState(""),[p,v]=N.useState(""),[x,_]=N.useState(""),[P,y]=N.useState(""),[w,T]=N.useState(""),[M,L]=N.useState(""),[B,C]=N.useState(""),[b,R]=N.useState(""),[S,E]=N.useState(""),[j,k]=N.useState(""),[Q,I]=N.useState(""),[V,q]=N.useState(""),[A,F]=N.useState(""),[O,z]=N.useState(""),[$,G]=N.useState(""),[J,ae]=N.useState([]),de=Ue.useRef(null),[ie,_e]=N.useState(-1),[Te,ge]=N.useState(""),[Pe,xe]=N.useState(!1),U=N.useMemo(()=>{const X=Number(a)||0,re=(Number(h)||0)/100;return!X||!re?0:Math.round(X/(re*re)*10)/10},[a,h]);N.useMemo(()=>Math.round((Number(a)||0)*2.20462262185*10)/10,[a]),N.useMemo(()=>Math.round((Number(h)||0)/2.54*10)/10,[h]),N.useEffect(()=>{t&&(d(""),f(""),v(""),_(""),y(""),T(""),L(""),C(""),R(""),E(""),k(""),I(""),q(""),F(""),z(""),G(""),ae([]),_e(-1),xe(!1))},[t]);const Z=async X=>{if(X)try{const re=String(n||"").toLowerCase(),oe=await ZD(X,re),ue=typeof oe=="string"?oe:(oe==null?void 0:oe.url)||"";ae(be=>{const De=Array.isArray(be)?[...be]:[];for(;De.length<3;)De.push("");const et=ie>=0&&ie<3?ie:De.findIndex(nn=>!nn);return et===-1||(De[et]=ue),De})}catch(re){const oe=(re==null?void 0:re.message)||"Failed to upload photo";ge(oe);try{qt.emit("modal:error",{message:oe,source:"ProgressModal",error:String(re)})}catch{}}finally{_e(-1)}},H=X=>{ae(re=>{const oe=Array.isArray(re)?[...re]:[];if(X<0||X>=3)return oe;if(oe.length<3)for(;oe.length<3;)oe.push("");return oe[X]="",oe})},te=async X=>{var oe;if((oe=X==null?void 0:X.preventDefault)==null||oe.call(X),!n||Pe)return;xe(!0),ge("");const re={MemberID:n,Date:o,No:`Day ${c}`,"Weight (kg)":a?String(a):"","Weight(kg)":a?String(a):"",WeightKg:a?String(a):"",Weight:a?String(a):"",BMI:U?String(U):"",MuscleMass:p?String(p):"",BodyFat:x?String(x):"",VisceralFat:P?String(P):"",Photo1URL:J[0]||"",Photo2URL:J[1]||"",Photo3URL:J[2]||"","Height (cm)":h?String(h):"","Height(cm)":h?String(h):"",HeightCm:h?String(h):"",Height:h?String(h):"",Chest:w?String(w):"",Waist:M?String(M):"",Hips:B?String(B):"",Shoulders:b?String(b):"",Arms:S?String(S):"",Forearms:j?String(j):"",Thighs:Q?String(Q):"",Calves:V?String(V):"",BloodPressure:A,"RestingHeart Rate":O,Comments:$};try{await JD(re),i==null||i(),e==null||e()}catch(ue){const be=(ue==null?void 0:ue.message)||"Failed to save progress entry";ge(be);try{qt.emit("modal:error",{message:be,source:"ProgressModal",error:String(ue)})}catch{}}finally{xe(!1)}};return t?u.jsxs(xs,{open:t,onClose:e,title:"Progress Entry",width:1e3,children:[Te&&u.jsx("div",{className:"small-error",style:{marginBottom:8},children:Te}),u.jsxs("form",{onSubmit:te,style:{width:"100%",padding:0,background:"transparent",border:"none",boxShadow:"none",overflow:"visible"},children:[u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12,marginBottom:12},children:[u.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[u.jsx("div",{style:{fontSize:14,fontStyle:"italic",color:"var(--muted)",display:"block",marginBottom:4},children:"Nickname"}),u.jsx("div",{style:{fontWeight:700,fontSize:18},children:s||n})]}),u.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[u.jsx("div",{style:{fontSize:14,fontStyle:"italic",color:"var(--muted)",display:"block",marginBottom:4},children:"Date"}),u.jsx("div",{style:{fontWeight:700,fontSize:18},children:tj(o)})]}),u.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[u.jsx("div",{style:{fontSize:14,fontStyle:"italic",color:"var(--muted)",display:"block",marginBottom:4},children:"No."}),u.jsx("div",{style:{fontWeight:700,fontSize:18},children:`Day ${c}`})]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:12},children:[u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Weight (kg)"}),u.jsx("input",{type:"number",step:"0.1",min:"0",value:a,onChange:X=>d(X.target.value)})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Height (cm)"}),u.jsx("input",{type:"number",step:"0.1",min:"0",value:h,onChange:X=>f(X.target.value)})]}),u.jsxs("div",{className:"field",children:[u.jsx("span",{className:"label",children:"BMI"}),u.jsx("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10,fontWeight:700},children:U||"-"})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Muscle Mass"}),u.jsx("input",{type:"number",step:"0.1",min:"0",value:p,onChange:X=>v(X.target.value)})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Body Fat (%)"}),u.jsx("input",{type:"number",step:"0.1",min:"0",value:x,onChange:X=>_(X.target.value)})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Visceral Fat"}),u.jsx("input",{type:"number",step:"0.1",min:"0",value:P,onChange:X=>y(X.target.value)})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Chest (cm)"}),u.jsx("input",{type:"number",step:"0.1",min:"0",value:w,onChange:X=>T(X.target.value)})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Waist (cm)"}),u.jsx("input",{type:"number",step:"0.1",min:"0",value:M,onChange:X=>L(X.target.value)})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Hips (cm)"}),u.jsx("input",{type:"number",step:"0.1",min:"0",value:B,onChange:X=>C(X.target.value)})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Shoulders (cm)"}),u.jsx("input",{type:"number",step:"0.1",min:"0",value:b,onChange:X=>R(X.target.value)})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Arms (cm)"}),u.jsx("input",{type:"number",step:"0.1",min:"0",value:S,onChange:X=>E(X.target.value)})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Forearms (cm)"}),u.jsx("input",{type:"number",step:"0.1",min:"0",value:j,onChange:X=>k(X.target.value)})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Thighs (cm)"}),u.jsx("input",{type:"number",step:"0.1",min:"0",value:Q,onChange:X=>I(X.target.value)})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Calves (cm)"}),u.jsx("input",{type:"number",step:"0.1",min:"0",value:V,onChange:X=>q(X.target.value)})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Blood Pressure"}),u.jsx("input",{placeholder:"120/80",value:A,onChange:X=>F(X.target.value)})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{className:"label",children:"Resting Heart Rate"}),u.jsx("input",{type:"number",step:"1",min:"0",value:O,onChange:X=>z(X.target.value)})]}),u.jsx("div",{})]}),u.jsxs("div",{style:{marginTop:12},children:[u.jsx("div",{className:"label",style:{marginBottom:6},children:"Photos (max 3)"}),u.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:12},children:[0,1,2].map(X=>{const re=J[X]||"";return u.jsxs("div",{style:{position:"relative"},children:[u.jsx("div",{onClick:()=>{},style:{position:"relative",width:"100%",height:0,paddingTop:"133.333%",borderRadius:8,border:re?"1px solid #e5e7eb":"1px dashed #e5e7eb",cursor:"default",overflow:"hidden",background:re?"#fff":"#fafafa",opacity:.65},children:re?u.jsx("img",{src:re,alt:`Photo ${X+1}`,style:{position:"absolute",inset:0,width:"100%",height:"100%",objectFit:"cover"}}):u.jsx("div",{style:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",color:"#999"},children:"Photo disabled"})}),re&&u.jsx("button",{type:"button","aria-label":"Remove",onClick:()=>H(X),style:{position:"absolute",top:6,right:6,background:"rgba(0,0,0,.55)",color:"#fff",borderRadius:6,padding:"4px 6px",border:0},children:""})]},X)})})]}),u.jsx("input",{ref:de,type:"file",accept:"image/*",style:{display:"none"},onChange:X=>{var oe;const re=(oe=X.target.files)==null?void 0:oe[0];re&&Z(re)}}),u.jsxs("div",{className:"field",style:{marginTop:12},children:[u.jsx("span",{className:"label",children:"Comments"}),u.jsx("textarea",{rows:4,value:$,onChange:X=>G(X.target.value),style:{width:"100%",borderRadius:8,border:"1px solid #e5e7eb",padding:12,fontFamily:"inherit",resize:"vertical",fontSize:16}})]}),u.jsxs("div",{style:{marginTop:12,display:"flex",gap:10,justifyContent:"flex-end"},children:[u.jsx("button",{type:"button",className:"back-btn",onClick:e,style:{background:"#e5e7eb",color:"#111",fontWeight:700},children:"Cancel"}),u.jsx("button",{type:"submit",className:"primary-btn",disabled:Pe,children:Pe?"Saving...":" Save Progress"})]})]})]}):null}const ij=(t="")=>{const e=String(t||"").match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^\/&#?]+)/);return e&&e[1]?e[1]:""},sj=(t="")=>{const e=String(t||"");if(/googleusercontent\.com\//.test(e))return e;const n=ij(e);return n?`https://drive.google.com/thumbnail?id=${n}&sz=w1000`:e},pt=(t,e=[])=>{if(!t)return"";for(const n of e){if(Object.prototype.hasOwnProperty.call(t,n))return t[n];const r=Object.keys(t).find(i=>i.toLowerCase().replace(/\s+/g,"")===n.toLowerCase().replace(/\s+/g,""));if(r)return t[r]}return""};function oj({open:t,onClose:e,row:n,memberNick:r}){if(!t)return null;const i=n||{},s=pt(i,["MemberID","memberid","member_id","id"]),o=pt(i,["Date","date","recorded","log_date","timestamp"]),c=pt(i,["No","no","entry_no","seq","number"]),a=pt(i,["Weight (kg)","Weight(kg)","WeightKg","Weight (lbs)","Weight(lbs)","Weight","Weight_lbs","weight","weight_lbs","weight_(lbs)"]),d=pt(i,["BMI","bmi"]),h=pt(i,["Height (cm)","Height(cm)","HeightCm","Height (inches)","Height(inches)","Height_in","height_in","height_inches"]),f=pt(i,["MuscleMass","muscle_mass","muscle","Muscle"]),p=pt(i,["BodyFat","body_fat","bf"]),v=pt(i,["VisceralFat","visceral_fat"]),x=pt(i,["Chest"]),_=pt(i,["Waist"]),P=pt(i,["Hips"]),y=pt(i,["Shoulders"]),w=pt(i,["Arms"]),T=pt(i,["Forearms"]),M=pt(i,["Thighs"]),L=pt(i,["Calves"]),B=pt(i,["BloodPressure","blood_pressure"]),C=pt(i,["RestingHeart Rate","RestingHeartRate","resting_heart_rate"]),b=pt(i,["Comments","comments","notes"]),R=pt(i,["Photo1URL","Photo1","photo1","photo_url","photo"]),S=pt(i,["Photo2URL","Photo2","photo2"]),E=pt(i,["Photo3URL","Photo3","photo3"]);return u.jsxs(xs,{open:t,onClose:e,title:"Progress Details",width:1e3,children:[u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12,marginBottom:12},children:[u.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[u.jsx("span",{style:{fontSize:14,fontStyle:"italic",color:"var(--muted)",display:"block",marginBottom:4},children:"Nickname"}),u.jsx("div",{style:{fontWeight:700,fontSize:18},children:r||s||"-"})]}),u.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[u.jsx("span",{style:{fontSize:14,fontStyle:"italic",color:"var(--muted)",display:"block",marginBottom:4},children:"Date"}),u.jsx("div",{style:{fontWeight:700,fontSize:18},children:lj(o)||"-"})]}),u.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[u.jsx("span",{style:{fontSize:14,fontStyle:"italic",color:"var(--muted)",display:"block",marginBottom:4},children:"No."}),u.jsx("div",{style:{fontWeight:700,fontSize:18},children:c||"-"})]})]}),u.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:12},children:[["Weight (kg)",a],["Height (cm)",h],["BMI",d],["Muscle Mass (%)",f],["Body Fat (%)",p],["Visceral Fat (%)",v],["Chest (cm)",x],["Waist (cm)",_],["Hips (cm)",P],["Shoulders (cm)",y],["Arms (cm)",w],["Forearms (cm)",T],["Thighs (cm)",M],["Calves (cm)",L],["Blood Pressure (mmHg)",B],["Resting Heart Rate (bpm)",C]].map(([j,k])=>u.jsxs("div",{className:"field",children:[u.jsx("span",{className:"label",style:{display:"block",marginBottom:6},children:j}),u.jsx("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10,fontWeight:700,fontSize:18},children:!k||String(k).trim()==="0"?"-":String(k)})]},j))}),u.jsxs("div",{className:"field",style:{marginTop:12},children:[u.jsx("span",{className:"label",children:"Comments"}),u.jsx("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:12,fontSize:16,minHeight:72},children:b?String(b):"-"})]}),u.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:12,marginTop:12},children:[R,S,E].map((j,k)=>u.jsx("div",{style:{position:"relative"},children:u.jsx("div",{style:{position:"relative",width:"100%",height:0,paddingTop:"133.333%",borderRadius:8,border:j?"1px solid #e5e7eb":"1px dashed #e5e7eb",overflow:"hidden"},children:j?u.jsx("img",{src:sj(j),alt:`Photo ${k+1}`,style:{position:"absolute",inset:0,width:"100%",height:"100%",objectFit:"cover"}}):u.jsx("div",{style:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",color:"#999"},children:"No photo"})})},k))})]})}const aj="Asia/Manila";function lj(t){var o,c,a;if(!t)return"";let e;if(typeof t=="string")if(/^\d{4}-\d{2}-\d{2}$/.test(t)){const[d,h,f]=t.split("-").map(Number);e=new Date(Date.UTC(d,h-1,f))}else{const d=new Date(t);isNaN(d)||(e=d)}else t instanceof Date&&(e=t);if(!e||isNaN(e))return String(t);const n=new Intl.DateTimeFormat("en-US",{timeZone:aj,month:"short",day:"numeric",year:"numeric"}).formatToParts(e),r=((o=n.find(d=>d.type==="month"))==null?void 0:o.value)||"",i=((c=n.find(d=>d.type==="day"))==null?void 0:c.value)||"",s=((a=n.find(d=>d.type==="year"))==null?void 0:a.value)||"";return`${r}-${i}, ${s}`}function OT({width:t="100%",height:e=200}){return u.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-start"},children:[u.jsx("div",{style:{width:150,height:200,borderRadius:12,background:"#f3f4f6",boxShadow:"inset 0 0 0 1px rgba(0,0,0,0.02)"}}),u.jsxs("div",{style:{flex:1},children:[u.jsx("div",{style:{height:22,width:"60%",background:"#f3f4f6",borderRadius:6,marginBottom:8}}),u.jsx("div",{style:{height:18,width:"40%",background:"#f3f4f6",borderRadius:6,marginBottom:14}}),u.jsx("div",{style:{height:12,width:"80%",background:"#f3f4f6",borderRadius:6,marginBottom:6}}),u.jsx("div",{style:{height:12,width:"70%",background:"#f3f4f6",borderRadius:6,marginBottom:6}}),u.jsx("div",{style:{height:12,width:"50%",background:"#f3f4f6",borderRadius:6,marginTop:10}})]})]})}function hd({text:t="Refreshing",show:e=!0}){return e?u.jsxs("span",{className:"refresh-badge",role:"status","aria-live":"polite",children:[u.jsx("span",{className:"refresh-spinner","aria-hidden":!0}),u.jsx("span",{style:{marginLeft:8},children:t})]}):null}const wn=(t,e)=>e.map(n=>t[n]).find(n=>n!==void 0&&n!==""),R_=t=>{if(!t&&t!==0)return null;try{if(t&&typeof t.toDate=="function")return t.toDate()}catch{}if(t&&typeof t.seconds=="number")return new Date(t.seconds*1e3);if(t instanceof Date)return t;const e=new Date(t);return isNaN(e)?null:e},cj="Asia/Manila",uc=t=>{var o,c,a;if(!t)return"-";const e=t instanceof Date?t:new Date(t);if(isNaN(e))return"-";const n=new Intl.DateTimeFormat("en-US",{timeZone:cj,month:"short",day:"numeric",year:"numeric"}).formatToParts(e),r=((o=n.find(d=>d.type==="month"))==null?void 0:o.value)||"",i=((c=n.find(d=>d.type==="day"))==null?void 0:c.value)||"",s=((a=n.find(d=>d.type==="year"))==null?void 0:a.value)||"";return`${r}-${i}, ${s}`},ur=t=>t==null||String(t).trim()===""?"-":String(t),ya=t=>{const n=String(t||"").match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return n&&n[1]?n[1]:""},uj=t=>{const e=String(t||"");if(!e)return"";const n=e.match(/https?:\/\/[^\s}]+/);if(n){const s=n[0];if(/googleusercontent\.com\//.test(s))return s;const o=s.match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^\/&?#]+)/);return o&&o[1]?`https://drive.google.com/uc?export=view&id=${o[1]}`:s}if(/googleusercontent\.com\//.test(e))return e;const r=e.match(/\/file\/d\/([^/]+)/)||e.match(/[?&]id=([^&]+)/)||e.match(/\/uc\?[^#]*id=([^&]+)/),i=r?r[1]:"";return i?`https://drive.google.com/uc?export=view&id=${i}`:e},D_=t=>{const e=String(t||"");if(/googleusercontent\.com\//.test(e))return e;const n=ya(e);return n?`https://drive.google.com/thumbnail?id=${n}&sz=w1000`:e};function dj({member:t,status:e={},isRefreshing:n=!1,onEdit:r=()=>{},onAddPayment:i=()=>{},onShowQr:s=()=>{},onShowProgress:o=()=>{},onCheckIn:c=()=>{}}){const[a,d]=N.useState(!1),h=wn(t||{},["lastname","last_name"]),f=wn(t||{},["firstname","first_name"]),p=wn(t||{},["middlename","middle_name"]),v=wn(t||{},["gender"]),x=wn(t||{},["birthday","birth_date","dob"]),_=R_(x);wn(t||{},["nick_name","nickname"]);const P=wn(t||{},["street"]),y=wn(t||{},["brgy","barangay"]),w=wn(t||{},["municipality","city"]),T=wn(t||{},["email"]),M=wn(t||{},["mobile","phone"]),L=R_(wn(t||{},["member_since","membersince","join_date"]));String(wn(t||{},["memberid","member_id","id"])||"").trim();const B=wn(t||{},["photourl","photo_url","photo"]),C=uj(B);D_(C),N.useEffect(()=>{d(!1)},[C]);const b=_?new Date().getFullYear()-_.getFullYear()-(new Date().getMonth()<_.getMonth()||new Date().getMonth()===_.getMonth()&&new Date().getDate()<_.getDate()?1:0):"-";return u.jsxs("div",{className:"member-card",style:{marginTop:12},children:[u.jsx("div",{className:"member-photo",children:u.jsx("div",{className:"photo-box",children:C&&!a?u.jsx("img",{src:D_(C),alt:"photo",onError:R=>{const S=R.currentTarget;if(!S.dataset.retry&&B){S.dataset.retry="1";const E=ya(B)||ya(C);E?S.src=`https://drive.google.com/uc?export=view&id=${E}`:S.style.display="none"}else if(S.dataset.retry==="1"){S.dataset.retry="2";const E=ya(B)||ya(C);E?S.src=`https://drive.google.com/uc?export=download&id=${E}`:d(!0)}else d(!0)}}):u.jsx("div",{style:{color:"var(--muted)",padding:16},children:"No photo"})})}),u.jsxs("div",{className:"member-info",children:[u.jsxs("div",{className:"member-grid",children:[u.jsxs("div",{className:"cell lastname",children:[u.jsx("div",{className:"label",children:"Last Name"}),u.jsx("div",{className:"value",children:ur(h)})]}),u.jsxs("div",{className:"cell firstname",children:[u.jsx("div",{className:"label",children:"First Name"}),u.jsx("div",{className:"value",children:ur(f)})]}),u.jsxs("div",{className:"cell middlename",children:[u.jsx("div",{className:"label",children:"Middle Name"}),u.jsx("div",{className:"value",children:ur(p)})]}),u.jsxs("div",{className:"cell gender",children:[u.jsx("div",{className:"label",children:"Gender"}),u.jsx("div",{className:"value",children:ur(v)})]}),u.jsxs("div",{className:"cell birthday",children:[u.jsx("div",{className:"label",children:"Birthday"}),u.jsx("div",{className:"value",children:uc(_)})]}),u.jsxs("div",{className:"cell age",children:[u.jsx("div",{className:"label",children:"Age"}),u.jsx("div",{className:"value",children:ur(b)})]}),u.jsxs("div",{className:"cell street",children:[u.jsx("div",{className:"label",children:"House No. / Street Name / Sitio"}),u.jsx("div",{className:"value",children:ur(P)})]}),u.jsxs("div",{className:"cell brgy",children:[u.jsx("div",{className:"label",children:"Brgy."}),u.jsx("div",{className:"value",children:ur(y)})]}),u.jsxs("div",{className:"cell municipality",children:[u.jsx("div",{className:"label",children:"Municipality / City"}),u.jsx("div",{className:"value",children:ur(w)})]}),u.jsxs("div",{className:"cell nickname",children:[u.jsx("div",{className:"label",children:"Member Since"}),u.jsx("div",{className:"value",children:uc(L)})]}),u.jsxs("div",{className:"cell mobile",children:[u.jsx("div",{className:"label",children:"Mobile"}),u.jsx("div",{className:"value",children:ur(M)})]}),u.jsxs("div",{className:"cell email",children:[u.jsx("div",{className:"label",children:"Email"}),u.jsx("div",{className:"value",children:ur(T)})]})]}),u.jsxs("div",{className:"status-tiles",children:[u.jsxs("div",{className:`status-tile ${e.membershipState==null?"none":e.membershipState}`,children:[u.jsx("div",{className:"title",children:"Gym Membership"}),u.jsxs("div",{style:{marginBottom:10},children:[e.membershipState==="active"&&u.jsx("span",{className:"pill ok",children:"Active"}),e.membershipState==="expired"&&u.jsx("span",{className:"pill bad",children:"Expired"}),(!e.membershipState||e.membershipState==="none")&&u.jsx("span",{className:"pill",style:{background:"#fff",color:"#555",borderColor:"#ddd"},children:"None"})]}),u.jsx("div",{className:"label",children:"Valid until"}),u.jsx("div",{className:"value",children:uc(e.membershipEnd)})]}),u.jsxs("div",{className:`status-tile ${e.coachEnd?e.coachActive?"active":"expired":"none"}`,children:[u.jsx("div",{className:"title",children:"Coach Subscription"}),u.jsxs("div",{style:{marginBottom:10},children:[e.coachActive&&u.jsx("span",{className:"pill ok",children:"Active"}),e.coachEnd&&!e.coachActive&&u.jsx("span",{className:"pill bad",children:"Expired"}),!e.coachEnd&&u.jsx("span",{className:"pill",style:{background:"#fff",color:"#555",borderColor:"#ddd"},children:"None"})]}),u.jsx("div",{className:"label",children:"Valid until"}),u.jsx("div",{className:"value",children:uc(e.coachEnd)})]})]}),u.jsxs("div",{className:"member-actions",children:[u.jsx("button",{className:"primary-btn",onClick:()=>r(),title:"Edit member details",children:" Edit"}),u.jsx("button",{className:"primary-btn",onClick:()=>i(),title:"Manage payments",children:" Add Payment"}),u.jsx("button",{className:"primary-btn",onClick:()=>s(),title:"Show QR code for this member",children:" QR Code"}),u.jsx("button",{className:"primary-btn",onClick:()=>o(),title:"Track or view progress",children:" Progress"})]})]})]})}const hj=t=>String(t||"").trim().toLowerCase().replace(/\s+/g,"_"),Zr=(t,e)=>e.map(n=>(t||{})[n]).find(n=>n!==void 0&&n!==""),aa=t=>{if(!t&&t!==0)return null;try{if(t&&typeof t.toDate=="function")return t.toDate()}catch{}if(t&&typeof t.seconds=="number")return new Date(t.seconds*1e3);if(t instanceof Date)return t;if(typeof t=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(t))try{return new Date(`${t}T00:00:00+08:00`)}catch{}const e=new Date(t);return isNaN(e)?null:e},fh=t=>{const e={};return Object.entries(t||{}).forEach(([n,r])=>{e[hj(n)]=r}),e};function Oi(t,e,n=[]){const r=y=>{if(!y)return null;const w=y instanceof Date?y:aa(y);return w?new Intl.DateTimeFormat("en-CA",{timeZone:"Asia/Manila",year:"numeric",month:"2-digit",day:"2-digit"}).format(w):null},i=r(new Date);let s=null,o=null,c=null,a=null;const d=new Map,h=Array.isArray(n)?n:[],f=y=>{const w=String(y??"").trim().toLowerCase();return w==="yes"||w==="y"||w==="true"||w==="1"},p=(y,w)=>{for(const T of w){if(y&&Object.prototype.hasOwnProperty.call(y,T))return y[T];const M=Object.keys(y||{}).find(L=>L.toLowerCase().replace(/\s+/g,"")===T.toLowerCase().replace(/\s+/g,""));if(M)return y[M]}};h.forEach(y=>{const w=String(p(y,["Particulars"])||"").trim();if(!w)return;const T=f(p(y,["Gym membership","Gym Membership","GymMembership","Membership"])),M=f(p(y,["Coach subscription","Coach Subscription","CoachSubscription","Coach"]));d.set(String(w).toLowerCase(),{gym:T,coach:M})});let v=null;if(typeof e=="string")v=String(e||"").trim().toLowerCase();else if(e&&typeof e=="object"){const y=fh(e);v=String(Zr(y,["memberid","member_id","id","member_id_"])||"").trim().toLowerCase()}const x=Array.isArray(t)?t:[];for(const y of x){const w=fh(y);if(v){const V=String(Zr(w,["memberid","member_id","id","member_id_"])||"").trim().toLowerCase();if(!V||V!==v)continue}const T=String(Zr(w,["particulars","type","item","category","product","paymentfor","plan","description"])||"").trim(),M=Zr(w,["gymvaliduntil","gym_valid_until","gym_until","enddate","end_date","valid_until","expiry","expires","until","end"]),L=Zr(w,["coachvaliduntil","coach_valid_until","coach_until","coach_end","coachend"]),B=Zr(w,["enddate","end_date","valid_until","expiry","expires","until","end"]),C=aa(M),b=aa(L),R=aa(B),S=r(C),E=r(b),j=r(R),k=d.get(String(T).toLowerCase())||{gym:null,coach:null},Q=k.coach===!0||k.coach===null&&/coach|trainer|pt/i.test(T),I=k.gym===!0||k.gym===null&&/member|gym/i.test(T);S?(!c||S>c)&&(c=S,s=C):I&&j&&(!c||j>c)&&(c=j,s=R),E?(!a||E>a)&&(a=E,o=b):Q&&j&&(!a||j>a)&&(a=j,o=R)}if((!s||s==null)&&e&&typeof e=="object"){const y=fh(e);if(String(Zr(y,["membershipstate","membership_state","membership","status"])||"").trim().toLowerCase()==="active")return{membershipEnd:s,membershipState:"active",coachEnd:o,coachActive:!!(a&&a>=i)};const T=Zr(y,["membershipend","membership_end","membershipEnd","membership_end","gymvaliduntil","gym_valid_until","gym_until","enddate","end_date","valid_until","expiry","expires","until","end","gym_valid","gym_validity","gymvalid"]);if(T){const M=aa(T),L=r(M);M&&!isNaN(M)&&(!c||L>c)&&(c=L,s=M)}}let _=null;c&&(_=c>=i?"active":"expired");let P=!1;return a&&(P=a>=i),{membershipEnd:s,membershipState:_,coachEnd:o,coachActive:P}}const{fetchMemberBundle:fj,fetchPricing:mj,gymQuickAppend:j_,gymClockOut:pj,upsertGymEntry:gj,gymClockIn:yj,fetchMemberByIdFresh:vj}=tt,Fs="Asia/Manila",mh=t=>{var o,c,a;if(!t)return"-";const e=t instanceof Date?t:new Date(t);if(isNaN(e))return"-";const n=new Intl.DateTimeFormat("en-US",{timeZone:Fs,month:"short",day:"numeric",year:"numeric"}).formatToParts(e),r=((o=n.find(d=>d.type==="month"))==null?void 0:o.value)||"",i=((c=n.find(d=>d.type==="day"))==null?void 0:c.value)||"",s=((a=n.find(d=>d.type==="year"))==null?void 0:a.value)||"";return`${r}-${i}, ${s}`},VT=t=>{const n=String(t||"").match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return n&&n[1]?n[1]:""},_j=t=>{const e=String(t||"");if(!e)return"";const n=e.match(/https?:\/\/[^\s}]+/);if(n){const i=n[0];if(/googleusercontent\.com\//.test(i))return i;const s=i.match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return s&&s[1]?`https://drive.google.com/uc?export=view&id=${s[1]}`:i}if(/googleusercontent\.com\//.test(e))return e;const r=VT(e);return r?`https://drive.google.com/uc?export=view&id=${r}`:e},wj=t=>{const e=String(t||"");if(/googleusercontent\.com\//.test(e))return e;const n=VT(e);return n?`https://drive.google.com/thumbnail?id=${n}&sz=w1000`:e};function fd({open:t,onClose:e,memberId:n,initialEntry:r=null,onSuccess:i,status:s=null,mode:o=null}){const[c,a]=N.useState(null),[d,h]=N.useState([]),[f,p]=N.useState(null),[v,x]=N.useState(!1),[_,P]=N.useState(""),[y,w]=N.useState(""),[T,M]=N.useState(""),[L,B]=N.useState(""),[C,b]=N.useState(!1),[R,S]=N.useState(!1),E=["Coach Elmer","Coach Jojo","None"],j=["Full body","Upper body","Lower body","Chest","Other"];N.useEffect(()=>{let V=!0;if(!(!t||!n))return(async()=>{x(!0);try{console.debug("[CheckInConfirmModal] loading bundle for",n);const[q,A]=await Promise.all([fj(n),mj()]);if(!V)return;if(q&&!q.member)try{console.debug("[CheckInConfirmModal] bundle missing member, trying fetchMemberByIdFresh",n);const ie=await vj(n);ie&&(q.member=ie)}catch(ie){console.debug("[CheckInConfirmModal] fetchMemberByIdFresh fallback failed",ie)}a(q);const F=(A==null?void 0:A.rows)||(A==null?void 0:A.data)||[];h(F);const O=s||Oi((q==null?void 0:q.payments)||[],n,F);p(O);const z=new Intl.DateTimeFormat("en-CA",{timeZone:Fs,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date),G=((q==null?void 0:q.gymEntries)||[]).filter(ie=>{const _e=(ie==null?void 0:ie.Date)||(ie==null?void 0:ie.date);if(!_e)return!1;const Te=new Date(_e);return new Intl.DateTimeFormat("en-CA",{timeZone:Fs,year:"numeric",month:"2-digit",day:"2-digit"}).format(Te)===z}).find(ie=>!String((ie==null?void 0:ie.TimeOut)||(ie==null?void 0:ie.timeout)||"").trim());let J=!1;if(r){const ie=r.Date||r.date||"";if(ie){const _e=new Date(ie);new Intl.DateTimeFormat("en-CA",{timeZone:Fs,year:"numeric",month:"2-digit",day:"2-digit"}).format(_e)===z&&!String(r.TimeOut||"").trim()&&(J=!0)}}let ae=!!G||J;o==="in"&&(ae=!1),o==="out"&&(ae=!0),b(ae);const de=J?r:G||null;if(ae&&de){const ie=de||{};P(String(ie.Workouts??ie.workouts??ie.Done??"").trim()),w(String(ie.Comments??ie.comments??ie.Notes??"").trim()),M(String(ie.Coach??ie.coach??"")||""),B(String(ie.Focus??ie.focus??"")||"")}else P(""),w(""),M(""),B("")}catch(q){try{console.debug("[CheckInConfirmModal] load error",q),qt.emit("modal:error",{message:"Failed to load check-in data",source:"CheckInConfirmModal",error:String(q)})}catch{}}finally{V&&x(!1)}})(),()=>{V=!1}},[t,n,r==null?void 0:r.rowNumber,r==null?void 0:r.Date,r==null?void 0:r.TimeIn,s]);const k=(c==null?void 0:c.member)||null,Q=async()=>{if(n){S(!0);try{if(r){const V=r.Date||r.date||"",q=new Intl.DateTimeFormat("en-CA",{timeZone:Fs,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date),A=V?new Date(V):null,F=A?new Intl.DateTimeFormat("en-CA",{timeZone:Fs,year:"numeric",month:"2-digit",day:"2-digit"}).format(A):"",O=String(r.TimeOut||r.timeout||"").trim();if(F===q&&!O){const z=new Date().toISOString();try{const $=r.TimeIn||r.Timein||r.timeIn||r.timein||null,G=r.Date||r.date||null,J={memberId:n,timeOut:z,Workouts:_,Comments:y};try{console.debug("[CheckInConfirmModal] upsert payload",J)}catch{}f!=null&&f.coachActive&&(T&&T!=="None"&&(J.Coach=T),L&&(J.Focus=L)),$&&(J.TimeIn=$),G&&(J.Date=G),r.rowNumber&&(J.rowNumber=r.rowNumber);const ae=await gj(J);try{console.debug("[CheckInConfirmModal] upsertGymEntry res",ae)}catch{}try{qt.emit("gymEntry:added",{MemberID:n,...ae||{},Workouts:_,Comments:y})}catch{}S(!1),i&&i(),e&&e();return}catch($){try{qt.emit("modal:error",{message:"Failed to upsert gym entry",source:"CheckInConfirmModal",error:String($)})}catch{}}}}try{const V={wantsOut:!0,Workouts:_,Comments:y};if(f!=null&&f.coachActive&&(T&&T!=="None"&&(V.Coach=T),L&&(V.Focus=L)),r){const q=r.TimeIn||r.Timein||r.timeIn||r.timein||null,A=r.Date||r.date||null;q&&(V.TimeIn=q),A&&(V.Date=A),r.rowNumber&&(V.rowNumber=r.rowNumber)}try{console.debug("[CheckInConfirmModal] gymQuickAppend extra",V)}catch{}await j_(n,V)}catch(V){const q={Workouts:_,Comments:y};r&&(r.TimeIn&&(q.TimeIn=r.TimeIn),r.Date&&(q.Date=r.Date),r.rowNumber&&(q.rowNumber=r.rowNumber)),f!=null&&f.coachActive&&(T&&T!=="None"&&(q.Coach=T),L&&(q.Focus=L));try{console.debug("[CheckInConfirmModal] gymQuickAppend failed, falling back to gymClockOut",q,V)}catch{}await pj(n,q)}try{qt.emit("gymEntry:added",{MemberID:n,Workouts:_,Comments:y})}catch{}S(!1),i&&i(),e&&e()}catch(V){try{qt.emit("modal:error",{message:"Checkout failed",source:"CheckInConfirmModal",error:String(V)})}catch{}S(!1)}}},I=async()=>{if(n){S(!0);try{const V={Workouts:_,Comments:y};f!=null&&f.coachActive&&(T&&T!=="None"&&(V.Coach=T),L&&(V.Focus=L));try{await j_(n,V)}catch{await yj(n,V)}S(!1),i&&i(),e&&e()}catch(V){try{qt.emit("modal:error",{message:"Checkin failed",source:"CheckInConfirmModal",error:String(V)})}catch{}S(!1)}}};return t?u.jsx(xs,{open:t,onClose:e,width:720,noInternalScroll:!0,children:v?u.jsx("div",{style:{padding:24},children:"Loading"}):k?u.jsxs(u.Fragment,{children:[u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"auto 1fr",gap:16,alignItems:"center"},children:[u.jsx("div",{style:{width:150,height:200,borderRadius:12,overflow:"hidden",border:"1px solid #e7e8ef",background:"#fafbff"},children:k.PhotoURL||k.Photo?u.jsx("img",{src:wj(_j(k.PhotoURL||k.Photo)),alt:"Member",style:{width:"100%",height:"100%",objectFit:"cover"}}):u.jsx("div",{style:{display:"flex",width:"100%",height:"100%",alignItems:"center",justifyContent:"center",color:"#999"},children:"No Photo"})}),u.jsxs("div",{children:[u.jsx("div",{style:{fontWeight:900,fontSize:28,lineHeight:1.1},children:k.NickName||k.Nickname||"-"}),u.jsx("div",{style:{fontWeight:700,fontSize:18,color:"#444",marginTop:4},children:[k.FirstName,k.LastName].filter(Boolean).join(" ")||"-"}),u.jsx("div",{style:{fontStyle:"italic",color:"#666",marginTop:8},children:"Member Since"}),u.jsx("div",{style:{fontWeight:800,fontSize:16},children:mh(k.MemberSince||k["Member Since"]||k.Joined||k["Join Date"])})]})]}),u.jsxs("div",{className:"status-tiles",style:{marginTop:14},children:[u.jsxs("div",{className:`status-tile ${(f==null?void 0:f.membershipState)==null?"none":f.membershipState}`,children:[u.jsx("div",{className:"title",children:"Gym Membership"}),u.jsx("div",{style:{marginBottom:10},children:(f==null?void 0:f.membershipState)==="active"?u.jsx("span",{className:"pill ok",children:"Active"}):(f==null?void 0:f.membershipState)==="expired"?u.jsx("span",{className:"pill bad",children:"Expired"}):u.jsx("span",{className:"pill",children:"None"})}),u.jsx("div",{className:"label",children:"Valid until"}),u.jsx("div",{className:"value",children:mh(f==null?void 0:f.membershipEnd)})]}),u.jsxs("div",{className:`status-tile ${f!=null&&f.coachActive?"active":f!=null&&f.coachEnd?"expired":"none"}`,children:[u.jsx("div",{className:"title",children:"Coach Subscription"}),u.jsx("div",{style:{marginBottom:10},children:f!=null&&f.coachActive?u.jsx("span",{className:"pill ok",children:"Active"}):f!=null&&f.coachEnd?u.jsx("span",{className:"pill bad",children:"Expired"}):u.jsx("span",{className:"pill",children:"None"})}),u.jsx("div",{className:"label",children:"Valid until"}),u.jsx("div",{className:"value",children:mh(f==null?void 0:f.coachEnd)})]})]}),C&&u.jsx("div",{children:f!=null&&f.coachActive?u.jsxs(u.Fragment,{children:[u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:14},children:[u.jsxs("div",{className:"field",children:[u.jsx("label",{className:"label",children:"Coach"}),u.jsxs("select",{value:T,onChange:V=>M(V.target.value),children:[u.jsx("option",{value:"",children:"(Select)"}),E.map(V=>u.jsx("option",{value:V,children:V},V))]})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{className:"label",children:"Workout Focus"}),u.jsxs("select",{value:L,onChange:V=>B(V.target.value),children:[u.jsx("option",{value:"",children:"(none)"}),j.map(V=>u.jsx("option",{value:V,children:V},V))]})]})]}),u.jsxs("div",{className:"field",style:{marginTop:16},children:[u.jsx("label",{className:"label",children:"Workouts Done"}),u.jsx("textarea",{value:_,onChange:V=>P(V.target.value),placeholder:"Describe workouts done (optional)",style:{width:"100%",minHeight:48,borderRadius:8,border:"1px solid #e7e8ef",padding:"8px 12px",fontSize:15,resize:"vertical"}})]})]}):u.jsxs("div",{className:"field",style:{marginTop:16},children:[u.jsx("label",{className:"label",children:"Workouts Done"}),u.jsx("textarea",{value:_,onChange:V=>P(V.target.value),placeholder:"Describe workouts done (optional)",style:{width:"100%",minHeight:48,borderRadius:8,border:"1px solid #e7e8ef",padding:"8px 12px",fontSize:15,resize:"vertical"}})]})}),!C&&u.jsx("div",{children:(f==null?void 0:f.coachActive)&&u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:14},children:[u.jsxs("div",{className:"field",children:[u.jsx("label",{className:"label",children:"Coach"}),u.jsxs("select",{value:T,onChange:V=>M(V.target.value),children:[u.jsx("option",{value:"",children:"(Select)"}),E.map(V=>u.jsx("option",{value:V,children:V},V))]})]}),u.jsxs("div",{className:"field",children:[u.jsx("label",{className:"label",children:"Workout Focus"}),u.jsxs("select",{value:L,onChange:V=>B(V.target.value),children:[u.jsx("option",{value:"",children:"(none)"}),j.map(V=>u.jsx("option",{value:V,children:V},V))]})]})]})}),u.jsxs("div",{className:"field",style:{marginTop:16},children:[u.jsx("label",{className:"label",children:"Comments"}),u.jsx("textarea",{value:y,onChange:V=>w(V.target.value),placeholder:"Add comments (optional)",style:{width:"100%",minHeight:48,borderRadius:8,border:"1px solid #e7e8ef",padding:"8px 12px",fontSize:15,resize:"vertical"}})]}),u.jsx("div",{style:{marginTop:12,color:"#b91c1c",fontSize:13},children:!C&&(f==null?void 0:f.membershipState)!=="active"&&u.jsx("div",{style:{marginBottom:8},children:"Cannot check in: gym membership is not active."})}),u.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:16},children:C?u.jsx("button",{className:"primary-btn",onClick:Q,disabled:R||(f==null?void 0:f.coachActive)&&(!T||!L),children:R?"Checking out":"Confirm Check-Out"}):u.jsx("button",{className:"primary-btn",onClick:I,disabled:R||(f==null?void 0:f.membershipState)!=="active"||(f==null?void 0:f.coachActive)&&(!T||!L),children:R?"Checking in":"Confirm Check-In"})})]}):u.jsx("div",{style:{padding:24},children:"Member not found."})}):null}const{fetchMemberById:Sj,fetchMemberByIdFresh:ph}=tt,Qe=(t,e=[])=>{if(!t)return"";for(const n of e){if(Object.prototype.hasOwnProperty.call(t,n))return t[n];const r=Object.keys(t).find(i=>i.toLowerCase().replace(/\s+/g,"")===n.toLowerCase().replace(/\s+/g,""));if(r)return t[r]}return""};function og({open:t,onClose:e,row:n,onCheckout:r}){Po();const[i,s]=Ue.useState(!1),[o,c]=Ue.useState(null),a=n&&n.raw?n.raw:n||{},d=Qe(a,["MemberID","memberid","member_id","id"]);Ue.useEffect(()=>{let L=!0;return(async()=>{try{if(!d)return;let B=await Sj(d);if(!L)return;if(!B)try{const R=await(ph==null?void 0:ph(d));R&&(B=R)}catch{}if(!B){try{const R=Qe(a,["NickName","nickname","Nick","nick","Nick_Name","Nick Name"])||Qe(n,["NickName","nickname","Nick","nick","Nick_Name","Nick Name"]);if(R){c(String(R).trim());return}const S=Qe(a,["FirstName","firstname","first_name","first"])||Qe(n,["FirstName","firstname","first_name","first"]),E=Qe(a,["LastName","lastname","last_name","last"])||Qe(n,["LastName","lastname","last_name","last"]),j=(S||"").trim()||(E||"").trim()?`${(S||"").trim()} ${(E||"").trim()}`.trim():null;if(j){c(j);return}}catch{}return}const C=B._raw||B,b=Qe(C,["NickName","nickname","Nick","nick","Nick_Name","Nick Name"]);if(b)c(String(b).trim());else{const R=(B.firstname||B.firstName||B.FirstName||"").trim(),S=(B.lastname||B.lastName||B.LastName||"").trim(),E=R||S?`${R} ${S}`.trim():null;if(E&&c(E),!E)try{const j=Qe(a,["NickName","nickname","Nick","nick","Nick_Name","Nick Name"])||Qe(n,["NickName","nickname","Nick","nick","Nick_Name","Nick Name"]);if(j){c(String(j).trim());return}const k=Qe(a,["FirstName","firstname","first_name","first"])||Qe(n,["FirstName","firstname","first_name","first"]),Q=Qe(a,["LastName","lastname","last_name","last"])||Qe(n,["LastName","lastname","last_name","last"]),I=(k||"").trim()||(Q||"").trim()?`${(k||"").trim()} ${(Q||"").trim()}`.trim():null;if(I){c(I);return}}catch{}}}catch{}})(),()=>{L=!1}},[d]);const h=Qe(a,["Date","date","visit_date","timestamp"])||Qe(n,["Date","date","visit_date","timestamp"]),f=Qe(a,["TimeIn","timein","time_in"])||Qe(n,["TimeIn","timein","time_in"]),p=Qe(a,["TimeOut","timeout","time_out"])||Qe(n,["TimeOut","timeout","time_out"]),v=Qe(a,["TotalHours","totalhours","NoOfHours","noofhours","hours"])||Qe(n,["TotalHours","totalhours","NoOfHours","noofhours","hours"]),x=Qe(a,["Coach","coach"])||Qe(n,["Coach","coach"]),_=Qe(a,["Focus","focus"])||Qe(n,["Focus","focus"]),P=Qe(a,["Workouts","workouts","done","workouts_done"])||Qe(n,["Workouts","workouts","done","workouts_done"]),y=Qe(a,["Comments","comments","notes"])||Qe(n,["Comments","comments","notes"]);Qe(a,["Photo","photo","photo_url","PhotoURL"])||Qe(n,["Photo","photo","photo_url","PhotoURL"]);const[w,T]=Ue.useState(!1);if(!t)return null;const M=()=>{if(typeof r=="function")try{r(n,{checkedOut:!0})}catch(L){console.error(L)}};return u.jsxs(u.Fragment,{children:[u.jsxs(xs,{open:t,onClose:e,title:"Visit Details",noInternalScroll:!0,children:[u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:12},children:[u.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[u.jsx("span",{style:{fontSize:14,fontStyle:"italic",color:"var(--muted)",display:"block",marginBottom:4},children:"Nickname"}),u.jsx("div",{style:{fontWeight:700,fontSize:18},children:o||d||"-"})]}),u.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10},children:[u.jsx("span",{style:{fontSize:14,fontStyle:"italic",color:"var(--muted)",display:"block",marginBottom:4},children:"Date"}),u.jsx("div",{style:{fontWeight:700,fontSize:18},children:ai(h)||"-"})]})]}),u.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:12},children:[["Time In",f],["Time Out",p],["Total Hours",v]].map(([L,B])=>u.jsxs("div",{className:"field",children:[u.jsx("span",{className:"label",style:{display:"block",marginBottom:6},children:L}),u.jsx("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:10,fontWeight:700,fontSize:18},children:L==="Time In"||L==="Time Out"?B?cl(B):"-":B?String(B):"-"})]},L))}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:12},children:[u.jsxs("div",{className:"field",children:[u.jsx("span",{className:"label",children:"Coach"}),u.jsx("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:12,fontSize:16,minHeight:44},children:x||"-"})]}),u.jsxs("div",{className:"field",children:[u.jsx("span",{className:"label",children:"Focus"}),u.jsx("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:12,fontSize:16,minHeight:44},children:_||"-"})]})]}),u.jsxs("div",{className:"field",style:{marginTop:12},children:[u.jsx("span",{className:"label",children:"Workouts Done"}),u.jsx("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:12,fontSize:16,minHeight:72},children:P||"-"})]}),u.jsxs("div",{className:"field",style:{marginTop:12},children:[u.jsx("span",{className:"label",children:"Comments"}),u.jsx("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:12,fontSize:16,minHeight:72},children:y||"-"})]}),u.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:[p?null:u.jsx("button",{className:"primary-btn",onClick:()=>{try{if(typeof r=="function"){try{r(a)}catch(L){console.error(L)}e&&e();return}T(!0)}catch(L){console.error(L)}},children:"Check Out"}),u.jsx("button",{className:"primary-btn",onClick:e,children:"Close"})]})]}),w&&u.jsx(fd,{open:w,onClose:()=>{T(!1)},memberId:d,initialEntry:a,onSuccess:()=>{T(!1),e&&e(),M()}})]})}function la(t,e=[]){if(t)for(const n of e){if(Object.prototype.hasOwnProperty.call(t,n))return t[n];const r=Object.keys(t).find(i=>i.toLowerCase().replace(/\s+/g,"")===n.toLowerCase().replace(/\s+/g,""));if(r)return t[r]}}function xu(t){if(!t)return"";if(typeof t=="string")return t;const e=la(t,["NickName","nickname","Nick","nick","Nick_Name","Nick Name","name","Name"]);if(e&&String(e).trim())return String(e).trim();const n=la(t,["FirstName","firstname","first_name","first"])||"",r=la(t,["LastName","lastname","last_name","last"])||"",i=`${String(n).trim()} ${String(r).trim()}`.trim();if(i)return i;const s=la(t,["DisplayName","displayname","display"]);if(s&&String(s).trim())return String(s).trim();const o=la(t,["MemberID","memberid","member_id","id"])||"";return o&&String(o).trim()?String(o).trim():""}const{fetchMembers:Ej,fetchPayments:Tj,fetchGymEntries:bj,fetchProgressTracker:xj,fetchMemberBundle:M_,fetchPricing:O_,fetchMemberByIdFresh:Ij}=tt,Cj=t=>String(t||"").trim().toLowerCase().replace(/\s+/g,"_"),ht=t=>Object.fromEntries(Object.entries(t||{}).map(([e,n])=>[Cj(e),n])),pe=(t,e)=>e.map(n=>t[n]).find(n=>n!==void 0&&n!==""),$t=t=>{if(!t&&t!==0)return null;try{if(t&&typeof t.toDate=="function")return t.toDate()}catch{}if(t&&typeof t.seconds=="number")return new Date(t.seconds*1e3);if(t instanceof Date)return t;const e=new Date(t);return isNaN(e)?null:e},Ji="Asia/Manila",cl=t=>{if(!t)return"-";if(/^\d{1,2}:\d{2}\s?(AM|PM)$/i.test(t))return t;const e=new Date(t);if(!isNaN(e))return new Intl.DateTimeFormat("en-US",{timeZone:Ji,hour:"2-digit",minute:"2-digit",hour12:!0}).format(e);const n=String(t).match(/(\d{2}):(\d{2})/);if(n){let r=parseInt(n[1],10),i=n[2],s=r>=12?"PM":"AM";return r=r%12||12,`${r}:${i} ${s}`}return"-"},ai=t=>{var o,c,a;if(!t)return"-";const e=t instanceof Date?t:new Date(t);if(isNaN(e))return"-";const n=new Intl.DateTimeFormat("en-US",{timeZone:Ji,month:"short",day:"numeric",year:"numeric"}).formatToParts(e),r=((o=n.find(d=>d.type==="month"))==null?void 0:o.value)||"",i=((c=n.find(d=>d.type==="day"))==null?void 0:c.value)||"",s=((a=n.find(d=>d.type==="year"))==null?void 0:a.value)||"";return`${r}-${i}, ${s}`},Dt=t=>t==null||String(t).trim()===""?"-":String(t),Aj=t=>{const e=String(t||"");if(!e)return"";const n=e.match(/https?:\/\/[^\s}]+/);if(n){const s=n[0];if(/googleusercontent\.com\//.test(s))return s;const o=s.match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return o&&o[1]?`https://drive.google.com/uc?export=view&id=${o[1]}`:s}if(/googleusercontent\.com\//.test(e))return e;const r=e.match(/\/file\/d\/([^/]+)/)||e.match(/[?&]id=([^&]+)/)||e.match(/\/uc\?[^#]*id=([^&]+)/),i=r?r[1]:"";return i?`https://drive.google.com/uc?export=view&id=${i}`:e},Nj=t=>{const n=String(t||"").match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return n&&n[1]?n[1]:""},kj=t=>{const e=String(t||"");if(/googleusercontent\.com\//.test(e))return e;const n=Nj(e);return n?`https://drive.google.com/thumbnail?id=${n}&sz=w1000`:e};function Pj(){var Lo;const[t,e]=N.useState(null),{id:n,memberId:r}=mC(),i=Po(),s=Ss(),o=Ue.useMemo(()=>{var ne;return(ne=s.state)!=null&&ne.row?ht(s.state.row):null},[(Lo=s.state)==null?void 0:Lo.row]),[c,a]=N.useState(o||null),[d,h]=N.useState(!o),[f,p]=N.useState(!1),[v,x]=N.useState(""),[_,P]=N.useState({membershipState:null,coachActive:!1,membershipEnd:null,coachEnd:null}),[y,w]=N.useState([]),[T,M]=N.useState([]),[L,B]=N.useState([]),[C,b]=N.useState([]),{membershipState:R,coachActive:S}=_,E=pe(c,["student"]),j=typeof E=="string"?E.trim().toLowerCase().startsWith("y"):!!E,k=pe(c,["lastname","last_name"]),Q=pe(c,["firstname","first_name"]);pe(c,["middlename","middle_name"]),pe(c,["gender"]);const I=pe(c,["birthday","birth_date","dob"]),V=$t(I),q=pe(c,["nick_name","nickname"]);pe(c,["street"]),pe(c,["brgy","barangay"]),pe(c,["municipality","city"]),pe(c,["email"]),pe(c,["mobile","phone"]);const A=$t(pe(c,["member_since","membersince","join_date"])),F=String(pe(c,["memberid","member_id","member_id_","id"])||"").trim(),O=pe(c,["photourl","photo_url","photo"]),z=Aj(O),$=kj(z),[G,J]=N.useState(!1),[ae,de]=N.useState(!1),[ie,_e]=N.useState(!1),[Te,ge]=N.useState(!1),[Pe,xe]=N.useState(!1),[U,Z]=N.useState(null),[H,te]=N.useState(!1),[X,re]=N.useState(!1),[oe,ue]=N.useState(null),[be,De]=N.useState(-1),[et,nn]=N.useState(!1),[st,Qt]=N.useState(10),[me,Fe]=N.useState(10),[ot,Pt]=N.useState(10);N.useEffect(()=>{nn(!1)},[z]);const Kn=ne=>{try{const Ce=ht(ne||{}),Ee=[Ce.timeout,Ce.time_out,Ce.timeOut,Ce.timeout,Ce.time_out_];for(const ye of Ee)if(ye&&String(ye).trim()!==""&&($t(ye)||/\d/.test(String(ye))))return!1;const Xe=String((ne==null?void 0:ne.TimeOut)||(ne==null?void 0:ne.Time_Out)||(ne==null?void 0:ne.TimeOUT)||(ne==null?void 0:ne.Timeout)||"").trim();if(Xe){try{if($t(Xe))return!1}catch{}if(/\d/.test(Xe))return!1}return!0}catch{return!0}},Nn=Ue.useRef(null),rn=()=>{Nn.current&&clearTimeout(Nn.current),Nn.current=setTimeout(()=>{fn(),Nn.current=null},200)};if(N.useEffect(()=>{let ne=!0;(async()=>{const ye=decodeURIComponent(r||n||"").trim(),Be=String(pe(o||{},["memberid","member_id","id"])||"").trim(),Oe=ye||Be;if(!Oe){h(!1);return}if(o){a(o),h(!1);try{rn(),typeof window<"u"&&setTimeout(()=>{try{rn()}catch{}},600)}catch{}return}async function mt(){const[we,ze]=await Promise.all([M_(Oe,{ttlMs:0}),O_()]),Ge=we.member?ht(we.member):null,nt=(we.payments||[]).map(ht),sr=(we.gymEntries||[]).map(_n=>_n),Ir=sr.map(ht),Cr=(we.progress||[]).map(ht);M(sr);const Cs=((ze==null?void 0:ze.rows)||(ze==null?void 0:ze.data)||[]).map(_n=>_n);return{m:Ge,pays:nt,gyms:Ir,progs:Cr,pricingRows:Cs}}async function Kt(){const[we,ze,Ge,nt]=await Promise.all([Ej(),Tj(),bj(),xj()]),Ir=((we==null?void 0:we.rows)??(we==null?void 0:we.data)??[]).map(ht).find(or=>String(pe(or,["memberid","member_id","member_id_","id"])||"").trim().toLowerCase()===Oe.toLowerCase())||null,Cr=((ze==null?void 0:ze.rows)??(ze==null?void 0:ze.data)??[]).filter(or=>String(pe(ht(or),["memberid","member_id","member_id_","id"])||"").trim().toLowerCase()===Oe.toLowerCase()),Cs=((Ge==null?void 0:Ge.rows)??(Ge==null?void 0:Ge.data)??[]).filter(or=>String(pe(ht(or),["memberid","member_id","member_id_","id"])||"").trim().toLowerCase()===Oe.toLowerCase()),_n=Cs.map(ht);M(Cs);const Al=((nt==null?void 0:nt.rows)??(nt==null?void 0:nt.data)??[]).filter(or=>String(pe(ht(or),["memberid","member_id","member_id_","id"])||"").trim().toLowerCase()===Oe.toLowerCase());return{m:Ir,pays:Cr,gyms:_n,progs:Al}}try{let we;try{we=await mt()}catch{we=await Kt()}if(!ne)return;if(we.m){a(we.m);const ze=String(pe(we.m,["memberid","member_id","id"])||"").trim();B((we.pays||[]).map(ht).sort((Ge,nt)=>{const sr=$t(pe(Ge,["date","paid_on","created","timestamp"]))||new Date(0);return($t(pe(nt,["date","paid_on","created","timestamp"]))||new Date(0))-sr})),w(we.gyms.map(Ge=>{const nt=ht(Ge);return{date:$t(pe(nt,["date"])),timeIn:pe(nt,["timein","time_in"]),timeOut:pe(nt,["timeout","time_out"]),totalHours:pe(nt,["totalhours","total_hours","hours"]),coach:pe(nt,["coach"]),focus:pe(nt,["focus"]),raw:Ge,memberId:String(pe(nt,["memberid","member_id","MemberID","id"])||"").trim()}}).filter(Ge=>!!Ge.date).sort((Ge,nt)=>nt.date-Ge.date)),b(we.progs.map(ht).sort((Ge,nt)=>{const sr=$t(pe(Ge,["date","recorded","log_date","timestamp"]))||new Date(0);return($t(pe(nt,["date","recorded","log_date","timestamp"]))||new Date(0))-sr})),P(Oi((we.pays||[]).map(ht),we.m,we.pricingRows||[]))}else o||(a(null),x("Member not found"))}catch(we){ne&&!o&&x(we.message||"Failed to load member")}finally{ne&&h(!1)}})();const Ce=qt.on("member:updated",ye=>{try{const Be=ye&&ye.request?ye.request:ye,Oe=String(pe(Be||{},["MemberID","memberid","member_id","id"])||"").trim(),mt=decodeURIComponent(r||n||"").trim(),Kt=String(pe(o||{},["memberid","member_id","id"])||"").trim(),we=mt||Kt;Oe&&we&&Oe.toLowerCase()===we.toLowerCase()&&setTimeout(()=>rn(),120)}catch{}}),Ee=qt.on("gymEntry:added",ye=>{try{const Be=String(pe(c||{},["memberid","member_id","id"])||"").trim();if(!Be)return;const Oe=String((ye==null?void 0:ye.MemberID)||(ye==null?void 0:ye.memberid)||(ye==null?void 0:ye.Member)||"").trim();Oe&&Oe===Be&&rn()}catch{}}),Xe=qt.on("payment:added",ye=>{try{const Be=String(pe(c||{},["memberid","member_id","id"])||"").trim();if(!Be)return;const Oe=ye&&ye.request?ye.request:ye,mt=ye&&ye.response?ye.response:null,Kt=String((Oe==null?void 0:Oe.MemberID)||(Oe==null?void 0:Oe.memberid)||(mt==null?void 0:mt.MemberID)||(mt==null?void 0:mt.memberid)||(Oe==null?void 0:Oe.Member)||(mt==null?void 0:mt.Member)||"").trim();Kt&&Kt===Be&&setTimeout(()=>rn(),120)}catch(Be){console.debug("payment event handler error",Be)}});return()=>{ne=!1;try{Ce()}catch{}try{Ee()}catch{}try{Xe()}catch{}try{Nn.current&&(clearTimeout(Nn.current),Nn.current=null)}catch{}}},[r,n,o]),d)return u.jsx("div",{className:"content",children:u.jsx(OT,{})});if(!c)return u.jsxs("div",{className:"content",children:[u.jsx("button",{className:"back-btn",onClick:()=>i(-1),children:" Back"}),u.jsx("div",{children:v||"Member not found"})]});async function fn(){p(!0);try{const ne=String(F||"").trim();if(!ne)return;console.debug("refreshBundle: fetching bundle for",ne);const[Ce,Ee]=await Promise.all([M_(ne,{ttlMs:0}),O_()]);console.debug("refreshBundle: fetched bundle",Ce,Ee);const Xe=Ce.member?ht(Ce.member):null,ye=(Ce.payments||[]).map(ht),Be=(Ce.gymEntries||[]).map(we=>we),Oe=Be.map(ht),mt=(Ce.progress||[]).map(ht);Xe&&a(Xe),M(Be),B(ye.sort((we,ze)=>{const Ge=$t(pe(we,["date","paid_on","created","timestamp"]))||new Date(0);return($t(pe(ze,["date","paid_on","created","timestamp"]))||new Date(0))-Ge})),w(Oe.map(we=>{const ze=ht(we);return{date:$t(pe(ze,["date"])),timeIn:pe(ze,["timein","time_in"]),timeOut:pe(ze,["timeout","time_out"]),totalHours:pe(ze,["totalhours","total_hours","hours"]),coach:pe(ze,["coach"]),focus:pe(ze,["focus"]),raw:we,memberId:String(pe(ze,["memberid","member_id","MemberID","id"])||"").trim()}}).filter(we=>!!we.date).sort((we,ze)=>ze.date-we.date)),b(mt.sort((we,ze)=>{const Ge=$t(pe(we,["date","recorded","log_date","timestamp"]))||new Date(0);return($t(pe(ze,["date","recorded","log_date","timestamp"]))||new Date(0))-Ge}));const Kt=((Ee==null?void 0:Ee.rows)||(Ee==null?void 0:Ee.data)||[]).map(we=>we);P(Oi(ye,ne,Kt))}catch(ne){console.error("refreshBundle failed",ne);try{x(String((ne==null?void 0:ne.message)||ne||"Failed to refresh member data"))}catch{}}finally{p(!1)}}const Is=new Intl.DateTimeFormat("en-CA",{timeZone:Ji,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date),xr=(y||[]).find(ne=>{try{const Ce=ne==null?void 0:ne.date;if(!Ce)return!1;const Ee=new Date(Ce);return new Intl.DateTimeFormat("en-CA",{timeZone:Ji,year:"numeric",month:"2-digit",day:"2-digit"}).format(Ee)!==Is?!1:Kn(ne)}catch{return!1}}),Vo=(T||[]).find(ne=>{try{const Ce=ht(ne||{}),Ee=pe(Ce,["date","Date","log_date","date_time"]);if(!Ee)return!1;const Xe=new Date(Ee);return new Intl.DateTimeFormat("en-CA",{timeZone:Ji,year:"numeric",month:"2-digit",day:"2-digit"}).format(Xe)!==Is?!1:Kn(ne)}catch{return!1}})||null,kn=!!xr||!!Vo;return u.jsxs("div",{className:"content",children:[u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[u.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[u.jsx("button",{className:"back-btn",onClick:()=>i(-1),children:" Back"}),u.jsxs("div",{style:{display:"flex",gap:8},children:[u.jsx("button",{className:"back-btn",onClick:()=>{ue("in"),re(!0)},disabled:!(!kn&&R==="active"),title:kn?"Member already has an open visit for today":R==="active"?"Check in":"Gym membership is not active",style:{opacity:!kn&&R==="active"?1:.5,cursor:!kn&&R==="active"?"pointer":"not-allowed"},children:"Check In"}),u.jsx("button",{className:"back-btn",onClick:()=>{ue("out"),re(!0)},disabled:!kn,title:kn?"Member has an open visit today  checkout":"No open visit to check out",style:{opacity:kn?1:.5,cursor:kn?"pointer":"not-allowed"},children:"Check Out"})]})]})}),u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginTop:8,marginBottom:8},children:[u.jsx("h2",{style:{margin:0},children:Dt(xu(c)||q||Q||"Member")}),u.jsx("div",{children:u.jsx(hd,{show:f&&!d})})]})]}),u.jsx(dj,{member:c,status:_,isRefreshing:f,onEdit:()=>de(!0),onAddPayment:()=>J(!0),onShowQr:()=>_e(!0),onShowProgress:()=>ge(!0),onCheckIn:()=>{ue("in"),re(!0)}}),u.jsx(PD,{open:G,onClose:()=>J(!1),memberId:F,onSaved:()=>{J(!1),fn()},membershipEnd:_.membershipEnd,coachEnd:_.coachEnd,isStudent:j,birthDate:V}),u.jsx(BD,{open:ae,onClose:()=>de(!1),member:c,onSaved:ne=>{de(!1);try{if(ne){const Ce=ht(ne)||{},Ee=Object.fromEntries(Object.entries(Ce).filter(([Xe,ye])=>ye!=null&&String(ye).trim()!==""));Object.keys(Ee).length&&a(Xe=>({...Xe||{},...Ee}))}}catch(Ce){console.debug("onSaved merge error",Ce)}(async()=>{try{const Ce=String(pe(ne||c||{},["memberid","member_id","id","MemberID"])||"").trim();if(Ce)try{const Ee=await Ij(Ce);if(Ee)try{const Xe=ht(Ee)||{},ye=Object.fromEntries(Object.entries(Xe).filter(([Be,Oe])=>Oe!=null&&String(Oe).trim()!==""));if(Object.keys(ye).length)a(Be=>({...Be||{},...ye}));else try{fn()}catch{}}catch{try{fn()}catch{}}}catch{try{fn()}catch{}}else try{fn()}catch{}}catch{try{fn()}catch{}}})()}}),u.jsx(XD,{open:ie,onClose:()=>_e(!1),memberId:F,nickname:q||Q||"",firstName:Q||"",lastName:k||"",memberSince:A||null,photo:$}),u.jsx(rj,{open:Te,onClose:()=>ge(!1),memberId:F,memberNick:q||Q||"",memberSinceYMD:A?`${A.getFullYear()}-${String(A.getMonth()+1).padStart(2,"0")}-${String(A.getDate()).padStart(2,"0")}`:"",onSaved:()=>{ge(!1),fn()}}),u.jsx(oj,{open:Pe,onClose:()=>{xe(!1),De(-1)},row:be>=0?C[be]:null,memberNick:q||Q||""}),u.jsxs("div",{className:"panel",children:[u.jsx("div",{className:"panel-header",children:"Gym Visits"}),u.jsxs("table",{className:"aligned",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Date"}),u.jsx("th",{children:"Time In"}),u.jsx("th",{children:"Time Out"}),u.jsx("th",{children:"Total Hours"}),u.jsx("th",{children:"Coach"}),u.jsx("th",{children:"Focus"})]})}),u.jsx("tbody",{children:y.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:6,children:"-"})}):y.slice(0,st).map((ne,Ce)=>u.jsxs("tr",{style:{cursor:"pointer"},onClick:()=>e(ne),children:[u.jsx("td",{children:ai(ne.date)}),u.jsx("td",{children:cl(ne.timeIn)}),u.jsx("td",{children:cl(ne.timeOut)}),u.jsx("td",{children:Dt(ne.totalHours)}),u.jsx("td",{children:Dt(ne.coach)}),u.jsx("td",{children:Dt(ne.focus)})]},Ce))})]}),y.length>st&&u.jsx("div",{style:{textAlign:"center",marginTop:8},children:u.jsx("button",{className:"button",onClick:()=>Qt(ne=>ne<y.length?Math.min(ne+10,y.length):10),children:st<y.length?`Load ${Math.min(10,y.length-st)} more`:"Show less"})})]}),t&&u.jsx(og,{open:!!t,onClose:()=>e(null),row:t,onCheckout:ne=>{try{const Ce=(T||[]).find(Ee=>{try{const Xe=ht(Ee||{}),ye=pe(Xe,["date","Date","log_date","date_time"]),Be=pe(Xe,["timein","TimeIn","time_in"]);if(!ye)return!1;const Oe=new Date(ye),mt=new Date((ne==null?void 0:ne.date)||(ne==null?void 0:ne.Date)||(ne==null?void 0:ne.date_time)||""),Kt=new Intl.DateTimeFormat("en-CA",{timeZone:Ji,year:"numeric",month:"2-digit",day:"2-digit"}).format(Oe),we=new Intl.DateTimeFormat("en-CA",{timeZone:Ji,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date(mt));if(Kt!==we)return!1;if(Be&&(ne!=null&&ne.timeIn||ne!=null&&ne.TimeIn)){const ze=String(Be).trim(),Ge=String(ne.timeIn||ne.TimeIn||ne.timein||"").trim();if(ze&&Ge&&ze.indexOf(Ge)===-1&&Ge.indexOf(ze)===-1)return!1}return!0}catch{return!1}})||null;Z(Ce)}catch{Z(null)}ue("out"),re(!0)}}),u.jsx(fd,{open:!!X,memberId:F,initialEntry:oe==="out"?U||Vo:null,mode:oe,onClose:()=>{re(!1),ue(null),Z(null)},status:_,onSuccess:async()=>{re(!1),ue(null),Z(null);try{await rn()}catch{}}}),y.length>200&&u.jsx("div",{style:{textAlign:"center",marginTop:8},children:u.jsx("button",{className:"button",onClick:()=>te(ne=>!ne),children:H?"Show less":`Show all (${y.length})`})}),u.jsxs("div",{className:"panel",children:[u.jsx("div",{className:"panel-header",children:"Progress"}),u.jsxs("table",{className:"aligned",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Date"}),u.jsx("th",{children:"No"}),u.jsx("th",{children:"Weight"}),u.jsx("th",{children:"BMI"}),u.jsx("th",{children:"Muscle Mass"}),u.jsx("th",{children:"Body Fat"})]})}),u.jsx("tbody",{children:C.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:6,children:"-"})}):C.slice(0,me).map((ne,Ce)=>{const Ee=$t(pe(ne,["date","recorded","log_date","timestamp"])),Xe=pe(ne,["no","entry_no","seq","number"]),ye=pe(ne,["weight","weight_kg","weight_lbs","weight_(lbs)","weight_(kg)","weight(lbs)","weightkg","weightlbs"]),Be=pe(ne,["bmi"]),Oe=pe(ne,["musclemass","muscle_mass","muscle"]),mt=pe(ne,["bodyfat","body_fat","bf"]);return u.jsxs("tr",{style:{cursor:"pointer"},onClick:()=>{De(Ce),xe(!0)},children:[u.jsx("td",{children:ai(Ee)}),u.jsx("td",{children:Dt(Xe)}),u.jsx("td",{children:Dt(ye)}),u.jsx("td",{children:Dt(Be)}),u.jsx("td",{children:Dt(Oe)}),u.jsx("td",{children:Dt(mt)})]},Ce)})})]}),C.length>me&&u.jsx("div",{style:{textAlign:"center",marginTop:8},children:u.jsx("button",{className:"button",onClick:()=>Fe(ne=>ne<C.length?Math.min(ne+10,C.length):10),children:me<C.length?`Load ${Math.min(10,C.length-me)} more`:"Show less"})})]}),u.jsxs("div",{className:"panel",children:[u.jsx("div",{className:"panel-header",children:"Payments"}),u.jsxs("table",{className:"aligned payments-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Date"}),u.jsx("th",{children:"Particulars"}),u.jsxs("th",{children:["Gym Membership",u.jsx("br",{}),u.jsx("span",{className:"th-sub",children:"Valid Until"})]}),u.jsxs("th",{children:["Coach Subscription",u.jsx("br",{}),u.jsx("span",{className:"th-sub",children:"Valid Until"})]}),u.jsx("th",{children:"Mode"}),u.jsx("th",{children:"Cost"})]})}),u.jsx("tbody",{children:L.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:6,children:"-"})}):L.slice(0,ot).map((ne,Ce)=>{const Ee=$t(pe(ne,["date","paid_on","created","timestamp"])),Xe=pe(ne,["particulars","type","item","category","product","paymentfor","plan","description"]),ye=$t(pe(ne,["gymvaliduntil","gym_valid_until","gym_until"])),Be=$t(pe(ne,["coachvaliduntil","coach_valid_until","coach_until"])),Oe=pe(ne,["mode","payment_mode","method","via"]),mt=pe(ne,["cost","amount","price","total","paid"]);return u.jsxs("tr",{children:[u.jsx("td",{children:ai(Ee)}),u.jsx("td",{children:Dt(Xe)}),u.jsx("td",{children:ai(ye)}),u.jsx("td",{children:ai(Be)}),u.jsx("td",{children:Dt(Oe)}),u.jsx("td",{children:Dt(mt)})]},Ce)})})]}),L.length>ot&&u.jsx("div",{style:{textAlign:"center",marginTop:8},children:u.jsx("button",{className:"button",onClick:()=>Pt(ne=>ne<L.length?Math.min(ne+10,L.length):10),children:ot<L.length?`Load ${Math.min(10,L.length-ot)} more`:"Show less"})})]})]})}const Rj=t=>String(t||"").trim().toLowerCase().replace(/\s+/g,"_"),Dj=t=>Object.fromEntries(Object.entries(t||{}).map(([e,n])=>[Rj(e),n])),jj=(t,e)=>{try{const n=t||{};for(const r of e){if(Object.prototype.hasOwnProperty.call(n,r))return n[r];const i=Object.keys(n).find(s=>s.toLowerCase().replace(/\s+/g,"")===r.toLowerCase().replace(/\s+/g,""));if(i)return n[i]}}catch{}},V_=t=>{if(!t&&t!==0)return null;try{if(t&&typeof t.toDate=="function")return t.toDate()}catch{}if(t&&typeof t.seconds=="number")return new Date(t.seconds*1e3);if(t instanceof Date)return t;const e=new Date(t);return isNaN(e)?null:e},L_=t=>{try{const e=Dj(t||{}),n=[e.timeout,e.time_out,e.timeOut,e.time_out_];for(const i of n)if(i&&String(i).trim()!==""&&(V_(i)||/\d/.test(String(i))))return!1;const r=String((t==null?void 0:t.TimeOut)||(t==null?void 0:t.Time_Out)||(t==null?void 0:t.TimeOUT)||(t==null?void 0:t.Timeout)||"").trim();if(r){try{if(V_(r))return!1}catch{}if(/\d/.test(r))return!1}return!0}catch{return!0}},{fetchMembers:gh,fetchPayments:F_,fetchGymEntries:U_,fetchGymEntriesFresh:yh,fetchPricing:B_,fetchDashboard:Mj}=tt;function dc(){return new Date().toLocaleDateString("en-CA",{year:"numeric",month:"2-digit",day:"2-digit"})}const Rn=(t,e)=>jj(t,e);function Oj(){const[t,e]=N.useState({totalMembers:0,activeGym:0,activeCoach:0,visitedToday:0,coachToday:0,checkedIn:0,cashToday:0,gcashToday:0}),[n,r]=N.useState(!0),[i,s]=N.useState(!1),[o,c]=N.useState([]),[a,d]=N.useState([]),[h,f]=N.useState([]),[p,v]=N.useState([]),[x,_]=N.useState(!1),[P,y]=N.useState(!1),[w,T]=N.useState(null),[M,L]=N.useState(!1),[B,C]=N.useState(null),[b,R]=N.useState(null),S=N.useMemo(()=>{const Q=(h||[]).filter(I=>{const V=I.Date||I.date;return(V?new Date(V).toLocaleDateString("en-CA",{year:"numeric",month:"2-digit",day:"2-digit"}):"")===dc()});return Q.sort((I,V)=>{const q=String(Rn(I,["TimeOut","timeout","time_out"])||"").trim(),A=String(Rn(V,["TimeOut","timeout","time_out"])||"").trim(),F=q===""||q==="-"||q==="",O=A===""||A==="-"||A==="";if(F&&!O)return-1;if(!F&&O)return 1;const z=String(Rn(I,["TimeIn","timein","time_in"])||"").trim(),$=String(Rn(V,["TimeIn","timein","time_in"])||"").trim();return String($).localeCompare(String(z))}),Q.map((I,V)=>{const q=String(Rn(I,["MemberID","memberid","member_id","member","id"])||"").trim(),A=(o||[]).find(G=>String(Rn(G,["MemberID","memberid","member_id","id"])||"").trim()===q),F=Rn(I,["TimeIn","timein","time_in"])||"",O=Rn(I,["TimeOut","timeout","time_out"])||"",z=String(O).trim()===""||String(O).trim()==="-"||String(O).trim()==="",$=Rn(I,["TotalHours","totalhours","NoOfHours","noofhours","hours"])||"";return u.jsxs("tr",{style:{cursor:"pointer"},onClick:()=>T(I),children:[u.jsx("td",{className:"td-fullname",style:{textAlign:"left"},children:u.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:8},children:[u.jsx("span",{children:xu(A)}),z&&u.jsx("span",{className:"status-badge on",children:"On"})]})}),u.jsx("td",{children:cl(F)}),u.jsx("td",{children:cl(O)}),u.jsx("td",{children:Dt($)}),u.jsx("td",{children:Dt(I.Coach||I.coach)}),u.jsx("td",{children:Dt(I.Focus||I.focus)})]},V)})},[h,o]),E=(Q,I,V,q)=>{const A=new Map,F=H=>{const te=String(H??"").trim().toLowerCase();return te==="yes"||te==="y"||te==="true"||te==="1"},O=(H,te)=>{for(const X of te){if(H&&Object.prototype.hasOwnProperty.call(H,X))return H[X];const re=Object.keys(H||{}).find(oe=>oe.toLowerCase().replace(/\s+/g,"")===X.toLowerCase().replace(/\s+/g,""));if(re)return H[re]}};(q||[]).forEach(H=>{const te=String(O(H,["Particulars"])||"").trim();if(!te)return;const X=F(O(H,["Gym membership","Gym Membership","GymMembership","Membership"])),re=F(O(H,["Coach subscription","Coach Subscription","CoachSubscription","Coach"]));A.set(te.toLowerCase(),{gym:X,coach:re})});const z=new Map;(I||[]).forEach(H=>{const te=String(H.MemberID||H.member_id||H.id||H.member||"").trim();te&&(z.has(te)||z.set(te,[]),z.get(te).push(H))});let $=0,G=0;for(const H of Q||[]){const te=String(H.MemberID||H.member_id||H.id||"").trim(),X=z.get(te)||[],re=Oi(X,H,q);if(re.membershipState!=="active")if((H.membershipState||H.membership_state||H.status||"").toLowerCase()==="active")re.membershipState="active";else{const ue=O(H,["membershipEnd","membership_end","gymvaliduntil","gym_valid_until","gym_until","enddate","end_date","valid_until","expiry","expires","until","end","gym_valid","gym_validity","gymvalid"]);if(ue){const be=new Date(ue);if(!isNaN(be)){be.setHours(0,0,0,0);const De=new Date;De.setHours(0,0,0,0),be>=De&&(re.membershipState="active")}}}re.membershipState==="active"&&$++,re.coachActive&&G++}const J=dc(),ae=(V||[]).filter(H=>{const te=H.Date||H.date;return te?new Date(te).toLocaleDateString("en-CA",{year:"numeric",month:"2-digit",day:"2-digit"})===J:!1}),ie=new Set(ae.map(H=>String(H.MemberID||H.member_id||H.id||"").trim()).filter(Boolean)).size,_e=new Set;for(const H of ae){const te=String(H.Coach||H.coach||"").trim(),X=String(H.MemberID||H.member_id||H.id||"").trim();te&&X&&_e.add(`${X}::${te.toLowerCase()}`)}const Te=_e.size,ge=new Set;for(const H of ae){const te=String(Rn(H,["TimeIn","timein","time_in"])||"").trim(),X=String(Rn(H,["MemberID","memberid","member_id","id"])||"").trim(),re=!L_(H);te&&!re&&X&&ge.add(X)}const Pe=ge.size;let xe=0,U=0,Z=0;for(const H of I||[]){const te=H.Date||H.date||H.pay_date;if(!te||new Date(te).toLocaleDateString("en-CA",{year:"numeric",month:"2-digit",day:"2-digit"})!==J)continue;const re=parseFloat(H.Cost||H.amount||0)||0;Z+=re;const oe=String(H.Mode||H.mode||H.method||"").toLowerCase();oe==="cash"&&(xe+=re),oe==="gcash"&&(U+=re)}return{totalMembers:(Q||[]).length,activeGym:$,activeCoach:G,visitedToday:ie,coachToday:Te,checkedIn:Pe,cashToday:xe,gcashToday:U,totalPaymentsToday:Z}},j=N.useMemo(()=>{const Q=dc(),I=A=>A.Date||A.date||A.pay_date||A.created||A.timestamp||null,V=A=>{if(!A&&A!==0)return 0;if(typeof A=="number")return A;try{if(A&&typeof A.seconds=="number")return A.seconds*1e3}catch{}const F=Date.parse(String(A));return isNaN(F)?0:F};return(a||[]).filter(A=>{const F=I(A);return(F?new Date(F).toLocaleDateString("en-CA",{year:"numeric",month:"2-digit",day:"2-digit"}):"")===Q}).sort((A,F)=>{const O=V(I(A));return(V(I(F))||0)-(O||0)}).map((A,F)=>{const O=(o||[]).find(ae=>{const de=String(A.MemberID||A.member_id||A.id||A.member||"").trim();return de?String(ae.MemberID||ae.member_id||ae.id||"").trim()===de:!1}),z=A.gymvaliduntil||A.GymValidUntil||A.gym_valid_until||A.gym_until||A.EndDate||A.Enddate||A.enddate||A.end_date||A.end||A.valid_until||A.expiry||A.expires||A.until||"",$=A.coachvaliduntil||A.CoachValidUntil||A.coach_valid_until||A.coach_until||"",G=ai(z),J=ai($);return u.jsxs("tr",{children:[u.jsx("td",{children:xu(O)}),u.jsx("td",{children:Dt(A.Particulars||A.particulars||A.type||A.item||A.category||A.product||A.paymentfor||A.plan||A.description)}),u.jsx("td",{children:Dt(G)}),u.jsx("td",{children:Dt(J)}),u.jsx("td",{children:Dt(A.Mode||A.mode||A.method)}),u.jsx("td",{children:Dt((parseFloat(A.Cost||A.amount||0)||0).toLocaleString())})]},F)})},[a,o]);N.useEffect(()=>{async function Q(){r(!0);try{const ge=await Mj();if(ge&&ge.ok){const{totalMembers:Pe=0,activeGym:xe=0,activeCoach:U=0,visitedToday:Z=0,coachToday:H=0,checkedIn:te=0,cashToday:X=0,gcashToday:re=0,totalPaymentsToday:oe=0}=ge;e({totalMembers:Pe,activeGym:xe,activeCoach:U,visitedToday:Z,coachToday:H,checkedIn:te,cashToday:X,gcashToday:re,totalPaymentsToday:oe}),r(!1),(async()=>{s(!0);try{const[ue,be,De,et]=await Promise.all([gh(),F_(),U_(),B_()]);c((ue==null?void 0:ue.rows)||(ue==null?void 0:ue.data)||[]),d((be==null?void 0:be.rows)||(be==null?void 0:be.data)||[]),f((De==null?void 0:De.rows)||(De==null?void 0:De.data)||[]),v((et==null?void 0:et.rows)||(et==null?void 0:et.data)||[]);try{const nn=E((ue==null?void 0:ue.rows)||(ue==null?void 0:ue.data)||[],(be==null?void 0:be.rows)||(be==null?void 0:be.data)||[],(De==null?void 0:De.rows)||(De==null?void 0:De.data)||[],(et==null?void 0:et.rows)||(et==null?void 0:et.data)||[]);e(nn)}catch(nn){console.warn("Failed to recompute stats after background fetch",nn)}}catch{}finally{s(!1)}})();return}}catch{}s(!0);const[A,F,O,z]=await Promise.all([gh(),F_(),U_(),B_()]),$=(A==null?void 0:A.rows)||(A==null?void 0:A.data)||[],G=(F==null?void 0:F.rows)||(F==null?void 0:F.data)||[],J=(O==null?void 0:O.rows)||(O==null?void 0:O.data)||[],ae=(z==null?void 0:z.rows)||(z==null?void 0:z.data)||[];c($),d(G),f(J),v(ae),s(!1);const de=$,ie=G,_e=J,Te=ae;e(ge=>({...ge,totalMembers:de.length})),setTimeout(()=>{const ge=new Map,Pe=me=>{const Fe=String(me??"").trim().toLowerCase();return Fe==="yes"||Fe==="y"||Fe==="true"||Fe==="1"},xe=(me,Fe)=>{for(const ot of Fe){if(me&&Object.prototype.hasOwnProperty.call(me,ot))return me[ot];const Pt=Object.keys(me||{}).find(Kn=>Kn.toLowerCase().replace(/\s+/g,"")===ot.toLowerCase().replace(/\s+/g,""));if(Pt)return me[Pt]}};Te.forEach(me=>{const Fe=String(xe(me,["Particulars"])||"").trim();if(!Fe)return;const ot=Pe(xe(me,["Gym membership","Gym Membership","GymMembership","Membership"])),Pt=Pe(xe(me,["Coach subscription","Coach Subscription","CoachSubscription","Coach"]));ge.set(Fe.toLowerCase(),{gym:ot,coach:Pt})});const U=new Map;ie.forEach(me=>{const Fe=String(me.MemberID||me.member_id||me.id||me.member||"").trim();Fe&&(U.has(Fe)||U.set(Fe,[]),U.get(Fe).push(me))});let Z=0,H=0;for(const me of de){const Fe=String(me.MemberID||me.member_id||me.id||"").trim(),ot=U.get(Fe)||[],Pt=Oi(ot,me,Te);if(Pt.membershipState!=="active")if((me.membershipState||me.membership_state||me.status||"").toLowerCase()==="active")Pt.membershipState="active";else{const Nn=xe(me,["membershipEnd","membership_end","gymvaliduntil","gym_valid_until","gym_until","enddate","end_date","valid_until","expiry","expires","until","end","gym_valid","gym_validity","gymvalid"]);if(Nn){const rn=new Date(Nn);if(!isNaN(rn)){rn.setHours(0,0,0,0);const fn=new Date;fn.setHours(0,0,0,0),rn>=fn&&(Pt.membershipState="active")}}}Pt.membershipState==="active"&&Z++,Pt.coachActive&&H++}const te=dc(),X=[];for(const me of _e){const Fe=me.Date||me.date;if(!Fe)continue;new Date(Fe).toLocaleDateString("en-CA",{year:"numeric",month:"2-digit",day:"2-digit"})===te&&X.push(me)}const oe=new Set(X.map(me=>String(me.MemberID||me.member_id||me.id||"").trim()).filter(Boolean)).size,ue=new Set;for(const me of X){const Fe=String(me.Coach||me.coach||"").trim(),ot=String(me.MemberID||me.member_id||me.id||"").trim();Fe&&ot&&ue.add(`${ot}::${Fe.toLowerCase()}`)}const be=ue.size,De=new Set;for(const me of X){const Fe=String(Rn(me,["TimeIn","timein","time_in"])||"").trim(),ot=String(Rn(me,["MemberID","memberid","member_id","id"])||"").trim(),Pt=!L_(me);Fe&&!Pt&&ot&&De.add(ot)}const et=De.size;let nn=0,st=0,Qt=0;for(const me of ie){const Fe=me.Date||me.date||me.pay_date;if(!Fe||new Date(Fe).toLocaleDateString("en-CA",{year:"numeric",month:"2-digit",day:"2-digit"})!==te)continue;const Pt=parseFloat(me.Cost||me.amount||0)||0;Qt+=Pt;const Kn=String(me.Mode||me.mode||me.method||"").toLowerCase();Kn==="cash"&&(nn+=Pt),Kn==="gcash"&&(st+=Pt)}e({totalMembers:de.length,activeGym:Z,activeCoach:H,visitedToday:oe,coachToday:be,checkedIn:et,cashToday:nn,gcashToday:st,totalPaymentsToday:Qt}),r(!1),setShowLoadingToast(!1)},20)}Q();const I=qt.on("gymEntry:added",async A=>{try{s(!0);const F=await yh();f((F==null?void 0:F.rows)||(F==null?void 0:F.data)||[]),s(!1)}catch{}}),V=qt.on("member:updated",async()=>{try{const A=await gh();c((A==null?void 0:A.rows)||(A==null?void 0:A.data)||[])}catch{}}),q=setInterval(async()=>{try{const A=await yh();f((A==null?void 0:A.rows)||(A==null?void 0:A.data)||[])}catch{}},15e3);return()=>{I(),V(),clearInterval(q)}},[]),N.useEffect(()=>{try{const Q=E(o||[],a||[],h||[],p||[]);e(Q)}catch(Q){console.warn("Failed to recompute stats on data change",Q)}},[o,a,h,p]);const k=Q=>{if(!Q)return;const I=String(Q.MemberID||Q.member_id||Q.id||Q.member||"").trim();I&&(C(I),R(Q||null),L(!0),T(null))};return u.jsxs("div",{className:"dashboard-content",children:[u.jsxs("h2",{className:"dashboard-title",children:["Daily Dashboard ",u.jsx(hd,{show:i&&!n})]}),u.jsxs("div",{className:"dashboard-grid-3x3",children:[u.jsxs("div",{className:"dashboard-card",children:[u.jsx("div",{className:"dashboard-label",children:"Total Members"}),u.jsx("div",{className:"dashboard-value magenta",children:t.totalMembers})]}),u.jsxs("div",{className:"dashboard-card",children:[u.jsx("div",{className:"dashboard-label",children:"Active Gym Memberships"}),u.jsx("div",{className:"dashboard-value magenta",children:t.activeGym})]}),u.jsxs("div",{className:"dashboard-card",children:[u.jsx("div",{className:"dashboard-label",children:"Active Coach Subscriptions"}),u.jsx("div",{className:"dashboard-value magenta",children:t.activeCoach})]}),u.jsxs("div",{className:"dashboard-card",children:[u.jsx("div",{className:"dashboard-label",children:"Member Visits"}),u.jsx("div",{className:"dashboard-value magenta",children:t.visitedToday})]}),u.jsxs("div",{className:"dashboard-card",children:[u.jsx("div",{className:"dashboard-label",children:"Coaching Sessions"}),u.jsx("div",{className:"dashboard-value magenta",children:t.coachToday})]}),u.jsxs("div",{className:"dashboard-card",children:[u.jsx("div",{className:"dashboard-label",children:"Currently Checked-In"}),u.jsx("div",{className:"dashboard-value magenta",children:t.checkedIn})]}),u.jsxs("div",{className:"dashboard-card",children:[u.jsx("div",{className:"dashboard-label",children:"Cash Revenue"}),u.jsxs("div",{className:"dashboard-value magenta",children:[" ",t.cashToday.toLocaleString()]})]}),u.jsxs("div",{className:"dashboard-card",children:[u.jsx("div",{className:"dashboard-label",children:"GCash Revenue"}),u.jsxs("div",{className:"dashboard-value magenta",children:[" ",t.gcashToday.toLocaleString()]})]}),u.jsxs("div",{className:"dashboard-card",children:[u.jsx("div",{className:"dashboard-label",children:"Total Revenue"}),u.jsxs("div",{className:"dashboard-value magenta",children:[" ",(t.totalPaymentsToday||0).toLocaleString()]})]})]}),u.jsxs("div",{style:{marginTop:24},className:"panel",children:[u.jsx("div",{className:"panel-header",children:"Gym Entries Today"}),u.jsxs("table",{className:"aligned",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Nickname"}),u.jsx("th",{children:"Time In"}),u.jsx("th",{children:"Time Out"}),u.jsx("th",{children:"Total Hours"}),u.jsx("th",{children:"Coach"}),u.jsx("th",{children:"Focus"})]})}),u.jsx("tbody",{children:!S||Array.isArray(S)&&S.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:6,children:"-"})}):S})]})]}),u.jsx(og,{open:!!w,onClose:()=>T(null),row:w,onCheckout:Q=>k(Q)}),u.jsx(fd,{open:M,memberId:B,initialEntry:b,onClose:()=>{L(!1),C(null),R(null)},onSuccess:async()=>{try{const Q=await yh();f((Q==null?void 0:Q.rows)||(Q==null?void 0:Q.data)||[])}catch(Q){console.error(Q)}L(!1),C(null),R(null)}}),u.jsxs("div",{style:{marginTop:24},className:"panel",children:[u.jsx("div",{className:"panel-header",children:"Payments Today"}),u.jsxs("table",{className:"aligned payments-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Nickname"}),u.jsx("th",{children:"Particulars"}),u.jsxs("th",{children:["Gym Membership",u.jsx("br",{}),"Valid Until"]}),u.jsxs("th",{children:["Coach Subscription",u.jsx("br",{}),"Valid Until"]}),u.jsx("th",{children:"Mode"}),u.jsx("th",{children:"Cost"})]})}),u.jsx("tbody",{children:!j||Array.isArray(j)&&j.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:6,children:"-"})}):j})]})]}),n&&u.jsx("div",{style:{marginTop:24},children:"Loading"})]})}const Vj="modulepreload",Lj=function(t){return"/kusgan-frontend/"+t},z_={},Fj=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(n.map(a=>{if(a=Lj(a),a in z_)return;z_[a]=!0;const d=a.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${h}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":Vj,d||(f.as="script"),f.crossOrigin="",f.href=a,c&&f.setAttribute("nonce",c),document.head.appendChild(f),d)return new Promise((p,v)=>{f.addEventListener("load",p),f.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${a}`)))})}))}function s(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return i.then(o=>{for(const c of o||[])c.status==="rejected"&&s(c.reason);return e().catch(s)})};var LT={exports:{}},FT={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Io=N;function Uj(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Bj=typeof Object.is=="function"?Object.is:Uj,zj=Io.useState,$j=Io.useEffect,Hj=Io.useLayoutEffect,Wj=Io.useDebugValue;function qj(t,e){var n=e(),r=zj({inst:{value:n,getSnapshot:e}}),i=r[0].inst,s=r[1];return Hj(function(){i.value=n,i.getSnapshot=e,vh(i)&&s({inst:i})},[t,n,e]),$j(function(){return vh(i)&&s({inst:i}),t(function(){vh(i)&&s({inst:i})})},[t]),Wj(n),n}function vh(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Bj(t,n)}catch{return!0}}function Gj(t,e){return e()}var Qj=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Gj:qj;FT.useSyncExternalStore=Io.useSyncExternalStore!==void 0?Io.useSyncExternalStore:Qj;LT.exports=FT;var Kj=LT.exports;const UT=0,BT=1,zT=2,$_=3;var H_=Object.prototype.hasOwnProperty;function em(t,e){var n,r;if(t===e)return!0;if(t&&e&&(n=t.constructor)===e.constructor){if(n===Date)return t.getTime()===e.getTime();if(n===RegExp)return t.toString()===e.toString();if(n===Array){if((r=t.length)===e.length)for(;r--&&em(t[r],e[r]););return r===-1}if(!n||typeof t=="object"){r=0;for(n in t)if(H_.call(t,n)&&++r&&!H_.call(e,n)||!(n in e)||!em(t[n],e[n]))return!1;return Object.keys(e).length===r}}return t!==t&&e!==e}const Rr=new WeakMap,fi=()=>{},dn=fi(),tm=Object,We=t=>t===dn,mr=t=>typeof t=="function",Vi=(t,e)=>({...t,...e}),$T=t=>mr(t.then),_h={},hc={},ag="undefined",Cl=typeof window!=ag,nm=typeof document!=ag,Yj=Cl&&"Deno"in window,Xj=()=>Cl&&typeof window.requestAnimationFrame!=ag,HT=(t,e)=>{const n=Rr.get(t);return[()=>!We(e)&&t.get(e)||_h,r=>{if(!We(e)){const i=t.get(e);e in hc||(hc[e]=i),n[5](e,Vi(i,r),i||_h)}},n[6],()=>!We(e)&&e in hc?hc[e]:!We(e)&&t.get(e)||_h]};let rm=!0;const Jj=()=>rm,[im,sm]=Cl&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[fi,fi],Zj=()=>{const t=nm&&document.visibilityState;return We(t)||t!=="hidden"},eM=t=>(nm&&document.addEventListener("visibilitychange",t),im("focus",t),()=>{nm&&document.removeEventListener("visibilitychange",t),sm("focus",t)}),tM=t=>{const e=()=>{rm=!0,t()},n=()=>{rm=!1};return im("online",e),im("offline",n),()=>{sm("online",e),sm("offline",n)}},nM={isOnline:Jj,isVisible:Zj},rM={initFocus:eM,initReconnect:tM},W_=!Ue.useId,ul=!Cl||Yj,iM=t=>Xj()?window.requestAnimationFrame(t):setTimeout(t,1),wh=ul?N.useEffect:N.useLayoutEffect,Sh=typeof navigator<"u"&&navigator.connection,q_=!ul&&Sh&&(["slow-2g","2g"].includes(Sh.effectiveType)||Sh.saveData),fc=new WeakMap,sM=t=>tm.prototype.toString.call(t),Eh=(t,e)=>t===`[object ${e}]`;let oM=0;const om=t=>{const e=typeof t,n=sM(t),r=Eh(n,"Date"),i=Eh(n,"RegExp"),s=Eh(n,"Object");let o,c;if(tm(t)===t&&!r&&!i){if(o=fc.get(t),o)return o;if(o=++oM+"~",fc.set(t,o),Array.isArray(t)){for(o="@",c=0;c<t.length;c++)o+=om(t[c])+",";fc.set(t,o)}if(s){o="#";const a=tm.keys(t).sort();for(;!We(c=a.pop());)We(t[c])||(o+=c+":"+om(t[c])+",");fc.set(t,o)}}else o=r?t.toJSON():e=="symbol"?t.toString():e=="string"?JSON.stringify(t):""+t;return o},lg=t=>{if(mr(t))try{t=t()}catch{t=""}const e=t;return t=typeof t=="string"?t:(Array.isArray(t)?t.length:t)?om(t):"",[t,e]};let aM=0;const am=()=>++aM;async function WT(...t){const[e,n,r,i]=t,s=Vi({populateCache:!0,throwOnError:!0},typeof i=="boolean"?{revalidate:i}:i||{});let o=s.populateCache;const c=s.rollbackOnError;let a=s.optimisticData;const d=p=>typeof c=="function"?c(p):c!==!1,h=s.throwOnError;if(mr(n)){const p=n,v=[],x=e.keys();for(const _ of x)!/^\$(inf|sub)\$/.test(_)&&p(e.get(_)._k)&&v.push(_);return Promise.all(v.map(f))}return f(n);async function f(p){const[v]=lg(p);if(!v)return;const[x,_]=HT(e,v),[P,y,w,T]=Rr.get(e),M=()=>{const Q=P[v];return(mr(s.revalidate)?s.revalidate(x().data,p):s.revalidate!==!1)&&(delete w[v],delete T[v],Q&&Q[0])?Q[0](zT).then(()=>x().data):x().data};if(t.length<3)return M();let L=r,B,C=!1;const b=am();y[v]=[b,0];const R=!We(a),S=x(),E=S.data,j=S._c,k=We(j)?E:j;if(R&&(a=mr(a)?a(k,E):a,_({data:a,_c:k})),mr(L))try{L=L(k)}catch(Q){B=Q,C=!0}if(L&&$T(L))if(L=await L.catch(Q=>{B=Q,C=!0}),b!==y[v][0]){if(C)throw B;return L}else C&&R&&d(B)&&(o=!0,_({data:k,_c:dn}));if(o&&!C)if(mr(o)){const Q=o(L,k);_({data:Q,error:dn,_c:dn})}else _({data:L,error:dn,_c:dn});if(y[v][1]=am(),Promise.resolve(M()).then(()=>{_({_c:dn})}),C){if(h)throw B;return}return L}}const G_=(t,e)=>{for(const n in t)t[n][0]&&t[n][0](e)},lM=(t,e)=>{if(!Rr.has(t)){const n=Vi(rM,e),r=Object.create(null),i=WT.bind(dn,t);let s=fi;const o=Object.create(null),c=(h,f)=>{const p=o[h]||[];return o[h]=p,p.push(f),()=>p.splice(p.indexOf(f),1)},a=(h,f,p)=>{t.set(h,f);const v=o[h];if(v)for(const x of v)x(f,p)},d=()=>{if(!Rr.has(t)&&(Rr.set(t,[r,Object.create(null),Object.create(null),Object.create(null),i,a,c]),!ul)){const h=n.initFocus(setTimeout.bind(dn,G_.bind(dn,r,UT))),f=n.initReconnect(setTimeout.bind(dn,G_.bind(dn,r,BT)));s=()=>{h&&h(),f&&f(),Rr.delete(t)}}};return d(),[t,i,d,s]}return[t,Rr.get(t)[4]]},cM=(t,e,n,r,i)=>{const s=n.errorRetryCount,o=i.retryCount,c=~~((Math.random()+.5)*(1<<(o<8?o:8)))*n.errorRetryInterval;!We(s)&&o>s||setTimeout(r,c,i)},uM=em,[qT,dM]=lM(new Map),hM=Vi({onLoadingSlow:fi,onSuccess:fi,onError:fi,onErrorRetry:cM,onDiscarded:fi,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:q_?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:q_?5e3:3e3,compare:uM,isPaused:()=>!1,cache:qT,mutate:dM,fallback:{}},nM),fM=(t,e)=>{const n=Vi(t,e);if(e){const{use:r,fallback:i}=t,{use:s,fallback:o}=e;r&&s&&(n.use=r.concat(s)),i&&o&&(n.fallback=Vi(i,o))}return n},mM=N.createContext({}),pM="$inf$",GT=Cl&&window.__SWR_DEVTOOLS_USE__,gM=GT?window.__SWR_DEVTOOLS_USE__:[],yM=()=>{GT&&(window.__SWR_DEVTOOLS_REACT__=Ue)},vM=t=>mr(t[1])?[t[0],t[1],t[2]||{}]:[t[0],null,(t[1]===null?t[2]:t[1])||{}],_M=()=>{const t=N.useContext(mM);return N.useMemo(()=>Vi(hM,t),[t])},wM=t=>(e,n,r)=>t(e,n&&((...s)=>{const[o]=lg(e),[,,,c]=Rr.get(qT);if(o.startsWith(pM))return n(...s);const a=c[o];return We(a)?n(...s):(delete c[o],a)}),r),SM=gM.concat(wM),EM=t=>function(...n){const r=_M(),[i,s,o]=vM(n),c=fM(r,o);let a=t;const{use:d}=c,h=(d||[]).concat(SM);for(let f=h.length;f--;)a=h[f](a);return a(i,s||c.fetcher||null,c)},TM=(t,e,n)=>{const r=e[t]||(e[t]=[]);return r.push(n),()=>{const i=r.indexOf(n);i>=0&&(r[i]=r[r.length-1],r.pop())}};yM();const Th=Ue.use||(t=>{switch(t.status){case"pending":throw t;case"fulfilled":return t.value;case"rejected":throw t.reason;default:throw t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}),t}}),bh={dedupe:!0},Q_=Promise.resolve(dn),bM=(t,e,n)=>{const{cache:r,compare:i,suspense:s,fallbackData:o,revalidateOnMount:c,revalidateIfStale:a,refreshInterval:d,refreshWhenHidden:h,refreshWhenOffline:f,keepPreviousData:p}=n,[v,x,_,P]=Rr.get(r),[y,w]=lg(t),T=N.useRef(!1),M=N.useRef(!1),L=N.useRef(y),B=N.useRef(e),C=N.useRef(n),b=()=>C.current,R=()=>b().isVisible()&&b().isOnline(),[S,E,j,k]=HT(r,y),Q=N.useRef({}).current,I=We(o)?We(n.fallback)?dn:n.fallback[y]:o,V=(U,Z)=>{for(const H in Q){const te=H;if(te==="data"){if(!i(U[te],Z[te])&&(!We(U[te])||!i(ae,Z[te])))return!1}else if(Z[te]!==U[te])return!1}return!0},q=N.useMemo(()=>{const U=!y||!e?!1:We(c)?b().isPaused()||s?!1:a!==!1:c,Z=ue=>{const be=Vi(ue);return delete be._k,U?{isValidating:!0,isLoading:!0,...be}:be},H=S(),te=k(),X=Z(H),re=H===te?X:Z(te);let oe=X;return[()=>{const ue=Z(S());return V(ue,oe)?(oe.data=ue.data,oe.isLoading=ue.isLoading,oe.isValidating=ue.isValidating,oe.error=ue.error,oe):(oe=ue,ue)},()=>re]},[r,y]),A=Kj.useSyncExternalStore(N.useCallback(U=>j(y,(Z,H)=>{V(H,Z)||U()}),[r,y]),q[0],q[1]),F=!T.current,O=v[y]&&v[y].length>0,z=A.data,$=We(z)?I&&$T(I)?Th(I):I:z,G=A.error,J=N.useRef($),ae=p?We(z)?We(J.current)?$:J.current:z:$,de=O&&!We(G)?!1:F&&!We(c)?c:b().isPaused()?!1:s?We($)?!1:a:We($)||a,ie=!!(y&&e&&F&&de),_e=We(A.isValidating)?ie:A.isValidating,Te=We(A.isLoading)?ie:A.isLoading,ge=N.useCallback(async U=>{const Z=B.current;if(!y||!Z||M.current||b().isPaused())return!1;let H,te,X=!0;const re=U||{},oe=!_[y]||!re.dedupe,ue=()=>W_?!M.current&&y===L.current&&T.current:y===L.current,be={isValidating:!1,isLoading:!1},De=()=>{E(be)},et=()=>{const st=_[y];st&&st[1]===te&&delete _[y]},nn={isValidating:!0};We(S().data)&&(nn.isLoading=!0);try{if(oe&&(E(nn),n.loadingTimeout&&We(S().data)&&setTimeout(()=>{X&&ue()&&b().onLoadingSlow(y,n)},n.loadingTimeout),_[y]=[Z(w),am()]),[H,te]=_[y],H=await H,oe&&setTimeout(et,n.dedupingInterval),!_[y]||_[y][1]!==te)return oe&&ue()&&b().onDiscarded(y),!1;be.error=dn;const st=x[y];if(!We(st)&&(te<=st[0]||te<=st[1]||st[1]===0))return De(),oe&&ue()&&b().onDiscarded(y),!1;const Qt=S().data;be.data=i(Qt,H)?Qt:H,oe&&ue()&&b().onSuccess(H,y,n)}catch(st){et();const Qt=b(),{shouldRetryOnError:me}=Qt;Qt.isPaused()||(be.error=st,oe&&ue()&&(Qt.onError(st,y,Qt),(me===!0||mr(me)&&me(st))&&(!b().revalidateOnFocus||!b().revalidateOnReconnect||R())&&Qt.onErrorRetry(st,y,Qt,Fe=>{const ot=v[y];ot&&ot[0]&&ot[0]($_,Fe)},{retryCount:(re.retryCount||0)+1,dedupe:!0})))}return X=!1,De(),!0},[y,r]),Pe=N.useCallback((...U)=>WT(r,L.current,...U),[]);if(wh(()=>{B.current=e,C.current=n,We(z)||(J.current=z)}),wh(()=>{if(!y)return;const U=ge.bind(dn,bh);let Z=0;b().revalidateOnFocus&&(Z=Date.now()+b().focusThrottleInterval);const te=TM(y,v,(X,re={})=>{if(X==UT){const oe=Date.now();b().revalidateOnFocus&&oe>Z&&R()&&(Z=oe+b().focusThrottleInterval,U())}else if(X==BT)b().revalidateOnReconnect&&R()&&U();else{if(X==zT)return ge();if(X==$_)return ge(re)}});return M.current=!1,L.current=y,T.current=!0,E({_k:w}),de&&(_[y]||(We($)||ul?U():iM(U))),()=>{M.current=!0,te()}},[y]),wh(()=>{let U;function Z(){const te=mr(d)?d(S().data):d;te&&U!==-1&&(U=setTimeout(H,te))}function H(){!S().error&&(h||b().isVisible())&&(f||b().isOnline())?ge(bh).then(Z):Z()}return Z(),()=>{U&&(clearTimeout(U),U=-1)}},[d,h,f,y]),N.useDebugValue(ae),s){const U=y&&We($);if(!W_&&ul&&U)throw new Error("Fallback data is required when using Suspense in SSR.");U&&(B.current=e,C.current=n,M.current=!1);const Z=P[y],H=!We(Z)&&U?Pe(Z):Q_;if(Th(H),!We(G)&&U)throw G;const te=U?ge(bh):Q_;!We(ae)&&U&&(te.status="fulfilled",te.value=!0),Th(te)}return{mutate:Pe,get data(){return Q.data=!0,ae},get error(){return Q.error=!0,G},get isValidating(){return Q.isValidating=!0,_e},get isLoading(){return Q.isLoading=!0,Te}}},xM=EM(bM);function lm(){return lm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},lm.apply(null,arguments)}function K_(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function cm(t,e){return cm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},cm(t,e)}function IM(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,cm(t,e)}var Y_=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function CM(t,e){return!!(t===e||Y_(t)&&Y_(e))}function AM(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!CM(t[n],e[n]))return!1;return!0}function xh(t,e){e===void 0&&(e=AM);var n,r=[],i,s=!1;function o(){for(var c=[],a=0;a<arguments.length;a++)c[a]=arguments[a];return s&&n===this&&e(c,r)||(i=t.apply(this,c),s=!0,n=this,r=c),i}return o}var NM=typeof performance=="object"&&typeof performance.now=="function",X_=NM?function(){return performance.now()}:function(){return Date.now()};function J_(t){cancelAnimationFrame(t.id)}function kM(t,e){var n=X_();function r(){X_()-n>=e?t.call(null):i.id=requestAnimationFrame(r)}var i={id:requestAnimationFrame(r)};return i}var Ih=-1;function Z_(t){if(t===void 0&&(t=!1),Ih===-1||t){var e=document.createElement("div"),n=e.style;n.width="50px",n.height="50px",n.overflow="scroll",document.body.appendChild(e),Ih=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return Ih}var Ds=null;function ew(t){if(t===void 0&&(t=!1),Ds===null||t){var e=document.createElement("div"),n=e.style;n.width="50px",n.height="50px",n.overflow="scroll",n.direction="rtl";var r=document.createElement("div"),i=r.style;return i.width="100px",i.height="100px",e.appendChild(r),document.body.appendChild(e),e.scrollLeft>0?Ds="positive-descending":(e.scrollLeft=1,e.scrollLeft===0?Ds="negative":Ds="positive-ascending"),document.body.removeChild(e),Ds}return Ds}var PM=150,RM=function(e,n){return e};function DM(t){var e,n=t.getItemOffset,r=t.getEstimatedTotalSize,i=t.getItemSize,s=t.getOffsetForIndexAndAlignment,o=t.getStartIndexForOffset,c=t.getStopIndexForStartIndex,a=t.initInstanceProps,d=t.shouldResetStyleCacheOnItemSizeChange,h=t.validateProps;return e=function(f){IM(p,f);function p(x){var _;return _=f.call(this,x)||this,_._instanceProps=a(_.props,K_(_)),_._outerRef=void 0,_._resetIsScrollingTimeoutId=null,_.state={instance:K_(_),isScrolling:!1,scrollDirection:"forward",scrollOffset:typeof _.props.initialScrollOffset=="number"?_.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},_._callOnItemsRendered=void 0,_._callOnItemsRendered=xh(function(P,y,w,T){return _.props.onItemsRendered({overscanStartIndex:P,overscanStopIndex:y,visibleStartIndex:w,visibleStopIndex:T})}),_._callOnScroll=void 0,_._callOnScroll=xh(function(P,y,w){return _.props.onScroll({scrollDirection:P,scrollOffset:y,scrollUpdateWasRequested:w})}),_._getItemStyle=void 0,_._getItemStyle=function(P){var y=_.props,w=y.direction,T=y.itemSize,M=y.layout,L=_._getItemStyleCache(d&&T,d&&M,d&&w),B;if(L.hasOwnProperty(P))B=L[P];else{var C=n(_.props,P,_._instanceProps),b=i(_.props,P,_._instanceProps),R=w==="horizontal"||M==="horizontal",S=w==="rtl",E=R?C:0;L[P]=B={position:"absolute",left:S?void 0:E,right:S?E:void 0,top:R?0:C,height:R?"100%":b,width:R?b:"100%"}}return B},_._getItemStyleCache=void 0,_._getItemStyleCache=xh(function(P,y,w){return{}}),_._onScrollHorizontal=function(P){var y=P.currentTarget,w=y.clientWidth,T=y.scrollLeft,M=y.scrollWidth;_.setState(function(L){if(L.scrollOffset===T)return null;var B=_.props.direction,C=T;if(B==="rtl")switch(ew()){case"negative":C=-T;break;case"positive-descending":C=M-w-T;break}return C=Math.max(0,Math.min(C,M-w)),{isScrolling:!0,scrollDirection:L.scrollOffset<C?"forward":"backward",scrollOffset:C,scrollUpdateWasRequested:!1}},_._resetIsScrollingDebounced)},_._onScrollVertical=function(P){var y=P.currentTarget,w=y.clientHeight,T=y.scrollHeight,M=y.scrollTop;_.setState(function(L){if(L.scrollOffset===M)return null;var B=Math.max(0,Math.min(M,T-w));return{isScrolling:!0,scrollDirection:L.scrollOffset<B?"forward":"backward",scrollOffset:B,scrollUpdateWasRequested:!1}},_._resetIsScrollingDebounced)},_._outerRefSetter=function(P){var y=_.props.outerRef;_._outerRef=P,typeof y=="function"?y(P):y!=null&&typeof y=="object"&&y.hasOwnProperty("current")&&(y.current=P)},_._resetIsScrollingDebounced=function(){_._resetIsScrollingTimeoutId!==null&&J_(_._resetIsScrollingTimeoutId),_._resetIsScrollingTimeoutId=kM(_._resetIsScrolling,PM)},_._resetIsScrolling=function(){_._resetIsScrollingTimeoutId=null,_.setState({isScrolling:!1},function(){_._getItemStyleCache(-1,null)})},_}p.getDerivedStateFromProps=function(_,P){return jM(_,P),h(_),null};var v=p.prototype;return v.scrollTo=function(_){_=Math.max(0,_),this.setState(function(P){return P.scrollOffset===_?null:{scrollDirection:P.scrollOffset<_?"forward":"backward",scrollOffset:_,scrollUpdateWasRequested:!0}},this._resetIsScrollingDebounced)},v.scrollToItem=function(_,P){P===void 0&&(P="auto");var y=this.props,w=y.itemCount,T=y.layout,M=this.state.scrollOffset;_=Math.max(0,Math.min(_,w-1));var L=0;if(this._outerRef){var B=this._outerRef;T==="vertical"?L=B.scrollWidth>B.clientWidth?Z_():0:L=B.scrollHeight>B.clientHeight?Z_():0}this.scrollTo(s(this.props,_,P,M,this._instanceProps,L))},v.componentDidMount=function(){var _=this.props,P=_.direction,y=_.initialScrollOffset,w=_.layout;if(typeof y=="number"&&this._outerRef!=null){var T=this._outerRef;P==="horizontal"||w==="horizontal"?T.scrollLeft=y:T.scrollTop=y}this._callPropsCallbacks()},v.componentDidUpdate=function(){var _=this.props,P=_.direction,y=_.layout,w=this.state,T=w.scrollOffset,M=w.scrollUpdateWasRequested;if(M&&this._outerRef!=null){var L=this._outerRef;if(P==="horizontal"||y==="horizontal")if(P==="rtl")switch(ew()){case"negative":L.scrollLeft=-T;break;case"positive-ascending":L.scrollLeft=T;break;default:var B=L.clientWidth,C=L.scrollWidth;L.scrollLeft=C-B-T;break}else L.scrollLeft=T;else L.scrollTop=T}this._callPropsCallbacks()},v.componentWillUnmount=function(){this._resetIsScrollingTimeoutId!==null&&J_(this._resetIsScrollingTimeoutId)},v.render=function(){var _=this.props,P=_.children,y=_.className,w=_.direction,T=_.height,M=_.innerRef,L=_.innerElementType,B=_.innerTagName,C=_.itemCount,b=_.itemData,R=_.itemKey,S=R===void 0?RM:R,E=_.layout,j=_.outerElementType,k=_.outerTagName,Q=_.style,I=_.useIsScrolling,V=_.width,q=this.state.isScrolling,A=w==="horizontal"||E==="horizontal",F=A?this._onScrollHorizontal:this._onScrollVertical,O=this._getRangeToRender(),z=O[0],$=O[1],G=[];if(C>0)for(var J=z;J<=$;J++)G.push(N.createElement(P,{data:b,key:S(J,b),index:J,isScrolling:I?q:void 0,style:this._getItemStyle(J)}));var ae=r(this.props,this._instanceProps);return N.createElement(j||k||"div",{className:y,onScroll:F,ref:this._outerRefSetter,style:lm({position:"relative",height:T,width:V,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:w},Q)},N.createElement(L||B||"div",{children:G,ref:M,style:{height:A?"100%":ae,pointerEvents:q?"none":void 0,width:A?ae:"100%"}}))},v._callPropsCallbacks=function(){if(typeof this.props.onItemsRendered=="function"){var _=this.props.itemCount;if(_>0){var P=this._getRangeToRender(),y=P[0],w=P[1],T=P[2],M=P[3];this._callOnItemsRendered(y,w,T,M)}}if(typeof this.props.onScroll=="function"){var L=this.state,B=L.scrollDirection,C=L.scrollOffset,b=L.scrollUpdateWasRequested;this._callOnScroll(B,C,b)}},v._getRangeToRender=function(){var _=this.props,P=_.itemCount,y=_.overscanCount,w=this.state,T=w.isScrolling,M=w.scrollDirection,L=w.scrollOffset;if(P===0)return[0,0,0,0];var B=o(this.props,L,this._instanceProps),C=c(this.props,B,L,this._instanceProps),b=!T||M==="backward"?Math.max(1,y):1,R=!T||M==="forward"?Math.max(1,y):1;return[Math.max(0,B-b),Math.max(0,Math.min(P-1,C+R)),B,C]},p}(N.PureComponent),e.defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},e}var jM=function(e,n){e.children,e.direction,e.height,e.layout,e.innerTagName,e.outerTagName,e.width,n.instance},MM=DM({getItemOffset:function(e,n){var r=e.itemSize;return n*r},getItemSize:function(e,n){var r=e.itemSize;return r},getEstimatedTotalSize:function(e){var n=e.itemCount,r=e.itemSize;return r*n},getOffsetForIndexAndAlignment:function(e,n,r,i,s,o){var c=e.direction,a=e.height,d=e.itemCount,h=e.itemSize,f=e.layout,p=e.width,v=c==="horizontal"||f==="horizontal",x=v?p:a,_=Math.max(0,d*h-x),P=Math.min(_,n*h),y=Math.max(0,n*h-x+h+o);switch(r==="smart"&&(i>=y-x&&i<=P+x?r="auto":r="center"),r){case"start":return P;case"end":return y;case"center":{var w=Math.round(y+(P-y)/2);return w<Math.ceil(x/2)?0:w>_+Math.floor(x/2)?_:w}case"auto":default:return i>=y&&i<=P?i:i<y?y:P}},getStartIndexForOffset:function(e,n){var r=e.itemCount,i=e.itemSize;return Math.max(0,Math.min(r-1,Math.floor(n/i)))},getStopIndexForStartIndex:function(e,n,r){var i=e.direction,s=e.height,o=e.itemCount,c=e.itemSize,a=e.layout,d=e.width,h=i==="horizontal"||a==="horizontal",f=n*c,p=h?d:s,v=Math.ceil((p+r-f)/c);return Math.max(0,Math.min(o-1,n+v-1))},initInstanceProps:function(e){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(e){e.itemSize}});const OM="kusgan-local-cache",VM=1,dl="kv",cg="state",Ch="__kusgan_sync_lock__";let Ke={members:[],attendance:[],payments:[],gymEntries:[],progress:[],queue:[]},Ah=null;function ug(){return Ah||(Ah=HS(OM,VM,{upgrade(t){t.objectStoreNames.contains(dl)||t.createObjectStore(dl)}})),Ah}async function LM(){try{const e=await(await ug()).get(dl,cg);e&&typeof e=="object"&&(Ke=Object.assign(Ke,e),Ke.members||(Ke.members=[]),Ke.attendance||(Ke.attendance=[]),Ke.queue||(Ke.queue=[]),Ke.payments||(Ke.payments=[]),Ke.gymEntries||(Ke.gymEntries=[]),Ke.progress||(Ke.progress=[]))}catch(t){console.warn("localCache: failed to load from idb",t&&t.message)}}async function md(t){try{await(await ug()).put(dl,t,cg)}catch(e){console.warn("localCache: failed to write to idb",e&&e.message)}}function ys(){return Ke||(Ke={members:[],attendance:[],payments:[],gymEntries:[],progress:[],queue:[]}),Ke.members||(Ke.members=[]),Ke.attendance||(Ke.attendance=[]),Ke.queue||(Ke.queue=[]),Ke.payments||(Ke.payments=[]),Ke.gymEntries||(Ke.gymEntries=[]),Ke.progress||(Ke.progress=[]),Ke}LM();function FM(t){return ys()[t]||[]}function UM(t,e){const n=ys();n[t]=Array.isArray(e)?e:[],md(n).catch(()=>{})}function BM(t){const e=ys();e.queue.unshift(t),md(e).catch(()=>{})}function QT(t){BM({id:"q-"+Date.now()+"-"+Math.floor(Math.random()*1e3),...t}),dg()}function zM(t){const n=new Date().toISOString(),r=n.slice(0,10),i=n.slice(11,16),s="local-"+Date.now(),o={id:s,Staff:t,staff_name:t,Date:r,TimeIn:i,time_in:n,status:"On Duty",_localPending:!0},c=ys();return c.attendance=[o,...c.attendance||[]],md(c).catch(()=>{}),QT({method:"POST",path:"/attendance/kiosk",body:{staff_name:t},tempId:s,collection:"attendance"}),o}async function $M(t){try{const e=Ca&&typeof Ca=="function"?Ca():null,n={"Content-Type":"application/json"};e&&(n.Authorization=`Bearer ${e}`);const r=await fetch(t.path,{method:t.method||"POST",headers:n,body:JSON.stringify(t.body||{})}),i=await r.json().catch(()=>({}));if(!r.ok)throw new Error(i&&i.error?i.error:"Request failed");return{ok:!0,json:i}}catch(e){return{ok:!1,error:String(e&&e.message||e)}}}async function dg(){if(!window[Ch]){window[Ch]=!0;try{let t=ys();for(;(t.queue||[]).length;){const e=t.queue[t.queue.length-1];if(!e)break;const n=await $M(e);if(n.ok){if(t=ys(),t.queue=(t.queue||[]).filter(r=>r.id!==e.id),e.collection==="attendance"&&e.tempId)try{const r=n.json&&(n.json.row||n.json);r&&(t.attendance=(t.attendance||[]).map(i=>i.id===e.tempId?r:i))}catch{}if(e.collection==="members"&&e.tempId)try{const r=n.json&&(n.json.row||n.json);r&&(t.members=(t.members||[]).map(i=>i.id===e.tempId?r:i))}catch{}md(t).catch(()=>{})}else break}}finally{window[Ch]=!1}}}window.addEventListener&&window.addEventListener("online",()=>{dg()});async function HM(){try{Ke={members:[],attendance:[],payments:[],gymEntries:[],progress:[],queue:[]},await(await ug()).delete(dl,cg)}catch(t){console.warn("localCache.clearCache failed",t&&t.message)}}ys();const Nr={getCached:FM,setCached:UM,addOptimisticAttendance:zM,enqueueWrite:QT,processQueue:dg,clearCache:HM},WM=Ue.lazy(()=>Fj(()=>import("./AddMemberModal-BiSPsGfF.js"),[])),Ct={members:null,payments:null,gymEntries:null,ts:{members:0,payments:0,gymEntries:0}},um="kusgan.members.cache.v1",qM=1e3*60*60;function GM(){try{if(typeof window>"u"||!window.localStorage)return;const t=window.localStorage.getItem(um);if(!t)return;const e=JSON.parse(t);if(!e||!e.ts||Date.now()-(e.ts.members||0)>qM)return;Ct.members=e.members||null,Ct.payments=e.payments||null,Ct.gymEntries=e.gymEntries||null,Ct.ts=e.ts||Ct.ts}catch(t){console.debug("Members: failed to load cache from localStorage",t)}}function QM(){try{if(typeof window>"u"||!window.localStorage)return;const t={members:Ct.members,payments:Ct.payments,gymEntries:Ct.gymEntries,ts:Ct.ts};typeof window.requestIdleCallback=="function"?window.requestIdleCallback(()=>{try{window.localStorage.setItem(um,JSON.stringify(t))}catch(e){console.debug("Members: failed to save cache to localStorage",e)}},{timeout:2e3}):setTimeout(()=>{try{window.localStorage.setItem(um,JSON.stringify(t))}catch(e){console.debug("Members: failed to save cache to localStorage",e)}},0)}catch(t){console.debug("Members: failed to save cache to localStorage",t)}}try{GM()}catch{}const KM=t=>String(t||"").trim().toLowerCase().replace(/\s+/g,"_"),tw=t=>["yes","y","true","1"].includes(String(t||"").trim().toLowerCase()),Lt=(t,e)=>e.map(n=>t[n]).find(n=>n!==void 0&&n!==""),li=t=>{if(t instanceof Date)return t;const e=new Date(t);return isNaN(e)?null:e},YM=(t,e)=>t&&e&&t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate(),Da=t=>{const e={};return Object.entries(t||{}).forEach(([n,r])=>{e[KM(n)]=r}),e},nw=t=>{if(!t)return null;let n=li(Lt(t,["member_since","membersince","member_date","memberdate","createdat","created_at","created","join_date","joined","start_date","memberdateexcel","membersinceexcel"]));if(n)return n;try{const r=t._raw||t;if(n=Lt(r,["MemberSince","Member Since","MemberDate","Member Date","createdAt","created_at","Created","Joined","Join Date","start_date"]),n)return li(n)}catch{}return null},rw=t=>String(t||"").toLowerCase().replace(/(?:^|[\s\-])([a-z])/g,(n,r)=>n.replace(r,r.toUpperCase())),ei=t=>t?`${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()]}-${t.getDate()}, ${t.getFullYear()}`:"",mc=t=>{if(!t)return!1;const e=t instanceof Date?new Date(t):new Date(t);if(isNaN(e))return!1;const n=new Date;return n.setHours(0,0,0,0),e.setHours(0,0,0,0),e>=n};function iw(t){const e=new Map;for(const r of t){const i=Da(r),s=Lt(i,["memberid","member_id","id","member_id_"]);s&&(e.has(s)||e.set(s,[]),e.get(s).push(r))}const n=new Map;for(const[r,i]of e){const s=Oi(i);n.set(r,{membershipEnd:s.membershipEnd||null,coachEnd:s.coachEnd||null,membershipState:s.membershipState||null,coachActive:!!s.coachActive})}return n}function sw(t){const e=new Map;for(const n of t){const r=Da(n),i=Lt(r,["memberid","member_id","id","member_id_"]);if(!i)continue;const s=li(Lt(r,["date","visit_date","entry_date","log_date","timestamp","checkin"]));if(!s)continue;const o=e.get(i);(!o||s>o)&&e.set(i,s)}return e}function XM(){const t=Po(),[e]=N.useState(Number.POSITIVE_INFINITY),[n,r]=N.useState([]),[i,s]=N.useState(new Map),[o,c]=N.useState(new Map),[a,d]=N.useState(!0),[h,f]=N.useState(!1),[p,v]=N.useState(""),[x,_]=N.useState(""),[P,y]=N.useState(""),[w,T]=N.useState(!1),M=N.useRef(null),[L,B]=N.useState(!1),C=N.useRef(null),[b,R]=N.useState(600);N.useEffect(()=>{function A(){try{const F=window.innerHeight||800,z=Math.max(300,F-220);R(z)}catch{R(600)}}return A(),window.addEventListener("resize",A),()=>window.removeEventListener("resize",A)},[]);const S=async()=>{const[F,O,z]=await Promise.all([tt.fetchMembersRecent({days:5}),tt.fetchPayments(),tt.fetchGymEntries()]);return{members:((F==null?void 0:F.rows)??(F==null?void 0:F.data)??[]).map(Da),payments:(O==null?void 0:O.rows)??(O==null?void 0:O.data)??[],gymEntries:(z==null?void 0:z.rows)??(z==null?void 0:z.data)??[]}},{data:E,error:j,isLoading:k,isValidating:Q,mutate:I}=xM("members:recent",S,{revalidateOnFocus:!0,dedupingInterval:2e3,fallbackData:Ct.members?{members:Ct.members,payments:Ct.payments,gymEntries:Ct.gymEntries}:void 0});N.useEffect(()=>{if(E)try{r(E.members||[]),s(iw(E.payments||[])),c(sw(E.gymEntries||[])),Ct.members=E.members||[],Ct.payments=E.payments||[],Ct.gymEntries=E.gymEntries||[],Ct.ts=Ct.ts||{},Ct.ts.members=Date.now(),Ct.ts.payments=Date.now(),Ct.ts.gymEntries=Date.now(),QM()}catch(A){console.error("Members: failed to hydrate from SWR data",A)}},[E]),N.useEffect(()=>{try{const A=Nr.getCached("members")||[];A&&A.length&&r(F=>F&&F.length?F:A.map(Da))}catch{}},[]),N.useEffect(()=>{let A=!1;async function F(){if(P){d(!0);try{const[O,z,$]=await Promise.all([tt.searchMembersByName(P),tt.fetchPayments(),tt.fetchGymEntries()]);if(A)return;const G=((O==null?void 0:O.rows)??[]).map(Da);r(G),s(iw((z==null?void 0:z.rows)||[])),c(sw(($==null?void 0:$.rows)||[]))}catch(O){A||v((O==null?void 0:O.message)||String(O))}finally{A||d(!1)}}}return P&&F(),()=>{A=!0}},[P]),N.useEffect(()=>{d(!!k),f(!!k),j&&v(j.message||String(j))},[k,j]),N.useEffect(()=>(M.current&&clearTimeout(M.current),M.current=setTimeout(()=>y(x.trim()),250),()=>{M.current&&clearTimeout(M.current)}),[x]);const V=N.useMemo(()=>{const A=P.trim().toLowerCase();let F=n;A&&(F=n.filter($=>["first_name","firstname","last_name","lastname","nick_name","nickname","mobile","email"].some(G=>String($[G]??"").toLowerCase().includes(A))));const O=new Date,z=F.map($=>{const G=Lt($,["memberid","member_id","id","member_id_"]),J=G?o.get(G):null,ae=J?YM(J,O):!1,de=li(Lt($,["member_since","membersince","member_date","memberdate","member_date","createdat","created_at","join_date","joined","start_date"])),ie=de?de.getTime():0,_e=J?J.getTime():-1;return{r:$,lastVisit:J,isToday:ae,joinTs:ie,visitTs:_e,memberId:G}});return z.sort(($,G)=>G.joinTs-$.joinTs||G.visitTs-$.visitTs),z},[n,P,o]);return N.useCallback((A,F)=>{A&&t(`/members/${encodeURIComponent(A)}`,{state:{row:F}})},[t]),u.jsxs("div",{className:"content",ref:C,style:{minHeight:"calc(100vh - 120px)",display:"flex",flexDirection:"column"},children:[u.jsxs("h2",{className:"dashboard-title",children:["All Members ",u.jsx(hd,{show:Q&&!k})]}),u.jsxs("div",{className:"toolbar",style:{display:"flex",justifyContent:"center",alignItems:"center",gap:12,marginBottom:12},children:[u.jsx("input",{className:"search-wide",style:{width:"60%",maxWidth:960,minWidth:320},placeholder:"Search members by name",value:x,onChange:A=>_(A.target.value)}),u.jsx("button",{className:"button",onClick:()=>B(!0),children:"+ Add Member"})]}),a&&u.jsx("div",{style:{color:"var(--muted)",textAlign:"center",padding:16},children:"Loading"}),p&&u.jsxs("div",{children:["Error: ",p]}),!a&&!p&&u.jsxs("div",{className:"panel",style:{flex:1,display:"flex",flexDirection:"column"},children:[n.length===0&&u.jsxs("div",{style:{padding:24,textAlign:"center",color:"#b91c1c",fontWeight:600},children:["No member data loaded.",u.jsx("br",{}),"Please check your API connection or try again later."]}),u.jsx("div",{style:{width:"100%"},children:V.length===0?u.jsx("div",{style:{padding:12},children:"No members found."}):V.length<=120?u.jsx("div",{className:"members-list-wrapper",style:{display:"flex",justifyContent:"center"},children:u.jsxs("table",{className:"attendance-table aligned",style:{width:"100%"},children:[u.jsxs("colgroup",{children:[u.jsx("col",{style:{width:"15%"}}),u.jsx("col",{style:{width:"25%"}}),u.jsx("col",{style:{width:"15%"}}),u.jsx("col",{style:{width:"15%"}}),u.jsx("col",{style:{width:"15%"}}),u.jsx("col",{style:{width:"15%"}})]}),u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{style:{textAlign:"center"},children:"Nick Name"}),u.jsx("th",{style:{textAlign:"center"},children:"Full Name"}),u.jsx("th",{style:{textAlign:"center"},children:"Member Since"}),u.jsx("th",{style:{textAlign:"center"},children:"Last Gym Visit"}),u.jsx("th",{style:{textAlign:"center"},children:"Gym Valid Until"}),u.jsx("th",{style:{textAlign:"center"},children:"Coach Valid Until"})]})}),u.jsx("tbody",{children:V.map(({r:A,lastVisit:F,isToday:O,memberId:z},$)=>{const G=z?i.get(z):void 0,J=tw(Lt(A,["student","is_student","student?"]));let ae=Number(Lt(A,["age","years_old"]));if(isNaN(ae)){const Z=Lt(A,["birthday","birth_date","dob"]),H=li(Z);if(H){const te=new Date;ae=te.getFullYear()-H.getFullYear()-(te.getMonth()<H.getMonth()||te.getMonth()===H.getMonth()&&te.getDate()<H.getDate()?1:0)}}const de=!isNaN(ae)&&ae>=60,ie=String(Lt(A,["first_name","firstname","first","given_name"])??""),_e=String(Lt(A,["last_name","lastname","last","surname"])??""),Te=[ie,_e].filter(Boolean).map(rw).join(" "),ge=String(A.nick_name??A.nickname??"").toUpperCase(),Pe=nw(A)||li(Lt(A,["member_since","membersince","member_date","memberdate","member_date","createdat","created_at","join_date","joined","start_date"])),xe=(G==null?void 0:G.membershipEnd)||null,U=(G==null?void 0:G.coachEnd)||null;return u.jsxs("tr",{className:"row-link",onClick:()=>t(`/members/${encodeURIComponent(z)}`,{state:{row:A}}),style:{cursor:"pointer"},children:[u.jsx("td",{style:{textAlign:"center"},children:u.jsx("strong",{children:ge})}),u.jsxs("td",{style:{textAlign:"left"},children:[Te," ",u.jsxs("span",{style:{display:"inline-flex",gap:6,marginLeft:8},children:[J&&u.jsx("span",{className:"pill student",children:"Student"}),de&&u.jsx("span",{className:"pill senior",children:"Senior"})]})]}),u.jsx("td",{style:{textAlign:"center"},children:ei(Pe)}),u.jsx("td",{style:{textAlign:"center"},children:O?u.jsx("span",{className:"pill ok",children:"Visited today"}):F?ei(new Date(F)):""}),u.jsx("td",{style:{textAlign:"center",color:xe?mc(xe)?"green":"red":"inherit"},children:xe?ei(new Date(xe)):""}),u.jsx("td",{style:{textAlign:"center",color:U?mc(U)?"green":"red":"inherit"},children:U?ei(new Date(U)):""})]},$)})})]})}):u.jsxs("div",{className:"members-list-wrapper",style:{width:"100%",display:"flex",flexDirection:"column",flex:1},children:[u.jsxs("div",{style:{display:"flex",padding:"8px 12px",fontWeight:700,borderBottom:"1px solid var(--light-border)",background:"var(--panel-header-bg)"},children:[u.jsx("div",{style:{width:"15%",textAlign:"center"},children:"Nick Name"}),u.jsx("div",{style:{width:"25%",textAlign:"left"},children:"Full Name"}),u.jsx("div",{style:{width:"15%",textAlign:"center"},children:"Member Since"}),u.jsx("div",{style:{width:"15%",textAlign:"center"},children:"Last Gym Visit"}),u.jsx("div",{style:{width:"15%",textAlign:"center"},children:"Gym Valid Until"}),u.jsx("div",{style:{width:"15%",textAlign:"center"},children:"Coach Valid Until"})]}),u.jsx(MM,{height:Math.min(b,Math.max(200,V.length*56)),itemCount:V.length,itemSize:56,width:"100%",children:({index:A,style:F})=>{const{r:O,lastVisit:z,isToday:$,memberId:G}=V[A],J=G?i.get(G):void 0,ae=tw(Lt(O,["student","is_student","student?"]));let de=Number(Lt(O,["age","years_old"]));if(isNaN(de)){const H=Lt(O,["birthday","birth_date","dob"]),te=li(H);if(te){const X=new Date;de=X.getFullYear()-te.getFullYear()-(X.getMonth()<te.getMonth()||X.getMonth()===te.getMonth()&&X.getDate()<te.getDate()?1:0)}}const ie=!isNaN(de)&&de>=60,_e=String(Lt(O,["first_name","firstname","first","given_name"])??""),Te=String(Lt(O,["last_name","lastname","last","surname"])??""),ge=[_e,Te].filter(Boolean).map(rw).join(" "),Pe=String(O.nick_name??O.nickname??"").toUpperCase(),xe=nw(O)||li(Lt(O,["member_since","membersince","member_date","memberdate","member_date","createdat","created_at","join_date","joined","start_date"])),U=(J==null?void 0:J.membershipEnd)||null,Z=(J==null?void 0:J.coachEnd)||null;return u.jsxs("div",{style:{...F,display:"flex",alignItems:"center",padding:"8px 12px",borderBottom:"1px solid rgba(0,0,0,0.04)",cursor:"pointer"},className:"row-link",onClick:()=>t(`/members/${encodeURIComponent(G)}`,{state:{row:O}}),children:[u.jsx("div",{style:{width:"15%",textAlign:"center"},children:u.jsx("strong",{children:Pe})}),u.jsxs("div",{style:{width:"25%"},children:[ge,u.jsxs("span",{style:{display:"inline-flex",gap:6,marginLeft:8,verticalAlign:"middle"},children:[ae&&u.jsx("span",{className:"pill student",children:"Student"}),ie&&u.jsx("span",{className:"pill senior",children:"Senior"})]})]}),u.jsx("div",{style:{width:"15%",textAlign:"center"},children:ei(xe)}),u.jsx("div",{style:{width:"15%",textAlign:"center"},children:$?u.jsx("span",{className:"pill ok",children:"Visited today"}):z?ei(new Date(z)):""}),u.jsx("div",{style:{width:"15%",textAlign:"center",color:U?mc(U)?"green":"red":"inherit"},children:U?ei(new Date(U)):""}),u.jsx("div",{style:{width:"15%",textAlign:"center",color:Z?mc(Z)?"green":"red":"inherit"},children:Z?ei(new Date(Z)):""})]},A)}})]})})]}),u.jsx(N.Suspense,{fallback:u.jsx(OT,{}),children:u.jsx(WM,{open:L,onClose:()=>B(!1),onSaved:async()=>{try{await I()}catch{}}})})]})}function JM({open:t,onClose:e,onDetected:n}){const r=N.useRef(null),i=N.useRef(null),[s,o]=N.useState(""),c=N.useRef(0),a=N.useRef(null),d=()=>{c.current&&cancelAnimationFrame(c.current),c.current=0,i.current&&(i.current.getTracks().forEach(p=>p.stop()),i.current=null)};async function h(){var p,v;try{if("BarcodeDetector"in window){const x=await((v=(p=window.BarcodeDetector).getSupportedFormats)==null?void 0:v.call(p))||[];if(x.includes("qr_code")||x.includes("qr"))return a.current=new window.BarcodeDetector({formats:["qr_code"]}),!0}}catch{}return a.current=null,!1}async function f(){o("");const p=await h();try{const v=await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"}},audio:!1});i.current=v;const x=r.current;if(x&&(x.srcObject=v,await x.play().catch(()=>{})),p){const _=async()=>{if(!r.current||r.current.readyState<2){c.current=requestAnimationFrame(_);return}try{const P=await a.current.detect(r.current);if(P&&P.length){const y=String(P[0].rawValue||P[0].raw||"").trim();if(y){n==null||n(y),e==null||e();return}}}catch{}c.current=requestAnimationFrame(_)};c.current=requestAnimationFrame(_)}else o("QR scanning isn't supported by this browser. Type the ID instead.")}catch(v){const x=(v==null?void 0:v.name)||"";o(x==="NotAllowedError"?"Camera permission denied. Allow access in browser/site settings.":x==="NotFoundError"?"No camera found.":"Cannot access camera.")}}return N.useEffect(()=>{if(!t){d();return}return f(),d},[t]),t?u.jsx("div",{style:ow.overlay,children:u.jsxs("div",{style:ow.modal,children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[u.jsx("div",{style:{fontWeight:800},children:"Scan QR Code"}),u.jsx("button",{className:"button btn-lg",style:{background:"#555"},onClick:e,children:"Close"})]}),s&&u.jsx("div",{style:{color:"#d33",marginBottom:8},children:s}),u.jsx("video",{ref:r,playsInline:!0,muted:!0,style:{width:"100%",borderRadius:10,background:"#000"}}),u.jsx("div",{style:{color:"#666",fontSize:12,marginTop:8},children:"Point the camera at the QR code."})]})}):null}const ow={overlay:{position:"fixed",inset:0,background:"rgba(0,0,0,.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},modal:{width:"min(720px, 92vw)",background:"#fff",borderRadius:12,padding:16,border:"1px solid #e7e8ef",boxShadow:"0 6px 24px rgba(0,0,0,.2)"}},{fetchMemberBundle:ZM,fetchPricing:aw,fetchMembers:eO,fetchPayments:tO,fetchGymEntries:nO}=tt,pc="Asia/Manila",rO=t=>{if(!t)return!1;const e=t instanceof Date?new Date(t):new Date(t);if(isNaN(e))return!1;const n=new Date;return n.setHours(0,0,0,0),e.setHours(0,0,0,0),e>=n},KT=t=>{const n=String(t||"").match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return n&&n[1]?n[1]:""},iO=t=>{const e=String(t||"");if(!e)return"";const n=e.match(/https?:\/\/[^\s}]+/);if(n){const i=n[0];if(/googleusercontent\.com\//.test(i))return i;const s=i.match(/(?:\/file\/d\/|[?&]id=|\/uc\?[^#]*id=)([^/&?#]+)/);return s&&s[1]?`https://drive.google.com/uc?export=view&id=${s[1]}`:i}if(/googleusercontent\.com\//.test(e))return e;const r=KT(e);return r?`https://drive.google.com/uc?export=view&id=${r}`:e},sO=t=>{const e=String(t||"");if(/googleusercontent\.com\//.test(e))return e;const n=KT(e);return n?`https://drive.google.com/thumbnail?id=${n}&sz=w1000`:e};function oO(){const[t,e]=N.useState(!1),[n,r]=N.useState(""),[i,s]=N.useState([]),[o,c]=N.useState(null),[a,d]=N.useState([]),[h,f]=N.useState(null),[p,v]=N.useState(!1),[x,_]=N.useState(null),[P,y]=N.useState(""),[w,T]=N.useState(""),[M,L]=N.useState(""),[B,C]=N.useState(!1),[b,R]=N.useState(""),[S,E]=N.useState(""),[j,k]=N.useState(!1),[Q,I]=N.useState(!1),V=N.useRef(null),q=N.useRef(null);N.useEffect(()=>{let O=!0;return(async()=>{try{const[z,$,G]=await Promise.all([eO(),tO(),aw()]);if(!O)return;const J=((z==null?void 0:z.rows)||(z==null?void 0:z.data)||[]).slice(),ae=($==null?void 0:$.rows)||($==null?void 0:$.data)||[],de=(G==null?void 0:G.rows)||(G==null?void 0:G.data)||[],ie=await nO(),_e=(ie==null?void 0:ie.rows)||(ie==null?void 0:ie.data)||[],Te=new Intl.DateTimeFormat("en-CA",{timeZone:pc,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date),ge=J.filter(Pe=>{const xe=(Pe.MemberID||Pe.member_id||Pe.id||"").toString().trim(),U=ae.filter(re=>String(re.MemberID||re.member_id||re.id||"").trim()===String(xe).trim()),Z=Oi(U,xe,de);return Z.membershipState==="active"||rO(Z==null?void 0:Z.membershipEnd)?!_e.filter(re=>{try{const oe=String(re.MemberID||re.memberId||re.memberid||re.id||"").trim();if(!oe||String(oe)!==String(xe))return!1;const ue=re.Date||re.date||re.DateTime||re.timestamp||re.checkin;return ue?new Intl.DateTimeFormat("en-CA",{timeZone:pc,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date(ue))===Te:!1}catch{return!1}}).some(re=>{try{const oe=String(re.TimeOut||re.timeOut||re.time_out||re.Timeout||"").trim();return oe?/\d/.test(oe)?!1:["-","","",""].includes(oe):!0}catch{return!0}}):!1});ge.sort((Pe,xe)=>{const U=String(Pe.Nickname||Pe.NickName||Pe["Nick Name"]||"").toLowerCase(),Z=String(xe.Nickname||xe.NickName||xe["Nick Name"]||"").toLowerCase();return U.localeCompare(Z)}),s(ge)}catch(z){console.error(z)}})(),()=>{O=!1}},[]),N.useEffect(()=>{I(!1)},[o==null?void 0:o.member]);const A=async O=>{const[z,$]=await Promise.all([ZM(O),aw()]),G=($==null?void 0:$.rows)||($==null?void 0:$.data)||[];c(z),d(G);const J=Oi(z.payments||[],O,G);return f(J),{b:z,rows:G,status:J}},F=async O=>{var _e,Te;const z=String(O||"").trim();if(!z)return;r(z),v(!0),L(""),c(null),f(null);const $=await A(z),G=((_e=$==null?void 0:$.b)==null?void 0:_e.member)||null,J=$==null?void 0:$.status;if(G&&(G.NickName||G.Nickname||G["Nick Name"]||G.nick_name||G.nickname),!G||(J==null?void 0:J.membershipState)!=="active"){L(null),setTimeout(()=>{L("NO ACTIVE GYM MEMBERSHIP")},100);return}const ae=new Intl.DateTimeFormat("en-CA",{timeZone:pc,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date),ie=(((Te=$==null?void 0:$.b)==null?void 0:Te.gymEntries)||[]).filter(ge=>{const Pe=(ge==null?void 0:ge.Date)||(ge==null?void 0:ge.date);if(!Pe)return!1;const xe=new Date(Pe);return new Intl.DateTimeFormat("en-CA",{timeZone:pc,year:"numeric",month:"2-digit",day:"2-digit"}).format(xe)===ae}).find(ge=>!String((ge==null?void 0:ge.TimeOut)||"").trim());ie?(k(!0),L(""),_(ie||null)):(k(!1),L(""),_(null))};return N.useEffect(()=>{const O=async $=>{try{const G=String($&&($.MemberID||$.memberid||$.Member)||"").trim();if(!G||!n||String(G)!==String(n))return;await A(n),_(null)}catch(G){console.debug("CheckIn: gymEntry event handler failed",G)}},z=qt.on("gymEntry:added",O);return()=>{try{z()}catch{}}},[n]),N.useMemo(()=>{const O=(o==null?void 0:o.member)||null;if(!O)return null;const z=_e=>_e.map(Te=>O[Te]).find(Te=>Te!==void 0&&Te!==""),$=z(["FirstName","First","first"]),G=z(["LastName","Last","last"]),J=z(["NickName","Nickname","Nick Name","nick_name","nickname"]),ae=z(["PhotoURL","Photo","photo","photo_url"]),de=sO(iO(ae)),ie=O.MemberSince||O["Member Since"]||O.Joined||O["Join Date"]||O.join_date;return{first:$,last:G,nick:J,photo:de,memberSince:ie}},[o]),u.jsxs("div",{className:"content",children:[u.jsx("h2",{className:"dashboard-title",children:"Member Check-In"}),u.jsx("div",{className:"card",style:{marginTop:8,marginBottom:12,maxWidth:480,minHeight:600,marginLeft:"auto",marginRight:"auto",padding:16,border:"2px solid #d7d9e5",background:"#fff",boxShadow:"0 10px 24px rgba(0,0,0,.12)",display:"flex",alignItems:"center",justifyContent:"center"},children:u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12,alignItems:"center",width:"100%"},children:[u.jsx("img",{src:"/kusgan-frontend/favicon.png",onError:O=>{try{O.currentTarget.onerror=null,O.currentTarget.src="/kusgan-frontend/kusgan-logo.png"}catch{}},alt:"Kusgan logo",style:{width:250,height:250,objectFit:"contain",opacity:1,marginBottom:8}}),u.jsx("div",{style:{maxWidth:420,width:"100%",margin:"0 auto"},children:u.jsx("button",{className:"primary-btn",style:{fontSize:"1.1rem",height:54,width:"100%"},onClick:()=>e(!0),children:" Scan QR Code"})}),u.jsx("div",{style:{color:"#666",textAlign:"center",marginTop:24},children:"or select a member below"}),u.jsx("div",{style:{maxWidth:420,width:"100%",margin:"0 auto"},children:u.jsxs("select",{value:n,onChange:O=>r(O.target.value),style:{width:"100%",height:44,padding:"8px 12px",border:"1px solid #e7e8ef",borderRadius:10},children:[u.jsx("option",{value:"",children:"Select member"}),i.map(O=>u.jsxs("option",{value:O.MemberID,children:[O.Nickname||O.NickName||O["Nick Name"]||"Member","  ",O.FirstName||O.First||""," ",O.LastName||O.Last||""]},O.MemberID))]})}),u.jsx("div",{style:{maxWidth:420,width:"100%",margin:"0 auto"},children:u.jsx("button",{className:"primary-btn",style:{fontSize:"1.1rem",height:54,width:"100%"},onClick:()=>{n&&F(n)},children:"Proceed"})})]})}),u.jsx(JM,{open:t,onClose:()=>e(!1),onDetected:F}),u.jsx(fd,{open:p,memberId:n,initialEntry:x,onClose:()=>{v(!1),L("")},onSuccess:()=>{v(!1),L(""),c(null),f(null),_(null)}}),B&&u.jsx("div",{style:{position:"fixed",top:24,right:24,zIndex:2e3,pointerEvents:V.current?"auto":"none"},children:u.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",background:"#333",color:"#fff",fontWeight:600,fontSize:16,borderRadius:8,boxShadow:"0 2px 12px rgba(0,0,0,.12)",padding:"10px 14px",minWidth:220,textAlign:"left",letterSpacing:.1},children:[u.jsx("div",{style:{flex:1},children:M}),V.current?u.jsx("button",{style:{background:"transparent",color:"#fff",border:"1px solid rgba(255,255,255,0.18)",padding:"6px 10px",borderRadius:6,cursor:"pointer"},onClick:()=>{const O=V.current;if(O){try{O.timer&&clearTimeout(O.timer)}catch{}V.current=null,O.type==="checkin"?(k(!1),c(z=>{if(!z)return z;const $=(z.gymEntries||[]).filter(G=>!(String(G.MemberID||"")===String(O.memberId)&&String(G.TimeIn||"")===String(O.nowIso)));return{...z,gymEntries:$}})):O.type==="checkout"&&(k(!0),c(z=>{if(!z)return z;const $=(z.gymEntries||[]).map(G=>String(G.MemberID||"")===String(O.memberId)&&String(G.TimeOut||"").length>0?{...G,TimeOut:""}:G);return{...z,gymEntries:$}})),L("Action cancelled"),C(!0),q.current&&clearTimeout(q.current),q.current=setTimeout(()=>{C(!1),L("")},1800)}},children:"Undo"}):null]})})]})}const aO=["Coach Jojo","Coach Elmer","Bezza","Jeanette","Johanna","Patpat","Sheena","Xyza"],Bn="Asia/Manila",dm=t=>{if(!t)return"";try{const e=new Date(t);return new Intl.DateTimeFormat("en-PH",{hour:"numeric",minute:"2-digit",hour12:!0,timeZone:Bn}).format(e)}catch{return String(t)}},lw=t=>{var e,n,r;if(!t)return"";try{const i=String(t||"");let s=null;if(/^\d{4}-\d{2}-\d{2}$/.test(i)?s=new Date(i+"T00:00:00"):s=new Date(i),isNaN(s))return i.slice(0,10);const o=new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",timeZone:Bn}).formatToParts(s),c=((e=o.find(h=>h.type==="month"))==null?void 0:e.value)||"",a=((n=o.find(h=>h.type==="day"))==null?void 0:n.value)||"",d=((r=o.find(h=>h.type==="year"))==null?void 0:r.value)||"";return`${c}-${a}, ${d}`}catch{return String(t)}},gc=t=>{try{const e=(t==null?void 0:t.time_in)||(t==null?void 0:t.timeIn)||(t==null?void 0:t.TimeIn)||(t==null?void 0:t.TimeInISO)||null,n=(t==null?void 0:t.TimeIn)||(t==null?void 0:t.time_in_short)||null;if(e)return dm(e);const r=String((t==null?void 0:t.TimeIn)||(t==null?void 0:t.time_in)||(t==null?void 0:t.TimeIn)||"");if(/^\d{1,2}:\d{2}$/.test(r)){const[i,s]=r.split(":").map(c=>Number(c)),o=new Date;return o.setHours(i,s,0,0),new Intl.DateTimeFormat("en-PH",{hour:"numeric",minute:"2-digit",hour12:!0,timeZone:Bn}).format(o)}return r||""}catch{return""}},Ar=t=>{try{const e=(t==null?void 0:t.Date)||(t==null?void 0:t.date)||(t==null?void 0:t.time_in)||(t==null?void 0:t.timeIn)||(t==null?void 0:t.Timestamp)||(t==null?void 0:t.timestamp)||(t==null?void 0:t.TimestampISO)||(t==null?void 0:t.timestampISO)||"";if(e&&typeof e=="object"&&(e.seconds||e._seconds)){const i=e.seconds||e._seconds,s=new Date(i*1e3);return new Intl.DateTimeFormat("en-CA",{timeZone:Bn}).format(s)}const n=String(e||"").trim();if(!n)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(n))return n.slice(0,10);const r=new Date(n);return isNaN(r)?n.slice(0,10):new Intl.DateTimeFormat("en-CA",{timeZone:Bn}).format(r)}catch{return""}};function lO(){const[t,e]=N.useState(""),[n,r]=N.useState([]),[i,s]=N.useState([]),[o,c]=N.useState([]),[a,d]=N.useState(null),[h,f]=N.useState(!1),[p,v]=N.useState(!1),[x,_]=N.useState(""),P=I=>{if(!I)return!1;const V=String(I).trim().toLowerCase(),q=new Intl.DateTimeFormat("en-CA",{timeZone:Bn}).format(new Date);for(const A of n||[])try{const F=String((A==null?void 0:A.Staff)||(A==null?void 0:A.staff)||(A==null?void 0:A.staff_name)||"").trim().toLowerCase(),O=Ar(A)||"",z=String((A==null?void 0:A.TimeIn)||(A==null?void 0:A.time_in)||(A==null?void 0:A.timein)||"").trim(),$=String((A==null?void 0:A.TimeOut)||(A==null?void 0:A.time_out)||(A==null?void 0:A.timeout)||"").trim();if(F===V&&O===q&&z&&($===""||$==="-"||$===""||$===null||typeof $>"u"))return!0}catch{}return!1},y=async()=>{f(!0),_("");try{const I=Nr.getCached("attendance")||[];I&&I.length&&r(I);const q=await(await fetch("/attendance")).json(),A=Array.isArray(q)?q:[];r(A),Nr.setCached("attendance",A);try{const F=await tt.fetchMembers(),O=F&&(F.rows||F.data)?F.rows||F.data:Array.isArray(F)?F:[];c(Array.isArray(O)?O:[])}catch{}try{const F=await tt.fetchGymEntries(),O=F&&(F.rows||F.data)?F.rows||F.data:Array.isArray(F)?F:[];s(Array.isArray(O)?O:[])}catch{}Nr.processQueue()}catch(I){console.error("load attendance",I),_("Failed to load attendance")}finally{f(!1)}};N.useEffect(()=>{y()},[]);const w=new Intl.DateTimeFormat("en-CA",{timeZone:Bn}).format(new Date),T=["Coach Jojo","Coach Elmer"],[M,L]=N.useState(T[0]),[B,C]=N.useState([]),[b,R]=N.useState(0),S=N.useMemo(()=>{try{const I=new Set;(i||[]).forEach(q=>{const A=String((q==null?void 0:q.Coach)||(q==null?void 0:q.coach)||"").trim();A&&I.add(A)});const V=Array.from(I);return V.length?V:T}catch{return T}},[i]);N.useEffect(()=>{try{!M&&S&&S.length&&L(S[0]),M&&S&&S.length&&!S.includes(M)&&L(S[0])}catch{}},[S]);const E=(I,V)=>{try{if(!I||!V)return[];const q=new Date(I.getFullYear(),I.getMonth(),1),A=new Date(V.getFullYear(),V.getMonth(),V.getDate()),F=[];let O=new Date(q);for(;O<=A;){const $=O.getFullYear(),G=O.getMonth(),J=new Date($,G,1),ae=new Date($,G,15),de=new Date($,G+1,0);F.push({label:`${J.toLocaleString("en-US",{month:"short"})} 1-15, ${$}`,start:new Intl.DateTimeFormat("en-CA",{timeZone:Bn}).format(J),end:new Intl.DateTimeFormat("en-CA",{timeZone:Bn}).format(ae)}),F.push({label:`${J.toLocaleString("en-US",{month:"short"})} 16-${de.getDate()}, ${$}`,start:new Intl.DateTimeFormat("en-CA",{timeZone:Bn}).format(new Date($,G,16)),end:new Intl.DateTimeFormat("en-CA",{timeZone:Bn}).format(de)}),O=new Date($,G+1,1)}const z=[];for(const $ of F)z.find(G=>G.label===$.label)||z.push($);return z}catch{return[]}};N.useEffect(()=>{try{if(!i||i.length===0){const z=new Date,$=E(new Date(z.getFullYear(),z.getMonth()-3,1),z);C($);const G=w,J=$.findIndex(ae=>ae.start<=G&&ae.end>=G);J>=0&&R(J);return}let I=null;for(const z of i){const $=Ar(z)||"";if(!$)continue;const G=new Date($+"T00:00:00");isNaN(G)||(!I||G<I)&&(I=G)}const V=new Date,q=I||new Date(V.getFullYear(),V.getMonth(),1),A=E(q,V);C(A);const F=w,O=A.findIndex(z=>z.start<=F&&z.end>=F);O>=0&&R(O)}catch{}},[i]);const j=N.useMemo(()=>{try{const I=(()=>{const V=new Date;return V.setDate(V.getDate()-19),new Intl.DateTimeFormat("en-CA",{timeZone:Bn}).format(V)})();return(n||[]).filter(V=>{const q=Ar(V)||"";return q&&q>=I&&(V.Staff||V.staff||V.staff_name)}).sort((V,q)=>{const A=(Ar(V)||"0000-00-00")+"T"+String((V==null?void 0:V.TimeIn)||(V==null?void 0:V.time_in)||"00:00");return((Ar(q)||"0000-00-00")+"T"+String((q==null?void 0:q.TimeIn)||(q==null?void 0:q.time_in)||"00:00")).localeCompare(A)})}catch{return[]}},[n]),k=N.useMemo(()=>{try{if(!B||B.length===0)return[];const I=B[b]||B[0],V=(I==null?void 0:I.start)||"",q=(I==null?void 0:I.end)||"";return(i||[]).filter(F=>{try{const O=String((F==null?void 0:F.Coach)||(F==null?void 0:F.coach)||"").trim();if(!O)return!1;if(M){const $=O.toLowerCase().replace(/\s+/g,""),G=String(M).toLowerCase().replace(/\s+/g,"");if(!($.includes(G)||G.includes($)))return!1}const z=Ar(F)||"";return z?z>=V&&z<=q:!1}catch{return!1}}).sort((F,O)=>String((O==null?void 0:O.TimeIn)||(O==null?void 0:O.time_in)||"").localeCompare(String((F==null?void 0:F.TimeIn)||(F==null?void 0:F.time_in)||"")))}catch{return[]}},[i,B,M,b]),Q=async()=>{if(t){v(!0),_("");try{const I=Nr.addOptimisticAttendance(t);r(V=>{const q=(V||[]).filter(A=>String(A.id)!==String(I.id));return[I,...q]});try{tt&&typeof tt.attendanceQuickAppend=="function"?await tt.attendanceQuickAppend(t,{}):tt&&typeof tt.clockIn=="function"?await tt.clockIn(t):(Nr.enqueueWrite({method:"POST",path:"/attendance/kiosk",body:{staff_name:t},tempId:I.id,collection:"attendance"}),await Nr.processQueue())}catch(V){console.warn("attendance client write failed, falling back to queue",V&&V.message),Nr.enqueueWrite({method:"POST",path:"/attendance/kiosk",body:{staff_name:t},tempId:I.id,collection:"attendance"}),await Nr.processQueue()}await y()}catch(I){console.error("kiosk error",I),_((I==null?void 0:I.message)||"Action failed")}finally{v(!1)}}};return u.jsxs("div",{className:"dashboard-content",children:[u.jsxs("h2",{className:"dashboard-title",children:["Staff Attendance ",u.jsx(hd,{show:h&&!p})]}),u.jsxs("div",{className:"panel",children:[u.jsx("div",{className:"panel-header",children:"Select Staff Member"}),u.jsx("div",{style:{display:"flex",justifyContent:"center"},children:u.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",padding:12},children:[u.jsxs("select",{value:t,onChange:I=>e(I.target.value),style:{width:300,height:44,padding:"8px 12px",border:"1px solid #e7e8ef",borderRadius:10,fontSize:18},children:[u.jsx("option",{value:"",children:"(choose)"}),aO.map(I=>u.jsx("option",{value:I,children:I},I))]}),u.jsx("button",{className:"primary-btn",onClick:Q,disabled:!t||p,children:p?"Processing":t&&P(t)?"Sign Out":"Sign In"})]})})]}),u.jsxs("div",{className:"panel",children:[u.jsx("div",{className:"panel-header",children:"Attendance Records"}),x&&u.jsx("div",{className:"small-error",children:x}),u.jsx("div",{style:{overflowX:"auto",padding:8},children:u.jsxs("table",{className:"attendance-table aligned",style:{width:"100%"},children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Date"}),u.jsx("th",{children:"Staff"}),u.jsx("th",{children:"Time In"}),u.jsx("th",{children:"Time Out"}),u.jsx("th",{style:{textAlign:"center"},children:"Total Hours"})]})}),u.jsx("tbody",{children:j.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:5,style:{textAlign:"center",color:"var(--muted)"},children:"No records."})}):j.map((I,V)=>{const q=Ar(I)||"",A=gc(I),F=(I==null?void 0:I.time_out)||(I==null?void 0:I.TimeOut)||(I==null?void 0:I.timeOut)||"",O=F?F.length===5?gc({TimeIn:F}):dm(F):"",z=typeof(I==null?void 0:I.TotalHours)<"u"&&(I==null?void 0:I.TotalHours)!==null?String(I==null?void 0:I.TotalHours):typeof(I==null?void 0:I.NoOfHours)<"u"&&(I==null?void 0:I.NoOfHours)!==null?String(I==null?void 0:I.NoOfHours):typeof(I==null?void 0:I.hours)<"u"&&(I==null?void 0:I.hours)!==null?String(I==null?void 0:I.hours):"",$=String((I==null?void 0:I.TimeOut)||(I==null?void 0:I.time_out)||(I==null?void 0:I.timeout)||"").trim(),G=$===""||$==="-"||$===""||$==="null"||typeof $>"u",J=String((I==null?void 0:I.Staff)||(I==null?void 0:I.staff)||(I==null?void 0:I.staff_name)||""),ae=(Ar(I)||"")===w;return u.jsxs("tr",{children:[u.jsx("td",{children:lw(q)}),u.jsxs("td",{style:{fontWeight:700},children:[J,G&&ae&&u.jsx("span",{style:{marginLeft:8},className:"status-badge on",children:"On"})]}),u.jsx("td",{children:A}),u.jsx("td",{children:O}),u.jsx("td",{style:{textAlign:"center"},children:z})]},(q||"")+"|"+String((I==null?void 0:I.Staff)||(I==null?void 0:I.staff)||V))})})]})})]}),u.jsxs("div",{className:"panel",style:{marginTop:18},children:[u.jsx("div",{className:"panel-header",children:"Coaching Sessions"}),u.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",justifyContent:"center",flexWrap:"wrap",padding:"8px 0 6px 0"},children:[u.jsxs("div",{children:[u.jsx("div",{style:{fontSize:12,color:"var(--muted)",marginBottom:6},children:"Coach"}),u.jsx("select",{value:M,onChange:I=>L(I.target.value),style:{width:260,height:44,padding:"8px 12px",border:"1px solid #e7e8ef",borderRadius:10,fontSize:16},children:S.map(I=>u.jsx("option",{value:I,children:I},I))})]}),u.jsxs("div",{children:[u.jsx("div",{style:{fontSize:12,color:"var(--muted)",marginBottom:6},children:"Period"}),u.jsx("select",{value:b,onChange:I=>R(Number(I.target.value)),style:{width:260,height:44,padding:"8px 12px",border:"1px solid #e7e8ef",borderRadius:10,fontSize:16},children:B.map((I,V)=>u.jsx("option",{value:V,children:I.label},I.label))})]})]}),u.jsxs("div",{style:{paddingTop:6,paddingBottom:12,fontWeight:700,paddingLeft:8},children:["Sessions: ",(k==null?void 0:k.length)||0]}),u.jsx("div",{style:{overflowX:"auto",padding:8},children:u.jsxs("table",{className:"attendance-table aligned",style:{width:"100%"},children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Date"}),u.jsx("th",{children:"Nickname"}),u.jsx("th",{children:"Time In"}),u.jsx("th",{children:"Time Out"}),u.jsx("th",{style:{textAlign:"center"},children:"Total Hours"}),u.jsx("th",{children:"Focus"})]})}),u.jsx("tbody",{children:!B||B.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:6,children:"No periods"})}):k.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:6,children:"No sessions for selected coach / period."})}):k.map((I,V)=>{const q=Ar(I)||"",A=gc(I),F=(I==null?void 0:I.time_out)||(I==null?void 0:I.TimeOut)||(I==null?void 0:I.timeOut)||"",O=F?F.length===5?gc({TimeIn:F}):dm(F):"",z=typeof(I==null?void 0:I.TotalHours)<"u"&&(I==null?void 0:I.TotalHours)!==null?String(I==null?void 0:I.TotalHours):typeof(I==null?void 0:I.NoOfHours)<"u"&&(I==null?void 0:I.NoOfHours)!==null?String(I==null?void 0:I.NoOfHours):typeof(I==null?void 0:I.TotalHours)<"u"&&(I==null?void 0:I.TotalHours)!==null?String(I==null?void 0:I.TotalHours):typeof(I==null?void 0:I.hours)<"u"&&(I==null?void 0:I.hours)!==null?String(I==null?void 0:I.hours):"",$=String((I==null?void 0:I.MemberID)||(I==null?void 0:I.memberid)||(I==null?void 0:I.member)||(I==null?void 0:I.Member)||(I==null?void 0:I.id)||"").trim(),G=(o||[]).find(ae=>String((ae==null?void 0:ae.MemberID)||(ae==null?void 0:ae.memberid)||(ae==null?void 0:ae.id)||"").trim()===$)||null,J=G?xu(G):String((I==null?void 0:I.NickName)||(I==null?void 0:I.nickname)||(I==null?void 0:I.Member)||(I==null?void 0:I.member)||"")||"";return u.jsxs("tr",{style:{cursor:"pointer"},onClick:()=>d(I),children:[u.jsx("td",{children:lw(q)}),u.jsx("td",{style:{fontWeight:700},children:J}),u.jsx("td",{children:A}),u.jsx("td",{children:O}),u.jsx("td",{style:{textAlign:"center"},children:z}),u.jsx("td",{children:String((I==null?void 0:I.Focus)||(I==null?void 0:I.focus)||"")})]},(q||"")+"|"+J+"|"+V)})})]})}),u.jsx(og,{open:!!a,onClose:()=>d(null),row:a,onCheckout:async I=>{try{await y()}catch{}d(null)}})]})]})}const{fetchPricing:js}=tt;function cO(){const[t,e]=N.useState(""),[n,r]=N.useState("Staff"),[i,s]=N.useState(""),[o,c]=N.useState(!1),[a,d]=N.useState(""),[h,f]=N.useState(null),[p,v]=N.useState(""),[x,_]=N.useState([]),[P,y]=N.useState(null),[w,T]=N.useState(""),M={padding:"8px 12px",fontSize:14,lineHeight:"1",minHeight:36},[L,B]=N.useState([]),[C,b]=N.useState(""),[R,S]=N.useState(""),[E,j]=N.useState([]),[k,Q]=N.useState("No"),[I,V]=N.useState("No"),[q,A]=N.useState(""),[F,O]=N.useState(""),[z,$]=N.useState(!1),[G,J]=N.useState(""),[ae,de]=N.useState("");N.useEffect(()=>{let U=!0;return(async()=>{try{const Z=await Tt.fetchWithAuth("/products");if(!U)return;if(!Z.ok){B([]);return}const H=await Z.json().catch(()=>[]);B(H||[])}catch{B([])}})(),()=>{U=!1}},[]),N.useEffect(()=>{let U=!0;return(async()=>{try{const Z=await js();if(!U)return;j((Z==null?void 0:Z.rows)||(Z==null?void 0:Z.data)||[])}catch{j([])}})(),()=>{U=!1}},[]);const ie=(()=>{const U={};(E||[]).forEach(H=>{const te=String(H.Particulars||H.particulars||H.name||"").trim();te&&(U[te.toLowerCase()]=H)});const Z=[];return(E||[]).forEach(H=>{const te=String(H.Particulars||H.particulars||H.name||"").trim();te&&Z.push({id:H.id||H.ID||H._id||null,particulars:te,gym:(H["Gym membership"]??H["Gym Membership"]??H.gym_membership??H.is_gym_membership??"")||"",coach:(H["Coach subscription"]??H["Coach Subscription"]??H.coach_subscription??H.is_coach_subscription??"")||"",cost:H.Cost||H.cost||H.Price||H.price||"",validity:H.Validity||H.validity||H.validity_days||H.ValidityDays||0,source:"pricing",raw:H})}),(L||[]).forEach(H=>{const te=String(H.name||H.Particulars||H.particulars||"").trim();te&&(U[te.toLowerCase()]||Z.push({id:H.id||null,particulars:te,gym:(H.is_gym_membership||H.is_gym||H.gym,H.is_gym_membership||H.gym?"Yes":"No"),coach:(H.is_coach_subscription||H.is_coach||H.coach,H.is_coach_subscription||H.coach?"Yes":"No"),cost:H.price||H.Cost||H.cost||"",validity:H.validity_days||H.Validity||H.validity||0,source:"products",raw:H}))}),Z})(),_e=(()=>{const U=[],Z=[],H=[],te=[];return ie.forEach(X=>{const re=String(X.gym||"").toLowerCase().startsWith("y"),oe=String(X.coach||"").toLowerCase().startsWith("y");re&&!oe?U.push(X):!re&&oe?Z.push(X):re&&oe?H.push(X):te.push(X)}),{gymOnly:U,coachOnly:Z,bundle:H,merch:te}})();N.useEffect(()=>{let U=!0;return(async()=>{var Z;try{const H=await Tt.fetchWithAuth("/users");if(!U)return;if(H&&H.ok){const te=await H.json().catch(()=>[]);_(te||[]);return}try{const te=await Tt.fetchWithAuth("/auth/me");if(te&&te.ok){const X=await te.json().catch(()=>({})),re=((Z=X==null?void 0:X.user)==null?void 0:Z.username)||"";_(re?[{id:null,username:re}]:[]);return}}catch{}_([])}catch{}})(),()=>{U=!1}},[]);const Te=async()=>{try{let U;try{U=await Tt.fetchWithAuth("/users")}catch{U=null}if(!U||!U.ok)try{const H=`${window.location.protocol}//${window.location.hostname}:4000`,te=Tt.getToken&&Tt.getToken(),X={};te&&(X.Authorization=`Bearer ${te}`);const re=await fetch(`${H}/users`,{headers:X});if(!re.ok){_([]);return}const oe=await re.json().catch(()=>[]);_(oe||[]);return}catch{_([]);return}const Z=await U.json().catch(()=>[]);_(Z||[])}catch{_([])}},ge=async()=>{try{const U=await Tt.fetchWithAuth("/products");if(!U.ok)return;const Z=await U.json().catch(()=>[]);B(Z||[])}catch{}},Pe=async U=>{if(U&&U.preventDefault(),s(""),!t)return s("Please enter username");c(!0);try{const Z=await Tt.fetchWithAuth("/staff",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({full_name:t,role:n})});if(!Z.ok){const te=await Z.json().catch(()=>({}));return s(te.error||"Failed to add staff")}const H=await Z.json().catch(()=>({}));try{const te=Math.random().toString(36).slice(-10),X=a||te;let re;try{re=await Tt.fetchWithAuth("/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:X,role:n==="Admin"?"admin":"staff"})})}catch{re=null}if(!re||!re.ok)try{const oe=`${window.location.protocol}//${window.location.hostname}:4000`,ue=Tt.getToken&&Tt.getToken(),be={"Content-Type":"application/json"};ue&&(be.Authorization=`Bearer ${ue}`);const De=await fetch(`${oe}/users`,{method:"POST",headers:be,body:JSON.stringify({username:t,password:X,role:n==="Admin"?"admin":"staff"})});if(!De.ok){let et="";try{et=await De.text()}catch{et=""}s(`Staff added. User creation failed: ${De.status} ${et||De.statusText||"error"}`),e(""),d(""),c(!1);return}await Te(),s(`Staff added. User created (password: ${X})`),e(""),d(""),c(!1);return}catch{s("Staff added. User creation failed (network)"),e(""),d(""),c(!1);return}try{await re.json().catch(()=>({}))}catch{}await Te(),s(`Staff added. User created (password: ${X})`),e(""),d(""),c(!1)}catch{s("Staff added. User creation failed"),e(""),d(""),c(!1);return}}catch{s("Server error"),c(!1)}},xe=U=>{if(!U.id){s("Cannot change status for current user from here");return}(async()=>{try{const Z=!U.active;if(!(await Tt.fetchWithAuth(`/users/${U.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...U,active:Z})})).ok)return s("Update failed");await Te(),s(Z?"User activated":"User deactivated")}catch{s("Server error")}})()};return u.jsx("div",{className:"content",children:u.jsxs("div",{className:"panel",children:[u.jsx("div",{className:"panel-header",children:"Admin Console"}),u.jsx("div",{style:{color:"var(--muted)",marginBottom:8},children:"Add staff accounts and manage products/services."}),u.jsxs("div",{className:"panel",style:{marginTop:12},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsx("div",{className:"panel-header",children:"Users"}),u.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[u.jsx("div",{style:{color:"var(--muted)",fontSize:13}}),u.jsx("button",{className:"button",style:M,onClick:()=>{Te(),s("Refreshed users")},children:"Refresh"})]})]}),u.jsxs("div",{style:{marginTop:6},children:[u.jsxs("form",{onSubmit:Pe,style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap",marginBottom:12},children:[u.jsx("input",{className:"input-compact",value:t,onChange:U=>e(U.target.value),placeholder:"username (e.g. jsmith)",style:{width:240}}),u.jsxs("select",{className:"select-compact",value:n,onChange:U=>r(U.target.value),style:{width:140},children:[u.jsx("option",{children:"Staff"}),u.jsx("option",{children:"Admin"})]}),u.jsx("input",{type:"password",className:"input-compact",placeholder:"password (optional)",value:a,onChange:U=>d(U.target.value),style:{width:180}}),u.jsx("button",{type:"submit",className:"button btn-compact",disabled:o,style:M,children:"Add"}),o&&u.jsx("div",{style:{color:"var(--muted)",marginLeft:8},children:"Adding..."})]}),u.jsx("div",{style:{marginTop:0,color:"var(--muted)",fontSize:13,marginBottom:12},children:"Creates a staff record; a login user will be created automatically (you may provide a password)."}),u.jsxs("ul",{style:{listStyle:"none",paddingLeft:0},children:[x.map(U=>u.jsxs("li",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 0",borderBottom:"1px solid var(--light-border)"},children:[u.jsxs("div",{children:[u.jsx("div",{style:{fontWeight:700},children:U.username}),u.jsx("div",{style:{color:"var(--muted)",fontSize:13},children:U.role||(U.id?"":"You")})]}),u.jsx("div",{style:{display:"flex",gap:8,alignItems:"center"},children:P===(U.id??"self")?u.jsxs(u.Fragment,{children:[u.jsx("input",{className:"input-compact",value:w,onChange:Z=>T(Z.target.value),placeholder:"new password",style:{width:140}}),u.jsx("button",{className:"button btn-compact",style:M,onClick:async()=>{if(!w)return s("Enter new password");try{let Z;if(U.id?Z=await Tt.fetchWithAuth(`/users/${U.id}/password`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:w})}):Z=await Tt.fetchWithAuth("/users/self/password",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:w})}),!Z.ok){const H=await Z.json().catch(()=>({}));s(H.error||"Reset failed");return}s("Password reset"),y(null),T(""),await Te()}catch{s("Server error")}},children:"Save"}),u.jsx("button",{className:"button",style:M,onClick:()=>{y(null),T("")},children:"Cancel"})]}):u.jsxs(u.Fragment,{children:[u.jsx("button",{className:"button btn-compact",style:M,onClick:()=>{y(U.id??"self"),T("")},children:"Reset"}),U.id?u.jsx("button",{className:"button",style:M,onClick:()=>xe(U),children:U.active??!0?"Deactivate":"Activate"}):null]})})]},U.id??U.username)),x.length===0&&u.jsx("li",{style:{color:"#888",padding:12},children:"No users found."})]})]}),u.jsx("div",{className:"panel-header",style:{marginTop:18},children:"Pricing Rules"}),u.jsxs("div",{style:{marginTop:8},children:[u.jsx("div",{style:{color:"var(--muted)",marginBottom:8},children:"This table lists the product rules used by the app to decide whether a Particulars value grants gym access and/or coach subscription."}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[u.jsx("div",{style:{color:"var(--muted)"},children:"This table lists the product rules used by the app to decide whether a Particulars value grants gym access and/or coach subscription."}),u.jsx("div",{children:z?u.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[u.jsx("input",{placeholder:"Merchandise name",value:G,onChange:U=>J(U.target.value),style:{width:240}}),u.jsx("input",{placeholder:"Price",value:ae,onChange:U=>de(U.target.value),style:{width:120}}),u.jsx("button",{className:"button",onClick:async()=>{if(!G)return s("Enter merchandise name");try{const U={Particulars:G,Cost:Number(ae)||0,Validity:0,"Gym membership":"No","Coach subscription":"No"};await tt.addPricing(U);const Z=await js();j((Z==null?void 0:Z.rows)||[]),J(""),de(""),$(!1),s("Merchandise added")}catch{s("Add failed")}},children:"Add"}),u.jsx("button",{className:"button",onClick:()=>{$(!1),J(""),de("")},children:"Cancel"})]}):u.jsx("button",{className:"button",onClick:()=>$(!0),children:"Add Merchandise"})})]}),u.jsxs("table",{className:"aligned",style:{width:"100%",borderCollapse:"collapse"},children:[u.jsxs("colgroup",{children:[u.jsx("col",{style:{width:"36%"}}),u.jsx("col",{style:{width:"14%"}}),u.jsx("col",{style:{width:"14%"}}),u.jsx("col",{style:{width:"14%"}}),u.jsx("col",{style:{width:"12%"}}),u.jsx("col",{style:{width:"10%"}})]}),u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Particulars"}),u.jsx("th",{children:"Gym Membership"}),u.jsx("th",{children:"Coach Subscription"}),u.jsx("th",{children:"Cost"}),u.jsx("th",{children:"Validity (days)"}),u.jsx("th",{children:"Actions"})]})}),u.jsx("tbody",{children:_e.gymOnly.length+_e.coachOnly.length+_e.bundle.length+_e.merch.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:6,style:{color:"#888",padding:12},children:"No pricing rules configured."})}):u.jsxs(u.Fragment,{children:[_e.gymOnly.length>0&&u.jsxs(u.Fragment,{children:[u.jsx("tr",{style:{background:"var(--muted-background)",fontWeight:700},children:u.jsx("td",{colSpan:6,style:{padding:8},children:"Gym Membership Only"})}),_e.gymOnly.map(U=>{const Z=h===(U.id||U.particulars);return u.jsxs("tr",{style:{borderTop:"1px solid var(--light-border)"},children:[u.jsx("td",{style:{padding:"6px 8px"},children:U.particulars}),u.jsx("td",{style:{textAlign:"center"},children:U.gym}),u.jsx("td",{style:{textAlign:"center"},children:U.coach}),u.jsx("td",{style:{textAlign:"center"},children:Z?u.jsx("input",{value:p,onChange:H=>v(H.target.value),style:{width:96}}):U.cost||""}),u.jsx("td",{style:{textAlign:"center"},children:U.validity||""}),u.jsx("td",{style:{textAlign:"right"},children:Z?u.jsxs(u.Fragment,{children:[u.jsx("button",{className:"button",onClick:async()=>{try{if(U.source==="pricing"){await tt.updatePricing(U.id,{Cost:Number(p)||0});const H=await js();j((H==null?void 0:H.rows)||[])}else U.source==="products"&&U.id&&(await Tt.fetchWithAuth(`/products/${U.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...U.raw,price:Number(p)||0})}),await ge());f(null),v(""),s("Pricing updated")}catch{s("Update failed")}},children:"Save"}),u.jsx("button",{className:"button",onClick:()=>{f(null),v("")},children:"Cancel"})]}):u.jsx("button",{className:"button",onClick:()=>{f(U.id||U.particulars),v(U.cost||"")},children:"Edit"})})]},U.id||U.particulars)})]}),_e.coachOnly.length>0&&u.jsxs(u.Fragment,{children:[u.jsx("tr",{style:{background:"var(--muted-background)",fontWeight:700},children:u.jsx("td",{colSpan:6,style:{padding:8},children:"Coach Subscription Only"})}),_e.coachOnly.map(U=>{const Z=h===(U.id||U.particulars);return u.jsxs("tr",{style:{borderTop:"1px solid var(--light-border)"},children:[u.jsx("td",{style:{padding:"6px 8px"},children:U.particulars}),u.jsx("td",{style:{textAlign:"center"},children:U.gym}),u.jsx("td",{style:{textAlign:"center"},children:U.coach}),u.jsx("td",{style:{textAlign:"center"},children:Z?u.jsx("input",{value:p,onChange:H=>v(H.target.value),style:{width:96}}):U.cost||""}),u.jsx("td",{style:{textAlign:"center"},children:U.validity||""}),u.jsx("td",{style:{textAlign:"right"},children:Z?u.jsxs(u.Fragment,{children:[u.jsx("button",{className:"button",onClick:async()=>{try{if(U.source==="pricing"){await tt.updatePricing(U.id,{Cost:Number(p)||0});const H=await js();j((H==null?void 0:H.rows)||[])}else U.source==="products"&&U.id&&(await Tt.fetchWithAuth(`/products/${U.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...U.raw,price:Number(p)||0})}),await ge());f(null),v(""),s("Pricing updated")}catch{s("Update failed")}},children:"Save"}),u.jsx("button",{className:"button",onClick:()=>{f(null),v("")},children:"Cancel"})]}):u.jsx("button",{className:"button",onClick:()=>{f(U.id||U.particulars),v(U.cost||"")},children:"Edit"})})]},U.id||U.particulars)})]}),_e.bundle.length>0&&u.jsxs(u.Fragment,{children:[u.jsx("tr",{style:{background:"var(--muted-background)",fontWeight:700},children:u.jsx("td",{colSpan:6,style:{padding:8},children:"Gym & Coach Bundle"})}),_e.bundle.map(U=>{const Z=h===(U.id||U.particulars);return u.jsxs("tr",{style:{borderTop:"1px solid var(--light-border)"},children:[u.jsx("td",{style:{padding:"6px 8px"},children:U.particulars}),u.jsx("td",{style:{textAlign:"center"},children:U.gym}),u.jsx("td",{style:{textAlign:"center"},children:U.coach}),u.jsx("td",{style:{textAlign:"center"},children:Z?u.jsx("input",{value:p,onChange:H=>v(H.target.value),style:{width:96}}):U.cost||""}),u.jsx("td",{style:{textAlign:"center"},children:U.validity||""}),u.jsx("td",{style:{textAlign:"right"},children:Z?u.jsxs(u.Fragment,{children:[u.jsx("button",{className:"button",onClick:async()=>{try{if(U.source==="pricing"){await tt.updatePricing(U.id,{Cost:Number(p)||0});const H=await js();j((H==null?void 0:H.rows)||[])}else U.source==="products"&&U.id&&(await Tt.fetchWithAuth(`/products/${U.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...U.raw,price:Number(p)||0})}),await ge());f(null),v(""),s("Pricing updated")}catch{s("Update failed")}},children:"Save"}),u.jsx("button",{className:"button",onClick:()=>{f(null),v("")},children:"Cancel"})]}):u.jsx("button",{className:"button",onClick:()=>{f(U.id||U.particulars),v(U.cost||"")},children:"Edit"})})]},U.id||U.particulars)})]}),_e.merch.length>0&&u.jsxs(u.Fragment,{children:[u.jsx("tr",{style:{background:"var(--muted-background)",fontWeight:700},children:u.jsx("td",{colSpan:6,style:{padding:8},children:"Merchandise"})}),_e.merch.map(U=>{const Z=h===(U.id||U.particulars);return u.jsxs("tr",{style:{borderTop:"1px solid var(--light-border)"},children:[u.jsx("td",{style:{padding:"6px 8px"},children:U.particulars}),u.jsx("td",{style:{textAlign:"center"},children:U.gym}),u.jsx("td",{style:{textAlign:"center"},children:U.coach}),u.jsx("td",{style:{textAlign:"center"},children:Z?u.jsx("input",{value:p,onChange:H=>v(H.target.value),style:{width:96}}):U.cost||""}),u.jsx("td",{style:{textAlign:"center"},children:U.validity||""}),u.jsx("td",{style:{textAlign:"right"},children:Z?u.jsxs(u.Fragment,{children:[u.jsx("button",{className:"button",onClick:async()=>{try{if(U.source==="pricing"){await tt.updatePricing(U.id,{Cost:Number(p)||0});const H=await js();j((H==null?void 0:H.rows)||[])}else U.source==="products"&&U.id&&(await Tt.fetchWithAuth(`/products/${U.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...U.raw,price:Number(p)||0})}),await ge());f(null),v(""),s("Pricing updated")}catch{s("Update failed")}},children:"Save"}),u.jsx("button",{className:"button",onClick:()=>{f(null),v("")},children:"Cancel"})]}):u.jsx("button",{className:"button",onClick:()=>{f(U.id||U.particulars),v(U.cost||"")},children:"Edit"})})]},U.id||U.particulars)})]})]})})]})]})]}),i&&u.jsx("div",{style:{marginTop:12,color:"#2b7",fontWeight:600},children:i})]})})}function uO(){const[t,e]=N.useState([]);return N.useEffect(()=>{const n=qt.on("modal:error",r=>{const i=Date.now()+Math.random(),s={id:i,message:(r==null?void 0:r.message)||"An error occurred",source:(r==null?void 0:r.source)||""};e(o=>[...o,s]),setTimeout(()=>e(o=>o.filter(c=>c.id!==i)),6e3)});return()=>n()},[]),t.length?u.jsx("div",{style:{position:"fixed",top:20,right:20,zIndex:99999,display:"flex",flexDirection:"column",gap:8},children:t.map(n=>u.jsxs("div",{style:{background:"#111",color:"#fff",padding:"10px 14px",borderRadius:10,minWidth:240,boxShadow:"0 8px 24px rgba(0,0,0,.2)"},children:[u.jsx("div",{style:{fontWeight:700,marginBottom:4},children:n.source||"Error"}),u.jsx("div",{style:{fontSize:13},children:n.message})]},n.id))}):null}function dO(){const[t,e]=N.useState("");N.useEffect(()=>{const i=Tt.getToken();i&&e(i)},[]);const n=i=>{e(i);try{Tt.setToken(i)}catch{}},r=()=>{e(""),localStorage.removeItem("authToken")};return t?u.jsxs("div",{className:"app",children:[u.jsx(uO,{}),u.jsx(nA,{onLogout:r}),u.jsx("div",{className:"main-content",children:u.jsxs(PC,{children:[u.jsx(ti,{path:"/",element:u.jsx(Oj,{})}),u.jsx(ti,{path:"/attendance",element:u.jsx(lO,{})}),u.jsx(ti,{path:"/members",element:u.jsx(XM,{})}),u.jsx(ti,{path:"/members/:memberId",element:u.jsx(Pj,{})}),u.jsx(ti,{path:"/checkin",element:u.jsx(oO,{})}),u.jsx(ti,{path:"/admin",element:u.jsx(cO,{})}),u.jsx(ti,{path:"*",element:u.jsx(NC,{to:"/",replace:!0})})]})})]}):u.jsx(tA,{setToken:n})}class hO extends Ue.Component{constructor(e){super(e),this.state={error:null,info:null}}componentDidCatch(e,n){this.setState({error:e,info:n})}render(){const{error:e,info:n}=this.state;return e?u.jsxs("div",{style:{padding:24,fontFamily:"sans-serif"},children:[u.jsx("h2",{style:{color:"#c92a2a"},children:"Application error"}),u.jsx("div",{style:{marginBottom:12,color:"#444"},children:"An uncaught error occurred while rendering the app."}),u.jsxs("details",{style:{whiteSpace:"pre-wrap",background:"#fff8f8",padding:12,borderRadius:6,border:"1px solid #ffd6d6"},children:[u.jsx("summary",{style:{cursor:"pointer",fontWeight:700},children:"Error details"}),u.jsx("div",{style:{marginTop:8},children:String(e&&e.toString())}),u.jsx("div",{style:{marginTop:8},children:n&&n.componentStack})]})]}):this.props.children}}try{console.log("[app] starting main.jsx",{base:"/kusgan-frontend/",hasClientId:!1});const t=document.getElementById("root");t&&(t.innerHTML='<div style="padding:20px;font-family:sans-serif;color:#333">Mounting Kusgan app...</div>')}catch{}try{Nh.createRoot(document.getElementById("root")).render(u.jsx(Ue.StrictMode,{children:u.jsx(GC,{clientId:"",children:u.jsx(FC,{children:u.jsx(hO,{children:u.jsx(dO,{})})})})}))}catch(t){console.error("[app] render failure",t);const e=document.getElementById("root");e&&(e.innerHTML=`<div style="padding:20px;font-family:sans-serif;color:#900"><h2>Render error</h2><pre>${String(t)}</pre></div>`)}export{RD as C,xs as M,DD as a,tt as b,qt as e,MD as g,u as j,Nr as l,N as r,Po as u};
